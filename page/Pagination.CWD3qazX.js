import{c as jg,g as JF}from"./apiConfig.APTs6M15.js";import{c as QF,d as eL,q as tL,o as Kv,e as Xv,f as zg,F as rL,D as nL,t as iL,G as sL,_ as oL}from"../index.CjFcdXSB.js";import{d as cT}from"./dateUtil.DjjUZQ_8.js";var Bh=function(t){return t&&t.Math===Math&&t},gn=Bh(typeof globalThis=="object"&&globalThis)||Bh(typeof window=="object"&&window)||Bh(typeof self=="object"&&self)||Bh(typeof jg=="object"&&jg)||Bh(typeof jg=="object"&&jg)||function(){return this}()||Function("return this")(),rb={},ai=function(t){try{return!!t()}catch{return!0}},aL=ai,Os=!aL(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),lL=ai,Ow=!lL(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),uL=Ow,Yg=Function.prototype.call,Is=uL?Yg.bind(Yg):function(){return Yg.apply(Yg,arguments)},bI={},xI={}.propertyIsEnumerable,RI=Object.getOwnPropertyDescriptor,cL=RI&&!xI.call({1:2},1);bI.f=cL?function(e){var r=RI(this,e);return!!r&&r.enumerable}:xI;var Iw=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},EI=Ow,TI=Function.prototype,Hy=TI.call,hL=EI&&TI.bind.bind(Hy,Hy),Br=EI?hL:function(t){return function(){return Hy.apply(t,arguments)}},_I=Br,dL=_I({}.toString),fL=_I("".slice),Bu=function(t){return fL(dL(t),8,-1)},gL=Br,mL=ai,pL=Bu,qv=Object,wL=gL("".split),vL=mL(function(){return!qv("z").propertyIsEnumerable(0)})?function(t){return pL(t)==="String"?wL(t,""):qv(t)}:qv,Pw=function(t){return t==null},CL=Pw,SL=TypeError,sg=function(t){if(CL(t))throw new SL("Can't call method on "+t);return t},yL=vL,bL=sg,Nw=function(t){return yL(bL(t))},Zv=typeof document=="object"&&document.all,mn=typeof Zv>"u"&&Zv!==void 0?function(t){return typeof t=="function"||t===Zv}:function(t){return typeof t=="function"},xL=mn,So=function(t){return typeof t=="object"?t!==null:xL(t)},Jv=gn,RL=mn,EL=function(t){return RL(t)?t:void 0},bh=function(t,e){return arguments.length<2?EL(Jv[t]):Jv[t]&&Jv[t][e]},TL=Br,Dw=TL({}.isPrototypeOf),_L=gn,hT=_L.navigator,dT=hT&&hT.userAgent,Hw=dT?String(dT):"",AI=gn,Qv=Hw,fT=AI.process,gT=AI.Deno,mT=fT&&fT.versions||gT&&gT.version,pT=mT&&mT.v8,Cs,m0;pT&&(Cs=pT.split("."),m0=Cs[0]>0&&Cs[0]<4?1:+(Cs[0]+Cs[1]));!m0&&Qv&&(Cs=Qv.match(/Edge\/(\d+)/),(!Cs||Cs[1]>=74)&&(Cs=Qv.match(/Chrome\/(\d+)/),Cs&&(m0=+Cs[1])));var AL=m0,wT=AL,ML=ai,OL=gn,IL=OL.String,nb=!!Object.getOwnPropertySymbols&&!ML(function(){var t=Symbol("symbol detection");return!IL(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&wT&&wT<41}),PL=nb,MI=PL&&!Symbol.sham&&typeof Symbol.iterator=="symbol",NL=bh,DL=mn,HL=Dw,kL=MI,FL=Object,ib=kL?function(t){return typeof t=="symbol"}:function(t){var e=NL("Symbol");return DL(e)&&HL(e.prototype,FL(t))},LL=String,kw=function(t){try{return LL(t)}catch{return"Object"}},$L=mn,BL=kw,VL=TypeError,og=function(t){if($L(t))return t;throw new VL(BL(t)+" is not a function")},WL=og,UL=Pw,Fw=function(t,e){var r=t[e];return UL(r)?void 0:WL(r)},eC=Is,tC=mn,rC=So,jL=TypeError,zL=function(t,e){var r,n;if(e==="string"&&tC(r=t.toString)&&!rC(n=eC(r,t))||tC(r=t.valueOf)&&!rC(n=eC(r,t))||e!=="string"&&tC(r=t.toString)&&!rC(n=eC(r,t)))return n;throw new jL("Can't convert object to primitive value")},OI={exports:{}},vT=gn,YL=Object.defineProperty,sb=function(t,e){try{YL(vT,t,{value:e,configurable:!0,writable:!0})}catch{vT[t]=e}return e},GL=gn,KL=sb,CT="__core-js_shared__",ST=OI.exports=GL[CT]||KL(CT,{});(ST.versions||(ST.versions=[])).push({version:"3.38.1",mode:"global",copyright:"Â© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"});var ob=OI.exports,yT=ob,II=function(t,e){return yT[t]||(yT[t]=e||{})},XL=sg,qL=Object,ag=function(t){return qL(XL(t))},ZL=Br,JL=ag,QL=ZL({}.hasOwnProperty),yo=Object.hasOwn||function(e,r){return QL(JL(e),r)},e$=Br,t$=0,r$=Math.random(),n$=e$(1 .toString),PI=function(t){return"Symbol("+(t===void 0?"":t)+")_"+n$(++t$+r$,36)},i$=gn,s$=II,bT=yo,o$=PI,a$=nb,l$=MI,qc=i$.Symbol,nC=s$("wks"),u$=l$?qc.for||qc:qc&&qc.withoutSetter||o$,yl=function(t){return bT(nC,t)||(nC[t]=a$&&bT(qc,t)?qc[t]:u$("Symbol."+t)),nC[t]},c$=Is,xT=So,RT=ib,h$=Fw,d$=zL,f$=yl,g$=TypeError,m$=f$("toPrimitive"),p$=function(t,e){if(!xT(t)||RT(t))return t;var r=h$(t,m$),n;if(r){if(e===void 0&&(e="default"),n=c$(r,t,e),!xT(n)||RT(n))return n;throw new g$("Can't convert object to primitive value")}return e===void 0&&(e="number"),d$(t,e)},w$=p$,v$=ib,NI=function(t){var e=w$(t,"string");return v$(e)?e:e+""},C$=gn,ET=So,ky=C$.document,S$=ET(ky)&&ET(ky.createElement),ab=function(t){return S$?ky.createElement(t):{}},y$=Os,b$=ai,x$=ab,DI=!y$&&!b$(function(){return Object.defineProperty(x$("div"),"a",{get:function(){return 7}}).a!==7}),R$=Os,E$=Is,T$=bI,_$=Iw,A$=Nw,M$=NI,O$=yo,I$=DI,TT=Object.getOwnPropertyDescriptor;rb.f=R$?TT:function(e,r){if(e=A$(e),r=M$(r),I$)try{return TT(e,r)}catch{}if(O$(e,r))return _$(!E$(T$.f,e,r),e[r])};var bl={},P$=Os,N$=ai,HI=P$&&N$(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),D$=So,H$=String,k$=TypeError,pa=function(t){if(D$(t))return t;throw new k$(H$(t)+" is not an object")},F$=Os,L$=DI,$$=HI,Gg=pa,_T=NI,B$=TypeError,iC=Object.defineProperty,V$=Object.getOwnPropertyDescriptor,sC="enumerable",oC="configurable",aC="writable";bl.f=F$?$$?function(e,r,n){if(Gg(e),r=_T(r),Gg(n),typeof e=="function"&&r==="prototype"&&"value"in n&&aC in n&&!n[aC]){var i=V$(e,r);i&&i[aC]&&(e[r]=n.value,n={configurable:oC in n?n[oC]:i[oC],enumerable:sC in n?n[sC]:i[sC],writable:!1})}return iC(e,r,n)}:iC:function(e,r,n){if(Gg(e),r=_T(r),Gg(n),L$)try{return iC(e,r,n)}catch{}if("get"in n||"set"in n)throw new B$("Accessors not supported");return"value"in n&&(e[r]=n.value),e};var W$=Os,U$=bl,j$=Iw,lg=W$?function(t,e,r){return U$.f(t,e,j$(1,r))}:function(t,e,r){return t[e]=r,t},kI={exports:{}},Fy=Os,z$=yo,FI=Function.prototype,Y$=Fy&&Object.getOwnPropertyDescriptor,lb=z$(FI,"name"),G$=lb&&(function(){}).name==="something",K$=lb&&(!Fy||Fy&&Y$(FI,"name").configurable),X$={EXISTS:lb,PROPER:G$,CONFIGURABLE:K$},q$=Br,Z$=mn,Ly=ob,J$=q$(Function.toString);Z$(Ly.inspectSource)||(Ly.inspectSource=function(t){return J$(t)});var Q$=Ly.inspectSource,eB=gn,tB=mn,AT=eB.WeakMap,rB=tB(AT)&&/native code/.test(String(AT)),nB=II,iB=PI,MT=nB("keys"),LI=function(t){return MT[t]||(MT[t]=iB(t))},ub={},sB=rB,$I=gn,oB=So,aB=lg,lC=yo,uC=ob,lB=LI,uB=ub,OT="Object already initialized",$y=$I.TypeError,cB=$I.WeakMap,p0,Of,w0,hB=function(t){return w0(t)?Of(t):p0(t,{})},dB=function(t){return function(e){var r;if(!oB(e)||(r=Of(e)).type!==t)throw new $y("Incompatible receiver, "+t+" required");return r}};if(sB||uC.state){var Hs=uC.state||(uC.state=new cB);Hs.get=Hs.get,Hs.has=Hs.has,Hs.set=Hs.set,p0=function(t,e){if(Hs.has(t))throw new $y(OT);return e.facade=t,Hs.set(t,e),e},Of=function(t){return Hs.get(t)||{}},w0=function(t){return Hs.has(t)}}else{var nc=lB("state");uB[nc]=!0,p0=function(t,e){if(lC(t,nc))throw new $y(OT);return e.facade=t,aB(t,nc,e),e},Of=function(t){return lC(t,nc)?t[nc]:{}},w0=function(t){return lC(t,nc)}}var fB={set:p0,get:Of,has:w0,enforce:hB,getterFor:dB},cb=Br,gB=ai,mB=mn,Kg=yo,By=Os,pB=X$.CONFIGURABLE,wB=Q$,BI=fB,vB=BI.enforce,CB=BI.get,IT=String,Wp=Object.defineProperty,SB=cb("".slice),yB=cb("".replace),bB=cb([].join),xB=By&&!gB(function(){return Wp(function(){},"length",{value:8}).length!==8}),RB=String(String).split("String"),EB=kI.exports=function(t,e,r){SB(IT(e),0,7)==="Symbol("&&(e="["+yB(IT(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!Kg(t,"name")||pB&&t.name!==e)&&(By?Wp(t,"name",{value:e,configurable:!0}):t.name=e),xB&&r&&Kg(r,"arity")&&t.length!==r.arity&&Wp(t,"length",{value:r.arity});try{r&&Kg(r,"constructor")&&r.constructor?By&&Wp(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var n=vB(t);return Kg(n,"source")||(n.source=bB(RB,typeof e=="string"?e:"")),t};Function.prototype.toString=EB(function(){return mB(this)&&CB(this).source||wB(this)},"toString");var TB=kI.exports,_B=mn,AB=bl,MB=TB,OB=sb,IB=function(t,e,r,n){n||(n={});var i=n.enumerable,s=n.name!==void 0?n.name:e;if(_B(r)&&MB(r,s,n),n.global)i?t[e]=r:OB(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch{}i?t[e]=r:AB.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},VI={},PB=Math.ceil,NB=Math.floor,DB=Math.trunc||function(e){var r=+e;return(r>0?NB:PB)(r)},HB=DB,ug=function(t){var e=+t;return e!==e||e===0?0:HB(e)},kB=ug,FB=Math.max,LB=Math.min,$B=function(t,e){var r=kB(t);return r<0?FB(r+e,0):LB(r,e)},BB=ug,VB=Math.min,WB=function(t){var e=BB(t);return e>0?VB(e,9007199254740991):0},UB=WB,cg=function(t){return UB(t.length)},jB=Nw,zB=$B,YB=cg,PT=function(t){return function(e,r,n){var i=jB(e),s=YB(i);if(s===0)return!t&&-1;var o=zB(n,s),a;if(t&&r!==r){for(;s>o;)if(a=i[o++],a!==a)return!0}else for(;s>o;o++)if((t||o in i)&&i[o]===r)return t||o||0;return!t&&-1}},GB={includes:PT(!0),indexOf:PT(!1)},KB=Br,cC=yo,XB=Nw,qB=GB.indexOf,ZB=ub,NT=KB([].push),WI=function(t,e){var r=XB(t),n=0,i=[],s;for(s in r)!cC(ZB,s)&&cC(r,s)&&NT(i,s);for(;e.length>n;)cC(r,s=e[n++])&&(~qB(i,s)||NT(i,s));return i},hb=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],JB=WI,QB=hb,e4=QB.concat("length","prototype");VI.f=Object.getOwnPropertyNames||function(e){return JB(e,e4)};var UI={};UI.f=Object.getOwnPropertySymbols;var t4=bh,r4=Br,n4=VI,i4=UI,s4=pa,o4=r4([].concat),a4=t4("Reflect","ownKeys")||function(e){var r=n4.f(s4(e)),n=i4.f;return n?o4(r,n(e)):r},DT=yo,l4=a4,u4=rb,c4=bl,jI=function(t,e,r){for(var n=l4(e),i=c4.f,s=u4.f,o=0;o<n.length;o++){var a=n[o];!DT(t,a)&&!(r&&DT(r,a))&&i(t,a,s(e,a))}},h4=ai,d4=mn,f4=/#|\.prototype\./,hg=function(t,e){var r=m4[g4(t)];return r===w4?!0:r===p4?!1:d4(e)?h4(e):!!e},g4=hg.normalize=function(t){return String(t).replace(f4,".").toLowerCase()},m4=hg.data={},p4=hg.NATIVE="N",w4=hg.POLYFILL="P",v4=hg,Xg=gn,C4=rb.f,S4=lg,y4=IB,b4=sb,x4=jI,R4=v4,pn=function(t,e){var r=t.target,n=t.global,i=t.stat,s,o,a,l,u,c;if(n?o=Xg:i?o=Xg[r]||b4(r,{}):o=Xg[r]&&Xg[r].prototype,o)for(a in e){if(u=e[a],t.dontCallGetSet?(c=C4(o,a),l=c&&c.value):l=o[a],s=R4(n?a:r+(i?".":"#")+a,t.forced),!s&&l!==void 0){if(typeof u==typeof l)continue;x4(u,l)}(t.sham||l&&l.sham)&&S4(u,"sham",!0),y4(o,a,u,t)}},E4=Ow,zI=Function.prototype,HT=zI.apply,kT=zI.call,Lw=typeof Reflect=="object"&&Reflect.apply||(E4?kT.bind(HT):function(){return kT.apply(HT,arguments)}),T4=Br,_4=og,YI=function(t,e,r){try{return T4(_4(Object.getOwnPropertyDescriptor(t,e)[r]))}catch{}},A4=So,M4=function(t){return A4(t)||t===null},O4=M4,I4=String,P4=TypeError,N4=function(t){if(O4(t))return t;throw new P4("Can't set "+I4(t)+" as a prototype")},D4=YI,H4=So,k4=sg,F4=N4,GI=Object.setPrototypeOf||("__proto__"in{}?function(){var t=!1,e={},r;try{r=D4(Object.prototype,"__proto__","set"),r(e,[]),t=e instanceof Array}catch{}return function(i,s){return k4(i),F4(s),H4(i)&&(t?r(i,s):i.__proto__=s),i}}():void 0),L4=bl.f,$4=function(t,e,r){r in t||L4(t,r,{configurable:!0,get:function(){return e[r]},set:function(n){e[r]=n}})},B4=mn,V4=So,FT=GI,W4=function(t,e,r){var n,i;return FT&&B4(n=e.constructor)&&n!==r&&V4(i=n.prototype)&&i!==r.prototype&&FT(t,i),t},U4=yl,j4=U4("toStringTag"),KI={};KI[j4]="z";var z4=String(KI)==="[object z]",Y4=z4,G4=mn,Up=Bu,K4=yl,X4=K4("toStringTag"),q4=Object,Z4=Up(function(){return arguments}())==="Arguments",J4=function(t,e){try{return t[e]}catch{}},XI=Y4?Up:function(t){var e,r,n;return t===void 0?"Undefined":t===null?"Null":typeof(r=J4(e=q4(t),X4))=="string"?r:Z4?Up(e):(n=Up(e))==="Object"&&G4(e.callee)?"Arguments":n},Q4=XI,eV=String,$w=function(t){if(Q4(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return eV(t)},tV=$w,rV=function(t,e){return t===void 0?arguments.length<2?"":e:tV(t)},nV=So,iV=lg,sV=function(t,e){nV(e)&&"cause"in e&&iV(t,"cause",e.cause)},oV=Br,qI=Error,aV=oV("".replace),lV=function(t){return String(new qI(t).stack)}("zxcasd"),ZI=/\n\s*at [^:]*:[^\n]*/,uV=ZI.test(lV),cV=function(t,e){if(uV&&typeof t=="string"&&!qI.prepareStackTrace)for(;e--;)t=aV(t,ZI,"");return t},hV=ai,dV=Iw,fV=!hV(function(){var t=new Error("a");return"stack"in t?(Object.defineProperty(t,"stack",dV(1,7)),t.stack!==7):!0}),gV=lg,mV=cV,pV=fV,LT=Error.captureStackTrace,wV=function(t,e,r,n){pV&&(LT?LT(t,e):gV(t,"stack",mV(r,n)))},$T=bh,vV=yo,BT=lg,CV=Dw,VT=GI,WT=jI,UT=$4,SV=W4,yV=rV,bV=sV,xV=wV,RV=Os,EV=function(t,e,r,n){var i="stackTraceLimit",s=n?2:1,o=t.split("."),a=o[o.length-1],l=$T.apply(null,o);if(l){var u=l.prototype;if(vV(u,"cause")&&delete u.cause,!r)return l;var c=$T("Error"),h=e(function(d,f){var m=yV(n?f:d,void 0),g=n?new l(d):new l;return m!==void 0&&BT(g,"message",m),xV(g,h,g.stack,2),this&&CV(u,this)&&SV(g,this,h),arguments.length>s&&bV(g,arguments[s]),g});h.prototype=u,a!=="Error"?VT?VT(h,c):WT(h,c,{name:!0}):RV&&i in l&&(UT(h,l,i),UT(h,l,"prepareStackTrace")),WT(h,l);try{u.name!==a&&BT(u,"name",a),u.constructor=h}catch{}return h}},JI=pn,TV=gn,bo=Lw,QI=EV,Vy="WebAssembly",jT=TV[Vy],v0=new Error("e",{cause:7}).cause!==7,Vu=function(t,e){var r={};r[t]=QI(t,e,v0),JI({global:!0,constructor:!0,arity:1,forced:v0},r)},db=function(t,e){if(jT&&jT[t]){var r={};r[t]=QI(Vy+"."+t,e,v0),JI({target:Vy,stat:!0,constructor:!0,arity:1,forced:v0},r)}};Vu("Error",function(t){return function(r){return bo(t,this,arguments)}});Vu("EvalError",function(t){return function(r){return bo(t,this,arguments)}});Vu("RangeError",function(t){return function(r){return bo(t,this,arguments)}});Vu("ReferenceError",function(t){return function(r){return bo(t,this,arguments)}});Vu("SyntaxError",function(t){return function(r){return bo(t,this,arguments)}});Vu("TypeError",function(t){return function(r){return bo(t,this,arguments)}});Vu("URIError",function(t){return function(r){return bo(t,this,arguments)}});db("CompileError",function(t){return function(r){return bo(t,this,arguments)}});db("LinkError",function(t){return function(r){return bo(t,this,arguments)}});db("RuntimeError",function(t){return function(r){return bo(t,this,arguments)}});var _V=Bu,eP=Array.isArray||function(e){return _V(e)==="Array"},AV=Os,MV=eP,OV=TypeError,IV=Object.getOwnPropertyDescriptor,PV=AV&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}(),tP=PV?function(t,e){if(MV(t)&&!IV(t,"length").writable)throw new OV("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e},NV=TypeError,DV=9007199254740991,rP=function(t){if(t>DV)throw NV("Maximum allowed index exceeded");return t},HV=pn,kV=ag,FV=cg,LV=tP,$V=rP,BV=ai,VV=BV(function(){return[].push.call({length:4294967296},1)!==4294967297}),WV=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},UV=VV||!WV();HV({target:"Array",proto:!0,arity:1,forced:UV},{push:function(e){var r=kV(this),n=FV(r),i=arguments.length;$V(n+i);for(var s=0;s<i;s++)r[n]=arguments[s],n++;return LV(r,n),n}});var hC=Br,qg=Set.prototype,xo={Set,add:hC(qg.add),has:hC(qg.has),remove:hC(qg.delete),proto:qg},jV=xo.has,Wu=function(t){return jV(t),t},zV=Is,Uu=function(t,e,r){for(var n=r?t:t.iterator,i=t.next,s,o;!(s=zV(i,n)).done;)if(o=e(s.value),o!==void 0)return o},nP=Br,YV=Uu,iP=xo,GV=iP.Set,sP=iP.proto,KV=nP(sP.forEach),oP=nP(sP.keys),XV=oP(new GV).next,dg=function(t,e,r){return r?YV({iterator:oP(t),next:XV},e):KV(t,e)},aP=xo,qV=dg,ZV=aP.Set,JV=aP.add,fb=function(t){var e=new ZV;return qV(t,function(r){JV(e,r)}),e},QV=YI,eW=xo,fg=QV(eW.proto,"size","get")||function(t){return t.size},tW=function(t){return{iterator:t,next:t.next,done:!1}},zT=og,lP=pa,YT=Is,rW=ug,nW=tW,GT="Invalid size",iW=RangeError,sW=TypeError,oW=Math.max,uP=function(t,e){this.set=t,this.size=oW(e,0),this.has=zT(t.has),this.keys=zT(t.keys)};uP.prototype={getIterator:function(){return nW(lP(YT(this.keys,this.set)))},includes:function(t){return YT(this.has,this.set,t)}};var ju=function(t){lP(t);var e=+t.size;if(e!==e)throw new sW(GT);var r=rW(e);if(r<0)throw new iW(GT);return new uP(t,r)},aW=Wu,cP=xo,lW=fb,uW=fg,cW=ju,hW=dg,dW=Uu,fW=cP.has,KT=cP.remove,gW=function(e){var r=aW(this),n=cW(e),i=lW(r);return uW(r)<=n.size?hW(r,function(s){n.includes(s)&&KT(i,s)}):dW(n.getIterator(),function(s){fW(r,s)&&KT(i,s)}),i},mW=bh,XT=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},zu=function(t){var e=mW("Set");try{new e()[t](XT(0));try{return new e()[t](XT(-1)),!1}catch{return!0}}catch{return!1}},pW=pn,wW=gW,vW=zu;pW({target:"Set",proto:!0,real:!0,forced:!vW("difference")},{difference:wW});var CW=Wu,gb=xo,SW=fg,yW=ju,bW=dg,xW=Uu,RW=gb.Set,qT=gb.add,EW=gb.has,TW=function(e){var r=CW(this),n=yW(e),i=new RW;return SW(r)>n.size?xW(n.getIterator(),function(s){EW(r,s)&&qT(i,s)}):bW(r,function(s){n.includes(s)&&qT(i,s)}),i},_W=pn,AW=ai,MW=TW,OW=zu,IW=!OW("intersection")||AW(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});_W({target:"Set",proto:!0,real:!0,forced:IW},{intersection:MW});var PW=Is,ZT=pa,NW=Fw,mb=function(t,e,r){var n,i;ZT(t);try{if(n=NW(t,"return"),!n){if(e==="throw")throw r;return r}n=PW(n,t)}catch(s){i=!0,n=s}if(e==="throw")throw r;if(i)throw n;return ZT(n),r},DW=Wu,HW=xo.has,kW=fg,FW=ju,LW=dg,$W=Uu,BW=mb,VW=function(e){var r=DW(this),n=FW(e);if(kW(r)<=n.size)return LW(r,function(s){if(n.includes(s))return!1},!0)!==!1;var i=n.getIterator();return $W(i,function(s){if(HW(r,s))return BW(i,"normal",!1)})!==!1},WW=pn,UW=VW,jW=zu;WW({target:"Set",proto:!0,real:!0,forced:!jW("isDisjointFrom")},{isDisjointFrom:UW});var zW=Wu,YW=fg,GW=dg,KW=ju,XW=function(e){var r=zW(this),n=KW(e);return YW(r)>n.size?!1:GW(r,function(i){if(!n.includes(i))return!1},!0)!==!1},qW=pn,ZW=XW,JW=zu;qW({target:"Set",proto:!0,real:!0,forced:!JW("isSubsetOf")},{isSubsetOf:ZW});var QW=Wu,e3=xo.has,t3=fg,r3=ju,n3=Uu,i3=mb,s3=function(e){var r=QW(this),n=r3(e);if(t3(r)<n.size)return!1;var i=n.getIterator();return n3(i,function(s){if(!e3(r,s))return i3(i,"normal",!1)})!==!1},o3=pn,a3=s3,l3=zu;o3({target:"Set",proto:!0,real:!0,forced:!l3("isSupersetOf")},{isSupersetOf:a3});var u3=Wu,pb=xo,c3=fb,h3=ju,d3=Uu,f3=pb.add,g3=pb.has,m3=pb.remove,p3=function(e){var r=u3(this),n=h3(e).getIterator(),i=c3(r);return d3(n,function(s){g3(r,s)?m3(i,s):f3(i,s)}),i},w3=pn,v3=p3,C3=zu;w3({target:"Set",proto:!0,real:!0,forced:!C3("symmetricDifference")},{symmetricDifference:v3});var S3=Wu,y3=xo.add,b3=fb,x3=ju,R3=Uu,E3=function(e){var r=S3(this),n=x3(e).getIterator(),i=b3(r);return R3(n,function(s){y3(i,s)}),i},T3=pn,_3=E3,A3=zu;T3({target:"Set",proto:!0,real:!0,forced:!A3("union")},{union:_3});var M3=Bu,O3=Br,I3=function(t){if(M3(t)==="Function")return O3(t)},JT=I3,P3=og,N3=Ow,D3=JT(JT.bind),hP=function(t,e){return P3(t),e===void 0?t:N3?D3(t,e):function(){return t.apply(e,arguments)}},H3=bh,dP=H3("document","documentElement"),k3=Br,wb=k3([].slice),F3=TypeError,fP=function(t,e){if(t<e)throw new F3("Not enough arguments");return t},L3=Hw,$3=/(?:ipad|iphone|ipod).*applewebkit/i.test(L3),Vh=gn,B3=Hw,V3=Bu,Zg=function(t){return B3.slice(0,t.length)===t},gP=function(){return Zg("Bun/")?"BUN":Zg("Cloudflare-Workers")?"CLOUDFLARE":Zg("Deno/")?"DENO":Zg("Node.js/")?"NODE":Vh.Bun&&typeof Bun.version=="string"?"BUN":Vh.Deno&&typeof Deno.version=="object"?"DENO":V3(Vh.process)==="process"?"NODE":Vh.window&&Vh.document?"BROWSER":"REST"}(),W3=gP,U3=W3==="NODE",Ri=gn,j3=Lw,z3=hP,QT=mn,Y3=yo,mP=ai,e_=dP,G3=wb,t_=ab,K3=fP,X3=$3,q3=U3,Wy=Ri.setImmediate,Uy=Ri.clearImmediate,Z3=Ri.process,dC=Ri.Dispatch,J3=Ri.Function,r_=Ri.MessageChannel,Q3=Ri.String,fC=0,Zd={},n_="onreadystatechange",If,_l,gC,mC;mP(function(){If=Ri.location});var vb=function(t){if(Y3(Zd,t)){var e=Zd[t];delete Zd[t],e()}},pC=function(t){return function(){vb(t)}},i_=function(t){vb(t.data)},s_=function(t){Ri.postMessage(Q3(t),If.protocol+"//"+If.host)};(!Wy||!Uy)&&(Wy=function(e){K3(arguments.length,1);var r=QT(e)?e:J3(e),n=G3(arguments,1);return Zd[++fC]=function(){j3(r,void 0,n)},_l(fC),fC},Uy=function(e){delete Zd[e]},q3?_l=function(t){Z3.nextTick(pC(t))}:dC&&dC.now?_l=function(t){dC.now(pC(t))}:r_&&!X3?(gC=new r_,mC=gC.port2,gC.port1.onmessage=i_,_l=z3(mC.postMessage,mC)):Ri.addEventListener&&QT(Ri.postMessage)&&!Ri.importScripts&&If&&If.protocol!=="file:"&&!mP(s_)?(_l=s_,Ri.addEventListener("message",i_,!1)):n_ in t_("script")?_l=function(t){e_.appendChild(t_("script"))[n_]=function(){e_.removeChild(this),vb(t)}}:_l=function(t){setTimeout(pC(t),0)});var pP={set:Wy,clear:Uy},eU=pn,tU=gn,o_=pP.clear;eU({global:!0,bind:!0,enumerable:!0,forced:tU.clearImmediate!==o_},{clearImmediate:o_});var wP=gn,rU=Lw,nU=mn,iU=gP,sU=Hw,oU=wb,aU=fP,lU=wP.Function,uU=/MSIE .\./.test(sU)||iU==="BUN"&&function(){var t=wP.Bun.version.split(".");return t.length<3||t[0]==="0"&&(t[1]<3||t[1]==="3"&&t[2]==="0")}(),cU=function(t,e){var r=e?2:1;return uU?function(n,i){var s=aU(arguments.length,1)>r,o=nU(n)?n:lU(n),a=s?oU(arguments,r):[],l=s?function(){rU(o,this,a)}:o;return e?t(l,i):t(l)}:t},hU=pn,vP=gn,a_=pP.set,dU=cU,l_=vP.setImmediate?dU(a_,!1):a_;hU({global:!0,bind:!0,enumerable:!0,forced:vP.setImmediate!==l_},{setImmediate:l_});/*! @license DOMPurify 2.5.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/2.5.6/LICENSE */function Ka(t){"@babel/helpers - typeof";return Ka=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ka(t)}function jy(t,e){return jy=Object.setPrototypeOf||function(n,i){return n.__proto__=i,n},jy(t,e)}function fU(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jp(t,e,r){return fU()?jp=Reflect.construct:jp=function(i,s,o){var a=[null];a.push.apply(a,s);var l=Function.bind.apply(i,a),u=new l;return o&&jy(u,o.prototype),u},jp.apply(null,arguments)}function ds(t){return gU(t)||mU(t)||pU(t)||wU()}function gU(t){if(Array.isArray(t))return zy(t)}function mU(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function pU(t,e){if(t){if(typeof t=="string")return zy(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return zy(t,e)}}function zy(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function wU(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var vU=Object.hasOwnProperty,u_=Object.setPrototypeOf,CU=Object.isFrozen,SU=Object.getPrototypeOf,yU=Object.getOwnPropertyDescriptor,Vn=Object.freeze,Gi=Object.seal,bU=Object.create,CP=typeof Reflect<"u"&&Reflect,C0=CP.apply,Yy=CP.construct;C0||(C0=function(e,r,n){return e.apply(r,n)});Vn||(Vn=function(e){return e});Gi||(Gi=function(e){return e});Yy||(Yy=function(e,r){return jp(e,ds(r))});var xU=Ki(Array.prototype.forEach),c_=Ki(Array.prototype.pop),Wh=Ki(Array.prototype.push),zp=Ki(String.prototype.toLowerCase),wC=Ki(String.prototype.toString),h_=Ki(String.prototype.match),es=Ki(String.prototype.replace),RU=Ki(String.prototype.indexOf),EU=Ki(String.prototype.trim),an=Ki(RegExp.prototype.test),vC=TU(TypeError);function Ki(t){return function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return C0(t,e,n)}}function TU(t){return function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return Yy(t,r)}}function mt(t,e,r){var n;r=(n=r)!==null&&n!==void 0?n:zp,u_&&u_(t,null);for(var i=e.length;i--;){var s=e[i];if(typeof s=="string"){var o=r(s);o!==s&&(CU(e)||(e[i]=o),s=o)}t[s]=!0}return t}function Al(t){var e=bU(null),r;for(r in t)C0(vU,t,[r])===!0&&(e[r]=t[r]);return e}function Jg(t,e){for(;t!==null;){var r=yU(t,e);if(r){if(r.get)return Ki(r.get);if(typeof r.value=="function")return Ki(r.value)}t=SU(t)}function n(i){return console.warn("fallback value for",i),null}return n}var d_=Vn(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),CC=Vn(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),SC=Vn(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_U=Vn(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),yC=Vn(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),AU=Vn(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),f_=Vn(["#text"]),g_=Vn(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),bC=Vn(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),m_=Vn(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Qg=Vn(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MU=Gi(/\{\{[\w\W]*|[\w\W]*\}\}/gm),OU=Gi(/<%[\w\W]*|[\w\W]*%>/gm),IU=Gi(/\${[\w\W]*}/gm),PU=Gi(/^data-[\-\w.\u00B7-\uFFFF]/),NU=Gi(/^aria-[\-\w]+$/),DU=Gi(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),HU=Gi(/^(?:\w+script|data):/i),kU=Gi(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),FU=Gi(/^html$/i),LU=Gi(/^[a-z][.\w]*(-[.\w]+)+$/i),$U=function(){return typeof window>"u"?null:window},BU=function(e,r){if(Ka(e)!=="object"||typeof e.createPolicy!="function")return null;var n=null,i="data-tt-policy-suffix";r.currentScript&&r.currentScript.hasAttribute(i)&&(n=r.currentScript.getAttribute(i));var s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML:function(a){return a},createScriptURL:function(a){return a}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}};function SP(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$U(),e=function(N){return SP(N)};if(e.version="2.5.6",e.removed=[],!t||!t.document||t.document.nodeType!==9)return e.isSupported=!1,e;var r=t.document,n=t.document,i=t.DocumentFragment,s=t.HTMLTemplateElement,o=t.Node,a=t.Element,l=t.NodeFilter,u=t.NamedNodeMap,c=u===void 0?t.NamedNodeMap||t.MozNamedAttrMap:u,h=t.HTMLFormElement,d=t.DOMParser,f=t.trustedTypes,m=a.prototype,g=Jg(m,"cloneNode"),w=Jg(m,"nextSibling"),S=Jg(m,"childNodes"),b=Jg(m,"parentNode");if(typeof s=="function"){var y=n.createElement("template");y.content&&y.content.ownerDocument&&(n=y.content.ownerDocument)}var _=BU(f,r),P=_?_.createHTML(""):"",z=n,I=z.implementation,W=z.createNodeIterator,L=z.createDocumentFragment,U=z.getElementsByTagName,G=r.importNode,X={};try{X=Al(n).documentMode?n.documentMode:{}}catch{}var le={};e.isSupported=typeof b=="function"&&I&&I.createHTMLDocument!==void 0&&X!==9;var xe=MU,be=OU,Ze=IU,Le=PU,Ne=NU,Me=HU,at=kU,v=LU,p=DU,C=null,x=mt({},[].concat(ds(d_),ds(CC),ds(SC),ds(yC),ds(f_))),R=null,F=mt({},[].concat(ds(g_),ds(bC),ds(m_),ds(Qg))),q=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),re=null,fe=null,de=!0,pe=!0,Oe=!1,Be=!0,ee=!1,et=!0,je=!1,ye=!1,Xe=!1,Ve=!1,T=!1,M=!1,B=!0,Q=!1,j="user-content-",te=!0,K=!1,Y={},Z=null,J=mt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),ue=null,Ee=mt({},["audio","video","img","source","image","track"]),De=null,Ye=mt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),nt="http://www.w3.org/1998/Math/MathML",vt="http://www.w3.org/2000/svg",lt="http://www.w3.org/1999/xhtml",Je=lt,yt=!1,rr=null,_o=mt({},[nt,vt,lt],wC),li,Tl=["application/xhtml+xml","text/html"],on="text/html",nr,Or=null,Wr=n.createElement("form"),Zt=function(N){return N instanceof RegExp||N instanceof Function},Lh=function(N){Or&&Or===N||((!N||Ka(N)!=="object")&&(N={}),N=Al(N),li=Tl.indexOf(N.PARSER_MEDIA_TYPE)===-1?li=on:li=N.PARSER_MEDIA_TYPE,nr=li==="application/xhtml+xml"?wC:zp,C="ALLOWED_TAGS"in N?mt({},N.ALLOWED_TAGS,nr):x,R="ALLOWED_ATTR"in N?mt({},N.ALLOWED_ATTR,nr):F,rr="ALLOWED_NAMESPACES"in N?mt({},N.ALLOWED_NAMESPACES,wC):_o,De="ADD_URI_SAFE_ATTR"in N?mt(Al(Ye),N.ADD_URI_SAFE_ATTR,nr):Ye,ue="ADD_DATA_URI_TAGS"in N?mt(Al(Ee),N.ADD_DATA_URI_TAGS,nr):Ee,Z="FORBID_CONTENTS"in N?mt({},N.FORBID_CONTENTS,nr):J,re="FORBID_TAGS"in N?mt({},N.FORBID_TAGS,nr):{},fe="FORBID_ATTR"in N?mt({},N.FORBID_ATTR,nr):{},Y="USE_PROFILES"in N?N.USE_PROFILES:!1,de=N.ALLOW_ARIA_ATTR!==!1,pe=N.ALLOW_DATA_ATTR!==!1,Oe=N.ALLOW_UNKNOWN_PROTOCOLS||!1,Be=N.ALLOW_SELF_CLOSE_IN_ATTR!==!1,ee=N.SAFE_FOR_TEMPLATES||!1,et=N.SAFE_FOR_XML!==!1,je=N.WHOLE_DOCUMENT||!1,Ve=N.RETURN_DOM||!1,T=N.RETURN_DOM_FRAGMENT||!1,M=N.RETURN_TRUSTED_TYPE||!1,Xe=N.FORCE_BODY||!1,B=N.SANITIZE_DOM!==!1,Q=N.SANITIZE_NAMED_PROPS||!1,te=N.KEEP_CONTENT!==!1,K=N.IN_PLACE||!1,p=N.ALLOWED_URI_REGEXP||p,Je=N.NAMESPACE||lt,q=N.CUSTOM_ELEMENT_HANDLING||{},N.CUSTOM_ELEMENT_HANDLING&&Zt(N.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(q.tagNameCheck=N.CUSTOM_ELEMENT_HANDLING.tagNameCheck),N.CUSTOM_ELEMENT_HANDLING&&Zt(N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(q.attributeNameCheck=N.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),N.CUSTOM_ELEMENT_HANDLING&&typeof N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(q.allowCustomizedBuiltInElements=N.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ee&&(pe=!1),T&&(Ve=!0),Y&&(C=mt({},ds(f_)),R=[],Y.html===!0&&(mt(C,d_),mt(R,g_)),Y.svg===!0&&(mt(C,CC),mt(R,bC),mt(R,Qg)),Y.svgFilters===!0&&(mt(C,SC),mt(R,bC),mt(R,Qg)),Y.mathMl===!0&&(mt(C,yC),mt(R,m_),mt(R,Qg))),N.ADD_TAGS&&(C===x&&(C=Al(C)),mt(C,N.ADD_TAGS,nr)),N.ADD_ATTR&&(R===F&&(R=Al(R)),mt(R,N.ADD_ATTR,nr)),N.ADD_URI_SAFE_ATTR&&mt(De,N.ADD_URI_SAFE_ATTR,nr),N.FORBID_CONTENTS&&(Z===J&&(Z=Al(Z)),mt(Z,N.FORBID_CONTENTS,nr)),te&&(C["#text"]=!0),je&&mt(C,["html","head","body"]),C.table&&(mt(C,["tbody"]),delete re.tbody),Vn&&Vn(N),Or=N)},Wg=mt({},["mi","mo","mn","ms","mtext"]),Ug=mt({},["foreignobject","annotation-xml"]),zv=mt({},["title","style","font","a","script"]),xa=mt({},CC);mt(xa,SC),mt(xa,_U);var $h=mt({},yC);mt($h,AU);var Yv=function(N){var ie=b(N);(!ie||!ie.tagName)&&(ie={namespaceURI:Je,tagName:"template"});var ne=zp(N.tagName),Se=zp(ie.tagName);return rr[N.namespaceURI]?N.namespaceURI===vt?ie.namespaceURI===lt?ne==="svg":ie.namespaceURI===nt?ne==="svg"&&(Se==="annotation-xml"||Wg[Se]):!!xa[ne]:N.namespaceURI===nt?ie.namespaceURI===lt?ne==="math":ie.namespaceURI===vt?ne==="math"&&Ug[Se]:!!$h[ne]:N.namespaceURI===lt?ie.namespaceURI===vt&&!Ug[Se]||ie.namespaceURI===nt&&!Wg[Se]?!1:!$h[ne]&&(zv[ne]||!xa[ne]):!!(li==="application/xhtml+xml"&&rr[N.namespaceURI]):!1},Un=function(N){Wh(e.removed,{element:N});try{N.parentNode.removeChild(N)}catch{try{N.outerHTML=P}catch{N.remove()}}},E=function(N,ie){try{Wh(e.removed,{attribute:ie.getAttributeNode(N),from:ie})}catch{Wh(e.removed,{attribute:null,from:ie})}if(ie.removeAttribute(N),N==="is"&&!R[N])if(Ve||T)try{Un(ie)}catch{}else try{ie.setAttribute(N,"")}catch{}},D=function(N){var ie,ne;if(Xe)N="<remove></remove>"+N;else{var Se=h_(N,/^[\r\n\t ]+/);ne=Se&&Se[0]}li==="application/xhtml+xml"&&Je===lt&&(N='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+N+"</body></html>");var Ge=_?_.createHTML(N):N;if(Je===lt)try{ie=new d().parseFromString(Ge,li)}catch{}if(!ie||!ie.documentElement){ie=I.createDocument(Je,"template",null);try{ie.documentElement.innerHTML=yt?P:Ge}catch{}}var gt=ie.body||ie.documentElement;return N&&ne&&gt.insertBefore(n.createTextNode(ne),gt.childNodes[0]||null),Je===lt?U.call(ie,je?"html":"body")[0]:je?ie.documentElement:gt},A=function(N){return W.call(N.ownerDocument||N,N,l.SHOW_ELEMENT|l.SHOW_COMMENT|l.SHOW_TEXT|l.SHOW_PROCESSING_INSTRUCTION|l.SHOW_CDATA_SECTION,null,!1)},O=function(N){return N instanceof h&&(typeof N.nodeName!="string"||typeof N.textContent!="string"||typeof N.removeChild!="function"||!(N.attributes instanceof c)||typeof N.removeAttribute!="function"||typeof N.setAttribute!="function"||typeof N.namespaceURI!="string"||typeof N.insertBefore!="function"||typeof N.hasChildNodes!="function")},H=function(N){return Ka(o)==="object"?N instanceof o:N&&Ka(N)==="object"&&typeof N.nodeType=="number"&&typeof N.nodeName=="string"},k=function(N,ie,ne){le[N]&&xU(le[N],function(Se){Se.call(e,ie,ne,Or)})},oe=function(N){var ie;if(k("beforeSanitizeElements",N,null),O(N)||an(/[\u0080-\uFFFF]/,N.nodeName))return Un(N),!0;var ne=nr(N.nodeName);if(k("uponSanitizeElement",N,{tagName:ne,allowedTags:C}),N.hasChildNodes()&&!H(N.firstElementChild)&&(!H(N.content)||!H(N.content.firstElementChild))&&an(/<[/\w]/g,N.innerHTML)&&an(/<[/\w]/g,N.textContent)||ne==="select"&&an(/<template/i,N.innerHTML)||N.nodeType===7||et&&N.nodeType===8&&an(/<[/\w]/g,N.data))return Un(N),!0;if(!C[ne]||re[ne]){if(!re[ne]&&se(ne)&&(q.tagNameCheck instanceof RegExp&&an(q.tagNameCheck,ne)||q.tagNameCheck instanceof Function&&q.tagNameCheck(ne)))return!1;if(te&&!Z[ne]){var Se=b(N)||N.parentNode,Ge=S(N)||N.childNodes;if(Ge&&Se)for(var gt=Ge.length,ht=gt-1;ht>=0;--ht){var hr=g(Ge[ht],!0);hr.__removalCount=(N.__removalCount||0)+1,Se.insertBefore(hr,w(N))}}return Un(N),!0}return N instanceof a&&!Yv(N)||(ne==="noscript"||ne==="noembed"||ne==="noframes")&&an(/<\/no(script|embed|frames)/i,N.innerHTML)?(Un(N),!0):(ee&&N.nodeType===3&&(ie=N.textContent,ie=es(ie,xe," "),ie=es(ie,be," "),ie=es(ie,Ze," "),N.textContent!==ie&&(Wh(e.removed,{element:N.cloneNode()}),N.textContent=ie)),k("afterSanitizeElements",N,null),!1)},me=function(N,ie,ne){if(B&&(ie==="id"||ie==="name")&&(ne in n||ne in Wr))return!1;if(!(pe&&!fe[ie]&&an(Le,ie))){if(!(de&&an(Ne,ie))){if(!R[ie]||fe[ie]){if(!(se(N)&&(q.tagNameCheck instanceof RegExp&&an(q.tagNameCheck,N)||q.tagNameCheck instanceof Function&&q.tagNameCheck(N))&&(q.attributeNameCheck instanceof RegExp&&an(q.attributeNameCheck,ie)||q.attributeNameCheck instanceof Function&&q.attributeNameCheck(ie))||ie==="is"&&q.allowCustomizedBuiltInElements&&(q.tagNameCheck instanceof RegExp&&an(q.tagNameCheck,ne)||q.tagNameCheck instanceof Function&&q.tagNameCheck(ne))))return!1}else if(!De[ie]){if(!an(p,es(ne,at,""))){if(!((ie==="src"||ie==="xlink:href"||ie==="href")&&N!=="script"&&RU(ne,"data:")===0&&ue[N])){if(!(Oe&&!an(Me,es(ne,at,"")))){if(ne)return!1}}}}}}return!0},se=function(N){return N!=="annotation-xml"&&h_(N,v)},ae=function(N){var ie,ne,Se,Ge;k("beforeSanitizeAttributes",N,null);var gt=N.attributes;if(gt){var ht={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:R};for(Ge=gt.length;Ge--;){ie=gt[Ge];var hr=ie,sr=hr.name,Ao=hr.namespaceURI;if(ne=sr==="value"?ie.value:EU(ie.value),Se=nr(sr),ht.attrName=Se,ht.attrValue=ne,ht.keepAttr=!0,ht.forceKeepAttr=void 0,k("uponSanitizeAttribute",N,ht),ne=ht.attrValue,et&&an(/((--!?|])>)|<\/(style|title)/i,ne)){E(sr,N);continue}if(!ht.forceKeepAttr&&(E(sr,N),!!ht.keepAttr)){if(!Be&&an(/\/>/i,ne)){E(sr,N);continue}ee&&(ne=es(ne,xe," "),ne=es(ne,be," "),ne=es(ne,Ze," "));var Ra=nr(N.nodeName);if(me(Ra,Se,ne)){if(Q&&(Se==="id"||Se==="name")&&(E(sr,N),ne=j+ne),_&&Ka(f)==="object"&&typeof f.getAttributeType=="function"&&!Ao)switch(f.getAttributeType(Ra,Se)){case"TrustedHTML":{ne=_.createHTML(ne);break}case"TrustedScriptURL":{ne=_.createScriptURL(ne);break}}try{Ao?N.setAttributeNS(Ao,sr,ne):N.setAttribute(sr,ne),O(N)?Un(N):c_(e.removed)}catch{}}}}k("afterSanitizeAttributes",N,null)}},he=function ce(N){var ie,ne=A(N);for(k("beforeSanitizeShadowDOM",N,null);ie=ne.nextNode();)k("uponSanitizeShadowNode",ie,null),!oe(ie)&&(ie.content instanceof i&&ce(ie.content),ae(ie));k("afterSanitizeShadowDOM",N,null)};return e.sanitize=function(ce){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ie,ne,Se,Ge,gt;if(yt=!ce,yt&&(ce="<!-->"),typeof ce!="string"&&!H(ce))if(typeof ce.toString=="function"){if(ce=ce.toString(),typeof ce!="string")throw vC("dirty is not a string, aborting")}else throw vC("toString is not a function");if(!e.isSupported){if(Ka(t.toStaticHTML)==="object"||typeof t.toStaticHTML=="function"){if(typeof ce=="string")return t.toStaticHTML(ce);if(H(ce))return t.toStaticHTML(ce.outerHTML)}return ce}if(ye||Lh(N),e.removed=[],typeof ce=="string"&&(K=!1),K){if(ce.nodeName){var ht=nr(ce.nodeName);if(!C[ht]||re[ht])throw vC("root node is forbidden and cannot be sanitized in-place")}}else if(ce instanceof o)ie=D("<!---->"),ne=ie.ownerDocument.importNode(ce,!0),ne.nodeType===1&&ne.nodeName==="BODY"||ne.nodeName==="HTML"?ie=ne:ie.appendChild(ne);else{if(!Ve&&!ee&&!je&&ce.indexOf("<")===-1)return _&&M?_.createHTML(ce):ce;if(ie=D(ce),!ie)return Ve?null:M?P:""}ie&&Xe&&Un(ie.firstChild);for(var hr=A(K?ce:ie);Se=hr.nextNode();)Se.nodeType===3&&Se===Ge||oe(Se)||(Se.content instanceof i&&he(Se.content),ae(Se),Ge=Se);if(Ge=null,K)return ce;if(Ve){if(T)for(gt=L.call(ie.ownerDocument);ie.firstChild;)gt.appendChild(ie.firstChild);else gt=ie;return(R.shadowroot||R.shadowrootmod)&&(gt=G.call(r,gt,!0)),gt}var sr=je?ie.outerHTML:ie.innerHTML;return je&&C["!doctype"]&&ie.ownerDocument&&ie.ownerDocument.doctype&&ie.ownerDocument.doctype.name&&an(FU,ie.ownerDocument.doctype.name)&&(sr="<!DOCTYPE "+ie.ownerDocument.doctype.name+`>
`+sr),ee&&(sr=es(sr,xe," "),sr=es(sr,be," "),sr=es(sr,Ze," ")),_&&M?_.createHTML(sr):sr},e.setConfig=function(ce){Lh(ce),ye=!0},e.clearConfig=function(){Or=null,ye=!1},e.isValidAttribute=function(ce,N,ie){Or||Lh({});var ne=nr(ce),Se=nr(N);return me(ne,Se,ie)},e.addHook=function(ce,N){typeof N=="function"&&(le[ce]=le[ce]||[],Wh(le[ce],N))},e.removeHook=function(ce){if(le[ce])return c_(le[ce])},e.removeHooks=function(ce){le[ce]&&(le[ce]=[])},e.removeAllHooks=function(){le={}},e}var VU=SP();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var yP;function Ce(){return yP.apply(null,arguments)}function WU(t){yP=t}function Ts(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Tu(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Ot(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Cb(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Ot(t,e))return!1;return!0}function Zn(t){return t===void 0}function ca(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function gg(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function bP(t,e){var r=[],n,i=t.length;for(n=0;n<i;++n)r.push(e(t[n],n));return r}function Qa(t,e){for(var r in e)Ot(e,r)&&(t[r]=e[r]);return Ot(e,"toString")&&(t.toString=e.toString),Ot(e,"valueOf")&&(t.valueOf=e.valueOf),t}function Ro(t,e,r,n){return zP(t,e,r,n,!0).utc()}function UU(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function dt(t){return t._pf==null&&(t._pf=UU()),t._pf}var Gy;Array.prototype.some?Gy=Array.prototype.some:Gy=function(t){var e=Object(this),r=e.length>>>0,n;for(n=0;n<r;n++)if(n in e&&t.call(this,e[n],n,e))return!0;return!1};function Sb(t){var e=null,r=!1,n=t._d&&!isNaN(t._d.getTime());if(n&&(e=dt(t),r=Gy.call(e.parsedDateParts,function(i){return i!=null}),n=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&r),t._strict&&(n=n&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=n;else return n;return t._isValid}function Bw(t){var e=Ro(NaN);return t!=null?Qa(dt(e),t):dt(e).userInvalidated=!0,e}var p_=Ce.momentProperties=[],xC=!1;function yb(t,e){var r,n,i,s=p_.length;if(Zn(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),Zn(e._i)||(t._i=e._i),Zn(e._f)||(t._f=e._f),Zn(e._l)||(t._l=e._l),Zn(e._strict)||(t._strict=e._strict),Zn(e._tzm)||(t._tzm=e._tzm),Zn(e._isUTC)||(t._isUTC=e._isUTC),Zn(e._offset)||(t._offset=e._offset),Zn(e._pf)||(t._pf=dt(e)),Zn(e._locale)||(t._locale=e._locale),s>0)for(r=0;r<s;r++)n=p_[r],i=e[n],Zn(i)||(t[n]=i);return t}function mg(t){yb(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),xC===!1&&(xC=!0,Ce.updateOffset(this),xC=!1)}function _s(t){return t instanceof mg||t!=null&&t._isAMomentObject!=null}function xP(t){Ce.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function qi(t,e){var r=!0;return Qa(function(){if(Ce.deprecationHandler!=null&&Ce.deprecationHandler(null,t),r){var n=[],i,s,o,a=arguments.length;for(s=0;s<a;s++){if(i="",typeof arguments[s]=="object"){i+=`
[`+s+"] ";for(o in arguments[0])Ot(arguments[0],o)&&(i+=o+": "+arguments[0][o]+", ");i=i.slice(0,-2)}else i=arguments[s];n.push(i)}xP(t+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return e.apply(this,arguments)},e)}var w_={};function RP(t,e){Ce.deprecationHandler!=null&&Ce.deprecationHandler(t,e),w_[t]||(xP(e),w_[t]=!0)}Ce.suppressDeprecationWarnings=!1;Ce.deprecationHandler=null;function Eo(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function jU(t){var e,r;for(r in t)Ot(t,r)&&(e=t[r],Eo(e)?this[r]=e:this["_"+r]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function Ky(t,e){var r=Qa({},t),n;for(n in e)Ot(e,n)&&(Tu(t[n])&&Tu(e[n])?(r[n]={},Qa(r[n],t[n]),Qa(r[n],e[n])):e[n]!=null?r[n]=e[n]:delete r[n]);for(n in t)Ot(t,n)&&!Ot(e,n)&&Tu(t[n])&&(r[n]=Qa({},r[n]));return r}function bb(t){t!=null&&this.set(t)}var Xy;Object.keys?Xy=Object.keys:Xy=function(t){var e,r=[];for(e in t)Ot(t,e)&&r.push(e);return r};var zU={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function YU(t,e,r){var n=this._calendar[t]||this._calendar.sameElse;return Eo(n)?n.call(e,r):n}function wo(t,e,r){var n=""+Math.abs(t),i=e-n.length,s=t>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+n}var xb=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,em=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,RC={},nh={};function Ke(t,e,r,n){var i=n;typeof n=="string"&&(i=function(){return this[n]()}),t&&(nh[t]=i),e&&(nh[e[0]]=function(){return wo(i.apply(this,arguments),e[1],e[2])}),r&&(nh[r]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function GU(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function KU(t){var e=t.match(xb),r,n;for(r=0,n=e.length;r<n;r++)nh[e[r]]?e[r]=nh[e[r]]:e[r]=GU(e[r]);return function(i){var s="",o;for(o=0;o<n;o++)s+=Eo(e[o])?e[o].call(i,t):e[o];return s}}function Yp(t,e){return t.isValid()?(e=EP(e,t.localeData()),RC[e]=RC[e]||KU(e),RC[e](t)):t.localeData().invalidDate()}function EP(t,e){var r=5;function n(i){return e.longDateFormat(i)||i}for(em.lastIndex=0;r>=0&&em.test(t);)t=t.replace(em,n),em.lastIndex=0,r-=1;return t}var XU={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function qU(t){var e=this._longDateFormat[t],r=this._longDateFormat[t.toUpperCase()];return e||!r?e:(this._longDateFormat[t]=r.match(xb).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[t])}var ZU="Invalid date";function JU(){return this._invalidDate}var QU="%d",e6=/\d{1,2}/;function t6(t){return this._ordinal.replace("%d",t)}var r6={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function n6(t,e,r,n){var i=this._relativeTime[r];return Eo(i)?i(t,e,r,n):i.replace(/%d/i,t)}function i6(t,e){var r=this._relativeTime[t>0?"future":"past"];return Eo(r)?r(e):r.replace(/%s/i,e)}var v_={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Zi(t){return typeof t=="string"?v_[t]||v_[t.toLowerCase()]:void 0}function Rb(t){var e={},r,n;for(n in t)Ot(t,n)&&(r=Zi(n),r&&(e[r]=t[n]));return e}var s6={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function o6(t){var e=[],r;for(r in t)Ot(t,r)&&e.push({unit:r,priority:s6[r]});return e.sort(function(n,i){return n.priority-i.priority}),e}var TP=/\d/,Ti=/\d\d/,_P=/\d{3}/,Eb=/\d{4}/,Vw=/[+-]?\d{6}/,cr=/\d\d?/,AP=/\d\d\d\d?/,MP=/\d\d\d\d\d\d?/,Ww=/\d{1,3}/,Tb=/\d{1,4}/,Uw=/[+-]?\d{1,6}/,xh=/\d+/,jw=/[+-]?\d+/,a6=/Z|[+-]\d\d:?\d\d/gi,zw=/Z|[+-]\d\d(?::?\d\d)?/gi,l6=/[+-]?\d+(\.\d{1,3})?/,pg=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Rh=/^[1-9]\d?/,_b=/^([1-9]\d|\d)/,S0;S0={};function Fe(t,e,r){S0[t]=Eo(e)?e:function(n,i){return n&&r?r:e}}function u6(t,e){return Ot(S0,t)?S0[t](e._strict,e._locale):new RegExp(c6(t))}function c6(t){return sa(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,r,n,i,s){return r||n||i||s}))}function sa(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Wi(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function xt(t){var e=+t,r=0;return e!==0&&isFinite(e)&&(r=Wi(e)),r}var qy={};function qt(t,e){var r,n=e,i;for(typeof t=="string"&&(t=[t]),ca(e)&&(n=function(s,o){o[e]=xt(s)}),i=t.length,r=0;r<i;r++)qy[t[r]]=n}function wg(t,e){qt(t,function(r,n,i,s){i._w=i._w||{},e(r,i._w,i,s)})}function h6(t,e,r){e!=null&&Ot(qy,t)&&qy[t](e,r._a,r,t)}function Yw(t){return t%4===0&&t%100!==0||t%400===0}var En=0,Jo=1,uo=2,Xr=3,ys=4,Qo=5,wu=6,d6=7,f6=8;Ke("Y",0,0,function(){var t=this.year();return t<=9999?wo(t,4):"+"+t});Ke(0,["YY",2],0,function(){return this.year()%100});Ke(0,["YYYY",4],0,"year");Ke(0,["YYYYY",5],0,"year");Ke(0,["YYYYYY",6,!0],0,"year");Fe("Y",jw);Fe("YY",cr,Ti);Fe("YYYY",Tb,Eb);Fe("YYYYY",Uw,Vw);Fe("YYYYYY",Uw,Vw);qt(["YYYYY","YYYYYY"],En);qt("YYYY",function(t,e){e[En]=t.length===2?Ce.parseTwoDigitYear(t):xt(t)});qt("YY",function(t,e){e[En]=Ce.parseTwoDigitYear(t)});qt("Y",function(t,e){e[En]=parseInt(t,10)});function Jd(t){return Yw(t)?366:365}Ce.parseTwoDigitYear=function(t){return xt(t)+(xt(t)>68?1900:2e3)};var OP=Eh("FullYear",!0);function g6(){return Yw(this.year())}function Eh(t,e){return function(r){return r!=null?(IP(this,t,r),Ce.updateOffset(this,e),this):Pf(this,t)}}function Pf(t,e){if(!t.isValid())return NaN;var r=t._d,n=t._isUTC;switch(e){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function IP(t,e,r){var n,i,s,o,a;if(!(!t.isValid()||isNaN(r))){switch(n=t._d,i=t._isUTC,e){case"Milliseconds":return void(i?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(i?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(i?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(i?n.setUTCHours(r):n.setHours(r));case"Date":return void(i?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,o=t.month(),a=t.date(),a=a===29&&o===1&&!Yw(s)?28:a,i?n.setUTCFullYear(s,o,a):n.setFullYear(s,o,a)}}function m6(t){return t=Zi(t),Eo(this[t])?this[t]():this}function p6(t,e){if(typeof t=="object"){t=Rb(t);var r=o6(t),n,i=r.length;for(n=0;n<i;n++)this[r[n].unit](t[r[n].unit])}else if(t=Zi(t),Eo(this[t]))return this[t](e);return this}function w6(t,e){return(t%e+e)%e}var Nr;Array.prototype.indexOf?Nr=Array.prototype.indexOf:Nr=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function Ab(t,e){if(isNaN(t)||isNaN(e))return NaN;var r=w6(e,12);return t+=(e-r)/12,r===1?Yw(t)?29:28:31-r%7%2}Ke("M",["MM",2],"Mo",function(){return this.month()+1});Ke("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ke("MMMM",0,0,function(t){return this.localeData().months(this,t)});Fe("M",cr,Rh);Fe("MM",cr,Ti);Fe("MMM",function(t,e){return e.monthsShortRegex(t)});Fe("MMMM",function(t,e){return e.monthsRegex(t)});qt(["M","MM"],function(t,e){e[Jo]=xt(t)-1});qt(["MMM","MMMM"],function(t,e,r,n){var i=r._locale.monthsParse(t,n,r._strict);i!=null?e[Jo]=i:dt(r).invalidMonth=t});var v6="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),PP="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),NP=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,C6=pg,S6=pg;function y6(t,e){return t?Ts(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||NP).test(e)?"format":"standalone"][t.month()]:Ts(this._months)?this._months:this._months.standalone}function b6(t,e){return t?Ts(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[NP.test(e)?"format":"standalone"][t.month()]:Ts(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function x6(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Ro([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?e==="MMM"?(i=Nr.call(this._shortMonthsParse,o),i!==-1?i:null):(i=Nr.call(this._longMonthsParse,o),i!==-1?i:null):e==="MMM"?(i=Nr.call(this._shortMonthsParse,o),i!==-1?i:(i=Nr.call(this._longMonthsParse,o),i!==-1?i:null)):(i=Nr.call(this._longMonthsParse,o),i!==-1?i:(i=Nr.call(this._shortMonthsParse,o),i!==-1?i:null))}function R6(t,e,r){var n,i,s;if(this._monthsParseExact)return x6.call(this,t,e,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(i=Ro([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="MMMM"&&this._longMonthsParse[n].test(t))return n;if(r&&e==="MMM"&&this._shortMonthsParse[n].test(t))return n;if(!r&&this._monthsParse[n].test(t))return n}}function DP(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=xt(e);else if(e=t.localeData().monthsParse(e),!ca(e))return t}var r=e,n=t.date();return n=n<29?n:Math.min(n,Ab(t.year(),r)),t._isUTC?t._d.setUTCMonth(r,n):t._d.setMonth(r,n),t}function HP(t){return t!=null?(DP(this,t),Ce.updateOffset(this,!0),this):Pf(this,"Month")}function E6(){return Ab(this.year(),this.month())}function T6(t){return this._monthsParseExact?(Ot(this,"_monthsRegex")||kP.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Ot(this,"_monthsShortRegex")||(this._monthsShortRegex=C6),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function _6(t){return this._monthsParseExact?(Ot(this,"_monthsRegex")||kP.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Ot(this,"_monthsRegex")||(this._monthsRegex=S6),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function kP(){function t(l,u){return u.length-l.length}var e=[],r=[],n=[],i,s,o,a;for(i=0;i<12;i++)s=Ro([2e3,i]),o=sa(this.monthsShort(s,"")),a=sa(this.months(s,"")),e.push(o),r.push(a),n.push(a),n.push(o);e.sort(t),r.sort(t),n.sort(t),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function A6(t,e,r,n,i,s,o){var a;return t<100&&t>=0?(a=new Date(t+400,e,r,n,i,s,o),isFinite(a.getFullYear())&&a.setFullYear(t)):a=new Date(t,e,r,n,i,s,o),a}function Nf(t){var e,r;return t<100&&t>=0?(r=Array.prototype.slice.call(arguments),r[0]=t+400,e=new Date(Date.UTC.apply(null,r)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function y0(t,e,r){var n=7+e-r,i=(7+Nf(t,0,n).getUTCDay()-e)%7;return-i+n-1}function FP(t,e,r,n,i){var s=(7+r-n)%7,o=y0(t,n,i),a=1+7*(e-1)+s+o,l,u;return a<=0?(l=t-1,u=Jd(l)+a):a>Jd(t)?(l=t+1,u=a-Jd(t)):(l=t,u=a),{year:l,dayOfYear:u}}function Df(t,e,r){var n=y0(t.year(),e,r),i=Math.floor((t.dayOfYear()-n-1)/7)+1,s,o;return i<1?(o=t.year()-1,s=i+oa(o,e,r)):i>oa(t.year(),e,r)?(s=i-oa(t.year(),e,r),o=t.year()+1):(o=t.year(),s=i),{week:s,year:o}}function oa(t,e,r){var n=y0(t,e,r),i=y0(t+1,e,r);return(Jd(t)-n+i)/7}Ke("w",["ww",2],"wo","week");Ke("W",["WW",2],"Wo","isoWeek");Fe("w",cr,Rh);Fe("ww",cr,Ti);Fe("W",cr,Rh);Fe("WW",cr,Ti);wg(["w","ww","W","WW"],function(t,e,r,n){e[n.substr(0,1)]=xt(t)});function M6(t){return Df(t,this._week.dow,this._week.doy).week}var O6={dow:0,doy:6};function I6(){return this._week.dow}function P6(){return this._week.doy}function N6(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function D6(t){var e=Df(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ke("d",0,"do","day");Ke("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ke("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ke("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ke("e",0,0,"weekday");Ke("E",0,0,"isoWeekday");Fe("d",cr);Fe("e",cr);Fe("E",cr);Fe("dd",function(t,e){return e.weekdaysMinRegex(t)});Fe("ddd",function(t,e){return e.weekdaysShortRegex(t)});Fe("dddd",function(t,e){return e.weekdaysRegex(t)});wg(["dd","ddd","dddd"],function(t,e,r,n){var i=r._locale.weekdaysParse(t,n,r._strict);i!=null?e.d=i:dt(r).invalidWeekday=t});wg(["d","e","E"],function(t,e,r,n){e[n]=xt(t)});function H6(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function k6(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Mb(t,e){return t.slice(e,7).concat(t.slice(0,e))}var F6="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),LP="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),L6="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),$6=pg,B6=pg,V6=pg;function W6(t,e){var r=Ts(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?Mb(r,this._week.dow):t?r[t.day()]:r}function U6(t){return t===!0?Mb(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function j6(t){return t===!0?Mb(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function z6(t,e,r){var n,i,s,o=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Ro([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?e==="dddd"?(i=Nr.call(this._weekdaysParse,o),i!==-1?i:null):e==="ddd"?(i=Nr.call(this._shortWeekdaysParse,o),i!==-1?i:null):(i=Nr.call(this._minWeekdaysParse,o),i!==-1?i:null):e==="dddd"?(i=Nr.call(this._weekdaysParse,o),i!==-1||(i=Nr.call(this._shortWeekdaysParse,o),i!==-1)?i:(i=Nr.call(this._minWeekdaysParse,o),i!==-1?i:null)):e==="ddd"?(i=Nr.call(this._shortWeekdaysParse,o),i!==-1||(i=Nr.call(this._weekdaysParse,o),i!==-1)?i:(i=Nr.call(this._minWeekdaysParse,o),i!==-1?i:null)):(i=Nr.call(this._minWeekdaysParse,o),i!==-1||(i=Nr.call(this._weekdaysParse,o),i!==-1)?i:(i=Nr.call(this._shortWeekdaysParse,o),i!==-1?i:null))}function Y6(t,e,r){var n,i,s;if(this._weekdaysParseExact)return z6.call(this,t,e,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(i=Ro([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(i,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(i,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(i,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&e==="dddd"&&this._fullWeekdaysParse[n].test(t))return n;if(r&&e==="ddd"&&this._shortWeekdaysParse[n].test(t))return n;if(r&&e==="dd"&&this._minWeekdaysParse[n].test(t))return n;if(!r&&this._weekdaysParse[n].test(t))return n}}function G6(t){if(!this.isValid())return t!=null?this:NaN;var e=Pf(this,"Day");return t!=null?(t=H6(t,this.localeData()),this.add(t-e,"d")):e}function K6(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function X6(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=k6(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function q6(t){return this._weekdaysParseExact?(Ot(this,"_weekdaysRegex")||Ob.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Ot(this,"_weekdaysRegex")||(this._weekdaysRegex=$6),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Z6(t){return this._weekdaysParseExact?(Ot(this,"_weekdaysRegex")||Ob.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ot(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=B6),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function J6(t){return this._weekdaysParseExact?(Ot(this,"_weekdaysRegex")||Ob.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ot(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=V6),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ob(){function t(c,h){return h.length-c.length}var e=[],r=[],n=[],i=[],s,o,a,l,u;for(s=0;s<7;s++)o=Ro([2e3,1]).day(s),a=sa(this.weekdaysMin(o,"")),l=sa(this.weekdaysShort(o,"")),u=sa(this.weekdays(o,"")),e.push(a),r.push(l),n.push(u),i.push(a),i.push(l),i.push(u);e.sort(t),r.sort(t),n.sort(t),i.sort(t),this._weekdaysRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function Ib(){return this.hours()%12||12}function Q6(){return this.hours()||24}Ke("H",["HH",2],0,"hour");Ke("h",["hh",2],0,Ib);Ke("k",["kk",2],0,Q6);Ke("hmm",0,0,function(){return""+Ib.apply(this)+wo(this.minutes(),2)});Ke("hmmss",0,0,function(){return""+Ib.apply(this)+wo(this.minutes(),2)+wo(this.seconds(),2)});Ke("Hmm",0,0,function(){return""+this.hours()+wo(this.minutes(),2)});Ke("Hmmss",0,0,function(){return""+this.hours()+wo(this.minutes(),2)+wo(this.seconds(),2)});function $P(t,e){Ke(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}$P("a",!0);$P("A",!1);function BP(t,e){return e._meridiemParse}Fe("a",BP);Fe("A",BP);Fe("H",cr,_b);Fe("h",cr,Rh);Fe("k",cr,Rh);Fe("HH",cr,Ti);Fe("hh",cr,Ti);Fe("kk",cr,Ti);Fe("hmm",AP);Fe("hmmss",MP);Fe("Hmm",AP);Fe("Hmmss",MP);qt(["H","HH"],Xr);qt(["k","kk"],function(t,e,r){var n=xt(t);e[Xr]=n===24?0:n});qt(["a","A"],function(t,e,r){r._isPm=r._locale.isPM(t),r._meridiem=t});qt(["h","hh"],function(t,e,r){e[Xr]=xt(t),dt(r).bigHour=!0});qt("hmm",function(t,e,r){var n=t.length-2;e[Xr]=xt(t.substr(0,n)),e[ys]=xt(t.substr(n)),dt(r).bigHour=!0});qt("hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Xr]=xt(t.substr(0,n)),e[ys]=xt(t.substr(n,2)),e[Qo]=xt(t.substr(i)),dt(r).bigHour=!0});qt("Hmm",function(t,e,r){var n=t.length-2;e[Xr]=xt(t.substr(0,n)),e[ys]=xt(t.substr(n))});qt("Hmmss",function(t,e,r){var n=t.length-4,i=t.length-2;e[Xr]=xt(t.substr(0,n)),e[ys]=xt(t.substr(n,2)),e[Qo]=xt(t.substr(i))});function e8(t){return(t+"").toLowerCase().charAt(0)==="p"}var t8=/[ap]\.?m?\.?/i,r8=Eh("Hours",!0);function n8(t,e,r){return t>11?r?"pm":"PM":r?"am":"AM"}var VP={calendar:zU,longDateFormat:XU,invalidDate:ZU,ordinal:QU,dayOfMonthOrdinalParse:e6,relativeTime:r6,months:v6,monthsShort:PP,week:O6,weekdays:F6,weekdaysMin:L6,weekdaysShort:LP,meridiemParse:t8},fr={},Uh={},Hf;function i8(t,e){var r,n=Math.min(t.length,e.length);for(r=0;r<n;r+=1)if(t[r]!==e[r])return r;return n}function C_(t){return t&&t.toLowerCase().replace("_","-")}function s8(t){for(var e=0,r,n,i,s;e<t.length;){for(s=C_(t[e]).split("-"),r=s.length,n=C_(t[e+1]),n=n?n.split("-"):null;r>0;){if(i=Gw(s.slice(0,r).join("-")),i)return i;if(n&&n.length>=r&&i8(s,n)>=r-1)break;r--}e++}return Hf}function o8(t){return!!(t&&t.match("^[^/\\\\]*$"))}function Gw(t){var e=null,r;if(fr[t]===void 0&&typeof module<"u"&&module&&module.exports&&o8(t))try{e=Hf._abbr,r=require,r("./locale/"+t),al(e)}catch{fr[t]=null}return fr[t]}function al(t,e){var r;return t&&(Zn(e)?r=wa(t):r=Pb(t,e),r?Hf=r:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Hf._abbr}function Pb(t,e){if(e!==null){var r,n=VP;if(e.abbr=t,fr[t]!=null)RP("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=fr[t]._config;else if(e.parentLocale!=null)if(fr[e.parentLocale]!=null)n=fr[e.parentLocale]._config;else if(r=Gw(e.parentLocale),r!=null)n=r._config;else return Uh[e.parentLocale]||(Uh[e.parentLocale]=[]),Uh[e.parentLocale].push({name:t,config:e}),null;return fr[t]=new bb(Ky(n,e)),Uh[t]&&Uh[t].forEach(function(i){Pb(i.name,i.config)}),al(t),fr[t]}else return delete fr[t],null}function a8(t,e){if(e!=null){var r,n,i=VP;fr[t]!=null&&fr[t].parentLocale!=null?fr[t].set(Ky(fr[t]._config,e)):(n=Gw(t),n!=null&&(i=n._config),e=Ky(i,e),n==null&&(e.abbr=t),r=new bb(e),r.parentLocale=fr[t],fr[t]=r),al(t)}else fr[t]!=null&&(fr[t].parentLocale!=null?(fr[t]=fr[t].parentLocale,t===al()&&al(t)):fr[t]!=null&&delete fr[t]);return fr[t]}function wa(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Hf;if(!Ts(t)){if(e=Gw(t),e)return e;t=[t]}return s8(t)}function l8(){return Xy(fr)}function Nb(t){var e,r=t._a;return r&&dt(t).overflow===-2&&(e=r[Jo]<0||r[Jo]>11?Jo:r[uo]<1||r[uo]>Ab(r[En],r[Jo])?uo:r[Xr]<0||r[Xr]>24||r[Xr]===24&&(r[ys]!==0||r[Qo]!==0||r[wu]!==0)?Xr:r[ys]<0||r[ys]>59?ys:r[Qo]<0||r[Qo]>59?Qo:r[wu]<0||r[wu]>999?wu:-1,dt(t)._overflowDayOfYear&&(e<En||e>uo)&&(e=uo),dt(t)._overflowWeeks&&e===-1&&(e=d6),dt(t)._overflowWeekday&&e===-1&&(e=f6),dt(t).overflow=e),t}var u8=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,c8=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,h8=/Z|[+-]\d\d(?::?\d\d)?/,tm=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],EC=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],d8=/^\/?Date\((-?\d+)/i,f8=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,g8={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function WP(t){var e,r,n=t._i,i=u8.exec(n)||c8.exec(n),s,o,a,l,u=tm.length,c=EC.length;if(i){for(dt(t).iso=!0,e=0,r=u;e<r;e++)if(tm[e][1].exec(i[1])){o=tm[e][0],s=tm[e][2]!==!1;break}if(o==null){t._isValid=!1;return}if(i[3]){for(e=0,r=c;e<r;e++)if(EC[e][1].exec(i[3])){a=(i[2]||" ")+EC[e][0];break}if(a==null){t._isValid=!1;return}}if(!s&&a!=null){t._isValid=!1;return}if(i[4])if(h8.exec(i[4]))l="Z";else{t._isValid=!1;return}t._f=o+(a||"")+(l||""),Hb(t)}else t._isValid=!1}function m8(t,e,r,n,i,s){var o=[p8(t),PP.indexOf(e),parseInt(r,10),parseInt(n,10),parseInt(i,10)];return s&&o.push(parseInt(s,10)),o}function p8(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function w8(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function v8(t,e,r){if(t){var n=LP.indexOf(t),i=new Date(e[0],e[1],e[2]).getDay();if(n!==i)return dt(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function C8(t,e,r){if(t)return g8[t];if(e)return 0;var n=parseInt(r,10),i=n%100,s=(n-i)/100;return s*60+i}function UP(t){var e=f8.exec(w8(t._i)),r;if(e){if(r=m8(e[4],e[3],e[2],e[5],e[6],e[7]),!v8(e[1],r,t))return;t._a=r,t._tzm=C8(e[8],e[9],e[10]),t._d=Nf.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),dt(t).rfc2822=!0}else t._isValid=!1}function S8(t){var e=d8.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(WP(t),t._isValid===!1)delete t._isValid;else return;if(UP(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Ce.createFromInputFallback(t)}Ce.createFromInputFallback=qi("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function jc(t,e,r){return t??e??r}function y8(t){var e=new Date(Ce.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function Db(t){var e,r,n=[],i,s,o;if(!t._d){for(i=y8(t),t._w&&t._a[uo]==null&&t._a[Jo]==null&&b8(t),t._dayOfYear!=null&&(o=jc(t._a[En],i[En]),(t._dayOfYear>Jd(o)||t._dayOfYear===0)&&(dt(t)._overflowDayOfYear=!0),r=Nf(o,0,t._dayOfYear),t._a[Jo]=r.getUTCMonth(),t._a[uo]=r.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=n[e]=i[e];for(;e<7;e++)t._a[e]=n[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Xr]===24&&t._a[ys]===0&&t._a[Qo]===0&&t._a[wu]===0&&(t._nextDay=!0,t._a[Xr]=0),t._d=(t._useUTC?Nf:A6).apply(null,n),s=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Xr]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==s&&(dt(t).weekdayMismatch=!0)}}function b8(t){var e,r,n,i,s,o,a,l,u;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(s=1,o=4,r=jc(e.GG,t._a[En],Df(lr(),1,4).year),n=jc(e.W,1),i=jc(e.E,1),(i<1||i>7)&&(l=!0)):(s=t._locale._week.dow,o=t._locale._week.doy,u=Df(lr(),s,o),r=jc(e.gg,t._a[En],u.year),n=jc(e.w,u.week),e.d!=null?(i=e.d,(i<0||i>6)&&(l=!0)):e.e!=null?(i=e.e+s,(e.e<0||e.e>6)&&(l=!0)):i=s),n<1||n>oa(r,s,o)?dt(t)._overflowWeeks=!0:l!=null?dt(t)._overflowWeekday=!0:(a=FP(r,n,i,s,o),t._a[En]=a.year,t._dayOfYear=a.dayOfYear)}Ce.ISO_8601=function(){};Ce.RFC_2822=function(){};function Hb(t){if(t._f===Ce.ISO_8601){WP(t);return}if(t._f===Ce.RFC_2822){UP(t);return}t._a=[],dt(t).empty=!0;var e=""+t._i,r,n,i,s,o,a=e.length,l=0,u,c;for(i=EP(t._f,t._locale).match(xb)||[],c=i.length,r=0;r<c;r++)s=i[r],n=(e.match(u6(s,t))||[])[0],n&&(o=e.substr(0,e.indexOf(n)),o.length>0&&dt(t).unusedInput.push(o),e=e.slice(e.indexOf(n)+n.length),l+=n.length),nh[s]?(n?dt(t).empty=!1:dt(t).unusedTokens.push(s),h6(s,n,t)):t._strict&&!n&&dt(t).unusedTokens.push(s);dt(t).charsLeftOver=a-l,e.length>0&&dt(t).unusedInput.push(e),t._a[Xr]<=12&&dt(t).bigHour===!0&&t._a[Xr]>0&&(dt(t).bigHour=void 0),dt(t).parsedDateParts=t._a.slice(0),dt(t).meridiem=t._meridiem,t._a[Xr]=x8(t._locale,t._a[Xr],t._meridiem),u=dt(t).era,u!==null&&(t._a[En]=t._locale.erasConvertYear(u,t._a[En])),Db(t),Nb(t)}function x8(t,e,r){var n;return r==null?e:t.meridiemHour!=null?t.meridiemHour(e,r):(t.isPM!=null&&(n=t.isPM(r),n&&e<12&&(e+=12),!n&&e===12&&(e=0)),e)}function R8(t){var e,r,n,i,s,o,a=!1,l=t._f.length;if(l===0){dt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(i=0;i<l;i++)s=0,o=!1,e=yb({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[i],Hb(e),Sb(e)&&(o=!0),s+=dt(e).charsLeftOver,s+=dt(e).unusedTokens.length*10,dt(e).score=s,a?s<n&&(n=s,r=e):(n==null||s<n||o)&&(n=s,r=e,o&&(a=!0));Qa(t,r||e)}function E8(t){if(!t._d){var e=Rb(t._i),r=e.day===void 0?e.date:e.day;t._a=bP([e.year,e.month,r,e.hour,e.minute,e.second,e.millisecond],function(n){return n&&parseInt(n,10)}),Db(t)}}function T8(t){var e=new mg(Nb(jP(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function jP(t){var e=t._i,r=t._f;return t._locale=t._locale||wa(t._l),e===null||r===void 0&&e===""?Bw({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),_s(e)?new mg(Nb(e)):(gg(e)?t._d=e:Ts(r)?R8(t):r?Hb(t):_8(t),Sb(t)||(t._d=null),t))}function _8(t){var e=t._i;Zn(e)?t._d=new Date(Ce.now()):gg(e)?t._d=new Date(e.valueOf()):typeof e=="string"?S8(t):Ts(e)?(t._a=bP(e.slice(0),function(r){return parseInt(r,10)}),Db(t)):Tu(e)?E8(t):ca(e)?t._d=new Date(e):Ce.createFromInputFallback(t)}function zP(t,e,r,n,i){var s={};return(e===!0||e===!1)&&(n=e,e=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Tu(t)&&Cb(t)||Ts(t)&&t.length===0)&&(t=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=i,s._l=r,s._i=t,s._f=e,s._strict=n,T8(s)}function lr(t,e,r,n){return zP(t,e,r,n,!1)}var A8=qi("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=lr.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:Bw()}),M8=qi("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=lr.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:Bw()});function YP(t,e){var r,n;if(e.length===1&&Ts(e[0])&&(e=e[0]),!e.length)return lr();for(r=e[0],n=1;n<e.length;++n)(!e[n].isValid()||e[n][t](r))&&(r=e[n]);return r}function O8(){var t=[].slice.call(arguments,0);return YP("isBefore",t)}function I8(){var t=[].slice.call(arguments,0);return YP("isAfter",t)}var P8=function(){return Date.now?Date.now():+new Date},jh=["year","quarter","month","week","day","hour","minute","second","millisecond"];function N8(t){var e,r=!1,n,i=jh.length;for(e in t)if(Ot(t,e)&&!(Nr.call(jh,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(n=0;n<i;++n)if(t[jh[n]]){if(r)return!1;parseFloat(t[jh[n]])!==xt(t[jh[n]])&&(r=!0)}return!0}function D8(){return this._isValid}function H8(){return Ps(NaN)}function Kw(t){var e=Rb(t),r=e.year||0,n=e.quarter||0,i=e.month||0,s=e.week||e.isoWeek||0,o=e.day||0,a=e.hour||0,l=e.minute||0,u=e.second||0,c=e.millisecond||0;this._isValid=N8(e),this._milliseconds=+c+u*1e3+l*6e4+a*1e3*60*60,this._days=+o+s*7,this._months=+i+n*3+r*12,this._data={},this._locale=wa(),this._bubble()}function Gp(t){return t instanceof Kw}function Zy(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function k8(t,e,r){var n=Math.min(t.length,e.length),i=Math.abs(t.length-e.length),s=0,o;for(o=0;o<n;o++)xt(t[o])!==xt(e[o])&&s++;return s+i}function GP(t,e){Ke(t,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+wo(~~(r/60),2)+e+wo(~~r%60,2)})}GP("Z",":");GP("ZZ","");Fe("Z",zw);Fe("ZZ",zw);qt(["Z","ZZ"],function(t,e,r){r._useUTC=!0,r._tzm=kb(zw,t)});var F8=/([\+\-]|\d\d)/gi;function kb(t,e){var r=(e||"").match(t),n,i,s;return r===null?null:(n=r[r.length-1]||[],i=(n+"").match(F8)||["-",0,0],s=+(i[1]*60)+xt(i[2]),s===0?0:i[0]==="+"?s:-s)}function Fb(t,e){var r,n;return e._isUTC?(r=e.clone(),n=(_s(t)||gg(t)?t.valueOf():lr(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),Ce.updateOffset(r,!1),r):lr(t).local()}function Jy(t){return-Math.round(t._d.getTimezoneOffset())}Ce.updateOffset=function(){};function L8(t,e,r){var n=this._offset||0,i;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=kb(zw,t),t===null)return this}else Math.abs(t)<16&&!r&&(t=t*60);return!this._isUTC&&e&&(i=Jy(this)),this._offset=t,this._isUTC=!0,i!=null&&this.add(i,"m"),n!==t&&(!e||this._changeInProgress?qP(this,Ps(t-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ce.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:Jy(this)}function $8(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function B8(t){return this.utcOffset(0,t)}function V8(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Jy(this),"m")),this}function W8(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=kb(a6,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function U8(t){return this.isValid()?(t=t?lr(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function j8(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function z8(){if(!Zn(this._isDSTShifted))return this._isDSTShifted;var t={},e;return yb(t,this),t=jP(t),t._a?(e=t._isUTC?Ro(t._a):lr(t._a),this._isDSTShifted=this.isValid()&&k8(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function Y8(){return this.isValid()?!this._isUTC:!1}function G8(){return this.isValid()?this._isUTC:!1}function KP(){return this.isValid()?this._isUTC&&this._offset===0:!1}var K8=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,X8=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function Ps(t,e){var r=t,n=null,i,s,o;return Gp(t)?r={ms:t._milliseconds,d:t._days,M:t._months}:ca(t)||!isNaN(+t)?(r={},e?r[e]=+t:r.milliseconds=+t):(n=K8.exec(t))?(i=n[1]==="-"?-1:1,r={y:0,d:xt(n[uo])*i,h:xt(n[Xr])*i,m:xt(n[ys])*i,s:xt(n[Qo])*i,ms:xt(Zy(n[wu]*1e3))*i}):(n=X8.exec(t))?(i=n[1]==="-"?-1:1,r={y:Ml(n[2],i),M:Ml(n[3],i),w:Ml(n[4],i),d:Ml(n[5],i),h:Ml(n[6],i),m:Ml(n[7],i),s:Ml(n[8],i)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(o=q8(lr(r.from),lr(r.to)),r={},r.ms=o.milliseconds,r.M=o.months),s=new Kw(r),Gp(t)&&Ot(t,"_locale")&&(s._locale=t._locale),Gp(t)&&Ot(t,"_isValid")&&(s._isValid=t._isValid),s}Ps.fn=Kw.prototype;Ps.invalid=H8;function Ml(t,e){var r=t&&parseFloat(t.replace(",","."));return(isNaN(r)?0:r)*e}function S_(t,e){var r={};return r.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(r.months,"M").isAfter(e)&&--r.months,r.milliseconds=+e-+t.clone().add(r.months,"M"),r}function q8(t,e){var r;return t.isValid()&&e.isValid()?(e=Fb(e,t),t.isBefore(e)?r=S_(t,e):(r=S_(e,t),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function XP(t,e){return function(r,n){var i,s;return n!==null&&!isNaN(+n)&&(RP(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),i=Ps(r,n),qP(this,i,t),this}}function qP(t,e,r,n){var i=e._milliseconds,s=Zy(e._days),o=Zy(e._months);t.isValid()&&(n=n??!0,o&&DP(t,Pf(t,"Month")+o*r),s&&IP(t,"Date",Pf(t,"Date")+s*r),i&&t._d.setTime(t._d.valueOf()+i*r),n&&Ce.updateOffset(t,s||o))}var Z8=XP(1,"add"),J8=XP(-1,"subtract");function ZP(t){return typeof t=="string"||t instanceof String}function Q8(t){return _s(t)||gg(t)||ZP(t)||ca(t)||tj(t)||ej(t)||t===null||t===void 0}function ej(t){var e=Tu(t)&&!Cb(t),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],i,s,o=n.length;for(i=0;i<o;i+=1)s=n[i],r=r||Ot(t,s);return e&&r}function tj(t){var e=Ts(t),r=!1;return e&&(r=t.filter(function(n){return!ca(n)&&ZP(t)}).length===0),e&&r}function rj(t){var e=Tu(t)&&!Cb(t),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],i,s;for(i=0;i<n.length;i+=1)s=n[i],r=r||Ot(t,s);return e&&r}function nj(t,e){var r=t.diff(e,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function ij(t,e){arguments.length===1&&(arguments[0]?Q8(arguments[0])?(t=arguments[0],e=void 0):rj(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var r=t||lr(),n=Fb(r,this).startOf("day"),i=Ce.calendarFormat(this,n)||"sameElse",s=e&&(Eo(e[i])?e[i].call(this,r):e[i]);return this.format(s||this.localeData().calendar(i,this,lr(r)))}function sj(){return new mg(this)}function oj(t,e){var r=_s(t)?t:lr(t);return this.isValid()&&r.isValid()?(e=Zi(e)||"millisecond",e==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(e).valueOf()):!1}function aj(t,e){var r=_s(t)?t:lr(t);return this.isValid()&&r.isValid()?(e=Zi(e)||"millisecond",e==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(e).valueOf()<r.valueOf()):!1}function lj(t,e,r,n){var i=_s(t)?t:lr(t),s=_s(e)?e:lr(e);return this.isValid()&&i.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(i,r):!this.isBefore(i,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function uj(t,e){var r=_s(t)?t:lr(t),n;return this.isValid()&&r.isValid()?(e=Zi(e)||"millisecond",e==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf())):!1}function cj(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function hj(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function dj(t,e,r){var n,i,s;if(!this.isValid())return NaN;if(n=Fb(t,this),!n.isValid())return NaN;switch(i=(n.utcOffset()-this.utcOffset())*6e4,e=Zi(e),e){case"year":s=Kp(this,n)/12;break;case"month":s=Kp(this,n);break;case"quarter":s=Kp(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-i)/864e5;break;case"week":s=(this-n-i)/6048e5;break;default:s=this-n}return r?s:Wi(s)}function Kp(t,e){if(t.date()<e.date())return-Kp(e,t);var r=(e.year()-t.year())*12+(e.month()-t.month()),n=t.clone().add(r,"months"),i,s;return e-n<0?(i=t.clone().add(r-1,"months"),s=(e-n)/(n-i)):(i=t.clone().add(r+1,"months"),s=(e-n)/(i-n)),-(r+s)||0}Ce.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ce.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function fj(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function gj(t){if(!this.isValid())return null;var e=t!==!0,r=e?this.clone().utc():this;return r.year()<0||r.year()>9999?Yp(r,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Eo(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Yp(r,"Z")):Yp(r,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function mj(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",r,n,i,s;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),r="["+t+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i="-MM-DD[T]HH:mm:ss.SSS",s=e+'[")]',this.format(r+n+i+s)}function pj(t){t||(t=this.isUtc()?Ce.defaultFormatUtc:Ce.defaultFormat);var e=Yp(this,t);return this.localeData().postformat(e)}function wj(t,e){return this.isValid()&&(_s(t)&&t.isValid()||lr(t).isValid())?Ps({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function vj(t){return this.from(lr(),t)}function Cj(t,e){return this.isValid()&&(_s(t)&&t.isValid()||lr(t).isValid())?Ps({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function Sj(t){return this.to(lr(),t)}function JP(t){var e;return t===void 0?this._locale._abbr:(e=wa(t),e!=null&&(this._locale=e),this)}var QP=qi("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function eN(){return this._locale}var b0=1e3,ih=60*b0,x0=60*ih,tN=(365*400+97)*24*x0;function sh(t,e){return(t%e+e)%e}function rN(t,e,r){return t<100&&t>=0?new Date(t+400,e,r)-tN:new Date(t,e,r).valueOf()}function nN(t,e,r){return t<100&&t>=0?Date.UTC(t+400,e,r)-tN:Date.UTC(t,e,r)}function yj(t){var e,r;if(t=Zi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?nN:rN,t){case"year":e=r(this.year(),0,1);break;case"quarter":e=r(this.year(),this.month()-this.month()%3,1);break;case"month":e=r(this.year(),this.month(),1);break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=r(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=sh(e+(this._isUTC?0:this.utcOffset()*ih),x0);break;case"minute":e=this._d.valueOf(),e-=sh(e,ih);break;case"second":e=this._d.valueOf(),e-=sh(e,b0);break}return this._d.setTime(e),Ce.updateOffset(this,!0),this}function bj(t){var e,r;if(t=Zi(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?nN:rN,t){case"year":e=r(this.year()+1,0,1)-1;break;case"quarter":e=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=r(this.year(),this.month()+1,1)-1;break;case"week":e=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=x0-sh(e+(this._isUTC?0:this.utcOffset()*ih),x0)-1;break;case"minute":e=this._d.valueOf(),e+=ih-sh(e,ih)-1;break;case"second":e=this._d.valueOf(),e+=b0-sh(e,b0)-1;break}return this._d.setTime(e),Ce.updateOffset(this,!0),this}function xj(){return this._d.valueOf()-(this._offset||0)*6e4}function Rj(){return Math.floor(this.valueOf()/1e3)}function Ej(){return new Date(this.valueOf())}function Tj(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function _j(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Aj(){return this.isValid()?this.toISOString():null}function Mj(){return Sb(this)}function Oj(){return Qa({},dt(this))}function Ij(){return dt(this).overflow}function Pj(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ke("N",0,0,"eraAbbr");Ke("NN",0,0,"eraAbbr");Ke("NNN",0,0,"eraAbbr");Ke("NNNN",0,0,"eraName");Ke("NNNNN",0,0,"eraNarrow");Ke("y",["y",1],"yo","eraYear");Ke("y",["yy",2],0,"eraYear");Ke("y",["yyy",3],0,"eraYear");Ke("y",["yyyy",4],0,"eraYear");Fe("N",Lb);Fe("NN",Lb);Fe("NNN",Lb);Fe("NNNN",Uj);Fe("NNNNN",jj);qt(["N","NN","NNN","NNNN","NNNNN"],function(t,e,r,n){var i=r._locale.erasParse(t,n,r._strict);i?dt(r).era=i:dt(r).invalidEra=t});Fe("y",xh);Fe("yy",xh);Fe("yyy",xh);Fe("yyyy",xh);Fe("yo",zj);qt(["y","yy","yyy","yyyy"],En);qt(["yo"],function(t,e,r,n){var i;r._locale._eraYearOrdinalRegex&&(i=t.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?e[En]=r._locale.eraYearOrdinalParse(t,i):e[En]=parseInt(t,10)});function Nj(t,e){var r,n,i,s=this._eras||wa("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":i=Ce(s[r].since).startOf("day"),s[r].since=i.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":i=Ce(s[r].until).startOf("day").valueOf(),s[r].until=i.valueOf();break}}return s}function Dj(t,e,r){var n,i,s=this.eras(),o,a,l;for(t=t.toUpperCase(),n=0,i=s.length;n<i;++n)if(o=s[n].name.toUpperCase(),a=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(e){case"N":case"NN":case"NNN":if(a===t)return s[n];break;case"NNNN":if(o===t)return s[n];break;case"NNNNN":if(l===t)return s[n];break}else if([o,a,l].indexOf(t)>=0)return s[n]}function Hj(t,e){var r=t.since<=t.until?1:-1;return e===void 0?Ce(t.since).year():Ce(t.since).year()+(e-t.offset)*r}function kj(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].name;return""}function Fj(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].narrow;return""}function Lj(){var t,e,r,n=this.localeData().eras();for(t=0,e=n.length;t<e;++t)if(r=this.clone().startOf("day").valueOf(),n[t].since<=r&&r<=n[t].until||n[t].until<=r&&r<=n[t].since)return n[t].abbr;return""}function $j(){var t,e,r,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(r=i[t].since<=i[t].until?1:-1,n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return(this.year()-Ce(i[t].since).year())*r+i[t].offset;return this.year()}function Bj(t){return Ot(this,"_erasNameRegex")||$b.call(this),t?this._erasNameRegex:this._erasRegex}function Vj(t){return Ot(this,"_erasAbbrRegex")||$b.call(this),t?this._erasAbbrRegex:this._erasRegex}function Wj(t){return Ot(this,"_erasNarrowRegex")||$b.call(this),t?this._erasNarrowRegex:this._erasRegex}function Lb(t,e){return e.erasAbbrRegex(t)}function Uj(t,e){return e.erasNameRegex(t)}function jj(t,e){return e.erasNarrowRegex(t)}function zj(t,e){return e._eraYearOrdinalRegex||xh}function $b(){var t=[],e=[],r=[],n=[],i,s,o,a,l,u=this.eras();for(i=0,s=u.length;i<s;++i)o=sa(u[i].name),a=sa(u[i].abbr),l=sa(u[i].narrow),e.push(o),t.push(a),r.push(l),n.push(o),n.push(a),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Ke(0,["gg",2],0,function(){return this.weekYear()%100});Ke(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Xw(t,e){Ke(0,[t,t.length],0,e)}Xw("gggg","weekYear");Xw("ggggg","weekYear");Xw("GGGG","isoWeekYear");Xw("GGGGG","isoWeekYear");Fe("G",jw);Fe("g",jw);Fe("GG",cr,Ti);Fe("gg",cr,Ti);Fe("GGGG",Tb,Eb);Fe("gggg",Tb,Eb);Fe("GGGGG",Uw,Vw);Fe("ggggg",Uw,Vw);wg(["gggg","ggggg","GGGG","GGGGG"],function(t,e,r,n){e[n.substr(0,2)]=xt(t)});wg(["gg","GG"],function(t,e,r,n){e[n]=Ce.parseTwoDigitYear(t)});function Yj(t){return iN.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Gj(t){return iN.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Kj(){return oa(this.year(),1,4)}function Xj(){return oa(this.isoWeekYear(),1,4)}function qj(){var t=this.localeData()._week;return oa(this.year(),t.dow,t.doy)}function Zj(){var t=this.localeData()._week;return oa(this.weekYear(),t.dow,t.doy)}function iN(t,e,r,n,i){var s;return t==null?Df(this,n,i).year:(s=oa(t,n,i),e>s&&(e=s),Jj.call(this,t,e,r,n,i))}function Jj(t,e,r,n,i){var s=FP(t,e,r,n,i),o=Nf(s.year,0,s.dayOfYear);return this.year(o.getUTCFullYear()),this.month(o.getUTCMonth()),this.date(o.getUTCDate()),this}Ke("Q",0,"Qo","quarter");Fe("Q",TP);qt("Q",function(t,e){e[Jo]=(xt(t)-1)*3});function Qj(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ke("D",["DD",2],"Do","date");Fe("D",cr,Rh);Fe("DD",cr,Ti);Fe("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});qt(["D","DD"],uo);qt("Do",function(t,e){e[uo]=xt(t.match(cr)[0])});var sN=Eh("Date",!0);Ke("DDD",["DDDD",3],"DDDo","dayOfYear");Fe("DDD",Ww);Fe("DDDD",_P);qt(["DDD","DDDD"],function(t,e,r){r._dayOfYear=xt(t)});function e5(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ke("m",["mm",2],0,"minute");Fe("m",cr,_b);Fe("mm",cr,Ti);qt(["m","mm"],ys);var t5=Eh("Minutes",!1);Ke("s",["ss",2],0,"second");Fe("s",cr,_b);Fe("ss",cr,Ti);qt(["s","ss"],Qo);var r5=Eh("Seconds",!1);Ke("S",0,0,function(){return~~(this.millisecond()/100)});Ke(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ke(0,["SSS",3],0,"millisecond");Ke(0,["SSSS",4],0,function(){return this.millisecond()*10});Ke(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ke(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ke(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ke(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ke(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});Fe("S",Ww,TP);Fe("SS",Ww,Ti);Fe("SSS",Ww,_P);var el,oN;for(el="SSSS";el.length<=9;el+="S")Fe(el,xh);function n5(t,e){e[wu]=xt(("0."+t)*1e3)}for(el="S";el.length<=9;el+="S")qt(el,n5);oN=Eh("Milliseconds",!1);Ke("z",0,0,"zoneAbbr");Ke("zz",0,0,"zoneName");function i5(){return this._isUTC?"UTC":""}function s5(){return this._isUTC?"Coordinated Universal Time":""}var Re=mg.prototype;Re.add=Z8;Re.calendar=ij;Re.clone=sj;Re.diff=dj;Re.endOf=bj;Re.format=pj;Re.from=wj;Re.fromNow=vj;Re.to=Cj;Re.toNow=Sj;Re.get=m6;Re.invalidAt=Ij;Re.isAfter=oj;Re.isBefore=aj;Re.isBetween=lj;Re.isSame=uj;Re.isSameOrAfter=cj;Re.isSameOrBefore=hj;Re.isValid=Mj;Re.lang=QP;Re.locale=JP;Re.localeData=eN;Re.max=M8;Re.min=A8;Re.parsingFlags=Oj;Re.set=p6;Re.startOf=yj;Re.subtract=J8;Re.toArray=Tj;Re.toObject=_j;Re.toDate=Ej;Re.toISOString=gj;Re.inspect=mj;typeof Symbol<"u"&&Symbol.for!=null&&(Re[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Re.toJSON=Aj;Re.toString=fj;Re.unix=Rj;Re.valueOf=xj;Re.creationData=Pj;Re.eraName=kj;Re.eraNarrow=Fj;Re.eraAbbr=Lj;Re.eraYear=$j;Re.year=OP;Re.isLeapYear=g6;Re.weekYear=Yj;Re.isoWeekYear=Gj;Re.quarter=Re.quarters=Qj;Re.month=HP;Re.daysInMonth=E6;Re.week=Re.weeks=N6;Re.isoWeek=Re.isoWeeks=D6;Re.weeksInYear=qj;Re.weeksInWeekYear=Zj;Re.isoWeeksInYear=Kj;Re.isoWeeksInISOWeekYear=Xj;Re.date=sN;Re.day=Re.days=G6;Re.weekday=K6;Re.isoWeekday=X6;Re.dayOfYear=e5;Re.hour=Re.hours=r8;Re.minute=Re.minutes=t5;Re.second=Re.seconds=r5;Re.millisecond=Re.milliseconds=oN;Re.utcOffset=L8;Re.utc=B8;Re.local=V8;Re.parseZone=W8;Re.hasAlignedHourOffset=U8;Re.isDST=j8;Re.isLocal=Y8;Re.isUtcOffset=G8;Re.isUtc=KP;Re.isUTC=KP;Re.zoneAbbr=i5;Re.zoneName=s5;Re.dates=qi("dates accessor is deprecated. Use date instead.",sN);Re.months=qi("months accessor is deprecated. Use month instead",HP);Re.years=qi("years accessor is deprecated. Use year instead",OP);Re.zone=qi("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",$8);Re.isDSTShifted=qi("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",z8);function o5(t){return lr(t*1e3)}function a5(){return lr.apply(null,arguments).parseZone()}function aN(t){return t}var It=bb.prototype;It.calendar=YU;It.longDateFormat=qU;It.invalidDate=JU;It.ordinal=t6;It.preparse=aN;It.postformat=aN;It.relativeTime=n6;It.pastFuture=i6;It.set=jU;It.eras=Nj;It.erasParse=Dj;It.erasConvertYear=Hj;It.erasAbbrRegex=Vj;It.erasNameRegex=Bj;It.erasNarrowRegex=Wj;It.months=y6;It.monthsShort=b6;It.monthsParse=R6;It.monthsRegex=_6;It.monthsShortRegex=T6;It.week=M6;It.firstDayOfYear=P6;It.firstDayOfWeek=I6;It.weekdays=W6;It.weekdaysMin=j6;It.weekdaysShort=U6;It.weekdaysParse=Y6;It.weekdaysRegex=q6;It.weekdaysShortRegex=Z6;It.weekdaysMinRegex=J6;It.isPM=e8;It.meridiem=n8;function R0(t,e,r,n){var i=wa(),s=Ro().set(n,e);return i[r](s,t)}function lN(t,e,r){if(ca(t)&&(e=t,t=void 0),t=t||"",e!=null)return R0(t,e,r,"month");var n,i=[];for(n=0;n<12;n++)i[n]=R0(t,n,r,"month");return i}function Bb(t,e,r,n){typeof t=="boolean"?(ca(e)&&(r=e,e=void 0),e=e||""):(e=t,r=e,t=!1,ca(e)&&(r=e,e=void 0),e=e||"");var i=wa(),s=t?i._week.dow:0,o,a=[];if(r!=null)return R0(e,(r+s)%7,n,"day");for(o=0;o<7;o++)a[o]=R0(e,(o+s)%7,n,"day");return a}function l5(t,e){return lN(t,e,"months")}function u5(t,e){return lN(t,e,"monthsShort")}function c5(t,e,r){return Bb(t,e,r,"weekdays")}function h5(t,e,r){return Bb(t,e,r,"weekdaysShort")}function d5(t,e,r){return Bb(t,e,r,"weekdaysMin")}al("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,r=xt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+r}});Ce.lang=qi("moment.lang is deprecated. Use moment.locale instead.",al);Ce.langData=qi("moment.langData is deprecated. Use moment.localeData instead.",wa);var Oo=Math.abs;function f5(){var t=this._data;return this._milliseconds=Oo(this._milliseconds),this._days=Oo(this._days),this._months=Oo(this._months),t.milliseconds=Oo(t.milliseconds),t.seconds=Oo(t.seconds),t.minutes=Oo(t.minutes),t.hours=Oo(t.hours),t.months=Oo(t.months),t.years=Oo(t.years),this}function uN(t,e,r,n){var i=Ps(e,r);return t._milliseconds+=n*i._milliseconds,t._days+=n*i._days,t._months+=n*i._months,t._bubble()}function g5(t,e){return uN(this,t,e,1)}function m5(t,e){return uN(this,t,e,-1)}function y_(t){return t<0?Math.floor(t):Math.ceil(t)}function p5(){var t=this._milliseconds,e=this._days,r=this._months,n=this._data,i,s,o,a,l;return t>=0&&e>=0&&r>=0||t<=0&&e<=0&&r<=0||(t+=y_(Qy(r)+e)*864e5,e=0,r=0),n.milliseconds=t%1e3,i=Wi(t/1e3),n.seconds=i%60,s=Wi(i/60),n.minutes=s%60,o=Wi(s/60),n.hours=o%24,e+=Wi(o/24),l=Wi(cN(e)),r+=l,e-=y_(Qy(l)),a=Wi(r/12),r%=12,n.days=e,n.months=r,n.years=a,this}function cN(t){return t*4800/146097}function Qy(t){return t*146097/4800}function w5(t){if(!this.isValid())return NaN;var e,r,n=this._milliseconds;if(t=Zi(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+n/864e5,r=this._months+cN(e),t){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(e=this._days+Math.round(Qy(this._months)),t){case"week":return e/7+n/6048e5;case"day":return e+n/864e5;case"hour":return e*24+n/36e5;case"minute":return e*1440+n/6e4;case"second":return e*86400+n/1e3;case"millisecond":return Math.floor(e*864e5)+n;default:throw new Error("Unknown unit "+t)}}function va(t){return function(){return this.as(t)}}var hN=va("ms"),v5=va("s"),C5=va("m"),S5=va("h"),y5=va("d"),b5=va("w"),x5=va("M"),R5=va("Q"),E5=va("y"),T5=hN;function _5(){return Ps(this)}function A5(t){return t=Zi(t),this.isValid()?this[t+"s"]():NaN}function Yu(t){return function(){return this.isValid()?this._data[t]:NaN}}var M5=Yu("milliseconds"),O5=Yu("seconds"),I5=Yu("minutes"),P5=Yu("hours"),N5=Yu("days"),D5=Yu("months"),H5=Yu("years");function k5(){return Wi(this.days()/7)}var Yo=Math.round,Zc={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function F5(t,e,r,n,i){return i.relativeTime(e||1,!!r,t,n)}function L5(t,e,r,n){var i=Ps(t).abs(),s=Yo(i.as("s")),o=Yo(i.as("m")),a=Yo(i.as("h")),l=Yo(i.as("d")),u=Yo(i.as("M")),c=Yo(i.as("w")),h=Yo(i.as("y")),d=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||o<=1&&["m"]||o<r.m&&["mm",o]||a<=1&&["h"]||a<r.h&&["hh",a]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(d=d||c<=1&&["w"]||c<r.w&&["ww",c]),d=d||u<=1&&["M"]||u<r.M&&["MM",u]||h<=1&&["y"]||["yy",h],d[2]=e,d[3]=+t>0,d[4]=n,F5.apply(null,d)}function $5(t){return t===void 0?Yo:typeof t=="function"?(Yo=t,!0):!1}function B5(t,e){return Zc[t]===void 0?!1:e===void 0?Zc[t]:(Zc[t]=e,t==="s"&&(Zc.ss=e-1),!0)}function V5(t,e){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Zc,i,s;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(r=t),typeof e=="object"&&(n=Object.assign({},Zc,e),e.s!=null&&e.ss==null&&(n.ss=e.s-1)),i=this.localeData(),s=L5(this,!r,n,i),r&&(s=i.pastFuture(+this,s)),i.postformat(s)}var TC=Math.abs;function ic(t){return(t>0)-(t<0)||+t}function qw(){if(!this.isValid())return this.localeData().invalidDate();var t=TC(this._milliseconds)/1e3,e=TC(this._days),r=TC(this._months),n,i,s,o,a=this.asSeconds(),l,u,c,h;return a?(n=Wi(t/60),i=Wi(n/60),t%=60,n%=60,s=Wi(r/12),r%=12,o=t?t.toFixed(3).replace(/\.?0+$/,""):"",l=a<0?"-":"",u=ic(this._months)!==ic(a)?"-":"",c=ic(this._days)!==ic(a)?"-":"",h=ic(this._milliseconds)!==ic(a)?"-":"",l+"P"+(s?u+s+"Y":"")+(r?u+r+"M":"")+(e?c+e+"D":"")+(i||n||t?"T":"")+(i?h+i+"H":"")+(n?h+n+"M":"")+(t?h+o+"S":"")):"P0D"}var _t=Kw.prototype;_t.isValid=D8;_t.abs=f5;_t.add=g5;_t.subtract=m5;_t.as=w5;_t.asMilliseconds=hN;_t.asSeconds=v5;_t.asMinutes=C5;_t.asHours=S5;_t.asDays=y5;_t.asWeeks=b5;_t.asMonths=x5;_t.asQuarters=R5;_t.asYears=E5;_t.valueOf=T5;_t._bubble=p5;_t.clone=_5;_t.get=A5;_t.milliseconds=M5;_t.seconds=O5;_t.minutes=I5;_t.hours=P5;_t.days=N5;_t.weeks=k5;_t.months=D5;_t.years=H5;_t.humanize=V5;_t.toISOString=qw;_t.toString=qw;_t.toJSON=qw;_t.locale=JP;_t.localeData=eN;_t.toIsoString=qi("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",qw);_t.lang=QP;Ke("X",0,0,"unix");Ke("x",0,0,"valueOf");Fe("x",jw);Fe("X",l6);qt("X",function(t,e,r){r._d=new Date(parseFloat(t)*1e3)});qt("x",function(t,e,r){r._d=new Date(xt(t))});//! moment.js
Ce.version="2.30.1";WU(lr);Ce.fn=Re;Ce.min=O8;Ce.max=I8;Ce.now=P8;Ce.utc=Ro;Ce.unix=o5;Ce.months=l5;Ce.isDate=gg;Ce.locale=al;Ce.invalid=Bw;Ce.duration=Ps;Ce.isMoment=_s;Ce.weekdays=c5;Ce.parseZone=a5;Ce.localeData=wa;Ce.isDuration=Gp;Ce.monthsShort=u5;Ce.weekdaysMin=d5;Ce.defineLocale=Pb;Ce.updateLocale=a8;Ce.locales=l8;Ce.weekdaysShort=h5;Ce.normalizeUnits=Zi;Ce.relativeTimeRounding=$5;Ce.relativeTimeThreshold=B5;Ce.calendarFormat=nj;Ce.prototype=Re;Ce.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};function dN(t){const e=t.length;let r=0;for(;r<e;)t[r]=[t[r]],r+=1}function e1(t,e){const r=e.length;let n=0;for(;n<r;)t.push(e[n]),n+=1}function Qd(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const r=t.length,n=t[0].length;for(let i=0;i<r;i++)for(let s=0;s<n;s++)e[s]||(e[s]=[]),e[s][i]=t[i][s];return e}function Hr(t,e,r,n){let i=-1,s=t,o=r;Array.isArray(t)||(s=Array.from(t));const a=s.length;for(n&&a&&(i+=1,o=s[i]),i+=1;i<a;)o=e(o,s[i],i,s),i+=1;return o}function ha(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];e(a,r,n)&&(o+=1,s[o]=a),r+=1}return s}function St(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length,s=[];let o=-1;for(;r<i;){const a=n[r];o+=1,s[o]=e(a,r,n),r+=1}return s}function V(t,e){let r=0,n=t;Array.isArray(t)||(n=Array.from(t));const i=n.length;for(;r<i&&e(n[r],r,n)!==!1;)r+=1;return t}function fN(t){return Hr(t,(e,r)=>e+r,0)}function W5(t){return Hr(t,(e,r)=>e>r?e:r,Array.isArray(t)?t[0]:void 0)}function U5(t){return Hr(t,(e,r)=>e<r?e:r,Array.isArray(t)?t[0]:void 0)}function j5(t){return t.length?fN(t)/t.length:0}function gN(t){return Hr(t,(e,r)=>e.concat(Array.isArray(r)?gN(r):r),[])}function Vb(t){const e=[];return V(t,r=>{e.indexOf(r)===-1&&e.push(r)}),e}function t1(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return V(i,o=>{s=s.filter(a=>!o.includes(a))}),s}function z5(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e];let s=n;return V(i,o=>{s=s.filter(a=>o.includes(a))}),s}function Y5(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=[...e],s=new Set(n);return V(i,o=>{V(o,a=>{s.has(a)||s.add(a)})}),Array.from(s)}function r1(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}const G5=Object.freeze(Object.defineProperty({__proto__:null,arrayAvg:j5,arrayEach:V,arrayFilter:ha,arrayFlatten:gN,arrayMap:St,arrayMax:W5,arrayMin:U5,arrayReduce:Hr,arraySum:fN,arrayUnique:Vb,extendArray:e1,getDifferenceOfArrays:t1,getIntersectionOfArrays:z5,getUnionOfArrays:Y5,pivot:Qd,stringToArray:r1,to2dArray:dN},Symbol.toStringTag,{value:"Module"}));function Ft(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return Hr(t,(s,o,a)=>{const l=o.replace(/\r?\n\s*/g,""),u=r[a]?r[a]:"";return s+l+u},"").trim()}function yr(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function ke(t){return typeof t<"u"}function er(t){return typeof t>"u"}function br(t){return t===null||t===""||er(t)}function mN(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const jd="length",ef=t=>parseInt(t,16),b_=t=>parseInt(t,10),E0=(t,e,r)=>t.substr(e,r),tf=t=>t.codePointAt(0)-65,n1=t=>`${t}`.replace(/\-/g,""),K5=t=>ef(E0(n1(t),ef("12"),tf("F")))/(ef(E0(n1(t),tf("B"),~~![][jd]))||9),X5=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let x_=!1;const R_={invalid:()=>Ft`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},E_={invalid:()=>Ft`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:r}=t;return Ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${r}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function pN(t,e){const r=!br(t),n=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",i="14.6.1";let s,o="invalid",a="invalid";t=n1(t||"");const l=q5(t);if(r||n||l)if(l){const u=Ce("17/10/2024","DD/MM/YYYY"),c=Math.floor(u.toDate().getTime()/864e5),h=K5(t);s=Ce((h+1)*864e5,"x").format("MMMM DD, YYYY"),c>h?(o="expired",a="expired"):(o="valid",a="valid")}else n?(o="non_commercial",a="valid"):(o="invalid",a="invalid");else o="missing",a="missing";if(X5()&&(o="valid",a="valid"),!x_&&o!=="valid"&&(R_[o]({keyValidityDate:s,hotVersion:i})&&console[o==="non_commercial"?"info":"warn"](R_[o]({keyValidityDate:s,hotVersion:i})),x_=!0),a!=="valid"&&e.parentNode&&E_[a]({keyValidityDate:s,hotVersion:i})){const c=document.createElement("div");c.className="hot-display-license-info",c.innerHTML=E_[a]({keyValidityDate:s,hotVersion:i}),e.parentNode.insertBefore(c,e.nextSibling)}}function q5(t){let e=[][jd],r=e;if(t[jd]!==tf("Z"))return!1;for(let n="",i="B<H4P+".split(""),s=tf(i.shift());s;s=tf(i.shift()||"A"))--s<""[jd]?r=r|(b_(`${b_(ef(n)+(ef(E0(t,Math.abs(s),2))+[]).padStart(2,"0"))}`)%97||2)>>1:n=E0(t,s,s?i[jd]===1?9:8:6);return r===e}const Z5=Object.freeze(Object.defineProperty({__proto__:null,_injectProductInfo:pN,isDefined:ke,isEmpty:br,isRegExp:mN,isUndefined:er,stringify:yr},Symbol.toStringTag,{value:"Module"}));function An(t){return t[0].toUpperCase()+t.substr(1)}function J5(){const t=[];for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];let i=r.length;for(;i;){i-=1;const s=yr(r[i]).toLowerCase();t.indexOf(s)===-1&&t.push(s)}return t.length===1}function Wb(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function Ub(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function jb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(r,n)=>r.charAt(0)==="\\"?r.substr(1,r.length-1):e[n]===void 0?"":e[n])}function i1(t){return Zw(`${t}`,{ALLOWED_TAGS:[]})}function Zw(t,e){return VU.sanitize(t,e)}const Q5=Object.freeze(Object.defineProperty({__proto__:null,equalsIgnoreCase:J5,isPercentValue:Ub,randomString:Wb,sanitize:Zw,stripTags:i1,substitute:jb,toUpperCaseFirst:An},Symbol.toStringTag,{value:"Module"})),Th=t=>["tabindex",t],ez=()=>["role","treegrid"],go=()=>["role","presentation"],tz=()=>["role","gridcell"],rz=()=>["role","rowheader"],wN=()=>["role","rowgroup"],nz=()=>["role","columnheader"],s1=()=>["role","row"],iz=()=>["role","menu"],sz=()=>["role","menuitem"],oz=()=>["role","menuitemcheckbox"],az=()=>["role","combobox"],vN=()=>["role","listbox"],lz=()=>["role","option"],uz=()=>["role","checkbox"],cz=()=>["scope","col"],hz=()=>["scope","row"],dz=()=>["type","text"],T0=t=>["aria-label",t],Gu=()=>["aria-hidden","true"],fz=()=>["aria-disabled","true"],gz=()=>["aria-multiselectable","true"],CN=t=>["aria-haspopup",t],SN=t=>["aria-rowcount",t],Jw=t=>["aria-colcount",t],yN=t=>["aria-rowindex",t],zb=t=>["aria-colindex",t],Yi=t=>["aria-expanded",t],mz=t=>["aria-sort",t],T_=()=>["aria-readonly","true"],__=()=>["aria-invalid","true"],bN=t=>["aria-checked",t],Yb=()=>["aria-selected","true"],pz=()=>["aria-autocomplete","list"],wz=t=>["aria-controls",t],vz=t=>["aria-activedescendant",t],Cz=t=>["aria-live",t],Sz=t=>["aria-relevant",t],yz=t=>["aria-setsize",t],bz=t=>["aria-posinset",t];function xN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=-1,n=null,i=t;for(;i!==null;){if(r===e){n=i;break}i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:(r+=1,i=i.parentNode)}return n}function RN(t,e){const r=t.closest(".handsontable");return!!r&&(r.parentNode===e||r===e)}function EN(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Au(t){return EN(t)&&t.parent}function xz(t){return!!Object.getPrototypeOf(t.parent)}function fl(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:n,DOCUMENT_FRAGMENT_NODE:i}=Node;let s=t;for(;s!=null&&s!==r;){const{nodeType:o,nodeName:a}=s;if(o===n&&(e.includes(a)||e.includes(s)))return s;const{host:l}=s;l&&o===i?s=l:s=s.parentNode}return null}function zd(t,e,r){const n=[];let i=t;for(;i&&(i=fl(i,e,r),!(!i||r&&!r.contains(i)));)n.push(i),i.host&&i.nodeType===Node.DOCUMENT_FRAGMENT_NODE?i=i.host:i=i.parentNode;const s=n.length;return s?n[s-1]:null}function ll(t,e){let r=t.parentNode,n=[];for(typeof e=="string"?t.defaultView?n=Array.prototype.slice.call(t.querySelectorAll(e),0):n=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):n.push(e);r!==null;){if(n.indexOf(r)>-1)return!0;r=r.parentNode}return!1}function TN(t){let e=0,r=t;if(r.previousSibling)for(;r=r.previousSibling;)e+=1;return e}function Va(t,e,r){const n=r.parentElement.querySelector(`.ht_clone_${t}`);return n?n.contains(e):null}function _N(t){return!t||!t.length?[]:t.filter(e=>!!e)}function AN(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const r=[],n=[];return n.push(...t.filter(i=>{const s=i instanceof RegExp;return s&&e&&r.push(i),!s})),{regexFree:n,regexes:r}}function Qe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function ve(t,e){typeof e=="string"&&(e=e.split(" ")),e=_N(e),e.length>0&&t.classList.add(...e)}function tt(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:r,regexes:n}=AN(e,!0);r=_N(r),r.length>0&&t.classList.remove(...r),n.forEach(i=>{t.classList.forEach(s=>{i.test(s)&&t.classList.remove(s)})})}function qe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,r]]),e.forEach(n=>{Array.isArray(n)&&n[0]!==""&&t.setAttribute(...n)})}function Ku(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:r,regexes:n}=AN(e,!0);r.forEach(i=>{i!==""&&t.removeAttribute(i)}),n.forEach(i=>{t.getAttributeNames().forEach(s=>{i.test(s)&&t.removeAttribute(s)})})}function Gb(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let r=e.length-1;r>=0;r--)Gb(e[r])}}function As(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const MN=/(<(.*)>|&(.*);)/;function Xu(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;MN.test(e)?t.innerHTML=r?Zw(e):e:gl(t,e)}function gl(t,e){const r=t.firstChild;r&&r.nodeType===3&&r.nextSibling===null?r.textContent=e:(As(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Mu(t){const e=t.ownerDocument.documentElement;let r=t;for(;r!==e;){if(r===null)return!1;if(r.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(r.host){if(r.host.impl)return Mu(r.host.impl);if(r.host)return Mu(r.host);throw new Error("Lost in Web Components world")}else return!1;else if(vo(r).display==="none")return!1;r=r.parentNode}return!0}function Kr(t){const e=t.ownerDocument,r=e.defaultView,n=e.documentElement;let i=t,s,o,a;for(s=i.offsetLeft,o=i.offsetTop,a=i;(i=i.offsetParent)&&!(i===e.body||!("offsetLeft"in i));)s+=i.offsetLeft,o+=i.offsetTop,a=i;return a&&a.style.position==="fixed"&&(s+=r.pageXOffset||n.scrollLeft,o+=r.pageYOffset||n.scrollTop),{left:s,top:o}}function Kb(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function Qw(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function ev(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Kb(e):t.scrollTop}function Xb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?Qw(e):t.scrollLeft}function kf(t){let e=t.ownerDocument,r=e?e.defaultView:void 0;e||(e=t.document?t.document:t,r=e.defaultView);const n=["auto","scroll"];let i=t.parentNode;for(;i&&i.style&&e.body!==i;){let{overflow:s,overflowX:o,overflowY:a}=i.style;if([s,o,a].includes("scroll"))return i;if({overflow:s,overflowX:o,overflowY:a}=r.getComputedStyle(i),n.includes(s)||n.includes(o)||n.includes(a)||i.clientHeight<=i.scrollHeight+1&&(n.includes(a)||n.includes(s))||i.clientWidth<=i.scrollWidth+1&&(n.includes(o)||n.includes(s)))return i;i=i.parentNode}return r}function ON(t){return t.scrollHeight-t.clientHeight}function IN(t){return t.scrollWidth-t.clientWidth}function Ou(t){const e=t.ownerDocument,r=e.defaultView;let n=t.parentNode;for(;n&&n.style&&e.body!==n;){if(n.style.overflow!=="visible"&&n.style.overflow!=="")return n;const i=vo(n,r),s=["scroll","hidden","auto"],o=i.getPropertyValue("overflow"),a=i.getPropertyValue("overflow-y"),l=i.getPropertyValue("overflow-x");if(s.includes(o)||s.includes(a)||s.includes(l))return n;n=n.parentNode}return r}function mh(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===r)return e==="width"?`${r.innerWidth}px`:e==="height"?`${r.innerHeight}px`:void 0}else return;const n=t.style[e];if(n!==""&&n!==void 0)return n;const i=vo(t,r);if(i[e]!==""&&i[e]!==void 0)return i[e]}function Rz(t,e){const{selectorText:r}=e;let n=!1;return e.type===CSSRule.STYLE_RULE&&r&&(t.msMatchesSelector?n=t.msMatchesSelector(r):t.matches&&(n=t.matches(r))),n}function vo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t.currentStyle||e.getComputedStyle(t)}function tr(t){return t.offsetWidth}function Ar(t){return t.offsetHeight}function vu(t){return t.clientHeight||t.innerHeight}function qb(t){return t.clientWidth||t.innerWidth}function Ez(t,e,r){t.addEventListener(e,r,!1)}function Tz(t,e,r){t.removeEventListener(e,r,!1)}function Zb(t){return t.selectionStart?t.selectionStart:0}function PN(t){return t.selectionEnd?t.selectionEnd:0}function _z(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;const e=t.document;let r="";return t.getSelection?r=t.getSelection().toString():e.selection&&e.selection.type!=="Control"&&(r=e.selection.createRange().text),r}function o1(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function vg(t,e,r){if(r===void 0&&(r=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,r)}catch{const i=t.parentNode,s=i.style.display;i.style.display="block",t.setSelectionRange(e,r),i.style.display=s}}}let _C;function Az(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const r=t.createElement("div");r.style.boxSizing="content-box",r.style.height="150px",r.style.left="0px",r.style.overflow="hidden",r.style.position="absolute",r.style.top="0px",r.style.width="200px",r.style.visibility="hidden",r.appendChild(e),(t.body||t.documentElement).appendChild(r);const n=e.offsetWidth;r.style.overflow="scroll";let i=e.offsetWidth;return n===i&&(i=r.clientWidth),(t.body||t.documentElement).removeChild(r),n-i}function qr(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return _C===void 0&&(_C=Az(t)),_C}function NN(t){return t.offsetWidth!==t.clientWidth}function DN(t){return t.offsetHeight!==t.clientHeight}function tv(t,e,r){t.style.transform=`translate3d(${e},${r},0)`}function Mz(t){let e;return t.style.transform&&(e=t.style.transform)!==""?["transform",e]:-1}function Cg(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function rf(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function rv(t){return rf(t)&&t.hasAttribute("data-hot-input")===!1}function Oz(t){const e=t.ownerDocument.activeElement;rv(e)||t.select()}function Jb(t){return!t.parentNode}function HN(t,e){new IntersectionObserver((n,i)=>{n.forEach(s=>{s.isIntersecting&&t.offsetParent!==null&&(e(),i.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function Qb(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const n=t.ownerDocument,i=n.createRange(),s=n.defaultView.getSelection();qe(t,"contenteditable",!0),r&&qe(t,...Gu()),e&&ve(t,"invisibleSelection"),i.selectNodeContents(t),s.removeAllRanges(),s.addRange(i)}function ex(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const r=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),r.removeAllRanges(),e&&tt(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function kN(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Qb(t,r),e(),ex(t,r)}const Iz=Object.freeze(Object.defineProperty({__proto__:null,HTML_CHARACTERS:MN,addClass:ve,addEvent:Ez,clearTextSelection:o1,closest:fl,closestDown:zd,empty:As,fastInnerHTML:Xu,fastInnerText:gl,getCaretPosition:Zb,getComputedStyle:vo,getCssTransform:Mz,getFrameElement:EN,getMaximumScrollLeft:IN,getMaximumScrollTop:ON,getParent:xN,getParentWindow:Au,getScrollLeft:Xb,getScrollTop:ev,getScrollableElement:kf,getScrollbarWidth:qr,getSelectionEndPosition:PN,getSelectionText:_z,getStyle:mh,getTrimmingContainer:Ou,getWindowScrollLeft:Qw,getWindowScrollTop:Kb,hasAccessToParentWindow:xz,hasClass:Qe,hasHorizontalScrollbar:DN,hasVerticalScrollbar:NN,index:TN,innerHeight:vu,innerWidth:qb,isChildOf:ll,isDetached:Jb,isInput:rf,isOutsideInput:rv,isThisHotChild:RN,isVisible:Mu,makeElementContentEditableAndSelectItsContent:Qb,matchesCSSRules:Rz,observeVisibilityChangeOnce:HN,offset:Kr,outerHeight:Ar,outerWidth:tr,overlayContainsElement:Va,removeAttribute:Ku,removeClass:tt,removeContentEditableFromElementAndDeselect:ex,removeEvent:Tz,removeTextNodes:Gb,resetCssTransform:Cg,runWithSelectedContendEditableElement:kN,selectElementIfAllowed:Oz,setAttribute:qe,setCaretPosition:vg,setOverlayPosition:tv},Symbol.toStringTag,{value:"Module"}));function Jt(t){return typeof t=="function"}function FN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=0;const n={lastCallThrottled:!0};let i=null;function s(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];const u=Date.now();let c=!1;n.lastCallThrottled=!0,r||(r=u,c=!0);const h=e-(u-r);return c?(n.lastCallThrottled=!1,t.apply(this,a)):(i&&clearTimeout(i),i=setTimeout(()=>{n.lastCallThrottled=!1,t.apply(this,a),r=0,i=void 0},h)),n}return s}function Pz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10;const n=FN(t,e);let i=r;function s(){i=r}function o(){for(var a=arguments.length,l=new Array(a),u=0;u<a;u++)l[u]=arguments[u];return i?(i-=1,t.apply(this,l)):n.apply(this,l)}return o.clearHits=s,o}function nv(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,r=null,n;function i(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return r&&clearTimeout(r),r=setTimeout(()=>{n=t.apply(this,o)},e),n}return i}function Nz(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];const[n,...i]=e;return function(){for(var o=arguments.length,a=new Array(o),l=0;l<o;l++)a[l]=arguments[l];return Hr(i,(u,c)=>c(u),n.apply(this,a))}}function tx(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return t.apply(this,r.concat(o))}}function LN(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=n.concat(o);let u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function Dz(t){const e=t.length;function r(n){return function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];const l=n.concat(o.reverse());let u;return l.length>=e?u=t.apply(this,l):u=r(l),u}}return r([])}function _0(t,e,r,n,i,s,o,a){return ke(a)?t.call(e,r,n,i,s,o,a):ke(o)?t.call(e,r,n,i,s,o):ke(s)?t.call(e,r,n,i,s):ke(i)?t.call(e,r,n,i):ke(n)?t.call(e,r,n):ke(r)?t.call(e,r):t.call(e)}const Hz=Object.freeze(Object.defineProperty({__proto__:null,curry:LN,curryRight:Dz,debounce:nv,fastCall:_0,isFunction:Jt,partial:tx,pipe:Nz,throttle:FN,throttleAfterHits:Pz},Symbol.toStringTag,{value:"Module"}));var kz=Br,A_=eP,Fz=mn,M_=Bu,Lz=$w,O_=kz([].push),$z=function(t){if(Fz(t))return t;if(A_(t)){for(var e=t.length,r=[],n=0;n<e;n++){var i=t[n];typeof i=="string"?O_(r,i):(typeof i=="number"||M_(i)==="Number"||M_(i)==="String")&&O_(r,Lz(i))}var s=r.length,o=!0;return function(a,l){if(o)return o=!1,l;if(A_(this))return l;for(var u=0;u<s;u++)if(r[u]===a)return l}}},Bz=pn,$N=bh,BN=Lw,Vz=Is,Sg=Br,VN=ai,I_=mn,P_=ib,WN=wb,Wz=$z,Uz=nb,jz=String,ul=$N("JSON","stringify"),rm=Sg(/./.exec),N_=Sg("".charAt),zz=Sg("".charCodeAt),Yz=Sg("".replace),Gz=Sg(1 .toString),Kz=/[\uD800-\uDFFF]/g,D_=/^[\uD800-\uDBFF]$/,H_=/^[\uDC00-\uDFFF]$/,k_=!Uz||VN(function(){var t=$N("Symbol")("stringify detection");return ul([t])!=="[null]"||ul({a:t})!=="{}"||ul(Object(t))!=="{}"}),F_=VN(function(){return ul("\uDF06\uD834")!=='"\\udf06\\ud834"'||ul("\uDEAD")!=='"\\udead"'}),Xz=function(t,e){var r=WN(arguments),n=Wz(e);if(!(!I_(n)&&(t===void 0||P_(t))))return r[1]=function(i,s){if(I_(n)&&(s=Vz(n,this,jz(i),s)),!P_(s))return s},BN(ul,null,r)},qz=function(t,e,r){var n=N_(r,e-1),i=N_(r,e+1);return rm(D_,t)&&!rm(H_,i)||rm(H_,t)&&!rm(D_,n)?"\\u"+Gz(zz(t,0),16):t};ul&&Bz({target:"JSON",stat:!0,arity:3,forced:k_||F_},{stringify:function(e,r,n){var i=WN(arguments),s=BN(k_?Xz:ul,null,i);return F_&&typeof s=="string"?Yz(s,Kz,qz):s}});function ph(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},ct(t,(r,n)=>{n!=="__children"&&(r&&typeof r=="object"&&!Array.isArray(r)?e[n]=ph(r):Array.isArray(r)?r.length&&typeof r[0]=="object"&&!Array.isArray(r[0])?e[n]=[ph(r[0])]:e[n]=[]:e[n]=null)})),e}function Ns(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Dr(t,e,r){const n=Array.isArray(r);return ct(e,(i,s)=>{(n===!1||r.includes(s))&&(t[s]=i)}),t}function yg(t,e){ct(e,(r,n)=>{e[n]&&typeof e[n]=="object"?(t[n]||(Array.isArray(e[n])?t[n]=[]:Object.prototype.toString.call(e[n])==="[object Date]"?t[n]=e[n]:t[n]={}),yg(t[n],e[n])):t[n]=e[n]})}function Mn(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function Ms(t){const e={};return ct(t,(r,n)=>{e[n]=r}),e}function Lt(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return V(r,i=>{t.MIXINS.push(i.MIXIN_NAME),ct(i,(s,o)=>{if(t.prototype[o]!==void 0)throw new Error(`Mixin conflict. Property '${o}' already exist and cannot be overwritten.`);if(typeof s=="function")t.prototype[o]=s;else{const a=function(c,h){const d=`_${c}`,f=m=>{let g=m;return(Array.isArray(g)||ut(g))&&(g=Mn(g)),g};return function(){return this[d]===void 0&&(this[d]=f(h)),this[d]}},l=function(c){const h=`_${c}`;return function(d){this[h]=d}};Object.defineProperty(t.prototype,o,{get:a(o,s),set:l(o),configurable:!0})}})}),t}function iv(t,e){return JSON.stringify(t)===JSON.stringify(e)}function ut(t){return Object.prototype.toString.call(t)==="[object Object]"}function To(t,e,r,n){n.value=r,n.writable=n.writable!==!1,n.enumerable=n.enumerable!==!1,n.configurable=n.configurable!==!1,Object.defineProperty(t,e,n)}function ct(t,e){for(const r in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,r))&&e(t[r],r,t)===!1)break;return t}function UN(t,e){const r=e.split(".");let n=t;return ct(r,i=>{if(n=n[i],n===void 0)return n=void 0,!1}),n}function Xp(t,e,r){const n=e.split(".");let i=t;n.forEach((s,o)=>{o!==n.length-1?(gr(i,s)||(i[s]={}),i=i[s]):i[s]=r})}function sv(t){if(!ut(t))return 0;const e=function(r){let n=0;return ut(r)?ct(r,(i,s)=>{s!=="__children"&&(n+=e(i))}):n+=1,n};return e(t)}function zi(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const r=`_${e}`,n={_touched:!1,[r]:t,isTouched(){return this._touched}};return Object.defineProperty(n,e,{get(){return this[r]},set(i){this._touched=!0,this[r]=i},enumerable:!0,configurable:!0}),n}function gr(t,e){return Object.prototype.hasOwnProperty.call(t,e)}const Zz=Object.freeze(Object.defineProperty({__proto__:null,clone:Ms,createObjectPropListener:zi,deepClone:Mn,deepExtend:yg,deepObjectSize:sv,defineGetter:To,duckSchema:ph,extend:Dr,getProperty:UN,hasOwnProperty:gr,inherit:Ns,isObject:ut,isObjectEqual:iv,mixin:Lt,objectEach:ct,setProperty:Xp},Symbol.toStringTag,{value:"Module"}));function ov(t){return window.requestAnimationFrame(t)}function Ff(t){window.cancelAnimationFrame(t)}function rx(){return"ontouchstart"in window}function jN(){return typeof window<"u"}let sc;function zN(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return sc||(typeof Intl=="object"?sc=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?sc=(r,n)=>`${r}`.localeCompare(n):sc=(r,n)=>r===n?0:r>n?-1:1,sc)}const Jz=Object.freeze(Object.defineProperty({__proto__:null,cancelAnimationFrame:Ff,getComparisonFunction:zN,isCSR:jN,isTouchSupported:rx,requestAnimationFrame:ov},Symbol.toStringTag,{value:"Module"})),ki=t=>{const e={value:!1};return e.test=(r,n)=>{e.value=t(r,n)},e},Ca={chrome:ki((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ki(t=>/CriOS/.test(t)),edge:ki(t=>/Edge/.test(t)),edgeWebKit:ki(t=>/EdgiOS/.test(t)),firefox:ki(t=>/Firefox/.test(t)),firefoxWebKit:ki(t=>/FxiOS/.test(t)),mobile:ki(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ki((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},_h={mac:ki(t=>/^Mac/.test(t)),win:ki(t=>/^Win/.test(t)),linux:ki(t=>/^Linux/.test(t)),ios:ki(t=>/iPhone|iPad|iPod/i.test(t))};function YN(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ct(Ca,r=>{let{test:n}=r;return void n(t,e)})}function GN(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ct(_h,e=>{let{test:r}=e;return void r(t)})}jN()&&(YN(),GN());function nx(){return Ca.chrome.value}function KN(){return Ca.chromeWebKit.value}function qp(){return Ca.firefox.value}function XN(){return Ca.firefoxWebKit.value}function ix(){return Ca.safari.value}function qN(){return Ca.edge.value}function Qz(){return Ca.edgeWebKit.value}function ea(){return Ca.mobile.value}function sx(){return _h.ios.value}function ox(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&_h.mac.value}function a1(){return _h.win.value}function Lf(){return _h.mac.value}function eY(){return _h.linux.value}const tY=Object.freeze(Object.defineProperty({__proto__:null,isChrome:nx,isChromeWebKit:KN,isEdge:qN,isEdgeWebKit:Qz,isFirefox:qp,isFirefoxWebKit:XN,isIOS:sx,isIpadOS:ox,isLinuxOS:eY,isMacOS:Lf,isMobileBrowser:ea,isSafari:ix,isWindowsOS:a1,setBrowserMeta:YN,setPlatformMeta:GN},Symbol.toStringTag,{value:"Module"})),We={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:qp()?182:174,AUDIO_MUTE:qp()?181:173,AUDIO_UP:qp()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},rY=[We.ALT,We.ARROW_DOWN,We.ARROW_LEFT,We.ARROW_RIGHT,We.ARROW_UP,We.AUDIO_DOWN,We.AUDIO_MUTE,We.AUDIO_UP,We.BACKSPACE,We.CAPS_LOCK,We.DELETE,We.END,We.ENTER,We.ESCAPE,We.F1,We.F2,We.F3,We.F4,We.F5,We.F6,We.F7,We.F8,We.F9,We.F10,We.F11,We.F12,We.F13,We.F14,We.F15,We.F16,We.F17,We.F18,We.F19,We.HOME,We.INSERT,We.MEDIA_NEXT,We.MEDIA_PLAY_PAUSE,We.MEDIA_PREV,We.MEDIA_STOP,We.NULL,We.NUM_LOCK,We.PAGE_DOWN,We.PAGE_UP,We.PAUSE,We.SCROLL_LOCK,We.SHIFT,We.TAB];function ZN(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function ax(t){return rY.includes(t)}function nY(t){const e=[];return Lf()?e.push(We.COMMAND_LEFT,We.COMMAND_RIGHT,We.COMMAND_FIREFOX):e.push(We.CONTROL),e.includes(t)}function JN(t){return[We.CONTROL,We.COMMAND_LEFT,We.COMMAND_RIGHT,We.COMMAND_FIREFOX].includes(t)}function Ah(t,e){const r=e.split("|");let n=!1;return V(r,i=>{if(t===We[i])return n=!0,!1}),n}const iY=Object.freeze(Object.defineProperty({__proto__:null,KEY_CODES:We,isCtrlKey:nY,isCtrlMetaKey:JN,isFunctionKey:ax,isKey:Ah,isPrintableChar:ZN},Symbol.toStringTag,{value:"Module"}));function Ji(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function Xa(t){return t.isImmediatePropagationEnabled===!1}function ml(t){return t.button===2}function av(t){return t.button===0}function QN(t){return t instanceof TouchEvent}function eD(t,e){const r={x:t.offsetX,y:t.offsetY};let n=t.target;if(!(e instanceof HTMLElement)||n!==e&&n.contains(e))return r;for(;n!==e;)r.x+=n.offsetLeft,r.y+=n.offsetTop,n=n.offsetParent;return r}const sY=Object.freeze(Object.defineProperty({__proto__:null,isImmediatePropagationStopped:Xa,isLeftClick:av,isRightClick:ml,isTouchEvent:QN,offsetRelativeTo:eD,stopImmediatePropagation:Ji},Symbol.toStringTag,{value:"Module"}));var tD={},oY=WI,aY=hb,lY=Object.keys||function(e){return oY(e,aY)},uY=Os,cY=HI,hY=bl,dY=pa,fY=Nw,gY=lY;tD.f=uY&&!cY?Object.defineProperties:function(e,r){dY(e);for(var n=fY(r),i=gY(r),s=i.length,o=0,a;s>o;)hY.f(e,a=i[o++],n[a]);return e};var mY=pa,pY=tD,L_=hb,wY=ub,vY=dP,CY=ab,SY=LI,$_=">",B_="<",l1="prototype",u1="script",rD=SY("IE_PROTO"),AC=function(){},nD=function(t){return B_+u1+$_+t+B_+"/"+u1+$_},V_=function(t){t.write(nD("")),t.close();var e=t.parentWindow.Object;return t=null,e},yY=function(){var t=CY("iframe"),e="java"+u1+":",r;return t.style.display="none",vY.appendChild(t),t.src=String(e),r=t.contentWindow.document,r.open(),r.write(nD("document.F=Object")),r.close(),r.F},nm,Zp=function(){try{nm=new ActiveXObject("htmlfile")}catch{}Zp=typeof document<"u"?document.domain&&nm?V_(nm):yY():V_(nm);for(var t=L_.length;t--;)delete Zp[l1][L_[t]];return Zp()};wY[rD]=!0;var bY=Object.create||function(e,r){var n;return e!==null?(AC[l1]=mY(e),n=new AC,AC[l1]=null,n[rD]=e):n=Zp(),r===void 0?n:pY.f(n,r)},xY=yl,RY=bY,EY=bl.f,c1=xY("unscopables"),h1=Array.prototype;h1[c1]===void 0&&EY(h1,c1,{configurable:!0,value:RY(null)});var lx=function(t){h1[c1][t]=!0},TY=lx;TY("flatMap");function kt(){ke(console)&&console.warn(...arguments)}function ux(){ke(console)&&console.error(...arguments)}function _Y(t,e,r){return(e=AY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function AY(t){var e=MY(t,"string");return typeof e=="symbol"?e:e+""}function MY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const oc=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],OY=Ft`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`,MC=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),OC=new Map([[]]),im=new WeakMap;class He{static getSingleton(){return PY()}constructor(){_Y(this,"globalBucket",void 0),this.globalBucket=this.createEmptyBucket()}createEmptyBucket(){const e=Object.create(null);return V(oc,r=>{e[r]=[],this.initOrderMap(e,r)}),e}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=this.createEmptyBucket()),e.pluginHookBucket):this.globalBucket}add(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;if(Array.isArray(r))V(r,s=>this.add(e,s,n));else{MC.has(e)&&kt(jb(OY,{hookName:e,removedInVersion:MC.get(e)})),OC.has(e)&&kt(OC.get(e));const s=this.getBucket(n);if(typeof s[e]>"u"&&(this.register(e),s[e]=[],this.initOrderMap(s,e)),r.skip=!1,s[e].indexOf(r)===-1){let o=!1;r.initialHook&&V(s[e],(a,l)=>{if(a.initialHook)return s[e][l]=r,o=!0,!1}),o||s[e].push(r)}this.setCallbackOrderIndex(s,e,r,i),this.orderBucketByOrderIndex(s,e)}return this}once(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;Array.isArray(r)?V(r,s=>this.once(e,s,n)):(r.runOnce=!0,this.add(e,r,n,i))}remove(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;const i=this.getBucket(n);return typeof i[e]<"u"&&i[e].indexOf(r)>=0?(r.skip=!0,!0):!1}has(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const n=this.getBucket(r);return!!(n[e]!==void 0&&n[e].length)}run(e,r,n,i,s,o,a,l){{const u=this.globalBucket[r],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=_0(u[h],e,n,i,s,o,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h]),h+=1}}{const u=this.getBucket(e)[r],c=u?u.length:0;let h=0;if(c)for(;h<c;){if(!u[h]||u[h].skip){h+=1;continue}const d=_0(u[h],e,n,i,s,o,a,l);d!==void 0&&(n=d),u[h]&&u[h].runOnce&&this.remove(r,u[h],e),h+=1}}return n}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;ct(this.getBucket(e),(r,n,i)=>i[n].length=0)}register(e){this.isRegistered(e)||oc.push(e)}deregister(e){this.isRegistered(e)&&oc.splice(oc.indexOf(e),1)}isDeprecated(e){return OC.has(e)||MC.has(e)}isRegistered(e){return oc.indexOf(e)>=0}getRegistered(){return oc}setCallbackOrderIndex(e,r,n,i){const s=Number.isInteger(i)?i:0,o=this.getCallbackOrderMap(e,r);o.set(s,[...o.get(s)||[],n])}orderBucketByOrderIndex(e,r){const n=this.getCallbackOrderMap(e,r);n===void 0||n.size===0||n.size===1&&n.has(0)||(e[r]=[...n].sort((i,s)=>i[0]-s[0]).flatMap(i=>{let[,s]=i;return s}))}initOrderMap(e,r){im.has(e)||im.set(e,[]),im.get(e)[r]=new Map}getCallbackOrderMap(e,r){return im.get(e)[r]}}const IY=new He;function PY(){return IY}const IC=new Map;function Ds(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";IC.has(t)||IC.set(t,new Map);const e=IC.get(t);function r(a,l){e.set(a,l)}function n(a){return e.get(a)}function i(a){return e.has(a)}function s(){return[...e.keys()]}function o(){return[...e.values()]}return{register:r,getItem:n,hasItem:i,getNames:s,getValues:o}}const d1=new WeakMap,{register:NY,getItem:iD,hasItem:sD,getNames:DY,getValues:eye}=Ds("editors");function HY(t){const e={},r=t;this.getConstructor=function(){return t},this.getInstance=function(n){return n.guid in e||(e[n.guid]=new r(n)),e[n.guid]},He.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function oD(t,e){let r;if(typeof t=="function")d1.get(t)||Jn(null,t),r=d1.get(t);else if(typeof t=="string")r=iD(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!r)throw Error(`No editor registered under name "${t}"`);return r.getInstance(e)}function A0(t){if(typeof t=="function")return t;if(!sD(t))throw Error(`No registered editor found under "${t}" name`);return iD(t).getConstructor()}function Jn(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const r=new HY(e);typeof t=="string"&&NY(t,r),d1.set(e,r)}function kY(t,e,r){return(e=FY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FY(t){var e=LY(t,"string");return typeof e=="symbol"?e:e+""}function LY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let Jp=0;class Xi{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;kY(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function s(o){n.call(this,$Y(o))}return this.context.eventListeners.push({element:e,event:r,callback:n,callbackProxy:s,options:i,eventManager:this}),e.addEventListener(r,s,i),Jp+=1,()=>{this.removeEventListener(e,r,n)}}removeEventListener(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=this.context.eventListeners.length,o;for(;s;)if(s-=1,o=this.context.eventListeners[s],o.event===r&&o.element===e){if(n&&n!==o.callback||i&&o.eventManager!==this)continue;this.context.eventListeners.splice(s,1),o.element.removeEventListener(o.event,o.callbackProxy,o.options),Jp-=1}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let r=this.context.eventListeners.length;for(;r;){r-=1;const n=this.context.eventListeners[r];e&&n.eventManager!==this||(this.context.eventListeners.splice(r,1),n.element.removeEventListener(n.event,n.callbackProxy,n.options),Jp-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,r){let n=e.document,i=e;n||(n=e.ownerDocument?e.ownerDocument:e,i=n.defaultView);const s={bubbles:!0,cancelable:r!=="mousemove",view:i,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};let o;n.createEvent?(o=n.createEvent("MouseEvents"),o.initMouseEvent(r,s.bubbles,s.cancelable,s.view,s.detail,s.screenX,s.screenY,s.clientX,s.clientY,s.ctrlKey,s.altKey,s.shiftKey,s.metaKey,s.button,n.body.parentNode)):o=n.createEventObject(),e.dispatchEvent?e.dispatchEvent(o):e.fireEvent(`on${r}`,o)}}function $Y(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),Ji(this)},t}function BY(){return Jp}function VY(t,e){WY(t,e),e.add(t)}function WY(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ol(t,e,r){return(e=UY(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function UY(t){var e=jY(t,"string");return typeof e=="symbol"?e:e+""}function jY(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function W_(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var PC=new WeakSet;class f1{constructor(e,r,n){VY(this,PC),Ol(this,"hot",void 0),Ol(this,"tableMeta",void 0),Ol(this,"selection",void 0),Ol(this,"eventManager",void 0),Ol(this,"destroyed",!1),Ol(this,"activeEditor",void 0),Ol(this,"cellProperties",void 0),this.hot=e,this.tableMeta=r,this.selection=n,this.eventManager=new Xi(e),this.hot.addHook("afterDocumentKeyDown",i=>W_(PC,this,zY).call(this,i)),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"compositionstart",i=>{!this.destroyed&&this.hot.isListening()&&this.openEditor("",i)}),this.hot.view._wt.update("onCellDblClick",(i,s,o)=>W_(PC,this,YY).call(this,i,s,o))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,u=>{u&&this.prepareEditor()});return}const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||r.isHeader())return;const{row:n,col:i}=r,s=this.hot.runHooks("modifyGetCellCoords",n,i);let o=n,a=i;if(Array.isArray(s)&&([o,a]=s),this.cellProperties=this.hot.getCellMeta(o,a),!this.isCellEditable()){this.clearActiveEditor();return}const l=this.hot.getCell(n,i,!0);if(l){const u=this.hot.getCellEditor(this.cellProperties),c=this.hot.colToProp(a),h=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o),a);this.activeEditor=oD(u,this.hot),this.activeEditor.prepare(n,i,c,l,h,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const i=this.hot.getSelectedRangeLast();let s=this.hot.runHooks("beforeBeginEditing",i.highlight.row,i.highlight.col,e,r,n);if(r instanceof MouseEvent&&typeof s!="boolean"&&(s=this.hot.selection.getLayerLevel()===0&&i.isSingle()),s===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(n&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,r))}closeEditor(e,r,n){this.activeEditor?this.activeEditor.finishEditing(e,r,n):n&&n(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeLast();if(!e)return!1;const r=this.hot.getCellEditor(this.cellProperties),{row:n,col:i}=e.highlight,{rowIndexMapper:s,columnIndexMapper:o}=this.hot,a=s.isHidden(this.hot.toPhysicalRow(n))||o.isHidden(this.hot.toPhysicalColumn(i));return!(this.cellProperties.readOnly||!r||a)}moveSelectionAfterEnter(e){const r={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(r.row=-r.row,r.col=-r.col),this.hot.selection.isMultiple()?this.selection.transformFocus(r.row,r.col):this.selection.transformStart(r.row,r.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function zY(t){const e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||Xa(t))return;const{keyCode:r}=t,n=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!ax(r)&&!JN(r)&&!n&&!this.isEditorOpened()&&this.openEditor("",t)}function YY(t,e){e.isCell()&&this.openEditor(null,t,!0)}const U_=new WeakMap;f1.getInstance=function(t,e,r){let n=U_.get(t);return n||(n=new f1(t,e,r),U_.set(t,n)),n};function GY(t,e){aD(t,e),e.add(t)}function zh(t,e,r){aD(t,e),e.set(t,r)}function aD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dr(t,e){return t.get(Zo(t,e))}function Yh(t,e,r){return t.set(Zo(t,e),r),r}function Zo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const oh=Object.freeze({CELL:"cell",MIXED:"mixed"});var en=new WeakMap,sm=new WeakMap,om=new WeakMap,am=new WeakMap,lm=new WeakMap,Ua=new WeakSet;class KY{constructor(e){var r=this;GY(this,Ua),zh(this,en,void 0),zh(this,sm,void 0),zh(this,om,1),zh(this,am,null),zh(this,lm,new Map);const n=e.getSettings();Yh(en,this,e),Yh(sm,this,n.imeFastEdit?oh.MIXED:oh.CELL),dr(en,this).addHook("afterUpdateSettings",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Zo(Ua,r,qY).call(r,...s)}),dr(en,this).addHook("afterSelection",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Zo(Ua,r,j_).call(r,...s)}),dr(en,this).addHook("afterSelectionFocusSet",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Zo(Ua,r,j_).call(r,...s)}),dr(en,this).addHook("afterSelectionEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Zo(Ua,r,XY).call(r,...s)})}getFocusMode(){return dr(sm,this)}setFocusMode(e){Object.values(oh).includes(e)?Yh(sm,this,e):kt(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return dr(om,this)}setRefocusDelay(e){Yh(om,this,e)}setRefocusElementGetter(e){Yh(am,this,e)}getRefocusElement(){if(typeof dr(am,this)=="function")return dr(am,this).call(this);var e;return(e=dr(en,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const r=n=>{var i,s;const o=(i=dr(en,this).getSelectedRangeLast())===null||i===void 0?void 0:i.highlight;if(!o)return;let a=dr(en,this).runHooks("modifyFocusedElement",o.row,o.col,n);a instanceof HTMLElement||(a=n),a&&!((s=dr(en,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())&&a.focus({preventScroll:!0})};e?r(e):Zo(Ua,this,cx).call(this,n=>r(n))}refocusToEditorTextarea(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:dr(om,this);const n=this.getRefocusElement();dr(en,this).getSettings().imeFastEdit&&!((e=dr(en,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())&&n&&(dr(lm,this).has(r)||dr(lm,this).set(r,nv(()=>{n.select()},r)),dr(lm,this).get(r)())}}function cx(t){var e;const r=(e=dr(en,this).getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;if(!r||!dr(en,this).selection.isCellVisible(r)){t(null);return}const n=dr(en,this).getCell(r.row,r.col,!0);n===null?dr(en,this).addHookOnce("afterScroll",()=>{t(dr(en,this).getCell(r.row,r.col,!0))}):t(n)}function j_(){Zo(Ua,this,cx).call(this,t=>{const{activeElement:e}=dr(en,this).rootDocument;e&&rv(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function XY(){Zo(Ua,this,cx).call(this,t=>{this.getFocusMode()===oh.MIXED&&t.nodeName==="TD"&&this.refocusToEditorTextarea()})}function qY(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?oh.MIXED:oh.CELL)}var ZY=So,JY=Bu,QY=yl,e9=QY("match"),t9=function(t){var e;return ZY(t)&&((e=t[e9])!==void 0?!!e:JY(t)==="RegExp")},r9=pa,n9=function(){var t=r9(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},i9=Is,s9=yo,o9=Dw,a9=n9,z_=RegExp.prototype,l9=function(t){var e=t.flags;return e===void 0&&!("flags"in z_)&&!s9(t,"flags")&&o9(z_,t)?i9(a9,t):e},hx=Br,u9=ag,c9=Math.floor,NC=hx("".charAt),h9=hx("".replace),DC=hx("".slice),d9=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,f9=/\$([$&'`]|\d{1,2})/g,g9=function(t,e,r,n,i,s){var o=r+t.length,a=n.length,l=f9;return i!==void 0&&(i=u9(i),l=d9),h9(s,l,function(u,c){var h;switch(NC(c,0)){case"$":return"$";case"&":return t;case"`":return DC(e,0,r);case"'":return DC(e,o);case"<":h=i[DC(c,1,-1)];break;default:var d=+c;if(d===0)return u;if(d>a){var f=c9(d/10);return f===0?u:f<=a?n[f-1]===void 0?NC(c,1):n[f-1]+NC(c,1):u}h=n[d-1]}return h===void 0?"":h})},m9=pn,p9=Is,dx=Br,Y_=sg,w9=mn,v9=Pw,C9=t9,Gh=$w,S9=Fw,y9=l9,b9=g9,x9=yl,R9=x9("replace"),E9=TypeError,HC=dx("".indexOf);dx("".replace);var G_=dx("".slice),T9=Math.max;m9({target:"String",proto:!0},{replaceAll:function(e,r){var n=Y_(this),i,s,o,a,l,u,c,h,d,f,m=0,g="";if(!v9(e)){if(i=C9(e),i&&(s=Gh(Y_(y9(e))),!~HC(s,"g")))throw new E9("`.replaceAll` does not allow non-global regexes");if(o=S9(e,R9),o)return p9(o,e,n,r)}for(a=Gh(n),l=Gh(e),u=w9(r),u||(r=Gh(r)),c=l.length,h=T9(1,c),d=HC(a,l);d!==-1;)f=u?Gh(r(l,d,a)):b9(l,a,d,[],void 0,r),g+=G_(a,m,d)+f,m=d+c,d=d+h>a.length?-1:HC(a,l,d+h);return m<a.length&&(g+=G_(a,m)),g}});const lD={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},_9=new RegExp(Object.keys(lD).map(t=>`(${t})`).join("|"),"gi");function A9(t){return(t&&t.nodeName||"")==="TABLE"}function g1(t){const e=t.hasColHeaders(),r=t.hasRowHeaders(),n=[e?-1:0,r?-1:0,t.countRows()-1,t.countCols()-1],i=t.getData(...n),s=i.length,o=s>0?i[0].length:0,a=["<table>","</table>"],l=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=r?1:0,h=e?1:0;for(let d=0;d<s;d+=1){const f=e&&d===0,m=[];for(let w=0;w<o;w+=1){const S=!f&&r&&w===0;let b="";if(f)b=`<th>${t.getColHeader(w-c)}</th>`;else if(S)b=`<th>${t.getRowHeader(d-h)}</th>`;else{const y=i[d][w],{hidden:_,rowspan:P,colspan:z}=t.getCellMeta(d-h,w-c);if(!_){const I=[];if(P&&I.push(`rowspan="${P}"`),z&&I.push(`colspan="${z}"`),br(y))b=`<td ${I.join(" ")}></td>`;else{const W=y.toString().replace("<","&lt;").replace(">","&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");b=`<td ${I.join(" ")}>${W}</td>`}}}m.push(b)}const g=["<tr>",...m,"</tr>"].join("");f?l.splice(1,0,g):u.splice(-1,0,g)}return a.splice(1,0,l.join(""),u.join("")),a.join("")}function m1(t){const e=t.length,r=["<table>"];for(let n=0;n<e;n+=1){const i=t[n],s=i.length,o=[];n===0&&r.push("<tbody>");for(let a=0;a<s;a+=1){const l=i[a],u=br(l)?"":l.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,c=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(c.length-1)} </span>`).replace(/\t/gi,"&#9;");o.push(`<td>${u}</td>`)}r.push("<tr>",...o,"</tr>"),n+1===e&&r.push("</tbody>")}return r.push("</table>"),r.join("")}function uD(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const r={},n=e.createDocumentFragment(),i=e.createElement("div");n.appendChild(i);let s=t;if(typeof s=="string"){const y=s.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,_=>{const P=_.match(/<td\b[^>]*?>/g)[0],z=/<p.*?>/g,I=_.substring(P.length,_.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(z,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${P}${I}</td>`});i.insertAdjacentHTML("afterbegin",`${y}`),s=i.querySelector("table")}if(!s||!A9(s))return;const o=i.querySelector('meta[name$="enerator"]'),a=s.querySelector("tbody th")!==null,l=s.querySelector("tr"),u=l?Array.from(l.cells).reduce((y,_)=>y+_.colSpan,0)-(a?1:0):0,c=s.tFoot&&Array.from(s.tFoot.rows)||[],h=[];let d=!1,f=0,m=0;if(s.tHead){const y=Array.from(s.tHead.rows).filter(_=>{const P=_.querySelector("td")!==null;return P&&h.push(_),!P});f=y.length,d=f>0,f>1?r.nestedHeaders=Array.from(y).reduce((_,P)=>{const z=Array.from(P.cells).reduce((I,W,L)=>{if(a&&L===0)return I;const{colSpan:U,innerHTML:G}=W,X=U>1?{label:G,colspan:U}:G;return I.push(X),I},[]);return _.push(z),_},[]):d&&(r.colHeaders=Array.from(y[0].children).reduce((_,P,z)=>(a&&z===0||_.push(P.innerHTML),_),[]))}h.length&&(r.fixedRowsTop=h.length),c.length&&(r.fixedRowsBottom=c.length);const g=[...h,...Array.from(s.tBodies).reduce((y,_)=>(y.push(...Array.from(_.rows)),y),[]),...c];m=g.length;const w=new Array(m);for(let y=0;y<m;y++)w[y]=new Array(u);const S=[],b=[];for(let y=0;y<m;y++){const _=g[y],P=Array.from(_.cells),z=P.length;for(let I=0;I<z;I++){const W=P[I],{nodeName:L,innerHTML:U,rowSpan:G,colSpan:X}=W,le=w[y].findIndex(xe=>xe===void 0);if(L==="TD"){if(G>1||X>1){for(let Le=y;Le<y+G;Le++)if(Le<m)for(let Ne=le;Ne<le+X;Ne++)w[Le][Ne]=null;const be=W.getAttribute("style");be&&be.includes("mso-ignore:colspan")||S.push({col:le,row:y,rowspan:G,colspan:X})}let xe="";o&&/excel/gi.test(o.content)?xe=U.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):xe=U.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),w[y][le]=xe.replace(_9,be=>lD[be])}else b.push(U)}}return S.length&&(r.mergeCells=S),b.length&&(r.rowHeaders=b),w.length&&(r.data=w),r}const M9=Object.freeze(Object.defineProperty({__proto__:null,_dataToHTML:m1,htmlToGridSettings:uD,instanceToHTML:g1},Symbol.toStringTag,{value:"Module"}));function xn(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=typeof t;if(r==="number")return!isNaN(t)&&isFinite(t);if(r==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const n=Array.from(new Set([".",...e])).map(i=>`\\${i}`).join("|");return new RegExp(`^[+-]?(((${n})?\\d+((${n})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(r==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function cD(t){return xn(t,[","])}function Ue(t,e,r){let n=-1;for(typeof e=="function"?(r=e,e=t):n=t-1;++n<=e&&r(n)!==!1;);}function p1(t,e,r){let n=t+1;for(typeof e=="function"&&(r=e,e=0);--n>=e&&r(n)!==!1;);}function fx(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function Ht(t,e,r){return Math.min(t,e)===t?e:Math.max(t,r)===t?r:t}const O9=Object.freeze(Object.defineProperty({__proto__:null,clamp:Ht,isNumeric:xn,isNumericLike:cD,rangeEach:Ue,rangeEachReverse:p1,valueAccordingPercent:fx},Symbol.toStringTag,{value:"Module"})),w1="asc",I9="desc",K_=new Map([[w1,[-1,1]],[I9,[1,-1]]]),P9=t=>`The priority '${t}' is already declared in a map.`,N9=t=>`The priority '${t}' is not a number.`;function D9(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=new Map;t=Jt(t)?t:P9,e=Jt(e)?e:N9;function n(s,o){if(!xn(s))throw new Error(e(s));if(r.has(s))throw new Error(t(s));r.set(s,o)}function i(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:w1;const[o,a]=K_.get(s)||K_.get(w1);return[...r].sort((l,u)=>l[0]<u[0]?o:a).map(l=>l[1])}return{addItem:n,getItems:i}}const H9=t=>`The id '${t}' is already declared in a map.`;function lv(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Jt(t)?t:H9;function r(u,c){if(l(u))throw new Error(t(u));e.set(u,c)}function n(u){return e.delete(u)}function i(){e.clear()}function s(u){const[c]=a().find(h=>{let[d,f]=h;return u===f?d:!1})||[null];return c}function o(u){return e.get(u)}function a(){return[...e]}function l(u){return e.has(u)}return{addItem:r,clear:i,getId:s,getItem:o,getItems:a,hasItem:l,removeItem:n}}const k9=t=>`'${t}' value is already declared in a unique set.`;function F9(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Jt(t)?t:k9;function r(s){if(e.has(s))throw new Error(t(s));e.add(s)}function n(){return[...e]}function i(){e.clear()}return{addItem:r,clear:i,getItems:n}}const gx=t=>`There is already registered "${t}" plugin.`,L9=t=>`There is already registered plugin on priority "${t}".`,$9=t=>`The priority "${t}" is not a number.`,hD=D9({errorPriorityExists:L9,errorPriorityNaN:$9}),dD=F9({errorItemExists:gx}),v1=lv({errorIdExists:gx});function mx(){return[...hD.getItems(),...dD.getItems()]}function bg(t){const e=An(t);return v1.getItem(e)}function B9(t){return!!bg(t)}function Et(t,e,r){[t,e,r]=W9(t,e,r),bg(t)===void 0&&V9(t,e,r)}function V9(t,e,r){const n=An(t);if(v1.hasItem(n))throw new Error(gx(n));r===void 0?dD.addItem(n):hD.addItem(r,n),v1.addItem(n,e)}function W9(t,e,r){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,r=e.PLUGIN_PRIORITY),[t,e,r]}const{register:U9,getItem:j9,hasItem:fD,getNames:z9,getValues:tye}=Ds("renderers");function M0(t){if(typeof t=="function")return t;if(!fD(t))throw Error(`No registered renderer found under "${t}" name`);return j9(t)}function di(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),U9(t,e)}const{register:Y9,getItem:G9,hasItem:gD,getNames:K9,getValues:rye}=Ds("validators");function px(t){if(typeof t=="function")return t;if(!gD(t))throw Error(`No registered validator found under "${t}" name`);return G9(t)}function gu(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Y9(t,e)}var X9=pn,q9=ag,Z9=cg,J9=ug,Q9=lx;X9({target:"Array",proto:!0},{at:function(e){var r=q9(this),n=Z9(r),i=J9(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:r[s]}});Q9("at");var e7=pn,t7=Br,r7=sg,n7=ug,i7=$w,s7=ai,o7=t7("".charAt),a7=s7(function(){return"ð ®·".at(-2)!=="\uD842"});e7({target:"String",proto:!0,forced:a7},{at:function(e){var r=i7(r7(this)),n=r.length,i=n7(e),s=i>=0?i:n+i;return s<0||s>=n?void 0:o7(r,s)}});function Kh(t,e,r){return(e=l7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l7(t){var e=u7(t,"string");return typeof e=="symbol"?e:e+""}function u7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class c7{constructor(){Kh(this,"count",0),Kh(this,"startColumn",null),Kh(this,"endColumn",null),Kh(this,"startPosition",null),Kh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s,columnWidth:o}=r,a=i>0?s+1:s;n>=i&&n+o<=i+a&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const m=u[this.endColumn]+c-u[this.startColumn-1];if(m<=i&&(this.startColumn-=1),m>=i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i,d=n+i-h,f=this.startColumn===null?0:e.getColumnWidth(this.startColumn);d<-1*s||n>u.at(-1)||-1*n-i>-1*f?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Xh(t,e,r){return(e=h7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h7(t){var e=d7(t,"string");return typeof e=="symbol"?e:e+""}function d7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class f7{constructor(){Xh(this,"count",0),Xh(this,"startRow",null),Xh(this,"endRow",null),Xh(this,"startPosition",null),Xh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s,rowHeight:o}=r;n>=i&&n+o<=s&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const d=l[this.endRow]+u-l[this.startRow-1];if(d<=i-s&&(this.startRow-=1),d>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null;const c=n+i-s,h=this.startRow===null?0:e.getRowHeight(this.startRow);c<h||n>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function qh(t,e,r){return(e=g7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function g7(t){var e=m7(t,"string");return typeof e=="symbol"?e:e+""}function m7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mD{constructor(){qh(this,"count",0),qh(this,"startColumn",null),qh(this,"endColumn",null),qh(this,"startPosition",null),qh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedWidth:n,zeroBasedScrollOffset:i,viewportWidth:s}=r;n<=i&&(this.startColumn=e);const o=i>0?s+1:s;n>=i&&n<=i+o&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var r;const{scrollOffset:n,viewportWidth:i,inlineStartOffset:s,zeroBasedScrollOffset:o,totalColumns:a,needReverse:l,startPositions:u,columnWidth:c}=e;if(this.endColumn===a-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){const f=u[this.endColumn]+c-u[this.startColumn-1];if(this.startColumn-=1,f>i)break}this.startPosition=(r=u[this.startColumn])!==null&&r!==void 0?r:null;const h=o>0?i+1:i;n+i-h<-1*s||n>u.at(-1)+c||-1*n-i>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endColumn&&(this.endColumn=a-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Zh(t,e,r){return(e=p7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p7(t){var e=w7(t,"string");return typeof e=="symbol"?e:e+""}function w7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pD{constructor(){Zh(this,"count",0),Zh(this,"startRow",null),Zh(this,"endRow",null),Zh(this,"startPosition",null),Zh(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,r){const{totalCalculatedHeight:n,zeroBasedScrollOffset:i,innerViewportHeight:s}=r;n<=i&&(this.startRow=e),n>=i&&n<=s&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var r;const{scrollOffset:n,viewportHeight:i,horizontalScrollbarHeight:s,totalRows:o,needReverse:a,startPositions:l,rowHeight:u}=e;if(this.endRow===o-1&&a)for(this.startRow=this.endRow;this.startRow>0;){const h=l[this.endRow]+u-l[this.startRow-1];if(this.startRow-=1,h>=i-s)break}this.startPosition=(r=l[this.startRow])!==null&&r!==void 0?r:null,n+i-s<0||n>l.at(-1)+u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Jh(t,e,r){return(e=v7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function v7(t){var e=C7(t,"string");return typeof e=="symbol"?e:e+""}function C7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class S7{constructor(){Jh(this,"count",0),Jh(this,"startColumn",0),Jh(this,"endColumn",0),Jh(this,"startPosition",0),Jh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:r}=e;this.count=r,this.endColumn=this.count-1}process(){}finalize(){}}function Qh(t,e,r){return(e=y7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function y7(t){var e=b7(t,"string");return typeof e=="symbol"?e:e+""}function b7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class x7{constructor(){Qh(this,"count",0),Qh(this,"startRow",0),Qh(this,"endRow",0),Qh(this,"startPosition",0),Qh(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:r}=e;this.count=r,this.endRow=this.count-1}process(){}finalize(){}}class R7 extends mD{finalize(e){var r;super.finalize(e);const{overrideFn:n,totalColumns:i,startPositions:s}=e;this.startColumn!==null&&typeof n=="function"&&n(this),this.startColumn<0&&(this.startColumn=0),this.startPosition=(r=s[this.startColumn])!==null&&r!==void 0?r:null,i<this.endColumn&&(this.endColumn=i-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}class E7 extends pD{finalize(e){var r;super.finalize(e);const{overrideFn:n,totalRows:i,startPositions:s}=e;this.startRow!==null&&typeof n=="function"&&n(this),this.startRow<0&&(this.startRow=0),this.startPosition=(r=s[this.startRow])!==null&&r!==void 0?r:null,i<this.endRow&&(this.endRow=i-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function X_(t,e,r){return(e=T7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function T7(t){var e=_7(t,"string");return typeof e=="symbol"?e:e+""}function _7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wD{constructor(e){X_(this,"calculationTypes",[]),X_(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(r=>{let[n,i]=r;this.calculationResults.set(n,i),i.initialize(e)})}_process(e,r){this.calculationTypes.forEach(n=>{let[,i]=n;return i.process(e,r)})}_finalize(e){this.calculationTypes.forEach(r=>{let[,n]=r;return n.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function ts(t,e,r){return(e=A7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function A7(t){var e=M7(t,"string");return typeof e=="symbol"?e:e+""}function M7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uv=50;class O7 extends wD{constructor(e){let{calculationTypes:r,viewportWidth:n,scrollOffset:i,totalColumns:s,columnWidthFn:o,overrideFn:a,inlineStartOffset:l}=e;super(r),ts(this,"viewportWidth",0),ts(this,"scrollOffset",0),ts(this,"zeroBasedScrollOffset",0),ts(this,"totalColumns",0),ts(this,"columnWidthFn",null),ts(this,"columnWidth",0),ts(this,"overrideFn",null),ts(this,"inlineStartOffset",0),ts(this,"totalCalculatedWidth",0),ts(this,"startPositions",[]),ts(this,"needReverse",!0),this.viewportWidth=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalColumns=s,this.columnWidthFn=o,this.overrideFn=a,this.inlineStartOffset=l,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const r=this.columnWidthFn(e);return isNaN(r)?uv:r}}function _i(t,e,r){return(e=I7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function I7(t){var e=P7(t,"string");return typeof e=="symbol"?e:e+""}function P7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const vD=23;class N7 extends wD{constructor(e){let{calculationTypes:r,viewportHeight:n,scrollOffset:i,totalRows:s,rowHeightFn:o,overrideFn:a,horizontalScrollbarHeight:l}=e;super(r),_i(this,"viewportHeight",0),_i(this,"scrollOffset",0),_i(this,"zeroBasedScrollOffset",0),_i(this,"totalRows",0),_i(this,"rowHeightFn",null),_i(this,"rowHeight",0),_i(this,"overrideFn",null),_i(this,"horizontalScrollbarHeight",0),_i(this,"innerViewportHeight",0),_i(this,"totalCalculatedHeight",0),_i(this,"startPositions",[]),_i(this,"needReverse",!0),this.viewportHeight=n,this.scrollOffset=i,this.zeroBasedScrollOffset=Math.max(i,0),this.totalRows=s,this.rowHeightFn=o,this.overrideFn=a,this.horizontalScrollbarHeight=l??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const r=this.rowHeightFn(e);return isNaN(r)?vD:r}}function D7(t,e,r){H7(t,e),e.set(t,r)}function H7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function q_(t,e,r){return(e=k7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function k7(t){var e=F7(t,"string");return typeof e=="symbol"?e:e+""}function F7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ac(t,e){return t.get(CD(t,e))}function Z_(t,e,r){return t.set(CD(t,e),r),r}function CD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Io=new WeakMap;class Iu{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;q_(this,"row",null),q_(this,"col",null),D7(this,Io,!1),Z_(Io,this,n),typeof e<"u"&&typeof r<"u"&&(this.row=e,this.col=r)}isValid(e){const{countRows:r,countCols:n,countRowHeaders:i,countColHeaders:s}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-s||this.col<-i||this.row>=r||this.col>=n)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return ac(Io,this)}isSouthEastOf(e){return this.row>=e.row&&(ac(Io,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(ac(Io,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(ac(Io,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(ac(Io,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e==null?void 0:e.row)&&(this.row=e.row),Number.isInteger(e==null?void 0:e.col)&&(this.col=e.col),e instanceof Iu&&Z_(Io,this,e.isRtl()),this}clone(){return new Iu(this.row,this.col,ac(Io,this))}toObject(){return{row:this.row,col:this.col}}}function L7(t,e,r){$7(t,e),e.set(t,r)}function $7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kC(t,e,r){return(e=B7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B7(t){var e=V7(t,"string");return typeof e=="symbol"?e:e+""}function V7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ai(t,e){return t.get(SD(t,e))}function W7(t,e,r){return t.set(SD(t,e),r),r}function SD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jn=new WeakMap;class xg{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;kC(this,"highlight",null),kC(this,"from",null),kC(this,"to",null),L7(this,jn,!1),this.highlight=e.clone(),this.from=r.clone(),this.to=n.clone(),W7(jn,this,i)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),r=Math.max(this.to.row,0);return Math.max(e,r)-Math.min(e,r)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),r=Math.max(this.to.col,0);return Math.max(e,r)-Math.min(e,r)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:r,col:n}=e,i=this.getOuterTopStartCorner(),s=this.getOuterBottomEndCorner();return i.row<=r&&s.row>=r&&i.col<=n&&s.col>=n}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return e.row<r.row||e.col<r.col||e.row>n.row||e.col>n.col?(this.from=this._createCellCoords(Math.min(r.row,e.row),Math.min(r.col,e.col)),this.to=this._createCellCoords(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0):!1}expandByRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner(),s=this.getDirection(),o=e.getOuterTopStartCorner(),a=e.getOuterBottomEndCorner(),l=Math.min(n.row,o.row),u=Math.min(n.col,o.col),c=Math.max(i.row,a.row),h=Math.max(i.col,a.col),d=this._createCellCoords(l,u),f=this._createCellCoords(c,h);return this.from=d,this.to=f,this.setDirection(s),r&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return Ai(jn,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return Ai(jn,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return Ai(jn,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return Ai(jn,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return Ai(jn,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return Ai(jn,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return Ai(jn,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return Ai(jn,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Iu))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const r={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return r.top===n.top&&i.push("top"),r.right===n.right&&i.push(Ai(jn,this)?"left":"right"),r.bottom===n.bottom&&i.push("bottom"),r.left===n.left&&i.push(Ai(jn,this)?"right":"left"),i}getInner(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)!(this.from.row===i&&this.from.col===s)&&!(this.to.row===i&&this.to.col===s)&&n.push(this._createCellCoords(i,s));return n}getAll(){const e=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=[];for(let i=e.row;i<=r.row;i++)for(let s=e.col;s<=r.col;s++)e.row===i&&e.col===s?n.push(e):r.row===i&&r.col===s?n.push(r):n.push(this._createCellCoords(i,s));return n}forAll(e){const r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();for(let i=r.row;i<=n.row;i++)for(let s=r.col;s<=n.col;s++)if(e(i,s)===!1)return}clone(){return new xg(this.highlight,this.from,this.to,Ai(jn,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,r){return new Iu(e,r,Ai(jn,this))}}function ks(t,e,r){U7(t,e),e.set(t,r)}function U7(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ze(t,e){return t.get(yD(t,e))}function Ta(t,e,r){return t.set(yD(t,e),r),r}function yD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Mi=new WeakMap,FC=new WeakMap,Zr=new WeakMap,lc=new WeakMap,um=new WeakMap,rs=new WeakMap,LC=new WeakMap,ed=new WeakMap,Il=new WeakMap,Fs=new WeakMap;let bD=class{constructor(e,r,n,i,s,o){let a=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;ks(this,Mi,void 0),ks(this,FC,void 0),ks(this,Zr,void 0),ks(this,lc,void 0),ks(this,um,void 0),ks(this,rs,void 0),ks(this,LC,void 0),ks(this,ed,void 0),ks(this,Il,[null,null]),ks(this,Fs,[null,null]),Ta(Mi,this,n),Ta(FC,this,r),Ta(Zr,this,s),Ta(lc,this,o),Ta(um,this,a),Ta(rs,this,i),Ta(LC,this,e),this.registerEvents()}registerEvents(){ze(rs,this).addEventListener(ze(Zr,this).holder,"contextmenu",n=>this.onContextMenu(n)),ze(rs,this).addEventListener(ze(Zr,this).TABLE,"mouseover",n=>this.onMouseOver(n)),ze(rs,this).addEventListener(ze(Zr,this).TABLE,"mouseout",n=>this.onMouseOut(n));const e=()=>{ze(rs,this).addEventListener(ze(Zr,this).holder,"touchstart",n=>this.onTouchStart(n)),ze(rs,this).addEventListener(ze(Zr,this).holder,"touchend",n=>this.onTouchEnd(n)),this.momentumScrolling||(this.momentumScrolling={}),ze(rs,this).addEventListener(ze(Zr,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||ze(Mi,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,ze(Mi,this).getSetting("onAfterMomentumScroll"))},200)})},r=()=>{ze(rs,this).addEventListener(ze(Zr,this).holder,"mouseup",n=>this.onMouseUp(n)),ze(rs,this).addEventListener(ze(Zr,this).holder,"mousedown",n=>this.onMouseDown(n))};ea()?e():(rx()&&e(),r())}selectedCellWasTouched(e){const n=this.parentCell(e).coords;if(ze(ed,this)&&n){const[i,s]=[n.row,ze(ed,this).from.row],[o,a]=[n.col,ze(ed,this).from.col];return i===s&&o===a}return!1}parentCell(e){const r={},n=ze(Zr,this).TABLE,i=zd(e,["TD","TH"],n);return i?(r.coords=ze(Zr,this).getCoords(i),r.TD=i):Qe(e,"wtBorder")&&Qe(e,"current")?(r.coords=ze(lc,this).getFocusSelection().cellRange.highlight,r.TD=ze(Zr,this).getCell(r.coords)):Qe(e,"wtBorder")&&Qe(e,"area")&&ze(lc,this).getAreaSelection().cellRange&&(r.coords=ze(lc,this).getAreaSelection().cellRange.to,r.TD=ze(Zr,this).getCell(r.coords)),r}onMouseDown(e){const r=ze(FC,this).rootDocument.activeElement,n=tx(xN,e.target),i=e.target;if(!["TD","TH"].includes(r.nodeName)&&(i===r||n(0)===r||n(1)===r))return;const s=this.parentCell(i);Qe(i,"corner")?ze(Mi,this).getSetting("onCellCornerMouseDown",e,i):s.TD&&ze(Mi,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,s.coords,s.TD),(e.button===0||this.touchApplied)&&s.TD&&(ze(Fs,this)[0]=s.TD,clearTimeout(ze(Il,this)[0]),ze(Il,this)[0]=setTimeout(()=>{ze(Fs,this)[0]=null},1e3))}onContextMenu(e){if(ze(Mi,this).has("onCellContextMenu")){const r=this.parentCell(e.target);r.TD&&this.callListener("onCellContextMenu",e,r.coords,r.TD)}}onMouseOver(e){if(!ze(Mi,this).has("onCellMouseOver"))return;const r=ze(Zr,this).TABLE,n=zd(e.target,["TD","TH"],r),i=ze(um,this)||this;n&&n!==i.lastMouseOver&&ll(n,r)&&(i.lastMouseOver=n,this.callListener("onCellMouseOver",e,ze(Zr,this).getCoords(n),n))}onMouseOut(e){if(!ze(Mi,this).has("onCellMouseOut"))return;const r=ze(Zr,this).TABLE,n=zd(e.target,["TD","TH"],r),i=zd(e.relatedTarget,["TD","TH"],r),s=ze(um,this)||this;n&&n!==i&&ll(n,r)&&(this.callListener("onCellMouseOut",e,ze(Zr,this).getCoords(n),n),i===null&&(s.lastMouseOver=null))}onMouseUp(e){const r=this.parentCell(e.target);r.TD&&ze(Mi,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,r.coords,r.TD),!(e.button!==0&&!this.touchApplied)&&(r.TD===ze(Fs,this)[0]&&r.TD===ze(Fs,this)[1]?(Qe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,r.coords,r.TD):this.callListener("onCellDblClick",e,r.coords,r.TD),ze(Fs,this)[0]=null,ze(Fs,this)[1]=null):r.TD===ze(Fs,this)[0]&&(ze(Fs,this)[1]=r.TD,clearTimeout(ze(Il,this)[1]),ze(Il,this)[1]=setTimeout(()=>{ze(Fs,this)[1]=null},500)))}onTouchStart(e){Ta(ed,this,ze(lc,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var r;const n=e.target,i=(r=this.parentCell(n))===null||r===void 0?void 0:r.coords,s=ke(i)&&i.row>=0&&i.col>=0;if(e.cancelable&&s&&ze(Mi,this).getSetting("isDataViewInstance")){const a=["A","BUTTON","INPUT"];sx()&&(KN()||XN())&&this.selectedCellWasTouched(n)&&!a.includes(n.tagName)?e.preventDefault():this.selectedCellWasTouched(n)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,r,n,i){const s=ze(Mi,this).getSettingPure(e);s&&s(r,n,i,ze(LC,this).call(this))}destroy(){clearTimeout(ze(Il,this)[0]),clearTimeout(ze(Il,this)[1]),ze(rs,this).destroy()}};function $C(t,e,r){return(e=j7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function j7(t){var e=z7(t,"string");return typeof e=="symbol"?e:e+""}function z7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Y7{constructor(e,r,n){$C(this,"offset",void 0),$C(this,"total",void 0),$C(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function BC(t,e,r){return(e=G7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function G7(t){var e=K7(t,"string");return typeof e=="symbol"?e:e+""}function K7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X7{constructor(e,r,n){BC(this,"offset",void 0),BC(this,"total",void 0),BC(this,"countTH",void 0),this.offset=e,this.total=r,this.countTH=n}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}const q7=0,O0=1,I0=2;function cm(t,e,r){return(e=Z7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Z7(t){var e=J7(t,"string");return typeof e=="symbol"?e:e+""}function J7(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J_{constructor(){cm(this,"currentSize",0),cm(this,"nextSize",0),cm(this,"currentOffset",0),cm(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function VC(t,e,r){return(e=Q7(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Q7(t){var e=eG(t,"string");return typeof e=="symbol"?e:e+""}function eG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tG{constructor(){VC(this,"size",new J_),VC(this,"workingSpace",q7),VC(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize instanceof J_}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=O0,e.workingSpace=I0,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=I0,e.workingSpace=O0,this.sharedSize=e.getViewSize()}}function uc(t,e,r){return(e=rG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function rG(t){var e=nG(t,"string");return typeof e=="symbol"?e:e+""}function nG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xD{constructor(e,r,n){uc(this,"rootNode",void 0),uc(this,"nodesPool",void 0),uc(this,"sizeSet",new tG),uc(this,"childNodeType",void 0),uc(this,"visualIndex",0),uc(this,"collectedNodes",[]),this.rootNode=e,this.nodesPool=r,this.childNodeType=n.toUpperCase()}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}getRenderedChildCount(){const{rootNode:e,sizeSet:r}=this;let n=0;if(this.isSharedViewSet()){let i=e.firstElementChild;for(;i;){if(i.tagName===this.childNodeType)n+=1;else if(r.isPlaceOn(O0))break;i=i.nextElementSibling}}else n=e.childElementCount;return n}start(){this.collectedNodes.length=0,this.visualIndex=0;const{rootNode:e,sizeSet:r}=this,n=this.isSharedViewSet(),{nextSize:i}=r.getViewSize();let s=this.getRenderedChildCount();for(;s<i;){const a=this.nodesPool();!n||n&&r.isPlaceOn(I0)?e.appendChild(a):e.insertBefore(a,e.firstChild),s+=1}const o=n&&r.isPlaceOn(O0);for(;s>i;)e.removeChild(o?e.firstChild:e.lastChild),s-=1}render(){const{rootNode:e,sizeSet:r}=this;let n=this.visualIndex;this.isSharedViewSet()&&r.isPlaceOn(I0)&&(n+=r.sharedSize.nextSize);let i=e.childNodes[n];if(i.tagName!==this.childNodeType){const s=this.nodesPool();e.replaceChild(s,i),i=s}this.collectedNodes.push(i),this.visualIndex+=1}end(){}}class RD extends xD{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function iG(t,e,r){return(e=sG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sG(t){var e=oG(t,"string");return typeof e=="symbol"?e:e+""}function oG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class aG{constructor(e){iG(this,"nodeType",void 0),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(){return this.rootDocument.createElement(this.nodeType)}}function td(t,e,r){return(e=lG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lG(t){var e=uG(t,"string");return typeof e=="symbol"?e:e+""}function uG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rg{constructor(e,r){td(this,"nodesPool",null),td(this,"nodeType",void 0),td(this,"rootNode",void 0),td(this,"table",null),td(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new aG(e):null,this.nodeType=e,this.rootNode=r}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function Q_(t,e,r){return(e=cG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cG(t){var e=hG(t,"string");return typeof e=="symbol"?e:e+""}function hG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class dG extends Rg{constructor(){super("TH"),Q_(this,"orderViews",new WeakMap),Q_(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new RD(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,rowHeaderFunctions:r,rowHeadersCount:n,rows:i,cells:s}=this.table;for(let o=0;o<e;o++){const a=this.table.renderedRowToSource(o),l=i.getRenderedNode(o);this.sourceRowIndex=a;const u=this.obtainOrderView(l),c=s.obtainOrderView(l);u.appendView(c).setSize(n).setOffset(this.table.renderedColumnToSource(0)).start();for(let h=0;h<n;h++){u.render();const d=u.getCurrentNode();d.className="",d.removeAttribute("style"),Ku(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&qe(d,[rz(),hz(),zb(h+1),Th(-1)]),r[h](a,d,h)}u.end()}}}class fG extends Rg{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:r}=this.table;let n=this.rootNode.firstChild;if(e){const{columnsToRender:i}=this.table,s=i+r;for(let a=0,l=e;a<l;a++){for(n=this.rootNode.childNodes[a],n||(n=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(n)),this.renderedNodes=n.childNodes.length;this.renderedNodes<s;)n.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>s;)n.removeChild(n.lastChild),this.renderedNodes-=1}const o=this.rootNode.childNodes.length;if(o>e)for(let a=e;a<o;a++)this.rootNode.removeChild(this.rootNode.lastChild)}else n&&As(n)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&qe(this.rootNode,[wN()]);for(let r=0;r<e;r+=1){const{columnHeaderFunctions:n,columnsToRender:i,rowHeadersCount:s}=this.table,o=this.rootNode.childNodes[r];this.table.isAriaEnabled()&&qe(o,[s1(),yN(r+1)]);for(let a=-1*s;a<i;a+=1){const l=this.table.renderedColumnToSource(a),u=o.childNodes[a+s];u.className="",u.removeAttribute("style"),Ku(u,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&qe(u,[zb(a+1+this.table.rowHeadersCount),Th(-1),nz(),...a>=0?[cz()]:[s1()]]),n[r](l,u,r)}}}}let eA=!1;class gG extends Rg{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:r}=this.table,n=e+r;for(;this.renderedNodes<n;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>n;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:r}=this.table;!eA&&e>1e3&&(eA=!0,kt(Ft`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let i=0;i<r;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getHeaderWidth(s);this.rootNode.childNodes[i].style.width=`${o}px`}for(let i=0;i<e;i++){const s=this.table.renderedColumnToSource(i),o=this.table.columnUtils.getStretchedColumnWidth(s);this.rootNode.childNodes[i+r].style.width=`${o}px`}const n=this.rootNode.firstChild;n&&ve(n,"rowHeader")}}function mG(t,e,r){return(e=pG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pG(t){var e=wG(t,"string");return typeof e=="symbol"?e:e+""}function wG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const hm={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let tA=!1;class vG extends Rg{constructor(e){super("TR",e),mG(this,"orderView",void 0),this.orderView=new xD(e,r=>this.nodesPool.obtain(r),this.nodeType)}getRenderedNode(e){return this.orderView.getNode(e)}render(){const{rowsToRender:e}=this.table;!tA&&e>1e3&&(tA=!0,kt(Ft`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&qe(this.rootNode,[wN()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let i=0;i<e;i++){this.orderView.render();const s=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(i);if(this.table.isAriaEnabled()){var r,n;qe(s,[s1(),yN(o+((r=(n=this.table.rowUtils)===null||n===void 0||(n=n.dataAccessObject)===null||n===void 0?void 0:n.columnHeaders.length)!==null&&r!==void 0?r:0)+1)])}tt(s,[hm.rowEven,hm.rowOdd]),(o+1)%2===0?ve(s,hm.rowEven):ve(s,hm.rowOdd)}this.orderView.end()}}function rA(t,e,r){return(e=CG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function CG(t){var e=SG(t,"string");return typeof e=="symbol"?e:e+""}function SG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yG extends Rg{constructor(){super("TD"),rA(this,"orderViews",new WeakMap),rA(this,"sourceRowIndex",0)}obtainOrderView(e){let r;return this.orderViews.has(e)?r=this.orderViews.get(e):(r=new RD(e,n=>this.nodesPool.obtain(this.sourceRowIndex,n),this.nodeType),this.orderViews.set(e,r)),r}render(){const{rowsToRender:e,columnsToRender:r,rows:n,rowHeaders:i}=this.table;for(let a=0;a<e;a++){const l=this.table.renderedRowToSource(a),u=n.getRenderedNode(a);this.sourceRowIndex=l;const c=this.obtainOrderView(u),h=i.obtainOrderView(u);c.prependView(h).setSize(r).setOffset(this.table.renderedColumnToSource(0)).start();for(let d=0;d<r;d++){c.render();const f=c.getCurrentNode(),m=this.table.renderedColumnToSource(d);if(Qe(f,"hide")||(f.className=""),f.removeAttribute("style"),f.removeAttribute("dir"),Ku(f,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(l,m,f),this.table.isAriaEnabled()){var s,o;qe(f,[...f.hasAttribute("role")?[]:[tz()],Th(-1),zb(m+((s=(o=this.table.rowUtils)===null||o===void 0||(o=o.dataAccessObject)===null||o===void 0?void 0:o.rowHeaders.length)!==null&&s!==void 0?s:0)+1)])}}c.end()}}}function Ur(t,e,r){return(e=bG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bG(t){var e=xG(t,"string");return typeof e=="symbol"?e:e+""}function xG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class RG{constructor(e){let{cellRenderer:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Ur(this,"rootNode",void 0),Ur(this,"rootDocument",void 0),Ur(this,"rowHeaders",null),Ur(this,"columnHeaders",null),Ur(this,"colGroup",null),Ur(this,"rows",null),Ur(this,"cells",null),Ur(this,"rowFilter",null),Ur(this,"columnFilter",null),Ur(this,"rowUtils",null),Ur(this,"columnUtils",null),Ur(this,"rowsToRender",0),Ur(this,"columnsToRender",0),Ur(this,"rowHeaderFunctions",[]),Ur(this,"rowHeadersCount",0),Ur(this,"columnHeaderFunctions",[]),Ur(this,"columnHeadersCount",0),Ur(this,"cellRenderer",void 0),Ur(this,"activeOverlayName",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=r}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,r){this.rowUtils=e,this.columnUtils=r}setViewportSize(e,r){this.rowsToRender=e,this.columnsToRender=r}setFilters(e,r){this.rowFilter=e,this.columnFilter=r}setHeaderContentRenderers(e,r){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=r,this.columnHeadersCount=r.length}setRenderers(){let{rowHeaders:e,columnHeaders:r,colGroup:n,rows:i,cells:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),r.setTable(this),n.setTable(this),i.setTable(this),s.setTable(this),this.rowHeaders=e,this.columnHeaders=r,this.colGroup=n,this.rows=i,this.cells=s}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:r}=this;for(let n=0;n<e;n++){const i=r.getRenderedNode(n);if(i.firstChild){const s=this.renderedRowToSource(n),o=this.rowUtils.getHeightByOverlayName(s,this.activeOverlayName);o?i.firstChild.style.height=`${o-1}px`:i.firstChild.style.height=""}}}}class EG{constructor(){let{TABLE:e,THEAD:r,COLGROUP:n,TBODY:i,rowUtils:s,columnUtils:o,cellRenderer:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new RG(e,{cellRenderer:a}),this.renderer.setRenderers({rowHeaders:new dG,columnHeaders:new fG(r),colGroup:new gG(n),rows:new vG(i),cells:new yG}),this.renderer.setAxisUtils(s,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,r){return this.renderer.setFilters(e,r),this}setViewportSize(e,r){return this.renderer.setViewportSize(e,r),this}setHeaderContentRenderers(e,r){return this.renderer.setHeaderContentRenderers(e,r),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function rd(t,e,r){TG(t,e),e.set(t,r)}function TG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dm(t,e,r){return(e=_G(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _G(t){var e=AG(t,"string");return typeof e=="symbol"?e:e+""}function AG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vn(t,e){return t.get(ED(t,e))}function nd(t,e,r){return t.set(ED(t,e),r),r}function ED(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var fm=new WeakMap,cc=new WeakMap,id=new WeakMap,gm=new WeakMap,Pl=new WeakMap;class MG{constructor(e){let{totalColumns:r,stretchMode:n,stretchingColumnWidthFn:i,columnWidthFn:s}=e;dm(this,"stretchAllRatio",0),dm(this,"stretchLastWidth",0),dm(this,"stretchAllColumnsWidth",[]),rd(this,fm,0),dm(this,"needVerifyLastColumnWidth",!0),rd(this,cc,()=>0),rd(this,id,o=>o),rd(this,gm,o=>o),rd(this,Pl,()=>"none"),nd(cc,this,r),nd(Pl,this,n),nd(id,this,i??vn(id,this)),nd(gm,this,s??vn(gm,this))}refreshStretching(e){if(vn(Pl,this).call(this)==="none")return;this.stretchAllRatio=0,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0,this.stretchLastWidth=0,nd(fm,this,e);let r=0;for(let i=0;i<vn(cc,this).call(this);i++){const s=this._getColumnWidth(i),o=vn(id,this).call(this,void 0,i);typeof o=="number"?e-=o:r+=s}const n=e-r;if(vn(Pl,this).call(this)==="all"&&n>0)this.stretchAllRatio=e/r,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0;else if(vn(Pl,this).call(this)==="last"&&e!==1/0){const i=this._getColumnWidth(vn(cc,this).call(this)-1),s=n+i;this.stretchLastWidth=s>=0?s:i}}getStretchedColumnWidth(e,r){let n=null;return vn(Pl,this).call(this)==="all"&&this.stretchAllRatio!==0?n=this._getStretchedAllColumnWidth(e,r):vn(Pl,this).call(this)==="last"&&this.stretchLastWidth!==0&&(n=this._getStretchedLastColumnWidth(e)),n}_getStretchedAllColumnWidth(e,r){let n=0;if(!this.stretchAllColumnsWidth[e]){const i=Math.round(r*this.stretchAllRatio),s=vn(id,this).call(this,i,e);s===void 0?this.stretchAllColumnsWidth[e]=i:this.stretchAllColumnsWidth[e]=isNaN(s)?this._getColumnWidth(e):s}if(this.stretchAllColumnsWidth.length===vn(cc,this).call(this)&&this.needVerifyLastColumnWidth){this.needVerifyLastColumnWidth=!1;for(let i=0;i<this.stretchAllColumnsWidth.length;i++)n+=this.stretchAllColumnsWidth[i];n!==vn(fm,this)&&(this.stretchAllColumnsWidth[this.stretchAllColumnsWidth.length-1]+=vn(fm,this)-n)}return this.stretchAllColumnsWidth[e]}_getStretchedLastColumnWidth(e){return e===vn(cc,this).call(this)-1?this.stretchLastWidth:null}_getColumnWidth(e){let r=vn(gm,this).call(this,e);return isNaN(r)&&(r=uv),r}}function mm(t,e,r){return(e=OG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function OG(t){var e=IG(t,"string");return typeof e=="symbol"?e:e+""}function IG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PG{constructor(e,r){mm(this,"dataAccessObject",void 0),mm(this,"wtSettings",void 0),mm(this,"headerWidths",new Map),mm(this,"stretching",void 0),this.dataAccessObject=e,this.wtSettings=r,this.stretching=new MG({totalColumns:()=>this.wtSettings.getSetting("totalColumns"),stretchMode:()=>this.wtSettings.getSetting("stretchH"),stretchingColumnWidthFn:(n,i)=>this.wtSettings.getSetting("onBeforeStretchingColumnWidth",n,i),columnWidthFn:n=>this.dataAccessObject.wtTable.getColumnWidth(n)})}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getStretchedColumnWidth(e){let r=this.getWidth(e);const n=this.stretching.getStretchedColumnWidth(e,r);return n&&(r=n),r}getHeaderHeight(e){let r=this.wtSettings.getSetting("defaultRowHeight");const n=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return n!==void 0&&(r=r?Math.max(r,n):n),r}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}refreshStretching(){const{wtTable:e,wtViewport:r,cloneSource:n}=this.dataAccessObject,i=n?n.wtTable.holder:e.holder,s=i.offsetHeight<i.scrollHeight?qr():0;this.stretching.refreshStretching(r.getViewportWidth()-s)}calculateWidths(){const{wtSettings:e}=this;let r=e.getSetting("rowHeaderWidth");if(this.refreshStretching(),r=e.getSetting("onModifyRowHeaderWidth",r),r!=null){const n=e.getSetting("rowHeaders").length,i=e.getSetting("defaultColumnWidth");for(let s=0;s<n;s++){let o=Array.isArray(r)?r[s]:r;o=o??i,this.headerWidths.set(s,o)}}}}function nA(t,e,r){return(e=NG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function NG(t){var e=DG(t,"string");return typeof e=="symbol"?e:e+""}function DG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HG{constructor(e,r){nA(this,"dataAccessObject",void 0),nA(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=r}getHeight(e){let r=this.wtSettings.getSetting("rowHeight",e);const n=this.dataAccessObject.wtViewport.oversizedRows[e];return n!==void 0&&(r=r===void 0?n:Math.max(r,n)),r}getHeightByOverlayName(e,r){let n=this.wtSettings.getSetting("rowHeightByOverlayName",e,r);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}}function Ls(t,e,r){return(e=kG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kG(t){var e=FG(t,"string");return typeof e=="symbol"?e:e+""}function FG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Mh{constructor(e,r,n,i,s){Ls(this,"wtSettings",null),Ls(this,"domBindings",void 0),Ls(this,"TBODY",null),Ls(this,"THEAD",null),Ls(this,"COLGROUP",null),Ls(this,"hasTableHeight",!0),Ls(this,"hasTableWidth",!0),Ls(this,"isTableVisible",!1),Ls(this,"tableOffset",0),Ls(this,"holderOffset",0),this.domBindings=n,this.isMaster=s==="master",this.name=s,this.dataAccessObject=e,this.facadeGetter=r,this.wtSettings=i,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=n.rootTable,Gb(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const o=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(o)),this.rowUtils=new HG(this.dataAccessObject,this.wtSettings),this.columnUtils=new PG(this.dataAccessObject,this.wtSettings),this.tableRenderer=new EG({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Qe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtSpreader",r&&r.insertBefore(n,e),n.appendChild(e)),n.style.position="relative",this.wtSettings.getSetting("ariaTags")&&qe(n,[go()]),n}createHider(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Qe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.className="wtHider",r&&r.insertBefore(n,e),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&qe(n,[go()]),n}createHolder(e){const r=e.parentNode;let n;return(!r||r.nodeType!==Node.ELEMENT_NODE||!Qe(r,"wtHolder"))&&(n=this.domBindings.rootDocument.createElement("div"),n.style.position="relative",n.className="wtHolder",r&&r.insertBefore(n,e),this.isMaster&&(n.parentNode.className+="ht_master handsontable",n.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&qe(n.parentNode,[go()])),n.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&qe(n,[go()]),n}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,{wtOverlays:n,wtViewport:i}=this.dataAccessObject,s=r.getSetting("totalRows"),o=r.getSetting("totalColumns"),a=r.getSetting("rowHeaders"),l=a.length,u=r.getSetting("columnHeaders"),c=u.length;let h=e;if(this.isMaster&&(n.beforeDraw(),this.holderOffset=Kr(this.holder),h=i.createCalculators(h),l&&!r.getSetting("fixedColumnsStart"))){const f=n.inlineStartOverlay.getScrollPosition(),m=this.correctHeaderWidth;this.correctHeaderWidth=f!==0,m!==this.correctHeaderWidth&&(h=!1)}if(h)this.isMaster&&n.refresh(!0);else{this.isMaster?this.tableOffset=Kr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const f=s>0?this.getFirstRenderedRow():0,m=o>0?this.getFirstRenderedColumn():0;this.rowFilter=new X7(f,s,c),this.columnFilter=new Y7(m,o,l);let g=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const w={};this.wtSettings.getSetting("beforeDraw",!0,w),g=w.skipRender!==!0}if(g){this.tableRenderer.setHeaderContentRenderers(a,u),(this.is(co)||this.is(cl))&&this.tableRenderer.setHeaderContentRenderers(a,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render();let w;if(this.isMaster&&(w=this.dataAccessObject.workspaceWidth,i.containerWidth=null,this.markOversizedColumnHeaders()),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(co))&&this.markOversizedRows(),this.isMaster){this.wtSettings.getSetting("externalRowCalculator")||i.createVisibleCalculators(),n.refresh(!1),n.applyToDOM();const S=tr(this.hider),b=tr(this.TABLE);S!==0&&b!==S&&(this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),w!==i.getWorkspaceWidth()&&(i.containerWidth=null,this.columnUtils.calculateWidths(),this.tableRenderer.renderer.colGroup.render()),this.wtSettings.getSetting("onDraw",!0)}else this.is(co)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize()}}let d=!1;return this.isMaster&&(d=n.topOverlay.resetFixedPosition(),n.bottomOverlay.clone&&(d=n.bottomOverlay.resetFixedPosition()||d),d=n.inlineStartOverlay.resetFixedPosition()||d,n.topInlineStartCornerOverlay&&n.topInlineStartCornerOverlay.resetFixedPosition(),n.bottomInlineStartCornerOverlay&&n.bottomInlineStartCornerOverlay.clone&&n.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(n.refreshAll(),n.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(h),this.isMaster&&n.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const r=this.columnFilter.renderedToSource(e);let n=this.wtSettings.getSetting("columnHeaders").length;const i=this.wtSettings.getSetting("defaultRowHeight");let s,o,a;const l=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;n;)n-=1,s=this.getColumnHeaderHeight(n),o=this.getColumnHeader(r,n),o&&(a=vu(o),(!s&&i<a||s<a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=a),Array.isArray(l)?l[n]!==null&&l[n]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]):isNaN(l)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l),this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]<(l[n]||l)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[n]=l[n]||l))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,r=this.THEAD.childNodes,n=this.dataAccessObject.wtViewport.oversizedColumnHeaders,i=e.getSetting("columnHeaders");for(let s=0,o=i.length;s<o;s++)if(n[s]){if(!r[s]||r[s].childNodes.length===0)return;r[s].childNodes[0].style.height=`${n[s]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(co))&&!e.getSetting("externalRowCalculator")){const n=this.getRenderedRowsCount();for(let i=0;i<n;i++){const s=this.rowFilter.renderedToSource(i);r.oversizedRows&&r.oversizedRows[s]&&(r.oversizedRows[s]=void 0)}}}getCell(e){let r=e.row,n=e.col;const i=this.wtSettings.getSetting("onModifyGetCellCoords",r,n);if(i&&Array.isArray(i)&&([r,n]=i),this.isRowBeforeRenderedRows(r))return-1;if(this.isRowAfterRenderedRows(r))return-2;if(this.isColumnBeforeRenderedColumns(n))return-3;if(this.isColumnAfterRenderedColumns(n))return-4;const s=this.getRow(r);if(!s&&r>=0)throw new Error("TR was expected to be rendered but is not");const o=s.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(n)];if(!o&&n>=0)throw new Error("TD or TH was expected to be rendered but is not");return o}getRow(e){let r=null,n=null;if(e<0){var i;r=(i=this.rowFilter)===null||i===void 0?void 0:i.sourceRowToVisibleColHeadedRow(e),n=this.THEAD}else{var s;r=(s=this.rowFilter)===null||s===void 0?void 0:s.sourceToRendered(e),n=this.TBODY}return r!==void 0&&n!==void 0?n.childNodes.length<r+1?!1:n.childNodes[r]:!1}getColumnHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.THEAD.childNodes[r];return n==null?void 0:n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const r=[],n=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(i=>{const s=i.childNodes[n];s&&r.push(s)}),r}getRowHeader(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const n=this.wtSettings.getSetting("rowHeaders").length;if(r>=n)return;const i=this.rowFilter.sourceToRendered(e),s=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,a=(i<0?this.THEAD:this.TBODY).childNodes[s];return a==null?void 0:a.childNodes[r]}getRowHeaders(e){const r=[],n=this.wtSettings.getSetting("rowHeaders").length;for(let i=0;i<n;i++){const s=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],o=s==null?void 0:s.childNodes[i];o&&r.push(o)}return r}getCoords(e){let r=e;if(r.nodeName!=="TD"&&r.nodeName!=="TH"&&(r=fl(r,["TD","TH"])),r===null)return null;const n=r.parentNode,i=n.parentNode;let s=TN(n),o=r.cellIndex;return Va(Du,r,this.wtRootElement)||Va(Pu,r,this.wtRootElement)?i.nodeName==="THEAD"&&(s-=i.childNodes.length):Va(cl,r,this.wtRootElement)||Va(co,r,this.wtRootElement)?s=this.wtSettings.getSetting("totalRows")-i.childNodes.length+s:i===this.THEAD?s=this.rowFilter.visibleColHeadedRowToSourceRow(s):s=this.rowFilter.renderedToSource(s),Va(Du,r,this.wtRootElement)||Va(Nu,r,this.wtRootElement)||Va(cl,r,this.wtRootElement)?o=this.columnFilter.offsettedTH(o):o=this.columnFilter.visibleRowHeadedColumnToSourceColumn(o),this.wot.createCellCoords(s,o)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const r=e*this.wtSettings.getSetting("defaultRowHeight"),n=vu(this.TBODY)-1;let i,s,o,a,l;if(!(r===n&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;)e-=1,o=this.rowFilter.renderedToSource(e),i=this.getRowHeight(o),a=this.getTrForRow(o),l=a.querySelector("th"),l?s=vu(l):s=vu(a)-1,(!i&&this.wtSettings.getSetting("defaultRowHeight")<s||i<s)&&(s+=1,this.dataAccessObject.wtViewport.oversizedRows[o]=s)}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=n}isRowHeaderRendered(e){if(e>=0)return!1;const n=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=n}isRowBeforeRenderedRows(e){const r=this.getFirstRenderedRow();return e<0&&r<=0?!this.isRowHeaderRendered(e):e<r}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const r=this.getFirstRenderedColumn();return e<0&&r<=0?!this.isColumnHeaderRendered(e):e<r}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}getStretchedColumnWidth(e){return this.columnUtils.getStretchedColumnWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return tr(this.TABLE)}getHeight(){return Ar(this.TABLE)}getTotalWidth(){const e=tr(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ar(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Mu(this.TABLE)}_modifyRowHeaderWidth(e){let r=Jt(e)?e():null;return Array.isArray(r)?(r=[...r],r[r.length-1]=this._correctRowHeaderWidth(r[r.length-1])):r=this._correctRowHeaderWidth(r),r}_correctRowHeaderWidth(e){let r=e;return typeof e!="number"&&(r=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(r+=1),r}}const LG="stickyRowsBottom",wx={getFirstRenderedRow(){const t=this.wtSettings.getSetting("totalRows"),e=this.wtSettings.getSetting("fixedRowsBottom"),r=t-e;return t===0||e===0?-1:r<0?0:r},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsBottom"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};To(wx,"MIXIN_NAME",LG,{writable:!1,enumerable:!1});const $G="stickyColumnsStart",cv={getFirstRenderedColumn(){return this.wtSettings.getSetting("totalColumns")===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){const t=this.wtSettings.getSetting("totalColumns");return Math.min(this.wtSettings.getSetting("fixedColumnsStart"),t)},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};To(cv,"MIXIN_NAME",$G,{writable:!1,enumerable:!1});class vx extends Mh{constructor(e,r,n,i){super(e,r,n,i,cl)}}Lt(vx,wx);Lt(vx,cv);const Pu="top",co="bottom",Nu="inline_start",Du="top_inline_start_corner",cl="bottom_inline_start_corner",TD=[Pu,co,Nu,Du,cl],BG=new Map([[Pu,`ht_clone_${Pu}`],[co,`ht_clone_${co}`],[Nu,`ht_clone_${Nu} ht_clone_left`],[Du,`ht_clone_${Du} ht_clone_top_left_corner`],[cl,`ht_clone_${cl} ht_clone_bottom_left_corner`]]);function VG(t,e){WG(t,e),e.add(t)}function WG(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function UG(t,e,r){return(e=jG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jG(t){var e=zG(t,"string");return typeof e=="symbol"?e:e+""}function zG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var sd=new WeakSet;class YG{constructor(e){VG(this,sd),UG(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,r,n,i,s){const o=this.scrollViewportHorizontally(e.col,n,s),a=this.scrollViewportVertically(e.row,r,i);return o||a}scrollViewportHorizontally(e,r,n){const{drawn:i,totalColumns:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=r===void 0&&n===void 0,{fixedColumnsStart:a,inlineStartOverlay:l}=this.dataAccessObject;if(o&&e<a||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e),!Number.isInteger(e)||e<0||e>s))return!1;const u=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();let h=!1;return(o&&(e<u||e>c)||!o)&&(h=l.scrollTo(e,o?e>=this.getLastPartiallyVisibleColumn():r)),h}scrollViewportVertically(e,r,n){const{drawn:i,totalRows:s}=this.dataAccessObject;if(!i||!Number.isInteger(e)||e<0||e>s)return!1;const o=r===void 0&&n===void 0,{fixedRowsBottom:a,fixedRowsTop:l,topOverlay:u}=this.dataAccessObject;if(o&&(e<l||e>s-a-1)||(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e),!Number.isInteger(e)||e<0||e>s))return!1;const c=this.getFirstVisibleRow(),h=this.getLastVisibleRow();let d=!1;return(o&&(e<c||e>h)||!o)&&(d=u.scrollTo(e,o?e>=this.getLastPartiallyVisibleRow():n)),d}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return pm(sd,this,sA).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return pm(sd,this,sA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return pm(sd,this,iA).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return pm(sd,this,iA).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function iA(t){const{wtSettings:e,inlineStartOverlay:r,wtTable:n,wtViewport:i,totalColumns:s,rootWindow:o}=this.dataAccessObject;if(r.mainTableScrollableElement===o){const a=e.getSetting("rtlMode");let l=null;if(a){const c=n.TABLE.getBoundingClientRect(),d=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;l=Math.abs(c.right-d)}else l=Kr(n.wtRootElement).left;const u=Math.abs(Xb(o,o));if(l>u){const c=qb(o);let h=i.getRowHeaderWidth();for(let d=1;d<=s;d++)if(h+=r.sumCellSizes(d-1,d),l+h-u>=c){t=d-2;break}}}return t}function sA(t){const{topOverlay:e,wtTable:r,wtViewport:n,totalRows:i,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){const o=Kr(r.wtRootElement),a=ev(s,s);if(o.top>a){const l=vu(s);let u=n.getColumnHeaderHeight();for(let c=1;c<=i;c++)if(u+=e.sumCellSizes(c-1,c),o.top+u-a>=l){t=c-2;break}}}return t}function ns(t,e,r){return(e=GG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function GG(t){var e=KG(t,"string");return typeof e=="symbol"?e:e+""}function KG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cx{get eventManager(){return new Xi(this)}constructor(e,r){ns(this,"wtTable",void 0),ns(this,"wtScroll",void 0),ns(this,"wtViewport",void 0),ns(this,"wtOverlays",void 0),ns(this,"selectionManager",void 0),ns(this,"wtEvent",void 0),ns(this,"guid",`wt_${Wb()}`),ns(this,"drawInterrupted",!1),ns(this,"drawn",!1),ns(this,"domBindings",void 0),ns(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=r,this.wtScroll=new YG(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let r=0,n=this.wtTable.THEAD.childNodes[0].childNodes.length;r<n;r++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[r].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(r,n){gl(n,e[r])}])}}createCellCoords(e,r){return new Iu(e,r,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,r,n){return new xg(e,r,n,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,this.wtTable.isVisible()?this.wtTable.draw(e):this.drawInterrupted=!0,this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const n=this.wtSettings.getSetting("totalRows"),i=this.wtSettings.getSetting("fixedRowsTop"),s=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<i&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<i)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=n-s){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<n&&e.row>=n-s&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,r,n,i,s){return e.col<0||e.row<0?!1:this.wtScroll.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return e<0?!1:this.wtScroll.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return e<0?!1:this.wtScroll.scrollViewportVertically(e,r,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(r){e.drawn=r},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function oA(t,e,r){return(e=XG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function XG(t){var e=qG(t,"string");return typeof e=="symbol"?e:e+""}function qG(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ZG extends Cx{constructor(e,r,n){super(e,r),oA(this,"cloneSource",void 0),oA(this,"cloneOverlay",void 0);const i=this.wtSettings.getSetting("facade",this);this.cloneSource=n.source,this.cloneOverlay=n.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=n.viewport,this.selectionManager=n.selectionManager,this.wtEvent=new bD(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,n.event),this.findOriginalHeaders()}}function JG(t,e,r){return(e=QG(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function QG(t){var e=eK(t,"string");return typeof e=="symbol"?e:e+""}function eK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Eg{constructor(e,r,n,i,s){JG(this,"wtSettings",null),To(this,"wot",e,{writable:!1}),this.domBindings=s,this.facadeGetter=r,this.wtSettings=i;const{TABLE:o,hider:a,spreader:l,holder:u,wtRootElement:c}=this.wot.wtTable;this.instance=this.wot,this.type=n,this.mainTableScrollableElement=null,this.TABLE=o,this.hider=a,this.spreader=l,this.holder=u,this.wtRootElement=c,this.trimmingContainer=Ou(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=Ou(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=kf(e.TABLE)}getRelativeCellPosition(e,r,n){if(this.clone.wtTable.holder.contains(e)===!1){kt(`The provided element is not a child of the ${this.type} overlay`);return}const i=this.mainTableScrollableElement===this.domBindings.rootWindow,s=n<this.wtSettings.getSetting("fixedColumnsStart"),o=r<this.wtSettings.getSetting("fixedRowsTop"),a=r>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,u={start:this.getRelativeStartPosition(l),top:l.offsetTop},c={start:this.getRelativeStartPosition(e),top:e.offsetTop};let h=null;return i?h=this.getRelativeCellPositionWithinWindow(o,s,c,u):h=this.getRelativeCellPositionWithinHolder(o,a,s,c,u),h}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,r,n,i){const s=this.wot.wtTable.wtRootElement.getBoundingClientRect();let o=0,a=0;if(!r)o=i.start;else{let l=s.left;this.isRtl()&&(l=this.domBindings.rootWindow.innerWidth-(s.left+s.width+qr())),o=l<=0?-1*l:0}return e?a=this.clone.wtTable.TABLE.getBoundingClientRect().top-s.top:a=i.top,{start:n.start+o,top:n.top+a}}getRelativeCellPositionWithinHolder(e,r,n,i,s){const o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let a=0,l=0;if(n||(a=o.horizontal-s.start),r){const u=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+u.top}else e||(l=o.vertical-s.top);return{start:i.start-a,top:i.top-l}}makeClone(){if(TD.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=n.createElement("div"),o=n.createElement("table"),a=e.wtRootElement.parentNode;s.className=`${BG.get(this.type)} handsontable`,s.setAttribute("dir",this.isRtl()?"rtl":"ltr"),s.style.position="absolute",s.style.top=0,s.style.overflow="visible",this.isRtl()?s.style.right=0:s.style.left=0,r.getSetting("ariaTags")&&qe(s,[go()]),o.className=e.TABLE.className,e.TABLE.getAttribute("role")&&o.setAttribute("role",e.TABLE.getAttribute("role")),s.appendChild(o),a.appendChild(s);const u=this.wtSettings.getSetting("preventOverflow");return u===!0||u==="horizontal"&&this.type===Pu||u==="vertical"&&this.type===Nu?this.mainTableScrollableElement=i:i.getComputedStyle(a).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=kf(e.TABLE),new ZG(o,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.needFullRender&&this.clone.draw(e)}reset(){const e=this.clone.wtTable.holder,r=this.clone.wtTable.hider,n=e.style,i=r.style,s=e.parentNode.style;[n,i,s].forEach(o=>{o.width="",o.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class tK extends Eg{constructor(e,r,n,i,s,o){super(e,r,cl,n,i),this.bottomOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new vx(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const r=this.clone.wtTable.holder.parentNode;if(r.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const s=this.inlineStartOverlay.getOverlayOffset(),o=this.bottomOverlay.getOverlayOffset();r.style[this.isRtl()?"right":"left"]=`${s}px`,r.style.bottom=`${o}px`}else Cg(r),this.repositionOverlay();let n=Ar(this.clone.wtTable.TABLE);const i=tr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),r.style.height=`${n}px`,r.style.width=`${i}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=qr(n)),i.style.bottom=`${s}px`}}const rK="calculatedColumns",hv={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};To(hv,"MIXIN_NAME",rK,{writable:!1,enumerable:!1});class Sx extends Mh{constructor(e,r,n,i){super(e,r,n,i,co)}}Lt(Sx,wx);Lt(Sx,hv);function nK(t,e,r){return(e=iK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iK(t){var e=sK(t,"string");return typeof e=="symbol"?e:e+""}function sK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class oK extends Eg{constructor(e,r,n,i){super(e,r,co,n,i),nK(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Sx(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,r=this.clone.wtTable.holder.parentNode;r.style.top="";let n=0;const i=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!i||i!=="vertical")?(n=this.getOverlayOffset(),r.style.bottom=`${n}px`):(n=this.getScrollPosition(),this.repositionOverlay());const s=this.adjustHeaderBordersPosition(n);return this.adjustElementsSize(),s}repositionOverlay(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode;let s=0;r.hasVerticalScroll()||(s+=r.getWorkspaceHeight()-e.getTotalHeight()),r.hasVerticalScroll()&&r.hasHorizontalScroll()&&(s+=qr(n)),i.style.bottom=`${s}px`}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.mainTableScrollableElement===r?(r.scrollTo(Qw(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const{wtTable:n,wtSettings:i}=this.wot,s=i.getSetting("defaultRowHeight");let o=e,a=0;for(;o<r;){const l=n.getRowHeight(o);a+=l===void 0?s:l,o+=1}return a}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:r}=this.wot,{rootDocument:n,rootWindow:i}=this.domBindings,s=qr(n),a=this.clone.wtTable.holder.parentNode.style,l=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==i||l==="horizontal"){let c=r.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(c-=s),c=Math.min(c,e.wtRootElement.scrollWidth),a.width=`${c}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let u=Ar(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(u=0),a.height=`${u}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){let n=this.getTableParentOffset();const s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let o=0;r&&s.offsetHeight!==s.clientHeight&&(o=qr(this.domBindings.rootDocument)),r?(n+=this.sumCellSizes(0,e+1),n-=this.wot.wtViewport.getViewportHeight(),n+=1):n+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),n+=o,this.setScrollPosition(n)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ev(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s,a=this.domBindings.rootDocument.documentElement.clientHeight;n=Math.max(this.getTableParentOffset()-this.getScrollPosition()-a+i,0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const r=this.wtSettings.getSetting("fixedRowsBottom"),n=this.cachedFixedRowsBottom!==r,i=this.wtSettings.getSetting("columnHeaders");let s=!1;if((n||r===0)&&i.length>0){const o=this.wot.wtTable.holder.parentNode,a=Qe(o,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(ve(o,"innerBorderBottom"),s=!a):(tt(o,"innerBorderBottom"),s=a)}return s}}const aK="calculatedRows",yx={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};To(yx,"MIXIN_NAME",aK,{writable:!1,enumerable:!1});class bx extends Mh{constructor(e,r,n,i){super(e,r,n,i,Nu)}}Lt(bx,yx);Lt(bx,cv);const lK="localHooks",wn={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,r,n,i,s,o){if(this._localHooks[t]){const a=this._localHooks[t].length;for(let l=0;l<a;l++)_0(this._localHooks[t][l],this,e,r,n,i,s,o)}},clearLocalHooks(){return this._localHooks={},this}};To(wn,"MIXIN_NAME",lK,{writable:!1,enumerable:!1});let _D=class{constructor(e,r){this.settings=e,this.cellRange=r||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,r){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=r,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=r,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),r=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,r.row,r.col]}destroy(){this.runLocalHooks("destroy")}};Lt(_D,wn);const AD="active-header",xx="header",Rx="area",Ex="focus",uK="fill",cK="row",hK="column",dK="custom-selection",Tx=Object.freeze({width:"6px",height:"6px",borderWidth:"1px",borderStyle:"solid",borderColor:"#FFF"});var fK=lx;fK("flat");function gK(t,e){MD(t,e),e.add(t)}function aA(t,e,r){MD(t,e),e.set(t,r)}function MD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ir(t,e){return t.get(nf(t,e))}function lA(t,e,r){return t.set(nf(t,e),r),r}function nf(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var is=new WeakMap,Xn=new WeakMap,wm=new WeakSet;class mK{constructor(){gK(this,wm),aA(this,is,void 0),aA(this,Xn,void 0)}setActiveOverlay(e){return lA(Xn,this,e),this}setActiveSelection(e){return lA(is,this,e),this}scan(){const e=Ir(is,this).settings.selectionType,r=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="area"?this.scanCellsRange(n=>r.add(n)):e==="focus"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n)),this.scanCellsRange(n=>r.add(n))):e==="fill"?this.scanCellsRange(n=>r.add(n)):e==="header"?(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanRowsInHeadersRange(n=>r.add(n))):e==="row"?(this.scanRowsInHeadersRange(n=>r.add(n)),this.scanRowsInCellsRange(n=>r.add(n))):e==="column"&&(this.scanColumnsInHeadersRange(n=>r.add(n)),this.scanColumnsInCellsRange(n=>r.add(n))),r}scanColumnsInHeadersRange(e){const[r,n,i,s]=Ir(is,this).getCorners(),{wtTable:o}=Ir(Xn,this),a=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount();let u=0;for(let c=-o.getRowHeadersCount();c<a;c++){const h=o.columnFilter.renderedToSource(c);if(!(h<n||h>s)){for(let d=-l;d<0;d++){if(d<r||d>i)continue;const f=d+l;let m=o.getColumnHeader(h,f);const g=Ir(Xn,this).getSetting("onBeforeHighlightingColumnHeader",h,f,{selectionType:Ir(is,this).settings.selectionType,columnCursor:u,selectionWidth:s-n+1});g!==null&&(g!==h&&(m=o.getColumnHeader(g,f)),e(m))}u+=1}}}scanRowsInHeadersRange(e){const[r,n,i,s]=Ir(is,this).getCorners(),{wtTable:o}=Ir(Xn,this),a=o.getRenderedRowsCount(),l=o.getRowHeadersCount();let u=0;for(let c=-o.getColumnHeadersCount();c<a;c++){const h=o.rowFilter.renderedToSource(c);if(!(h<r||h>i)){for(let d=-l;d<0;d++){if(d<n||d>s)continue;const f=d+l;let m=o.getRowHeader(h,f);const g=Ir(Xn,this).getSetting("onBeforeHighlightingRowHeader",h,f,{selectionType:Ir(is,this).settings.selectionType,rowCursor:u,selectionHeight:i-r+1});g!==null&&(g!==h&&(m=o.getRowHeader(g,f)),e(m))}u+=1}}}scanCellsRange(e){const[r,n,i,s]=Ir(is,this).getCorners(),{wtTable:o}=Ir(Xn,this);nf(wm,this,WC).call(this,(a,l)=>{if(a>=r&&a<=i&&l>=n&&l<=s){const u=o.getCell(Ir(Xn,this).createCellCoords(a,l)),c=Ir(Xn,this).getSetting("onAfterDrawSelection",a,l,Ir(is,this).settings.layerLevel);typeof c=="string"&&ve(u,c),e(u)}})}scanRowsInCellsRange(e){const[r,,n]=Ir(is,this).getCorners(),{wtTable:i}=Ir(Xn,this);nf(wm,this,WC).call(this,(s,o)=>{if(s>=r&&s<=n){const a=i.getCell(Ir(Xn,this).createCellCoords(s,o));e(a)}})}scanColumnsInCellsRange(e){const[,r,,n]=Ir(is,this).getCorners(),{wtTable:i}=Ir(Xn,this);nf(wm,this,WC).call(this,(s,o)=>{if(o>=r&&o<=n){const a=i.getCell(Ir(Xn,this).createCellCoords(s,o));e(a)}})}}function WC(t){const{wtTable:e}=Ir(Xn,this),r=e.getRenderedRowsCount(),n=e.getRenderedColumnsCount();for(let i=0;i<r;i+=1){const s=e.rowFilter.renderedToSource(i);for(let o=0;o<n;o+=1)t(s,e.columnFilter.renderedToSource(o))}}class uA{constructor(e,r){r&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=r,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=Tx,this.cornerCenterPointOffset=-(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(r),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let r=0,n=this.main.childNodes.length;r<n;r++){const i=this.main.childNodes[r];this.eventManager.addEventListener(i,"mouseenter",s=>this.onMouseEnter(s,this.main.childNodes[r]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,r){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),Ji(e);const n=this,i=this.wot.rootDocument.body,s=r.getBoundingClientRect();r.style.display="none";function o(l){if(l.clientY<Math.floor(s.top)||l.clientY>Math.ceil(s.top+s.height)||l.clientX<Math.floor(s.left)||l.clientX>Math.ceil(s.left+s.width))return!0}function a(l){o(l)&&(n.eventManager.removeEventListener(i,"mousemove",a),r.style.display="block")}this.eventManager.addEventListener(i,"mousemove",a)}createBorders(e){const{rootDocument:r}=this.wot;this.main=r.createElement("div");const n=["top","start","bottom","end","corner"];let i=this.main.style;i.position="absolute",i.top=0,i.left=0;for(let a=0;a<5;a++){const l=n[a],u=r.createElement("div");u.className=`wtBorder ${this.settings.className||""}`,this.settings[l]&&this.settings[l].hide&&(u.className+=" hidden"),i=u.style,i.backgroundColor=this.settings[l]&&this.settings[l].color?this.settings[l].color:e.border.color,i.height=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,i.width=this.settings[l]&&this.settings[l].width?`${this.settings[l].width}px`:`${e.border.width}px`,this.main.appendChild(u)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),ea()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:s}=this.wot;let o=s.bordersHolder;o||(o=r.createElement("div"),o.className="htBorders",s.bordersHolder=o,s.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e}=this.wot;this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const r=10,n=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const i={position:"absolute",height:`${n}px`,width:`${n}px`,"border-radius":`${parseInt(n/1.5,10)}px`};ct(i,(o,a)=>{this.selectionHandles.styles.bottomHitArea[a]=o,this.selectionHandles.styles.topHitArea[a]=o});const s={position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${parseInt(r/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"};ct(s,(o,a)=>{this.selectionHandles.styles.bottom[a]=o,this.selectionHandles.styles.top[a]=o}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,r){const n=this.wot.selectionManager.getAreaSelection();return!!(n.cellRange&&(e!==n.cellRange.to.row||r!==n.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,r,n,i,s,o){const l=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:u,topHitArea:c,bottom:h,bottomHitArea:d}=this.selectionHandles.styles,f=parseInt(u.borderWidth,10),m=parseInt(u.width,10),g=parseInt(c.width,10),w=this.wot.wtTable.getWidth(),S=this.wot.wtTable.getHeight();u.top=`${parseInt(n-m-1,10)}px`,u[l]=`${parseInt(i-m-1,10)}px`,c.top=`${parseInt(n-g/4*3,10)}px`,c[l]=`${parseInt(i-g/4*3,10)}px`;const b=Math.min(parseInt(i+s,10),w-m-f*2),y=Math.min(parseInt(i+s-g/4,10),w-g-f*2);h[l]=`${b}px`,d[l]=`${y}px`;const _=Math.min(parseInt(n+o,10),S-m-f*2),P=Math.min(parseInt(n+o-g/4,10),S-g-f*2);h.top=`${_}px`,d.top=`${P}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(u.display="block",c.display="block",this.isPartRange(e,r)?(h.display="none",d.display="none"):(h.display="block",d.display="block")):(u.display="none",h.display="none",c.display="none",d.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||r===this.wot.wtSettings.getSetting("fixedColumnsStart")?(u.zIndex="9999",c.zIndex="9999"):(u.zIndex="",c.zIndex="")}appear(e){if(this.disabled)return;const{wtTable:r,rootDocument:n,rootWindow:i}=this.wot;let s,o,a,l,u,c;const h=r.getRenderedRowsCount();for(let Ne=0;Ne<h;Ne+=1){const Me=r.rowFilter.renderedToSource(Ne);if(Me>=e[0]&&Me<=e[2]){s=Me,u=e[0];break}}for(let Ne=h-1;Ne>=0;Ne-=1){const Me=r.rowFilter.renderedToSource(Ne);if(Me>=e[0]&&Me<=e[2]){o=Me;break}}const d=r.getRenderedColumnsCount();for(let Ne=0;Ne<d;Ne+=1){const Me=r.columnFilter.renderedToSource(Ne);if(Me>=e[1]&&Me<=e[3]){a=Me,c=e[1];break}}for(let Ne=d-1;Ne>=0;Ne-=1){const Me=r.columnFilter.renderedToSource(Ne);if(Me>=e[1]&&Me<=e[3]){l=Me;break}}if(s===void 0||a===void 0){this.disappear();return}let f=r.getCell(this.wot.createCellCoords(s,a));const m=s!==o||a!==l,g=m?r.getCell(this.wot.createCellCoords(o,l)):f,w=Kr(f),S=m?Kr(g):w,b=Kr(r.TABLE),y=tr(r.TABLE),_=w.top,P=w.left,z=this.wot.wtSettings.getSetting("rtlMode");let I=0,W=0;if(z){const Ne=tr(f),Me=i.innerWidth-b.left-y;W=P+Ne-S.left,I=i.innerWidth-P-Ne-Me-1}else W=S.left+tr(g)-P,I=P-b.left-1;if(this.isEntireColumnSelected(s,o)){const Ne=this.getDimensionsFromHeader("columns",a,l,u,b);let Me=null;Ne&&([Me,I,W]=Ne),Me&&(f=Me)}let L=_-b.top-1,U=S.top+Ar(g)-_;if(this.isEntireRowSelected(a,l)){const Ne=this.getDimensionsFromHeader("rows",s,o,c,b);let Me=null;Ne&&([Me,L,U]=Ne),Me&&(f=Me)}const G=vo(f,i);parseInt(G.borderTopWidth,10)>0&&(L+=1,U=U>0?U-1:0),parseInt(G[z?"borderRightWidth":"borderLeftWidth"],10)>0&&(I+=1,W=W>0?W-1:0);const X=z?"right":"left";this.topStyle.top=`${L}px`,this.topStyle[X]=`${I}px`,this.topStyle.width=`${W}px`,this.topStyle.display="block",this.startStyle.top=`${L}px`,this.startStyle[X]=`${I}px`,this.startStyle.height=`${U}px`,this.startStyle.display="block";const le=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${L+U-le}px`,this.bottomStyle[X]=`${I}px`,this.bottomStyle.width=`${W}px`,this.bottomStyle.display="block",this.endStyle.top=`${L}px`,this.endStyle[X]=`${I+W-le}px`,this.endStyle.height=`${U+1}px`,this.endStyle.display="block";let xe=this.settings.border.cornerVisible;xe=typeof xe=="function"?xe(this.settings.layerLevel):xe;const be=this.wot.getSetting("onModifyGetCellCoords",o,l);let[Ze,Le]=[o,l];if(be&&Array.isArray(be)&&([,,Ze,Le]=be),ea()||!xe||this.isPartRange(Ze,Le))this.cornerStyle.display="none";else{this.cornerStyle.top=`${L+U+this.cornerCenterPointOffset-1}px`,this.cornerStyle[X]=`${I+W+this.cornerCenterPointOffset-1}px`,this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Ne=Ou(r.TABLE);const Me=Ne===i;Me&&(Ne=n.documentElement);const at=parseInt(this.cornerDefaultStyle.width,10)/2,v=parseInt(this.cornerDefaultStyle.height,10)/2;if(l===this.wot.getSetting("totalColumns")-1){const p=Me?g.getBoundingClientRect().left:g.offsetLeft;let C=!1,x=0;z?(x=p-parseInt(this.cornerDefaultStyle.width,10)/2,C=x<0):(x=p+tr(g)+parseInt(this.cornerDefaultStyle.width,10)/2,C=x>=qb(Ne)),C&&(this.cornerStyle[X]=`${Math.floor(I+W+this.cornerCenterPointOffset-at)}px`,this.cornerStyle[z?"borderLeftWidth":"borderRightWidth"]=0)}o===this.wot.getSetting("totalRows")-1&&(Me?g.getBoundingClientRect().top:g.offsetTop)+Ar(g)+parseInt(this.cornerDefaultStyle.height,10)/2>=vu(Ne)&&(this.cornerStyle.top=`${Math.floor(L+U+this.cornerCenterPointOffset-v)}px`,this.cornerStyle.borderBottomWidth=0),this.cornerStyle.display="block"}ea()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,l,L,I,W,U)}isEntireColumnSelected(e,r){return e===this.wot.wtTable.getFirstRenderedRow()&&r===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,r){return e===this.wot.wtTable.getFirstRenderedColumn()&&r===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,r,n,i,s){const{wtTable:o}=this.wot,a=o.wtRootElement.parentNode;let l=null,u=null,c=null,h=null,d=null,f=null,m=null,g=null;switch(e){case"rows":l=function(){return o.getRowHeader(...arguments)},u=function(){return Ar(...arguments)},c="ht__selection--rows",f="top";break;case"columns":l=function(){return o.getColumnHeader(...arguments)},u=function(){return tr(...arguments)},c="ht__selection--columns",f="left";break}if(a.classList.contains(c)){const w=this.wot.getSetting("columnHeaders").length;if(m=l(r,w-i),g=l(n,w-i),!m||!g)return!1;const S=Kr(m),b=Kr(g);return m&&g&&(h=S[f]-s[f]-1,d=b[f]+u(g)-S[f]),[m,h,d]}return!1}changeBorderStyle(e,r){const n=this[e].style,i=r[e];!i||i.hide?ve(this[e],"hidden"):(Qe(this[e],"hidden")&&tt(this[e],"hidden"),n.backgroundColor=i.color,(e==="top"||e==="bottom")&&(n.height=`${i.width}px`),(e==="start"||e==="end")&&(n.width=`${i.width}px`))}changeBorderToDefaultStyle(e){const r={width:1,color:"#000"},n=this[e].style;n.backgroundColor=r.color,n.width=`${r.width}px`,n.height=`${r.width}px`}toggleHiddenClass(e,r){this.changeBorderToDefaultStyle(e),r?ve(this[e],"hidden"):tt(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",ea()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function pK(t,e){OD(t,e),e.add(t)}function hc(t,e,r){OD(t,e),e.set(t,r)}function OD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(_x(t,e))}function cA(t,e,r){return t.set(_x(t,e),r),r}function _x(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var bn=new WeakMap,Qn=new WeakMap,UC=new WeakMap,Yd=new WeakMap,jC=new WeakMap,Nl=new WeakMap,hA=new WeakSet;class wK{constructor(e){pK(this,hA),hc(this,bn,void 0),hc(this,Qn,void 0),hc(this,UC,new mK),hc(this,Yd,new WeakMap),hc(this,jC,new WeakSet),hc(this,Nl,new Map),cA(Qn,this,e)}setActiveOverlay(e){return cA(bn,this,e),pt(UC,this).setActiveOverlay(pt(bn,this)),pt(Yd,this).has(pt(bn,this))||pt(Yd,this).set(pt(bn,this),new Set),this}getFocusSelection(){return pt(Qn,this)!==null?pt(Qn,this).getFocus():null}getAreaSelection(){return pt(Qn,this)!==null?pt(Qn,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(pt(Nl,this).has(e)){const n=pt(Nl,this).get(e);if(n.has(pt(bn,this)))return n.get(pt(bn,this));const i=new uA(pt(bn,this),e.settings);return n.set(pt(bn,this),i),i}const r=new uA(pt(bn,this),e.settings);return pt(Nl,this).set(e,new Map([[pt(bn,this),r]])),r}getBorderInstances(e){var r,n;return Array.from((r=(n=pt(Nl,this).get(e))===null||n===void 0?void 0:n.values())!==null&&r!==void 0?r:[])}destroyBorders(e){pt(Nl,this).get(e).forEach(r=>r.destroy()),pt(Nl,this).delete(e)}render(e){if(pt(Qn,this)===null)return;e&&_x(hA,this,vK).call(this);const r=Array.from(pt(Qn,this)),n=new Map,i=new Map;for(let s=0;s<r.length;s++){const o=r[s],{className:a,headerAttributes:l,createLayers:u,selectionType:c}=o.settings;pt(jC,this).has(o)||(pt(jC,this).add(o),o.addLocalHook("destroy",()=>this.destroyBorders(o)));const h=this.getBorderInstance(o);if(o.isEmpty()){h==null||h.disappear();continue}a&&pt(UC,this).setActiveSelection(o).scan().forEach(m=>{if(n.has(m)){const g=n.get(m);g.has(a)&&u===!0?g.set(a,g.get(a)+1):g.set(a,1)}else n.set(m,new Map([[a,1]]));l&&(i.has(m)||i.set(m,[]),m.nodeName==="TH"&&i.get(m).push(...l))});const d=o.getCorners();pt(bn,this).getSetting("onBeforeDrawBorders",d,c),h==null||h.appear(d)}n.forEach((s,o)=>{var a;const l=Array.from(s).map(u=>{let[c,h]=u;return h===1?c:[c,...Array.from({length:h-1},(d,f)=>`${c}-${f+1}`)]}).flat();l.forEach(u=>pt(Yd,this).get(pt(bn,this)).add(u)),ve(o,l),o.nodeName==="TD"&&Array.isArray((a=pt(Qn,this).options)===null||a===void 0?void 0:a.cellAttributes)&&qe(o,pt(Qn,this).options.cellAttributes)}),Array.from(i.keys()).forEach(s=>{qe(s,[...i.get(s)])})}}function vK(){const t=pt(Yd,this).get(pt(bn,this)),e=pt(bn,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let r=0;r<e.length;r++)t.add(e[r]);t.forEach(r=>{var n,i;const s=pt(bn,this).wtTable.TABLE.querySelectorAll(`.${r}`);let o=[];Array.isArray((n=pt(Qn,this).options)===null||n===void 0?void 0:n.cellAttributes)&&(o=pt(Qn,this).options.cellAttributes.map(a=>a[0])),Array.isArray((i=pt(Qn,this).options)===null||i===void 0?void 0:i.headerAttributes)&&(o=[...o,...pt(Qn,this).options.headerAttributes.map(a=>a[0])]);for(let a=0,l=s.length;a<l;a++)tt(s[a],r),Ku(s[a],o)}),t.clear()}class CK extends Eg{constructor(e,r,n,i){super(e,r,Nu,n,i)}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new bx(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:r}=this.domBindings,n=this.clone.wtTable.holder.parentNode,i=this.wtSettings.getSetting("preventOverflow");let s=0;this.trimmingContainer===r&&(!i||i!=="horizontal")?(s=this.getOverlayOffset()*(this.isRtl()?-1:1),tv(n,`${s}px`,"0px")):(s=this.getScrollPosition(),Cg(n));const o=this.adjustHeaderBordersPosition(s);return this.adjustElementsSize(),o}setScrollPosition(e){const{rootWindow:r}=this.domBindings;let n=!1;return this.isRtl()&&(e=-e),this.mainTableScrollableElement===r&&r.scrollX!==e?(r.scrollTo(e,Kb(r)),n=!0):this.mainTableScrollableElement.scrollLeft!==e&&(this.mainTableScrollableElement.scrollLeft=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultColumnWidth");let i=e,s=0;for(;i<r;)s+=this.wot.wtTable.getStretchedColumnWidth(i)||n,i+=1;return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=qr(r),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="vertical"){let u=this.wot.wtViewport.getWorkspaceHeight();this.wot.wtOverlays.hasScrollbarBottom&&(u-=i),u=Math.min(u,e.wtRootElement.scrollHeight),o.height=`${u}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;const l=tr(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=this.wot.selectionManager.getFocusSelection()?parseInt(Tx.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),r=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[r]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[r]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,r){const{wtSettings:n}=this,i=n.getSetting("rowHeaders"),s=n.getSetting("fixedColumnsStart"),a=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=s===0&&i.length>0&&!Qe(a.parentNode,"innerBorderInlineStart")?1:0;let u=this.getTableParentOffset(),c=0;if(r){const h=this.wot.wtTable.getColumnWidth(e),d=this.wot.wtViewport.getViewportWidth();h>d&&(r=!1)}return r&&a.offsetWidth!==a.clientWidth&&(c=qr(this.domBindings.rootDocument)),r?(u+=this.sumCellSizes(0,e+1),u-=this.wot.wtViewport.getViewportWidth(),u+=l):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),u+=c,IN(this.mainTableScrollableElement)===u-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(u)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let r=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(r=this.wot.wtTable.holderOffset.left),r}getScrollPosition(){return Math.abs(Xb(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="horizontal")){this.isRtl()?n=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const i=this.wot.wtTable.getTotalWidth(),s=this.clone.wtTable.getTotalWidth(),o=i-s;n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){const{wtSettings:r}=this,n=this.wot.wtTable.holder.parentNode,i=r.getSetting("rowHeaders"),s=r.getSetting("fixedColumnsStart"),o=r.getSetting("totalRows"),a=r.getSetting("preventOverflow")==="vertical";o?tt(n,"emptyRows"):ve(n,"emptyRows");let l=!1;if(!a){if(s&&!i.length)ve(n,"innerBorderLeft innerBorderInlineStart");else if(!s&&i.length){const u=Qe(n,"innerBorderInlineStart");e?(ve(n,"innerBorderLeft innerBorderInlineStart"),l=!u):(tt(n,"innerBorderLeft innerBorderInlineStart"),l=u)}}return l}}const SK="stickyRowsTop",Ax={getFirstRenderedRow(){return this.wtSettings.getSetting("totalRows")===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){const t=this.wtSettings.getSetting("totalRows");return Math.min(this.wtSettings.getSetting("fixedRowsTop"),t)},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};To(Ax,"MIXIN_NAME",SK,{writable:!1,enumerable:!1});class Mx extends Mh{constructor(e,r,n,i){super(e,r,n,i,Du)}}Lt(Mx,Ax);Lt(Mx,cv);function dA(t,e,r){return(e=yK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function yK(t){var e=bK(t,"string");return typeof e=="symbol"?e:e+""}function bK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xK extends Eg{constructor(e,r,n,i,s,o){super(e,r,Du,n,i),dA(this,"topOverlay",void 0),dA(this,"inlineStartOverlay",void 0),this.topOverlay=s,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Mx(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const i=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),s=this.topOverlay.getOverlayOffset();tv(e,`${i}px`,`${s}px`)}else Cg(e);let r=Ar(this.clone.wtTable.TABLE);const n=tr(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(r=0),e.style.height=`${r}px`,e.style.width=`${n}px`,!1}}class Ox extends Mh{constructor(e,r,n,i){super(e,r,n,i,Pu)}}Lt(Ox,Ax);Lt(Ox,hv);function RK(t,e,r){return(e=EK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function EK(t){var e=TK(t,"string");return typeof e=="symbol"?e:e+""}function TK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _K extends Eg{constructor(e,r,n,i){super(e,r,Pu,n,i),RK(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return new Ox(...r)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:r}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0,s=!1;if(this.trimmingContainer===r&&(!n||n!=="vertical")){const{wtTable:a}=this.wot,l=a.hider.getBoundingClientRect(),u=Math.ceil(l.bottom),c=e.offsetHeight;s=u===c,i=this.getOverlayOffset(),tv(e,"0px",`${i}px`)}else i=this.getScrollPosition(),Cg(e);const o=this.adjustHeaderBordersPosition(i,s);return this.adjustElementsSize(),o}setScrollPosition(e){const r=this.domBindings.rootWindow;let n=!1;return this.mainTableScrollableElement===r&&r.scrollY!==e?(r.scrollTo(Qw(r),e),n=!0):this.mainTableScrollableElement.scrollTop!==e&&(this.mainTableScrollableElement.scrollTop=e,n=!0),n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,r){const n=this.wtSettings.getSetting("defaultRowHeight");let i=e,s=0;for(;i<r;){const o=this.wot.wtTable.getRowHeight(i);s+=o===void 0?n:o,i+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e}=this.wot,{rootDocument:r,rootWindow:n}=this.domBindings,i=qr(r),o=this.clone.wtTable.holder.parentNode.style,a=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||a==="horizontal"){let u=this.wot.wtViewport.getWorkspaceWidth();this.wot.wtOverlays.hasScrollbarRight&&(u-=i),u=Math.min(u,e.wtRootElement.scrollWidth),o.width=`${u}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=Ar(this.clone.wtTable.TABLE);this.wot.wtTable.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,r=this.wot.selectionManager.getFocusSelection()?parseInt(Tx.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+r}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:r}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?r.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:r.style[e]=""}scrollTo(e,r){const{wot:n,wtSettings:i}=this,o=(n.cloneSource?n.cloneSource:n).wtTable.holder,a=i.getSetting("columnHeaders"),u=i.getSetting("fixedRowsTop")===0&&a.length>0&&!Qe(o.parentNode,"innerBorderTop")?1:0;let c=this.getTableParentOffset(),h=0;if(r){const d=this.wot.wtTable.getRowHeight(e),f=this.wot.wtViewport.getViewportHeight();d>f&&(r=!1)}if(r&&o.offsetHeight!==o.clientHeight&&(h=qr(this.domBindings.rootDocument)),r){const d=i.getSetting("fixedRowsBottom"),f=i.getSetting("totalRows");c+=this.sumCellSizes(0,e+1),c-=n.wtViewport.getViewportHeight()-this.sumCellSizes(f-d,f),c+=1,c+=u}else c+=this.sumCellSizes(i.getSetting("fixedRowsTop"),e);return c+=h,ON(this.mainTableScrollableElement)===c-u&&u>0&&this.wot.wtOverlays.expandHiderVerticallyBy(u),this.setScrollPosition(c)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return ev(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,r=this.wtSettings.getSetting("preventOverflow");let n=0;if(this.trimmingContainer===e&&(!r||r!=="vertical")){const i=this.wot.wtTable.getTotalHeight(),s=this.clone.wtTable.getTotalHeight(),o=i-s;n=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),n>o&&(n=0)}return n}adjustHeaderBordersPosition(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,s=n.getSetting("totalColumns"),o=n.getSetting("preventOverflow")==="horizontal";s?tt(i,"emptyColumns"):ve(i,"emptyColumns");let a=!1;if(!r&&!o){const l=n.getSetting("fixedRowsTop"),u=this.cachedFixedRowsTop!==l,c=n.getSetting("columnHeaders");if((u||l===0)&&c.length>0){const h=Qe(i,"innerBorderTop");this.cachedFixedRowsTop=n.getSetting("fixedRowsTop"),e||n.getSetting("totalRows")===0?(ve(i,"innerBorderTop"),a=!h):(tt(i,"innerBorderTop"),a=h)}}return a}}function vm(t,e,r){AK(t,e),e.set(t,r)}function AK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Po(t,e,r){return(e=MK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function MK(t){var e=OK(t,"string");return typeof e=="symbol"?e:e+""}function OK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dl(t,e,r){return t.set(ID(t,e),r),r}function No(t,e){return t.get(ID(t,e))}function ID(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var dc=new WeakMap,Cm=new WeakMap,fc=new WeakMap,Sm=new WeakMap;class IK{constructor(e,r,n,i,s,o){Po(this,"wot",null),vm(this,dc,[]),Po(this,"topOverlay",null),Po(this,"bottomOverlay",null),Po(this,"inlineStartOverlay",null),Po(this,"topInlineStartCornerOverlay",null),Po(this,"bottomInlineStartCornerOverlay",null),Po(this,"browserLineHeight",void 0),Po(this,"wtSettings",null),vm(this,Cm,!1),vm(this,fc,0),vm(this,Sm,null),Po(this,"resizeObserver",new ResizeObserver(c=>{ov(()=>{!Array.isArray(c)||!c.length||(Dl(fc,this,No(fc,this)+1),No(fc,this)===100&&(kt("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),No(Sm,this)!==null&&clearTimeout(No(Sm,this)),Dl(Sm,this,setTimeout(()=>{Dl(fc,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=i,this.domBindings=n,this.facadeGetter=r,this.wtTable=o;const{rootDocument:a,rootWindow:l}=this.domBindings;this.instance=this.wot,this.eventManager=s,this.scrollbarSize=qr(a);const u=l.getComputedStyle(o.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=u?o.holder:kf(o.TABLE),this.initOverlays(),this.hasScrollbarBottom=!1,this.hasScrollbarRight=!1,this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=l.scrollX,this.lastScrollY=l.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=[...No(dc,this)];return e&&r.push(this.wtTable),r}initBrowserLineHeight(){const{rootWindow:e,rootDocument:r}=this.domBindings,n=e.getComputedStyle(r.body),i=parseInt(n.lineHeight,10),s=parseInt(n.fontSize,10)*1.2;this.browserLineHeight=i||s}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new _K(...e),this.bottomOverlay=new oK(...e),this.inlineStartOverlay=new CK(...e),this.topInlineStartCornerOverlay=new xK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new tK(...e,this.bottomOverlay,this.inlineStartOverlay),Dl(dc,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){Dl(Cm,this,No(dc,this).reduce((e,r)=>r.hasRenderingStateChanged()||e,!1)),No(dc,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),No(dc,this).forEach(e=>{const r=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),r&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:r}=this.domBindings,{mainTableScrollableElement:n}=this.topOverlay,{mainTableScrollableElement:i}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",h=>this.onKeyDown(h)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(n,"scroll",h=>this.onTableScroll(h),{passive:!0}),n!==i&&this.eventManager.addEventListener(i,"scroll",h=>this.onTableScroll(h),{passive:!0});const s=r.devicePixelRatio&&r.devicePixelRatio>1,o=this.scrollableElement===r,a=this.wtSettings.getSetting("preventWheel"),l={passive:o};(a||s||!nx())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",h=>this.onCloneWheel(h,a),l),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(h=>{if(h&&h.needFullRender){const{holder:d}=h.clone.wtTable;this.eventManager.addEventListener(d,"wheel",f=>this.onCloneWheel(f,a),l)}});let c;this.eventManager.addEventListener(r,"resize",()=>{clearTimeout(c),c=setTimeout(()=>{this.wtSettings.getSetting("onWindowResize"),Dl(fc,this,0)},200)}),o||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}deregisterListeners(){this.eventManager.clearEvents(!0)}onTableScroll(e){const r=this.domBindings.rootWindow,n=this.inlineStartOverlay.mainTableScrollableElement,i=this.topOverlay.mainTableScrollableElement,s=e.target;this.keyPressed&&(i!==r&&s!==r&&!e.target.contains(i)||n!==r&&s!==r&&!e.target.contains(n))||this.syncScrollPositions(e)}onCloneWheel(e,r){const{rootWindow:n}=this.domBindings,i=this.inlineStartOverlay.mainTableScrollableElement,s=this.topOverlay.mainTableScrollableElement,o=e.target,a=s!==n&&o!==n&&!o.contains(s),l=i!==n&&o!==n&&!o.contains(i);if(this.keyPressed&&(a||l)||this.scrollableElement===n)return;const u=this.translateMouseWheelToScroll(e);(r||this.scrollableElement!==n&&u)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ah(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let r=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,n=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(n+=n*this.browserLineHeight,r+=r*this.browserLineHeight);const i=this.scrollVertically(r),s=this.scrollHorizontally(n);return i||s}scrollVertically(e){const r=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,r!==this.scrollableElement.scrollTop}scrollHorizontally(e){const r=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,r!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const{rootWindow:e}=this.domBindings,r=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder,[i,s]=[this.scrollableElement.scrollLeft,this.scrollableElement.scrollTop];if(this.horizontalScrolling=r.scrollLeft!==i||this.lastScrollX!==e.scrollX,this.verticalScrolling=n.scrollTop!==s||this.lastScrollY!==e.scrollY,this.lastScrollX=e.scrollX,this.lastScrollY=e.scrollY,this.horizontalScrolling){r.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=s),this.refreshAll()}syncScrollWithMaster(){if(!No(Cm,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:r,scrollTop:n}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=r),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=r),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=n),Dl(Cm,this,!1)}updateMainScrollableElements(){this.deregisterListeners(),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:r}=this.domBindings;r.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=kf(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,r=e.clientWidth,n=e.clientHeight,i=r!==this.spreaderLastSize.width||n!==this.spreaderLastSize.height;return i&&(this.spreaderLastSize.width=r,this.spreaderLastSize.height=n),i}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:r}=this,{rootWindow:n}=this.domBindings,i=this.scrollableElement===n,s=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),a=e.getRowHeaderWidth(),u=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,c=a+this.inlineStartOverlay.sumCellSizes(0,s),d=r.hider.style,f=()=>i?!1:this.scrollableElement.scrollTop>Math.max(0,u-r.holder.clientHeight),m=()=>i?!1:this.scrollableElement.scrollLeft>Math.max(0,c-r.holder.clientWidth),g=f()?1:0,w=m()?1:0;if(d.width=`${c+w}px`,d.height=`${u+g}px`,this.scrollbarSize>0){const{scrollHeight:S,scrollWidth:b}=r.wtRootElement,{scrollHeight:y,scrollWidth:_}=r.holder;this.hasScrollbarRight=S<y,this.hasScrollbarBottom=b<_,this.hasScrollbarRight&&r.hider.scrollWidth+this.scrollbarSize>b?this.hasScrollbarBottom=!0:this.hasScrollbarBottom&&r.hider.scrollHeight+this.scrollbarSize>S&&(this.hasScrollbarRight=!0)}this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:r}=this;r.hider.style.height=`${parseInt(r.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:r}=this;r.hider.style.width=`${parseInt(r.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let n=null;return V(r,i=>{i&&i.clone&&i.clone.wtTable.TABLE.contains(e)&&(n=i.clone)}),n}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,r=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];V(r,n=>{n&&(n.clone.wtTable.TABLE.className=e.className)})}}function fA(t,e,r){return(e=PK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PK(t){var e=NK(t,"string");return typeof e=="symbol"?e:e+""}function NK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DK{constructor(e){fA(this,"settings",{}),fA(this,"defaults",Object.freeze(this.getDefaults())),ct(this.defaults,(r,n)=>{if(e[n]!==void 0)this.settings[n]=e[n];else{if(r===void 0)throw new Error(`A required setting "${n}" was not provided`);this.settings[n]=r}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,freezeOverlays:!1,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,r,n)=>{const i=this.getSetting("data",e,r);gl(n,i??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onBeforeStretchingColumnWidth:e=>e,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,r){return r===void 0?ct(e,(n,i)=>{this.settings[i]=n}):this.settings[e]=r,this}getSetting(e,r,n,i,s){return typeof this.settings[e]=="function"?this.settings[e](r,n,i,s):r!==void 0&&Array.isArray(this.settings[e])?this.settings[e][r]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class Ix extends Mh{constructor(e,r,n,i){super(e,r,n,i,"master")}alignOverlaysWithTrimmingContainer(){const e=Ou(this.wtRootElement),{rootWindow:r}=this.domBindings;if(e===r)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const n=e.parentElement,i=mh(e,"height",r),s=mh(e,"overflow",r),o=this.holder.style,{scrollWidth:a,scrollHeight:l}=e;let u=e.offsetWidth,c=e.offsetHeight;if(n&&["auto","hidden","scroll"].includes(s)){const d=e.cloneNode(!1);d.style.overflow="auto",d.style.position="absolute",e.nextElementSibling?n.insertBefore(d,e.nextElementSibling):n.appendChild(d);const f=parseInt(vo(d,r).height,10);n.removeChild(d),f===0&&(c=0)}c=Math.min(c,l),o.height=i==="auto"?"auto":`${c}px`,u=Math.min(u,a),o.width=`${u}px`,o.overflow="",this.hasTableHeight=o.height==="auto"?!0:c>0,this.hasTableWidth=u>0}this.isTableVisible=Mu(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:r}=this.dataAccessObject,n="master",s=e.getSetting("columnHeaders").length;if(s&&!r.hasOversizedColumnHeadersMarked[n]){const a=e.getSetting("rowHeaders").length,l=this.getRenderedColumnsCount();for(let u=0;u<s;u++)for(let c=-1*a;c<l;c++)this.markIfOversizedColumnHeader(c);r.hasOversizedColumnHeadersMarked[n]=!0}}}Lt(Ix,yx);Lt(Ix,hv);class HK{constructor(e,r,n,i,s){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=r,this.wtSettings=n,this.wtTable=s,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.containerWidth=NaN,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new x7:new E7],["fullyVisible",()=>new f7],["partiallyVisible",()=>new pD]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new S7:new R7],["fullyVisible",()=>new c7],["partiallyVisible",()=>new mD]]),this.eventManager=i,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,r=this.dataAccessObject.topOverlayTrimmingContainer;let n=0;return r===this.domBindings.rootWindow?n=e.documentElement.clientHeight:n=Ar(r)>0&&r.clientHeight>0?r.clientHeight:1/0,n}getWorkspaceWidth(){const{wtSettings:e}=this,{rootDocument:r,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer,s=r.documentElement.offsetWidth,o=e.getSetting("totalColumns"),a=e.getSetting("preventOverflow"),l=e.getSetting("rtlMode"),u=this.wtTable.TABLE.getBoundingClientRect(),c=l?u.right-s:u.left,h=s-c;let d,f;if(a)return tr(this.wtTable.wtRootElement);if(e.getSetting("freezeOverlays")?d=Math.min(h,s):d=Math.min(this.getContainerFillWidth(),h,s),i===n&&o>0&&this.sumColumnWidths(0,o-1)>d)return r.documentElement.clientWidth;if(i!==n&&(f=mh(this.dataAccessObject.inlineStartOverlayTrimmingContainer,"overflow",n),f==="scroll"||f==="hidden"||f==="auto"))return Math.max(d,i.clientWidth);const m=e.getSetting("stretchH");return m==="none"||!m?Math.max(d,tr(this.wtTable.TABLE)):d}hasVerticalScroll(){return this.wtTable.hider.offsetHeight>this.getWorkspaceHeight()}hasHorizontalScroll(){return this.wtTable.hider.offsetWidth>this.getWorkspaceWidth()}sumColumnWidths(e,r){let n=0,i=e;for(;i<r;)n+=this.wtTable.getColumnWidth(i),i+=1;return n}getContainerFillWidth(){if(this.containerWidth)return this.containerWidth;const e=this.wtTable.holder,r=this.domBindings.rootDocument.createElement("div");r.style.width="100%",r.style.height="1px",e.appendChild(r);const n=r.offsetWidth;return this.containerWidth=n,e.removeChild(r),n}getWorkspaceOffset(){return Kr(this.wtTable.TABLE)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ar(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const r=this.getColumnHeaderHeight();return r>0&&(e-=r),e}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),r=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let n=0,i=r.length;n<i;n++)this.rowHeaderWidth+=e[n]||e}if(isNaN(this.rowHeaderWidth))if(r.length){let n=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,s=r.length;i<s;i++)n?(this.rowHeaderWidth+=tr(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const r=this.getRowHeaderWidth();return r>0?e-r:e}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportHeight(),s,o;this.rowHeaderWidth=NaN;let a=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const l=r.getSetting("fixedRowsTop"),u=r.getSetting("fixedRowsBottom"),c=r.getSetting("totalRows");return l&&a>=0&&(o=this.dataAccessObject.topOverlay.sumCellSizes(0,l),a+=o,i-=o),u&&this.dataAccessObject.bottomOverlay.clone&&(o=this.dataAccessObject.bottomOverlay.sumCellSizes(c-u,c),i-=o),n.holder.clientHeight===n.holder.offsetHeight?s=0:s=qr(this.domBindings.rootDocument),new N7({calculationTypes:e.map(h=>[h,this.rowsCalculatorTypes.get(h)()]),viewportHeight:i,scrollOffset:a,totalRows:r.getSetting("totalRows"),rowHeightFn:h=>n.getRowHeight(h),overrideFn:r.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:s})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:r,wtTable:n}=this;let i=this.getViewportWidth(),s=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const o=r.getSetting("fixedColumnsStart");if(o&&s>=0){const a=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,o);s+=a,i-=a}return n.holder.clientWidth!==n.holder.offsetWidth&&(i-=qr(this.domBindings.rootDocument)),new O7({calculationTypes:e.map(a=>[a,this.columnsCalculatorTypes.get(a)()]),viewportWidth:i,scrollOffset:s,totalColumns:r.getSetting("totalColumns"),columnWidthFn:a=>n.getColumnWidth(a),overrideFn:r.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:r}=this,n=this.createRowsCalculator(),i=this.createColumnsCalculator();if(e&&!r.getSetting("renderAllRows")){const s=n.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(s)}if(e&&!r.getSetting("renderAllColumns")){const s=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(s)}return e||(this.rowsRenderCalculator=n.getResultsFor("rendered"),this.columnsRenderCalculator=i.getResultsFor("rendered")),this.rowsVisibleCalculator=n.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=i.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),r=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:r,endRow:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.rowsPartiallyVisibleCalculator.startRow,n=this.rowsPartiallyVisibleCalculator.endRow}const{startRow:i,endRow:s}=this.rowsRenderCalculator;return r<i||r===i&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalRows")-1)}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:r,endColumn:n}=e;if(r===null&&n===null){if(!e.isVisibleInTrimmingContainer)return!0;r=this.columnsPartiallyVisibleCalculator.startColumn,n=this.columnsPartiallyVisibleCalculator.endColumn}const{startColumn:i,endColumn:s}=this.columnsRenderCalculator;return r<i||r===i&&r>0?!1:!(n>s||n===s&&n<this.wtSettings.getSetting("totalColumns")-1)}resetHasOversizedColumnHeadersMarked(){ct(this.hasOversizedColumnHeadersMarked,(e,r,n)=>{n[r]=void 0})}}class kK extends Cx{constructor(e,r){super(e,new DK(r));const n=this.wtSettings.getSetting("facade",this);this.wtTable=new Ix(this.getTableDao(),n,this.domBindings,this.wtSettings),this.wtViewport=new HK(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new wK(this.wtSettings.getSetting("selections")),this.wtEvent=new bD(n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new IK(this,n,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},r=[],n=[];ct(e,(i,s)=>{this.wtSettings.getSetting(s).length&&n.push(i),r.push(i)}),tt(this.wtTable.wtRootElement.parentNode,r),ve(this.wtTable.wtRootElement.parentNode,n)}getOverlayByName(e){var r;if(!TD.includes(e))return null;const n=e.replace(/_([a-z])/g,i=>i[1].toUpperCase());return(r=this.wtOverlays[`${n}Overlay`])!==null&&r!==void 0?r:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class Px{constructor(e){e instanceof Cx?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=r=>{const n=new Px(r);return()=>n},this._wot=new kK(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,r){return this._wot.createCellCoords(e,r)}createCellRange(e,r,n){return this._wot.createCellRange(e,r,n)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,r)}scrollViewport(e,r,n,i,s){return this._wot.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return this._wot.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wot.scrollViewportVertically(e,r,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,r){return this._wot.wtSettings.update(e,r),this}getSetting(e,r,n,i,s){return this._wot.wtSettings.getSetting(e,r,n,i,s)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function gA(t){let{isShiftKey:e,isLeftClick:r,isRightClick:n,coords:i,selection:s,controller:o,cellCoordsFactory:a}=t;const l=s.isSelected()?s.getSelectedRange().current():null,u=s.isSelectedByCorner(),c=s.isSelectedByRowHeader();if(s.markSource("mouse"),e&&l)i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(i):(u||c)&&i.row>=0&&i.col>=0&&!o.cell?s.setRangeEnd(a(i.row,i.col)):u&&i.row<0&&!o.column?s.setRangeEnd(a(l.to.row,i.col)):c&&i.col<0&&!o.row?s.setRangeEnd(a(i.row,l.to.col)):(!u&&!c&&i.col<0||u&&i.col<0)&&!o.row?s.selectRows(Math.max(l.from.row,0),i.row,i.col):(!u&&!c&&i.row<0||c&&i.row<0)&&!o.column&&s.selectColumns(Math.max(l.from.col,0),i.col,i.row);else{const h=!s.inInSelection(i),d=r||n&&h;i.row<0&&i.col>=0&&!o.column?d&&s.selectColumns(i.col,i.col,i.row):i.col<0&&i.row>=0&&!o.row?d&&s.selectRows(i.row,i.row,i.col):i.col>=0&&i.row>=0&&!o.cell?d&&s.setRangeStart(i):i.col<0&&i.row<0&&s.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}s.markEndSource()}function FK(t){let{isLeftClick:e,coords:r,selection:n,controller:i,cellCoordsFactory:s}=t;if(!e)return;const o=n.isSelectedByRowHeader(),a=n.isSelectedByColumnHeader(),l=n.tableProps.countCols(),u=n.tableProps.countRows();n.markSource("mouse"),a&&!i.column?n.setRangeEnd(s(u-1,r.col)):o&&!i.row?n.setRangeEnd(s(r.row,l-1)):i.cell||n.setRangeEnd(r),n.markEndSource()}const LK=new Map([["mousedown",gA],["mouseover",FK],["touchstart",gA]]);function mA(t,e){let{coords:r,selection:n,controller:i,cellCoordsFactory:s}=e;LK.get(t.type)({coords:r,selection:n,controller:i,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:av(t)||t.type==="touchstart",isRightClick:ml(t)})}const PD=new WeakMap,Nx=Symbol("rootInstance");function $K(t){PD.set(t,!0)}function BK(t){return t===Nx}function Qp(t){return PD.has(t)}function VK(t,e){ND(t,e),e.add(t)}function Hl(t,e,r){ND(t,e),e.set(t,r)}function ND(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _a(t,e,r){return(e=WK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function WK(t){var e=UK(t,"string");return typeof e=="symbol"?e:e+""}function UK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jr(t,e){return t.get($f(t,e))}function Oi(t,e,r){return t.set($f(t,e),r),r}function $f(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var zC=new WeakMap,ym=new WeakMap,bm=new WeakMap,Do=new WeakMap,ss=new WeakMap,YC=new WeakMap,GC=new WeakMap,e0=new WeakSet;class jK{constructor(e){VK(this,e0),_a(this,"hot",void 0),_a(this,"eventManager",void 0),_a(this,"settings",void 0),_a(this,"THEAD",void 0),_a(this,"TBODY",void 0),_a(this,"_wt",void 0),_a(this,"activeWt",void 0),Hl(this,zC,0),Hl(this,ym,0),_a(this,"postponedAdjustElementsSize",!1),Hl(this,bm,!1),Hl(this,Do,void 0),Hl(this,ss,void 0),Hl(this,YC,0),Hl(this,GC,0),this.hot=e,this.eventManager=new Xi(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){this.hot.isRenderSuspended()||(this.hot.runHooks("beforeRender",this.hot.forceFullRender),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this._wt.draw(!this.hot.forceFullRender),this.hot.runHooks("afterRender",this.hot.forceFullRender),this.hot.forceFullRender=!1,this.hot.renderCall=!1)}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,r){const n=this._wt.getCell(e,r);return n<0?null:n}scrollViewport(e,r,n,i,s){return this._wt.scrollViewport(e,r,n,i,s)}scrollViewportHorizontally(e,r,n){return this._wt.scrollViewportHorizontally(e,r,n)}scrollViewportVertically(e,r,n){return this._wt.scrollViewportVertically(e,r,n)}createElements(){const{rootElement:e,rootDocument:r}=this.hot,n=e.getAttribute("style");n&&e.setAttribute("data-originalstyle",n),ve(e,"handsontable"),Oi(ss,this,r.createElement("TABLE")),ve(Jr(ss,this),"htCore"),this.hot.getSettings().tableClassName&&ve(Jr(ss,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(qe(Jr(ss,this),[go()]),qe(e,[ez(),SN(-1),Jw(this.hot.countCols()),gz()])),this.THEAD=r.createElement("THEAD"),Jr(ss,this).appendChild(this.THEAD),this.TBODY=r.createElement("TBODY"),Jr(ss,this).appendChild(this.TBODY),this.hot.table=Jr(ss,this),this.hot.container.insertBefore(Jr(ss,this),this.hot.container.firstChild)}registerEvents(){const{rootElement:e,rootDocument:r,selection:n,rootWindow:i}=this.hot,s=r.documentElement;this.eventManager.addEventListener(e,"mousedown",a=>{Oi(bm,this,!0),this.isTextSelectionAllowed(a.target)||(o1(i),a.preventDefault(),i.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{Oi(bm,this,!1)}),this.eventManager.addEventListener(e,"mousemove",a=>{Jr(bm,this)&&!this.isTextSelectionAllowed(a.target)&&(this.settings.fragmentSelection&&o1(i),a.preventDefault())}),this.eventManager.addEventListener(s,"keyup",a=>{n.isInProgress()&&!a.shiftKey&&n.finish()}),this.eventManager.addEventListener(s,"mouseup",a=>{n.isInProgress()&&av(a)&&n.finish(),Oi(Do,this,!1);const l=rv(r.activeElement);rf(r.activeElement)&&!l||(l||!n.isSelected()&&!n.isSelectedByAnyHeader()&&!e.contains(a.target)&&!ml(a))&&this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",a=>{n.isInProgress()&&ml(a)&&(n.finish(),Oi(Do,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{n.isInProgress()&&n.finish(),Oi(Do,this,!1)}),this.eventManager.addEventListener(s,"mousedown",a=>{const l=a.target,u=a.x||a.clientX,c=a.y||a.clientY;let h=a.target;if(Jr(Do,this)||!e||!this.hot.view)return;const{holder:d}=this._wt.wtTable;if(h===d){const m=qr(r);if(r.elementFromPoint(u+m,c)!==d||r.elementFromPoint(u,c+m)!==d)return}else for(;h!==s;){if(h===null){if(a.isTargetWebComponent)break;return}if(h===e)return;h=h.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(l):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let o=Au(i);for(;o!==null;)this.eventManager.addEventListener(o.document.documentElement,"click",()=>{this.hot.unlisten()}),o=Au(o);this.eventManager.addEventListener(Jr(ss,this),"selectstart",a=>{this.settings.fragmentSelection||rf(a.target)||a.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:r,col:n}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(r,n))}translateFromRenderableToVisualIndex(e,r){let n=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,i=r>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(r):r;return n===null&&(n=e),i===null&&(i=r),[n,i]}countRenderableIndexes(e,r){const n=Math.min(e.getNotTrimmedIndexesLength(),r),i=e.getNearestNotHiddenIndex(n-1,-1);return i===null?0:e.getRenderableFromVisualIndex(i)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,r){return this.countNotHiddenIndexes(e,r,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,r,n,i){if(isNaN(e)||e<0)return 0;const s=n.getNearestNotHiddenIndex(e,r),o=n.getRenderableFromVisualIndex(s);if(!Number.isInteger(o))return 0;let a=0;return r<0?a=o+1:r>0&&(a=i-o),a}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),r=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(r,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),r=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(r,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),r=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(r,1)}countRenderableColumnsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}countRenderableRowsInRange(e,r){let n=0;for(let i=e;i<=r;i++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(i)!==null&&(n+=1);return n}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),r=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>r}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:Jr(ss,this),isDataViewInstance:()=>Qp(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,stretchH:()=>this.settings.stretchH,data:(s,o)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(s,o)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const s=[];return this.hot.hasRowHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(o):o;this.appendRowHeader(l,a)}),this.hot.runHooks("afterGetRowHeaderRenderers",s),Oi(ym,this,s.length),this.hot.getSettings().ariaTags&&$f(e0,this,DD).call(this)===this.hot.countCols()&&$f(e0,this,zK).call(this,Jr(ym,this)),s},columnHeaders:()=>{const s=[];return this.hot.hasColHeaders()&&s.push((o,a)=>{const l=o>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(o):o;this.appendColHeader(l,a)}),this.hot.runHooks("afterGetColumnHeaderRenderers",s),Oi(zC,this,s.length),s},columnWidth:s=>{const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getColWidth(o===null?s:o)},rowHeight:s=>{const o=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s);return this.hot.getRowHeight(o===null?s:o)},rowHeightByOverlayName:(s,o)=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(s),l=a===null?s:a;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(l),l,o)},cellRenderer:(s,o,a)=>{const[l,u]=this.translateFromRenderableToVisualIndex(s,o),c=this.hot.runHooks("modifyGetCellCoords",l,u);let h=l,d=u;Array.isArray(c)&&([h,d]=c);const f=this.hot.getCellMeta(h,d),m=this.hot.colToProp(d);let g=this.hot.getDataAtRowProp(h,m);this.hot.hasHook("beforeValueRender")&&(g=this.hot.runHooks("beforeValueRender",g,f)),this.hot.runHooks("beforeRenderer",a,l,u,m,g,f),this.hot.getCellRenderer(f)(this.hot,a,l,u,m,g,f),this.hot.runHooks("afterRenderer",a,l,u,m,g,f)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Mu(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=l,Oi(Do,this,!0),this.hot.runHooks("beforeOnCellMouseDown",s,u,a,c),!Xa(s)&&(mA(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseDown",s,u,a),this.activeWt=this._wt)},onCellContextMenu:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,Oi(Do,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",s,u,a),!Xa(s)&&(this.hot.runHooks("afterOnCellContextMenu",s,u,a),this.activeWt=this._wt)},onCellMouseOut:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOut",s,u,a),!Xa(s)&&(this.hot.runHooks("afterOnCellMouseOut",s,u,a),this.activeWt=this._wt)},onCellMouseOver:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o),c={row:!1,column:!1,cell:!1};this.activeWt=l,this.hot.runHooks("beforeOnCellMouseOver",s,u,a,c),!Xa(s)&&(Jr(Do,this)&&mA(s,{coords:u,selection:this.hot.selection,controller:c,cellCoordsFactory:(h,d)=>this.hot._createCellCoords(h,d)}),this.hot.runHooks("afterOnCellMouseOver",s,u,a),this.activeWt=this._wt)},onCellMouseUp:(s,o,a,l)=>{const u=this.translateFromRenderableToVisualCoords(o);this.activeWt=l,this.hot.runHooks("beforeOnCellMouseUp",s,u,a),!(Xa(s)||this.hot.isDestroyed)&&(this.hot.runHooks("afterOnCellMouseUp",s,u,a),this.activeWt=this._wt)},onCellCornerMouseDown:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",s)},onCellCornerDblClick:s=>{s.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",s)},beforeDraw:(s,o)=>this.beforeRender(s,o),onDraw:s=>this.afterRender(s),onBeforeViewportScrollVertically:s=>{const o=this.hot.rowIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollVertically",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onBeforeViewportScrollHorizontally:s=>{const o=this.hot.columnIndexMapper,a=s<0;let l=s;return!a&&(l=o.getVisualFromRenderableIndex(s),l===null)?s:(l=this.hot.runHooks("beforeViewportScrollHorizontally",l),this.hot.runHooks("beforeViewportScroll"),a?l:o.getRenderableFromVisualIndex(l))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingRowHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onBeforeHighlightingColumnHeader:(s,o,a)=>{const l=this.hot.columnIndexMapper,u=s<0;let c=s;u||(c=l.getVisualFromRenderableIndex(s));const h=this.hot.runHooks("beforeHighlightingColumnHeader",c,o,a);return u?h:l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(h,1))},onAfterDrawSelection:(s,o,a)=>{let l;const[u,c]=this.translateFromRenderableToVisualIndex(s,o),h=this.hot.selection.getSelectedRange();if(h.size()>0){const f=h.peekByIndex(a??0);l=[f.from.row,f.from.col,f.to.row,f.to.col]}return this.hot.runHooks("afterDrawSelection",u,c,l,a)},onBeforeDrawBorders:(s,o)=>{const[a,l,u,c]=s,h=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(a),this.hot.columnIndexMapper.getVisualFromRenderableIndex(l),this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(c)];return this.hot.runHooks("beforeDrawBorders",h,o)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onBeforeStretchingColumnWidth:(s,o)=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.runHooks("beforeStretchingColumnWidth",s,a)},onModifyRowHeaderWidth:s=>this.hot.runHooks("modifyRowHeaderWidth",s),onModifyGetCellCoords:(s,o,a)=>{const l=this.hot.rowIndexMapper,u=this.hot.columnIndexMapper,c=o>=0?u.getVisualFromRenderableIndex(o):o,h=s>=0?l.getVisualFromRenderableIndex(s):s,d=this.hot.runHooks("modifyGetCellCoords",h,c,a);if(Array.isArray(d)){const[f,m,g,w]=d;return[f>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(f,1)):f,m>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(m,1)):m,g>=0?l.getRenderableFromVisualIndex(l.getNearestNotHiddenIndex(g,-1)):g,w>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(w,-1)):w]}},viewportRowCalculatorOverride:s=>{let o=this.settings.viewportRowRenderingOffset;if(o==="auto"&&this.settings.fixedRowsTop&&(o=10),o>0||o==="auto"){const a=this.countRenderableRows(),l=s.startRow,u=s.endRow;if(typeof o=="number")s.startRow=Math.max(l-o,0),s.endRow=Math.min(u+o,a-1);else if(o==="auto"){const c=Math.ceil(u/a*12);s.startRow=Math.max(l-c,0),s.endRow=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",s)},viewportColumnCalculatorOverride:s=>{let o=this.settings.viewportColumnRenderingOffset;if(o==="auto"&&this.settings.fixedColumnsStart&&(o=10),o>0||o==="auto"){const a=this.countRenderableColumns(),l=s.startColumn,u=s.endColumn;if(typeof o=="number"&&(s.startColumn=Math.max(l-o,0),s.endColumn=Math.min(u+o,a-1)),o==="auto"){const c=Math.ceil(u/a*6);s.startColumn=Math.max(l-c,0),s.endColumn=Math.min(u+c,a-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",s)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const s=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||s}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new Px(e),this.activeWt=this._wt;const r=this._wt.wtTable.spreader,{width:n,height:i}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(n,i),this.eventManager.addEventListener(r,"mousedown",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(r,"contextmenu",s=>{s.target===r&&s.which===3&&s.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&(this.hot.forceFullRender=!0,this.render())})}isTextSelectionAllowed(e){if(rf(e))return!0;const r=ll(e,this._wt.wtTable.spreader);return!!(this.settings.fragmentSelection===!0&&r||this.settings.fragmentSelection==="cell"&&this.isSelectedOnlyCell()&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return Jr(Do,this)}isSelectedOnlyCell(){var e,r;return(e=(r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingleCell())!==null&&e!==void 0?e:!1}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,r){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,r)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,r){if(r.firstChild){const n=r.firstChild;if(!Qe(n,"relative")){As(r),this.appendRowHeader(e,r);return}this.updateCellHeader(n.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:n,getRowHeader:i}=this.hot,s=n.createElement("div"),o=n.createElement("span");s.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,i),s.appendChild(o),r.appendChild(s)}this.hot.runHooks("afterGetRowHeader",e,r)}appendColHeader(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const s=()=>{const o=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return o?o.split(" "):[]};if(r.firstChild){const o=r.firstChild;Qe(o,"relative")?(this.updateCellHeader(o.querySelector(".colHeader"),e,n,i),o.className="",ve(o,["relative",...s()])):(As(r),this.appendColHeader(e,r,n,i))}else{const{rootDocument:o}=this.hot,a=o.createElement("div"),l=o.createElement("span"),u=s();a.classList.add("relative",...u),l.className="colHeader",this.settings.ariaTags&&(qe(a,...go()),qe(l,...go())),this.updateCellHeader(l,e,n,i),a.appendChild(l),r.appendChild(a)}this.hot.runHooks("afterGetColHeader",e,r,i)}updateCellHeader(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=r;const o=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Qe(e,"colHeader")?s=o.wtTable.columnFilter.sourceToRendered(r):Qe(e,"rowHeader")&&(s=o.wtTable.rowFilter.sourceToRendered(r))),s>-1?Xu(e,n(r,i)):(gl(e,"Â "),ve(e,"cornerHeader"))}maximumVisibleElementWidth(e){const n=this._wt.wtViewport.getWorkspaceWidth()-e;return n>0?n:0}maximumVisibleElementHeight(e){const n=this._wt.wtViewport.getWorkspaceHeight()-e;return n>0?n:0}setLastSize(e,r){Oi(YC,this,e),Oi(GC,this,r)}getLastSize(){return{width:Jr(YC,this),height:Jr(GC,this)}}getFirstRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedRow(),1):null}getLastRenderedVisibleRow(){return this._wt.wtViewport.rowsRenderCalculator?this.hot.rowIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedRow(),-1):null}getFirstRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getFirstRenderedColumn(),1):null}getLastRenderedVisibleColumn(){return this._wt.wtViewport.columnsRenderCalculator?this.hot.columnIndexMapper.getNearestNotHiddenIndex(this._wt.wtTable.getLastRenderedColumn(),-1):null}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return Jr(zC,this)}getRowHeadersCount(){return Jr(ym,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var r;return((r=this._wt.wtOverlays.getParentOverlay(e))!==null&&r!==void 0?r:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}isVisible(){return this._wt.wtTable.isVisible()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function DD(){return parseInt(this.hot.rootElement.getAttribute(Jw()[0]),10)}function zK(t){const e=$f(e0,this,DD).call(this)+t;qe(this.hot.rootElement,...Jw(e))}const HD="ABCDEFGHIJKLMNOPQRSTUVWXYZ",C1=HD.length;function dv(t){let e=t+1,r="",n;for(;e>0;)n=(e-1)%C1,r=String.fromCharCode(65+n)+r,e=parseInt((e-n)/C1,10);return r}function YK(t){let e=0;if(t)for(let r=0,n=t.length-1;r<t.length;r+=1,n-=1)e+=C1**n*(HD.indexOf(t[r])+1);return e-=1,e}function GK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const s=[];for(i=0;i<e;i++)s.push(dv(i)+(n+1));r.push(s)}return r}function KK(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:100,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:4;const r=[];let n,i;for(n=0;n<t;n++){const s={};for(i=0;i<e;i++)s[`prop${i}`]=dv(i)+(n+1);r.push(s)}return r}function XK(t,e){const r=[];let n;for(let i=0;i<t;i++){n=[];for(let s=0;s<e;s++)n.push("");r.push(n)}return r}function Dx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=t;const n=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(r=[t]),r.forEach((i,s)=>{Array.isArray(i)?i.forEach((o,a)=>{n.push([s+e,a,o])}):Object.keys(i).forEach(o=>{n.push([s+e,o,i[o]])})}),n}function Hx(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&ut(t[0])&&(e=sv(t[0]))),e}function kD(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function FD(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}const qK=Object.freeze(Object.defineProperty({__proto__:null,countFirstRowKeys:Hx,createEmptySpreadsheetData:XK,createSpreadsheetData:GK,createSpreadsheetObjectData:KK,dataRowToChangesArray:Dx,isArrayOfArrays:kD,isArrayOfObjects:FD,spreadsheetColumnIndex:YK,spreadsheetColumnLabel:dv},Symbol.toStringTag,{value:"Module"}));function od(t,e,r){return(e=ZK(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZK(t){var e=JK(t,"string");return typeof e=="symbol"?e:e+""}function JK(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QK{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];od(this,"hot",void 0),od(this,"data",void 0),od(this,"dataType","array"),od(this,"colToProp",()=>{}),od(this,"propToCol",()=>{}),this.hot=e,this.data=r}modifyRowData(e){let r;return this.hot.hasHook("modifyRowData")&&(r=this.hot.runHooks("modifyRowData",e)),r!==void 0&&!Number.isInteger(r)?r:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const r=[];return V(this.data,(n,i)=>{const s=this.getAtCell(i,e);r.push(s)}),r}getAtRow(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const s=r===void 0&&n===void 0,{dataDotNotation:o}=this.hot.getSettings();let a=null,l=null;if(a=this.modifyRowData(e),Array.isArray(a))l=[],s?a.forEach((u,c)=>{l[c]=this.getAtPhysicalCell(e,c,a)}):Ue(r,n,u=>{l[u-r]=this.getAtPhysicalCell(e,u,a)});else if(ut(a)||Jt(a))if(i?l=[]:l={},!s||i){const c=this.countFirstRowKeys()-1;Ue(0,c,h=>{const d=this.colToProp(h);if(h>=(r||0)&&h<=(n||c)&&!Number.isInteger(d)){const f=this.getAtPhysicalCell(e,d,a);i?l.push(f):o?Xp(l,d,f):l[d]=f}})}else ct(a,(u,c)=>{const h=this.getAtPhysicalCell(e,c,a);o?Xp(l,c,h):l[c]=h});return l}setAtCell(e,r,n){if(!(e>=this.countRows()||r>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const i=zi(n);this.hot.runHooks("modifySourceData",e,r,i,"set"),i.isTouched()&&(n=i.value)}Number.isInteger(r)?this.data[e][r]=n:Xp(this.data[e],r,n)}}getAtPhysicalCell(e,r,n){let i=null;if(n)if(typeof r=="string"){const{dataDotNotation:s}=this.hot.getSettings();i=s?UN(n,r):n[r]}else typeof r=="function"?i=r(n):i=n[r];if(this.hot.hasHook("modifySourceData")){const s=zi(i);this.hot.runHooks("modifySourceData",e,r,s,"get"),s.isTouched()&&(i=s.value)}return i}getAtCell(e,r){const n=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(r),n)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=!1,s=null,o=null,a=null,l=null;e===null||r===null?(i=!0,s=0,a=this.countRows()-1):(s=Math.min(e.row,r.row),o=Math.min(e.col,r.col),a=Math.max(e.row,r.row),l=Math.max(e.col,r.col));const u=[];return Ue(s,a,c=>{u.push(i?this.getAtRow(c,void 0,void 0,n):this.getAtRow(c,o,l,n))}),u}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return Hx(this.data)}destroy(){this.data=null,this.hot=null}}function pA(t,e,r){return(e=eX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function eX(t){var e=tX(t,"string");return typeof e=="symbol"?e:e+""}function tX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;pA(this,"indexedValues",[]),pA(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const r=this.indexedValues;if(e<r.length)return r[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,r){return e<this.indexedValues.length?(this.indexedValues[e]=r,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Jt(this.initValueOrFn)?Ue(e-1,r=>this.indexedValues.push(this.initValueOrFn(r))):Ue(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}Lt(qu,wn);function kx(t,e,r,n){const i=r.length?r[0]:void 0;return[...t.slice(0,i),...r.map((s,o)=>Jt(n)?n(s,o):n),...i===void 0?[]:t.slice(i)]}function Fx(t,e){return ha(t,(r,n)=>e.includes(n)===!1)}class xl extends qu{insert(e,r){this.indexedValues=kx(this.indexedValues,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){this.indexedValues=Fx(this.indexedValues,e),super.remove(e)}}class fv extends xl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return Hr(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}function Lx(t,e,r){return[...t.slice(0,e),...r,...t.slice(e)]}function Bf(t,e){return ha(t,r=>e.includes(r)===!1)}function $x(t,e){return St(t,r=>r-e.filter(n=>n<r).length)}function Bx(t,e){const r=e[0],n=e.length;return St(t,i=>i>=r?i+n:i)}function rX(t,e,r){return(e=nX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nX(t){var e=iX(t,"string");return typeof e=="symbol"?e:e+""}function iX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class gv extends qu{constructor(){super(...arguments),rX(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=r,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(n,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=Bf(this.orderOfIndexes,[e]),Jt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,r){this.indexedValues=kx(this.indexedValues,e,r,this.initValueOrFn),this.orderOfIndexes=Bx(this.orderOfIndexes,r),super.insert(e,r)}remove(e){this.indexedValues=Fx(this.indexedValues,e),this.orderOfIndexes=Bf(this.orderOfIndexes,e),this.orderOfIndexes=$x(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Tg extends xl{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return Hr(this.getValues(),(e,r,n)=>(r&&e.push(n),e),[])}}const wA=new Map([["indexesSequence",{getListWithInsertedItems:Lx,getListWithRemovedItems:Bf}],["physicallyIndexed",{getListWithInsertedItems:kx,getListWithRemovedItems:Fx}]]),LD=t=>{if(wA.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return wA.get(t)};class $D extends qu{constructor(){super(e=>e)}insert(e,r){const n=Bx(this.indexedValues,r);this.indexedValues=Lx(n,e,r),super.insert(e,r)}remove(e){const r=Bf(this.indexedValues,e);this.indexedValues=$x(r,e),super.remove(e)}}const vA=new Map([["hiding",fv],["index",qu],["linkedPhysicalIndexToValue",gv],["physicalIndexToValue",xl],["trimming",Tg]]);function sX(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!vA.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(vA.get(t))(e)}function oX(t,e,r){return(e=aX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aX(t){var e=lX(t,"string");return typeof e=="symbol"?e:e+""}function lX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let S1=0;class Vx{constructor(){oX(this,"collection",new Map)}register(e,r){this.collection.has(e)===!1&&(this.collection.set(e,r),r.addLocalHook("change",()=>this.runLocalHooks("change",r)),S1+=1)}unregister(e){const r=this.collection.get(e);ke(r)&&(r.destroy(),this.collection.delete(e),this.runLocalHooks("change",r),S1-=1)}unregisterAll(){this.collection.forEach((e,r)=>this.unregister(r)),this.collection.clear()}get(e){return er(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(r=>{r.remove(e)})}insertToEvery(e,r){this.collection.forEach(n=>{n.insert(e,r)})}initEvery(e){this.collection.forEach(r=>{r.init(e)})}}Lt(Vx,wn);function uX(){return S1}function KC(t,e,r){return(e=cX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cX(t){var e=hX(t,"string");return typeof e=="symbol"?e:e+""}function hX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class CA extends Vx{constructor(e,r){super(),KC(this,"mergedValuesCache",[]),KC(this,"aggregationFunction",void 0),KC(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=r}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const r=St(this.get(),s=>s.getValues()),n=[],i=ke(r[0])&&r[0].length||0;for(let s=0;s<i;s+=1){const o=[];for(let a=0;a<this.getLength();a+=1)o.push(r[a][s]);n.push(o)}return St(n,this.aggregationFunction)}getMergedValueAtIndex(e,r){const n=this.getMergedValues(r)[e];return ke(n)?n:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function dX(t,e,r){fX(t,e),e.set(t,r)}function fX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gX(t,e,r){return t.set(BD(t,e),r),r}function mX(t,e){return t.get(BD(t,e))}function BD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var XC=new WeakMap;class VD{constructor(){dX(this,XC,[])}subscribe(e){return this.addLocalHook("change",e),this._write(mX(XC,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){gX(XC,this,e)}}Lt(VD,wn);function SA(t,e){const r=[];let n=0,i=0;for(;n<t.length&&i<e.length;n++,i++)t[n]!==e[i]&&r.push({op:"replace",index:i,oldValue:t[n],newValue:e[i]});for(;n<e.length;n++)r.push({op:"insert",index:n,oldValue:void 0,newValue:e[n]});for(;i<t.length;i++)r.push({op:"remove",index:i,oldValue:t[i],newValue:void 0});return r}function ad(t,e,r){pX(t,e),e.set(t,r)}function pX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ii(t,e){return t.get(WD(t,e))}function xm(t,e,r){return t.set(WD(t,e),r),r}function WD(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Rm=new WeakMap,ld=new WeakMap,Em=new WeakMap,Tm=new WeakMap,_m=new WeakMap;class wX{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ad(this,Rm,new Set),ad(this,ld,[]),ad(this,Em,[]),ad(this,Tm,!1),ad(this,_m,!1),xm(_m,this,e??!1)}createObserver(){const e=new VD;return Ii(Rm,this).add(e),e.addLocalHook("unsubscribe",()=>{Ii(Rm,this).delete(e)}),e._writeInitialChanges(SA(Ii(ld,this),Ii(Em,this))),e}emit(e){let r=Ii(Em,this);(!Ii(Tm,this)||Ii(ld,this).length!==e.length)&&(e.length===0?e=new Array(r.length).fill(Ii(_m,this)):xm(ld,this,new Array(e.length).fill(Ii(_m,this))),Ii(Tm,this)||(xm(Tm,this,!0),r=Ii(ld,this)));const n=SA(r,e);Ii(Rm,this).forEach(i=>i._write(n)),xm(Em,this,e)}}function On(t,e,r){return(e=vX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vX(t){var e=CX(t,"string");return typeof e=="symbol"?e:e+""}function CX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class y1{constructor(){On(this,"indexesSequence",new $D),On(this,"trimmingMapsCollection",new CA(e=>e.some(r=>r===!0),!1)),On(this,"hidingMapsCollection",new CA(e=>e.some(r=>r===!0),!1)),On(this,"variousMapsCollection",new Vx),On(this,"hidingChangesObservable",new wX({initialIndexValue:!1})),On(this,"notTrimmedIndexesCache",[]),On(this,"notHiddenIndexesCache",[]),On(this,"isBatched",!1),On(this,"indexesSequenceChanged",!1),On(this,"indexesChangeSource",void 0),On(this,"trimmedIndexesChanged",!1),On(this,"hiddenIndexesChanged",!1),On(this,"renderablePhysicalIndexesCache",[]),On(this,"fromPhysicalToVisualIndexesCache",new Map),On(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,r,n){return this.registerMap(e,sX(r,n))}registerMap(e,r){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);r instanceof Tg?this.trimmingMapsCollection.register(e,r):r instanceof fv?this.hidingMapsCollection.register(e,r):this.variousMapsCollection.register(e,r);const n=this.getNumberOfIndexes();return n>0&&r.init(n),r}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const r=this.notTrimmedIndexesCache[e];return ke(r)?r:null}getPhysicalFromRenderableIndex(e){const r=this.renderablePhysicalIndexesCache[e];return ke(r)?r:null}getVisualFromPhysicalIndex(e){const r=this.fromPhysicalToVisualIndexesCache.get(e);return ke(r)?r:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const r=this.fromVisualToRenderableIndexesCache.get(e);return ke(r)?r:null}getNearestNotHiddenIndex(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const s=Array.from(this.fromVisualToRenderableIndexesCache.keys());let o=-1;return r>0?o=s.findIndex(a=>a>e):o=s.reverse().findIndex(a=>a<e),o===-1?n?this.getNearestNotHiddenIndex(e,-r,!1):null:s[o]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const r=this.getNumberOfIndexes();if(e<r){const n=[...Array(this.getNumberOfIndexes()-e).keys()].map(i=>i+e);this.removeIndexes(n)}else this.insertIndexes(r,e-r)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(n=>this.isTrimmed(n)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(n=>this.isHidden(n)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(n=>this.isHidden(n)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,r){typeof e=="number"&&(e=[e]);const n=St(e,u=>this.getPhysicalFromVisualIndex(u)),i=this.getNotTrimmedIndexesLength(),s=e.length,o=Bf(this.getIndexesSequence(),n),a=o.filter(u=>this.isTrimmed(u)===!1);let l=o.indexOf(a[a.length-1])+1;if(r+s<i){const u=a[r];l=o.indexOf(u)}this.indexesChangeSource="move",this.setIndexesSequence(Lx(o,l,n)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,r){const n=this.getNotTrimmedIndexes()[e],i=ke(n)?n:this.getNumberOfIndexes(),s=this.getIndexesSequence().includes(n)?this.getIndexesSequence().indexOf(n):this.getNumberOfIndexes(),o=St(new Array(r).fill(i),(a,l)=>a+l);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(s,o),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(s,o),this.hidingMapsCollection.insertToEvery(s,o),this.variousMapsCollection.insertToEvery(s,o),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const r=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&r===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromVisualIndex(r);this.fromPhysicalToVisualIndexesCache.set(n,r)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let r=0;r<e;r+=1){const n=this.getPhysicalFromRenderableIndex(r),i=this.getVisualFromPhysicalIndex(n);this.fromVisualToRenderableIndexesCache.set(i,r)}}}Lt(y1,wn);function SX(t,e){return ct(e,(r,n)=>{er(t[n])&&(t[n]=r)}),t}function UD(t){const r=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return r?`${r[1].toLowerCase()}-${r[2].toUpperCase()}`:t}function jD(t){ke(t)&&ux(Ft`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function yX(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}const{register:bX,getValues:xX}=Ds("phraseFormatters");function RX(t,e){bX(t,e)}function EX(){return xX()}RX("pluralize",yX);const zD="ContextMenu:items",st=zD,Wx=`${st}.noItems`,Ux=`${st}.insertRowAbove`,jx=`${st}.insertRowBelow`,zx=`${st}.insertColumnOnTheLeft`,Yx=`${st}.insertColumnOnTheRight`,Gx=`${st}.removeRow`,Kx=`${st}.removeColumn`,Xx=`${st}.undo`,qx=`${st}.redo`,P0=`${st}.readOnly`,Zx=`${st}.clearColumn`,Jx=`${st}.copy`,Qx=`${st}.copyWithHeaders`,eR=`${st}.copyWithGroupHeaders`,tR=`${st}.copyHeadersOnly`,rR=`${st}.cut`,nR=`${st}.freezeColumn`,iR=`${st}.unfreezeColumn`,sR=`${st}.mergeCells`,oR=`${st}.unmergeCells`,aR=`${st}.addComment`,lR=`${st}.editComment`,uR=`${st}.removeComment`,cR=`${st}.readOnlyComment`,hR=`${st}.align`,N0=`${st}.align.left`,D0=`${st}.align.center`,H0=`${st}.align.right`,k0=`${st}.align.justify`,F0=`${st}.align.top`,L0=`${st}.align.middle`,$0=`${st}.align.bottom`,dR=`${st}.borders`,fR=`${st}.borders.top`,gR=`${st}.borders.right`,mR=`${st}.borders.bottom`,pR=`${st}.borders.left`,wR=`${st}.borders.remove`,vR=`${st}.nestedHeaders.insertChildRow`,CR=`${st}.nestedHeaders.detachFromParent`,SR=`${st}.hideColumn`,yR=`${st}.showColumn`,bR=`${st}.hideRow`,xR=`${st}.showRow`,Wn="Filters:",xr=`${Wn}conditions`,mv=`${xr}.none`,RR=`${xr}.isEmpty`,ER=`${xr}.isNotEmpty`,TR=`${xr}.isEqualTo`,_R=`${xr}.isNotEqualTo`,AR=`${xr}.beginsWith`,MR=`${xr}.endsWith`,OR=`${xr}.contains`,IR=`${xr}.doesNotContain`,TX=`${xr}.byValue`,PR=`${xr}.greaterThan`,NR=`${xr}.greaterThanOrEqualTo`,DR=`${xr}.lessThan`,HR=`${xr}.lessThanOrEqualTo`,kR=`${xr}.isBetween`,FR=`${xr}.isNotBetween`,LR=`${xr}.after`,$R=`${xr}.before`,BR=`${xr}.today`,VR=`${xr}.tomorrow`,WR=`${xr}.yesterday`,UR=`${Wn}labels.filterByCondition`,jR=`${Wn}labels.filterByValue`,zR=`${Wn}labels.conjunction`,pv=`${Wn}labels.disjunction`,B0=`${Wn}values.blankCells`,YR=`${Wn}buttons.selectAll`,GR=`${Wn}buttons.clear`,KR=`${Wn}buttons.ok`,XR=`${Wn}buttons.cancel`,qR=`${Wn}buttons.placeholder.search`,ZR=`${Wn}buttons.placeholder.value`,JR=`${Wn}buttons.placeholder.secondValue`,QR="CheckboxRenderer:",eE=`${QR}checked`,tE=`${QR}unchecked`,_X=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:eE,CHECKBOX_RENDERER_NAMESPACE:QR,CHECKBOX_UNCHECKED:tE,CONTEXTMENU_ITEMS_ADD_COMMENT:aR,CONTEXTMENU_ITEMS_ALIGNMENT:hR,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:$0,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:D0,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:k0,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:N0,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:L0,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:H0,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:F0,CONTEXTMENU_ITEMS_BORDERS:dR,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:mR,CONTEXTMENU_ITEMS_BORDERS_LEFT:pR,CONTEXTMENU_ITEMS_BORDERS_RIGHT:gR,CONTEXTMENU_ITEMS_BORDERS_TOP:fR,CONTEXTMENU_ITEMS_CLEAR_COLUMN:Zx,CONTEXTMENU_ITEMS_COPY:Jx,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:tR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:eR,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:Qx,CONTEXTMENU_ITEMS_CUT:rR,CONTEXTMENU_ITEMS_EDIT_COMMENT:lR,CONTEXTMENU_ITEMS_FREEZE_COLUMN:nR,CONTEXTMENU_ITEMS_HIDE_COLUMN:SR,CONTEXTMENU_ITEMS_HIDE_ROW:bR,CONTEXTMENU_ITEMS_INSERT_LEFT:zx,CONTEXTMENU_ITEMS_INSERT_RIGHT:Yx,CONTEXTMENU_ITEMS_MERGE_CELLS:sR,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:CR,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:vR,CONTEXTMENU_ITEMS_NO_ITEMS:Wx,CONTEXTMENU_ITEMS_READ_ONLY:P0,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:cR,CONTEXTMENU_ITEMS_REDO:qx,CONTEXTMENU_ITEMS_REMOVE_BORDERS:wR,CONTEXTMENU_ITEMS_REMOVE_COLUMN:Kx,CONTEXTMENU_ITEMS_REMOVE_COMMENT:uR,CONTEXTMENU_ITEMS_REMOVE_ROW:Gx,CONTEXTMENU_ITEMS_ROW_ABOVE:Ux,CONTEXTMENU_ITEMS_ROW_BELOW:jx,CONTEXTMENU_ITEMS_SHOW_COLUMN:yR,CONTEXTMENU_ITEMS_SHOW_ROW:xR,CONTEXTMENU_ITEMS_UNDO:Xx,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:iR,CONTEXTMENU_ITEMS_UNMERGE_CELLS:oR,CONTEXT_MENU_ITEMS_NAMESPACE:zD,FILTERS_BUTTONS_CANCEL:XR,FILTERS_BUTTONS_CLEAR:GR,FILTERS_BUTTONS_OK:KR,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:qR,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:JR,FILTERS_BUTTONS_PLACEHOLDER_VALUE:ZR,FILTERS_BUTTONS_SELECT_ALL:YR,FILTERS_CONDITIONS_AFTER:LR,FILTERS_CONDITIONS_BEFORE:$R,FILTERS_CONDITIONS_BEGINS_WITH:AR,FILTERS_CONDITIONS_BETWEEN:kR,FILTERS_CONDITIONS_BY_VALUE:TX,FILTERS_CONDITIONS_CONTAINS:OR,FILTERS_CONDITIONS_EMPTY:RR,FILTERS_CONDITIONS_ENDS_WITH:MR,FILTERS_CONDITIONS_EQUAL:TR,FILTERS_CONDITIONS_GREATER_THAN:PR,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:NR,FILTERS_CONDITIONS_LESS_THAN:DR,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:HR,FILTERS_CONDITIONS_NAMESPACE:xr,FILTERS_CONDITIONS_NONE:mv,FILTERS_CONDITIONS_NOT_BETWEEN:FR,FILTERS_CONDITIONS_NOT_CONTAIN:IR,FILTERS_CONDITIONS_NOT_EMPTY:ER,FILTERS_CONDITIONS_NOT_EQUAL:_R,FILTERS_CONDITIONS_TODAY:BR,FILTERS_CONDITIONS_TOMORROW:VR,FILTERS_CONDITIONS_YESTERDAY:WR,FILTERS_DIVS_FILTER_BY_CONDITION:UR,FILTERS_DIVS_FILTER_BY_VALUE:jR,FILTERS_LABELS_CONJUNCTION:zR,FILTERS_LABELS_DISJUNCTION:pv,FILTERS_NAMESPACE:Wn,FILTERS_VALUES_BLANK_CELLS:B0},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const YD={languageCode:"en-US",[Wx]:"No available options",[Ux]:"Insert row above",[jx]:"Insert row below",[zx]:"Insert column left",[Yx]:"Insert column right",[Gx]:["Remove row","Remove rows"],[Kx]:["Remove column","Remove columns"],[Xx]:"Undo",[qx]:"Redo",[P0]:"Read only",[Zx]:"Clear column",[hR]:"Alignment",[N0]:"Left",[D0]:"Center",[H0]:"Right",[k0]:"Justify",[F0]:"Top",[L0]:"Middle",[$0]:"Bottom",[nR]:"Freeze column",[iR]:"Unfreeze column",[dR]:"Borders",[fR]:"Top",[gR]:"Right",[mR]:"Bottom",[pR]:"Left",[wR]:"Remove border(s)",[aR]:"Add comment",[lR]:"Edit comment",[uR]:"Delete comment",[cR]:"Read-only comment",[sR]:"Merge cells",[oR]:"Unmerge cells",[Jx]:"Copy",[Qx]:["Copy with header","Copy with headers"],[eR]:["Copy with group header","Copy with group headers"],[tR]:["Copy header only","Copy headers only"],[rR]:"Cut",[vR]:"Insert child row",[CR]:"Detach from parent",[SR]:["Hide column","Hide columns"],[yR]:["Show column","Show columns"],[bR]:["Hide row","Hide rows"],[xR]:["Show row","Show rows"],[mv]:"None",[RR]:"Is empty",[ER]:"Is not empty",[TR]:"Is equal to",[_R]:"Is not equal to",[AR]:"Begins with",[MR]:"Ends with",[OR]:"Contains",[IR]:"Does not contain",[PR]:"Greater than",[NR]:"Greater than or equal to",[DR]:"Less than",[HR]:"Less than or equal to",[kR]:"Is between",[FR]:"Is not between",[LR]:"After",[$R]:"Before",[BR]:"Today",[VR]:"Tomorrow",[WR]:"Yesterday",[B0]:"Blank cells",[UR]:"Filter by condition",[jR]:"Filter by value",[zR]:"And",[pv]:"Or",[YR]:"Select all",[GR]:"Clear",[KR]:"OK",[XR]:"Cancel",[qR]:"Search",[ZR]:"Value",[JR]:"Second value",[eE]:"Checked",[tE]:"Unchecked"},AX=_X,b1=YD.languageCode,{register:MX,getItem:GD,hasItem:OX,getValues:IX}=Ds("languagesDictionaries");KD(YD);function KD(t,e){let r=t,n=e;return ut(t)&&(n=t,r=n.languageCode),PX(r,n),MX(r,Mn(n)),Mn(n)}function PX(t,e){t!==b1&&SX(e,GD(b1))}function XD(t){return rE(t)?Mn(GD(t)):null}function rE(t){return OX(t)}function NX(){return IX()}function qD(t,e,r){const n=XD(t);if(n===null)return null;const i=n[e];if(er(i))return null;const s=DX(i,r);return Array.isArray(s)?s[0]:s}function DX(t,e){let r=t;return V(EX(),n=>{r=n(t,e)}),r}function HX(t){let e=UD(t);return rE(e)||(e=b1,jD(t)),e}function kX(t,e,r){return(e=FX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function FX(t){var e=LX(t,"string");return typeof e=="symbol"?e:e+""}function LX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sa extends _D{constructor(e,r){super(e,null),kX(this,"visualCellRange",null),this.visualCellRange=r||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:r,to:n}=e,i=this.getNearestNotHiddenCoords(r,1),s=this.getNearestNotHiddenCoords(n,-1);return i===null||s===null?null:((i.row>s.row||i.col>s.col)&&(i=r,s=n),this.settings.createCellRange(i,i,s))}getNearestNotHiddenCoords(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:r;const i=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,r);if(i===null)return null;const s=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,n);return s===null?null:this.settings.createCellCoords(i,s)}getNearestNotHiddenIndex(e,r,n){return r<0?r:e.getNearestNotHiddenIndex(r,n)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const r=e.from.clone().normalize(),n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,s=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let o=null;if((s===null||s.col===null||s.row===null)&&(o=this.getNearestNotHiddenCoords(r,n,i)),o!==null&&e.overlaps(o)){const a=e.highlight.clone();if(a.row>=0&&(a.row=o.row),a.col>=0&&(a.col=o.col),this.cellRange===null){const l=this.settings.visualToRenderableCoords(a);this.cellRange=this.settings.createCellRange(l)}e.setHighlight(a)}return this.settings.selectionType==="focus"&&s!==null&&o===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:r}=this.cellRange;return[Math.min(e.row,r.row),Math.min(e.col,r.col),Math.max(e.row,r.row),Math.max(e.col,r.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),r=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,r.row,r.col]}createRenderableCellRange(e,r){const n=this.settings.visualToRenderableCoords(e),i=this.settings.visualToRenderableCoords(r);return n.row===null||n.col===null||i.row===null||i.col===null?null:this.settings.createCellRange(n,n,i)}}function qC(t){let{activeHeaderClassName:e,...r}=t;return new Sa({className:e,...r,selectionType:AD})}function $X(t){let{areaCornerVisible:e,...r}=t;return new Sa({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...r,selectionType:Rx})}function BX(t){let{...e}=t;return new Sa({className:"highlight",...e,selectionType:Rx})}function VX(t){let{columnClassName:e,...r}=t;return new Sa({className:e,...r,selectionType:hK})}function WX(t){let{cellCornerVisible:e,...r}=t;return new Sa({className:"current",headerAttributes:[Yb()],border:{width:2,color:"#4b89ff",cornerVisible:e},...r,selectionType:Ex})}function UX(t){let{border:e,visualCellRange:r,...n}=t;return new Sa({...e,...n,selectionType:dK},r)}function jX(t){let{...e}=t;return new Sa({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:uK})}function yA(t){let{headerClassName:e,...r}=t;return new Sa({className:e,...r,selectionType:xx})}function zX(t){let{rowClassName:e,...r}=t;return new Sa({className:e,...r,selectionType:cK})}function YX(t,e){GX(t,e),e.add(t)}function GX(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zn(t,e,r){return(e=KX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function KX(t){var e=XX(t,"string");return typeof e=="symbol"?e:e+""}function XX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ho(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $s=new WeakSet;class qX{constructor(e){YX(this,$s),zn(this,"options",void 0),zn(this,"layerLevel",0),zn(this,"focus",void 0),zn(this,"fill",void 0),zn(this,"layeredAreas",new Map),zn(this,"areas",new Map),zn(this,"rowHeaders",new Map),zn(this,"columnHeaders",new Map),zn(this,"activeRowHeaders",new Map),zn(this,"activeColumnHeaders",new Map),zn(this,"activeCornerHeaders",new Map),zn(this,"rowHighlights",new Map),zn(this,"columnHighlights",new Map),zn(this,"customSelections",[]),this.options=e,this.focus=WX(e),this.fill=jX(e)}isEnabledFor(e,r){let n=e;e===Ex&&(n="current");let i=this.options.disabledCellSelection(r.row,r.col);return typeof i=="string"&&(i=[i]),i===!1||Array.isArray(i)&&!i.includes(n)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Ho($s,this,ko).call(this,this.layeredAreas,$X)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Ho($s,this,ko).call(this,this.areas,BX)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Ho($s,this,ko).call(this,this.rowHeaders,yA)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Ho($s,this,ko).call(this,this.columnHeaders,yA)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Ho($s,this,ko).call(this,this.activeRowHeaders,qC)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Ho($s,this,ko).call(this,this.activeColumnHeaders,qC)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Ho($s,this,ko).call(this,this.activeCornerHeaders,qC)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Ho($s,this,ko).call(this,this.rowHighlights,zX)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Ho($s,this,ko).call(this,this.columnHighlights,VX)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(UX({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),V(this.areas.values(),e=>void e.clear()),V(this.layeredAreas.values(),e=>void e.clear()),V(this.rowHeaders.values(),e=>void e.clear()),V(this.columnHeaders.values(),e=>void e.clear()),V(this.activeRowHeaders.values(),e=>void e.clear()),V(this.activeColumnHeaders.values(),e=>void e.clear()),V(this.activeCornerHeaders.values(),e=>void e.clear()),V(this.rowHighlights.values(),e=>void e.clear()),V(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function ko(t,e){const r=this.layerLevel;if(t.has(r))return t.get(r);const n=e({layerLevel:r,...this.options});return t.set(r,n),n}function bA(t,e,r){return(e=ZX(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ZX(t){var e=JX(t,"string");return typeof e=="symbol"?e:e+""}function JX(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QX{constructor(e){bA(this,"ranges",[]),bA(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(r=>r.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,r;return e>=0&&e<this.size()&&(r=this.ranges[e]),r}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function eq(t,e){ZD(t,e),e.add(t)}function ZC(t,e,r){ZD(t,e),e.set(t,r)}function ZD(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tt(t,e){return t.get(Lr(t,e))}function Am(t,e,r){return t.set(Lr(t,e),r),r}function Lr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Mm=new WeakMap,ir=new WeakMap,xs=new WeakMap,zr=new WeakSet;class x1{constructor(e,r){eq(this,zr),ZC(this,Mm,void 0),ZC(this,ir,void 0),ZC(this,xs,{x:0,y:0}),Am(Mm,this,e),Am(ir,this,r)}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=Tt(ir,this).createCellCoords(e,r);let s=Tt(Mm,this).current().highlight;const o=Tt(ir,this).visualToRenderableCoords(s);let a=0,l=0;if(this.runLocalHooks("beforeTransformStart",i),o.row!==null&&o.col!==null){const{width:u,height:c}=Lr(zr,this,JD).call(this),{row:h,col:d}=Lr(zr,this,RA).call(this,s),f=Tt(ir,this).fixedRowsBottom(),m=Tt(ir,this).minSpareRows(),g=Tt(ir,this).minSpareCols(),w=Tt(ir,this).autoWrapRow(),S=Tt(ir,this).autoWrapCol(),b=Tt(ir,this).createCellCoords(h+i.row,d+i.col);if(b.row>=c){const P=zi(n&&m>0&&f===0),z=b.col+1,I=Tt(ir,this).createCellCoords(b.row-c,z>=u?z-u:z);this.runLocalHooks("beforeColumnWrap",P,Lr(zr,this,gc).call(this,I),z>=u),P.value?this.runLocalHooks("insertRowRequire",Tt(ir,this).countRenderableRows()):S&&b.assign(I)}else if(b.row<0){const P=zi(S),z=b.col-1,I=Tt(ir,this).createCellCoords(c+b.row,z<0?u+z:z);this.runLocalHooks("beforeColumnWrap",P,Lr(zr,this,gc).call(this,I),z<0),S&&b.assign(I)}if(b.col>=u){const P=zi(n&&g>0),z=b.row+1,I=Tt(ir,this).createCellCoords(z>=c?z-c:z,b.col-u);this.runLocalHooks("beforeRowWrap",P,Lr(zr,this,gc).call(this,I),z>=c),P.value?this.runLocalHooks("insertColRequire",Tt(ir,this).countRenderableColumns()):w&&b.assign(I)}else if(b.col<0){const P=zi(w),z=b.row-1,I=Tt(ir,this).createCellCoords(z<0?c+z:z,u+b.col);this.runLocalHooks("beforeRowWrap",P,Lr(zr,this,gc).call(this,I),z<0),w&&b.assign(I)}const{rowDir:y,colDir:_}=Lr(zr,this,xA).call(this,b);a=y,l=_,s=Lr(zr,this,gc).call(this,b)}return this.runLocalHooks("afterTransformStart",s,a,l),s}transformEnd(e,r){const n=Tt(ir,this).createCellCoords(e,r),i=Tt(Mm,this).current(),s=Tt(ir,this).visualToRenderableCoords(i.highlight),o=Lr(zr,this,JC).call(this,i.to.row,i.from.row),a=Lr(zr,this,QC).call(this,i.to.col,i.from.col),l=i.to.clone();let u=0,c=0;if(this.runLocalHooks("beforeTransformEnd",n),s.row!==null&&s.col!==null&&o!==null&&a!==null){const{row:h,col:d}=Lr(zr,this,RA).call(this,i.highlight),f=Tt(ir,this).createCellCoords(o+n.row,a+n.col),m=i.getTopStartCorner(),g=i.getTopEndCorner(),w=i.getBottomEndCorner();if(n.col<0&&a>=d&&f.col<d){const _=f.col-d;f.col=Lr(zr,this,QC).call(this,m.col,g.col)+_}else if(n.col>0&&a<=d&&f.col>d){const _=Lr(zr,this,QC).call(this,g.col,m.col),P=Math.max(f.col-_,1);f.col=_+P}if(n.row<0&&o>=h&&f.row<h){const _=f.row-h;f.row=Lr(zr,this,JC).call(this,m.row,w.row)+_}else if(n.row>0&&o<=h&&f.row>h){const _=Lr(zr,this,JC).call(this,w.row,m.row),P=Math.max(f.row-_,1);f.row=_+P}const{rowDir:S,colDir:b}=Lr(zr,this,xA).call(this,f);u=S,c=b;const y=Lr(zr,this,gc).call(this,f);n.row===0&&n.col!==0?l.col=y.col:n.row!==0&&n.col===0?l.row=y.row:(l.row=y.row,l.col=y.col)}return this.runLocalHooks("afterTransformEnd",l,u,c),l}setOffsetSize(e){let{x:r,y:n}=e;Am(xs,this,{x:r,y:n})}resetOffsetSize(){Am(xs,this,{x:0,y:0})}}function xA(t){const{width:e,height:r}=Lr(zr,this,JD).call(this);let n=0,i=0;return t.row<0?(n=-1,t.row=0):t.row>0&&t.row>=r&&(n=1,t.row=r-1),t.col<0?(i=-1,t.col=0):t.col>0&&t.col>=e&&(i=1,t.col=e-1),{rowDir:n,colDir:i}}function JD(){return{width:Tt(xs,this).x+Tt(ir,this).countRenderableColumns(),height:Tt(xs,this).y+Tt(ir,this).countRenderableRows()}}function JC(t,e){const r=Tt(ir,this).findFirstNonHiddenRenderableRow(t,e);return r===null?null:Tt(xs,this).y+r}function QC(t,e){const r=Tt(ir,this).findFirstNonHiddenRenderableColumn(t,e);return r===null?null:Tt(xs,this).x+r}function RA(t){const{row:e,col:r}=Tt(ir,this).visualToRenderableCoords(t);if(e===null||r===null)throw new Error("Renderable coords are not visible.");return Tt(ir,this).createCellCoords(Tt(xs,this).y+e,Tt(xs,this).x+r)}function gc(t){const e=t.clone();return e.col=t.col-Tt(xs,this).x,e.row=t.row-Tt(xs,this).y,Tt(ir,this).renderableToVisualCoords(e)}Lt(x1,wn);const wv=0,vv=1,QD=2,nE=3,tq=[nE,QD],rq=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],eS=Symbol("root"),EA=Symbol("child");function wh(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:eS;if(e!==eS&&e!==EA)throw new Error("The second argument is used internally only and cannot be overwritten.");const r=Array.isArray(t),n=e===eS;let i=wv;if(r){const s=t[0];t.length===0?i=vv:n&&s instanceof xg?i=nE:n&&Array.isArray(s)?i=wh(s,EA):t.length>=2&&t.length<=4&&!t.some((a,l)=>!rq[l].includes(typeof a))&&(i=QD)}return i}function Vf(t){let{createCellCoords:e,createCellRange:r,keepDirection:n=!1,propToCol:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!tq.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(s){const o=t===nE;let a=o?s.from.row:s[0],l=o?s.from.col:s[1],u=o?s.to.row:s[2],c=o?s.to.col:s[3];if(typeof i=="function"&&(typeof l=="string"&&(l=i(l)),typeof c=="string"&&(c=i(c))),er(u)&&(u=a),er(c)&&(c=l),!n){const f=a,m=l,g=u,w=c;a=Math.min(f,g),l=Math.min(m,w),u=Math.max(f,g),c=Math.max(m,w)}const h=e(a,l),d=e(u,c);return r(h,h,d)}}function nq(t){const e=wh(t.getSelected());if(e===wv||e===vv)return[];const r=Vf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;V(t.getSelected(),o=>{const{from:a,to:l}=r(o),u=Math.max(a.col,0),c=l.col-u+1;V(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Hr(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function iq(t){const e=wh(t.getSelected());if(e===wv||e===vv)return[];const r=Vf(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),n=new Set;V(t.getSelected(),o=>{const{from:a,to:l}=r(o),u=Math.max(a.row,0),c=l.row-u+1;V(Array.from(new Array(c),(h,d)=>u+d),h=>{n.has(h)||n.add(h)})});const i=Array.from(n).sort((o,a)=>o-a);return Hr(i,(o,a,l,u)=>(l!==0&&a===u[l-1]+1?o[o.length-1][1]+=1:o.push([a,1]),o),[])}function mc(t,e,r){sq(t,e),e.set(t,r)}function sq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kl(t,e,r){return(e=oq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oq(t){var e=aq(t,"string");return typeof e=="symbol"?e:e+""}function aq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function or(t,e){return t.get(eH(t,e))}function Bs(t,e,r){return t.set(eH(t,e),r),r}function eH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Cn=new WeakMap,Fl=new WeakMap,Om=new WeakMap,ud=new WeakMap,Im=new WeakMap,cd=new WeakMap;class tH{constructor(e,r){var n=this;kl(this,"settings",void 0),kl(this,"tableProps",void 0),kl(this,"inProgress",!1),kl(this,"selectedRange",new QX((i,s,o)=>this.tableProps.createCellRange(i,s,o))),kl(this,"highlight",void 0),mc(this,Cn,void 0),mc(this,Fl,void 0),kl(this,"selectedByRowHeader",new Set),kl(this,"selectedByColumnHeader",new Set),mc(this,Om,!1),mc(this,ud,!1),mc(this,Im,"unknown"),mc(this,cd,-1),this.settings=e,this.tableProps=r,this.highlight=new qX({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[Yb()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(i,s)=>this.tableProps.isDisabledCellSelection(i,s),cellCornerVisible:function(){return n.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return n.isAreaCornerVisible(...arguments)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),createCellRange:(i,s,o)=>this.tableProps.createCellRange(i,s,o)}),Bs(Cn,this,new x1(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),Bs(Fl,this,new x1(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,i.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{const i=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,i.getOuterBottomEndCorner().col)},visualToRenderableCoords:i=>this.tableProps.visualToRenderableCoords(i),renderableToVisualCoords:i=>this.tableProps.renderableToVisualCoords(i),findFirstNonHiddenRenderableRow:function(){return n.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return n.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(i,s)=>this.tableProps.createCellCoords(i,s),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),or(Cn,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformStart",...s)}),or(Cn,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformStart",...s)}),or(Cn,this).addLocalHook("beforeTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformEnd",...s)}),or(Cn,this).addLocalHook("afterTransformEnd",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformEnd",...s)}),or(Cn,this).addLocalHook("insertRowRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertRowRequire",...s)}),or(Cn,this).addLocalHook("insertColRequire",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("insertColRequire",...s)}),or(Cn,this).addLocalHook("beforeRowWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeRowWrap",...s)}),or(Cn,this).addLocalHook("beforeColumnWrap",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeColumnWrap",...s)}),or(Fl,this).addLocalHook("beforeTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("beforeModifyTransformFocus",...s)}),or(Fl,this).addLocalHook("afterTransformStart",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("afterModifyTransformFocus",...s)})}getSelectedRange(){return this.selectedRange}markSource(e){Bs(Im,this,e)}markEndSource(){Bs(Im,this,"unknown")}getSelectionSource(){return or(Im,this)}setExpectedLayers(e){Bs(cd,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,Bs(cd,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const s=this.settings.selectionMode==="multiple",o=er(r)?this.tableProps.getShortcutManager().isCtrlPressed():r,a=e.clone();Bs(Om,this,!1),this.runLocalHooks(`beforeSetRangeStart${n?"Only":""}`,a),(!s||s&&!o&&er(r))&&this.selectedRange.clear(),this.selectedRange.add(a).current().setHighlight(i.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),n||this.setRangeEnd(e)}setRangeStartOnly(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,r,!0,n)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;const r=e.clone(),n=this.tableProps.countRows(),i=this.tableProps.countCols(),s=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((n>0||i>0)&&(n===0&&r.col<0&&!s||i===0&&r.row<0&&!s))return;this.runLocalHooks("beforeSetRangeEnd",r),this.begin();const o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),this.settings.selectionMode==="single")o.setFrom(o.highlight),o.setTo(o.highlight);else{const l=o.getHorizontalDirection(),u=o.getVerticalDirection(),c=this.isMultiple();o.setTo(r),c&&(l!==o.getHorizontalDirection()||o.getWidth()===1&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),c&&(u!==o.getVerticalDirection()||o.getHeight()===1&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}n>0&&i>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();const a=or(cd,this)===-1||this.selectedRange.size()===or(cd,this);this.runLocalHooks("afterSetRangeEnd",e,a)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectedRange.current(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const n=this.tableProps.countRows(),i=this.tableProps.countCols();r<this.highlight.layerLevel&&(V(this.highlight.getAreas(),m=>void m.clear()),V(this.highlight.getLayeredAreas(),m=>void m.clear()),V(this.highlight.getRowHeaders(),m=>void m.clear()),V(this.highlight.getColumnHeaders(),m=>void m.clear()),V(this.highlight.getActiveRowHeaders(),m=>void m.clear()),V(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),V(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),V(this.highlight.getRowHighlights(),m=>void m.clear()),V(this.highlight.getColumnHighlights(),m=>void m.clear())),this.highlight.useLayerLevel(r);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();if(s.clear(),o.clear(),a.clear(),l.clear(),u.clear(),c.clear(),h.clear(),d.clear(),f.clear(),this.highlight.isEnabledFor(Rx,e.highlight)&&(this.isMultiple()||r>=1)&&(s.add(e.from).add(e.to).commit(),o.add(e.from).add(e.to).commit(),r===1)){const m=this.selectedRange.previous();this.highlight.useLayerLevel(r-1),this.highlight.createArea().add(m.from).commit().syncWith(m),this.highlight.createLayeredArea().add(m.from).commit().syncWith(m),this.highlight.useLayerLevel(r)}if(this.highlight.isEnabledFor(xx,e.highlight)){if(!e.isSingleHeader()){const w=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),S=this.tableProps.createCellCoords(e.to.row,-1),b=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),y=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(a.add(w).commit(),l.add(b).commit(),d.add(w).commit(),f.add(b).commit()):(a.add(w).add(S).commit(),l.add(b).add(y).commit(),d.add(w).add(S).commit(),f.add(b).add(y).commit())}const m=!or(ud,this)&&this.isEntireRowSelected()&&(i>0&&i===e.getWidth()||i===0&&this.isSelectedByRowHeader()),g=!or(ud,this)&&this.isEntireColumnSelected()&&(n>0&&n===e.getHeight()||n===0&&this.isSelectedByColumnHeader());m&&u.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),g&&c.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),m&&g&&h.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;const r=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const n=this.highlight.getFocus();n.clear(),r.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(Ex,r.highlight)&&n.add(r.highlight).commit().syncWith(r),this.inProgress||(Bs(Om,this,!0),this.runLocalHooks("afterSetFocus",r.highlight))}transformStart(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;this.settings.navigableHeaders?or(Cn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):or(Cn,this).resetOffsetSize(),this.setRangeStart(or(Cn,this).transformStart(e,r,n))}transformEnd(e,r){this.settings.navigableHeaders?or(Cn,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):or(Cn,this).resetOffsetSize(),this.setRangeEnd(or(Cn,this).transformEnd(e,r))}transformFocus(e,r){const n=this.selectedRange.current(),{row:i,col:s}=n.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,s-1),a=this.tableProps.countRenderableRowsInRange(0,i-1);n.highlight.isHeader()?or(Fl,this).setOffsetSize({x:s<0?Math.abs(s):-o,y:i<0?Math.abs(i):-a}):or(Fl,this).setOffsetSize({x:s<0?0:-o,y:i<0?0:-a});const l=or(Fl,this).transformStart(e,r);this.setRangeFocus(l.normalize())}shiftRows(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||n.getOuterTopStartCorner().row>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=u?-1:0,h=u?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(Ht(i.row+h,c,a-1),i.col),f=this.tableProps.createCellCoords(Ht(s.row+r,c,a-1),s.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(Ht(o.row+r,0,a-1),o.col)):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}shiftColumns(e,r){if(!this.isSelected())return;const n=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||n.getOuterTopStartCorner().col>=e){const{from:i,to:s,highlight:o}=n,a=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),u=this.isSelectedByColumnHeader(),c=l?-1:0,h=l?0:r;this.getSelectedRange().pop();const d=this.tableProps.createCellCoords(i.row,Ht(i.col+h,c,a-1)),f=this.tableProps.createCellCoords(s.row,Ht(s.col+r,c,a-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(d,!0,this.tableProps.createCellCoords(o.row,Ht(o.col+r,0,a-1))):this.setRangeStartOnly(d,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),u&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;const e=zi(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&or(Om,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{col:s}=i.getOuterTopStartCorner(),o=this.tableProps.countRowHeaders(),a=this.tableProps.countCols();return(o>0&&s<0||o===0)&&i.getWidth()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const r=i=>{const{row:s}=i.getOuterTopStartCorner(),o=this.tableProps.countColHeaders(),a=this.tableProps.countRows();return(o>0&&s<0||o===0)&&i.getHeight()===a};if(e===-1)return Array.from(this.selectedRange).some(i=>r(i));const n=this.selectedRange.peekByIndex(e);return n?r(n):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const r=this.tableProps.visualToRenderableCoords(e);return r.row!==null&&r.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const s=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),u=n?-l:0,c=r?-a:0;if(u===0&&c===0&&(s===0||o===0))return;let h=(e=this.getSelectedRange().current())===null||e===void 0?void 0:e.highlight;const{focusPosition:d,disableHeadersHighlight:f}=i;Bs(ud,this,f),d&&Number.isInteger(d==null?void 0:d.row)&&Number.isInteger(d==null?void 0:d.col)&&(h=this.tableProps.createCellCoords(Ht(d.row,u,s-1),Ht(d.col,c,o-1)));const m=this.tableProps.createCellCoords(u,c),g=this.tableProps.createCellCoords(s-1,o-1);this.clear(),this.setRangeStartOnly(m,void 0,h),c<0&&this.selectedByRowHeader.add(this.getLayerLevel()),u<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(g),this.finish(),Bs(ud,this,!1)}selectCells(e){var r=this;const n=wh(e);if(n===vv)return!1;if(n===wv)throw new Error(Ft`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const i=Vf(n,{createCellCoords:function(){return r.tableProps.createCellCoords(...arguments)},createCellRange:function(){return r.tableProps.createCellRange(...arguments)},propToCol:l=>this.tableProps.propToCol(l),keepDirection:!0}),s=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:s?this.tableProps.countRowHeaders():0,countColHeaders:s?this.tableProps.countColHeaders():0},a=!e.some(l=>{const u=i(l),c=u.isValid(o);return!(c&&!u.containsHeaders()||c&&u.containsHeaders()&&u.isSingleHeader())});return a&&(this.clear(),this.setExpectedLayers(e.length),V(e,l=>{const{from:u,to:c}=i(l);this.setRangeStartOnly(u.clone(),!1),this.setRangeEnd(c.clone())}),this.finish()),a}selectColumns(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=typeof e=="string"?this.tableProps.propToCol(e):e,s=typeof r=="string"?this.tableProps.propToCol(r):r,o=this.tableProps.countRows(),a=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),u=l===0?0:-l,c=this.tableProps.createCellCoords(u,i),h=this.tableProps.createCellCoords(o-1,s),d=this.tableProps.createCellRange(c,c,h).isValid({countRows:o,countCols:a,countRowHeaders:0,countColHeaders:l});if(d){let f=0,m=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(f=Ht(n.row,u,o-1),m=Ht(n.col,Math.min(i,s),Math.max(i,s))):(f=Ht(n,u,o-1),m=i);const g=this.tableProps.createCellCoords(f,m),w=l===0?0:Ht(g.row,u,-1),S=o-1,b=this.tableProps.createCellCoords(w,i),y=this.tableProps.createCellCoords(S,s);this.runLocalHooks("beforeSelectColumns",b,y,g),b.row=w,y.row=S,this.setRangeStartOnly(b,void 0,g),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.runLocalHooks("afterSelectColumns",b,y,g),this.finish()}return d}selectRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const i=this.tableProps.countRows(),s=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),a=o===0?0:-o,l=this.tableProps.createCellCoords(e,a),u=this.tableProps.createCellCoords(r,s-1),c=this.tableProps.createCellRange(l,l,u).isValid({countRows:i,countCols:s,countRowHeaders:o,countColHeaders:0});if(c){let h=0,d=0;Number.isInteger(n==null?void 0:n.row)&&Number.isInteger(n==null?void 0:n.col)?(h=Ht(n.row,Math.min(e,r),Math.max(e,r)),d=Ht(n.col,a,s-1)):(h=e,d=Ht(n,a,s-1));const f=this.tableProps.createCellCoords(h,d),m=o===0?0:Ht(f.col,a,-1),g=s-1,w=this.tableProps.createCellCoords(e,m),S=this.tableProps.createCellCoords(r,g);this.runLocalHooks("beforeSelectRows",w,S,f),w.col=m,S.col=g,this.setRangeStartOnly(w,void 0,f),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(S),this.runLocalHooks("afterSelectRows",w,S,f),this.finish()}return c}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),r=this.tableProps.countCols();if(e===0||r===0){this.deselect();return}const n=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:i,to:s,highlight:o}=n;this.clear(),o.assign({row:Ht(o.row,-1/0,e-1),col:Ht(o.col,-1/0,r-1)}),i.assign({row:Ht(i.row,-1/0,e-1),col:Ht(i.col,-1/0,r-1)}),s.assign({row:Ht(s.row,0,e-1),col:Ht(s.col,0,r-1)}),this.selectedRange.ranges.push(n),this.highlight.getFocus().add(o).commit().syncWith(n),this.applyAndCommit(n)}commit(){if(this.highlight.getCustomSelections().forEach(i=>{i.commit()}),!this.isSelected())return;const r=this.highlight.getFocus(),n=this.getLayerLevel();r.commit().syncWith(this.selectedRange.current());for(let i=0;i<this.selectedRange.size();i+=1){this.highlight.useLayerLevel(i);const s=this.highlight.createArea(),o=this.highlight.createLayeredArea(),a=this.highlight.createRowHeader(),l=this.highlight.createColumnHeader(),u=this.highlight.createActiveRowHeader(),c=this.highlight.createActiveColumnHeader(),h=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),f=this.highlight.createColumnHighlight();s.commit(),o.commit(),a.commit(),l.commit(),u.commit(),c.commit(),h.commit(),d.commit(),f.commit()}this.highlight.useLayerLevel(n)}}Lt(tH,wn);const TA=/^(\r\n|\n\r|\r|\n)/,lq=/^[^\t\r\n]+/,_A=/^\t/;function uq(t){const e=[[""]];if(t.length===0)return e;let r=0,n=0,i;for(;t.length>0&&i!==t.length;)if(i=t.length,t.match(_A))t=t.replace(_A,""),r+=1,e[n][r]="";else if(t.match(TA))t=t.replace(TA,""),r=0,n+=1,e[n]=[""];else{let s="";if(t.startsWith('"')){let o=0,a=!0;for(;a;){const l=t.slice(0,1);l==='"'&&(o+=1),s+=l,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&o%2===0)&&(a=!1)}s=s.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,l=>new Array(Math.floor(l.length/2)).fill('"').join(""))}else{const o=t.match(lq);s=o?o[0]:"",t=t.slice(s.length)}e[n][r]=s}return e}function sf(t){let e,r,n,i,s="",o;for(e=0,r=t.length;e<r;e+=1){for(i=t[e].length,n=0;n<i;n+=1)n>0&&(s+="	"),o=t[e][n],typeof o=="string"?o.indexOf(`
`)>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:o==null?s+="":s+=o;e!==r-1&&(s+=`
`)}return s}function Ll(t,e,r){return(e=cq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function cq(t){var e=hq(t,"string");return typeof e=="symbol"?e:e+""}function hq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jc{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,r,n){Ll(this,"hot",void 0),Ll(this,"metaManager",void 0),Ll(this,"tableMeta",void 0),Ll(this,"dataSource",void 0),Ll(this,"duckSchema",void 0),Ll(this,"colToPropCache",void 0),Ll(this,"propToColCache",void 0),this.hot=e,this.metaManager=n,this.tableMeta=n.getTableMeta(),this.dataSource=r,this.duckSchema=this.createDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const r=this.tableMeta.columns;let n;if(this.colToPropCache=[],this.propToColCache=new Map,r){let i=0,s=0,o=!1;if(typeof r=="function"){const a=sv(e);i=a>0?a:this.countFirstRowKeys(),o=!0}else{const a=this.tableMeta.maxCols;i=Math.min(a,r.length)}for(n=0;n<i;n++){const a=o?r(n):r[n];if(ut(a)){if(typeof a.data<"u"){const l=o?s:n;this.colToPropCache[l]=a.data,this.propToColCache.set(a.data,l)}s+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return Hx(this.dataSource)}recursiveDuckColumns(e,r,n){let i=r,s=n,o;return typeof i>"u"&&(i=0,s=""),typeof e=="object"&&!Array.isArray(e)&&ct(e,(a,l)=>{a===null?(o=s+l,this.colToPropCache.push(o),this.propToColCache.set(o,i),i+=1):i=this.recursiveDuckColumns(a,i,`${l}.`)}),i}colToProp(e){if(Number.isInteger(e)===!1)return e;const r=this.hot.toPhysicalColumn(e);return r===null?e:this.colToPropCache&&ke(this.colToPropCache[r])?this.colToPropCache[r]:r}propToCol(e){const r=this.propToColCache.get(e);if(ke(r))return this.hot.toVisualColumn(r);const n=this.hot.toVisualColumn(e);return n===null?e:n}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?ph(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=this.hot.countSourceRows();let o=s,a=0,l=e;if((typeof l!="number"||l>=s)&&(l=s),l<this.hot.countRows()&&(o=this.hot.toPhysicalRow(l)),this.hot.runHooks("beforeCreateRow",l,r,n)===!1||o===null)return{delta:0};const c=this.tableMeta.maxRows,h=this.getSchema().length,d=[];for(;a<r&&s+a<c;){let m=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?m=Mn(this.getSchema()):(m=[],Ue(h-1,()=>m.push(null))):this.hot.dataType==="function"?m=this.tableMeta.dataSchema(l+a):(m={},yg(m,this.getSchema())),d.push(m),a+=1}this.hot.rowIndexMapper.insertIndexes(l,a),i==="below"&&(o=Math.min(o+1,s)),this.spliceData(o,0,d);const f=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),a>0&&(e==null?this.metaManager.createRow(null,a):n!=="auto"&&this.metaManager.createRow(o,r)),this.hot.runHooks("afterCreateRow",f,a,n),this.hot.forceFullRender=!0,{delta:a,startPhysicalIndex:o}}createCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:n,mode:i="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const s=this.dataSource,o=this.tableMeta.maxCols,a=this.hot.countSourceCols();let l=e;if((typeof l!="number"||l>=a)&&(l=a),this.hot.runHooks("beforeCreateCol",l,r,n)===!1)return{delta:0};let c=a;l<this.hot.countCols()&&(c=this.hot.toPhysicalColumn(l));const h=this.hot.countSourceRows();let d=this.hot.countCols(),f=0,m=c;i==="end"&&(m=Math.min(m+1,a));const g=m;for(;f<r&&d<o;){if(typeof l!="number"||l>=d)if(h>0)for(let S=0;S<h;S+=1)typeof s[S]>"u"&&(s[S]=[]),s[S].push(null);else s.push([null]);else for(let S=0;S<h;S++)s[S].splice(m,0,null);f+=1,m+=1,d+=1}this.hot.columnIndexMapper.insertIndexes(l,f),f>0&&(e==null?this.metaManager.createColumn(null,f):n!=="auto"&&this.metaManager.createColumn(g,r));const w=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",w,f,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),{delta:f,startPhysicalIndex:g}}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0,i=Number.isInteger(e)?e:-r;const s=this.visualRowsToPhysical(i,r),o=this.hot.countSourceRows();if(i=(o+i)%o,this.hot.runHooks("beforeRemoveRow",i,s.length,s,n)===!1)return!1;const l=s.length;if(this.filterData(i,l,s),i<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(s);const c=ke(this.tableMeta.columns)||ke(this.tableMeta.dataSchema);this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&c===!1&&this.hot.columnIndexMapper.setIndexesSequence([])}return s.slice(0).sort((c,h)=>h-c).forEach(c=>{this.metaManager.removeRow(c,1)}),this.hot.runHooks("afterRemoveRow",i,l,s,n),this.hot.forceFullRender=!0,!0}removeCol(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,n=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let i=typeof e!="number"?-r:e;i=(this.hot.countCols()+i)%this.hot.countCols();const s=this.visualColumnsToPhysical(i,r),o=s.slice(0).sort((h,d)=>d-h);if(this.hot.runHooks("beforeRemoveCol",i,r,s,n)===!1)return!1;let l=!0;const u=o.length,c=this.dataSource;for(let h=0;h<u;h++)l&&s[0]!==s[h]-h&&(l=!1);if(l)for(let h=0,d=this.hot.countSourceRows();h<d;h++)c[h].splice(s[0],r),h===0&&this.metaManager.removeColumn(s[0],r);else for(let h=0,d=this.hot.countSourceRows();h<d;h++)for(let f=0;f<u;f++)c[h].splice(o[f],1),h===0&&this.metaManager.removeColumn(o[f],1);return i<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(s),this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",i,r,s,n),this.hot.forceFullRender=!0,this.refreshDuckSchema(),!0}spliceCol(e,r,n){const i=this.hot.getDataAtCol(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];e1(l,o);let c=0;for(;c<n;)l.push(null),c+=1;return dN(l),this.hot.populateFromArray(r,e,l,null,null,"spliceCol"),s}spliceRow(e,r,n){const i=this.hot.getSourceDataAtRow(e),s=i.slice(r,r+n),o=i.slice(r+n);for(var a=arguments.length,l=new Array(a>3?a-3:0),u=3;u<a;u++)l[u-3]=arguments[u];e1(l,o);let c=0;for(;c<n;)l.push(null),c+=1;return this.hot.populateFromArray(e,r,[l],null,null,"spliceRow"),s}spliceData(e,r,n){if(this.hot.runHooks("beforeDataSplice",e,r,n)!==!1){const s=[...this.dataSource.slice(0,e),...n,...this.dataSource.slice(e)];this.dataSource.length=0,s.forEach(o=>this.dataSource.push(o))}}filterData(e,r,n){let i=this.hot.runHooks("filterData",e,r,n);Array.isArray(i)===!1&&(i=this.dataSource.filter((s,o)=>n.indexOf(o)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,i)}get(e,r){const n=this.hot.toPhysicalRow(e);let i=this.dataSource[n];const s=this.hot.runHooks("modifyRowData",n);i=isNaN(s)?s:i;const{dataDotNotation:o}=this.hot.getSettings();let a=null;if(i&&i.hasOwnProperty&&gr(i,r))a=i[r];else if(o&&typeof r=="string"&&r.indexOf(".")>-1){let l=i;if(!l)return null;const u=r.split(".");for(let c=0,h=u.length;c<h;c++)if(l=l[u[c]],typeof l>"u")return null;a=l}else typeof r=="function"&&(a=r(this.dataSource.slice(n,n+1)[0]));if(this.hot.hasHook("modifyData")){const l=zi(a);this.hot.runHooks("modifyData",n,this.propToCol(r),l,"get"),l.isTouched()&&(a=l.value)}return a}getCopyable(e,r){return this.hot.getCellMeta(e,this.propToCol(r)).copyable?this.get(e,r):""}set(e,r,n){const i=this.hot.toPhysicalRow(e);let s=n,o=this.dataSource[i];const a=this.hot.runHooks("modifyRowData",i);if(o=isNaN(a)?a:o,this.hot.hasHook("modifyData")){const u=zi(s);this.hot.runHooks("modifyData",i,this.propToCol(r),u,"set"),u.isTouched()&&(s=u.value)}const{dataDotNotation:l}=this.hot.getSettings();if(o&&o.hasOwnProperty&&gr(o,r))o[r]=s;else if(l&&typeof r=="string"&&r.indexOf(".")>-1){let u=o,c=0,h;const d=r.split(".");for(c=0,h=d.length-1;c<h;c++)typeof u[d[c]]>"u"&&(u[d[c]]={}),u=u[d[c]];u[d[c]]=s}else typeof r=="function"?r(this.dataSource.slice(i,i+1)[0],s):o[r]=s}visualRowsToPhysical(e,r){const n=this.hot.countSourceRows(),i=[];let s=(n+e)%n,o=r,a;for(;s<n&&o;)a=this.hot.toPhysicalRow(s),i.push(a),o-=1,s+=1;return i}visualColumnsToPhysical(e,r){const n=this.hot.countCols(),i=[];let s=(n+e)%n,o=r;for(;s<n&&o;){const a=this.hot.toPhysicalColumn(s);i.push(a),o-=1,s+=1}return i}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let r=0;r<this.hot.countCols();r++)this.set(e,this.colToProp(r),"")}getLength(){const e=this.tableMeta.maxRows;let r;e<0||e===0?r=0:r=e||1/0;const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(n,r)}getAll(){const e={row:0,col:0},r={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-r.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,r,Jc.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,r,n){const i=[];let s,o,a;const l=this.tableMeta.maxRows,u=this.tableMeta.maxCols;if(l===0||u===0)return[];const c=n===Jc.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,h=Math.min(Math.max(l-1,0),Math.max(e.row,r.row)),d=Math.min(Math.max(u-1,0),Math.max(e.col,r.col));for(s=Math.min(e.row,r.row);s<=h;s++){a=[];const f=s>=0?this.hot.toPhysicalRow(s):s;for(o=Math.min(e.col,r.col);o<=d&&f!==null;o++)a.push(c.call(this,s,this.colToProp(o)));f!==null&&i.push(a)}return i}getText(e,r){return sf(this.getRange(e,r,Jc.DESTINATION_RENDERER))}getCopyableText(e,r){return sf(this.getRange(e,r,Jc.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:dq,getItem:fq,hasItem:rH,getNames:gq,getValues:sye}=Ds("cellTypes");function iE(t){if(!rH(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return fq(t)}function Di(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:r,renderer:n,validator:i}=e;r&&Jn(t,r),n&&di(t,n),i&&gu(t,i),dq(t,e)}function mq(t,e){var r;return t==="CELL_TYPE"?!1:((r=e._automaticallyAssignedMetaProps)===null||r===void 0?void 0:r.has(t))||!gr(e,t)}function Cv(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const n=typeof e.type=="string"?iE(e.type):e.type;if(t._automaticallyAssignedMetaProps&&ct(e,(s,o)=>void t._automaticallyAssignedMetaProps.delete(o)),!ut(n))return;r===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const i={};ct(n,(s,o)=>{if(mq(o,r)){var a;i[o]=s,(a=t._automaticallyAssignedMetaProps)===null||a===void 0||a.add(o)}}),Dr(t,i)}function pq(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function r(){}Ns(r,t);for(let n=0;n<e.length;n++)r.prototype[e[n]]=void 0;return r}function t0(t){return Number.isInteger(t)&&t>=0}function r0(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Pm(t){return t==null}const nH=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,r,n;for(e=0,r=this.countRows();e<r;e++)if(n=this.getDataAtCell(e,t),br(n)===!1)return!1;return!0},isEmptyRow(t){let e,r,n,i;for(e=0,r=this.countCols();e<r;e++)if(n=this.getDataAtCell(t,e),br(n)===!1)return typeof n=="object"?(i=this.getCellMeta(t,e),iv(this.getSchema()[i.prop],n)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:void 0,validator:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",visibleRows:10,width:void 0,wordWrap:!0});function AA(t,e,r){return(e=wq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function wq(t){var e=vq(t,"string");return typeof e=="symbol"?e:e+""}function vq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cq(){return class{}}class Sq{constructor(e){AA(this,"metaCtor",Cq()),AA(this,"meta",void 0),this.meta=this.metaCtor.prototype,Dr(this.meta,nH()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var r;Dr(this.meta,e),Cv(this.meta,{...e,type:(r=e.type)!==null&&r!==void 0?r:this.meta.type},e)}}function yq(t,e,r){return(e=bq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bq(t){var e=xq(t,"string");return typeof e=="symbol"?e:e+""}function xq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Rq{constructor(e){yq(this,"meta",void 0);const r=e.getMetaConstructor();this.meta=new r}getMeta(){return this.meta}updateMeta(e){Dr(this.meta,e),Cv(this.meta,e,e)}}function Nm(t,e,r){return(e=Eq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eq(t){var e=Tq(t,"string");return typeof e=="symbol"?e:e+""}function Tq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class V0{constructor(e){Nm(this,"valueFactory",void 0),Nm(this,"data",[]),Nm(this,"index",[]),Nm(this,"holes",new Set),this.valueFactory=e}obtain(e){r0(()=>t0(e),"Expecting an unsigned number.");const r=this._getStorageIndexByKey(e);let n;if(r>=0)n=this.data[r],n===void 0&&(n=this.valueFactory(e),this.data[r]=n);else if(n=this.valueFactory(e),this.holes.size>0){const i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=n,this.index[e]=i}else this.data.push(n),this.index[e]=this.data.length-1;return n}insert(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;r0(()=>t0(e)||Pm(e),"Expecting an unsigned number or null/undefined argument.");const n=[],i=this.data.length;for(let o=0;o<r;o++)n.push(i+o),this.data.push(void 0);const s=Pm(e)?this.index.length:e;this.index=[...this.index.slice(0,s),...n,...this.index.slice(s)]}remove(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;r0(()=>t0(e)||Pm(e),"Expecting an unsigned number or null/undefined argument.");const n=this.index.splice(Pm(e)?this.index.length-r:e,r);for(let i=0;i<n.length;i++){const s=n[i];typeof s=="number"&&this.holes.add(s)}}size(){return this.data.length-this.holes.size}values(){return ha(this.data,(e,r)=>!this.holes.has(r))[Symbol.iterator]()}entries(){const e=[];for(let n=0;n<this.data.length;n++){const i=this._getKeyByStorageIndex(n);i!==-1&&e.push([i,this.data[n]])}let r=0;return{next:()=>{if(r<e.length){const n=e[r];return r+=1,{value:n,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function MA(t,e,r){return(e=_q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _q(t){var e=Aq(t,"string");return typeof e=="symbol"?e:e+""}function Aq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Mq=["data","width"];class Oq{constructor(e){MA(this,"globalMeta",void 0),MA(this,"metas",new V0(()=>this._createMeta())),this.globalMeta=e,this.metas=new V0(()=>this._createMeta())}updateMeta(e,r){const n=this.getMeta(e);Dr(n,r),Cv(n,r)}createColumn(e,r){this.metas.insert(e,r)}removeColumn(e,r){this.metas.remove(e,r)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return pq(this.globalMeta.getMetaConstructor(),Mq).prototype}}function OA(t,e,r){return(e=Iq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Iq(t){var e=Pq(t,"string");return typeof e=="symbol"?e:e+""}function Pq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Nq{constructor(e){OA(this,"columnMeta",void 0),OA(this,"metas",new V0(()=>this._createRow())),this.columnMeta=e}updateMeta(e,r,n){const i=this.getMeta(e,r);Dr(i,n),Cv(i,n)}createRow(e,r){this.metas.insert(e,r)}createColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).insert(e,r)}removeRow(e,r){this.metas.remove(e,r)}removeColumn(e,r){for(let n=0;n<this.metas.size();n++)this.metas.obtain(n).remove(e,r)}getMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);return n===void 0?i:i[n]}setMeta(e,r,n,i){var s;const o=this.metas.obtain(e).obtain(r);(s=o._automaticallyAssignedMetaProps)===null||s===void 0||s.delete(n),o[n]=i}removeMeta(e,r,n){const i=this.metas.obtain(e).obtain(r);delete i[n]}getMetas(){const e=[],r=Array.from(this.metas.values());for(let n=0;n<r.length;n++)ke(r[n])&&e.push(...r[n].values());return e}getMetasAtRow(e){r0(()=>t0(e),"Expecting an unsigned number.");const r=new Map(this.metas);return r.has(e)?Array.from(r.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new V0(e=>this._createMeta(e))}_createMeta(e){const r=this.columnMeta.getMetaConstructor(e);return new r}}class iH{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Sq(e),this.tableMeta=new Rq(this.globalMeta),this.columnMeta=new Oq(this.globalMeta),this.cellMeta=new Nq(this.columnMeta),n.forEach(i=>new i(this)),this.globalMeta.updateMeta(r)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,r){this.columnMeta.updateMeta(e,r)}getCellMeta(e,r,n){let{visualRow:i,visualColumn:s}=n;const o=this.cellMeta.getMeta(e,r);return o.visualRow=i,o.visualCol=s,o.row=e,o.col=r,this.runLocalHooks("afterGetCellMeta",o),o}getCellMetaKeyValue(e,r,n){if(typeof n!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,r,n)}setCellMeta(e,r,n,i){this.cellMeta.setMeta(e,r,n,i)}updateCellMeta(e,r,n){this.cellMeta.updateMeta(e,r,n)}removeCellMeta(e,r,n){this.cellMeta.removeMeta(e,r,n)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,r)}removeRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,r)}createColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,r),this.columnMeta.createColumn(e,r)}removeColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,r),this.columnMeta.removeColumn(e,r)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}Lt(iH,wn);function IA(t,e,r,n){const{hotInstance:i,dataMap:s,dataSource:o,internalSource:a,source:l,metaManager:u,firstRun:c}=n,h=An(a),d=i.getSettings();Array.isArray(d.dataSchema)?i.dataType="array":Jt(d.dataSchema)?i.dataType="function":i.dataType="object",s&&s.destroy(),t=i.runHooks(`before${h}`,t,c,l);const f=new Jc(i,t,u);if(e(f),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const m=f.getSchema();t=[];let g,w=0,S=0;for(w=0,S=d.startRows;w<S;w++)if((i.dataType==="object"||i.dataType==="function")&&d.dataSchema)g=Mn(m),t.push(g);else if(i.dataType==="array")g=Mn(m[0]),t.push(g);else{g=[];for(let b=0,y=d.startCols;b<y;b++)g.push(null);t.push(g)}}else throw new Error(`${a} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(i.dataType="array"),d.data=t,f.dataSource=t,o.data=t,o.dataType=i.dataType,o.colToProp=f.colToProp.bind(f),o.propToCol=f.propToCol.bind(f),o.countCachedColumns=f.countCachedColumns.bind(f),r(f),i.runHooks(`after${h}`,t,c,l),c||(i.runHooks("afterChange",null,a),i.render()),i.getSettings().ariaTags&&qe(i.rootElement,[SN(-1),Jw(i.countCols()+(i.view?i.countRowHeaders():0))])}function PA(t,e,r){return(e=Dq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Dq(t){var e=Hq(t,"string");return typeof e=="symbol"?e:e+""}function Hq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kq{constructor(e){PA(this,"metaManager",void 0),PA(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",r=>this.extendCellMeta(r)),He.getSingleton().add("beforeRender",r=>{r&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var r;const{row:n,col:i}=e;if((r=this.metaSyncMemo.get(n))!==null&&r!==void 0&&r.has(i))return;const{visualRow:s,visualCol:o}=e,a=this.metaManager.hot,l=a.colToProp(o);e.prop=l,a.runHooks("beforeGetCellMeta",s,o,e);const u=gr(e,"type")?e.type:null;let c=Jt(e.cells)?e.cells(n,i,l):null;if(u)if(c){var h;c.type=(h=c.type)!==null&&h!==void 0?h:u}else c={type:u};c&&this.metaManager.updateCellMeta(n,i,c),a.runHooks("afterGetCellMeta",s,o,e),this.metaSyncMemo.has(n)||this.metaSyncMemo.set(n,new Set),this.metaSyncMemo.get(n).add(i)}}function Fq(t,e,r){Lq(t,e),e.set(t,r)}function Lq(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function tS(t,e,r){return(e=$q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $q(t){var e=Bq(t,"string");return typeof e=="symbol"?e:e+""}function Bq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vq(t,e){return t.get(Wq(t,e))}function Wq(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var NA=new WeakMap;class Uq{constructor(e){tS(this,"metaManager",void 0),tS(this,"usageTracker",new Set),tS(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(r){if(this.metaManager.hot.isRtl()&&r==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Fq(this,NA,(r,n,i)=>{if(!i)throw new Error(`The \`${r}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,r)=>{const{initOnly:n,target:i,onChange:s}=e,o=typeof i=="string",a=o?i:r,l=`_${a}`;this.metaManager.globalMeta.meta[l]=this.metaManager.globalMeta.meta[a],s?(this.installPropWatcher(r,l,s),o&&this.installPropWatcher(i,l,s)):n&&(this.installPropWatcher(r,l,Vq(NA,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(r))})}installPropWatcher(e,r,n){const i=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[r]},set(s){const o=!i.usageTracker.has(e);i.usageTracker.add(e),n.call(i,e,s,o),this[r]=s},enumerable:!0,configurable:!0})}}const sH="gridDefault",Rl="editorManager.handlingEditor",jq={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},zq="hooksRefRegisterer",oH={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){V(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){ct(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};To(oH,"MIXIN_NAME",zq,{writable:!1,enumerable:!1});function os(t,e,r){return(e=Yq(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yq(t){var e=Gq(t,"string");return typeof e=="symbol"?e:e+""}function Gq(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Kq="base",Er=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Oh{static get EDITOR_TYPE(){return Kq}constructor(e){os(this,"hot",void 0),os(this,"state",Er.VIRGIN),os(this,"_opened",!1),os(this,"_fullEditMode",!1),os(this,"_closeCallback",null),os(this,"TD",null),os(this,"row",null),os(this,"col",null),os(this,"prop",null),os(this,"originalValue",null),os(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,r,n,i,s,o){this.TD=i,this.row=e,this.col=r,this.prop=n,this.originalValue=s,this.cellProperties=o,this.state=this.isOpened()?this.state:Er.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,r){let n,i,s,o;if(r){const l=this.hot.getSelectedLast();n=Math.max(Math.min(l[0],l[2]),0),i=Math.max(Math.min(l[1],l[3]),0),s=Math.max(l[0],l[2]),o=Math.max(l[1],l[3])}else[n,i,s,o]=[this.row,this.col,null,null];const a=this.hot.runHooks("modifyGetCellCoords",n,i);Array.isArray(a)&&([n,i]=a),this.hot.populateFromArray(n,i,e,s,o,"edit")}beginEditing(e,r){if(this.state!==Er.VIRGIN)return;const n=this.hot,i=n.rowIndexMapper.getRenderableFromVisualIndex(this.row),s=n.columnIndexMapper.getRenderableFromVisualIndex(this.col);if(n.view.scrollViewport(n._createCellCoords(i,s)),this.state=Er.EDITING,this.isInFullEditMode()){const o=typeof e=="string"?e:yr(this.originalValue);this.setValue(o)}this.open(r),this._opened=!0,this.focus(),n.view.render(),n.runHooks("afterBeginEditing",this.row,this.col)}finishEditing(e,r,n){let i;if(n){const s=this._closeCallback;this._closeCallback=o=>{s&&s(o),n(o),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Er.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Er.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const s=this.getValue();this.cellProperties.trimWhitespace?i=[[typeof s=="string"?String.prototype.trim.call(s||""):s]]:i=[[s]],this.state=Er.WAITING,this.saveValue(i,r),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",o=>{this.state=Er.FINISHED,this.discardEditor(o)}):(this.state=Er.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Er.FINISHED,this.discardEditor()}discardEditor(e){this.state===Er.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Er.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Er.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Er.WAITING}getEditedCellRect(){var e;const r=this.getEditedCell();if(!r)return;const{wtOverlays:n,wtViewport:i}=this.hot.view._wt,s=this.hot.rootWindow,o=Kr(r),a=tr(r),l=Kr(this.hot.rootElement),u=tr(this.hot.rootElement),c=n.topOverlay.holder,h=n.inlineStartOverlay.holder,d=c!==s?c.scrollTop:0,f=h!==s?h.scrollLeft:0,m=s.innerWidth-l.left-u,{wtTable:g}=(e=n.getParentOverlay(r))!==null&&e!==void 0?e:this.hot.view._wt,w=g.name,S=["master","inline_start"].includes(w)?d:0,b=["master","top","bottom"].includes(w)?f:0,y=o.top===l.top?0:1;let _=o.top-l.top-y-S,P=0;this.hot.isRtl()?P=s.innerWidth-o.left-a-m-1+b:P=o.left-l.left-1-b,["top","top_inline_start_corner"].includes(w)&&(_+=n.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(w)&&(P+=Math.abs(n.inlineStartOverlay.getOverlayOffset()));const z=this.hot.hasColHeaders(),I=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),W=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),U=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(z&&I<=0||I===U)&&(_+=1),W<=0&&(P+=1);const G=i.rowsRenderCalculator.startPosition,X=i.columnsRenderCalculator.startPosition,le=Math.abs(n.inlineStartOverlay.getScrollPosition()),xe=n.topOverlay.getScrollPosition(),be=qr(this.hot.rootDocument);let Ze=r.offsetTop;if(["inline_start","master"].includes(w)&&(Ze+=G-xe),["bottom","bottom_inline_start_corner"].includes(w)){const{wtViewport:re,wtTable:fe}=n.bottomOverlay.clone;Ze+=re.getWorkspaceHeight()-fe.getHeight()-be}let Le=r.offsetLeft;this.hot.isRtl()?(Le>=0?Le=g.getWidth()-r.offsetLeft:Le=Math.abs(Le),Le+=X-le-a):["top","master","bottom"].includes(w)&&(Le+=X-le);const Ne=vo(this.TD,this.hot.rootWindow),Me=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",at=parseInt(Ne[Me],10)>0?0:1,v=parseInt(Ne.borderTopWidth,10)>0?0:1,p=tr(r)+at,C=Ar(r)+v,x=NN(c)?be:0,R=DN(h)?be:0,F=this.hot.view.maximumVisibleElementWidth(Le)-x+at,q=Math.max(this.hot.view.maximumVisibleElementHeight(Ze)-R+v,23);return{top:_,start:P,height:C,maxHeight:q,width:p,maxWidth:F}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let r="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?r="top-inline-start-corner":r="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?r="bottom-inline-start-corner":r="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(r="inline-start"),r}}Lt(Oh,oH);const Xq={name:"editorCloseAndSaveByArrowKeys",callback(t,e,r){const n=t._getEditorManager(),i=n.getActiveEditor();i.isInFullEditMode()&&i.state===Er.EDITING||(n.closeEditorAndSaveChanges(),t.getSelected()&&(r.includes("arrowdown")?t.selection.transformStart(1,0):r.includes("arrowup")?t.selection.transformStart(-1,0):r.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):r.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},qq={name:"editorCloseAndSaveByEnter",callback(t,e){const r=t._getEditorManager();r.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),r.moveSelectionAfterEnter(e)}},Zq={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},Jq={name:"editorFastOpen",callback(t,e){const{highlight:r}=t.getSelectedRangeLast();r.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},Qq={name:"editorOpen",callback(t,e,r){const n=t._getEditorManager(),i=t.getSelectedRangeLast(),{highlight:s}=i;if(t.selection.isMultiple()&&!i.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const o=t.getSettings(),a=typeof o.enterMoves=="function"?o.enterMoves(e):o.enterMoves;r.includes("shift")?t.selection.transformFocus(-a.row,-a.col):t.selection.transformFocus(a.row,a.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?n.cellProperties.readOnly?n.moveSelectionAfterEnter(e):n.openEditor(null,e,!0):n.moveSelectionAfterEnter(e),Ji(e))}};function eZ(){return[jq,Xq,qq,Zq,Jq,Qq]}const tZ={name:"extendCellsSelectionDown",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(1,0)}},rZ={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.min(e.row+t.countVisibleRows(),t.countRows()-1),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,-1);if(n!==null){const i=t._createCellCoords(n,e.col),s=e.row-t.view.getFirstFullyVisibleRow(),o=Math.min(i.row-s,t.countRows()-1);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}},nZ={name:"extendCellsSelectionLeft",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,-1*t.getDirectionFactor())}},iZ={name:"extendCellsSelectionRight",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByColumnHeader())&&t.selection.transformEnd(0,t.getDirectionFactor())}},sZ={name:"extendCellsSelectionToColumns",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByRowHeader()?t.selection.selectAll(!0,!0):t.selectColumns(r.col,n.col,e)}},oZ={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(t.countRows()-1,-1),l=i.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},aZ={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const o=r.getNearestNotHiddenIndex(t.countCols()-1,-1),a=i.clone();a.col=n.col,e.setRangeStart(a,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,o))}}},lZ={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast();if(!t.selection.isSelectedByRowHeader()&&!t.selection.isSelectedByCorner()&&n.isCell()){const o=parseInt(t.getSettings().fixedColumnsStart,10),a=r.getNearestNotHiddenIndex(o,1),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},uZ={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},cZ={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByColumnHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),l=i.clone();l.col=n.col,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(s.row,a))}}},hZ={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:r}=t,{highlight:n,from:i,to:s}=t.getSelectedRangeLast(),o=n.isHeader()&&t.selection.isSelectedByRowHeader();if(n.isCell()||o){const a=r.getNearestNotHiddenIndex(0,1),l=i.clone();l.row=n.row,e.setRangeStart(l,void 0,!1,n.clone()),o&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(a,s.col))}}},dZ={name:"extendCellsSelectionToRows",callback(t){const{highlight:e,from:r,to:n}=t.getSelectedRangeLast();t.selection.isSelectedByColumnHeader()?t.selection.selectAll(!0,!0):t.selectRows(r.row,n.row,e)}},fZ={name:"extendCellsSelectionUp",callback(t){const{highlight:e}=t.getSelectedRangeLast();!t.selection.isSelectedByColumnHeader()&&!t.selection.isSelectedByCorner()&&(e.isCell()||e.isHeader()&&t.selection.isSelectedByRowHeader())&&t.selection.transformEnd(-1,0)}},gZ={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{to:e}=t.getSelectedRangeLast(),r=Math.max(e.row-t.countVisibleRows(),0),n=t.rowIndexMapper.getNearestNotHiddenIndex(r,1);if(n!==null){const i=t._createCellCoords(n,e.col),s=e.row-t.view.getFirstFullyVisibleRow(),o=Math.max(i.row-s,0);t.selection.setRangeEnd(i),t.scrollViewportTo({row:o,verticalSnap:"top",horizontalSnap:"start"})}}};function mZ(){return[tZ,rZ,nZ,iZ,sZ,oZ,aZ,lZ,uZ,cZ,hZ,dZ,fZ,gZ]}const pZ={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.transformStart(1,0)}},wZ={name:"moveCellSelectionDownByViewportHeight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=t.countVisibleRows()+r;n===t.countRows()-1?i=1:n+i>t.countRows()&&(i=t.countRows()-n-1),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},vZ={name:"moveCellSelectionInlineEnd",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(-i.row,-i.col):t.selection.transformStart(-i.row,-i.col)}},CZ={name:"moveCellSelectionInlineStart",callback(t,e){const r=t.getSettings(),n=t.getSelectedRangeLast(),i=typeof r.tabMoves=="function"?r.tabMoves(e):r.tabMoves;t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?t.selection.transformFocus(i.row,i.col):t.selection.transformStart(i.row,i.col)}},SZ={name:"moveCellSelectionLeft",callback(t){t.selection.transformStart(0,-1*t.getDirectionFactor())}},yZ={name:"moveCellSelectionRight",callback(t){t.selection.transformStart(0,t.getDirectionFactor())}},bZ={name:"moveCellSelectionToMostBottom",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);r===null&&(r=-1),t.selection.setRangeStart(t._createCellCoords(r,e))}},xZ={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsBottom,10),s=r.getNearestNotHiddenIndex(t.countRows()-i-1,-1),o=n.getNearestNotHiddenIndex(t.countCols()-1,-1);e.setRangeStart(t._createCellCoords(s,o))}},RZ={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:r}=t;e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,r.getNearestNotHiddenIndex(t.countCols()-1,-1)))}},EZ={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedColumnsStart,10),i=t.getSelectedRangeLast().highlight.row,s=r.getNearestNotHiddenIndex(n,1);e.setRangeStart(t._createCellCoords(i,s))}},TZ={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:r}=t,n=t.getSelectedRangeLast().highlight.row;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);i===null&&(i=t.isRtl()?-1:-t.countRowHeaders()),e.setRangeStart(t._createCellCoords(n,i))}},_Z={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:r}=t,{row:n}=t.getSelectedRangeLast().highlight;let i=r.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);i===null&&(i=t.isRtl()?-t.countRowHeaders():-1),e.setRangeStart(t._createCellCoords(n,i))}},AZ={name:"moveCellSelectionToMostTop",callback(t){const{col:e}=t.getSelectedRangeLast().highlight;let r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);r===null&&(r=-t.countColHeaders()),t.selection.setRangeStart(t._createCellCoords(r,e))}},MZ={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:r,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedRowsTop,10),s=parseInt(t.getSettings().fixedColumnsStart,10),o=r.getNearestNotHiddenIndex(i,1),a=n.getNearestNotHiddenIndex(s,1);e.setRangeStart(t._createCellCoords(o,a))}},OZ={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.transformStart(-1,0)}},IZ={name:"moveCellSelectionUpByViewportHight",callback(t){const{navigableHeaders:e}=t.getSettings(),r=e?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight;let i=-(t.countVisibleRows()+r);n===-r?i=-1:n+i<r&&(i=-(n+r)),t.selection.transformStart(i,0),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}};function PZ(){return[pZ,wZ,vZ,CZ,SZ,yZ,bZ,xZ,RZ,EZ,TZ,_Z,AZ,MZ,OZ,IZ]}const NZ={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},DZ={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeLast(),r=t.view.getFirstFullyVisibleRow()-1,n=t.view.getFirstFullyVisibleColumn()-1,i=t.view.getLastFullyVisibleRow()+1,s=t.view.getLastFullyVisibleColumn()+1,o=t._createCellCoords(r,n),a=t._createCellCoords(i,s);if(!t._createCellRange(o,o,a).includes(e)&&(e.row>=0||e.col>=0)){const u={};if(e.col>=0){const c=Math.floor(t.countVisibleCols()/2);u.col=Math.max(e.col-c,0)}if(e.row>=0){const c=Math.floor(t.countVisibleRows()/2);u.row=Math.max(e.row-c,0)}t.scrollViewportTo({...u,verticalSnap:"top",horizontalSnap:"start"})}}},HZ={name:"selectAllCells",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!0})}},kZ={name:"selectAllCellsAndHeaders",callback(t){t.selection.selectAll(!0,!0,{disableHeadersHighlight:!1})}},FZ={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:r,col:n}=e[e.length-1].highlight.normalize(),i=t.getDataAtCell(r,n),s=new Map;for(let o=0;o<e.length;o++)e[o].forAll((a,l)=>{if(a>=0&&l>=0&&(a!==r||l!==n)){const{readOnly:u}=t.getCellMeta(a,l);u||s.set(`${a}x${l}`,[a,l,i])}});t.setDataAtCell(Array.from(s.values()))}},LZ=[...eZ(),...mZ(),...PZ(),NZ,DZ,HZ,kZ,FZ];function aH(t){const e={};return LZ.forEach(r=>{let{name:n,callback:i}=r;e[n]=function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return i(t,...o)}}),e}function $Z(t){const e=t.getShortcutManager().addContext("editor"),r=aH(t),n={group:Rl};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(i,s)=>r.editorCloseAndSaveByEnter(i,s)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(i,s)=>r.editorCloseAndSave(i,s)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(i,s)=>r.editorCloseAndSaveByArrowKeys(i,s)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>r.editorCloseWithoutSaving()}],n)}function BZ(t){const e=t.getShortcutManager().addContext("grid"),r=aH(t),n={runOnlyIf:()=>{const{navigableHeaders:i}=t.getSettings();return ke(t.getSelected())&&(i||!i&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:sH};e.addShortcuts([{keys:[["F2"]],callback:i=>r.editorFastOpen(i)},{keys:[["Enter"],["Enter","Shift"]],callback:(i,s)=>r.editorOpen(i,s)},{keys:[["Backspace"],["Delete"]],callback:()=>r.emptySelectedCells()}],{group:Rl,runOnlyIf:()=>ke(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>r.selectAllCells(),runOnlyIf:()=>{var i;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var i;return(i=t.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>r.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>r.populateSelectedCellsData(),runOnlyIf:()=>{var i,s;return!((i=t.getSelectedRangeLast())!==null&&i!==void 0&&i.highlight.isHeader())&&((s=t.getSelectedRangeLast())===null||s===void 0?void 0:s.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>r.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>r.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>r.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>r.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>r.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>r.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>r.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>r.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>r.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>r.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>r.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>r.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>r.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>r.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>r.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>r.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineStart(i)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:i=>r.moveCellSelectionInlineEnd(i)},{keys:[["Control/Meta","Backspace"]],callback:()=>r.scrollToFocusedCell()}],n)}function VZ(t){[BZ,$Z].forEach(e=>e(t))}function WZ(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t.rootElement,n=DA(t),i=DA(t);return n.addEventListener("focus",()=>e==null?void 0:e.onFocusFromTop()),i.addEventListener("focus",()=>e==null?void 0:e.onFocusFromBottom()),r.firstChild.before(n),r.lastChild.after(i),{activate(){t._registerTimeout(()=>{n.tabIndex=0,i.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{n.tabIndex=-1,i.tabIndex=-1},10)}}}function DA(t){const r=t.rootDocument.createElement("input");return r.type="text",r.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&qe(r,[go(),Gu()]),r}function UZ(t){const e=jZ(t);let r;const{activate:n,deactivate:i}=WZ(t,{onFocusFromTop(){var h;const d=(h=e(r))!==null&&h!==void 0?h:R1(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_above",d),t.selectCell(d.row,d.col)),t.listen()},onFocusFromBottom(){var h;const d=(h=e(r))!==null&&h!==void 0?h:E1(t);d&&(t.runHooks("modifyFocusOnTabNavigation","from_below",d),t.selectCell(d.row,d.col)),t.listen()}}),s={wrapped:!1,flipped:!1};let o=!0,a=!1,l=!1;t.addHook("afterListen",()=>i()),t.addHook("afterUnlisten",()=>n()),t.addHook("afterSelection",(h,d,f,m,g)=>{if(a&&(s.wrapped&&s.flipped||l)&&(l=!1,g.value=!0),o){var w;r=(w=t.getSelectedRangeLast())===null||w===void 0?void 0:w.highlight}}),t.addHook("beforeRowWrap",(h,d,f)=>{s.wrapped=!0,s.flipped=f});function u(){s.wrapped=!1,s.flipped=!1,t.deselectCell(),t.unlisten()}const c={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:sH,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...c,callback:()=>{const{tabNavigation:h}=t.getSettings();a=!0,t.getSelectedRangeLast()&&!h&&(o=!1),h||(l=!0)},position:"before"},{...c,callback:h=>{const{tabNavigation:d,autoWrapRow:f}=t.getSettings();if(a=!1,o=!0,!d||!t.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return f&&s.wrapped&&s.flipped&&(r=h.shiftKey?R1(t):E1(t)),u(),!1;h.preventDefault()},position:"after"}])}function R1(t){const{rowIndexMapper:e,columnIndexMapper:r}=t,{navigableHeaders:n}=t.getSettings();let i=n&&t.countColHeaders()>0?-t.countColHeaders():0,s=n&&t.countRowHeaders()>0?-t.countRowHeaders():0;return i===0&&(i=e.getVisualFromRenderableIndex(i)),s===0&&(s=r.getVisualFromRenderableIndex(s)),i===null||s===null?null:t._createCellCoords(i,s)}function E1(t){var e,r;const{rowIndexMapper:n,columnIndexMapper:i}=t,{navigableHeaders:s}=t.getSettings();let o=n.getRenderableIndexesLength()-1,a=i.getRenderableIndexesLength()-1;if(o<0){if(!s||t.countColHeaders()===0)return null;o=-1}if(a<0){if(!s||t.countColHeaders()===0)return null;a=-1}return t._createCellCoords((e=n.getVisualFromRenderableIndex(o))!==null&&e!==void 0?e:o,(r=i.getVisualFromRenderableIndex(a))!==null&&r!==void 0?r:a)}function jZ(t){return e=>{if(!e)return null;const r=R1(t),n=E1(t);return e.col<r.col&&(e.col=r.col),e.col>n.col&&(e.col=n.col),e.row<r.row&&(e.row=r.row),e.row>n.row&&(e.row=n.row),e}}function zZ(t){return e=>{let{col:r}=e;t.scrollViewportTo({col:r})}}function YZ(){return()=>{}}function GZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function KZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function XZ(t){return e=>{t.scrollViewportTo(e.toObject())}}function qZ(t){return e=>{let{row:r}=e;t.scrollViewportTo({row:r})}}function ZZ(t){return e=>{const r=t.selection.getSelectionSource(),{row:n,col:i}=e;if(n<0&&i>=0)t.scrollViewportTo({col:i});else if(i<0&&n>=0)t.scrollViewportTo({row:n});else{if(r==="mouse"&&(i===t.view.getLastPartiallyVisibleColumn()||n===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:n,col:i})}}}function JZ(t){const{selection:e}=t;let r=!1,n=!1;return{resume(){n=!1},suspend(){n=!0},skipNextScrollCycle(){r=!0},scrollTo(i){var s;if(r||n){r=!1;return}let o;e.isFocusSelectionChanged()?o=GZ(t):e.isSelectedByCorner()?o=YZ():e.isSelectedByRowHeader()?o=qZ(t):e.isSelectedByColumnHeader()?o=zZ(t):e.getSelectedRange().size()===1&&e.isMultiple()?o=KZ(t):e.getSelectedRange().size()===1&&!e.isMultiple()?o=ZZ(t):e.getSelectedRange().size()>1&&(o=XZ(t)),(s=o)===null||s===void 0||s(i)}}}const HA=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),Dm=t=>t.map(e=>{const r=e.toLowerCase();return HA.has(r)?HA.get(r):r}).sort().join("+"),QZ=t=>t.split("+"),kA=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),rS=t=>{let{which:e,key:r}=t;if(kA.has(e))return kA.get(e);const n=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(n)?n:r.toLowerCase()},lH=Symbol("shortcut-context");function uH(t){return ut(t)&&t.__kindOf===lH}const eJ=t=>{const e=lv({errorIdExists:l=>`The "${l}" shortcut is already registered in the "${t}" context.`}),r=function(){let{keys:l,callback:u,group:c,runOnlyIf:h=()=>!0,captureCtrl:d=!1,preventDefault:f=!0,stopPropagation:m=!1,relativeToGroup:g,position:w,forwardToContext:S}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(er(c))throw new Error("You need to define the shortcut's group.");if(Jt(u)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(l)===!1)throw new Error(Ft`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const b={callback:u,group:c,runOnlyIf:h,captureCtrl:d,preventDefault:f,stopPropagation:m};ke(g)&&(b.relativeToGroup=g,b.position=w),uH(S)&&(b.forwardToContext=S),l.forEach(y=>{const _=Dm(y);if(e.hasItem(_)){const z=e.getItem(_);let I=z.findIndex(W=>W.group===g);I!==-1?w==="before"?I-=1:I+=1:I=z.length,z.splice(I,0,b)}else e.addItem(_,[b])})},n=function(l){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};l.forEach(c=>{ct(u,(h,d)=>{Object.prototype.hasOwnProperty.call(c,d)===!1&&(c[d]=u[d])}),r(c)})},i=l=>{const u=Dm(l);e.removeItem(u)};return{__kindOf:lH,addShortcut:r,addShortcuts:n,getShortcuts:l=>{const u=Dm(l),c=e.getItem(u);return ke(c)?c.slice():[]},hasShortcut:l=>{const u=Dm(l);return e.hasItem(u)},removeShortcutsByKeys:i,removeShortcutsByGroup:l=>{e.getItems().forEach(c=>{let[h,d]=c;const f=d.filter(m=>m.group!==l);f.length===0?i(QZ(h)):(d.length=0,d.push(...f))})}}};function tJ(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const rJ=["meta","alt","shift","control"],hd=tJ(),dd=[];let Hm=0;function nJ(t,e,r,n,i){const s=f=>rJ.includes(f),o=function(f){let m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const g=[];return f.altKey&&g.push("alt"),m&&(f.ctrlKey||f.metaKey)?g.push("control/meta"):(f.ctrlKey&&g.push("control"),f.metaKey&&g.push("meta")),f.shiftKey&&g.push("shift"),g},a=f=>{if(e(f)===!1)return;const m=r(f);if(f.keyCode===229||m===!1||Xa(f))return;const g=rS(f);let w=[];s(g)||(w=o(f));const S=[g].concat(w);!i(f,S)&&(Lf()&&w.includes("meta")||!Lf()&&w.includes("control"))&&i(f,[g].concat(o(f,!0))),n(f)},l=f=>{if(f.key){const m=rS(f);s(m)&&hd.press(m)}},u=f=>{if(f.key){const m=rS(f);s(m)&&hd.release(m)}},c=()=>{hd.releaseAll()};return{mount:()=>{let f=t;for(Hm+=1;f;)Hm===1&&(f.document.documentElement.addEventListener("keydown",l),dd.push({event:"keydown",listener:l}),f.document.documentElement.addEventListener("keyup",u),dd.push({event:"keyup",listener:u})),f.document.documentElement.addEventListener("keydown",a),f.document.documentElement.addEventListener("blur",c),f=Au(f)},unmount:()=>{let f=t;for(Hm-=1;f;){if(Hm===0){for(let m=0;m<dd.length;m++){const{event:g,listener:w}=dd[m];f.document.documentElement.removeEventListener(g,w)}dd.length=0}f.document.documentElement.removeEventListener("keydown",a),f.document.documentElement.removeEventListener("blur",c),f=Au(f)}},isPressed:f=>hd.isPressed(f),releasePressedKeys:()=>hd.releaseAll()}}const iJ=t=>{let{ownerWindow:e,handleEvent:r,beforeKeyDown:n,afterKeyDown:i}=t;const s=lv({errorIdExists:m=>`The "${m}" context name is already registered.`});let o="grid";const a=m=>{const g=eJ(m);return s.addItem(m,g),g},l=()=>o,u=m=>s.getItem(m),c=m=>{if(!s.hasItem(m))throw new Error(Ft`You've tried to activate the "${m}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);o=m};let h=!1;const d=function(m,g){let w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:l();const S=uH(w)?w:u(w);let b=!1;if(!S.hasShortcut(g))return b;const y=S.getShortcuts(g);for(let _=0;_<y.length;_++){const{callback:P,runOnlyIf:z,preventDefault:I,stopPropagation:W,captureCtrl:L,forwardToContext:U}=y[_];if(z(m)===!0){if(h=L,b=P(m,g)===!1,h=!1,I&&m.preventDefault(),W&&(Ji(m),m.stopPropagation()),b)break;U&&d(m,g,U)}}return b},f=nJ(e,r,n,i,d);return f.mount(),{addContext:a,getActiveContextName:l,getContext:u,setActiveContextName:c,isCtrlPressed:()=>!h&&(f.isPressed("control")||f.isPressed("meta")),releasePressedKeys:()=>f.releasePressedKeys(),destroy:()=>f.unmount()}};let nS=null;const iS=new Map;function cH(t,e){var r,n=this;let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=this;const o=new Xi(s);let a,l,u,c,h,d,f=!0;BK(i)&&$K(this),this.rootElement=t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const m=(r=e==null?void 0:e.layoutDirection)!==null&&r!==void 0?r:"inherit",g=["rtl","ltr"].includes(m)?m:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",g),this.isRtl=function(){return g==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1},e.language=HX(e.language);const w=new iH(s,e,[kq,Uq]),S=w.getTableMeta(),b=w.getGlobalMeta(),y=lv();this.container=this.rootDocument.createElement("div"),this.renderCall=!1,t.insertBefore(this.container,t.firstChild),Qp(this)&&pN(e.licenseKey,t),this.guid=`ht_${Wb()}`,iS.set(this.guid,this),this.columnIndexMapper=new y1,this.rowIndexMapper=new y1,this.columnIndexMapper.addLocalHook("indexesSequenceChange",v=>{s.runHooks("afterColumnSequenceChange",v)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",v=>{s.runHooks("afterRowSequenceChange",v)}),l=new QK(s),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const _=v=>{const{row:p,col:C}=v;return s._createCellCoords(p>=0?s.rowIndexMapper.getRenderableFromVisualIndex(p):p,C>=0?s.columnIndexMapper.getRenderableFromVisualIndex(C):C)},P=v=>{const{row:p,col:C}=v;return s._createCellCoords(p>=0?s.rowIndexMapper.getVisualFromRenderableIndex(p):p,C>=0?s.columnIndexMapper.getVisualFromRenderableIndex(C):C)},z=(v,p)=>{const C=p>v?1:-1,x=Math.min(v,p),R=Math.max(v,p),F=s.rowIndexMapper.getNearestNotHiddenIndex(v,C);return F===null||C===1&&F>R||C===-1&&F<x?null:F>=0?s.rowIndexMapper.getRenderableFromVisualIndex(F):F},I=(v,p)=>{const C=p>v?1:-1,x=Math.min(v,p),R=Math.max(v,p),F=s.columnIndexMapper.getNearestNotHiddenIndex(v,C);return F===null||C===1&&F>R||C===-1&&F<x?null:F>=0?s.columnIndexMapper.getRenderableFromVisualIndex(F):F};let W=new tH(S,{rowIndexMapper:s.rowIndexMapper,columnIndexMapper:s.columnIndexMapper,countCols:()=>s.countCols(),countRows:()=>s.countRows(),propToCol:v=>a.propToCol(v),isEditorOpened:()=>s.getActiveEditor()?s.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return n.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return n.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>s.getShortcutManager(),createCellCoords:(v,p)=>s._createCellCoords(v,p),createCellRange:(v,p,C)=>s._createCellRange(v,p,C),visualToRenderableCoords:_,renderableToVisualCoords:P,findFirstNonHiddenRenderableRow:z,findFirstNonHiddenRenderableColumn:I,isDisabledCellSelection:(v,p)=>v<0||p<0?s.getSettings().disableVisualSelection:s.getCellMeta(v,p).disableVisualSelection});this.selection=W;const L=v=>{let{hiddenIndexesChanged:p}=v;p&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",L),this.rowIndexMapper.addLocalHook("cacheUpdated",L),this.selection.addLocalHook("afterSetRangeEnd",(v,p)=>{const C=zi(!1),x=this.selection.getSelectedRange(),{from:R,to:F}=x.current(),q=x.size()-1;this.runHooks("afterSelection",R.row,R.col,F.row,F.col,C,q),this.runHooks("afterSelectionByProp",R.row,s.colToProp(R.col),F.row,s.colToProp(F.col),C,q),p&&(!C.isTouched()||C.isTouched()&&!C.value)&&d.scrollTo(v);const re=W.isSelectedByRowHeader(),fe=W.isSelectedByColumnHeader();re&&fe?ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]):re?(tt(this.rootElement,"ht__selection--columns"),ve(this.rootElement,"ht__selection--rows")):fe?(tt(this.rootElement,"ht__selection--rows"),ve(this.rootElement,"ht__selection--columns")):tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),W.getSelectionSource()!=="shift"&&c.closeEditor(null),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",v=>{this.runHooks("beforeSelectionFocusSet",v.row,v.col)}),this.selection.addLocalHook("afterSetFocus",v=>{const p=zi(!1);this.runHooks("afterSelectionFocusSet",v.row,v.col,p),(!p.isTouched()||p.isTouched()&&!p.value)&&d.scrollTo(v),c.closeEditor(),s.view.render(),c.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",v=>{const p=v.length-1,{from:C,to:x}=v[p];this.runHooks("afterSelectionEnd",C.row,C.col,x.row,x.col,p),this.runHooks("afterSelectionEndByProp",C.row,s.colToProp(C.col),x.row,s.colToProp(x.col),p)}),this.selection.addLocalHook("afterIsMultipleSelection",v=>{const p=this.runHooks("afterIsMultipleSelection",v.value);v.value&&(v.value=p)}),this.selection.addLocalHook("afterDeselect",()=>{c.closeEditor(),s.view.render(),tt(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("beforeSetRangeStart",...p)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("beforeSetRangeStartOnly",...p)}).addLocalHook("beforeSetRangeEnd",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("beforeSetRangeEnd",...p)}).addLocalHook("beforeSelectColumns",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("beforeSelectColumns",...p)}).addLocalHook("afterSelectColumns",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("afterSelectColumns",...p)}).addLocalHook("beforeSelectRows",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("beforeSelectRows",...p)}).addLocalHook("afterSelectRows",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("afterSelectRows",...p)}).addLocalHook("beforeModifyTransformStart",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("modifyTransformStart",...p)}).addLocalHook("afterModifyTransformStart",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("afterModifyTransformStart",...p)}).addLocalHook("beforeModifyTransformFocus",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("modifyTransformFocus",...p)}).addLocalHook("afterModifyTransformFocus",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("afterModifyTransformFocus",...p)}).addLocalHook("beforeModifyTransformEnd",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("modifyTransformEnd",...p)}).addLocalHook("afterModifyTransformEnd",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("afterModifyTransformEnd",...p)}).addLocalHook("beforeRowWrap",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("beforeRowWrap",...p)}).addLocalHook("beforeColumnWrap",function(){for(var v=arguments.length,p=new Array(v),C=0;C<v;C++)p[C]=arguments[C];return n.runHooks("beforeColumnWrap",...p)}).addLocalHook("insertRowRequire",v=>this.alter("insert_row_above",v,1,"auto")).addLocalHook("insertColRequire",v=>this.alter("insert_col_start",v,1,"auto")),u={alter(v,p){var C,x;let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,q=arguments.length>4?arguments[4]:void 0;const re=fe=>{if(fe.length===0)return[];const de=[...fe];return de.sort((Oe,Be)=>{let[ee]=Oe,[et]=Be;return ee===et?0:ee>et?1:-1}),Hr(de,(Oe,Be)=>{let[ee,et]=Be;const je=Oe[Oe.length-1],[ye,Xe]=je,Ve=ye+Xe;if(ee<=Ve){const T=Math.max(et-(Ve-ee),0);je[1]+=T}else Oe.push([ee,et]);return Oe},[de[0]])};switch(v){case"insert_row_below":case"insert_row_above":const fe=s.countSourceRows();if(S.maxRows===fe)return;const de=v==="insert_row_below"?"below":"above";p=(C=p)!==null&&C!==void 0?C:de==="below"?fe:0;const{delta:pe,startPhysicalIndex:Oe}=a.createRow(p,R,{source:F,mode:de});W.shiftRows(s.toVisualRow(Oe),pe);break;case"insert_col_start":case"insert_col_end":const Be=v==="insert_col_end"?"end":"start";p=(x=p)!==null&&x!==void 0?x:Be==="end"?s.countSourceCols():0;const{delta:ee,startPhysicalIndex:et}=a.createCol(p,R,{source:F,mode:Be});if(ee){if(Array.isArray(S.colHeaders)){const Xe=[s.toVisualColumn(et),0];Xe.length+=ee,Array.prototype.splice.apply(S.colHeaders,Xe)}W.shiftColumns(s.toVisualColumn(et),ee)}break;case"remove_row":const je=Xe=>{let Ve=0;V(Xe,T=>{let[M,B]=T;const Q=br(M)?s.countRows()-1:Math.max(M-Ve,0);if(Number.isInteger(M)&&(M=Math.max(M-Ve,0)),!a.removeRow(M,B,F))return;if(W.isSelected()){const{row:Z}=s.getSelectedRangeLast().highlight;Z>=M&&Z<=M+B-1&&c.closeEditor(!0)}const te=s.countRows();te===0?W.deselect():F==="ContextMenu.removeRow"?W.refresh():W.shiftRows(M,-B);const K=S.fixedRowsTop;K>=Q+1&&(S.fixedRowsTop-=Math.min(B,K-Q));const Y=S.fixedRowsBottom;Y&&Q>=te-Y&&(S.fixedRowsBottom-=Math.min(B,Y)),Ve+=B})};Array.isArray(p)?je(re(p)):je([[p,R]]);break;case"remove_col":const ye=Xe=>{let Ve=0;V(Xe,T=>{let[M,B]=T;const Q=br(M)?s.countCols()-1:Math.max(M-Ve,0);let j=s.toPhysicalColumn(Q);if(Number.isInteger(M)&&(M=Math.max(M-Ve,0)),!a.removeCol(M,B,F))return;if(W.isSelected()){const{col:Z}=s.getSelectedRangeLast().highlight;Z>=M&&Z<=M+B-1&&c.closeEditor(!0)}s.countCols()===0?W.deselect():F==="ContextMenu.removeColumn"?W.refresh():W.shiftColumns(M,-B);const Y=S.fixedColumnsStart;Y>=Q+1&&(S.fixedColumnsStart-=Math.min(B,Y-Q)),Array.isArray(S.colHeaders)&&(typeof j>"u"&&(j=-1),S.colHeaders.splice(j,B)),Ve+=B})};Array.isArray(p)?ye(re(p)):ye([[p,R]]);break;default:throw new Error(`There is no such action "${v}"`)}s.view.render(),q||u.adjustRowsAndCols()},adjustRowsAndCols(){const v=S.minRows,p=S.minSpareRows,C=S.minCols,x=S.minSpareCols;if(v){const R=s.countRows();R<v&&a.createRow(R,v-R,{source:"auto"})}if(p){const R=s.countEmptyRows(!0);if(R<p){const F=p-R,q=Math.min(F,S.maxRows-s.countSourceRows());a.createRow(s.countRows(),q,{source:"auto"})}}{let R;(C||x)&&(R=s.countEmptyCols(!0));let F=s.countCols();if(C&&!S.columns&&F<C){const q=C-F;R+=q,a.createCol(F,q,{source:"auto"})}if(x&&!S.columns&&s.dataType==="array"&&R<x){F=s.countCols();const q=x-R,re=Math.min(q,S.maxCols-F);a.createCol(F,re,{source:"auto"})}}s.view&&s.view.adjustElementsSize()},populateFromArray(v,p,C,x,R){let F,q,re,fe;const de=[],pe={},Oe=[],Be=v.row,ee=v.col;if(q=p.length,q===0)return!1;let et=0,je=0;switch(ut(C)&&(et=C.col-ee+1,je=C.row-Be+1),R){case"shift_down":const ye=Qd(p),Xe=ye.length,Ve=Math.max(Xe,et),T=s.getData().slice(Be),M=Qd(T).slice(ee,ee+Ve);for(re=0;re<Ve;re+=1)if(re<Xe){for(F=0,q=ye[re].length;F<je-q;F+=1)ye[re].push(ye[re][F%q]);re<M.length?Oe.push(ye[re].concat(M[re])):Oe.push(ye[re].concat(new Array(T.length).fill(null)))}else Oe.push(ye[re%Xe].concat(M[re]));s.populateFromArray(Be,ee,Qd(Oe));break;case"shift_right":const B=p.length,Q=Math.max(B,je),j=s.getData().slice(Be).map(De=>De.slice(ee));for(F=0;F<Q;F+=1)if(F<B){for(re=0,fe=p[F].length;re<et-fe;re+=1)p[F].push(p[F][re%fe]);if(F<j.length)for(let De=0;De<j[F].length;De+=1)p[F].push(j[F][De]);else p[F].push(...new Array(j[0].length).fill(null))}else p.push(p[F%q].slice(0,Q).concat(j[F]));s.populateFromArray(Be,ee,p);break;case"overwrite":default:pe.row=v.row,pe.col=v.col;let te=0,K=0,Y=!0,Z;const J=function(Ye){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const vt=p[Ye%p.length];return nt!==null?vt[nt%vt.length]:vt},ue=p.length,Ee=C?C.row-v.row+1:0;for(C?q=Ee:q=Math.max(ue,Ee),F=0;F<q&&!(C&&pe.row>C.row&&Ee>ue||!S.allowInsertRow&&pe.row>s.countRows()-1||pe.row>=S.maxRows);F++){const De=F-te,Ye=J(De).length,nt=C?C.col-v.col+1:0;if(C?fe=nt:fe=Math.max(Ye,nt),pe.col=v.col,Z=s.getCellMeta(pe.row,pe.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Z.skipRowOnPaste){te+=1,pe.row+=1,q+=1;continue}for(K=0,re=0;re<fe&&!(C&&pe.col>C.col&&nt>Ye||!S.allowInsertColumn&&pe.col>s.countCols()-1||pe.col>=S.maxCols);re++){if(Z=s.getCellMeta(pe.row,pe.col),(x==="CopyPaste.paste"||x==="Autofill.fill")&&Z.skipColumnOnPaste){K+=1,pe.col+=1,fe+=1;continue}if(Z.readOnly&&x!=="UndoRedo.undo"){pe.col+=1;continue}const vt=re-K;let lt=J(De,vt),Je=s.getDataAtCell(pe.row,pe.col);if(lt!==null&&typeof lt=="object")if(Array.isArray(lt)&&Je===null&&(Je=[]),Je===null||typeof Je!="object")Y=!1;else{const yt=ph(Array.isArray(Je)?Je:Je[0]||Je),rr=ph(Array.isArray(lt)?lt:lt[0]||lt);iv(yt,rr)||Array.isArray(yt)&&Array.isArray(rr)?lt=Mn(lt):Y=!1}else Je!==null&&typeof Je=="object"&&(Y=!1);Y&&de.push([pe.row,pe.col,lt]),Y=!0,pe.col+=1}pe.row+=1}s.setDataAtCell(de,null,null,x||"populateFromArray");break}}};function U(v){const p=UD(v);rE(p)?(s.runHooks("beforeLanguageChange",p),b.language=p,s.runHooks("afterLanguageChange",p)):jD(v)}function G(v,p){const C=v==="className"?s.rootElement:s.table;if(f)ve(C,p);else{let x=[],R=[];b[v]&&(x=Array.isArray(b[v])?b[v]:r1(b[v])),p&&(R=Array.isArray(p)?p:r1(p));const F=t1(x,R),q=t1(R,x);F.length&&tt(C,F),q.length&&ve(C,q)}b[v]=p}this.init=function(){l.setData(S.data),s.runHooks("beforeInit"),(ea()||ox())&&ve(s.rootElement,"mobile"),this.updateSettings(S,!0),this.view=new jK(this),c=f1.getInstance(s,S,W),d=JZ(s),h=new KY(s),Qp(this)&&UZ(s),s.runHooks("init"),this.forceFullRender=!0,this.view.render(),f&&s.rootElement.offsetParent===null&&HN(s.rootElement,()=>{s.view._wt.wtOverlays.updateLastSpreaderSize(),s.render(),s.view.adjustElementsSize()}),typeof f=="object"&&(s.runHooks("afterChange",f[0],f[1]),f=!1),s.runHooks("afterInit")};function X(){let v=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,v=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&v===!1&&(v=!0,this.onQueueEmpty(this.valid))}}}function le(v){const p=v.replace(",",".");return isNaN(parseFloat(p))===!1?parseFloat(p):v}function xe(v,p,C){if(!v.length){C();return}const x=s.getActiveEditor(),R=new X;let F=!0;R.onQueueEmpty=()=>{x&&F&&x.cancelChanges(),C()};for(let q=v.length-1;q>=0;q--){const[re,fe,,de]=v[q],pe=a.propToCol(fe);let Oe;Number.isInteger(pe)?Oe=s.getCellMeta(re,pe):Oe={...Object.getPrototypeOf(S),...S},Oe.type==="numeric"&&typeof de=="string"&&cD(de)&&(v[q][3]=le(de)),s.getCellValidator(Oe)&&(R.addValidatorToQueue(),s.validateCell(v[q][3],Oe,function(Be,ee){return function(et){if(typeof et!="boolean")throw new Error("Validation error: result is not boolean");et===!1&&ee.allowInvalid===!1&&(F=!1,v.splice(Be,1),ee.valid=!0),R.removeValidatorFormQueue()}}(q,Oe),p))}R.checkIfQueueIsEmpty()}function be(v,p){for(let x=v.length-1;x>=0;x--){let R=!1;if(v[x]===null){v.splice(x,1);continue}if(!((v[x][2]===null||v[x][2]===void 0)&&(v[x][3]===null||v[x][3]===void 0))){if(S.allowInsertRow)for(;v[x][0]>s.countRows()-1;){const{delta:F}=a.createRow(void 0,void 0,{source:p});if(F===0){R=!0;break}}if(s.dataType==="array"&&(!S.columns||S.columns.length===0)&&S.allowInsertColumn)for(;a.propToCol(v[x][1])>s.countCols()-1;){const{delta:F}=a.createCol(void 0,void 0,{source:p});if(F===0){R=!0;break}}R||a.set(v[x][0],v[x][1],v[x][3])}}const C=v.length>0;if(s.forceFullRender=!0,C){u.adjustRowsAndCols(),s.runHooks("beforeChangeRender",v,p),c.closeEditor(),s.view.render(),c.prepareEditor(),s.view.adjustElementsSize(),s.runHooks("afterChange",v,p||"edit");const x=s.getActiveEditor();x&&ke(x.refreshValue)&&x.refreshValue()}else s.view.render()}this._createCellCoords=function(v,p){return s.view._wt.createCellCoords(v,p)},this._createCellRange=function(v,p,C){return s.view._wt.createCellRange(v,p,C)},this.validateCell=function(v,p,C,x){let R=s.getCellValidator(p);function F(q){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||p.hidden===!0){C(q);return}const fe=p.visualCol,de=p.visualRow,pe=s.getCell(de,fe,!0);if(pe&&pe.nodeName!=="TH"){const Oe=s.rowIndexMapper.getRenderableFromVisualIndex(de),Be=s.columnIndexMapper.getRenderableFromVisualIndex(fe);s.view._wt.getSetting("cellRenderer",Oe,Be,pe)}C(q)}mN(R)&&(R=function(q){return function(re,fe){fe(q.test(re))}}(R)),Jt(R)?(v=s.runHooks("beforeValidate",v,p.visualRow,p.prop,x),s._registerImmediate(()=>{R.call(p,v,q=>{s&&(q=s.runHooks("afterValidate",q,v,p.visualRow,p.prop,x),p.valid=q,F(q),s.runHooks("postAfterValidate",q,v,p.visualRow,p.prop,x))})})):s._registerImmediate(()=>{p.valid=!0,F(p.valid,!1)})};function Ze(v,p,C){return Array.isArray(v)?v:[[v,p,C]]}function Le(v,p){const C=s.getActiveEditor(),x=s.runHooks("beforeChange",v,p||"edit"),R=v.filter(F=>F!==null);return x===!1||R.length===0?(C&&C.cancelChanges(),[]):R}this.setDataAtCell=function(v,p,C,x){const R=Ze(v,p,C),F=[];let q=x,re,fe,de;for(re=0,fe=R.length;re<fe;re++){if(typeof R[re]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof R[re][1]!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");R[re][1]>=this.countCols()?de=R[re][1]:de=a.colToProp(R[re][1]),F.push([R[re][0],de,l.getAtCell(this.toPhysicalRow(R[re][0]),R[re][1]),R[re][2]])}!q&&typeof v=="object"&&(q=p);const pe=Le(F,x);s.runHooks("afterSetDataAtCell",pe,q),xe(pe,q,()=>{be(pe,q)})},this.setDataAtRowProp=function(v,p,C,x){const R=Ze(v,p,C),F=[];let q=x,re,fe;for(re=0,fe=R.length;re<fe;re++)F.push([R[re][0],R[re][1],l.getAtCell(this.toPhysicalRow(R[re][0]),R[re][1]),R[re][2]]);!q&&typeof v=="object"&&(q=p);const de=Le(F,x);s.runHooks("afterSetDataAtRowProp",de,q),xe(de,q,()=>{be(de,q)})},this.listen=function(){s&&!s.isListening()&&(iS.forEach(v=>{s!==v&&v.unlisten()}),nS=s.guid,s.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(nS=null,s.runHooks("afterUnlisten"))},this.isListening=function(){return nS===s.guid},this.destroyEditor=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;c.closeEditor(v),s.view.render(),p&&W.isSelected()&&c.prepareEditor()},this.populateFromArray=function(v,p,C,x,R,F,q){if(!(typeof C=="object"&&typeof C[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const re=typeof x=="number"?s._createCellCoords(x,R):null;return u.populateFromArray(s._createCellCoords(v,p),C,re,F,q)},this.spliceCol=function(v,p,C){for(var x=arguments.length,R=new Array(x>3?x-3:0),F=3;F<x;F++)R[F-3]=arguments[F];return a.spliceCol(v,p,C,...R)},this.spliceRow=function(v,p,C){for(var x=arguments.length,R=new Array(x>3?x-3:0),F=3;F<x;F++)R[F-3]=arguments[F];return a.spliceRow(v,p,C,...R)},this.getSelected=function(){if(W.isSelected())return St(W.getSelectedRange(),v=>{let{from:p,to:C}=v;return[p.row,p.col,C.row,C.col]})},this.getSelectedLast=function(){const v=this.getSelected();let p;return v&&v.length>0&&(p=v[v.length-1]),p},this.getSelectedRange=function(){if(W.isSelected())return Array.from(W.getSelectedRange())},this.getSelectedRangeLast=function(){const v=this.getSelectedRange();let p;return v&&v.length>0&&(p=v[v.length-1]),p},this.emptySelectedCells=function(v){if(!W.isSelected()||this.countRows()===0||this.countCols()===0)return;const p=[];V(W.getSelectedRange(),C=>{if(C.isSingleHeader())return;const x=C.getTopStartCorner(),R=C.getBottomEndCorner();Ue(x.row,R.row,F=>{Ue(x.col,R.col,q=>{this.getCellMeta(F,q).readOnly||p.push([F,q,null])})})}),p.length>0&&this.setDataAtCell(p,v)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const v=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(v,0),!this.isRenderSuspended()&&v===this.renderSuspendedCounter&&(this.renderCall?this.render():s.view.render())},this.render=function(){this.view&&(this.renderCall=!0,this.forceFullRender=!0,this.isRenderSuspended()||s.view.render())},this.batchRender=function(v){this.suspendRender();const p=v();return this.resumeRender(),p},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const p=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(p,0),(!this.isExecutionSuspended()&&p===this.executionSuspendedCounter||v)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const C=v();return this.resumeExecution(p),C},this.batch=function(v){this.suspendRender(),this.suspendExecution();const p=v();return this.resumeExecution(),this.resumeRender(),p},this.refreshDimensions=function(){if(!s.view)return;const{width:v,height:p}=s.view.getLastSize(),{width:C,height:x}=s.rootElement.getBoundingClientRect(),R=C!==v||x!==p;s.runHooks("beforeRefreshDimensions",{width:v,height:p},{width:C,height:x},R)!==!1&&((R||s.view._wt.wtOverlays.scrollableElement===s.rootWindow)&&(s.view.setLastSize(C,x),s.render()),s.runHooks("afterRefreshDimensions",{width:v,height:p},{width:C,height:x},R))},this.updateData=function(v,p){IA(v,C=>{a=C},C=>{a=C,s.columnIndexMapper.fitToLength(this.getInitialColumnCount()),s.rowIndexMapper.fitToLength(this.countSourceRows()),u.adjustRowsAndCols(),W.refresh()},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"updateData",source:p,metaManager:w,firstRun:f})},this.loadData=function(v,p){IA(v,C=>{a=C},()=>{w.clearCellsCache(),s.initIndexMappers(),u.adjustRowsAndCols(),W.refresh(),f&&(f=[null,"loadData"])},{hotInstance:s,dataMap:a,dataSource:l,internalSource:"loadData",source:p,metaManager:w,firstRun:f})},this.getInitialColumnCount=function(){const v=S.columns;let p=0;if(Array.isArray(v))p=v.length;else if(Jt(v))if(s.dataType==="array"){const C=this.countSourceCols();for(let x=0;x<C;x+=1)v(x)&&(p+=1)}else(s.dataType==="object"||s.dataType==="function")&&(p=a.colToPropCache.length);else if(ke(S.dataSchema)){const C=a.getSchema();p=Array.isArray(C)?C.length:sv(C)}else p=this.countSourceCols();return p},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(v,p,C,x){return er(v)?a.getAll():a.getRange(s._createCellCoords(v,p),s._createCellCoords(C,x),a.DESTINATION_RENDERER)},this.getCopyableText=function(v,p,C,x){return a.getCopyableText(s._createCellCoords(v,p),s._createCellCoords(C,x))},this.getCopyableData=function(v,p){return a.getCopyable(v,a.colToProp(p))},this.getSchema=function(){return a.getSchema()},this.updateSettings=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=(f?s.loadData:s.updateData).bind(this);let x=!1,R,F;if(ke(v.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(ke(v.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(ke(v.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(R in v)R==="data"||(R==="language"?U(v.language):R==="className"?G("className",v.className):R==="tableClassName"&&s.table?(G("tableClassName",v.tableClassName),s.view._wt.wtOverlays.syncOverlayTableClassNames()):He.getSingleton().isRegistered(R)||He.getSingleton().isDeprecated(R)?(Jt(v[R])||Array.isArray(v[R]))&&(v[R].initialHook=!0,s.addHook(R,v[R])):!p&&gr(v,R)&&(b[R]=v[R]));v.data===void 0&&S.data===void 0?C(null,"updateSettings"):v.data!==void 0?C(v.data,"updateSettings"):v.columns!==void 0&&(a.createMap(),s.initIndexMappers());const q=s.countCols(),re=S.columns;if(re&&Jt(re)&&(x=!0),(v.cell!==void 0||v.cells!==void 0||v.columns!==void 0)&&w.clearCache(),q>0)for(R=0,F=0;R<q;R++){if(re){const pe=x?re(R):re[F];pe&&w.updateColumnMeta(F,pe)}F+=1}ke(v.cell)&&ct(v.cell,pe=>{s.setCellMetaObject(pe.row,pe.col,pe)}),s.runHooks("afterCellMetaReset");let fe=s.rootElement.style.height;fe!==""&&(fe=parseInt(s.rootElement.style.height,10));let de=v.height;if(Jt(de)&&(de=de()),p&&s.rootElement.getAttribute("style")&&s.rootElement.setAttribute("data-initialstyle",s.rootElement.getAttribute("style")),de===null){const pe=s.rootElement.getAttribute("data-initialstyle");pe&&(pe.indexOf("height")>-1||pe.indexOf("overflow")>-1)?s.rootElement.setAttribute("style",pe):(s.rootElement.style.height="",s.rootElement.style.overflow="")}else de!==void 0&&(s.rootElement.style.height=isNaN(de)?`${de}`:`${de}px`,s.rootElement.style.overflow="hidden");if(typeof v.width<"u"){let pe=v.width;Jt(pe)&&(pe=pe()),s.rootElement.style.width=isNaN(pe)?`${pe}`:`${pe}px`}p||(s.view&&(s.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),s.view._wt.exportSettingsAsClassNames()),s.runHooks("afterUpdateSettings",v)),u.adjustRowsAndCols(),s.view&&!f&&(s.forceFullRender=!0,s.view.render(),s.view._wt.wtOverlays.adjustElementsSize()),!p&&s.view&&(fe===""||de===""||de===void 0)&&fe!==de&&s.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const v=s.getSelectedLast();if(S.getValue){if(Jt(S.getValue))return S.getValue.call(s);if(v)return s.getData()[v[0][0]][S.getValue]}else if(v)return s.getDataAtCell(v[0],v[1])},this.getSettings=function(){return S},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(v,p,C,x,R){u.alter(v,p,C,x,R)},this.getCell=function(v,p){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=p,R=v;if(p>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(p)))return null;x=this.columnIndexMapper.getRenderableFromVisualIndex(p)}if(v>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(v)))return null;R=this.rowIndexMapper.getRenderableFromVisualIndex(v)}return R===null||x===null||R===void 0||x===void 0?null:s.view.getCellAtCoords(s._createCellCoords(R,x),C)},this.getCoords=function(v){const p=this.view._wt.wtTable.getCoords(v);if(p===null)return null;const{row:C,col:x}=p;let R=C,F=x;return C>=0&&(R=this.rowIndexMapper.getVisualFromRenderableIndex(C)),x>=0&&(F=this.columnIndexMapper.getVisualFromRenderableIndex(x)),s._createCellCoords(R,F)},this.colToProp=function(v){return a.colToProp(v)},this.propToCol=function(v){return a.propToCol(v)},this.toVisualRow=v=>this.rowIndexMapper.getVisualFromPhysicalIndex(v),this.toVisualColumn=v=>this.columnIndexMapper.getVisualFromPhysicalIndex(v),this.toPhysicalRow=v=>this.rowIndexMapper.getPhysicalFromVisualIndex(v),this.toPhysicalColumn=v=>this.columnIndexMapper.getPhysicalFromVisualIndex(v),this.getDataAtCell=function(v,p){return a.get(v,a.colToProp(p))},this.getDataAtRowProp=function(v,p){return a.get(v,p)},this.getDataAtCol=function(v){const p=[],C=a.getRange(s._createCellCoords(0,v),s._createCellCoords(S.data.length-1,v),a.DESTINATION_RENDERER);for(let x=0;x<C.length;x+=1)for(let R=0;R<C[x].length;R+=1)p.push(C[x][R]);return p},this.getDataAtProp=function(v){const p=[],C=a.getRange(s._createCellCoords(0,a.propToCol(v)),s._createCellCoords(S.data.length-1,a.propToCol(v)),a.DESTINATION_RENDERER);for(let x=0;x<C.length;x+=1)for(let R=0;R<C[x].length;R+=1)p.push(C[x][R]);return p},this.getSourceData=function(v,p,C,x){let R;return v===void 0?R=l.getData():R=l.getByRange(s._createCellCoords(v,p),s._createCellCoords(C,x)),R},this.getSourceDataArray=function(v,p,C,x){let R;return v===void 0?R=l.getData(!0):R=l.getByRange(s._createCellCoords(v,p),s._createCellCoords(C,x),!0),R},this.getSourceDataAtCol=function(v){return l.getAtColumn(v)},this.setSourceDataAtCell=function(v,p,C,x){const R=Ze(v,p,C),F=this.hasHook("afterSetSourceDataAtCell"),q=[];F&&V(R,fe=>{let[de,pe,Oe]=fe;q.push([de,pe,l.getAtCell(de,pe),Oe])}),V(R,fe=>{let[de,pe,Oe]=fe;l.setAtCell(de,pe,Oe)}),F&&this.runHooks("afterSetSourceDataAtCell",q,x),this.render();const re=s.getActiveEditor();re&&ke(re.refreshValue)&&re.refreshValue()},this.getSourceDataAtRow=function(v){return l.getAtRow(v)},this.getSourceDataAtCell=function(v,p){return l.getAtCell(v,p)},this.getDataAtRow=function(v){return a.getRange(s._createCellCoords(v,0),s._createCellCoords(v,this.countCols()-1),a.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(v,p,C,x){const R=v===void 0?[0,0,this.countRows(),this.countCols()]:[v,p,C,x],[F,q]=R;let[,,re,fe]=R,de=null,pe=null;re===void 0&&(re=F),fe===void 0&&(fe=q);let Oe="mixed";return Ue(Math.max(Math.min(F,re),0),Math.max(F,re),Be=>{let ee=!0;return Ue(Math.max(Math.min(q,fe),0),Math.max(q,fe),et=>(pe=this.getCellMeta(Be,et).type,de?ee=de===pe:de=pe,ee)),Oe=ee?pe:"mixed",ee}),Oe},this.removeCellMeta=function(v,p,C){const[x,R]=[this.toPhysicalRow(v),this.toPhysicalColumn(p)];let F=w.getCellMetaKeyValue(x,R,C);s.runHooks("beforeRemoveCellMeta",v,p,C,F)!==!1&&(w.removeCellMeta(x,R,C),s.runHooks("afterRemoveCellMeta",v,p,C,F)),F=null},this.spliceCellsMeta=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var C=arguments.length,x=new Array(C>2?C-2:0),R=2;R<C;R++)x[R-2]=arguments[R];if(x.length>0&&!Array.isArray(x[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");p>0&&w.removeRow(this.toPhysicalRow(v),p),x.length>0&&V(x.reverse(),F=>{w.createRow(this.toPhysicalRow(v)),V(F,(q,re)=>this.setCellMetaObject(v,re,q))}),s.render()},this.setCellMetaObject=function(v,p,C){typeof C=="object"&&ct(C,(x,R)=>{this.setCellMeta(v,p,R,x)})},this.setCellMeta=function(v,p,C,x){if(s.runHooks("beforeSetCellMeta",v,p,C,x)===!1)return;let F=v,q=p;v<this.countRows()&&(F=this.toPhysicalRow(v)),p<this.countCols()&&(q=this.toPhysicalColumn(p)),w.setCellMeta(F,q,C,x),s.runHooks("afterSetCellMeta",v,p,C,x)},this.getCellsMeta=function(){return w.getCellsMeta()},this.getCellMeta=function(v,p){let C=this.toPhysicalRow(v),x=this.toPhysicalColumn(p);return C===null&&(C=v),x===null&&(x=p),w.getCellMeta(C,x,{visualRow:v,visualColumn:p})},this.getColumnMeta=function(v){return w.getColumnMeta(this.toPhysicalColumn(v))},this.getCellMetaAtRow=function(v){return w.getCellsMetaAtRow(v)},this.isColumnModificationAllowed=function(){return!(s.dataType==="object"||S.columns)},this.getCellRenderer=function(v,p){const C=typeof v=="number"?s.getCellMeta(v,p).renderer:v.renderer;return typeof C=="string"?M0(C):er(C)?M0("text"):C},this.getCellEditor=function(v,p){const C=typeof v=="number"?s.getCellMeta(v,p).editor:v.editor;return typeof C=="string"?A0(C):er(C)?A0("text"):C},this.getCellValidator=function(v,p){const C=typeof v=="number"?s.getCellMeta(v,p).validator:v.validator;return typeof C=="string"?px(C):C},this.validateCells=function(v){this._validateCells(v)},this.validateRows=function(v,p){if(!Array.isArray(v))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(p,v)},this.validateColumns=function(v,p){if(!Array.isArray(v))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(p,void 0,v)},this._validateCells=function(v,p,C){const x=new X;v&&(x.onQueueEmpty=v);let R=s.countRows()-1;for(;R>=0;){if(p!==void 0&&p.indexOf(R)===-1){R-=1;continue}let F=s.countCols()-1;for(;F>=0;){if(C!==void 0&&C.indexOf(F)===-1){F-=1;continue}x.addValidatorToQueue(),s.validateCell(s.getDataAtCell(R,F),s.getCellMeta(R,F),q=>{if(typeof q!="boolean")throw new Error("Validation error: result is not boolean");q===!1&&(x.valid=!1),x.removeValidatorFormQueue()},"validateCells"),F-=1}R-=1}x.checkIfQueueIsEmpty()},this.getRowHeader=function(v){let p=S.rowHeaders,C=v;return C!==void 0&&(C=s.runHooks("modifyRowHeader",C)),C===void 0?(p=[],Ue(s.countRows()-1,x=>{p.push(s.getRowHeader(x))})):Array.isArray(p)&&p[C]!==void 0?p=p[C]:Jt(p)?p=p(C):p&&typeof p!="string"&&typeof p!="number"&&(p=C+1),p},this.hasRowHeaders=function(){return!!S.rowHeaders},this.hasColHeaders=function(){if(S.colHeaders!==void 0&&S.colHeaders!==null)return!!S.colHeaders;for(let v=0,p=s.countCols();v<p;v++)if(s.getColHeader(v))return!0;return!1},this.getColHeader=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const C=s.runHooks("modifyColHeader",v);if(C===void 0){const re=[],fe=s.countCols();for(let de=0;de<fe;de++)re.push(s.getColHeader(de));return re}let x=S.colHeaders;const R=function(re){const fe=[],de=s.countCols();let pe=0;for(;pe<de;pe++)Jt(S.columns)&&S.columns(pe)&&fe.push(pe);return fe[re]},F=s.toPhysicalColumn(C),q=R(F);return S.colHeaders===!1?x=null:S.columns&&Jt(S.columns)&&S.columns(q)&&S.columns(q).title?x=S.columns(q).title:S.columns&&S.columns[F]&&S.columns[F].title?x=S.columns[F].title:Array.isArray(S.colHeaders)&&S.colHeaders[F]!==void 0?x=S.colHeaders[F]:Jt(S.colHeaders)?x=S.colHeaders(F):S.colHeaders&&typeof S.colHeaders!="string"&&typeof S.colHeaders!="number"&&(x=dv(C)),x=s.runHooks("modifyColumnHeaderValue",x,v,p),x},this._getColWidthFromSettings=function(v){let p;if(v>=0&&(p=s.getCellMeta(0,v).width),(p===void 0||p===S.width)&&(p=S.colWidths),p!=null){switch(typeof p){case"object":p=p[v];break;case"function":p=p(v);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getColWidth=function(v){let p=s._getColWidthFromSettings(v);return p=s.runHooks("modifyColWidth",p,v),p===void 0&&(p=uv),p},this._getRowHeightFromSettings=function(v){let p=S.rowHeights;if(p!=null){switch(typeof p){case"object":p=p[v];break;case"function":p=p(v);break}typeof p=="string"&&(p=parseInt(p,10))}return p},this.getRowHeight=function(v){let p=s._getRowHeightFromSettings(v);return p=s.runHooks("modifyRowHeight",p,v),p},this.countSourceRows=function(){return l.countRows()},this.countSourceCols=function(){return l.countFirstRowKeys()},this.countRows=function(){return a.getLength()},this.countCols=function(){const v=S.maxCols,p=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(v,p)},this.countRenderedRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return s.view._wt.drawn?s.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return p1(s.countRows()-1,C=>{if(s.isEmptyRow(C))p+=1;else if(v===!0)return!1}),p},this.countEmptyCols=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,p=0;return p1(s.countCols()-1,C=>{if(s.isEmptyCol(C))p+=1;else if(v===!0)return!1}),p},this.isEmptyRow=function(v){return S.isEmptyRow.call(s,v)},this.isEmptyCol=function(v){return S.isEmptyCol.call(s,v)},this.selectCell=function(v,p,C,x){let R=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,F=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return er(v)||er(p)?!1:this.selectCells([[v,p,C,x]],R,F)},this.selectCells=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;p===!1&&d.suspend();const x=W.selectCells(v);return x&&C&&s.listen(),d.resume(),x},this.selectColumns=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v,C=arguments.length>2?arguments[2]:void 0;return W.selectColumns(v,p,C)},this.selectRows=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v,C=arguments.length>2?arguments[2]:void 0;return W.selectRows(v,p,C)},this.deselectCell=function(){W.deselect()},this.selectAll=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v,C=arguments.length>2?arguments[2]:void 0;d.skipNextScrollCycle(),W.selectAll(v,p,C)};const Ne=(v,p)=>v.getNearestNotHiddenIndex(p,1,!0);this.scrollViewportTo=function(v){var p;if(typeof v=="number"){var C;v={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(C=arguments[4])!==null&&C!==void 0?C:!0}}const{row:x,col:R,verticalSnap:F,horizontalSnap:q,considerHiddenIndexes:re}=(p=v)!==null&&p!==void 0?p:{};let fe,de,pe,Oe;F!==void 0&&(fe=F==="top",de=!fe),q!==void 0&&(pe=q==="start",Oe=!pe);let Be=x,ee=R;if(re===void 0||re){const ye=Number.isInteger(x)&&x>=0,Xe=Number.isInteger(R)&&R>=0,Ve=ye?Ne(this.rowIndexMapper,x):void 0,T=Xe?Ne(this.columnIndexMapper,R):void 0;if(Ve===null||T===null)return!1;Be=ye?s.rowIndexMapper.getRenderableFromVisualIndex(Ve):x,ee=Xe?s.columnIndexMapper.getRenderableFromVisualIndex(T):R}const et=Number.isInteger(Be),je=Number.isInteger(ee);return et&&Be>=0&&je&&ee>=0?s.view.scrollViewport(s._createCellCoords(Be,ee),fe,Oe,de,pe):et&&Be>=0&&(je&&ee<0||!je)?s.view.scrollViewportVertically(Be,fe,de):je&&ee>=0&&(et&&Be<0||!et)?s.view.scrollViewportHorizontally(ee,Oe,pe):!1},this.scrollToFocusedCell=function(){let v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:()=>{};if(!this.selection.isSelected())return;this.addHookOnce("afterScroll",v);const{highlight:p}=this.getSelectedRangeLast();this.scrollViewportTo(p.toObject())?this.view.render():(this.removeHook("afterScroll",v),this._registerImmediate(()=>v()))},this.destroy=function(){if(s._clearTimeouts(),s._clearImmediates(),s.view&&s.view.destroy(),l&&l.destroy(),l=null,this.getShortcutManager().destroy(),w.clearCache(),iS.delete(this.guid),Qp(s)){const v=this.rootDocument.querySelector(".hot-display-license-info");v&&v.parentNode.removeChild(v)}As(s.rootElement),o.destroy(),c&&c.destroy(),s.batchExecution(()=>{s.rowIndexMapper.unregisterAll(),s.columnIndexMapper.unregisterAll(),y.getItems().forEach(v=>{let[,p]=v;p.destroy()}),y.clear(),s.runHooks("afterDestroy")},!0),He.getSingleton().destroy(s),ct(s,(v,p,C)=>{Jt(v)?C[p]=Me(p):p!=="guid"&&(C[p]=null)}),s.isDestroyed=!0,a&&a.destroy(),a=null,u=null,W=null,c=null,s=null};function Me(v){return()=>{throw new Error(`The "${v}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return c.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return s.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return s.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return s.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return s.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return s.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return s.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return s.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return s.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return s.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return s.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return s.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return s.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(v){const p=An(v);return p==="UndoRedo"?this.undoRedo:y.getItem(p)},this.getPluginName=function(v){return v===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:y.getId(v)},this.getInstance=function(){return s},this.addHook=function(v,p,C){He.getSingleton().add(v,p,s,C)},this.hasHook=function(v){return He.getSingleton().has(v,s)||He.getSingleton().has(v)},this.addHookOnce=function(v,p,C){He.getSingleton().once(v,p,s,C)},this.removeHook=function(v,p){He.getSingleton().remove(v,p,s)},this.runHooks=function(v,p,C,x,R,F,q){return He.getSingleton().run(s,v,p,C,x,R,F,q)},this.getTranslatedPhrase=function(v,p){return qD(S.language,v,p)},this.toHTML=()=>g1(this),this.toTableElement=()=>{const v=this.rootDocument.createElement("div");return v.insertAdjacentHTML("afterbegin",g1(this)),v.firstElementChild},this.timeouts=[],this._registerTimeout=function(v){let p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,C=v;typeof C=="function"&&(C=setTimeout(C,p)),this.timeouts.push(C)},this._clearTimeouts=function(){V(this.timeouts,v=>{clearTimeout(v)})},this.immediates=[],this._registerImmediate=function(v){this.immediates.push(setImmediate(v))},this._clearImmediates=function(){V(this.immediates,v=>{clearImmediate(v)})},this._getEditorManager=function(){return c},this.isRtl=function(){return s.rootWindow.getComputedStyle(s.rootElement).direction==="rtl"},this.isLtr=function(){return!s.isRtl()},this.getDirectionFactor=function(){return s.isLtr()?1:-1};const at=iJ({handleEvent(){return s.isListening()},beforeKeyDown:v=>this.runHooks("beforeKeyDown",v),afterKeyDown:v=>{this.isDestroyed||s.runHooks("afterDocumentKeyDown",v)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",v=>{v.ctrlKey===!1&&v.metaKey===!1&&at.releasePressedKeys()}),this.getShortcutManager=function(){return at},this.getFocusManager=function(){return h},mx().forEach(v=>{const p=bg(v);y.addItem(v,new p(this))}),VZ(s),at.setActiveContextName("grid"),He.getSingleton().run(s,"construct")}function FA(t,e,r){t.addEventListener(e,r,!1)}function LA(t,e,r){t.removeEventListener(e,r,!1)}function $A(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function sJ(t){const e={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},r=t.body,n=t.createTextNode(""),i=t.createElement("span");let s;function o(){n.textContent=s.value,i.style.position="absolute",i.style.fontSize=$A(s).fontSize,i.style.fontFamily=$A(s).fontFamily,i.style.whiteSpace="pre",r.appendChild(i);const c=i.clientWidth+2;r.removeChild(i);const h=s.style;h.height=`${e.minHeight}px`,e.minWidth>c?h.width=`${e.minWidth}px`:c>e.maxWidth?h.width=`${e.maxWidth}px`:h.width=`${c}px`;const d=s.scrollHeight?s.scrollHeight-1:0;e.minHeight>d?h.height=`${e.minHeight}px`:e.maxHeight<d?(h.height=`${e.maxHeight}px`,h.overflowY="visible"):h.height=`${d}px`}function a(){t.defaultView.setTimeout(o,0)}function l(c){if(c&&c.minHeight)if(c.minHeight==="inherit")e.minHeight=s.clientHeight;else{const h=parseInt(c.minHeight,10);isNaN(h)||(e.minHeight=h)}if(c&&c.maxHeight)if(c.maxHeight==="inherit")e.maxHeight=s.clientHeight;else{const h=parseInt(c.maxHeight,10);isNaN(h)||(e.maxHeight=h)}if(c&&c.minWidth)if(c.minWidth==="inherit")e.minWidth=s.clientWidth;else{const h=parseInt(c.minWidth,10);isNaN(h)||(e.minWidth=h)}if(c&&c.maxWidth)if(c.maxWidth==="inherit")e.maxWidth=s.clientWidth;else{const h=parseInt(c.maxWidth,10);isNaN(h)||(e.maxWidth=h)}i.firstChild||(i.className="autoResize",i.style.display="inline-block",i.appendChild(n))}function u(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;s=c,l(h),s.nodeName==="TEXTAREA"&&(s.style.resize="none",s.style.height=`${e.minHeight}px`,s.style.minWidth=`${e.minWidth}px`,s.style.maxWidth=`${e.maxWidth}px`,s.style.overflowY="hidden"),d&&(FA(s,"input",o),FA(s,"keydown",a)),o()}return{init:u,resize:o,unObserve(){LA(s,"input",o),LA(s,"keydown",a)}}}function BA(t,e){const r=Zb(e),n=e.value.split(`
`);let i=r,s=0;for(let o=0;o<n.length;o++){const a=n[o];o!==0&&(s+=n[o-1].length+1);const l=s+a.length;if(t==="home"?i=s:t==="end"&&(i=l),r<=l)break}vg(e,i)}function $l(t,e,r){return(e=oJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function oJ(t){var e=aJ(t,"string");return typeof e=="symbol"?e:e+""}function aJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lJ="ht_editor_visible",km="ht_editor_hidden",VA="textEditor",uJ="text";class Zu extends Oh{static get EDITOR_TYPE(){return uJ}constructor(e){super(e),$l(this,"eventManager",new Xi(this)),$l(this,"autoResize",sJ(this.hot.rootDocument)),$l(this,"TEXTAREA",void 0),$l(this,"textareaStyle",void 0),$l(this,"TEXTAREA_PARENT",void 0),$l(this,"textareaParentStyle",void 0),$l(this,"layerClass",void 0),this.eventManager=new Xi(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),RN(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,r,n,i,s,o){const a=this.state;if(super.prepare(e,r,n,i,s,o),!o.readOnly){this.refreshDimensions(!0);const{allowInvalid:l}=o;l&&!this.isOpened()&&(this.TEXTAREA.value=""),a!==Er.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,r){this.state===Er.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,r))}focus(){this.TEXTAREA.select(),vg(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),qe(this.TEXTAREA,[["data-hot-input",""],Th(-1)]),ve(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),ve(this.TEXTAREA_PARENT,"handsontableInputHolder"),Qe(this.TEXTAREA_PARENT,this.layerClass)&&tt(this.TEXTAREA_PARENT,this.layerClass),ve(this.TEXTAREA_PARENT,km),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){qN()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",tt(this.TEXTAREA_PARENT,this.layerClass),ve(this.TEXTAREA_PARENT,km)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let r=!1;Ue(e.length-1,n=>{const i=e[n];if(Qe(i,"handsontableEditor"))return r=!0,!1}),Qe(this.TEXTAREA_PARENT,km)&&tt(this.TEXTAREA_PARENT,km),r?(this.layerClass=lJ,ve(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),ve(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),r=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=r,this.setValue(r),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Er.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:r,start:n,width:i,maxWidth:s,height:o,maxHeight:a}=this.getEditedCellRect();this.textareaParentStyle.top=`${r}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${n}px`,this.showEditableElement();const l=vo(this.TD,this.hot.rootWindow);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor;const u=vo(this.TEXTAREA),c=parseInt(u.paddingLeft,10)+parseInt(u.paddingRight,10),h=parseInt(u.paddingTop,10)+parseInt(u.paddingBottom,10),d=i-c,f=o-h,m=s-c,g=a-h;this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,m),minHeight:Math.min(f,g),maxWidth:m,maxHeight:g},!0)}bindEvents(){sx()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Er.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Er.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={runOnlyIf:()=>ke(this.hot.getSelected()),group:VA},i=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};r.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(i(),!1),runOnlyIf:s=>!this.hot.selection.isMultiple()&&!s.altKey},{keys:[["Meta","Enter"]],callback:()=>(i(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(i(),!1)},{keys:[["Home"]],callback:(s,o)=>{let[a]=o;BA(a,this.TEXTAREA)}},{keys:[["End"]],callback:(s,o)=>{let[a]=o;BA(a,this.TEXTAREA)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(VA)}}const cJ="base";function _g(t,e,r,n,i,s,o){const a=o.ariaTags,l=[],u=[],c=[],h=[];o.className&&ve(e,o.className),o.readOnly?(l.push(o.readOnlyCellClassName),a&&h.push(T_())):a&&c.push(T_()[0]),o.valid===!1&&o.invalidCellClassName?(l.push(o.invalidCellClassName),a&&h.push(__())):(u.push(o.invalidCellClassName),a&&c.push(__()[0])),o.wordWrap===!1&&o.noWordWrapClassName&&l.push(o.noWordWrapClassName),!s&&o.placeholder&&l.push(o.placeholderCellClassName),tt(e,u),ve(e,l),Ku(e,c),qe(e,h)}_g.RENDERER_TYPE=cJ;const hJ="text";function ya(t,e,r,n,i,s,o){_g.apply(this,[t,e,r,n,i,s,o]);let a=s;if(!a&&o.placeholder&&(a=o.placeholder),a=yr(a),o.trimWhitespace&&(a=a.trim()),o.rendererTemplate){As(e);const l=t.rootDocument.createElement("TEMPLATE");l.setAttribute("bind","{{}}"),l.innerHTML=o.rendererTemplate,HTMLTemplateElement.decorate(l),l.model=t.getSourceDataAtRow(r),e.appendChild(l)}else gl(e,a)}ya.RENDERER_TYPE=hJ;const dJ="text",hH={CELL_TYPE:dJ,editor:Zu,renderer:ya};Di(hH);rt.editors={BaseEditor:Oh};function rt(t,e){const r=new cH(t,e||{},Nx);return r.init(),r}rt.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new cH(t,e,Nx)};rt.DefaultSettings=nH();rt.hooks=He.getSingleton();rt.CellCoords=Iu;rt.CellRange=xg;rt.packageName="handsontable";rt.buildDate="17/10/2024 09:16:16";rt.version="14.6.1";rt.languages={dictionaryKeys:AX,getLanguageDictionary:XD,getLanguagesDictionaries:NX,registerLanguageDictionary:KD,getTranslatedPhrase:qD};const WA="handsontableEditor",fJ="handsontable";class sE extends Zu{static get EDITOR_TYPE(){return fJ}open(){super.open(),this.htEditor&&this.htEditor.destroy(),this.htContainer.style.display==="none"&&(this.htContainer.style.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),vg(this.TEXTAREA,0,this.TEXTAREA.value.length),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,afterOnCellMouseDown(u,c){const h=this.getSourceData(c.row,c.col);h!==void 0&&a.setValue(h),a.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Dr(l,o.handsontable),this.htOptions=l}beginEditing(e,r){const n=this.hot.getSettings().onBeginEditing;n&&n()===!1||super.beginEditing(e,r)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,r,n){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){const i=this.htEditor.getValue();i!==void 0&&this.setValue(i)}super.finishEditing(e,r,n)}assignHooks(){this.hot.addHook("afterDestroy",()=>{this.htEditor&&this.htEditor.destroy()})}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const n={group:WA,relativeToGroup:Rl,position:"before"},i=(s,o)=>{const a=this.htEditor;if(s!==void 0&&(s<0||a.flipped&&s>a.countRows()-1?a.deselectCell():a.selectCell(s,0),a.getData().length))return o.preventDefault(),Ji(o),this.hot.listen(),this.TEXTAREA.focus(),!1};r.addShortcuts([{keys:[["ArrowUp"]],callback:s=>{const o=this.htEditor;let a,l;return!o.getSelectedLast()&&o.flipped?a=o.countRows()-1:o.getSelectedLast()&&(o.flipped?(l=o.getSelectedLast()[0],a=Math.max(0,l-1)):(l=o.getSelectedLast()[0],a=l-1)),i(a,s)},preventDefault:!1},{keys:[["ArrowDown"]],callback:s=>{const o=this.htEditor;let a,l;if(!o.getSelectedLast()&&!o.flipped)a=0;else if(o.getSelectedLast()){if(o.flipped)a=o.getSelectedLast()[0]+1;else if(!o.flipped){const u=o.countRows()-1;l=o.getSelectedLast()[0],a=Math.min(u,l+1)}}return i(a,s)},preventDefault:!1}],n)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(WA)}}function gJ(t,e,r){mJ(t,e),e.set(t,r)}function mJ(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fm(t,e,r){return(e=pJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function pJ(t){var e=wJ(t,"string");return typeof e=="symbol"?e:e+""}function wJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function UA(t,e){return t.get(vJ(t,e))}function vJ(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const CJ="autocomplete";var sS=new WeakMap;class oE extends sE{constructor(){super(...arguments),Fm(this,"query",null),Fm(this,"strippedChoices",[]),Fm(this,"rawChoices",[]),gJ(this,sS,this.hot.guid.slice(0,9)),Fm(this,"sortByRelevance",function(e,r,n){const i=[],s=[],o=e.length;let a=r.length,l,u,c,h;if(o===0){for(c=0;c<a;c++)s.push(c);return s}for(c=0;c<a;c++){if(u=i1(yr(r[c])),n)h=u.indexOf(e);else{const d=this.cellProperties.locale;h=u.toLocaleLowerCase(d).indexOf(e.toLocaleLowerCase(d))}h!==-1&&(l=u.length-h-o,i.push({baseIndex:c,index:h,charsLeft:l,value:u}))}for(i.sort((d,f)=>{if(f.index===-1)return-1;if(d.index===-1)return 1;if(d.index<f.index)return-1;if(f.index<d.index)return 1;if(d.index===f.index){if(d.charsLeft<f.charsLeft)return-1;if(d.charsLeft>f.charsLeft)return 1}return 0}),c=0,a=i.length;c<a;c++)s.push(i[c].baseIndex);return s})}static get EDITOR_TYPE(){return CJ}getValue(){const e=this.rawChoices.find(r=>this.stripValueIfNeeded(r)===this.TEXTAREA.value);return ke(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),ve(this.htContainer,"autocompleteEditor"),ve(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&qe(this.TEXTAREA,[dz(),az(),CN("listbox"),pz()])}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.hot.getSettings().ariaTags&&qe(this.TEXTAREA,[Yi("false"),wz(`${UA(sS,this)}-listbox-${e}-${r}`)])}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,r=this.hot.getSettings().ariaTags,n=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,i=n==null?void 0:n.length,{row:s,col:o}=this;this.showEditableElement(),this.focus();let a=qr();a===0&&Lf()&&(a+=15),this.addHook("beforeKeyDown",l=>this.onBeforeKeyDown(l)),this.htEditor.updateSettings({colWidths:e?[tr(this.TEXTAREA)-2]:void 0,width:e?tr(this.TEXTAREA)+a:void 0,autoColumnSize:!0,renderer:(l,u,c,h,d,f,m)=>{ya(l,u,c,h,d,f,m);const{filteringCaseSensitive:g,allowHtml:w,locale:S}=this.cellProperties,b=this.query;let y=yr(f),_,P;y&&!w&&(_=g===!0?y.indexOf(b):y.toLocaleLowerCase(S).indexOf(b.toLocaleLowerCase(S)),_!==-1&&(P=y.substr(_,b.length),y=y.replace(P,`<strong>${P}</strong>`))),r&&qe(u,[lz(),...n?[yz(i)]:[],...n?[bz(n.indexOf(f)+1)]:[],["id",`${this.htEditor.rootElement.id}_${c}-${h}`]]),u.innerHTML=y},afterSelectionEnd:(l,u)=>{if(r){const c=this.htEditor.getCell(l,u,!0);qe(c,[Yb()]),qe(this.TEXTAREA,...vz(c.id))}}}),r&&(qe(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...go()),qe(this.htEditor.rootElement,[vN(),Cz("polite"),Sz("text"),["id",`${UA(sS,this)}-listbox-${s}-${o}`]]),qe(this.TEXTAREA,...Yi("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&qe(this.TEXTAREA,[Yi("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const r=this.cellProperties.source;this.query=e,typeof r=="function"?r.call(this.cellProperties,e,n=>{this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))}):Array.isArray(r)?(this.rawChoices=r,this.updateChoicesList(this.stripValuesIfNeeded(r))):this.updateChoicesList([])}updateChoicesList(e){const r=Zb(this.TEXTAREA),n=PN(this.TEXTAREA),i=this.cellProperties.sortByRelevance,s=this.cellProperties.filter;let o=null,a=null,l=e;i&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));const u=Array.isArray(o)?o.length:0;if(s===!1)u&&(a=o[0]);else{const c=[];for(let h=0,d=l.length;h<d&&!(i&&u<=h);h++)u?c.push(l[o[h]]):c.push(l[h]);a=0,l=c}this.strippedChoices=l,l.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(Qd([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(a)),this.hot.listen(),vg(this.TEXTAREA,r,r===n?void 0:n)}flipDropdownIfNeeded(){const e=Ou(this.hot.view._wt.wtTable.TABLE),r=e===this.hot.rootWindow,n=this.cellProperties.preventOverflow;if(r||!r&&(n||n==="horizontal"))return!1;const i=Kr(this.TEXTAREA),s=Ar(this.TEXTAREA),o=this.getDropdownHeight(),a=e.scrollTop,l=Ar(this.hot.view._wt.wtTable.THEAD),u=Kr(e),c=i.top-u.top-l+a,h=e.scrollHeight-c-l-s,d=o>h&&c>h;return d?this.flipDropdown(o):this.unflipDropdown(),this.limitDropdownIfNeeded(d?c:h,o),d}limitDropdownIfNeeded(e,r){if(r>e){let n=0,i=0,s=0,o=null;do s=this.htEditor.getRowHeight(i)||this.htEditor.view._wt.getSetting("defaultRowHeight"),n+=s,i+=1;while(n<e);o=n-s,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+r-o}px`),this.setDropdownHeight(n-s)}}flipDropdown(e){const r=this.htEditor.rootElement.style;r.position="absolute",r.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){const e=this.htEditor.getColWidth(0)+qr(this.hot.rootDocument)+2,r=this.cellProperties.trimDropdown;this.htEditor.updateSettings({height:this.getDropdownHeight(),width:r?void 0:e}),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e})}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getDropdownHeight(){const e=this.htEditor.getRowHeight(0)||23,r=this.cellProperties.visibleRows;return this.strippedChoices.length>=r?r*e:this.strippedChoices.length*e+8}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:r}=this.cellProperties,n=St(e,s=>yr(s));return St(n,s=>r?s:i1(s))}allowKeyEventPropagation(e){const r=this.htEditor.getSelectedRangeLast(),n={row:r?r.from.row:-1};let i=!1;return e===We.ARROW_DOWN&&n.row>0&&n.row<this.htEditor.countRows()-1&&(i=!0),e===We.ARROW_UP&&n.row>-1&&(i=!0),i}onBeforeKeyDown(e){if(ZN(e.keyCode)||e.keyCode===We.BACKSPACE||e.keyCode===We.DELETE||e.keyCode===We.INSERT){let r=10;if(e.keyCode===We.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(r+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},r)}}}const SJ="checkbox";class dH extends Oh{static get EDITOR_TYPE(){return SJ}beginEditing(e,r){if(r&&r.type==="mouseup"&&r.target.nodeName==="TD"){const n=this.TD.querySelector('input[type="checkbox"]');Qe(n,"htBadValue")||n.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright Â© 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const tl=()=>window,Bi=()=>window.document,T1=(t,e)=>window.setTimeout(t,e),Qs=function(t,e,r,n){t.addEventListener(e,r,!!n)},Fo=function(t,e,r,n){t.removeEventListener(e,r,!!n)},yJ=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},hi=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},oS=function(t,e){hi(t,e)||(t.className=t.className===""?e:t.className+" "+e)},aS=function(t,e){t.className=yJ((" "+t.className+" ").replace(" "+e+" "," "))},aE=function(t){return/Array/.test(Object.prototype.toString.call(t))},mi=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},bJ=function(t){let e=t.getDay();return e===0||e===6},xJ=function(t){return t%4===0&&t%100!==0||t%400===0},jA=function(t,e){return[31,xJ(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},Lm=function(t){mi(t)&&t.setHours(0,0,0,0)},$m=function(t,e){return t.getTime()===e.getTime()},W0=function(t,e,r){let n,i;for(n in e)i=t[n]!==void 0,i&&typeof e[n]=="object"&&e[n]!==null&&e[n].nodeName===void 0?mi(e[n])?r&&(t[n]=new Date(e[n].getTime())):aE(e[n])?r&&(t[n]=e[n].slice(0)):t[n]=W0({},e[n],r):(r||!i)&&(t[n]=e[n]);return t},zA=function(t,e,r){let n=Bi().createEvent("HTMLEvents");n.initEvent(e,!0,!1),n=W0(n,r),t.dispatchEvent(n)},YA=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Vs={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},GA=function(t,e,r){for(e+=t.firstDay;e>=7;)e-=7;return r?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},RJ=function(t){let e=[],r="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),r="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+r+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},EJ=function(t,e){t.setHours(0,0,0,0);let r=t.getDate(),n=t.getDay(),i=e,s=i-1,o=7,a=function(d){return(d+o-1)%o};t.setDate(r+s-a(n));let l=new Date(t.getFullYear(),0,i),u=24*60*60*1e3,c=(t.getTime()-l.getTime())/u;return 1+Math.round((c-s+a(l.getDay()))/o)},TJ=function(t,e,r,n,i){let s=new Date(n,r,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(s).isoWeek():EJ(s,i))+"</td>"},_J=function(t,e,r,n){return'<tr class="pika-row'+(r?" pick-whole-week":"")+(n?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},AJ=function(t){return"<tbody>"+t.join("")+"</tbody>"},MJ=function(t){let e,r=[];for(t.showWeekNumber&&r.push("<th></th>"),e=0;e<7;e++)r.push('<th scope="col"><abbr title="'+GA(t,e)+'">'+GA(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?r.reverse():r).join("")+"</tr></thead>"},OJ=function(t,e,r,n,i,s){let o,a,l,u=t._o,c=r===u.minYear,h=r===u.maxYear,d='<div id="'+s+'" class="pika-title" role="heading" aria-live="polite">',f,m,g=!0,w=!0;for(l=[],o=0;o<12;o++)l.push('<option value="'+(r===i?o-e:12+o-e)+'"'+(o===n?' selected="selected"':"")+(c&&o<u.minMonth||h&&o>u.maxMonth?' disabled="disabled"':"")+">"+u.i18n.months[o]+"</option>");for(f='<div class="pika-label">'+u.i18n.months[n]+'<select class="pika-select pika-select-month" tabindex="-1">'+l.join("")+"</select></div>",aE(u.yearRange)?(o=u.yearRange[0],a=u.yearRange[1]+1):(o=r-u.yearRange,a=1+r+u.yearRange),l=[];o<a&&o<=u.maxYear;o++)o>=u.minYear&&l.push('<option value="'+o+'"'+(o===r?' selected="selected"':"")+">"+o+"</option>");return m='<div class="pika-label">'+r+u.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+l.join("")+"</select></div>",u.showMonthAfterYear?d+=m+f:d+=f+m,c&&(n===0||u.minMonth>=n)&&(g=!1),h&&(n===11||u.maxMonth<=n)&&(w=!1),e===0&&(d+='<button class="pika-prev'+(g?"":" is-disabled")+'" type="button">'+u.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(w?"":" is-disabled")+'" type="button">'+u.i18n.nextMonth+"</button>"),d+="</div>"},IJ=function(t,e,r){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+r+'">'+MJ(t)+AJ(e)+"</table>"};function _1(t){let e=this,r=e.config(t);e._onMouseDown=function(i){if(!e._v)return;i=i||tl().event;let s=i.target||i.srcElement;if(s)if(hi(s,"is-disabled")||(hi(s,"pika-button")&&!hi(s,"is-empty")&&!hi(s.parentNode,"is-disabled")?(e.setDate(new Date(s.getAttribute("data-pika-year"),s.getAttribute("data-pika-month"),s.getAttribute("data-pika-day"))),r.bound&&T1(function(){e.hide(),r.blurFieldOnSelect&&r.field&&r.field.blur()},100)):hi(s,"pika-prev")?e.prevMonth():hi(s,"pika-next")&&e.nextMonth()),hi(s,"pika-select"))e._c=!0;else if(i.preventDefault)i.preventDefault();else return i.returnValue=!1,!1},e._onChange=function(i){i=i||tl().event;let s=i.target||i.srcElement;s&&(hi(s,"pika-select-month")?e.gotoMonth(s.value):hi(s,"pika-select-year")&&e.gotoYear(s.value))},e._onKeyChange=function(i){if(i=i||tl().event,e.isVisible())switch(i.keyCode){case 13:case 27:r.field&&r.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(r.parse)return r.parse(r.field.value,r.format);if(this.hasMoment){let i=this.moment(r.field.value,r.format,r.formatStrict);return i&&i.isValid()?i.toDate():null}else return new Date(Date.parse(r.field.value))},e._onInputChange=function(i){let s;i.firedBy!==e&&(s=e._parseFieldValue(),mi(s)&&e.setDate(s),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let i=Bi().activeElement;do if(hi(i,"pika-single"))return;while(i=i.parentNode);e._c||(e._b=T1(function(){e.hide()},50)),e._c=!1},e._onClick=function(i){i=i||tl().event;let s=i.target||i.srcElement,o=s;if(s){!hasEventListeners&&hi(s,"pika-select")&&(s.onchange||(s.setAttribute("onchange","return;"),Qs(s,"change",e._onChange)));do if(hi(o,"pika-single")||o===r.trigger)return;while(o=o.parentNode);e._v&&s!==r.trigger&&o!==r.trigger&&e.hide()}},e.el=Bi().createElement("div"),e.el.className="pika-single"+(r.isRTL?" is-rtl":"")+(r.theme?" "+r.theme:""),Qs(e.el,"mousedown",e._onMouseDown,!0),Qs(e.el,"touchend",e._onMouseDown,!0),Qs(e.el,"change",e._onChange),r.keyboardInput&&Qs(Bi(),"keydown",e._onKeyChange),r.field&&(r.container?r.container.appendChild(e.el):r.bound?Bi().body.appendChild(e.el):r.field.parentNode.insertBefore(e.el,r.field.nextSibling),Qs(r.field,"change",e._onInputChange),r.defaultDate||(r.defaultDate=e._parseFieldValue(),r.setDefaultDate=!0));let n=r.defaultDate;mi(n)?r.setDefaultDate?e.setDate(n,!0):e.gotoDate(n):e.gotoDate(new Date),r.bound?(this.hide(),e.el.className+=" is-bound",Qs(r.trigger,"click",e._onInputClick),Qs(r.trigger,"focus",e._onInputFocus),Qs(r.trigger,"blur",e._onInputBlur)):this.show()}_1.prototype={config:function(t){this._o||(this._o=W0({},Vs,!0));let e=W0(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let r=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=r>4?4:r,mi(e.minDate)||(e.minDate=!1),mi(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),aE(e.yearRange)){let n=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||n,e.yearRange[1]=parseInt(e.yearRange[1],10)||n}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Vs.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,mi(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return mi(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",zA(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!mi(t))return;let r=this._o.minDate,n=this._o.maxDate;mi(r)&&t<r?t=r:mi(n)&&t>n&&(t=n),this._d=new Date(t.getTime()),Lm(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),zA(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(mi(t)){if(this.calendars){let r=new Date(this.calendars[0].year,this.calendars[0].month,1),n=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),i=t.getTime();n.setMonth(n.getMonth()+1),n.setDate(n.getDate()-1),e=i<r.getTime()||n.getTime()<i}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let r=this.getDate()||new Date,n=parseInt(e)*24*60*60*1e3,i;t==="add"?i=new Date(r.valueOf()+n):t==="subtract"&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=YA(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=YA({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(Lm(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Vs.minDate,this._o.minYear=Vs.minYear,this._o.minMonth=Vs.minMonth,this._o.startRange=Vs.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(Lm(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Vs.maxDate,this._o.maxYear=Vs.maxYear,this._o.maxMonth=Vs.maxMonth,this._o.endRange=Vs.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,r=e.minYear,n=e.maxYear,i=e.minMonth,s=e.maxMonth,o="",a;this._y<=r&&(this._y=r,!isNaN(i)&&this._m<i&&(this._m=i)),this._y>=n&&(this._y=n,!isNaN(s)&&this._m>s&&(this._m=s));for(let l=0;l<e.numberOfMonths;l++)a="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),o+='<div class="pika-lendar">'+OJ(this,l,this.calendars[l].year,this.calendars[l].month,this.calendars[0].year,a)+this.render(this.calendars[l].year,this.calendars[l].month,a)+"</div>";this.el.innerHTML=o,e.bound&&e.field.type!=="hidden"&&T1(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,r,n,i,s,o,a,l,u,c;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,r=this.el.offsetHeight,n=tl().innerWidth||Bi().documentElement.clientWidth,i=tl().innerHeight||Bi().documentElement.clientHeight,s=Bi().body.scrollTop||Bi().documentElement.scrollTop,u=!0,c=!0,l=t.getBoundingClientRect(),o=l.left+tl().pageXOffset,a=l.bottom+tl().pageYOffset,(this._o.reposition&&o+e>n||this._o.position.indexOf("right")>-1&&o-e+t.offsetWidth>0)&&(o=o-e+t.offsetWidth,u=!1),(this._o.reposition&&a+r>i+s||this._o.position.indexOf("top")>-1&&a-r-t.offsetHeight>0)&&(a=a-r-t.offsetHeight,c=!1),o<0&&(o=0),a<0&&(a=0),this.el.style.left=o+"px",this.el.style.top=a+"px",oS(this.el,u?"left-aligned":"right-aligned"),oS(this.el,c?"bottom-aligned":"top-aligned"),aS(this.el,u?"right-aligned":"left-aligned"),aS(this.el,c?"top-aligned":"bottom-aligned"))},render:function(t,e,r){let n=this._o,i=new Date,s=jA(t,e),o=new Date(t,e,1).getDay(),a=[],l=[];Lm(i),n.firstDay>0&&(o-=n.firstDay,o<0&&(o+=7));let u=e===0?11:e-1,c=e===11?0:e+1,h=e===0?t-1:t,d=e===11?t+1:t,f=jA(h,u),m=s+o,g=m;for(;g>7;)g-=7;m+=7-g;let w=!1;for(let S=0,b=0;S<m;S++){let y=new Date(t,e,1+(S-o)),_=mi(this._d)?$m(y,this._d):!1,P=$m(y,i),z=n.events.indexOf(y.toDateString())!==-1,I=S<o||S>=s+o,W=1+(S-o),L=e,U=t,G=n.startRange&&$m(n.startRange,y),X=n.endRange&&$m(n.endRange,y),le=n.startRange&&n.endRange&&n.startRange<y&&y<n.endRange,xe=n.minDate&&y<n.minDate||n.maxDate&&y>n.maxDate||n.disableWeekends&&bJ(y)||n.disableDayFn&&n.disableDayFn(y);I&&(S<o?(W=f+W,L=u,U=h):(W=W-s,L=c,U=d));let be={day:W,month:L,year:U,hasEvent:z,isSelected:_,isToday:P,isDisabled:xe,isEmpty:I,isStartRange:G,isEndRange:X,isInRange:le,showDaysInNextAndPreviousMonths:n.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:n.enableSelectionDaysInNextAndPreviousMonths};n.pickWholeWeek&&_&&(w=!0),l.push(RJ(be)),++b===7&&(n.showWeekNumber&&l.unshift(TJ(this,S-o,e,t,n.firstWeekOfYearMinDays)),a.push(_J(l,n.isRTL,n.pickWholeWeek,w)),l=[],b=0,w=!1)}return IJ(n,a,r)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),aS(this.el,"is-hidden"),this._o.bound&&(Qs(Bi(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Fo(Bi(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),oS(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Fo(this.el,"mousedown",this._onMouseDown,!0),Fo(this.el,"touchend",this._onMouseDown,!0),Fo(this.el,"change",this._onChange),t.keyboardInput&&Fo(Bi(),"keydown",this._onKeyChange),t.field&&(Fo(t.field,"change",this._onInputChange),t.bound&&(Fo(t.trigger,"click",this._onInputClick),Fo(t.trigger,"focus",this._onInputFocus),Fo(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function lS(t,e,r){return(e=PJ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function PJ(t){var e=NJ(t,"string");return typeof e=="symbol"?e:e+""}function NJ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fH="date",KA="dateEditor";class gH extends Zu{constructor(){super(...arguments),lS(this,"defaultDateFormat","DD/MM/YYYY"),lS(this,"parentDestroyed",!1),lS(this,"$datePicker",null)}static get EDITOR_TYPE(){return fH}init(){if(typeof Ce!="function")throw new Error("You need to include moment.js to your project.");if(typeof _1!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),ve(this.datePicker,"htDatepickerHolder"),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Qe(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),n.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:KA})}close(){var e;this._opened=!1,(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const i=this.hot._getEditorManager();i.closeEditor(),this.hot.view.render(),i.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(KA),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,r)}showDatepicker(e){const r=this.cellProperties.dateFormat||this.defaultDateFormat,n=this.hot.view.isMouseDown(),i=e?ax(e.keyCode):!1;let s;this.datePicker.style.display="block",this.$datePicker=new _1(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Ce),this.$datePicker._onInputFocus=function(){},this.originalValue?(s=this.originalValue,Ce(s,r,!0).isValid()&&this.$datePicker.setMoment(Ce(s,r),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!i&&!n&&this.setValue("")):this.cellProperties.defaultDate?(s=this.cellProperties.defaultDate,Ce(s,r,!0).isValid()&&this.$datePicker.setMoment(Ce(s,r),!0),!i&&!n&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){const e=this.TEXTAREA,r={};this.cellProperties&&this.cellProperties.datePickerConfig&&yg(r,this.cellProperties.datePickerConfig);const n=r.onSelect,i=r.onClose;return r.field=e,r.trigger=e,r.container=this.datePicker,r.bound=!1,r.keyboardInput=!1,r.format=r.format||this.defaultDateFormat,r.reposition=r.reposition||!1,r.isRTL=!1,r.onSelect=s=>{let o=s;isNaN(o.getTime())||(o=Ce(o).format(this.cellProperties.dateFormat||this.defaultDateFormat)),this.setValue(o),n&&n()},r.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),i&&i()},r}refreshDimensions(e){var r;if(super.refreshDimensions(e),this.state!==Er.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{wtOverlays:s}=this.hot.view._wt,{wtTable:o}=(r=s.getParentOverlay(this.TD))!==null&&r!==void 0?r:this.hot.view._wt,a=n.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=n.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),u=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),c=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=a&&this.row<=l&&this.col>=u&&this.col<=c){const h=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+h.top+Ar(this.TD)}px`;let d=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?d+=h.right-tr(this.datePicker):d+=h.left,this.datePickerStyle.left=`${d}px`}else this.hideDatepicker()}}const DJ="dropdown";class lE extends oE{static get EDITOR_TYPE(){return DJ}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.cellProperties.filter=!1,this.cellProperties.strict=!0}}He.getSingleton().add("beforeValidate",function(t,e,r){const n=this.propToCol(r);if(Number.isInteger(n)){const i=this.getCellMeta(e,n);i.editor===lE&&i.strict===void 0&&(i.filter=!1,i.strict=!0)}});const HJ="numeric";class mH extends Zu{static get EDITOR_TYPE(){return HJ}}const kJ="password";class pH extends Zu{static get EDITOR_TYPE(){return kJ}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,As(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const uS="ht_editor_visible",XA="selectEditor",FJ="select";class wH extends Oh{static get EDITOR_TYPE(){return FJ}init(){this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.select.style.display="none",ve(this.select,"htSelectEditor"),this.hot.rootElement.appendChild(this.select),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.select.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.select.style.display="none",Qe(this.select,uS)&&tt(this.select,uS),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o);const a=this.cellProperties.selectOptions;let l;typeof a=="function"?l=this.prepareOptions(a(this.row,this.col,this.prop)):l=this.prepareOptions(a),As(this.select),ct(l,(u,c)=>{const h=this.hot.rootDocument.createElement("OPTION");h.value=c,Xu(h,u),this.select.appendChild(h)})}prepareOptions(e){let r={};if(Array.isArray(e))for(let n=0,i=e.length;n<i;n++)r[e[n]]=e[n];else typeof e=="object"&&(r=e);return r}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Er.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:r,width:n,height:i}=this.getEditedCellRect(),s=this.select.style;s.height=`${i}px`,s.width=`${n}px`,s.top=`${e}px`,s[this.hot.isRtl()?"right":"left"]=`${r}px`,s.margin="0px",ve(this.select,uS)}registerShortcuts(){const r=this.hot.getShortcutManager().getContext("editor"),n={group:XA};this.isInFullEditMode()&&r.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const i=this.select.selectedIndex-1;i>=0&&(this.select[i].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const i=this.select.selectedIndex+1;i<=this.select.length-1&&(this.select[i].selected=!0)}}],n)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(XA)}}const LJ="time";class vH extends Zu{static get EDITOR_TYPE(){return LJ}prepare(e,r,n,i,s,o){super.prepare(e,r,n,i,s,o),this.TEXTAREA.dir="ltr"}}function $J(){Jn(Oh),Jn(oE),Jn(dH),Jn(gH),Jn(lE),Jn(sE),Jn(mH),Jn(pH),Jn(wH),Jn(Zu),Jn(vH)}const BJ="html";function uE(t,e,r,n,i,s,o){_g.apply(this,[t,e,r,n,i,s,o]),Xu(e,s??"",!1)}uE.RENDERER_TYPE=BJ;const VJ="autocomplete";function Ih(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=o.allowHtml?uE:ya,u=a.createElement("DIV"),c=t.getSettings().ariaTags;if(u.className="htAutocompleteArrow",c&&u.setAttribute(...Gu()),u.appendChild(a.createTextNode("â¼")),l.apply(this,[t,e,r,n,i,s,o]),e.firstChild||e.appendChild(a.createTextNode("Â ")),e.insertBefore(u,e.firstChild),ve(e,"htAutocomplete"),!t.acArrowListener){const h=new Xi(t);t.acArrowListener=function(d){Qe(d.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(r,n),e)},h.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{h.destroy()})}}Ih.RENDERER_TYPE=VJ;const WJ="dropdown";function cE(t,e,r,n,i,s,o){Ih.apply(this,[t,e,r,n,i,s,o])}cE.RENDERER_TYPE=WJ;const qA=new WeakMap,ZA=new WeakMap,UJ="htBadValue",vh="data-row",Ch="data-col",jJ="checkboxRenderer",CH="checkbox";He.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,r){const{label:n,type:i,row:s,column:o,prop:a}=e;if(i===CH){if(n){const{value:l,property:u}=n;let c=r;if(l)c=typeof l=="function"?l(s,o,a,r):l;else if(u){const h=this.getDataAtRowProp(s,u);c=h!==null?h:r}t=c}return t}});function hE(t,e,r,n,i,s,o){const{rootDocument:a}=t,l=t.getSettings().ariaTags;_g.apply(this,[t,e,r,n,i,s,o]),zJ(t);let u=YJ(a);const c=o.label;let h=!1;if(typeof o.checkedTemplate>"u"&&(o.checkedTemplate=!0),typeof o.uncheckedTemplate>"u"&&(o.uncheckedTemplate=!1),As(e),s===o.checkedTemplate||yr(s).toLocaleLowerCase(o.locale)===yr(o.checkedTemplate).toLocaleLowerCase(o.locale)?u.checked=!0:s===o.uncheckedTemplate||yr(s).toLocaleLowerCase(o.locale)===yr(o.uncheckedTemplate).toLocaleLowerCase(o.locale)?u.checked=!1:br(s)?ve(u,"noValue"):(u.style.display="none",ve(u,UJ),h=!0),qe(u,[[vh,r],[Ch,n]]),l&&qe(u,[T0(u.checked?t.getTranslatedPhrase(eE):t.getTranslatedPhrase(tE)),bN(u.checked),uz()]),!h&&c){let g="";if(c.value)g=typeof c.value=="function"?c.value.call(this,r,n,i,s):c.value;else if(c.property){const S=t.getDataAtRowProp(r,c.property);g=S!==null?S:""}const w=GJ(a,g,c.separated!==!0);c.position==="before"?c.separated?(e.appendChild(w),e.appendChild(u)):(w.appendChild(u),u=w):(!c.position||c.position==="after")&&(c.separated?(e.appendChild(u),e.appendChild(w)):(w.insertBefore(u,w.firstChild),u=w))}(!c||c&&!c.separated)&&e.appendChild(u),h&&e.appendChild(a.createTextNode("#bad-value#")),qA.has(t)||(qA.set(t,!0),d());function d(){const w=t.getShortcutManager().getContext("grid"),S={group:jJ,relativeToGroup:Rl,position:"before"};w.addShortcuts([{keys:[["space"]],callback:()=>(f(),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight.isCell()}},{keys:[["enter"]],callback:()=>(f(),!m()),runOnlyIf:()=>{const b=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(b==null?void 0:b.isSingle())&&b.highlight.isCell()}},{keys:[["delete"],["backspace"]],callback:()=>(f(!0),!m()),runOnlyIf:()=>{var b;return(b=t.getSelectedRangeLast())===null||b===void 0?void 0:b.highlight.isCell()}}],S)}function f(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const w=t.getSelectedRange(),S=[],b=new Map;let y=[],_=0;if(w){for(let P=0;P<w.length;P++){const{row:z,col:I}=w[P].getTopStartCorner(),{row:W,col:L}=w[P].getBottomEndCorner();for(let U=z;U<=W;U+=1)for(let G=I;G<=L;G+=1){const X=t.getCellMeta(U,G),le={checkedTemplate:X.checkedTemplate,uncheckedTemplate:X.uncheckedTemplate};if(X.type!=="checkbox"){g===!0&&!X.readOnly&&(b.has(S.length)?b.set(S.length,[...b.get(S.length),[U,G,null]]):b.set(S.length,[[U,G,null]]));continue}if(X.readOnly===!0)continue;typeof X.checkedTemplate>"u"&&(X.checkedTemplate=!0),typeof X.uncheckedTemplate>"u"&&(X.uncheckedTemplate=!1);const xe=t.getDataAtCell(U,G);g===!1?[X.checkedTemplate,X.checkedTemplate.toString()].includes(xe)?y.push([U,G,X.uncheckedTemplate,le]):[X.uncheckedTemplate,X.uncheckedTemplate.toString(),null,void 0].includes(xe)&&y.push([U,G,X.checkedTemplate,le]):y.push([U,G,X.uncheckedTemplate,le]),_+=1}S.push(_),_=0}y.every(P=>{let[,,z]=P;return z===y[0][2]})?y=y.map(P=>{let[z,I,W]=P;return[z,I,W]}):y=y.map(P=>{let[z,I,,W]=P;return[z,I,W.checkedTemplate]}),y.length>0&&S.forEach((P,z)=>{let I=y.splice(0,P);b.size&&b.has(z)&&(I=[...I,...b.get(z)]),t.setDataAtCell(I)})}}function m(){const g=t.getSelectedRange();if(g){for(let w=0;w<g.length;w++){const S=g[w].getTopStartCorner(),b=g[w].getBottomEndCorner();for(let y=S.row;y<=b.row;y++)for(let _=S.col;_<=b.col;_++){const P=t.getCellMeta(y,_),z=t.getCell(y,_);if(z==null)return!0;if(z.querySelectorAll("input[type=checkbox]").length>0&&!P.readOnly)return!0}}return!1}}}hE.RENDERER_TYPE=CH;function zJ(t){let e=ZA.get(t);if(!e){const{rootElement:r}=t;e=new Xi(t),e.addEventListener(r,"click",n=>XJ(n,t)),e.addEventListener(r,"mouseup",n=>KJ(n,t)),e.addEventListener(r,"change",n=>qJ(n,t)),ZA.set(t,e)}return e}function YJ(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function GJ(t,e,r){const n=t.createElement("label");return n.className=`htCheckboxRendererLabel ${r?"fullWidth":""}`,n.appendChild(t.createTextNode(e)),n.cloneNode(!0)}function KJ(t,e){const{target:r}=t;dE(r)&&(!r.hasAttribute(vh)||!r.hasAttribute(Ch)||setTimeout(e.listen,10))}function XJ(t,e){const{target:r}=t;if(!dE(r)||!r.hasAttribute(vh)||!r.hasAttribute(Ch))return;const n=parseInt(r.getAttribute(vh),10),i=parseInt(r.getAttribute(Ch),10);e.getCellMeta(n,i).readOnly&&t.preventDefault()}function qJ(t,e){const{target:r}=t;if(!dE(r)||!r.hasAttribute(vh)||!r.hasAttribute(Ch))return;const n=parseInt(r.getAttribute(vh),10),i=parseInt(r.getAttribute(Ch),10),s=e.getCellMeta(n,i);if(!s.readOnly){let o=null;t.target.checked?o=s.uncheckedTemplate===void 0?!0:s.checkedTemplate:o=s.uncheckedTemplate===void 0?!1:s.uncheckedTemplate,e.setDataAtCell(n,i,o)}}function dE(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const ZJ="handsontable";function fE(t,e,r,n,i,s,o){Ih.apply(this,[t,e,r,n,i,s,o])}fE.RENDERER_TYPE=ZJ;function Bm(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var SH={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(n,i,s){function o(u,c){if(!i[u]){if(!n[u]){var h=typeof Bm=="function"&&Bm;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var d=new Error("Cannot find module '"+u+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[u]={exports:{}};n[u][0].call(f.exports,function(m){return o(n[u][1][m]||m)},f,f.exports,r,n,i,s)}return i[u].exports}for(var a=typeof Bm=="function"&&Bm,l=0;l<s.length;l++)o(s[l]);return o}({1:[function(r,n,i){(function(s){var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,l=Math.ceil,u=Math.floor,c="[BigNumber Error] ",h=c+"Number primitive has more than 15 significant digits: ",d=1e14,f=14,m=9007199254740991,g=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],w=1e7,S=1e9;function b(L){var U=0|L;return 0<L||L===U?U:U-1}function y(L){for(var U,G,X=1,le=L.length,xe=L[0]+"";X<le;){for(U=L[X++]+"",G=f-U.length;G--;U="0"+U);xe+=U}for(le=xe.length;xe.charCodeAt(--le)===48;);return xe.slice(0,le+1||1)}function _(L,U){var G,X,le=L.c,xe=U.c,be=L.s,Ze=U.s,Le=L.e,Ne=U.e;if(!be||!Ze)return null;if(G=le&&!le[0],X=xe&&!xe[0],G||X)return G?X?0:-Ze:be;if(be!=Ze)return be;if(G=be<0,X=Le==Ne,!le||!xe)return X?0:!le^G?1:-1;if(!X)return Ne<Le^G?1:-1;for(Ze=(Le=le.length)<(Ne=xe.length)?Le:Ne,be=0;be<Ze;be++)if(le[be]!=xe[be])return le[be]>xe[be]^G?1:-1;return Le==Ne?0:Ne<Le^G?1:-1}function P(L,U,G,X){if(L<U||G<L||L!==(L<0?l(L):u(L)))throw Error(c+(X||"Argument")+(typeof L=="number"?L<U||G<L?" out of range: ":" not an integer: ":" not a primitive number: ")+String(L))}function z(L){var U=L.c.length-1;return b(L.e/f)==U&&L.c[U]%2!=0}function I(L,U){return(1<L.length?L.charAt(0)+"."+L.slice(1):L)+(U<0?"e":"e+")+U}function W(L,U,G){var X,le;if(U<0){for(le=G+".";++U;le+=G);L=le+L}else if(++U>(X=L.length)){for(le=G,U-=X;--U;le+=G);L+=le}else U<X&&(L=L.slice(0,U)+"."+L.slice(U));return L}(o=function L(U){var G,X,le,xe,be,Ze,Le,Ne,Me,at,v=ee.prototype={constructor:ee,toString:null,valueOf:null},p=new ee(1),C=20,x=4,R=-7,F=21,q=-1e7,re=1e7,fe=!1,de=1,pe=0,Oe={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},Be="0123456789abcdefghijklmnopqrstuvwxyz";function ee(T,M){var B,Q,j,te,K,Y,Z,J,ue=this;if(!(ue instanceof ee))return new ee(T,M);if(M==null){if(T instanceof ee)return ue.s=T.s,ue.e=T.e,void(ue.c=(T=T.c)?T.slice():T);if((Y=typeof T=="number")&&0*T==0){if(ue.s=1/T<0?(T=-T,-1):1,T===~~T){for(te=0,K=T;10<=K;K/=10,te++);return ue.e=te,void(ue.c=[T])}J=String(T)}else{if(J=String(T),!a.test(J))return le(ue,J,Y);ue.s=J.charCodeAt(0)==45?(J=J.slice(1),-1):1}-1<(te=J.indexOf("."))&&(J=J.replace(".","")),0<(K=J.search(/e/i))?(te<0&&(te=K),te+=+J.slice(K+1),J=J.substring(0,K)):te<0&&(te=J.length)}else{if(P(M,2,Be.length,"Base"),J=String(T),M==10)return Xe(ue=new ee(T instanceof ee?T:J),C+ue.e+1,x);if(Y=typeof T=="number"){if(0*T!=0)return le(ue,J,Y,M);if(ue.s=1/T<0?(J=J.slice(1),-1):1,ee.DEBUG&&15<J.replace(/^0\.0*|\./,"").length)throw Error(h+T);Y=!1}else ue.s=J.charCodeAt(0)===45?(J=J.slice(1),-1):1;for(B=Be.slice(0,M),te=K=0,Z=J.length;K<Z;K++)if(B.indexOf(Q=J.charAt(K))<0){if(Q=="."){if(te<K){te=Z;continue}}else if(!j&&(J==J.toUpperCase()&&(J=J.toLowerCase())||J==J.toLowerCase()&&(J=J.toUpperCase()))){j=!0,K=-1,te=0;continue}return le(ue,String(T),Y,M)}-1<(te=(J=X(J,M,10,ue.s)).indexOf("."))?J=J.replace(".",""):te=J.length}for(K=0;J.charCodeAt(K)===48;K++);for(Z=J.length;J.charCodeAt(--Z)===48;);if(J=J.slice(K,++Z)){if(Z-=K,Y&&ee.DEBUG&&15<Z&&(m<T||T!==u(T)))throw Error(h+ue.s*T);if(re<(te=te-K-1))ue.c=ue.e=null;else if(te<q)ue.c=[ue.e=0];else{if(ue.e=te,ue.c=[],K=(te+1)%f,te<0&&(K+=f),K<Z){for(K&&ue.c.push(+J.slice(0,K)),Z-=f;K<Z;)ue.c.push(+J.slice(K,K+=f));J=J.slice(K),K=f-J.length}else K-=Z;for(;K--;J+="0");ue.c.push(+J)}}else ue.c=[ue.e=0]}function et(T,M,B,Q){var j,te,K,Y,Z;if(B==null?B=x:P(B,0,8),!T.c)return T.toString();if(j=T.c[0],K=T.e,M==null)Z=y(T.c),Z=Q==1||Q==2&&(K<=R||F<=K)?I(Z,K):W(Z,K,"0");else if(te=(T=Xe(new ee(T),M,B)).e,Y=(Z=y(T.c)).length,Q==1||Q==2&&(M<=te||te<=R)){for(;Y<M;Z+="0",Y++);Z=I(Z,te)}else if(M-=K,Z=W(Z,te,"0"),Y<te+1){if(0<--M)for(Z+=".";M--;Z+="0");}else if(0<(M+=te-Y))for(te+1==Y&&(Z+=".");M--;Z+="0");return T.s<0&&j?"-"+Z:Z}function je(T,M){for(var B,Q=1,j=new ee(T[0]);Q<T.length;Q++){if(!(B=new ee(T[Q])).s){j=B;break}M.call(j,B)&&(j=B)}return j}function ye(T,M,B){for(var Q=1,j=M.length;!M[--j];M.pop());for(j=M[0];10<=j;j/=10,Q++);return(B=Q+B*f-1)>re?T.c=T.e=null:T.c=B<q?[T.e=0]:(T.e=B,M),T}function Xe(T,M,B,Q){var j,te,K,Y,Z,J,ue,Ee=T.c,De=g;if(Ee){e:{for(j=1,Y=Ee[0];10<=Y;Y/=10,j++);if((te=M-j)<0)te+=f,K=M,ue=(Z=Ee[J=0])/De[j-K-1]%10|0;else if((J=l((te+1)/f))>=Ee.length){if(!Q)break e;for(;Ee.length<=J;Ee.push(0));Z=ue=0,K=(te%=f)-f+(j=1)}else{for(Z=Y=Ee[J],j=1;10<=Y;Y/=10,j++);ue=(K=(te%=f)-f+j)<0?0:Z/De[j-K-1]%10|0}if(Q=Q||M<0||Ee[J+1]!=null||(K<0?Z:Z%De[j-K-1]),Q=B<4?(ue||Q)&&(B==0||B==(T.s<0?3:2)):5<ue||ue==5&&(B==4||Q||B==6&&(0<te?0<K?Z/De[j-K]:0:Ee[J-1])%10&1||B==(T.s<0?8:7)),M<1||!Ee[0])return Ee.length=0,Q?(M-=T.e+1,Ee[0]=De[(f-M%f)%f],T.e=-M||0):Ee[0]=T.e=0,T;if(te==0?(Ee.length=J,Y=1,J--):(Ee.length=J+1,Y=De[f-te],Ee[J]=0<K?u(Z/De[j-K]%De[K])*Y:0),Q)for(;;){if(J==0){for(te=1,K=Ee[0];10<=K;K/=10,te++);for(K=Ee[0]+=Y,Y=1;10<=K;K/=10,Y++);te!=Y&&(T.e++,Ee[0]==d&&(Ee[0]=1));break}if(Ee[J]+=Y,Ee[J]!=d)break;Ee[J--]=0,Y=1}for(te=Ee.length;Ee[--te]===0;Ee.pop());}T.e>re?T.c=T.e=null:T.e<q&&(T.c=[T.e=0])}return T}function Ve(T){var M,B=T.e;return B===null?T.toString():(M=y(T.c),M=B<=R||F<=B?I(M,B):W(M,B,"0"),T.s<0?"-"+M:M)}return ee.clone=L,ee.ROUND_UP=0,ee.ROUND_DOWN=1,ee.ROUND_CEIL=2,ee.ROUND_FLOOR=3,ee.ROUND_HALF_UP=4,ee.ROUND_HALF_DOWN=5,ee.ROUND_HALF_EVEN=6,ee.ROUND_HALF_CEIL=7,ee.ROUND_HALF_FLOOR=8,ee.EUCLID=9,ee.config=ee.set=function(T){var M,B;if(T!=null){if(typeof T!="object")throw Error(c+"Object expected: "+T);if(T.hasOwnProperty(M="DECIMAL_PLACES")&&(P(B=T[M],0,S,M),C=B),T.hasOwnProperty(M="ROUNDING_MODE")&&(P(B=T[M],0,8,M),x=B),T.hasOwnProperty(M="EXPONENTIAL_AT")&&((B=T[M])&&B.pop?(P(B[0],-S,0,M),P(B[1],0,S,M),R=B[0],F=B[1]):(P(B,-S,S,M),R=-(F=B<0?-B:B))),T.hasOwnProperty(M="RANGE"))if((B=T[M])&&B.pop)P(B[0],-S,-1,M),P(B[1],1,S,M),q=B[0],re=B[1];else{if(P(B,-S,S,M),!B)throw Error(c+M+" cannot be zero: "+B);q=-(re=B<0?-B:B)}if(T.hasOwnProperty(M="CRYPTO")){if((B=T[M])!==!!B)throw Error(c+M+" not true or false: "+B);if(B){if(typeof crypto>"u"||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw fe=!B,Error(c+"crypto unavailable");fe=B}else fe=B}if(T.hasOwnProperty(M="MODULO_MODE")&&(P(B=T[M],0,9,M),de=B),T.hasOwnProperty(M="POW_PRECISION")&&(P(B=T[M],0,S,M),pe=B),T.hasOwnProperty(M="FORMAT")){if(typeof(B=T[M])!="object")throw Error(c+M+" not an object: "+B);Oe=B}if(T.hasOwnProperty(M="ALPHABET")){if(typeof(B=T[M])!="string"||/^.$|[+-.\s]|(.).*\1/.test(B))throw Error(c+M+" invalid: "+B);Be=B}}return{DECIMAL_PLACES:C,ROUNDING_MODE:x,EXPONENTIAL_AT:[R,F],RANGE:[q,re],CRYPTO:fe,MODULO_MODE:de,POW_PRECISION:pe,FORMAT:Oe,ALPHABET:Be}},ee.isBigNumber=function(T){return T instanceof ee||T&&T._isBigNumber===!0||!1},ee.maximum=ee.max=function(){return je(arguments,v.lt)},ee.minimum=ee.min=function(){return je(arguments,v.gt)},ee.random=(xe=9007199254740992,be=Math.random()*xe&2097151?function(){return u(Math.random()*xe)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)},function(T){var M,B,Q,j,te,K=0,Y=[],Z=new ee(p);if(T==null?T=C:P(T,0,S),j=l(T/f),fe)if(crypto.getRandomValues){for(M=crypto.getRandomValues(new Uint32Array(j*=2));K<j;)9e15<=(te=131072*M[K]+(M[K+1]>>>11))?(B=crypto.getRandomValues(new Uint32Array(2)),M[K]=B[0],M[K+1]=B[1]):(Y.push(te%1e14),K+=2);K=j/2}else{if(!crypto.randomBytes)throw fe=!1,Error(c+"crypto unavailable");for(M=crypto.randomBytes(j*=7);K<j;)9e15<=(te=281474976710656*(31&M[K])+1099511627776*M[K+1]+4294967296*M[K+2]+16777216*M[K+3]+(M[K+4]<<16)+(M[K+5]<<8)+M[K+6])?crypto.randomBytes(7).copy(M,K):(Y.push(te%1e14),K+=7);K=j/7}if(!fe)for(;K<j;)(te=be())<9e15&&(Y[K++]=te%1e14);for(j=Y[--K],T%=f,j&&T&&(te=g[f-T],Y[K]=u(j/te)*te);Y[K]===0;Y.pop(),K--);if(K<0)Y=[Q=0];else{for(Q=-1;Y[0]===0;Y.splice(0,1),Q-=f);for(K=1,te=Y[0];10<=te;te/=10,K++);K<f&&(Q-=f-K)}return Z.e=Q,Z.c=Y,Z}),ee.sum=function(){for(var T=1,M=arguments,B=new ee(M[0]);T<M.length;)B=B.plus(M[T++]);return B},X=function(){var T="0123456789";function M(B,Q,j,te){for(var K,Y,Z=[0],J=0,ue=B.length;J<ue;){for(Y=Z.length;Y--;Z[Y]*=Q);for(Z[0]+=te.indexOf(B.charAt(J++)),K=0;K<Z.length;K++)Z[K]>j-1&&(Z[K+1]==null&&(Z[K+1]=0),Z[K+1]+=Z[K]/j|0,Z[K]%=j)}return Z.reverse()}return function(B,Q,j,te,K){var Y,Z,J,ue,Ee,De,Ye,nt,vt=B.indexOf("."),lt=C,Je=x;for(0<=vt&&(ue=pe,pe=0,B=B.replace(".",""),De=(nt=new ee(Q)).pow(B.length-vt),pe=ue,nt.c=M(W(y(De.c),De.e,"0"),10,j,T),nt.e=nt.c.length),J=ue=(Ye=M(B,Q,j,K?(Y=Be,T):(Y=T,Be))).length;Ye[--ue]==0;Ye.pop());if(!Ye[0])return Y.charAt(0);if(vt<0?--J:(De.c=Ye,De.e=J,De.s=te,Ye=(De=G(De,nt,lt,Je,j)).c,Ee=De.r,J=De.e),vt=Ye[Z=J+lt+1],ue=j/2,Ee=Ee||Z<0||Ye[Z+1]!=null,Ee=Je<4?(vt!=null||Ee)&&(Je==0||Je==(De.s<0?3:2)):ue<vt||vt==ue&&(Je==4||Ee||Je==6&&1&Ye[Z-1]||Je==(De.s<0?8:7)),Z<1||!Ye[0])B=Ee?W(Y.charAt(1),-lt,Y.charAt(0)):Y.charAt(0);else{if(Ye.length=Z,Ee)for(--j;++Ye[--Z]>j;)Ye[Z]=0,Z||(++J,Ye=[1].concat(Ye));for(ue=Ye.length;!Ye[--ue];);for(vt=0,B="";vt<=ue;B+=Y.charAt(Ye[vt++]));B=W(B,J,Y.charAt(0))}return B}}(),G=function(){function T(Q,j,te){var K,Y,Z,J,ue=0,Ee=Q.length,De=j%w,Ye=j/w|0;for(Q=Q.slice();Ee--;)ue=((Y=De*(Z=Q[Ee]%w)+(K=Ye*Z+(J=Q[Ee]/w|0)*De)%w*w+ue)/te|0)+(K/w|0)+Ye*J,Q[Ee]=Y%te;return ue&&(Q=[ue].concat(Q)),Q}function M(Q,j,te,K){var Y,Z;if(te!=K)Z=K<te?1:-1;else for(Y=Z=0;Y<te;Y++)if(Q[Y]!=j[Y]){Z=Q[Y]>j[Y]?1:-1;break}return Z}function B(Q,j,te,K){for(var Y=0;te--;)Q[te]-=Y,Y=Q[te]<j[te]?1:0,Q[te]=Y*K+Q[te]-j[te];for(;!Q[0]&&1<Q.length;Q.splice(0,1));}return function(Q,j,te,K,Y){var Z,J,ue,Ee,De,Ye,nt,vt,lt,Je,yt,rr,_o,li,Tl,on,nr,Or=Q.s==j.s?1:-1,Wr=Q.c,Zt=j.c;if(!(Wr&&Wr[0]&&Zt&&Zt[0]))return new ee(Q.s&&j.s&&(Wr?!Zt||Wr[0]!=Zt[0]:Zt)?Wr&&Wr[0]==0||!Zt?0*Or:Or/0:NaN);for(lt=(vt=new ee(Or)).c=[],Or=te+(J=Q.e-j.e)+1,Y||(Y=d,J=b(Q.e/f)-b(j.e/f),Or=Or/f|0),ue=0;Zt[ue]==(Wr[ue]||0);ue++);if(Zt[ue]>(Wr[ue]||0)&&J--,Or<0)lt.push(1),Ee=!0;else{for(li=Wr.length,on=Zt.length,Or+=2,1<(De=u(Y/(Zt[ue=0]+1)))&&(Zt=T(Zt,De,Y),Wr=T(Wr,De,Y),on=Zt.length,li=Wr.length),_o=on,yt=(Je=Wr.slice(0,on)).length;yt<on;Je[yt++]=0);nr=Zt.slice(),nr=[0].concat(nr),Tl=Zt[0],Zt[1]>=Y/2&&Tl++;do{if(De=0,(Z=M(Zt,Je,on,yt))<0){if(rr=Je[0],on!=yt&&(rr=rr*Y+(Je[1]||0)),1<(De=u(rr/Tl)))for(Y<=De&&(De=Y-1),nt=(Ye=T(Zt,De,Y)).length,yt=Je.length;M(Ye,Je,nt,yt)==1;)De--,B(Ye,on<nt?nr:Zt,nt,Y),nt=Ye.length,Z=1;else De==0&&(Z=De=1),nt=(Ye=Zt.slice()).length;if(nt<yt&&(Ye=[0].concat(Ye)),B(Je,Ye,yt,Y),yt=Je.length,Z==-1)for(;M(Zt,Je,on,yt)<1;)De++,B(Je,on<yt?nr:Zt,yt,Y),yt=Je.length}else Z===0&&(De++,Je=[0]);lt[ue++]=De,Je[0]?Je[yt++]=Wr[_o]||0:(Je=[Wr[_o]],yt=1)}while((_o++<li||Je[0]!=null)&&Or--);Ee=Je[0]!=null,lt[0]||lt.splice(0,1)}if(Y==d){for(ue=1,Or=lt[0];10<=Or;Or/=10,ue++);Xe(vt,te+(vt.e=ue+J*f-1)+1,K,Ee)}else vt.e=J,vt.r=+Ee;return vt}}(),Ze=/^(-?)0([xbo])(?=\w[\w.]*$)/i,Le=/^([^.]+)\.$/,Ne=/^\.([^.]+)$/,Me=/^-?(Infinity|NaN)$/,at=/^\s*\+(?=[\w.])|^\s+|\s+$/g,le=function(T,M,B,Q){var j,te=B?M:M.replace(at,"");if(Me.test(te))T.s=isNaN(te)?null:te<0?-1:1,T.c=T.e=null;else{if(!B&&(te=te.replace(Ze,function(K,Y,Z){return j=(Z=Z.toLowerCase())=="x"?16:Z=="b"?2:8,Q&&Q!=j?K:Y}),Q&&(j=Q,te=te.replace(Le,"$1").replace(Ne,"0.$1")),M!=te))return new ee(te,j);if(ee.DEBUG)throw Error(c+"Not a"+(Q?" base "+Q:"")+" number: "+M);T.c=T.e=T.s=null}},v.absoluteValue=v.abs=function(){var T=new ee(this);return T.s<0&&(T.s=1),T},v.comparedTo=function(T,M){return _(this,new ee(T,M))},v.decimalPlaces=v.dp=function(T,M){var B,Q,j;if(T!=null)return P(T,0,S),M==null?M=x:P(M,0,8),Xe(new ee(this),T+this.e+1,M);if(!(B=this.c))return null;if(Q=((j=B.length-1)-b(this.e/f))*f,j=B[j])for(;j%10==0;j/=10,Q--);return Q<0&&(Q=0),Q},v.dividedBy=v.div=function(T,M){return G(this,new ee(T,M),C,x)},v.dividedToIntegerBy=v.idiv=function(T,M){return G(this,new ee(T,M),0,1)},v.exponentiatedBy=v.pow=function(T,M){var B,Q,j,te,K,Y,Z,J,ue=this;if((T=new ee(T)).c&&!T.isInteger())throw Error(c+"Exponent not an integer: "+Ve(T));if(M!=null&&(M=new ee(M)),K=14<T.e,!ue.c||!ue.c[0]||ue.c[0]==1&&!ue.e&&ue.c.length==1||!T.c||!T.c[0])return J=new ee(Math.pow(+Ve(ue),K?2-z(T):+Ve(T))),M?J.mod(M):J;if(Y=T.s<0,M){if(M.c?!M.c[0]:!M.s)return new ee(NaN);(Q=!Y&&ue.isInteger()&&M.isInteger())&&(ue=ue.mod(M))}else{if(9<T.e&&(0<ue.e||ue.e<-1||(ue.e==0?1<ue.c[0]||K&&24e7<=ue.c[1]:ue.c[0]<8e13||K&&ue.c[0]<=9999975e7)))return te=ue.s<0&&z(T)?-0:0,-1<ue.e&&(te=1/te),new ee(Y?1/te:te);pe&&(te=l(pe/f+2))}for(Z=K?(B=new ee(.5),Y&&(T.s=1),z(T)):(j=Math.abs(+Ve(T)))%2,J=new ee(p);;){if(Z){if(!(J=J.times(ue)).c)break;te?J.c.length>te&&(J.c.length=te):Q&&(J=J.mod(M))}if(j){if((j=u(j/2))===0)break;Z=j%2}else if(Xe(T=T.times(B),T.e+1,1),14<T.e)Z=z(T);else{if((j=+Ve(T))==0)break;Z=j%2}ue=ue.times(ue),te?ue.c&&ue.c.length>te&&(ue.c.length=te):Q&&(ue=ue.mod(M))}return Q?J:(Y&&(J=p.div(J)),M?J.mod(M):te?Xe(J,pe,x,void 0):J)},v.integerValue=function(T){var M=new ee(this);return T==null?T=x:P(T,0,8),Xe(M,M.e+1,T)},v.isEqualTo=v.eq=function(T,M){return _(this,new ee(T,M))===0},v.isFinite=function(){return!!this.c},v.isGreaterThan=v.gt=function(T,M){return 0<_(this,new ee(T,M))},v.isGreaterThanOrEqualTo=v.gte=function(T,M){return(M=_(this,new ee(T,M)))===1||M===0},v.isInteger=function(){return!!this.c&&b(this.e/f)>this.c.length-2},v.isLessThan=v.lt=function(T,M){return _(this,new ee(T,M))<0},v.isLessThanOrEqualTo=v.lte=function(T,M){return(M=_(this,new ee(T,M)))===-1||M===0},v.isNaN=function(){return!this.s},v.isNegative=function(){return this.s<0},v.isPositive=function(){return 0<this.s},v.isZero=function(){return!!this.c&&this.c[0]==0},v.minus=function(T,M){var B,Q,j,te,K=this,Y=K.s;if(M=(T=new ee(T,M)).s,!Y||!M)return new ee(NaN);if(Y!=M)return T.s=-M,K.plus(T);var Z=K.e/f,J=T.e/f,ue=K.c,Ee=T.c;if(!Z||!J){if(!ue||!Ee)return ue?(T.s=-M,T):new ee(Ee?K:NaN);if(!ue[0]||!Ee[0])return Ee[0]?(T.s=-M,T):new ee(ue[0]?K:x==3?-0:0)}if(Z=b(Z),J=b(J),ue=ue.slice(),Y=Z-J){for((j=(te=Y<0)?(Y=-Y,ue):(J=Z,Ee)).reverse(),M=Y;M--;j.push(0));j.reverse()}else for(Q=(te=(Y=ue.length)<(M=Ee.length))?Y:M,Y=M=0;M<Q;M++)if(ue[M]!=Ee[M]){te=ue[M]<Ee[M];break}if(te&&(j=ue,ue=Ee,Ee=j,T.s=-T.s),0<(M=(Q=Ee.length)-(B=ue.length)))for(;M--;ue[B++]=0);for(M=d-1;Y<Q;){if(ue[--Q]<Ee[Q]){for(B=Q;B&&!ue[--B];ue[B]=M);--ue[B],ue[Q]+=d}ue[Q]-=Ee[Q]}for(;ue[0]==0;ue.splice(0,1),--J);return ue[0]?ye(T,ue,J):(T.s=x==3?-1:1,T.c=[T.e=0],T)},v.modulo=v.mod=function(T,M){var B,Q,j=this;return T=new ee(T,M),!j.c||!T.s||T.c&&!T.c[0]?new ee(NaN):!T.c||j.c&&!j.c[0]?new ee(j):(de==9?(Q=T.s,T.s=1,B=G(j,T,0,3),T.s=Q,B.s*=Q):B=G(j,T,0,de),(T=j.minus(B.times(T))).c[0]||de!=1||(T.s=j.s),T)},v.multipliedBy=v.times=function(T,M){var B,Q,j,te,K,Y,Z,J,ue,Ee,De,Ye,nt,vt,lt,Je=this,yt=Je.c,rr=(T=new ee(T,M)).c;if(!(yt&&rr&&yt[0]&&rr[0]))return!Je.s||!T.s||yt&&!yt[0]&&!rr||rr&&!rr[0]&&!yt?T.c=T.e=T.s=null:(T.s*=Je.s,yt&&rr?(T.c=[0],T.e=0):T.c=T.e=null),T;for(Q=b(Je.e/f)+b(T.e/f),T.s*=Je.s,(Z=yt.length)<(Ee=rr.length)&&(nt=yt,yt=rr,rr=nt,j=Z,Z=Ee,Ee=j),j=Z+Ee,nt=[];j--;nt.push(0));for(vt=d,lt=w,j=Ee;0<=--j;){for(B=0,De=rr[j]%lt,Ye=rr[j]/lt|0,te=j+(K=Z);j<te;)B=((J=De*(J=yt[--K]%lt)+(Y=Ye*J+(ue=yt[K]/lt|0)*De)%lt*lt+nt[te]+B)/vt|0)+(Y/lt|0)+Ye*ue,nt[te--]=J%vt;nt[te]=B}return B?++Q:nt.splice(0,1),ye(T,nt,Q)},v.negated=function(){var T=new ee(this);return T.s=-T.s||null,T},v.plus=function(T,M){var B,Q=this,j=Q.s;if(M=(T=new ee(T,M)).s,!j||!M)return new ee(NaN);if(j!=M)return T.s=-M,Q.minus(T);var te=Q.e/f,K=T.e/f,Y=Q.c,Z=T.c;if(!te||!K){if(!Y||!Z)return new ee(j/0);if(!Y[0]||!Z[0])return Z[0]?T:new ee(Y[0]?Q:0*j)}if(te=b(te),K=b(K),Y=Y.slice(),j=te-K){for((B=0<j?(K=te,Z):(j=-j,Y)).reverse();j--;B.push(0));B.reverse()}for((j=Y.length)-(M=Z.length)<0&&(B=Z,Z=Y,Y=B,M=j),j=0;M;)j=(Y[--M]=Y[M]+Z[M]+j)/d|0,Y[M]=d===Y[M]?0:Y[M]%d;return j&&(Y=[j].concat(Y),++K),ye(T,Y,K)},v.precision=v.sd=function(T,M){var B,Q,j;if(T!=null&&T!==!!T)return P(T,1,S),M==null?M=x:P(M,0,8),Xe(new ee(this),T,M);if(!(B=this.c))return null;if(Q=(j=B.length-1)*f+1,j=B[j]){for(;j%10==0;j/=10,Q--);for(j=B[0];10<=j;j/=10,Q++);}return T&&this.e+1>Q&&(Q=this.e+1),Q},v.shiftedBy=function(T){return P(T,-m,m),this.times("1e"+T)},v.squareRoot=v.sqrt=function(){var T,M,B,Q,j,te=this,K=te.c,Y=te.s,Z=te.e,J=C+4,ue=new ee("0.5");if(Y!==1||!K||!K[0])return new ee(!Y||Y<0&&(!K||K[0])?NaN:K?te:1/0);if((B=(Y=Math.sqrt(+Ve(te)))==0||Y==1/0?(((M=y(K)).length+Z)%2==0&&(M+="0"),Y=Math.sqrt(+M),Z=b((Z+1)/2)-(Z<0||Z%2),new ee(M=Y==1/0?"1e"+Z:(M=Y.toExponential()).slice(0,M.indexOf("e")+1)+Z)):new ee(Y+"")).c[0]){for((Y=(Z=B.e)+J)<3&&(Y=0);;)if(j=B,B=ue.times(j.plus(G(te,j,J,1))),y(j.c).slice(0,Y)===(M=y(B.c)).slice(0,Y)){if(B.e<Z&&--Y,(M=M.slice(Y-3,Y+1))!="9999"&&(Q||M!="4999")){+M&&(+M.slice(1)||M.charAt(0)!="5")||(Xe(B,B.e+C+2,1),T=!B.times(B).eq(te));break}if(!Q&&(Xe(j,j.e+C+2,0),j.times(j).eq(te))){B=j;break}J+=4,Y+=4,Q=1}}return Xe(B,B.e+C+1,x,T)},v.toExponential=function(T,M){return T!=null&&(P(T,0,S),T++),et(this,T,M,1)},v.toFixed=function(T,M){return T!=null&&(P(T,0,S),T=T+this.e+1),et(this,T,M)},v.toFormat=function(T,M,B){var Q;if(B==null)T!=null&&M&&typeof M=="object"?(B=M,M=null):T&&typeof T=="object"?(B=T,T=M=null):B=Oe;else if(typeof B!="object")throw Error(c+"Argument not an object: "+B);if(Q=this.toFixed(T,M),this.c){var j,te=Q.split("."),K=+B.groupSize,Y=+B.secondaryGroupSize,Z=B.groupSeparator||"",J=te[0],ue=te[1],Ee=this.s<0,De=Ee?J.slice(1):J,Ye=De.length;if(Y&&(j=K,K=Y,Ye-=Y=j),0<K&&0<Ye){for(j=Ye%K||K,J=De.substr(0,j);j<Ye;j+=K)J+=Z+De.substr(j,K);0<Y&&(J+=Z+De.slice(j)),Ee&&(J="-"+J)}Q=ue?J+(B.decimalSeparator||"")+((Y=+B.fractionGroupSize)?ue.replace(new RegExp("\\d{"+Y+"}\\B","g"),"$&"+(B.fractionGroupSeparator||"")):ue):J}return(B.prefix||"")+Q+(B.suffix||"")},v.toFraction=function(T){var M,B,Q,j,te,K,Y,Z,J,ue,Ee,De,Ye=this,nt=Ye.c;if(T!=null&&(!(Y=new ee(T)).isInteger()&&(Y.c||Y.s!==1)||Y.lt(p)))throw Error(c+"Argument "+(Y.isInteger()?"out of range: ":"not an integer: ")+Ve(Y));if(!nt)return new ee(Ye);for(M=new ee(p),J=B=new ee(p),Q=Z=new ee(p),De=y(nt),te=M.e=De.length-Ye.e-1,M.c[0]=g[(K=te%f)<0?f+K:K],T=!T||0<Y.comparedTo(M)?0<te?M:J:Y,K=re,re=1/0,Y=new ee(De),Z.c[0]=0;ue=G(Y,M,0,1),(j=B.plus(ue.times(Q))).comparedTo(T)!=1;)B=Q,Q=j,J=Z.plus(ue.times(j=J)),Z=j,M=Y.minus(ue.times(j=M)),Y=j;return j=G(T.minus(B),Q,0,1),Z=Z.plus(j.times(J)),B=B.plus(j.times(Q)),Z.s=J.s=Ye.s,Ee=G(J,Q,te*=2,x).minus(Ye).abs().comparedTo(G(Z,B,te,x).minus(Ye).abs())<1?[J,Q]:[Z,B],re=K,Ee},v.toNumber=function(){return+Ve(this)},v.toPrecision=function(T,M){return T!=null&&P(T,1,S),et(this,T,M,2)},v.toString=function(T){var M,B=this,Q=B.s,j=B.e;return j===null?Q?(M="Infinity",Q<0&&(M="-"+M)):M="NaN":(M=T==null?j<=R||F<=j?I(y(B.c),j):W(y(B.c),j,"0"):T===10?W(y((B=Xe(new ee(B),C+j+1,x)).c),B.e,"0"):(P(T,2,Be.length,"Base"),X(W(y(B.c),j,"0"),10,T,Q,!0)),Q<0&&B.c[0]&&(M="-"+M)),M},v.valueOf=v.toJSON=function(){return Ve(this)},v._isBigNumber=!0,typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"&&(v[Symbol.toStringTag]="BigNumber",v[Symbol.for("nodejs.util.inspect.custom")]=v.valueOf),U!=null&&ee.set(U),ee}()).default=o.BigNumber=o,n!==void 0&&n.exports?n.exports=o:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=o)})(this)},{}],2:[function(r,n,i){n.exports={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(s){var o=s%10;return~~(s%100/10)==1?"th":o===1?"st":o===2?"nd":o===3?"rd":"th"},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}},{}],3:[function(r,n,i){function s(b,y){return function(_){if(Array.isArray(_))return _}(b)||function(_,P){var z=[],I=!0,W=!1,L=void 0;try{for(var U,G=_[Symbol.iterator]();!(I=(U=G.next()).done)&&(z.push(U.value),!P||z.length!==P);I=!0);}catch(X){W=!0,L=X}finally{try{I||G.return==null||G.return()}finally{if(W)throw L}}return z}(b,y)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var o=r("./globalState"),a=r("./validating"),l=r("./parsing"),u=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],c={general:{scale:1024,suffixes:u,marker:"bd"},binary:{scale:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],marker:"b"},decimal:{scale:1e3,suffixes:u,marker:"d"}},h={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1};function d(b){var y=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{},_=2<arguments.length?arguments[2]:void 0;if(typeof y=="string"&&(y=l.parseFormat(y)),!a.validateFormat(y))return"ERROR: invalid format";var P=y.prefix||"",z=y.postfix||"",I=function(W,L,U){switch(L.output){case"currency":return L=S(L,o.currentCurrencyDefaultFormat()),function(Be,ee,et){var je=et.currentCurrency(),ye=Object.assign({},h,ee),Xe=void 0,Ve="",T=!!ye.totalLength||!!ye.forceAverage||ye.average,M=ee.currencyPosition||je.position,B=ee.currencySymbol||je.symbol;ye.spaceSeparated&&(Ve=" "),M==="infix"&&(Xe=Ve+B+Ve);var Q=w({instance:Be,providedFormat:ee,state:et,decimalSeparator:Xe});return M==="prefix"&&(Q=Be._value<0&&ye.negative==="sign"?"-".concat(Ve).concat(B).concat(Q.slice(1)):B+Ve+Q),M&&M!=="postfix"||(Q=Q+(Ve=T?"":Ve)+B),Q}(W,L,o);case"percent":return L=S(L,o.currentPercentageDefaultFormat()),function(Be,ee,et,je){var ye=ee.prefixSymbol,Xe=w({instance:je(100*Be._value),providedFormat:ee,state:et}),Ve=Object.assign({},h,ee);return ye?"%".concat(Ve.spaceSeparated?" ":"").concat(Xe):"".concat(Xe).concat(Ve.spaceSeparated?" ":"","%")}(W,L,o,U);case"byte":return L=S(L,o.currentByteDefaultFormat()),p=W,x=o,R=U,F=(C=L).base||"binary",q=c[F],re=f(p._value,q.suffixes,q.scale),fe=re.value,de=re.suffix,pe=w({instance:R(fe),providedFormat:C,state:x,defaults:x.currentByteDefaultFormat()}),Oe=x.currentAbbreviations(),"".concat(pe).concat(Oe.spaced?" ":"").concat(de);case"time":return L=S(L,o.currentTimeDefaultFormat()),Ne=W,Me=Math.floor(Ne._value/60/60),at=Math.floor((Ne._value-60*Me*60)/60),v=Math.round(Ne._value-60*Me*60-60*at),"".concat(Me,":").concat(at<10?"0":"").concat(at,":").concat(v<10?"0":"").concat(v);case"ordinal":return L=S(L,o.currentOrdinalDefaultFormat()),G=W,X=L,xe=(le=o).currentOrdinal(),be=Object.assign({},h,X),Ze=w({instance:G,providedFormat:X,state:le}),Le=xe(G._value),"".concat(Ze).concat(be.spaceSeparated?" ":"").concat(Le);case"number":default:return w({instance:W,providedFormat:L,numbro:U})}var G,X,le,xe,be,Ze,Le,Ne,Me,at,v,p,C,x,R,F,q,re,fe,de,pe,Oe}(b,y,_);return I=(I=P+I)+z}function f(b,y,_){var P=y[0],z=Math.abs(b);if(_<=z){for(var I=1;I<y.length;++I){var W=Math.pow(_,I),L=Math.pow(_,I+1);if(W<=z&&z<L){P=y[I],b/=W;break}}P===y[0]&&(b/=Math.pow(_,y.length-1),P=y[y.length-1])}return{value:b,suffix:P}}function m(b){for(var y="",_=0;_<b;_++)y+="0";return y}function g(b,y){return b.toString().indexOf("e")!==-1?function(_,P){var z=_.toString(),I=s(z.split("e"),2),W=I[0],L=I[1],U=s(W.split("."),2),G=U[0],X=U[1],le=X===void 0?"":X;if(0<+L)z=G+le+m(L-le.length);else{var xe=".";xe=+G<0?"-0".concat(xe):"0".concat(xe);var be=(m(-L-1)+Math.abs(G)+le).substr(0,P);be.length<P&&(be+=m(P-be.length)),z=xe+be}return 0<+L&&0<P&&(z+=".".concat(m(P))),z}(b,y):(Math.round(+"".concat(b,"e+").concat(y))/Math.pow(10,y)).toFixed(y)}function w(b){var y=b.instance,_=b.providedFormat,P=b.state,z=P===void 0?o:P,I=b.decimalSeparator,W=b.defaults,L=W===void 0?z.currentDefaults():W,U=y._value;if(U===0&&z.hasZeroFormat())return z.getZeroFormat();if(!isFinite(U))return U.toString();var G,X,le,xe,be,Ze,Le,Ne,Me=Object.assign({},h,L,_),at=Me.totalLength,v=at?0:Me.characteristic,p=Me.optionalCharacteristic,C=Me.forceAverage,x=!!at||!!C||Me.average,R=at?-1:x&&_.mantissa===void 0?0:Me.mantissa,F=!at&&(_.optionalMantissa===void 0?R===-1:Me.optionalMantissa),q=Me.trimMantissa,re=Me.thousandSeparated,fe=Me.spaceSeparated,de=Me.negative,pe=Me.forceSign,Oe=Me.exponential,Be="";if(x){var ee=function(T){var M=T.value,B=T.forceAverage,Q=T.abbreviations,j=T.spaceSeparated,te=j!==void 0&&j,K=T.totalLength,Y=K===void 0?0:K,Z="",J=Math.abs(M),ue=-1;if(J>=Math.pow(10,12)&&!B||B==="trillion"?(Z=Q.trillion,M/=Math.pow(10,12)):J<Math.pow(10,12)&&J>=Math.pow(10,9)&&!B||B==="billion"?(Z=Q.billion,M/=Math.pow(10,9)):J<Math.pow(10,9)&&J>=Math.pow(10,6)&&!B||B==="million"?(Z=Q.million,M/=Math.pow(10,6)):(J<Math.pow(10,6)&&J>=Math.pow(10,3)&&!B||B==="thousand")&&(Z=Q.thousand,M/=Math.pow(10,3)),Z&&(Z=(te?" ":"")+Z),Y){var Ee=M.toString().split(".")[0];ue=Math.max(Y-Ee.length,0)}return{value:M,abbreviation:Z,mantissaPrecision:ue}}({value:U,forceAverage:C,abbreviations:z.currentAbbreviations(),spaceSeparated:fe,totalLength:at});U=ee.value,Be+=ee.abbreviation,at&&(R=ee.mantissaPrecision)}if(Oe){var et=(X=(G={value:U,characteristicPrecision:v}).value,le=G.characteristicPrecision,xe=le===void 0?0:le,be=s(X.toExponential().split("e"),2),Ze=be[0],Le=be[1],Ne=+Ze,xe&&1<xe&&(Ne*=Math.pow(10,xe-1),Le=0<=(Le=+Le-(xe-1))?"+".concat(Le):Le),{value:Ne,abbreviation:"e".concat(Le)});U=et.value,Be=et.abbreviation+Be}var je,ye,Xe,Ve=function(T,M,B,Q,j){if(Q===-1)return T;var te=g(M,Q),K=s(te.toString().split("."),2),Y=K[0],Z=K[1],J=Z===void 0?"":Z;if(J.match(/^0+$/)&&(B||j))return Y;var ue=J.match(/0+$/);return j&&ue?"".concat(Y,".").concat(J.toString().slice(0,ue.index)):te.toString()}(U.toString(),U,F,R,q);return Ve=function(T,M,B,Q,j){var te=Q.currentDelimiters(),K=te.thousands;j=j||te.decimal;var Y=te.thousandsSize||3,Z=T.toString(),J=Z.split(".")[0],ue=Z.split(".")[1];return B&&(M<0&&(J=J.slice(1)),function(Ee,De){for(var Ye=[],nt=0,vt=Ee;0<vt;vt--)nt===De&&(Ye.unshift(vt),nt=0),nt++;return Ye}(J.length,Y).forEach(function(Ee,De){J=J.slice(0,Ee+De)+K+J.slice(Ee+De)}),M<0&&(J="-".concat(J))),Z=ue?J+j+ue:J}(Ve=function(T,M,B,Q){var j=T,te=s(j.toString().split("."),2),K=te[0],Y=te[1];if(K.match(/^-?0$/)&&B)return Y?"".concat(K.replace("0",""),".").concat(Y):K.replace("0","");if(K.length<Q)for(var Z=Q-K.length,J=0;J<Z;J++)j="0".concat(j);return j.toString()}(Ve,0,p,v),U,re,z,I),(x||Oe)&&(Ve=Ve+Be),(pe||U<0)&&(je=Ve,Xe=de,Ve=(ye=U)===0?je:+je==0?je.replace("-",""):0<ye?"+".concat(je):Xe==="sign"?je:"(".concat(je.replace("-",""),")")),Ve}function S(b,y){if(!b)return y;var _=Object.keys(b);return _.length===1&&_[0]==="output"?y:b}n.exports=function(b){return{format:function(){for(var y=arguments.length,_=new Array(y),P=0;P<y;P++)_[P]=arguments[P];return d.apply(void 0,_.concat([b]))},getByteUnit:function(){for(var y=arguments.length,_=new Array(y),P=0;P<y;P++)_[P]=arguments[P];return(function(z){var I=c.general;return f(z._value,I.suffixes,I.scale).suffix}).apply(void 0,_.concat([b]))},getBinaryByteUnit:function(){for(var y=arguments.length,_=new Array(y),P=0;P<y;P++)_[P]=arguments[P];return(function(z){var I=c.binary;return f(z._value,I.suffixes,I.scale).suffix}).apply(void 0,_.concat([b]))},getDecimalByteUnit:function(){for(var y=arguments.length,_=new Array(y),P=0;P<y;P++)_[P]=arguments[P];return(function(z){var I=c.decimal;return f(z._value,I.suffixes,I.scale).suffix}).apply(void 0,_.concat([b]))},formatOrDefault:S}}},{"./globalState":4,"./parsing":8,"./validating":10}],4:[function(r,n,i){var s=r("./en-US"),o=r("./validating"),a=r("./parsing"),l={},u=void 0,c={},h=null,d={};function f(g){u=g}function m(){return c[u]}l.languages=function(){return Object.assign({},c)},l.currentLanguage=function(){return u},l.currentCurrency=function(){return m().currency},l.currentAbbreviations=function(){return m().abbreviations},l.currentDelimiters=function(){return m().delimiters},l.currentOrdinal=function(){return m().ordinal},l.currentDefaults=function(){return Object.assign({},m().defaults,d)},l.currentOrdinalDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().ordinalFormat)},l.currentByteDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().byteFormat)},l.currentPercentageDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().percentageFormat)},l.currentCurrencyDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().currencyFormat)},l.currentTimeDefaultFormat=function(){return Object.assign({},l.currentDefaults(),m().timeFormat)},l.setDefaults=function(g){g=a.parseFormat(g),o.validateFormat(g)&&(d=g)},l.getZeroFormat=function(){return h},l.setZeroFormat=function(g){return h=typeof g=="string"?g:null},l.hasZeroFormat=function(){return h!==null},l.languageData=function(g){if(g){if(c[g])return c[g];throw new Error('Unknown tag "'.concat(g,'"'))}return m()},l.registerLanguage=function(g){var w=1<arguments.length&&arguments[1]!==void 0&&arguments[1];if(!o.validateLanguage(g))throw new Error("Invalid language data");c[g.languageTag]=g,w&&f(g.languageTag)},l.setLanguage=function(g){var w=1<arguments.length&&arguments[1]!==void 0?arguments[1]:s.languageTag;if(!c[g]){var S=g.split("-")[0],b=Object.keys(c).find(function(y){return y.split("-")[0]===S});return c[b]?void f(b):void f(w)}f(g)},l.registerLanguage(s),u=s.languageTag,n.exports=l},{"./en-US":2,"./parsing":8,"./validating":10}],5:[function(r,n,i){n.exports=function(s){return{loadLanguagesInNode:function(o){return a=s,void o.forEach(function(l){var u=void 0;try{u=r("../languages/".concat(l))}catch{console.error('Unable to load "'.concat(l,'". No matching language file found.'))}u&&a.registerLanguage(u)});var a}}}},{}],6:[function(r,n,i){var s=r("bignumber.js");function o(a,l,u){var c=new s(a._value),h=l;return u.isNumbro(l)&&(h=l._value),h=new s(h),a._value=c.minus(h).toNumber(),a}n.exports=function(a){return{add:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.plus(m).toNumber(),c;var c,h,d,f,m},subtract:function(l,u){return o(l,u,a)},multiply:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.times(m).toNumber(),c;var c,h,d,f,m},divide:function(l,u){return h=u,d=a,f=new s((c=l)._value),m=h,d.isNumbro(h)&&(m=h._value),m=new s(m),c._value=f.dividedBy(m).toNumber(),c;var c,h,d,f,m},set:function(l,u){return c=l,d=h=u,a.isNumbro(h)&&(d=h._value),c._value=d,c;var c,h,d},difference:function(l,u){return c=u,o(d=(h=a)(l._value),c,h),Math.abs(d._value);var c,h,d}}}},{"bignumber.js":1}],7:[function(r,n,i){function s(w,S){for(var b=0;b<S.length;b++){var y=S[b];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(w,y.key,y)}}var o=r("./globalState"),a=r("./validating"),l=r("./loading")(g),u=r("./unformatting"),c=r("./formatting")(g),h=r("./manipulating")(g),d=r("./parsing"),f=function(){function w(y){(function(_,P){if(!(_ instanceof P))throw new TypeError("Cannot call a class as a function")})(this,w),this._value=y}var S,b;return S=w,(b=[{key:"clone",value:function(){return g(this._value)}},{key:"format",value:function(){var y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return c.format(this,y)}},{key:"formatCurrency",value:function(y){return typeof y=="string"&&(y=d.parseFormat(y)),(y=c.formatOrDefault(y,o.currentCurrencyDefaultFormat())).output="currency",c.format(this,y)}},{key:"formatTime",value:function(){var y=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return y.output="time",c.format(this,y)}},{key:"binaryByteUnits",value:function(){return c.getBinaryByteUnit(this)}},{key:"decimalByteUnits",value:function(){return c.getDecimalByteUnit(this)}},{key:"byteUnits",value:function(){return c.getByteUnit(this)}},{key:"difference",value:function(y){return h.difference(this,y)}},{key:"add",value:function(y){return h.add(this,y)}},{key:"subtract",value:function(y){return h.subtract(this,y)}},{key:"multiply",value:function(y){return h.multiply(this,y)}},{key:"divide",value:function(y){return h.divide(this,y)}},{key:"set",value:function(y){return h.set(this,m(y))}},{key:"value",value:function(){return this._value}},{key:"valueOf",value:function(){return this._value}}])&&s(S.prototype,b),w}();function m(w){var S=w;return g.isNumbro(w)?S=w._value:typeof w=="string"?S=g.unformat(w):isNaN(w)&&(S=NaN),S}function g(w){return new f(m(w))}g.version="2.1.2",g.isNumbro=function(w){return w instanceof f},g.language=o.currentLanguage,g.registerLanguage=o.registerLanguage,g.setLanguage=o.setLanguage,g.languages=o.languages,g.languageData=o.languageData,g.zeroFormat=o.setZeroFormat,g.defaultFormat=o.currentDefaults,g.setDefaults=o.setDefaults,g.defaultCurrencyFormat=o.currentCurrencyDefaultFormat,g.validate=a.validate,g.loadLanguagesInNode=l.loadLanguagesInNode,g.unformat=u.unformat,n.exports=g},{"./formatting":3,"./globalState":4,"./loading":5,"./manipulating":6,"./parsing":8,"./unformatting":9,"./validating":10}],8:[function(r,n,i){n.exports={parseFormat:function(s){var o,a,l,u,c,h,d,f,m,g,w,S,b,y,_,P,z,I,W,L,U=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};return typeof s!="string"?s:(a=U,s=(l=(o=s).match(/^{([^}]*)}/))?(a.prefix=l[1],o.slice(l[0].length)):o,c=U,function(G,X){if(G.indexOf("$")===-1){if(G.indexOf("%")===-1)return G.indexOf("bd")!==-1?(X.output="byte",X.base="general"):G.indexOf("b")!==-1?(X.output="byte",X.base="binary"):G.indexOf("d")!==-1?(X.output="byte",X.base="decimal"):G.indexOf(":")===-1?G.indexOf("o")!==-1&&(X.output="ordinal"):X.output="time";X.output="percent"}else X.output="currency"}(s=(h=(u=s).match(/{([^}]*)}$/))?(c.postfix=h[1],u.slice(0,-h[0].length)):u,U),d=U,(f=s.match(/[1-9]+[0-9]*/))&&(d.totalLength=+f[0]),m=U,(g=s.split(".")[0].match(/0+/))&&(m.characteristic=g[0].length),function(G,X){if(G.indexOf(".")!==-1){var le=G.split(".")[0];X.optionalCharacteristic=le.indexOf("0")===-1}}(s,U),w=U,s.indexOf("a")!==-1&&(w.average=!0),b=U,(S=s).indexOf("K")!==-1?b.forceAverage="thousand":S.indexOf("M")!==-1?b.forceAverage="million":S.indexOf("B")!==-1?b.forceAverage="billion":S.indexOf("T")!==-1&&(b.forceAverage="trillion"),function(G,X){var le=G.split(".")[1];if(le){var xe=le.match(/0+/);xe&&(X.mantissa=xe[0].length)}}(s,U),_=U,(y=s).match(/\[\.]/)?_.optionalMantissa=!0:y.match(/\./)&&(_.optionalMantissa=!1),P=U,s.indexOf(",")!==-1&&(P.thousandSeparated=!0),z=U,s.indexOf(" ")!==-1&&(z.spaceSeparated=!0),W=U,(I=s).match(/^\+?\([^)]*\)$/)&&(W.negative="parenthesis"),I.match(/^\+?-/)&&(W.negative="sign"),L=U,s.match(/^\+/)&&(L.forceSign=!0),U)}}},{}],9:[function(r,n,i){var s=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function o(l){return l.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function a(l,u){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",h=3<arguments.length?arguments[3]:void 0,d=4<arguments.length?arguments[4]:void 0,f=5<arguments.length?arguments[5]:void 0,m=6<arguments.length?arguments[6]:void 0;if(l!=="")return l===d?0:function g(w,S){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",y=3<arguments.length?arguments[3]:void 0,_=4<arguments.length?arguments[4]:void 0,P=5<arguments.length?arguments[5]:void 0,z=6<arguments.length?arguments[6]:void 0;if(!isNaN(+w))return+w;var I="",W=w.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(W!==w)return-1*g(W,S,b,y,_,P,z);for(var L=0;L<s.length;L++){var U=s[L];if((I=w.replace(U.key,""))!==w)return g(I,S,b,y,_,P,z)*U.factor}if((I=w.replace("%",""))!==w)return g(I,S,b,y,_,P,z)/100;var G=parseFloat(w);if(!isNaN(G)){var X=y(G);if(X&&X!=="."&&(I=w.replace(new RegExp("".concat(o(X),"$")),""))!==w)return g(I,S,b,y,_,P,z);var le={};Object.keys(P).forEach(function(at){le[P[at]]=at});for(var xe=Object.keys(le).sort().reverse(),be=xe.length,Ze=0;Ze<be;Ze++){var Le=xe[Ze],Ne=le[Le];if((I=w.replace(Le,""))!==w){var Me=void 0;switch(Ne){case"thousand":Me=Math.pow(10,3);break;case"million":Me=Math.pow(10,6);break;case"billion":Me=Math.pow(10,9);break;case"trillion":Me=Math.pow(10,12)}return g(I,S,b,y,_,P,z)*Me}}}}(function(g,w){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",b=g.replace(S,"");return b=(b=b.replace(new RegExp("([0-9])".concat(o(w.thousands),"([0-9])"),"g"),"$1$2")).replace(w.decimal,".")}(l,u,c),u,c,h,d,f,m)}n.exports={unformat:function(l,u){var c,h,d,f=r("./globalState"),m=f.currentDelimiters(),g=f.currentCurrency().symbol,w=f.currentOrdinal(),S=f.getZeroFormat(),b=f.currentAbbreviations(),y=void 0;if(typeof l=="string")y=function(_,P){if(!_.indexOf(":")||P.thousands===":")return!1;var z=_.split(":");if(z.length!==3)return!1;var I=+z[0],W=+z[1],L=+z[2];return!isNaN(I)&&!isNaN(W)&&!isNaN(L)}(l,m)?(c=l.split(":"),h=+c[0],d=+c[1],+c[2]+60*d+3600*h):a(l,m,g,w,S,b,u);else{if(typeof l!="number")return;y=l}if(y!==void 0)return y}}},{"./globalState":4}],10:[function(r,n,i){function s(m){return function(g){if(Array.isArray(g)){for(var w=0,S=new Array(g.length);w<g.length;w++)S[w]=g[w];return S}}(m)||function(g){if(Symbol.iterator in Object(g)||Object.prototype.toString.call(g)==="[object Arguments]")return Array.from(g)}(m)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(m){return(o=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g})(m)}var a=r("./unformatting"),l=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,u={output:{type:"string",validValues:["currency","percent","byte","time","ordinal","number"]},base:{type:"string",validValues:["decimal","binary","general"],restriction:function(m,g){return g.output==="byte"},message:"`base` must be provided only when the output is `byte`",mandatory:function(m){return m.output==="byte"}},characteristic:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:["trillion","billion","million","thousand"]},average:"boolean",currencyPosition:{type:"string",validValues:["prefix","infix","postfix"]},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:function(m){return 0<=m},message:"value must be positive"},{restriction:function(m,g){return!g.exponential},message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:function(m){return 0<=m},message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:["sign","parenthesis"]},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:function(m,g){return g.output==="percent"},message:"`prefixSymbol` can be provided only when the output is `percent`"}},c={languageTag:{type:"string",mandatory:!0,restriction:function(m){return m.match(l)},message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:{type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},spaceSeparated:"boolean",ordinal:{type:"function",mandatory:!0},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function h(m){return!!a.unformat(m)}function d(m,g,w){var S=3<arguments.length&&arguments[3]!==void 0&&arguments[3],b=Object.keys(m).map(function(y){if(!g[y])return console.error("".concat(w," Invalid key: ").concat(y)),!1;var _=m[y],P=g[y];if(typeof P=="string"&&(P={type:P}),P.type==="format"){if(!d(_,u,"[Validate ".concat(y,"]"),!0))return!1}else if(o(_)!==P.type)return console.error("".concat(w," ").concat(y,' type mismatched: "').concat(P.type,'" expected, "').concat(o(_),'" provided')),!1;if(P.restrictions&&P.restrictions.length)for(var z=P.restrictions.length,I=0;I<z;I++){var W=P.restrictions[I],L=W.restriction,U=W.message;if(!L(_,m))return console.error("".concat(w," ").concat(y," invalid value: ").concat(U)),!1}return P.restriction&&!P.restriction(_,m)?(console.error("".concat(w," ").concat(y," invalid value: ").concat(P.message)),!1):P.validValues&&P.validValues.indexOf(_)===-1?(console.error("".concat(w," ").concat(y," invalid value: must be among ").concat(JSON.stringify(P.validValues),', "').concat(_,'" provided')),!1):!(P.children&&!d(_,P.children,"[Validate ".concat(y,"]")))});return S||b.push.apply(b,s(Object.keys(g).map(function(y){var _=g[y];if(typeof _=="string"&&(_={type:_}),_.mandatory){var P=_.mandatory;if(typeof P=="function"&&(P=P(m)),P&&m[y]===void 0)return console.error("".concat(w,' Missing mandatory key "').concat(y,'"')),!1}return!0}))),b.reduce(function(y,_){return y&&_},!0)}function f(m){return d(m,u,"[Validate format]")}n.exports={validate:function(m,g){var w=h(m),S=f(g);return w&&S},validateFormat:f,validateInput:h,validateLanguage:function(m){return d(m,c,"[Validate language]")}}},{"./unformatting":9}]},{},[7])(7)})})(SH);var JJ=SH.exports;const Bl=JF(JJ),QJ="numeric";function yH(t,e){if(xn(t)){const r=e.numericFormat,n=r&&r.culture||"-",i=r&&r.pattern;if(typeof n<"u"&&!Bl.languages()[n]){const s=n.replace("-",""),o=Bl.allLanguages?Bl.allLanguages[n]:Bl[s];o&&Bl.registerLanguage(o)}Bl.setLanguage(n),t=Bl(t).format(i||"0")}return t}function gE(t,e,r,n,i,s,o){let a=s;if(xn(a)){const l=o.className||"",u=l.length?l.split(" "):[];a=yH(a,o),u.indexOf("htLeft")<0&&u.indexOf("htCenter")<0&&u.indexOf("htRight")<0&&u.indexOf("htJustify")<0&&u.push("htRight"),u.indexOf("htNumeric")<0&&u.push("htNumeric"),o.className=u.join(" "),e.dir="ltr"}ya(t,e,r,n,i,a,o)}gE.RENDERER_TYPE=QJ;const eQ="password";function mE(t,e,r,n,i,s,o){ya.apply(this,[t,e,r,n,i,s,o]);const a=o.hashLength||e.innerHTML.length,l=o.hashSymbol||"*";let u="";Ue(a-1,()=>{u+=l}),Xu(e,u)}mE.RENDERER_TYPE=eQ;const tQ="select";function pE(t,e,r,n,i,s,o){ya.apply(this,[t,e,r,n,i,s,o])}pE.RENDERER_TYPE=tQ;const rQ="time";function wE(t,e,r,n,i,s,o){ya.apply(this,[t,e,r,n,i,s,o]),e.dir="ltr"}wE.RENDERER_TYPE=rQ;function nQ(){di(Ih),di(_g),di(hE),di(cE),di(fE),di(uE),di(gE),di(mE),di(pE),di(ya),di(wE)}const iQ="autocomplete";function Sv(t,e){let r=t;if(r==null&&(r=""),this.allowEmpty&&r===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(r,JA(r,e)):JA(r,e)(this.source):e(!0)}Sv.VALIDATOR_TYPE=iQ;function JA(t,e){const r=t;return function(n){let i=!1;for(let s=0,o=n.length;s<o;s++)if(r===n[s]){i=!0;break}e(i)}}function bH(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const sQ=Object.freeze(Object.defineProperty({__proto__:null,getNormalizedDate:bH},Symbol.toStringTag,{value:"Module"})),oQ="date";function vE(t,e){const r=oD(fH,this.instance);let n=t,i=!0;n==null&&(n="");let s=Ce(n,this.dateFormat||r.defaultDateFormat,!0).isValid(),o=Ce(new Date(n)).isValid()||s;if(this.allowEmpty&&n===""&&(o=!0,s=!0),o||(i=!1),!o&&s&&(i=!0),o&&!s)if(this.correctFormat===!0){const a=aQ(n,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,a,"dateValidator"),i=!0}else i=!1;e(i)}vE.VALIDATOR_TYPE=oQ;function aQ(t,e){const r=Ce(bH(t)),n=Ce(t,e),i=t.search(/[A-z]/g)>-1;let s;return r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||i?s=r:s=n,s.format(e)}const lQ="dropdown";function CE(t,e){Sv.apply(this,[t,e])}CE.VALIDATOR_TYPE=lQ;const uQ="numeric";function SE(t,e){let r=t;r==null&&(r=""),this.allowEmpty&&r===""?e(!0):e(r===""?!1:xn(t))}SE.VALIDATOR_TYPE=uQ;const cQ=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],hQ="time";function yE(t,e){const r=this.timeFormat||"h:mm:ss a";let n=!0,i=t;i===null&&(i=""),i=/^\d{3,}$/.test(i)?parseInt(i,10):i;const s=/^\d{1,2}$/.test(i);s&&(i+=":00");const o=Ce(i,cQ,!0).isValid()?Ce(i):Ce(i,r);let a=o.isValid(),l=Ce(i,r,!0).isValid()&&!s;if(this.allowEmpty&&i===""&&(a=!0,l=!0),a||(n=!1),!a&&l&&(n=!0),a&&!l)if(this.correctFormat===!0){const u=o.format(r);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"timeValidator"),n=!0}else n=!1;e(n)}yE.VALIDATOR_TYPE=hQ;function dQ(){gu(Sv),gu(CE),gu(vE),gu(SE),gu(yE)}const fQ="autocomplete",gQ={CELL_TYPE:fQ,editor:oE,renderer:Ih,validator:Sv},mQ="checkbox",pQ={CELL_TYPE:mQ,editor:dH,renderer:hE},wQ="date";function xH(t,e,r,n,i,s,o){Ih.apply(this,[t,e,r,n,i,s,o])}xH.RENDERER_TYPE=wQ;const vQ="date",CQ={CELL_TYPE:vQ,editor:gH,renderer:xH,validator:vE},SQ="dropdown",yQ={CELL_TYPE:SQ,editor:lE,renderer:cE,validator:CE},bQ="handsontable",xQ={CELL_TYPE:bQ,editor:sE,renderer:fE},RQ="numeric",EQ={CELL_TYPE:RQ,editor:mH,renderer:gE,validator:SE,dataType:"number"},TQ="password",_Q={CELL_TYPE:TQ,editor:pH,renderer:mE,copyable:!1},AQ="select",MQ={CELL_TYPE:AQ,editor:wH,renderer:pE},OQ="time",IQ={CELL_TYPE:OQ,editor:vH,renderer:wE,validator:yE};function PQ(){Di(gQ),Di(pQ),Di(CQ),Di(yQ),Di(xQ),Di(EQ),Di(_Q),Di(MQ),Di(hH),Di(IQ)}function NQ(t,e){RH(t,e),e.add(t)}function DQ(t,e,r){RH(t,e),e.set(t,r)}function RH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pc(t,e,r){return(e=HQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function HQ(t){var e=kQ(t,"string");return typeof e=="symbol"?e:e+""}function kQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wc(t,e){return t.get(EH(t,e))}function EH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const QA=new Map([["plugin",B9],["cell-type",rH],["editor",sD],["renderer",fD],["validator",gD]]),FQ="base",cS=[];let Ws=null;var Vl=new WeakMap,eM=new WeakSet;class At{static get PLUGIN_KEY(){return FQ}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}constructor(e){NQ(this,eM),pc(this,"eventManager",new Xi(this)),pc(this,"pluginName",null),pc(this,"pluginsInitializedCallbacks",[]),pc(this,"isPluginsReady",!1),pc(this,"enabled",!1),pc(this,"initialized",!1),DQ(this,Vl,{}),To(this,"hot",e,{writable:!1}),Ws=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",r=>this.onUpdateSettings(r)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);const e=this.constructor.PLUGIN_DEPS,r=Array.isArray(e)?e:[];if(r.length>0){const i=[];if(r.forEach(s=>{const[o,a]=s.split(":");if(!QA.has(o))throw new Error(`Unknown plugin dependency type "${o}" was found.`);QA.get(o)(a)||i.push(` - ${a} (${o})`)}),i.length>0){const s=[`The ${this.pluginName} plugin requires the following modules:
`,`${i.join(`
`)}
`].join("");cS.push(s)}}if(Ws||(Ws=mx()),Ws.indexOf("UndoRedo")>=0&&Ws.splice(Ws.indexOf("UndoRedo"),1),Ws.indexOf(this.pluginName)>=0&&Ws.splice(Ws.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Ws.length===0){if(cS.length>0){const i=[`${cS.join(`
`)}
`,"You have to import and register them manually."].join("");throw new Error(i)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}addHook(e,r,n){wc(Vl,this)[e]=wc(Vl,this)[e]||[];const i=wc(Vl,this)[e];this.hot.addHook(e,r,n),i.push(r),wc(Vl,this)[e]=i}removeHooks(e){V(wc(Vl,this)[e]||[],r=>{this.hot.removeHook(e,r)})}clearHooks(){const e=wc(Vl,this);ct(e,(r,n)=>this.removeHooks(n)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){V(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const r=EH(eM,this,LQ).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&r&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),ct(this,(r,n)=>{n!=="hot"&&(this[n]=null)}),delete this.t,delete this.hot}}function LQ(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let r=0;r<e.length;r++)if(t[e[r]]!==void 0)return!0;return!1}function Wl(t,e,r){return(e=$Q(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $Q(t){var e=BQ(t,"string");return typeof e=="symbol"?e:e+""}function BQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let bE=class{constructor(e){Wl(this,"hot",null),Wl(this,"container",null),Wl(this,"injected",!1),Wl(this,"rows",[]),Wl(this,"columns",[]),Wl(this,"samples",null),Wl(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,r){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={row:e};this.rows.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}addColumnHeadersRow(e){const r=this.hot.getColHeader(0);if(r!=null){const n={row:-1};this.rows.push(n),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}}addColumn(e,r){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const n={col:e};this.columns.push(n),this.samples=r,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),n.table=this.table.table}getHeights(e){this.injected||this.injectTable(),V(this.rows,r=>{const{height:n}=r.table.getBoundingClientRect();e(r.row,Math.ceil(n)-1)})}getWidths(e){this.injected||this.injectTable(),V(this.columns,r=>{const{width:n}=r.table.getBoundingClientRect();e(r.col,Math.ceil(n))})}setSettings(e){this.settings=e}setSetting(e,r){this.settings||(this.settings={}),this.settings[e]=r}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const r=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&r.appendChild(this.createColElement(-1,-1)),this.samples.forEach(n=>{V(n.strings,i=>{r.appendChild(this.createColElement(i.col,e))})}),r}createRow(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,i),n.appendChild(i)),this.samples.forEach(s=>{V(s.strings,o=>{const a=o.col,l=this.hot.getCellMeta(e,a),u=this.hot.getCellRenderer(l),c=r.createElement("td");c.setAttribute("ghost-table",1),u(this.hot,c,e,a,this.hot.colToProp(a),o.value,l),n.appendChild(c)})}),n}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,r=e.createDocumentFragment(),n=[];if(this.hot.hasRowHeaders()){const i=e.createElement("th");n.push([-1,i]),r.appendChild(i)}this.samples.forEach(i=>{V(i.strings,s=>{const o=s.col,a=e.createElement("th");n.push([o,a]),r.appendChild(a)})}),this.table.tHead.appendChild(r),V(n,i=>{const[s,o]=i;this.hot.view.appendColHeader(s,o)})}createCol(e){const{rootDocument:r}=this.hot,n=r.createDocumentFragment();return this.samples.forEach(i=>{V(i.strings,s=>{const o=s.row,a=this.hot.getCellMeta(o,e),l=this.hot.getCellRenderer(a),u=r.createElement("td"),c=r.createElement("tr");u.setAttribute("ghost-table",1),l(this.hot,u,o,e,this.hot.colToProp(e),s.value,a),c.appendChild(u),n.appendChild(c)})}),n}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,r){const n=this.hot.rootDocument.createElement("col");let i=0;r>=0&&e>=0&&(i=this.hot.getCellMeta(r,e).colspan);let s=this.hot.getColWidth(e);if(i>1)for(let o=e+1;o<e+i;o++)s+=this.hot.getColWidth(o);return n.style.width=`${s}px`,n}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("table"),s=r.createElement("thead"),o=r.createElement("tbody"),a=r.createElement("colgroup"),l=r.createElement("tr"),u=r.createElement("th");return this.isVertical()&&i.appendChild(a),this.isHorizontal()&&(l.appendChild(u),s.appendChild(l),i.style.tableLayout="auto",i.style.width="auto"),i.appendChild(s),this.isVertical()&&o.appendChild(l),i.appendChild(o),ve(i,e),n.appendChild(i),{fragment:n,table:i,tHead:s,tBody:o,colGroup:a,tr:l,th:u}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:r}=this.hot,n=r.createDocumentFragment(),i=r.createElement("div"),s=`htGhostTable htAutoSize ${e.trim()}`;return ve(i,s),n.appendChild(i),{fragment:n,container:i}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function Vm(t,e,r){return(e=VQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function VQ(t){var e=WQ(t,"string");return typeof e=="symbol"?e:e+""}function WQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class yv{static get SAMPLE_COUNT(){return 3}constructor(e){Vm(this,"samples",null),Vm(this,"dataFactory",null),Vm(this,"customSampleCount",null),Vm(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:yv.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,r){return this.generateSamples("row",r,e)}generateColumnSamples(e,r){return this.generateSamples("col",r,e)}generateSamples(e,r,n){const i=new Map,{from:s,to:o}=typeof n=="number"?{from:n,to:n}:n;return Ue(s,o,a=>{const l=this.generateSample(e,r,a);i.set(a,l)}),i}generateSample(e,r,n){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const i=new Map,s=e==="row"?"col":"row",o=[];return Ue(r.from,r.to,a=>{const l=e==="row"?this.dataFactory(n,a):this.dataFactory(a,n);if(l===!1)return;const{value:u,bundleSeed:c}=l,h=typeof c=="string"&&c.length>0;let d;h?d=c:ut(u)?d=`${Object.keys(u).length}`:Array.isArray(u)?d=`${u.length}`:d=`${yr(u).length}`,i.has(d)||i.set(d,{needed:this.getSampleCount(),strings:[]});const f=i.get(d);f.needed&&(!(o.indexOf(u)>-1)||this.allowDuplicates||h)&&(f.strings.push({value:u,[s]:a}),o.push(u),f.needed-=1)}),i}}function UQ(t,e){TH(t,e),e.add(t)}function tM(t,e,r){TH(t,e),e.set(t,r)}function TH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fd(t,e,r){return(e=jQ(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jQ(t){var e=zQ(t,"string");return typeof e=="symbol"?e:e+""}function zQ(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cu(t,e){return t.get(oo(t,e))}function xE(t,e,r){return t.set(oo(t,e),r),r}function oo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("modifyAutoColumnSizeSeed");const gd="autoColumnSize",YQ=10,GQ="autoColumnSize";var zc=new WeakMap,Sh=new WeakMap,Uo=new WeakSet;class of extends At{static get PLUGIN_KEY(){return gd}static get PLUGIN_PRIORITY(){return YQ}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),UQ(this,Uo),fd(this,"ghostTable",new bE(this.hot)),fd(this,"samplesGenerator",new yv((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s))return!1;const o=this.hot.getCellMeta(r,n);let a="";o.spanned||(a=this.hot.getDataAtCell(r,n));let l="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(l=this.hot.runHooks("modifyAutoColumnSizeSeed",l,o,a)),{value:a,bundleSeed:l}})),fd(this,"inProgress",!1),fd(this,"measuredColumns",0),fd(this,"columnWidthsMap",new xl),tM(this,zc,[]),tM(this,Sh,[]),this.hot.columnIndexMapper.registerMap(GQ,this.columnWidthsMap),this.addHook("beforeColumnResize",(r,n,i)=>oo(Uo,this,rM).call(this,r,n,i))}isEnabled(){return this.hot.getSettings()[gd]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[gd];r&&r.useHeaders!==null&&r.useHeaders!==void 0&&this.ghostTable.setSetting("useHeaders",r.useHeaders),this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return oo(Uo,e,qQ).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return oo(Uo,e,ZQ).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return oo(Uo,e,QQ).call(e,...i)}),this.addHook("beforeRender",()=>oo(Uo,this,XQ).call(this)),this.addHook("modifyColWidth",(n,i)=>this.getColumnWidth(i,n)),this.addHook("init",()=>oo(Uo,this,JQ).call(this)),super.enablePlugin()}updatePlugin(){xE(Sh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,r,n)=>oo(Uo,this,rM).call(this,e,r,n))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),r=this.getLastVisibleColumn();if(e===-1||r===-1)return;const n=this.hot.renderCall;this.calculateColumnsWidth({from:e,to:r},void 0,n)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;Ue(i.from,i.to,o=>{let a=this.hot.toPhysicalColumn(o);a===null&&(a=o),(n||this.columnWidthsMap.getValueAtIndex(a)===null&&!this.hot._getColWidthFromSettings(a))&&this.samplesGenerator.generateColumnSamples(o,s).forEach((u,c)=>this.ghostTable.addColumn(c,u))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((o,a)=>{const l=this.hot.toPhysicalColumn(o);this.columnWidthsMap.setValueAtIndex(l,a)})},!0),this.measuredColumns=i.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countCols()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Ff(s),this.inProgress=!1;return}this.calculateColumnsWidth({from:n,to:Math.min(n+of.CALCULATION_STEP,i)},e,r),n=n+of.CALCULATION_STEP+1,n<i?s=ov(o):(Ff(s),this.inProgress=!1,this.hot.view.adjustElementsSize())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateColumnsWidth({from:0,to:a},e,r),n=a+1),n<i?o():this.inProgress=!1}setSamplingOptions(){const e=this.hot.getSettings()[gd],r=e&&gr(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&gr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[gd];let r=of.SYNC_CALCULATION_LIMIT;const n=this.hot.countCols()-1;return ut(e)&&(r=e.syncLimit,Ub(r)?r=fx(n,r):r>>=0),Math.min(r,n)}getColumnWidth(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=r;return i===void 0&&(i=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),n&&typeof i=="number"&&(i=Math.max(i,uv))),i}getFirstVisibleColumn(){var e;return(e=this.hot.view.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.view.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((n,i,s)=>{const o=Cu(zc,this).length;return(o-1<s||Cu(zc,this)[s]!==i)&&n.push(this.hot.toVisualColumn(s)),o-1<s?Cu(zc,this).push(i):Cu(zc,this)[s]=i,n},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.columnWidthsMap.setValueAtIndex(r,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function KQ(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(r=>{const n=this.hot.toPhysicalColumn(r);n!==null&&(this.hot._getColWidthFromSettings(n)||this.samplesGenerator.generateColumnSamples(r,e).forEach((s,o)=>this.ghostTable.addColumn(o,s)))}),this.ghostTable.columns.length&&(this.hot.batchExecution(()=>{this.ghostTable.getWidths((r,n)=>{const i=this.hot.toPhysicalColumn(r);this.columnWidthsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function XQ(){this.calculateVisibleColumnsWidth(),this.inProgress||(oo(Uo,this,KQ).call(this,Cu(Sh,this)),xE(Sh,this,[]))}function qQ(t,e){e||this.recalculateAllColumnsWidth()}function ZQ(t){const e=t.reduce((r,n)=>{let[,i]=n;const s=this.hot.propToCol(i);return Number.isInteger(s)&&r.indexOf(s)===-1&&r.push(s),r},[]);Cu(Sh,this).push(...e)}function rM(t,e,r){let n=t;return r&&(this.calculateColumnsWidth(e,void 0,!0),n=this.getColumnWidth(e,void 0,!1)),n}function JQ(){xE(zc,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth()}function QQ(t){const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.col;if(Number.isInteger(s)){const o=this.hot.toVisualColumn(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);Cu(Sh,this).push(...e)}const Su={horizontal:"horizontal",vertical:"vertical"};function eee(t,e,r){let n,i,s;return e[0]===t[0]&&e[1]<t[1]?(s="left",n=r(e[0],e[1]),i=r(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(s="right",n=r(e[0],t[3]+1),i=r(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(s="up",n=r(e[0],e[1]),i=r(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(s="down",n=r(t[2]+1,e[1]),i=r(e[2],e[3])),n&&n.normalize(),i&&i.normalize(),{directionOfDrag:s,startOfDragCoords:n,endOfDragCoords:i}}function tee(t){const e={};return t===!0?(e.directions=Object.keys(Su),e.autoInsertRow=!0):ut(t)?(ke(t.autoInsertRow)?t.direction===Su.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,ke(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(Su)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function ree(t,e){nee(t,e),e.add(t)}function nee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vc(t,e,r){return(e=iee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function iee(t){var e=see(t,"string");return typeof e=="symbol"?e:e+""}function see(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function md(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("modifyAutofillRange");He.getSingleton().register("beforeAutofill");He.getSingleton().register("afterAutofill");const nM="autofill",oee=20,aee=["fillHandle"],lee="insert_row_below",uee=200;var Cc=new WeakSet;class cee extends At{constructor(){super(...arguments),ree(this,Cc),vc(this,"addingStarted",!1),vc(this,"mouseDownOnCellCorner",!1),vc(this,"mouseDragOutside",!1),vc(this,"handleDraggedCells",0),vc(this,"directions",[]),vc(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return nM}static get PLUGIN_PRIORITY(){return oee}static get SETTING_KEYS(){return[nM,...aee]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>md(Cc,this,dee).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>md(Cc,this,hee).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,r)=>md(Cc,this,fee).call(this,r)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){const e=this.hot.getSelectedRangeLast(),{row:r,col:n}=e.getTopStartCorner(),{row:i,col:s}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:r,startCol:n,endRow:i,endCol:s}]),a=[],l=[],u=[];return V(o,c=>{for(let h=c.startRow;h<=c.endRow;h+=1)a.indexOf(h)===-1&&a.push(h);for(let h=c.startCol;h<=c.endCol;h+=1)l.indexOf(h)===-1&&l.push(h)}),V(a,c=>{const h=[];V(l,d=>{h.push(this.hot.getCopyableData(c,d))}),u.push(h)}),u}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,r,n,i]=this.hot.selection.highlight.getFill().getVisualCorners(),s=this.hot.getSelectedRangeLast(),o=s.getTopStartCorner(),a=s.getBottomEndCorner();this.resetSelectionOfDraggedArea();const l=[o.row,o.col,a.row,a.col],u=this.hot.runHooks("modifyAutofillRange",[Math.min(o.row,e),Math.min(o.col,r),Math.max(a.row,n),Math.max(a.col,i)],l),{directionOfDrag:c,startOfDragCoords:h,endOfDragCoords:d}=eee(l,u,(f,m)=>this.hot._createCellCoords(f,m));if(h&&h.row>-1&&h.col>-1){const f=this.getSelectionData(),m=s.clone(),g=this.hot._createCellRange(h,h,d),w=this.hot.runHooks("beforeAutofill",f,m,g,c);if(w===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let S=w;const b=w;if(["up","left"].indexOf(c)>-1&&!(b.length===1&&b[0].length===0))if(S=[],c==="up"){const y=d.row-h.row+1,_=y%b.length;for(let P=0;P<y;P++)S.push(b[(P+(b.length-_))%b.length])}else{const y=d.col-h.col+1,_=y%b[0].length;for(let P=0;P<b.length;P++){S.push([]);for(let z=0;z<y;z++)S[P].push(b[P][(z+(b[P].length-_))%b[P].length])}}this.hot.populateFromArray(h.row,h.col,S,d.row,d.col,`${this.pluginName}.fill`,null),this.setSelection(u),this.hot.runHooks("afterAutofill",S,m,g,c),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const r=this.hot.getSelectedRangeLast(),n=r.getBottomEndCorner();let i=e;if(this.directions.includes(Su.vertical)&&this.directions.includes(Su.horizontal)){const s=r.getTopStartCorner();(n.col<=e.col||s.col>=e.col)&&(i=this.hot._createCellCoords(n.row,e.col)),(n.row<e.row||s.row>e.row)&&(i=this.hot._createCellCoords(e.row,n.col))}else if(this.directions.includes(Su.vertical))i=this.hot._createCellCoords(e.row,n.col);else if(this.directions.includes(Su.horizontal))i=this.hot._createCellCoords(n.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(i)}showBorder(e){const r=this.getCoordsOfDragAndDropBorders(e);r&&this.redrawBorders(r)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(lee,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},uee)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),r=this.hot.selection.highlight.getFill().getVisualCorners(),n=this.hot.countRows();e[2]<n-1&&r[2]===n-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const r=this.hot.getData(),n=this.hot.countRows();let i;for(let s=e[2]+1;s<n;s++){for(let l=e[1];l<=e[3];l++){const u=r[s][l];if(!br(u))return-1}const o=r[s][e[1]-1],a=r[s][e[3]+1];(!br(o)||!br(a))&&(i=s)}return i}addSelectionFromStartAreaToSpecificRowIndex(e,r){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(r,e[3])).commit()}setSelection(e){this.hot.selectCell(...St(e,r=>Math.max(r,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),r=this.getIndexOfLastAdjacentFilledInRow(e);return r===-1||r===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,r),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:r}=this.hot.rootDocument,n=Kr(this.hot.table).top-(this.hot.rootWindow.pageYOffset||r.scrollTop)+Ar(this.hot.table),i=Kr(this.hot.table).left-(this.hot.rootWindow.pageXOffset||r.scrollLeft)+tr(this.hot.table);return e.clientY>n&&e.clientX<=i}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>md(Cc,this,gee).call(this)),this.eventManager.addEventListener(e,"mousemove",r=>md(Cc,this,mee).call(this,r))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=tee(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function hee(){this.selectAdjacent()&&this.fillIn()}function dee(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function fee(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function gee(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function mee(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function pee(t,e){_H(t,e),e.add(t)}function wee(t,e,r){_H(t,e),e.set(t,r)}function _H(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sc(t,e,r){return(e=vee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vee(t){var e=Cee(t,"string");return typeof e=="symbol"?e:e+""}function Cee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function See(t,e,r){return t.set(ao(t,e),r),r}function RE(t,e){return t.get(ao(t,e))}function ao(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Wm="autoRowSize",yee=40,bee="autoRowSize";var Wf=new WeakMap,jo=new WeakSet;class af extends At{static get PLUGIN_KEY(){return Wm}static get PLUGIN_PRIORITY(){return yee}static get SETTING_KEYS(){return!0}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),pee(this,jo),Sc(this,"headerHeight",null),Sc(this,"ghostTable",new bE(this.hot)),Sc(this,"samplesGenerator",new yv((r,n)=>{const i=this.hot.toPhysicalRow(r),s=this.hot.toPhysicalColumn(n);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(s)||r>=0&&n>=0&&this.hot.getCellMeta(r,n).hidden)return!1;let o;return r>=0?o=this.hot.getDataAtCell(r,n):r===-1&&(o=this.hot.getColHeader(n)),{value:o}})),Sc(this,"inProgress",!1),Sc(this,"measuredRows",0),Sc(this,"rowHeightsMap",new xl),wee(this,Wf,[]),this.hot.rowIndexMapper.registerMap(bee,this.rowHeightsMap),this.addHook("beforeRowResize",(r,n,i)=>ao(jo,this,iM).call(this,r,n,i))}isEnabled(){const e=this.hot.getSettings()[Wm];return e===!0||ut(e)}enablePlugin(){var e=this;this.enabled||(this.setSamplingOptions(),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ao(jo,e,Eee).call(e,...n)}),this.addHook("beforeChangeRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ao(jo,e,Tee).call(e,...n)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return ao(jo,e,Aee).call(e,...n)}),this.addHook("beforeRender",()=>ao(jo,this,Ree).call(this)),this.addHook("modifyRowHeight",(r,n)=>this.getRowHeight(n,r)),this.addHook("init",()=>ao(jo,this,_ee).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin())}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,r,n)=>ao(jo,this,iM).call(this,e,r,n))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),r=this.getLastVisibleRow();if(e===-1||r===-1)return;const n=this.hot.renderCall;this.calculateRowsHeight({from:e,to:r},void 0,n)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=typeof e=="number"?{from:e,to:e}:e,s=typeof r=="number"?{from:r,to:r}:r;if(this.hot.getColHeader(0)!==null){const o=this.samplesGenerator.generateRowSamples(-1,s);this.ghostTable.addColumnHeadersRow(o.get(-1))}Ue(i.from,i.to,o=>{let a=this.hot.toPhysicalRow(o);a===null&&(a=o),(n||this.rowHeightsMap.getValueAtIndex(a)===null)&&this.samplesGenerator.generateRowSamples(o,s).forEach((u,c)=>this.ghostTable.addRow(c,u))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((o,a)=>{o<0?this.headerHeight=a:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(o),a)})},!0),this.measuredRows=i.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=0;const i=this.hot.countRows()-1;let s=null;this.inProgress=!0;const o=()=>{if(!this.hot){Ff(s),this.inProgress=!1;return}this.calculateRowsHeight({from:n,to:Math.min(n+af.CALCULATION_STEP,i)},e,r),n=n+af.CALCULATION_STEP+1,n<i?s=ov(o):(Ff(s),this.inProgress=!1,this.hot.view.adjustElementsSize(),this.hot.view._wt.wtOverlays.inlineStartOverlay.needFullRender&&this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.draw())},a=this.getSyncCalculationLimit();a>=0&&(this.calculateRowsHeight({from:0,to:a},e,r),n=a+1),n<i?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}setSamplingOptions(){const e=this.hot.getSettings()[Wm],r=e&&gr(e,"samplingRatio")?e.samplingRatio:void 0,n=e&&gr(e,"allowSampleDuplicates")?e.allowSampleDuplicates:void 0;r&&!isNaN(r)&&this.samplesGenerator.setSampleCount(parseInt(r,10)),n&&this.samplesGenerator.setAllowDuplicates(n)}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[Wm];let r=af.SYNC_CALCULATION_LIMIT;const n=this.hot.countRows()-1;return ut(e)&&(r=e.syncLimit,Ub(r)?r=fx(n,r):r>>=0),Math.min(r,n)}getRowHeight(e,r){const n=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e));let i=r;return n!==null&&n>(r||0)&&(i=n),i}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.view.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.view.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:r,to:n}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{Ue(Math.min(r,n),Math.max(r,n),i=>{this.rowHeightsMap.setValueAtIndex(i,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function xee(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(r=>{this.samplesGenerator.generateRowSamples(r,e).forEach((i,s)=>this.ghostTable.addRow(s,i))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((r,n)=>{const i=this.hot.toPhysicalRow(r);this.rowHeightsMap.setValueAtIndex(i,n)})},!0),this.ghostTable.clean())}function Ree(){this.calculateVisibleRowsHeight(),this.inProgress||(ao(jo,this,xee).call(this,RE(Wf,this)),See(Wf,this,[]))}function iM(t,e,r){let n=t;return r&&(this.calculateRowsHeight(e,void 0,!0),n=this.getRowHeight(e)),n}function Eee(t,e){e||this.recalculateAllRowsHeight()}function Tee(t){const e=t.reduce((r,n)=>{let[i]=n;return r.indexOf(i)===-1&&r.push(i),r},[]);RE(Wf,this).push(...e)}function _ee(){this.recalculateAllRowsHeight()}function Aee(t){const e=t.reduce((r,n)=>{var i;const s=(i=n.address)===null||i===void 0?void 0:i.row;if(Number.isInteger(s)){const o=this.hot.toVisualRow(s);r.indexOf(o)===-1&&r.push(o)}return r},[]);RE(Wf,this).push(...e)}const{getListWithInsertedItems:Mee,getListWithRemovedItems:Oee}=LD("physicallyIndexed");class Iee extends qu{constructor(){super(e=>e)}insert(e,r){const n=Bx(this.indexedValues,r);this.indexedValues=Mee(n,e,r,this.initValueOrFn),super.insert(e,r)}remove(e){const r=Oee(this.indexedValues,e);this.indexedValues=$x(r,e),super.remove(e)}}const{getListWithInsertedItems:Pee,getListWithRemovedItems:Nee}=LD("physicallyIndexed");class Dee extends qu{constructor(){super(e=>e)}insert(e,r){this.indexedValues=Pee(this.indexedValues,e,r,(n,i)=>this.getNextValue(i)),super.insert(e,r)}remove(e){this.indexedValues=Nee(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function Hee(t,e){kee(t,e),e.add(t)}function kee(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Fee(t,e,r){return(e=Lee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Lee(t){var e=$ee(t,"string");return typeof e=="symbol"?e:e+""}function $ee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bee(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const hS="bindRowsWithHeaders",Vee=210,Wee="loose",Uee=new Map([["loose",Iee],["strict",Dee]]);var sM=new WeakSet;class jee extends At{constructor(){super(...arguments),Hee(this,sM),Fee(this,"headerIndexes",null)}static get PLUGIN_KEY(){return hS}static get PLUGIN_PRIORITY(){return Vee}isEnabled(){return!!this.hot.getSettings()[hS]}enablePlugin(){if(this.enabled)return;let e=this.hot.getSettings()[hS];typeof e!="string"&&(e=Wee);const r=Uee.get(e);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new r),this.addHook("modifyRowHeader",n=>Bee(sM,this,zee).call(this,n)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function zee(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Yee(t,e){AH(t,e),e.add(t)}function Gee(t,e,r){AH(t,e),e.set(t,r)}function AH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oM(t,e,r){return(e=Kee(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kee(t){var e=Xee(t,"string");return typeof e=="symbol"?e:e+""}function Xee(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function aM(t,e){return t.get(Qc(t,e))}function dS(t,e,r){return t.set(Qc(t,e),r),r}function Qc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const n0="collapsibleColumns",qee=290,Zee=["nestedHeaders"],ah="collapsibleIndicator",lM=n0,uM=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var yc=new WeakMap,pd=new WeakSet;class Jee extends At{constructor(){super(...arguments),Yee(this,pd),oM(this,"nestedHeadersPlugin",null),oM(this,"headerStateManager",null),Gee(this,yc,null)}static get PLUGIN_KEY(){return n0}static get PLUGIN_PRIORITY(){return qee}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[n0,...Zee]}isEnabled(){return!!this.hot.getSettings()[n0]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();r||kt("You need to configure the Nested Headers plugin in order to use collapsible headers."),dS(yc,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>Qc(pd,this,tte).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Qc(pd,e,rte).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Qc(pd,e,Qee).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(n,i,s)=>Qc(pd,this,ete).call(this,n,i,s)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(r=>({collapsible:r.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),dS(yc,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:r,col:n}=this.hot.getSelectedRangeLast().highlight,{collapsible:i,isCollapsed:s,columnIndex:o}=(e=this.headerStateManager.getHeaderTreeNodeData(r,n))!==null&&e!==void 0?e:{};if(i)return s?this.expandSection({row:r,col:o}):this.collapseSection({row:r,col:o}),!1},runOnlyIf:()=>{var e,r;return((e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.isSingle())&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.highlight.isHeader())},group:lM,relativeToGroup:Rl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(lM)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,r=this.hot.view._wt.wtTable.THEAD,n=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,s=function(o){o&&o.parentNode.removeChild(o)};Ue(0,e-1,o=>{const a=r.childNodes[o],l=n.childNodes[o],u=i?i.childNodes[o]:null;Ue(0,a.childNodes.length-1,c=>{let h=a.childNodes[c].querySelector(`.${ah}`);s(h),l&&l.childNodes[c]&&(h=l.childNodes[c].querySelector(`.${ah}`),s(h)),i&&u&&u.childNodes[c]&&(h=u.childNodes[c].querySelector(`.${ah}`),s(h))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const r=this.headerStateManager.mapNodes(n=>{const{collapsible:i,origColspan:s,headerLevel:o,columnIndex:a,isCollapsed:l}=n;if(i===!0&&s>1&&(l&&e==="expand"||!l&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(o),col:a}});this.toggleCollapsibleSection(r,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,r){if(!uM.has(r))throw new Error(`Unsupported action is passed (${r}).`);if(!Array.isArray(e))return;const n=ha(e,f=>{let{row:m}=f;return m<0});let i=n.length>0;V(n,f=>{var m;let{row:g,col:w}=f;const{collapsible:S,isCollapsed:b}=(m=this.headerStateManager.getHeaderSettings(g,w))!==null&&m!==void 0?m:{};if(!S||b&&r==="collapse"||!b&&r==="expand")return i=!1,!1});const s=[],o=[];i&&V(n,f=>{let{row:m,col:g}=f;const{colspanCompensation:w,affectedColumns:S,rollbackModification:b}=this.headerStateManager.triggerNodeModification(r,m,g);w>0&&(o.push(...S),s.push(b))});const a=this.getCollapsedColumns();let l=[];r==="collapse"?l=Vb([...a,...o]):r==="expand"&&(l=ha(a,f=>!o.includes(f)));const u=uM.get(r);if(this.hot.runHooks(u.beforeHook,a,l,i)===!1){V(s,f=>{f()});return}this.hot.batchExecution(()=>{V(o,f=>{aM(yc,this).setValueAtIndex(this.hot.toPhysicalColumn(f),u.hideColumn)})},!0);const h=this.getCollapsedColumns().length!==a.length,d=this.hot.getSelectedRangeLast();if(r==="collapse"&&h&&d){const{row:f,col:m}=d.highlight;if((this.hot.rowIndexMapper.isHidden(f)||this.hot.columnIndexMapper.isHidden(m))&&o.includes(m)){const w=f>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0):f,S=m>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(m,1,!0):m;w!==null&&S!==null&&this.hot.selectCell(w,S)}}this.hot.runHooks(u.afterHook,a,l,i,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return aM(yc,this).getHiddenIndexes()}destroy(){dS(yc,this,null),super.destroy()}}function Qee(t,e,r){var n;const{collapsible:i,origColspan:s,isCollapsed:o}=(n=this.headerStateManager.getHeaderSettings(r,t))!==null&&n!==void 0?n:{},a=i&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,l=this.hot.getSettings().ariaTags;let u=e.querySelector(`.${ah}`);if(Ku(e,[Yi("")[0]]),a)u||(u=this.hot.rootDocument.createElement("div"),ve(u,ah),e.querySelector("div:first-child").appendChild(u)),tt(u,["collapsed","expanded"]),o?(ve(u,"collapsed"),gl(u,"+"),l&&qe(e,...Yi(!1))):(ve(u,"expanded"),gl(u,"-"),l&&qe(e,...Yi(!0))),l&&qe(u,...Gu());else{var c;(c=u)===null||c===void 0||c.remove()}}function ete(t,e){Qe(t.target,ah)&&(Qe(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Qe(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),Ji(t))}function tte(){this.updatePlugin()}function rte(t,e){e||this.updatePlugin()}function Ul(t,e,r){return(e=nte(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function nte(t){var e=ite(t,"string");return typeof e=="symbol"?e:e+""}function ite(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ste=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],ote=!1,ate=!0,lte=!0;class ute{constructor(e,r){Ul(this,"hot",void 0),Ul(this,"sortingStates",new gv),Ul(this,"sortEmptyCells",ote),Ul(this,"indicator",ate),Ul(this,"headerAction",lte),Ul(this,"compareFunctionFactory",void 0),Ul(this,"mapName",void 0),this.hot=e,this.mapName=r,this.hot.columnIndexMapper.registerMap(r,this.sortingStates)}updateAllColumnsProperties(e){ut(e)&&ct(e,(r,n)=>{ste.includes(n)&&(this[n]=r)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var r;return(r=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||r===void 0?void 0:r.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(r=>{let[n]=r;return n===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return ut(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(r=>{let[n,i]=r;return{column:this.hot.toVisualColumn(n),...i}})}getColumnSortState(e){const r=this.getSortOrderOfColumn(e);if(ke(r))return{column:e,sortOrder:r}}setSortStates(e){this.sortingStates.clear();for(let r=0;r<e.length;r+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[r].column),{sortOrder:e[r].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function MH(t,e,r){const n=e.locale;return function(i,s){const{sortEmptyCells:o}=r;return typeof i=="string"&&(i=i.toLocaleLowerCase(n)),typeof s=="string"&&(s=s.toLocaleLowerCase(n)),i===s?po:br(i)?br(s)?po:o&&t==="asc"?Cr:Sr:br(s)?o&&t==="asc"?Sr:Cr:isNaN(i)&&!isNaN(s)?t==="asc"?Sr:Cr:!isNaN(i)&&isNaN(s)||(isNaN(i)||isNaN(s)||(i=parseFloat(i),s=parseFloat(s)),i<s)?t==="asc"?Cr:Sr:i>s?t==="asc"?Sr:Cr:po}}const OH="default";function cte(t,e,r){return function(n,i){const s=parseFloat(n),o=parseFloat(i),{sortEmptyCells:a}=r;if(s===o||isNaN(s)&&isNaN(o))return po;if(a){if(br(n))return t==="asc"?Cr:Sr;if(br(i))return t==="asc"?Sr:Cr}return isNaN(s)?Sr:isNaN(o)?Cr:s<o?t==="asc"?Cr:Sr:s>o?t==="asc"?Sr:Cr:po}}const hte="numeric";function dte(t,e,r){const n=e.checkedTemplate,i=e.uncheckedTemplate,{sortEmptyCells:s}=r;return function(o,a){const l=br(o),u=br(a),c=l?i:o,h=u?i:a,d=c===i||c===n,f=h===i||h===n;if(s===!1){if(l&&u===!1)return Sr;if(l===!1&&u)return Cr}return d===!1&&f?t==="asc"?Cr:Sr:d&&f===!1?t==="asc"?Sr:Cr:d===!1&&f===!1?MH(t,e,r)(o,a):c===i&&h===n?t==="asc"?Cr:Sr:c===n&&h===i?t==="asc"?Sr:Cr:po}}const fte="checkbox";function gte(t,e,r){return kH(t,e.dateFormat,r)}const mte="date";function pte(t,e,r){return kH(t,e.timeFormat,r)}const wte="time",{register:Ag,getItem:cM,hasItem:vte}=Ds("sorting.compareFunctionFactory"),{register:IH,getItem:Cte}=Ds("sorting.mainSortComparator");function PH(t){return vte(t)?cM(t):cM(OH)}Ag(fte,dte);Ag(mte,gte);Ag(OH,MH);Ag(hte,cte);Ag(wte,pte);const po=0,Cr=-1,Sr=1;function Ste(t,e){const r=Cte(e);for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];t.sort(r(...i))}const U0="asc",j0="desc",NH="colHeader";function yte(t){if(ut(t)===!1)return!1;const{column:e,sortOrder:r}=t;return Number.isInteger(e)&&[U0,j0].includes(r)}function bte(t){if(t.some(r=>yte(r)===!1))return!1;const e=t.map(r=>{let{column:n}=r;return n});return new Set(e).size===e.length}function hM(t){if(t!==j0)return t===U0?j0:U0}function DH(t){return t.querySelector(`.${NH}`)}function HH(t,e){if(t<0||!e.parentNode)return!1;const r=e.parentNode.parentNode.childNodes;return Array.from(r).indexOf(e.parentNode)-r.length===-1}function EE(t,e,r){return t===-1&&e>=0&&ml(r)===!1}function kH(t,e,r){return function(n,i){const{sortEmptyCells:s}=r;if(n===i)return po;if(br(n))return br(i)?po:s&&t==="asc"?Cr:Sr;if(br(i))return s&&t==="asc"?Sr:Cr;const o=Ce(n,e),a=Ce(i,e);return o.isValid()?a.isValid()?a.isAfter(o)?t==="asc"?Cr:Sr:a.isBefore(o)?t==="asc"?Sr:Cr:po:Cr:Sr}}const xte="ascending",Rte="descending",FH="indicatorDisabled",LH="columnSorting",$H="sortAction",BH=new Map([[U0,xte],[j0,Rte]]);function Ete(t,e,r,n){const i=[LH];if(n&&i.push($H),r===!1)return i.push(FH),i;const s=t.getSortOrderOfColumn(e);return ke(s)&&i.push(BH.get(s)),i}function Tte(){return Array.from(BH.values()).concat($H,FH,LH)}function _te(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function(a){const l=t[a],u=e[a],c=i[a],h=s[a],d=u.columnSorting;return(d.compareFunctionFactory?d.compareFunctionFactory:PH(u.type))(l,u,d)(c,h)}(0)}}function Ate(t,e){Mte(t,e),e.add(t)}function Mte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Um(t,e,r){return(e=Ote(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ote(t){var e=Ite(t,"string");return typeof e=="symbol"?e:e+""}function Ite(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yc(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const z0="columnSorting",Pte=50,Y0="append",Nte="replace",dM=z0;IH(z0,_te);He.getSingleton().register("beforeColumnSort");He.getSingleton().register("afterColumnSort");var du=new WeakSet;class VH extends At{constructor(){super(...arguments),Ate(this,du),Um(this,"columnStatesManager",null),Um(this,"columnMetaCache",null),Um(this,"pluginKey",z0),Um(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return z0}static get PLUGIN_PRIORITY(){return Pte}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;this.enabled||(this.columnStatesManager=new ute(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new xl(r=>{let n=this.hot.toVisualColumn(r);return n===null&&(n=r),this.getMergedPluginSettings(n)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(r,n)=>Yc(du,this,Dte).call(this,r,n)),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yc(du,e,kte).call(e,...n)}),this.addHook("afterOnCellMouseDown",(r,n)=>this.onAfterOnCellMouseDown(r,n)),this.addHook("afterInit",()=>Yc(du,this,A1).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yc(du,e,Hte).call(e,...n)}),this.hot.view&&Yc(du,this,A1).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(r,n)=>{const i=DH(n);HH(r,n)===!1||i===null||this.updateHeaderClasses(i)};this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.row===-1&&n.col>=0},relativeToGroup:Rl,position:"before",group:dM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dM)}sort(e){const r=this.getSortConfig(),n=this.getNormalizedSortConfigs(e),i=this.areValidSortConfigs(n);this.hot.runHooks("beforeColumnSort",r,n,i)!==!1&&(r.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new $D),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),i&&(this.columnStatesManager.setSortStates(n),this.sortByPresetSortStates(n),this.saveAllSortSettings(n)),this.hot.runHooks("afterColumnSort",r,i?n:r,i),i&&(this.hot.render(),this.hot.forceFullRender=!1,this.hot.view.render()))}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return ke(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const r=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(r)&&this.columnStatesManager.setSortStates(r)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const r=this.hot.countCols();return bte(e)&&e.every(n=>{let{column:i}=n;return i<=r&&i>=0})}saveAllSortSettings(e){const r=this.columnStatesManager.getAllColumnsProperties(),n=i=>{let{column:s,...o}=i;return{column:this.hot.toPhysicalColumn(s),...o}};r.initialConfig=St(e,n),this.hot.runHooks("persistentStateSave","columnSorting",r)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const r=e.value,n=i=>{let{column:s,...o}=i;return{column:this.hot.toVisualColumn(s),...o}};return ke(r)&&Array.isArray(r.initialConfig)&&(r.initialConfig=St(r.initialConfig,n)),r}getColumnNextConfig(e){const r=this.columnStatesManager.getSortOrderOfColumn(e);if(ke(r)){const i=hM(r);return ke(i)?{column:e,sortOrder:i}:void 0}const n=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<n)return{column:e,sortOrder:hM()}}getNextSortConfig(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y0;const n=this.columnStatesManager.getIndexOfColumnInSortQueue(e),i=n!==-1,s=this.getSortConfig(),o=this.getColumnNextConfig(e);if(i){if(er(o))return[...s.slice(0,n),...s.slice(n+1)];if(r===Y0)return[...s.slice(0,n),...s.slice(n+1),o];if(r===Nte)return[...s.slice(0,n),o,...s.slice(n+1)]}return ke(o)?s.concat(o):s}getPluginColumnConfig(e){if(ut(e)){const r=e[this.pluginKey];if(ut(r))return r}return{}}getMergedPluginSettings(e){const r=this.hot.getSettings()[this.pluginKey],n=this.columnStatesManager.getAllColumnsProperties(),i=this.hot.getCellMeta(0,e),s=Object.getPrototypeOf(i);return Array.isArray(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns[e])):Jt(s.columns)?Object.assign(n,r,this.getPluginColumnConfig(s.columns(e))):Object.assign(n,r)}getFirstCellSettings(e){const r=this.hot.getCellMeta(0,e),n=Object.create(r);return n[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),n}getNumberOfRowsToSort(e){const r=this.hot.getSettings();return r.maxRows<=e?r.maxRows:e-r.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const r=[],n=this.hot.countRows(),i=u=>St(e,c=>this.hot.getDataAtCell(u,c.column));for(let u=0;u<this.getNumberOfRowsToSort(n);u+=1)r.push([this.hot.toPhysicalRow(u)].concat(i(u)));const s=St(r,u=>u[0]);Ste(r,this.pluginKey,St(e,u=>u.sortOrder),St(e,u=>this.getFirstCellSettings(u.column)));for(let u=r.length;u<n;u+=1)r.push([u].concat(i(u)));const o=St(r,u=>u[0]),a=new Map(St(s,(u,c)=>[u,o[c]])),l=St(this.hot.rowIndexMapper.getIndexesSequence(),u=>a.has(u)?a.get(u):u);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if(ut(e)){this.columnStatesManager.updateAllColumnsProperties(e);const r=e.initialConfig;(Array.isArray(r)||ut(r))&&this.sort(r)}else this.hot.render()}updateHeaderClasses(e){if(tt(e,Tte()),this.enabled!==!1){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];ve(e,Ete(...n))}}onUpdateSettings(e){super.onUpdateSettings(),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),ke(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,r){return this.getFirstCellSettings(r)[this.pluginKey].headerAction&&Qe(e.target,NH)}onAfterOnCellMouseDown(e,r){if(EE(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(r.col));const n=this.hot.getActiveEditor(),i=this.getColumnNextConfig(r.col);n!=null&&n.isOpened()&&this.hot.getCellValidator(n.row,n.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function A1(){const t=this.getAllSavedSortSettings();if(ut(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Dte(t,e){const r=DH(e);if(HH(t,e)===!1||r===null)return;const n=this.getFirstCellSettings(t)[this.pluginKey],i=n.indicator,s=n.headerAction;if(this.updateHeaderClasses(r,this.columnStatesManager,t,i,s),this.hot.getSettings().ariaTags){const o=this.columnStatesManager.getSortOrderOfColumn(t);qe(e,...mz(o?`${o}ending`:"none"))}}function Hte(t){t===!0&&this.hot.view&&Yc(du,this,A1).call(this)}function kte(t,e,r,n){EE(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(n.column=!0)}function jl(t,e,r){return(e=Fte(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Fte(t){var e=Lte(t,"string");return typeof e=="symbol"?e:e+""}function Lte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class $te{constructor(e,r){jl(this,"plugin",void 0),jl(this,"hot",void 0),jl(this,"endpoints",[]),jl(this,"settings",void 0),jl(this,"settingsType","array"),jl(this,"currentEndpoint",null),jl(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=r}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const r=[];let n=e;if(!n&&typeof this.settings=="function"){this.settingsType="function";return}return n||(n=this.settings),V(n,i=>{const s={};this.assignSetting(i,s,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(i,s,"reversedRowCoords",!1),this.assignSetting(i,s,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(i,s,"sourceColumn",i.destinationColumn),this.assignSetting(i,s,"type","sum"),this.assignSetting(i,s,"forceNumeric",!1),this.assignSetting(i,s,"suppressDataTypeErrors",!0),this.assignSetting(i,s,"customFunction",null),this.assignSetting(i,s,"readOnly",!0),this.assignSetting(i,s,"roundFloat",!1),r.push(s)}),r}assignSetting(e,r,n,i){if(n==="ranges"&&e[n]===void 0){r[n]=i;return}else if(n==="ranges"&&e[n].length===0)return;if(e[n]===void 0){if(i instanceof Error)throw i;r[n]=i}else n==="destinationRow"&&r.reversedRowCoords?r[n]=this.hot.countRows()-e[n]-1:r[n]=e[n]}resetSetupBeforeStructureAlteration(e,r,n){if(this.settingsType!=="function")return;const i=e.indexOf("row")>-1?"row":"col",s=this.getAllEndpoints();V(s,o=>{i==="row"&&o.destinationRow>=r&&(e==="insert_row"?o.alterRowOffset=n:e==="remove_row"&&(o.alterRowOffset=-1*n)),i==="col"&&o.destinationColumn>=r&&(e==="insert_col"?o.alterColumnOffset=n:e==="remove_col"&&(o.alterColumnOffset=-1*n))}),this.resetAllEndpoints(s,!1)}resetSetupAfterStructureAlteration(e,r,n,i,s){let o=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const d=()=>(this.hot.removeHook("beforeViewRender",d),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",d);return}const a=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,u=this.getAllEndpoints(),c=e.indexOf("move_row")===0,h=r;V(u,d=>{a==="row"&&d.destinationRow>=h&&(d.alterRowOffset=l*n),a==="col"&&d.destinationColumn>=h&&(d.alterColumnOffset=l*n)}),this.resetAllEndpoints(u,!c),c?V(u,d=>{this.extendEndpointRanges(d,h,i[0],i.length),this.recreatePhysicalRanges(d),this.clearOffsetInformation(d)}):V(u,d=>{this.shiftEndpointCoordinates(d,h)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,r,n,i){V(e.ranges,s=>{s[1]&&(r>=s[0]&&r<=s[1]?n>s[1]?s[1]+=i:n<s[0]&&(s[0]-=i):n>=s[0]&&n<=s[1]&&(s[1]-=i,r<=s[0]&&(s[0]+=1,s[1]+=1)))})}recreatePhysicalRanges(e){const r=e.ranges,n=[],i=[];V(r,s=>{const o=[];if(s[1])for(let a=s[0];a<=s[1];a++)o.push(this.hot.toPhysicalRow(a));else o.push(this.hot.toPhysicalRow(s[0]));i.push(o)}),V(i,s=>{let o=[];V(s,(a,l)=>{l===0?o.push(a):s[l]!==s[l-1]+1&&(o.push(s[l-1]),n.push(o),o=[],o.push(a)),l===s.length-1&&(o.push(a),n.push(o))})}),e.ranges=n}shiftEndpointCoordinates(e,r){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,V(e.ranges,n=>{V(n,(i,s)=>{i>=r&&(n[s]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(i=>{const s=i.alterRowOffset||0,o=i.alterColumnOffset||0;return i.destinationRow+s>=this.hot.countRows()||i.destinationColumn+o>=this.hot.countCols()})||(this.cellsToSetCache=[],V(e,i=>{this.resetEndpointValue(i,r)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],V(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const r=[];this.cellsToSetCache=[],V(e,(n,i,s)=>{`${n[2]||""}`!=`${n[3]}`&&V(this.getAllEndpoints(),(o,a)=>{this.hot.propToCol(s[i][1])===o.sourceColumn&&r.indexOf(a)===-1&&r.push(a)})}),V(r,n=>{this.refreshEndpoint(this.getEndpoint(n))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const r=this.hot.toVisualRow(e.destinationRow);if(r!==null){const n=this.hot.getCellMeta(r,e.destinationColumn);n.readOnly=e.readOnly,n.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=e.alterRowOffset||0,i=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(r?n:0)),this.hot.toVisualColumn(e.destinationColumn+(r?i:0)),""])}setEndpointValue(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const s=this.hot.toVisualRow(e.destinationRow);if(s!==null){const o=this.hot.getCellMeta(s,e.destinationColumn);(r==="init"||o.readOnly!==e.readOnly)&&(o.readOnly=e.readOnly,o.className="columnSummaryResult")}if((e.roundFloat===!0||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){const o=e.roundFloat;let a=0;Number.isInteger(o)&&(a=Math.min(Math.max(0,o),100)),e.result=e.result.toFixed(a)}n?this.hot.setDataAtCell(i,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([i,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){kt("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function fS(t){return t==null||isNaN(t)}function Bte(t,e){Vte(t,e),e.add(t)}function Vte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wte(t,e,r){return(e=Ute(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ute(t){var e=jte(t,"string");return typeof e=="symbol"?e:e+""}function jte(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const gS="columnSummary",zte=220;var wd=new WeakSet;class Yte extends At{constructor(){super(...arguments),Bte(this,wd),Wte(this,"endpoints",null)}static get PLUGIN_KEY(){return gS}static get PLUGIN_PRIORITY(){return zte}isEnabled(){return!!this.hot.getSettings()[gS]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[gS],this.endpoints=new $te(this,this.settings),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jm(wd,e,Gte).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jm(wd,e,Xte).call(e,...n)}),this.addHook("afterUpdateSettings",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jm(wd,e,Kte).call(e,...n)}),this.addHook("beforeCreateRow",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",r,n,null,i)),this.addHook("beforeCreateCol",(r,n,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",r,n,null,i)),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...n)}),this.addHook("beforeRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...n)}),this.addHook("afterCreateRow",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",r,n,null,i)),this.addHook("afterCreateCol",(r,n,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",r,n,null,i)),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...n)}),this.addHook("afterRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return jm(wd,e,qte).call(e,...n)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let r=0;return ct(e.ranges,n=>{r+=this.getPartialSum(n,e.sourceColumn)}),r}getPartialSum(e,r){let n=0,i=e[1]||e[0],s=null,o=0;do{if(s=this.getCellValue(i,r),s=fS(s)?null:s,s!==null){const a=(`${s}`.split(".")[1]||[]).length||1;a>o&&(o=a)}n+=s||0,i-=1}while(i>=e[0]);return Math.round(n*10**o)/10**o}calculateMinMax(e,r){let n=null;return ct(e.ranges,i=>{const s=this.getPartialMinMax(i,e.sourceColumn,r);if(n===null&&s!==null&&(n=s),s!==null)switch(r){case"min":n=Math.min(n,s);break;case"max":n=Math.max(n,s);break}}),n===null?"Not enough data":n}getPartialMinMax(e,r,n){let i=null,s=e[1]||e[0],o;do{if(o=this.getCellValue(s,r),o=fS(o)?null:o,i===null)i=o;else if(o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}s-=1}while(s>=e[0]);return i}countEmpty(e,r){let n,i=0,s=e[1]||e[0];do n=this.getCellValue(s,r),n=fS(n)?null:n,n===null&&(i+=1),s-=1;while(s>=e[0]);return i}countEntries(e){let r=0;const n=e.ranges;return ct(n,i=>{const s=i[1]===void 0?1:i[1]-i[0]+1,o=this.countEmpty(i,e.sourceColumn);r+=s,r-=o}),r}calculateAverage(e){const r=this.calculateSum(e),n=this.countEntries(e);return r/n}getCellValue(e,r){const n=this.hot.toVisualRow(e),i=this.hot.toVisualColumn(r);let s=this.hot.getSourceDataAtCell(e,r),o="";if(n!==null&&i!==null&&(o=this.hot.getCellMeta(n,i).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof s=="string"&&(s=s.replace(/,/,".")),s=parseFloat(s)),isNaN(s)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ft`ColumnSummary plugin: cell at (${e}, ${r}) is not in a\x20
          numeric format. Cannot do the calculation.`);return s}}function Gte(){this.endpoints.initEndpoints()}function Kte(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function Xte(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function qte(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function Zte(t,e){WH(t,e),e.add(t)}function mS(t,e,r){WH(t,e),e.set(t,r)}function WH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gc(t,e){return t.get(TE(t,e))}function M1(t,e,r){return t.set(TE(t,e),r),r}function TE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var G0=new WeakMap,zm=new WeakMap,Ym=new WeakMap,fM=new WeakSet;class UH{constructor(){Zte(this,fM),mS(this,G0,!0),mS(this,zm,null),mS(this,Ym,new ResizeObserver(e=>TE(fM,this,Jte).call(this,e)))}setObservedElement(e){M1(zm,this,e)}unobserve(){Gc(Ym,this).unobserve(Gc(zm,this))}observe(){M1(G0,this,!0),Gc(Ym,this).observe(Gc(zm,this))}destroy(){Gc(Ym,this).disconnect()}}function Jte(t){if(Gc(G0,this)||!Array.isArray(t)||!t.length){M1(G0,this,!1);return}t.forEach(e=>{let{borderBoxSize:r}=e;const{inlineSize:n,blockSize:i}=r[0];this.runLocalHooks("resize",n,i)})}Lt(UH,wn);function zl(t,e,r){Qte(t,e),e.set(t,r)}function Qte(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Yt(t,e){return t.get(jH(t,e))}function Lo(t,e,r){return t.set(jH(t,e),r),r}function jH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Yl=new WeakMap,pS=new WeakMap,$o=new WeakMap,Gl=new WeakMap,Aa=new WeakMap,Gm=new WeakMap,bc=new WeakMap;class yu{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,r){var n=this;zl(this,Yl,void 0),zl(this,pS,!1),zl(this,$o,null),zl(this,Gl,void 0),zl(this,Aa,void 0),zl(this,Gm,!0),zl(this,bc,new UH),Lo(Yl,this,e),Lo(pS,this,r),Lo(Gl,this,this.createEditor()),Lo(Aa,this,Yt(Gl,this).style),Yt(bc,this).setObservedElement(this.getInputElement()),Yt(bc,this).addLocalHook("resize",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.runLocalHooks("resize",...s)}),this.hide()}setPosition(e,r){Yt(Aa,this).left=`${e}px`,Yt(Aa,this).top=`${r}px`}setSize(e,r){if(e&&r){const n=this.getInputElement();n.style.width=`${e}px`,n.style.height=`${r}px`}}getSize(){return{width:tr(this.getInputElement()),height:Ar(this.getInputElement())}}observeSize(){Yt(bc,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const r=this.getInputElement();r.readOnly=e}show(){Yt(Aa,this).display="block",Lo(Gm,this,!1)}hide(){Yt(bc,this).unobserve(),Yt(Gm,this)||(Yt(Aa,this).display="none"),Lo(Gm,this,!0)}isVisible(){return Yt(Aa,this).display==="block"}setValue(){const r=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=r}getValue(){return this.getInputElement().value}isFocused(){return Yt(Yl,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=Yt(Yl,this).createElement("div"),r=Yt(Yl,this).createElement("textarea");return e.style.display="none",Lo($o,this,Yt(Yl,this).createElement("div")),Yt($o,this).setAttribute("dir",Yt(pS,this)?"rtl":"ltr"),ve(Yt($o,this),yu.CLASS_EDITOR_CONTAINER),Yt(Yl,this).body.appendChild(Yt($o,this)),ve(e,yu.CLASS_EDITOR),ve(r,yu.CLASS_INPUT),r.setAttribute("data-hot-input",!0),e.appendChild(r),Yt($o,this).appendChild(e),e}getInputElement(){return Yt(Gl,this).querySelector(`.${yu.CLASS_INPUT}`)}destroy(){const e=Yt($o,this)?Yt($o,this).parentNode:null;Yt(Gl,this).parentNode.removeChild(Yt(Gl,this)),Lo(Gl,this,null),Lo(Aa,this,null),Yt(bc,this).destroy(),e&&e.removeChild(Yt($o,this))}}Lt(yu,wn);function wS(t,e,r){return(e=ere(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ere(t){var e=tre(t,"string");return typeof e=="symbol"?e:e+""}function tre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const rre=250,nre=250;class zH{constructor(e){wS(this,"wasLastActionShow",!0),wS(this,"showDebounced",null),wS(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},nre)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rre;this.showDebounced=nv(r=>{this.wasLastActionShow&&this.runLocalHooks("show",r.from.row,r.from.col)},e)}destroy(){this.clearLocalHooks()}}Lt(zH,wn);function ire(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function sre(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Kl(t,e){const r={};return V(t,n=>{n.forAll((i,s)=>{i>=0&&s>=0&&(r[i]||(r[i]=[]),r[i][s]=e(i,s))})}),r}function Wa(t,e,r,n,i){V(t,s=>{s.forAll((o,a)=>{o>=0&&a>=0&&ore(o,a,e,r,n,i)})})}function ore(t,e,r,n,i,s){const o=i(t,e);let a=n;o.className&&(r==="vertical"?a=ire(o.className,n):a=sre(o.className,n)),s(t,e,"className",a)}function Go(t){return`<span class="selected">â</span>${t}`}function lf(t,e){let r=!1;return Array.isArray(t)&&V(t,n=>(n.forAll((i,s)=>{if(i>=0&&s>=0&&e(i,s))return r=!0,!1}),r)),r}function bv(t,e){const r={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:n}=e.defaultView,{top:i,left:s}=n.getBoundingClientRect();r.top=i,r.left=s}return r}function are(t){return function(e,r){const n=this.getCellMeta(e,r).className;return n&&n.indexOf(t)!==-1}}function Yn(t,e){return lf(t.getSelectedRange(),are(e).bind(t))}const ft="---------";function lre(){return{name:ft}}const Fi="alignment";function ure(){return{key:Fi,name(){return this.getTranslatedPhrase(hR)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${Fi}:left`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(N0)},ariaChecked(){return Yn(this,"htLeft")},name(){let t=this.getTranslatedPhrase(N0);return Yn(this,"htLeft")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Kl(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htLeft";this.runHooks("beforeCellAlignment",e,t,r,n),Wa(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Fi}:center`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(D0)},ariaChecked(){return Yn(this,"htCenter")},name(){let t=this.getTranslatedPhrase(D0);return Yn(this,"htCenter")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Kl(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htCenter";this.runHooks("beforeCellAlignment",e,t,r,n),Wa(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Fi}:right`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(H0)},ariaChecked(){return Yn(this,"htRight")},name(){let t=this.getTranslatedPhrase(H0);return Yn(this,"htRight")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Kl(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htRight";this.runHooks("beforeCellAlignment",e,t,r,n),Wa(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Fi}:justify`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(k0)},ariaChecked(){return Yn(this,"htJustify")},name(){let t=this.getTranslatedPhrase(k0);return Yn(this,"htJustify")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Kl(t,(i,s)=>this.getCellMeta(i,s).className),r="horizontal",n="htJustify";this.runHooks("beforeCellAlignment",e,t,r,n),Wa(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{name:ft},{key:`${Fi}:top`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(F0)},ariaChecked(){return Yn(this,"htTop")},name(){let t=this.getTranslatedPhrase(F0);return Yn(this,"htTop")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Kl(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htTop";this.runHooks("beforeCellAlignment",e,t,r,n),Wa(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Fi}:middle`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase(L0)},ariaChecked(){return Yn(this,"htMiddle")},name(){let t=this.getTranslatedPhrase(L0);return Yn(this,"htMiddle")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Kl(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htMiddle";this.runHooks("beforeCellAlignment",e,t,r,n),Wa(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1},{key:`${Fi}:bottom`,checkable:!0,ariaLabel(){return this.getTranslatedPhrase($0)},ariaChecked(){return Yn(this,"htBottom")},name(){let t=this.getTranslatedPhrase($0);return Yn(this,"htBottom")&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=Kl(t,(i,s)=>this.getCellMeta(i,s).className),r="vertical",n="htBottom";this.runHooks("beforeCellAlignment",e,t,r,n),Wa(t,r,n,(i,s)=>this.getCellMeta(i,s),(i,s,o,a)=>this.setCellMeta(i,s,o,a)),this.render()},disabled:!1}]}}}const xv="clear_column";function cre(){return{key:xv,name(){return this.getTranslatedPhrase(Zx)},callback(t,e){const r=e[0].start.col,n=e[0].end.col;this.countRows()&&this.populateFromArray(0,r,[[null]],Math.max(e[0].start.row,e[0].end.row),n,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:!this.selection.isSelectedByColumnHeader()}}}const Mg="col_left";function hre(){return{key:Mg,name(){return this.getTranslatedPhrase(zx)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?this.countCols()===0:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Og="col_right";function dre(){return{key:Og,name(){return this.getTranslatedPhrase(Yx)},callback(){const t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.col<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByRowHeader()||this.countCols()>=this.getSettings().maxCols},hidden(){return!this.getSettings().allowInsertColumn}}}const Ig="make_read_only";function fre(){return{key:Ig,checkable:!0,ariaChecked(){return lf(this.getSelectedRange(),(e,r)=>this.getCellMeta(e,r).readOnly)},ariaLabel(){return this.getTranslatedPhrase(P0)},name(){let t=this.getTranslatedPhrase(P0);return lf(this.getSelectedRange(),(r,n)=>this.getCellMeta(r,n).readOnly)&&(t=Go(t)),t},callback(){const t=this.getSelectedRange(),e=lf(t,(r,n)=>this.getCellMeta(r,n).readOnly);V(t,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&this.setCellMeta(n,i,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const Rv="redo";function gre(){return{key:Rv,name(){return this.getTranslatedPhrase(qx)},callback(){this.redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Pg="remove_col";function mre(){return{key:Pg,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Kx,e)},callback(){this.alter("remove_col",nq(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const Ev="remove_row";function pre(){return{key:Ev,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[r,,n]=t[0];r-n!==0&&(e=1)}return this.getTranslatedPhrase(Gx,e)},callback(){this.alter("remove_row",iq(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const Tv="row_above";function wre(){return{key:Tv,name(){return this.getTranslatedPhrase(Ux)},callback(){const t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?this.countRows()===0:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const _v="row_below";function vre(){return{key:_v,name(){return this.getTranslatedPhrase(jx)},callback(){const t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeLast();return!t||t.isSingleHeader()&&t.highlight.row<0?!0:this.selection.isSelectedByCorner()?!1:this.selection.isSelectedByColumnHeader()||this.countRows()>=this.getSettings().maxRows},hidden(){return!this.getSettings().allowInsertRow}}}const Uf="no_items";function Cre(){return{key:Uf,name(){return this.getTranslatedPhrase(Wx)},disabled:!0,isCommand:!1}}const Av="undo";function Sre(){return{key:Av,name(){return this.getTranslatedPhrase(Xx)},callback(){this.undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const yre=[Tv,_v,Mg,Og,xv,Ev,Pg,Av,Rv,Ig,Fi,ft,Uf],bre={[ft]:lre,[Uf]:Cre,[Tv]:wre,[_v]:vre,[Mg]:hre,[Og]:dre,[xv]:cre,[Ev]:pre,[Pg]:mre,[Av]:Sre,[Rv]:gre,[Ig]:fre,[Fi]:ure};function YH(){const t={};return ct(bre,(e,r)=>{t[r]=e()}),t}function xre(t){return{key:"commentsAddEdit",name(){var e;const r=(e=this.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r!=null&&r.isCell()&&t.getCommentAtCell(r.row,r.col)?this.getTranslatedPhrase(lR):this.getTranslatedPhrase(aR)},callback(){const e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Rre(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(uR)},callback(){this.getSelectedRangeLast().forAll((r,n)=>{r>=0&&n>=0&&t.removeCommentAtCell(r,n,!1)}),this.render()},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Ere(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(cR);return lf(this.getSelectedRange(),(n,i)=>t.getCommentMeta(n,i,i0))?Go(e):e},callback(){this.getSelectedRangeLast().forAll((r,n)=>{if(r>=0&&n>=0){const i=!!t.getCommentMeta(r,n,i0);t.updateCommentMeta(r,n,{[i0]:!i})}})},disabled(){const e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function Tre(t,e){GH(t,e),e.add(t)}function xc(t,e,r){GH(t,e),e.set(t,r)}function GH(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _re(t,e,r){return(e=Are(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Are(t){var e=Mre(t,"string");return typeof e=="symbol"?e:e+""}function Mre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function rl(t,e,r){return t.set(gs(t,e),r),r}function Ct(t,e){return t.get(gs(t,e))}function gs(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const uf="comments",Ore=60,Ko="comment",Gd="value",KH="style",i0="readOnly",Km=uf,O1=`plugin:${uf}`;var Kt=new WeakMap,no=new WeakMap,Mv=new WeakMap,s0=new WeakMap,I1=new WeakMap,K0=new WeakMap,Us=new WeakSet;class Ire extends At{constructor(){super(...arguments),Tre(this,Us),_re(this,"range",{}),xc(this,Kt,null),xc(this,no,null),xc(this,Mv,!1),xc(this,s0,!1),xc(this,I1,null),xc(this,K0,"")}static get PLUGIN_KEY(){return uf}static get PLUGIN_PRIORITY(){return Ore}isEnabled(){return!!this.hot.getSettings()[uf]}enablePlugin(){var e=this;this.enabled||(Ct(Kt,this)||(rl(Kt,this,new yu(this.hot.rootDocument,this.hot.isRtl())),Ct(Kt,this).addLocalHook("resize",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return gs(Us,e,Lre).call(e,...n)})),Ct(no,this)||rl(no,this,new zH(this.getDisplayDelaySetting())),this.addHook("afterContextMenuDefaultOptions",r=>this.addToContextMenu(r)),this.addHook("afterRenderer",(r,n,i,s,o,a)=>gs(Us,this,Hre).call(this,r,a)),this.addHook("afterScroll",()=>gs(Us,this,Bre).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",r=>gs(Us,this,$re).call(this,r)),Ct(no,this).addLocalHook("hide",()=>this.hide()),Ct(no,this).addLocalHook("show",(r,n)=>this.showAtCell(r,n)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){Ct(no,this).updateDelay(this.getDisplayDelaySetting()),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),r=e.getContext("grid"),n=e.addContext(O1);r.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const i=this.hot.getSelectedRangeLast();rl(s0,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(i),this.show(),this.focusEditor(),e.setActiveContextName(O1),this.hot._registerTimeout(()=>{rl(s0,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var i;return((i=this.hot.getSelectedRangeLast())===null||i===void 0?void 0:i.highlight.isCell())&&!Ct(Kt,this).isVisible()},group:Km}),n.addShortcut({keys:[["Escape"]],callback:()=>{Ct(Kt,this).setValue(Ct(K0,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ct(Kt,this).isVisible()&&Ct(Kt,this).isFocused(),group:Km}),n.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>Ct(Kt,this).isVisible()&&Ct(Kt,this).isFocused(),group:Km})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Km)}registerListeners(){const{rootDocument:e}=this.hot,r=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",n=>gs(Us,this,Nre).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>gs(Us,this,Pre).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>gs(Us,this,Dre).call(this)),this.eventManager.addEventListener(r,"focus",()=>gs(Us,this,Fre).call(this)),this.eventManager.addEventListener(r,"blur",()=>gs(Us,this,kre).call(this))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const r=fl(e.target,"TD","TBODY");return!!(r&&Qe(r,"htCommentCell")&&fl(r,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const r=Ct(Kt,this).getValue();let n="";e!=null?n=e:r!=null&&(n=r);const i=this.range.from.row,s=this.range.from.col;this.updateCommentMeta(i,s,{[Gd]:n}),this.hot.render()}setCommentAtCell(e,r,n){this.setRange({from:this.hot._createCellCoords(e,r)}),this.setComment(n)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,Ko),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,r)}),this.removeComment(n)}getComment(){const e=this.range.from.row,r=this.range.from.col;return this.getCommentMeta(e,r,Gd)}getCommentAtCell(e,r){return this.getCommentMeta(e,r,Gd)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{from:{row:r,col:n}}=this.range;if(r<0||r>this.hot.countSourceRows()-1||n<0||n>this.hot.countSourceCols()-1)return!1;const i=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return Ct(no,this).cancelHiding(),Ct(Kt,this).setValue((e=i[Ko]?i[Ko][Gd]:null)!==null&&e!==void 0?e:""),Ct(Kt,this).show(),this.refreshEditor(!0),!0}showAtCell(e,r){return this.setRange({from:this.hot._createCellCoords(e,r)}),this.show()}hide(){Ct(Kt,this).hide()}refreshEditor(){var e,r;if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!Ct(Kt,this).isVisible()))return;const{rowIndexMapper:i,columnIndexMapper:s}=this.hot,{row:o,col:a}=this.range.from;let l=i.getRenderableFromVisualIndex(o),u=s.getRenderableFromVisualIndex(a);const c=l===null;Ct(Kt,this).setPosition(0,0),l===null&&(l=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1))),u===null&&(u=s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(a,-1)));const h=l===null,d=u===null;l=(e=l)!==null&&e!==void 0?e:0,u=(r=u)!==null&&r!==void 0?r:0;const{rootWindow:f,view:{_wt:m}}=this.hot,{wtTable:g}=m,w=m.getCell({row:l,col:u},!0),S=this.getCommentMeta(o,a,KH);S?Ct(Kt,this).setSize(S.width,S.height):Ct(Kt,this).resetSize();const b=d?0:g.getStretchedColumnWidth(u),y=c&&!h?Ar(w):0,{left:_,top:P,width:z,height:I}=w.getBoundingClientRect(),{width:W,height:L}=Ct(Kt,this).getSize(),{innerWidth:U,innerHeight:G}=this.hot.rootWindow,X=this.hot.rootDocument.documentElement;let le=_+f.scrollX+b,xe=P+f.scrollY+y;this.hot.isRtl()&&(le-=W+b),this.hot.isLtr()&&_+z+W>U?le=_+f.scrollX-W-1:this.hot.isRtl()&&le<-(X.scrollWidth-X.clientWidth)&&(le=_+f.scrollX+b+1),P+L>G&&(xe-=L-I+1),Ct(Kt,this).setPosition(le,xe),Ct(Kt,this).setReadOnlyState(this.getCommentMeta(o,a,i0)),Ct(Kt,this).observeSize()}focusEditor(){Ct(Kt,this).focus()}updateCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r)[Ko];let s;i?(s=Mn(i),yg(s,n)):s=n,this.hot.setCellMeta(e,r,Ko,s)}getCommentMeta(e,r,n){const i=this.hot.getCellMeta(e,r);if(i[Ko])return i[Ko][n]}addToContextMenu(e){e.items.push({name:ft},xre(this),Rre(this),Ere(this))}getDisplayDelaySetting(){const e=this.hot.getSettings()[uf];if(ut(e))return e.displayDelay}getEditorInputElement(){return Ct(Kt,this).getInputElement()}destroy(){var e,r;(e=Ct(Kt,this))===null||e===void 0||e.destroy(),(r=Ct(no,this))===null||r===void 0||r.destroy(),super.destroy()}}function Pre(t){if(!(!this.hot.view||!this.hot.view._wt)&&!Ct(Mv,this)&&!this.targetIsCommentTextArea(t)){const e=fl(t.target,"TD","TBODY");let r=null;e&&(r=this.hot.getCoords(e)),(!e||this.range.from&&r&&(this.range.from.row!==r.row||this.range.from.col!==r.col))&&this.hide()}}function Nre(t){const{rootDocument:e}=this.hot;if(!(Ct(Mv,this)||Ct(Kt,this).isFocused()||Qe(t.target,"wtBorder")||Ct(I1,this)===t.target||!Ct(Kt,this)))if(rl(I1,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const r=this.hot._createCellRange(this.hot.getCoords(t.target));Ct(no,this).show(r)}else ll(t.target,e)&&!this.targetIsCommentTextArea(t)&&Ct(no,this).hide()}function Dre(){rl(Mv,this,!1)}function Hre(t,e){e[Ko]&&e[Ko][Gd]&&ve(t,e.commentedCellClassName)}function kre(){rl(K0,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function Fre(){rl(K0,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(O1)}function Lre(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[KH]:{width:t,height:e}})}function $re(t){Ct(Kt,this).isVisible()&&Ji(t)}function Bre(){Ct(s0,this)||this.hide()}var gM=kw,Vre=TypeError,Wre=function(t,e){if(!delete t[e])throw new Vre("Cannot delete property "+gM(e)+" of "+gM(t))},Ure=pn,jre=ag,zre=cg,Yre=tP,Gre=Wre,Kre=rP,Xre=[].unshift(0)!==1,qre=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}},Zre=Xre||!qre();Ure({target:"Array",proto:!0,arity:1,forced:Zre},{unshift:function(e){var r=jre(this),n=zre(r),i=arguments.length;if(i){Kre(n+i);for(var s=n;s--;){var o=s+i;s in r?r[o]=r[s]:Gre(r,o)}for(var a=0;a<i;a++)r[a]=arguments[a]}return Yre(r,n+i)}});function vS(t,e,r){return(e=Jre(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jre(t){var e=Qre(t,"string");return typeof e=="symbol"?e:e+""}function Qre(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class XH{constructor(e){vS(this,"hot",void 0),vS(this,"commands",{}),vS(this,"commonCallback",null),this.hot=e}registerCommand(e,r){this.commands[e]=r}setCommonCallback(e){this.commonCallback=e}execute(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];const s=e.split(":"),o=s[0],a=s.length===2?s[1]:null;let l=this.commands[o];if(!l)throw new Error(`Menu command '${o}' not exists.`);if(a&&l.submenu&&(l=ene(a,l.submenu.items)),l.disabled===!0||typeof l.disabled=="function"&&l.disabled.call(this.hot)===!0||gr(l,"submenu"))return;const u=[];typeof l.callback=="function"&&u.push(l.callback),typeof this.commonCallback=="function"&&u.push(this.commonCallback),n.unshift(s.join(":")),V(u,c=>c.apply(this.hot,n))}}function ene(t,e){let r;return V(e,n=>{const i=n.key?n.key.split(":"):null;if(Array.isArray(i)&&i[1]===t)return r=n,!1}),r}function CS(t,e,r){return(e=tne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function tne(t){var e=rne(t,"string");return typeof e=="symbol"?e:e+""}function rne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qH{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;CS(this,"hot",void 0),CS(this,"predefinedItems",YH()),CS(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=r}setPredefinedItems(e){const r={};this.defaultOrderPattern.length=0,ct(e,(n,i)=>{let s="";n.name===ft?(r[ft]=n,s=ft):isNaN(parseInt(i,10))?(n.key=n.key===void 0?i:n.key,r[i]=n,s=n.key):(r[n.key]=n,s=n.key),this.defaultOrderPattern.push(s)}),this.predefinedItems=r}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return nne(e,this.defaultOrderPattern,this.predefinedItems)}}function nne(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const n=[];let i=t;return i&&i.items?i=i.items:Array.isArray(i)||(i=e),ut(i)?ct(i,(s,o)=>{let a=r[typeof s=="string"?s:o];a||(a=s),ut(s)?Dr(a,s):typeof a=="string"&&(a={name:a}),a.key===void 0&&(a.key=o),n.push(a)}):V(i,(s,o)=>{let a=r[s];!a&&yre.indexOf(s)>=0||(a||(a={name:s,key:`${o}`}),ut(s)&&Dr(a,s),a.key===void 0&&(a.key=o),n.push(a))}),n}function Ma(t,e,r){return(e=ine(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ine(t){var e=sne(t,"string");return typeof e=="symbol"?e:e+""}function sne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class one{constructor(e,r){Ma(this,"top",void 0),Ma(this,"topRelative",void 0),Ma(this,"left",void 0),Ma(this,"leftRelative",void 0),Ma(this,"scrollTop",void 0),Ma(this,"scrollLeft",void 0),Ma(this,"cellHeight",void 0),Ma(this,"cellWidth",void 0);const n=r.scrollY,i=r.scrollX;let s,o,a,l,u,c;this.rootWindow=r,this.type=this.getSourceType(e),this.type==="literal"?(s=parseInt(e.top,10),a=parseInt(e.left,10),u=e.height||0,c=e.width||0,o=s,l=a,s+=n,a+=i):this.type==="event"&&(s=parseInt(e.pageY,10),a=parseInt(e.pageX,10),u=e.target.clientHeight,c=e.target.clientWidth,o=s-n,l=a-i),this.top=s,this.topRelative=o,this.left=a,this.leftRelative=l,this.scrollTop=n,this.scrollLeft=i,this.cellHeight=u,this.cellWidth=c}getSourceType(e){let r="literal";return e instanceof Event&&(r="event"),r}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=r}fitsOnRight(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=r}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function vd(t,e,r){ane(t,e),e.set(t,r)}function ane(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bt(t,e){return t.get(ZH(t,e))}function Xm(t,e,r){return t.set(ZH(t,e),r),r}function ZH(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var In=new WeakMap,Oa=new WeakMap,Gn=new WeakMap,SS=new WeakMap,Rc=new WeakMap;class lne{constructor(e){vd(this,In,void 0),vd(this,Oa,void 0),vd(this,Gn,void 0),vd(this,SS,!1),vd(this,Rc,{above:0,below:0,left:0,right:0}),Xm(SS,this,e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return bt(Rc,this)[e]=r,this}setElement(e){return Xm(In,this,e),this}setParentElement(e){return Xm(Oa,this,e),this}updatePosition(e){Xm(Gn,this,new one(e,bt(In,this).ownerDocument.defaultView)),bt(SS,this)?(bt(Gn,this).fitsBelow(bt(In,this))?this.setPositionBelowCursor():bt(Gn,this).fitsAbove(bt(In,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){bt(In,this).dir==="rtl"?bt(Gn,this).fitsOnLeft(bt(In,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():bt(Gn,this).fitsOnRight(bt(In,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=bt(Rc,this).above+bt(Gn,this).top-bt(In,this).offsetHeight;bt(Oa,this)&&(e=bt(Gn,this).top+bt(Gn,this).cellHeight-bt(In,this).offsetHeight+3),bt(In,this).style.top=`${e}px`}setPositionBelowCursor(){let e=bt(Rc,this).below+bt(Gn,this).top+1;bt(Oa,this)&&(e=bt(Gn,this).top-1),bt(In,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=bt(Gn,this).left;if(bt(Oa,this)){const r=Number.parseInt(getComputedStyle(bt(Oa,this).querySelector(".htCore")).borderRightWidth,10);e+=bt(Gn,this).cellWidth+r}else e+=bt(Rc,this).right;bt(In,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=bt(Rc,this).left+bt(Gn,this).left-bt(In,this).offsetWidth;if(bt(Oa,this)){const r=Number.parseInt(getComputedStyle(bt(Oa,this).querySelector(".htCore")).borderLeftWidth,10);e-=r}bt(In,this).style.left=`${e}px`}}function JH(t){let{initialPage:e=-1,size:r=()=>0,onItemSelect:n=()=>{},onClear:i=()=>{}}=t;const s=new Set;let o=Ht(e,-1,m()-1);function a(w,S){const b=m()-1;return w<0&&(w=b),w>b&&(w=0),s.has(w)?-1:(s.add(w),n(w,!1)===!1&&(w=a(S===1?++w:--w,S)),w)}function l(w){w>-1&&w<m()&&n(w,!0)!==!1&&(o=w)}function u(){return o}function c(){m()>0&&(s.clear(),o=a(0,1))}function h(){m()>0&&(s.clear(),o=a(m()-1,-1))}function d(){m()>0&&(s.clear(),o=a(++o,1))}function f(){m()>0&&(s.clear(),o=a(--o,-1))}function m(){return Math.max(r(),0)}function g(){s.clear(),o=e,i()}return{setCurrentPage:l,getCurrentPage:u,toFirstItem:c,toLastItem:h,toNextItem:d,toPreviousItem:f,getSize:m,clear:g}}function une(t){return St(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function P1(t){return gr(t,"submenu")}function N1(t){return new RegExp(ft,"i").test(t.name)}function o0(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function mM(t){return gr(t,"disableSelection")}function cne(t){return Qe(t,"htSeparator")}function hne(t){return Qe(t,"htSubmenu")}function dne(t){return Qe(t,"htDisabled")}function fne(t){return Qe(t,"htSelectionDisabled")}function gne(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function QH(t,e){const r=t.slice(0);for(let n=0;n<r.length&&r[n].name===e;)r.shift();return r}function mne(t,e){let r=t.slice(0);return r.reverse(),r=QH(r,e),r.reverse(),r}function pne(t){const e=[];return V(t,(r,n)=>{n>0?e[e.length-1].name!==r.name&&e.push(r):e.push(r)}),e}function wne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:ft,r=t.slice(0);return r=QH(r,e),r=mne(r,e),r=pne(r),r}function vne(t){return t.checkable===!0}function Cne(t){return JH({size:()=>t.countRows(),onItemSelect(e,r){const n=t.getCell(e,0);if(!n||cne(n)||dne(n)||fne(n))return!1;t.selectCell(e,0,...r?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function Sne(t){const{hot:e,hotMenu:r}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(n,i)=>{const s=e.getSettings(),o=typeof s.tabMoves=="function"?s.tabMoves(n):s.tabMoves;i.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[["ArrowRight"]],callback:()=>{const n=r.getSelectedLast();if(n){const i=t.openSubMenu(n[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[["ArrowLeft"]],callback:()=>{r.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:n=>{const i=r.getSelectedLast();i&&(r.getSourceDataAtRow(i[0]).submenu?t.openSubMenu(i[0]).getNavigator().toFirstItem():(t.executeCommand(n),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(-r.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{r.getSelectedLast()?r.selection.transformStart(r.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const e2="menu",pM=e2;function yne(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const r=[];n(Sne(t)),e.forEach(u=>{let{shortcuts:c,contextName:h}=u;i(c,h)});function n(u,c){a(c).addShortcuts(u,{group:e2})}function i(u,c){const h=a(c);u.forEach(d=>{let{keys:f}=d;f.forEach(m=>h.removeShortcutsByKeys(m))}),r.push({shortcuts:u,contextName:c}),n(u,c)}function s(){return[...r]}function o(u){return u?`${pM}:${u}`:pM}function a(u){var c;const h=t.hotMenu.getShortcutManager(),d=o(u);return(c=h.getContext(d))!==null&&c!==void 0?c:h.addContext(d)}function l(u){t.hotMenu.getShortcutManager().setActiveContextName(o(u))}return{addCustomShortcuts:i,getCustomShortcuts:s,getContext:a,listen:l}}function bne(t){return(e,r,n,i,s,o)=>{const a=e.getSourceDataAtRow(n),l=t.rootDocument.createElement("div"),u=typeof o=="function"?o.call(t):o,c=typeof a.ariaLabel=="function"?a.ariaLabel.call(t):a.ariaLabel,h=typeof a.ariaChecked=="function"?a.ariaChecked.call(t):a.ariaChecked;if(As(r),ve(l,"htItemWrapper"),t.getSettings().ariaTags){const d=!o0(a,t)&&!mM(a)&&!N1(a);qe(r,[...vne(a)?[oz(),T0(c),bN(h)]:[sz(),T0(u)],...d?[Th(-1)]:[],...o0(a,t)?[fz()]:[],...P1(a)?[Yi(!1)]:[]])}r.className="",r.appendChild(l),N1(a)?ve(r,"htSeparator"):typeof a.renderer=="function"?(ve(r,"htCustomMenuRenderer"),r.appendChild(a.renderer(e,l,n,i,s,u))):Xu(l,u),o0(a,t)?ve(r,"htDisabled"):mM(a)?ve(r,"htSelectionDisabled"):P1(a)&&ve(r,"htSubmenu")}}function yS(t,e,r){xne(t,e),e.set(t,r)}function xne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function js(t,e,r){return(e=Rne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rne(t){var e=Ene(t,"string");return typeof e=="symbol"?e:e+""}function Ene(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bS(t,e,r){return t.set(t2(t,e),r),r}function Xl(t,e){return t.get(t2(t,e))}function t2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wM=215;var Cd=new WeakMap,qm=new WeakMap,Zm=new WeakMap;class Ph{get tableBorderWidth(){return Xl(Zm,this)===void 0&&this.hotMenu&&bS(Zm,this,parseInt(vo(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),Xl(Zm,this)}constructor(e,r){var n=this;js(this,"hot",void 0),js(this,"options",void 0),js(this,"eventManager",new Xi(this)),js(this,"container",void 0),js(this,"positioner",void 0),js(this,"hotMenu",null),js(this,"hotSubMenus",{}),js(this,"parentMenu",void 0),js(this,"menuItems",null),js(this,"origOutsideClickDeselects",null),yS(this,Cd,void 0),yS(this,qm,void 0),yS(this,Zm,void 0),this.hot=e,this.options=r||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:wM,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new lne(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return n.parentMenu.runLocalHooks("afterSelectionChange",...s)})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"touchstart",r=>this.onDocumentMouseDown(r)),this.eventManager.addEventListener(e.document,"contextmenu",r=>this.onDocumentContextMenu(r)),e=Au(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return Xl(Cd,this)}getKeyboardShortcutsCtrl(){return Xl(qm,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=nv(a=>this.openSubMenu(a),300),r=this.options.minWidth||wM;let n=!1,i=ha(this.menuItems,a=>(a.key===Uf&&(n=!0),gne(a,this.hot)));if(i.length<1&&!n)i.push(YH()[Uf]);else if(i.length===0)return;i=wne(i,ft);let s=!1;const o={data:i,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(a){return ke(a)&&a<r?r:a},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:bne(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,beforeOnCellMouseOver:(a,l)=>{Xl(Cd,this).setCurrentPage(l.row)},afterOnCellMouseOver:(a,l)=>{this.isAllSubMenusClosed()?e(l.row):this.openSubMenu(l.row)},rowHeights:a=>i[a].name===ft?1:void 0,afterOnCellContextMenu:a=>{a.preventDefault(),a1()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(a,l,u,c,h)=>{this.hotMenu.view.isMouseDown()&&(h.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:a=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(a))},afterOnCellMouseUp:a=>{(!a1()||!ml(a))&&s&&this.hasSelectedItem()&&(ea()||ox()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,o),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),bS(Cd,this,Cne(this.hotMenu)),bS(qm,this,yne(this)),Xl(qm,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(Xl(Cd,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const r=this.parentMenu.hotMenu.getSelectedLast();if(r){const n=this.parentMenu.hotMenu.getCell(r[0],0);qe(n,[Yi(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const r=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!r||!hne(r))return!1;const n=this.hotMenu.getSourceDataAtRow(e),i=new Ph(this.hot,{parent:this,name:n.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return i.setMenuItems(n.submenu.items),i.open(),i.setPosition(r.getBoundingClientRect()),this.hotSubMenus[n.key]=i,this.hot.getSettings().ariaTags&&qe(r,[Yi(!0)]),i}closeSubMenu(e){const r=this.hotMenu.getSourceDataAtRow(e),n=this.hotSubMenus[r.key];if(n){n.destroy(),delete this.hotSubMenus[r.key];const i=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&qe(i,[Yi(!1)])}}closeAllSubMenus(){V(this.hotMenu.getData(),(e,r)=>this.closeSubMenu(r))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const r=this.getSelectedItem();if(this.runLocalHooks("select",r,e),this.isCommandPassive(r))return;const n=this.hot.getSelectedRange(),i=n?une(n):[];this.runLocalHooks("executeCommand",r.key,i,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",r.key,i,e)}isCommandPassive(e){return e.isCommand===!1||N1(e)||o0(e,this.hot)||P1(e)}setOffset(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,r)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,r=this.hotMenu.getSettings().data,n=e.hider.style,i=e.holder.style,s=parseInt(n.width,10),o=Hr(r,(a,l,u)=>{const h=this.hotMenu.getCell(u,0)?Ar(this.hotMenu.getCell(u,0)):0;return a+(l.name===ft?1:h)},0);i.width=`${s+3}px`,i.height=`${o+3}px`,n.height=i.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const r=this.options.container.ownerDocument;let n=e,i;return n&&(Jt(n)&&(n=n.call(this.hot),n===null||er(n)?n="":n=n.toString()),n=n.replace(/[^A-z0-9]/g,"_"),n=`${this.options.className}Sub_${n}`,i=r.querySelector(`.${this.options.className}.${n}`)),i||(i=r.createElement("div"),ve(i,`htMenu ${this.options.className}`),n&&ve(i,n),this.options.container.appendChild(i)),i}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&qe(this.hotMenu.rootElement,[iz(),Th(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!ll(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!ll(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Qe(e.target,"htCore")&&ll(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}Lt(Ph,wn);function Tne(t,e){_ne(t,e),e.add(t)}function _ne(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xS(t,e,r){return(e=Ane(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ane(t){var e=Mne(t,"string");return typeof e=="symbol"?e:e+""}function Mne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jm(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Kd="contextMenu",One=70,vM=Kd;He.getSingleton().register("afterContextMenuDefaultOptions");He.getSingleton().register("beforeContextMenuShow");He.getSingleton().register("afterContextMenuShow");He.getSingleton().register("afterContextMenuHide");He.getSingleton().register("afterContextMenuExecute");var Sd=new WeakSet;class Ov extends At{constructor(){super(...arguments),Tne(this,Sd),xS(this,"commandExecutor",new XH(this.hot)),xS(this,"itemsFactory",null),xS(this,"menu",null)}static get PLUGIN_KEY(){return Kd}static get PLUGIN_PRIORITY(){return One}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Tv,_v,ft,Mg,Og,ft,Ev,Pg,ft,Av,Rv,ft,Ig,ft,Fi]}isEnabled(){return!!this.hot.getSettings()[Kd]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[Kd];typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.menu=new Ph(this.hot,{className:"htContextMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>Jm(Sd,this,Pne).call(this)),this.menu.addLocalHook("afterOpen",()=>Jm(Sd,this,Nne).call(this)),this.menu.addLocalHook("afterClose",()=>Jm(Sd,this,Dne).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",n=>Jm(Sd,this,Ine).call(this,n)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();const r=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),n=bv(this.menu.container,this.hot.rootDocument);this.open({left:r.left+n.left,top:r.top+n.top-1+r.height},{left:r.width,above:-r.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r&&this.hot.selection.isCellVisible(r)&&!this.menu.isOpened()},group:vM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(vM)}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};if((r=this.menu)!==null&&r!==void 0&&r.isOpened())return;this.prepareMenuItems(),this.menu.open(),this.menu.tableBorderWidth>0||(n.below+=1,n.right+=1,n.above-=1,n.left-=1),ct(n,(s,o)=>{this.menu.setOffset(o,s)}),this.menu.setPosition(e)}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}prepareMenuItems(){this.itemsFactory=new qH(this.hot,Ov.DEFAULT_ITEMS);const e=this.hot.getSettings()[Kd],r={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",r),this.itemsFactory.setPredefinedItems(r.items);const n=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",n),this.menu.setMenuItems(n),V(n,i=>this.commandExecutor.registerCommand(i.key,i))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function Ine(t){const e=this.hot.getSettings(),r=e.rowHeaders,n=e.colHeaders;function i(a){return a.nodeName==="TD"||a.parentNode.nodeName==="TD"}const s=t.target;if(this.close(),Qe(s,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(r||n)&&!i(s)&&!(Qe(s,"current")&&Qe(s,"wtBorder"))))return;const o=bv(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function Pne(){this.hot.runHooks("beforeContextMenuShow",this)}function Nne(){this.hot.runHooks("afterContextMenuShow",this)}function Dne(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}Ov.SEPARATOR={name:ft};function Hne(t){return{key:"copy",name(){return this.getTranslatedPhrase(Jx)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function kne(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeLast(),r=e?Ht(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tR,r)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Fne(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeLast(),r=e?Ht(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(eR,r)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function Lne(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeLast(),r=e?Ht(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(Qx,r)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}function $ne(t){return{key:"cut",name(){return this.getTranslatedPhrase(rR)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;const r=this.getSelected();return!r||r.length>1},hidden:!1}}class Bne{constructor(){this.data={}}setData(e,r){this.data[e]=r}getData(e){return this.data[e]||void 0}}class Vne{constructor(){this.clipboardData=new Bne}preventDefault(){}}function Wne(t,e){r2(t,e),e.add(t)}function Ec(t,e,r){r2(t,e),e.set(t,r)}function r2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dn(t,e){return t.get(eh(t,e))}function Tc(t,e,r){return t.set(eh(t,e),r),r}function eh(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ia=new WeakMap,RS=new WeakMap,yd=new WeakMap,D1=new WeakMap,H1=new WeakMap,bd=new WeakMap,xd=new WeakSet;class Une{constructor(e){let{countRows:r,countColumns:n,rowsLimit:i,columnsLimit:s,countColumnHeaders:o}=e;Wne(this,xd),Ec(this,Ia,void 0),Ec(this,RS,void 0),Ec(this,yd,void 0),Ec(this,D1,void 0),Ec(this,H1,void 0),Ec(this,bd,void 0),Tc(RS,this,r),Tc(yd,this,n),Tc(D1,this,i),Tc(H1,this,s),Tc(bd,this,o)}setSelectedRange(e){Tc(Ia,this,e)}getCellsRange(){if(Dn(RS,this).call(this)===0||Dn(yd,this).call(this)===0)return null;const{row:e,col:r}=Dn(Ia,this).getTopStartCorner(),{row:n,col:i}=Dn(Ia,this).getBottomEndCorner(),s=eh(xd,this,jne).call(this,e,n),o=eh(xd,this,ES).call(this,r,i);return{isRangeTrimmed:n!==s||i!==o,startRow:e,startCol:r,endRow:s,endCol:o}}getMostBottomColumnHeadersRange(){if(Dn(yd,this).call(this)===0||Dn(bd,this).call(this)===0)return null;const{col:e}=Dn(Ia,this).getTopStartCorner(),{col:r}=Dn(Ia,this).getBottomEndCorner(),n=eh(xd,this,ES).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-1,startCol:e,endRow:-1,endCol:n}}getAllColumnHeadersRange(){if(Dn(yd,this).call(this)===0||Dn(bd,this).call(this)===0)return null;const{col:e}=Dn(Ia,this).getTopStartCorner(),{col:r}=Dn(Ia,this).getBottomEndCorner(),n=eh(xd,this,ES).call(this,e,r);return{isRangeTrimmed:r!==n,startRow:-Dn(bd,this).call(this),startCol:e,endRow:-1,endCol:n}}}function ES(t,e){return Math.min(e,Math.max(t+Dn(H1,this).call(this)-1,t))}function jne(t,e){return Math.min(e,Math.max(t+Dn(D1,this).call(this)-1,t))}function n2(t){const e=[],r=[];return V(t,n=>{const i=Math.min(n.startRow,n.endRow),s=Math.max(n.startRow,n.endRow);Ue(i,s,l=>{e.indexOf(l)===-1&&e.push(l)});const o=Math.min(n.startCol,n.endCol),a=Math.max(n.startCol,n.endCol);Ue(o,a,l=>{r.indexOf(l)===-1&&r.push(l)})}),{rows:e,columns:r}}function zne(t,e){i2(t,e),e.add(t)}function Pa(t,e,r){i2(t,e),e.set(t,r)}function i2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rd(t,e,r){return(e=Yne(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yne(t){var e=Gne(t,"string");return typeof e=="symbol"?e:e+""}function Gne(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ei(t,e){return t.get(ti(t,e))}function fs(t,e,r){return t.set(ti(t,e),r),r}function ti(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("afterCopyLimit");He.getSingleton().register("modifyCopyableRange");He.getSingleton().register("beforeCut");He.getSingleton().register("afterCut");He.getSingleton().register("beforePaste");He.getSingleton().register("afterPaste");He.getSingleton().register("beforeCopy");He.getSingleton().register("afterCopy");const Qm="copyPaste",Kne=80,Xne=["fragmentSelection"],CM=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var k1=new WeakMap,F1=new WeakMap,L1=new WeakMap,_c=new WeakMap,ep=new WeakMap,tp=new WeakMap,Ac=new WeakMap,X0=new WeakMap,gi=new WeakSet;class qne extends At{constructor(){super(...arguments),zne(this,gi),Rd(this,"columnsLimit",1/0),Rd(this,"rowsLimit",1/0),Rd(this,"pasteMode","overwrite"),Rd(this,"uiContainer",this.hot.rootDocument.body),Pa(this,k1,!1),Pa(this,F1,!1),Pa(this,L1,!1),Pa(this,_c,"cells-only"),Pa(this,ep,!1),Pa(this,tp,!1),Pa(this,Ac,new Une({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),Pa(this,X0,!1),Rd(this,"copyableRanges",[])}static get PLUGIN_KEY(){return Qm}static get SETTING_KEYS(){return[Qm,...Xne]}static get PLUGIN_PRIORITY(){return Kne}isEnabled(){return!!this.hot.getSettings()[Qm]}enablePlugin(){var e=this;if(this.enabled)return;const{[Qm]:r}=this.hot.getSettings();if(typeof r=="object"){var n,i;this.pasteMode=(n=r.pasteMode)!==null&&n!==void 0?n:this.pasteMode,this.rowsLimit=isNaN(r.rowsLimit)?this.rowsLimit:r.rowsLimit,this.columnsLimit=isNaN(r.columnsLimit)?this.columnsLimit:r.columnsLimit,fs(k1,this,!!r.copyColumnHeaders),fs(F1,this,!!r.copyColumnGroupHeaders),fs(L1,this,!!r.copyColumnHeadersOnly),this.uiContainer=(i=r.uiContainer)!==null&&i!==void 0?i:this.uiContainer}this.addHook("afterContextMenuDefaultOptions",s=>ti(gi,this,Qne).call(this,s)),this.addHook("afterSelection",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return ti(gi,e,eie).call(e,...o)}),this.addHook("afterSelectionEnd",()=>ti(gi,this,tie).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return e.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return e.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return e.onPaste(...arguments)}),ix()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return ti(gi,e,rie).call(e,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return ti(gi,e,nie).call(e,...o)}),this.addHook("afterSelection",()=>ti(gi,this,iie).call(this))),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";fs(_c,this,e),fs(ep,this,!0),ti(gi,this,SM).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){fs(tp,this,!0),ti(gi,this,SM).call(this,"cut")}getRangedCopyableData(e){return sf(this.getRangedData(e))}getRangedData(e){const r=[],{rows:n,columns:i}=n2(e);return V(n,s=>{const o=[];V(i,a=>{s<0?o.push(this.hot.getColHeader(a,s)):o.push(this.hot.getCopyableData(s,a))}),r.push(o)}),r}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!r)return;const n=new Vne;e&&n.clipboardData.setData("text/plain",e),r&&n.clipboardData.setData("text/html",r),this.onPaste(n)}setCopyableText(){const e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ei(Ac,this).setSelectedRange(e);const r=new Map([["headers",null],["cells",null]]);ei(_c,this)==="column-headers-only"?r.set("headers",ei(Ac,this).getMostBottomColumnHeadersRange()):(ei(_c,this)==="with-column-headers"?r.set("headers",ei(Ac,this).getMostBottomColumnHeadersRange()):ei(_c,this)==="with-column-group-headers"&&r.set("headers",ei(Ac,this).getAllColumnHeadersRange()),r.set("cells",ei(Ac,this).getCellsRange())),this.copyableRanges=Array.from(r.values()).filter(i=>i!==null).map(i=>{let{startRow:s,startCol:o,endRow:a,endCol:l}=i;return{startRow:s,startCol:o,endRow:a,endCol:l}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const n=r.get("cells");if(n!==null&&n.isRangeTrimmed){const{startRow:i,startCol:s,endRow:o,endCol:a}=n;this.hot.runHooks("afterCopyLimit",o-i+1,a-s+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;const n=e.length,i=e[0].length,s=[],{row:o,col:a}=r.getTopStartCorner(),{row:l,col:u}=r.getBottomEndCorner();let c=o,h=a,d=o,f=a;for(;s.length<n||c<=l;){const{skipRowOnPaste:m,visualRow:g}=this.hot.getCellMeta(c,a);if(c=g+1,m===!0)continue;d=g,h=a;const w=[],S=s.length%n;for(;w.length<i||h<=u;){const{skipColumnOnPaste:b,visualCol:y}=this.hot.getCellMeta(o,h);if(h=y+1,b===!0)continue;f=y;const _=w.length%i;w.push(e[S][_])}s.push(w)}return fs(X0,this,!0),this.hot.populateFromArray(o,a,s,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,a,d,f]}onCopy(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ei(ep,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),fs(ep,this,!1);const s=this.getRangedData(this.copyableRanges),o=ti(gi,this,Zne).call(this,this.copyableRanges);if(!!this.hot.runHooks("beforeCopy",s,this.copyableRanges,o)){const l=sf(s);if(e&&e.clipboardData){const u=m1(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",l),e.clipboardData.setData("text/html",[CM,u].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",l);this.hot.runHooks("afterCopy",s,this.copyableRanges,o)}fs(_c,this,"cells-only")}onCut(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ei(tp,this)||this.isEditorOpened()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault(),this.setCopyableText(),fs(tp,this,!1);const s=this.getRangedData(this.copyableRanges);if(!!this.hot.runHooks("beforeCut",s,this.copyableRanges)){const a=sf(s);if(e&&e.clipboardData){const l=m1(s,this.hot.rootDocument);e.clipboardData.setData("text/plain",a),e.clipboardData.setData("text/html",[CM,l].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",a);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",s,this.copyableRanges)}}onPaste(e){var r;const n=this.hot.getFocusManager().getRefocusElement(),i=(r=e.target)===null||r===void 0?void 0:r.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||e.target instanceof HTMLElement&&(i&&e.target!==n||!i&&e.target!==this.hot.rootDocument.body))return;e.preventDefault();let s;if(e&&typeof e.clipboardData<"u"){const c=Zw(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});c&&/(<table)|(<TABLE)/g.test(c)?s=uD(c,this.hot.rootDocument).data:s=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(s=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof s=="string"&&(s=uq(s)),s===void 0||s&&s.length===0||this.hot.runHooks("beforePaste",s,this.copyableRanges)===!1)return;const[o,a,l,u]=this.populateValues(s);this.hot.selectCell(o,a,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,u)),this.hot.runHooks("afterPaste",s,this.copyableRanges)}destroy(){super.destroy()}}function SM(t){if(ix()){const e=this.hot.getSelectedRangeLast();if(e){const{row:r,col:n}=e.highlight,i=this.hot.getCell(r,n,!0);i&&kN(i,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Zne(t){const{rows:e}=n2(t);let r=0;for(let n=0;n<e.length&&!(e[n]>=0);n++)r+=1;return{columnHeadersCount:r}}function Jne(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n&&Qb(n)}}}function s2(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeLast();if(t){const{row:e,col:r}=t.highlight,n=this.hot.getCell(e,r,!0);n!=null&&n.hasAttribute("contenteditable")&&ex(n)}}}function Qne(t){t.items.push({name:"---------"},Hne(this)),ei(k1,this)&&t.items.push(Lne(this)),ei(F1,this)&&t.items.push(Fne(this)),ei(L1,this)&&t.items.push(kne(this)),t.items.push($ne(this))}function eie(t,e,r,n,i){ei(X0,this)&&(i.value=!0),fs(X0,this,!1)}function tie(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function rie(){ti(gi,this,s2).call(this)}function nie(){ti(gi,this,Jne).call(this)}function iie(){ti(gi,this,s2).call(this)}function o2(t,e){return`border_row${t}col${e}`}function Xd(){return{width:1,color:"#000"}}function ta(){return{hide:!0}}function sie(){return{width:1,color:"#000",cornerVisible:!1}}function TS(t){if(ke(t.start)||ke(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(ke(t.end)||ke(t.right)){var r;t.end=(r=t.end)!==null&&r!==void 0?r:t.right}return delete t.left,delete t.right,t}function Ed(t){return ke(t.start)&&(t.left=t.start),ke(t.end)&&(t.right=t.end),t}function _S(t,e){return{id:o2(t,e),border:sie(),row:t,col:e,top:ta(),bottom:ta(),start:ta(),end:ta()}}function oie(t,e){return gr(e,"border")&&e.border&&(t.border=e.border),gr(e,"top")&&ke(e.top)&&(e.top?(ut(e.top)||(e.top=Xd()),t.top=e.top):(e.top=ta(),t.top=e.top)),gr(e,"bottom")&&ke(e.bottom)&&(e.bottom?(ut(e.bottom)||(e.bottom=Xd()),t.bottom=e.bottom):(e.bottom=ta(),t.bottom=e.bottom)),gr(e,"start")&&ke(e.start)&&(e.start?(ut(e.start)||(e.start=Xd()),t.start=e.start):(e.start=ta(),t.start=e.start)),gr(e,"end")&&ke(e.end)&&(e.end?(ut(e.end)||(e.end=Xd()),t.end=e.end):(e.end=ta(),t.end=e.end)),t}function da(t,e){let r=!1;return V(t.getSelectedRange(),n=>{n.forAll((i,s)=>{if(i<0||s<0)return;const o=t.getCellMeta(i,s).borders;if(o)if(e){if(!gr(o[e],"hide")||o[e].hide===!1)return r=!0,!1}else return r=!0,!1})}),r}function Iv(t){return`<span class="selected">â</span>${t}`}function aie(t){return t.some(e=>ke(e.left)||ke(e.right))}function lie(t){return t.some(e=>ke(e.start)||ke(e.end))}const uie=new Map([["left","start"],["right","end"]]);function cie(t){var e;return(e=uie.get(t))!==null&&e!==void 0?e:t}function hie(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(mR);return da(this,"bottom")&&(e=Iv(e)),e},callback(e,r){const n=da(this,"bottom");t.prepareBorder(r,"bottom",n)}}}function die(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let r=this.getTranslatedPhrase(pR);return da(this,e)&&(r=Iv(r)),r},callback(r,n){const i=da(this,e);t.prepareBorder(n,e,i)}}}function fie(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(wR)},callback(e,r){t.prepareBorder(r,"noBorders")},disabled(){return!da(this)}}}function gie(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let r=this.getTranslatedPhrase(gR);return da(this,e)&&(r=Iv(r)),r},callback(r,n){const i=da(this,e);t.prepareBorder(n,e,i)}}}function mie(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(fR);return da(this,"top")&&(e=Iv(e)),e},callback(e,r){const n=da(this,"top");t.prepareBorder(r,"top",n)}}}function pie(t,e){wie(t,e),e.add(t)}function wie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vie(t,e,r){return(e=Cie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Cie(t){var e=Sie(t,"string");return typeof e=="symbol"?e:e+""}function Sie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const a0="customBorders",yie=90;var AS=new WeakSet;class bie extends At{constructor(){super(...arguments),pie(this,AS),vie(this,"savedBorders",[])}static get PLUGIN_KEY(){return a0}static get PLUGIN_PRIORITY(){return yie}isEnabled(){return!!this.hot.getSettings()[a0]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>yM(AS,this,xie).call(this,e)),this.addHook("init",()=>yM(AS,this,Rie).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,r){let n=["top","bottom","start","end"],i=null;r&&(this.checkSettingsCohesion([r]),n=Object.keys(r),i=TS(r));const s=wh(e),o=Vf(s,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});V(e,a=>{o(a).forAll((l,u)=>{V(n,c=>{this.prepareBorderFromCustomAdded(l,u,i,cie(c))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const r=wh(e),n=Vf(r,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),i=[];return V(e,s=>{n(s).forAll((o,a)=>{V(this.savedBorders,l=>{l.row===o&&l.col===a&&i.push(Ed(l))})})}),i}clearBorders(e){e?this.setBorders(e):(V(this.savedBorders,r=>{this.clearBordersFromSelectionSettings(r.id),this.clearNullCellRange(),this.hot.removeCellMeta(r.row,r.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,r){this.checkSavedBorders(e)||this.savedBorders.push(e);const i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,r)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,r,n,i){const s=this.hot.countRows(),o=this.hot.countCols();if(e>=s||r>=o)return;let a=_S(e,r);n&&(a=oie(a,n),V(this.hot.selection.highlight.customSelections,l=>{if(a.id===l.settings.id)return Object.assign(l.settings,n),a.id=l.settings.id,a.top=l.settings.top,a.bottom=l.settings.bottom,a.start=l.settings.start,a.end=l.settings.end,!1})),this.hot.setCellMeta(e,r,"borders",Ed(a)),this.insertBorderIntoSettings(a,i)}prepareBorderFromCustomAddedRange(e,r){const n=Math.min(e.to.row,this.hot.countRows()-1),i=Math.min(e.to.col,this.hot.countCols()-1);Ue(e.from.row,n,s=>{Ue(e.from.col,i,o=>{const a=_S(s,o);let l=0;s===e.from.row&&gr(r,"top")&&(l+=1,a.top=r.top),s===e.to.row&&gr(r,"bottom")&&(l+=1,a.bottom=r.bottom),o===e.from.col&&gr(r,"start")&&(l+=1,a.start=r.start),o===e.to.col&&gr(r,"end")&&(l+=1,a.end=r.end),l>0&&(this.hot.setCellMeta(s,o,"borders",Ed(a)),this.insertBorderIntoSettings(a))})})}removeAllBorders(e,r){const n=o2(e,r);this.spliceBorder(n),this.clearBordersFromSelectionSettings(n),this.clearNullCellRange(),this.hot.removeCellMeta(e,r,"borders")}setBorder(e,r,n,i){let s=this.hot.getCellMeta(e,r).borders;!s||s.border===void 0?s=_S(e,r):s=TS(s),i?(s[n]=ta(),this.countHide(s)===4?this.removeAllBorders(e,r):(this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Ed(s)))):(s[n]=Xd(),this.checkCustomSelectionsFromContextMenu(s,n,i)||this.insertBorderIntoSettings(s),this.hot.setCellMeta(e,r,"borders",Ed(s)))}prepareBorder(e,r,n){V(e,i=>{let{start:s,end:o}=i;if(s.row===o.row&&s.col===o.col)r==="noBorders"?this.removeAllBorders(s.row,s.col):this.setBorder(s.row,s.col,r,n);else switch(r){case"noBorders":Ue(s.col,o.col,a=>{Ue(s.row,o.row,l=>{this.removeAllBorders(l,a)})});break;case"top":Ue(s.col,o.col,a=>{this.setBorder(s.row,a,r,n)});break;case"bottom":Ue(s.col,o.col,a=>{this.setBorder(o.row,a,r,n)});break;case"start":Ue(s.row,o.row,a=>{this.setBorder(a,s.col,r,n)});break;case"end":Ue(s.row,o.row,a=>{this.setBorder(a,o.col,r,n)});break}})}createCustomBorders(e){V(e,r=>{const n=TS(r);r.range?this.prepareBorderFromCustomAddedRange(r.range,n):this.prepareBorderFromCustomAdded(r.row,r.col,n)})}countHide(e){const{top:r,bottom:n,start:i,end:s}=e;return Hr([r,n,i,s],(a,l)=>{let u=a;return l&&l.hide&&(u+=1),u},0)}clearBordersFromSelectionSettings(e){const r=St(this.hot.selection.highlight.customSelections,n=>n.settings.id).indexOf(e);r>-1&&this.hot.selection.highlight.customSelections[r].clear()}clearNullCellRange(){V(this.hot.selection.highlight.customSelections,(e,r)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[r].destroy(),this.hot.selection.highlight.customSelections.splice(r,1),!1})}hideBorders(){V(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const r=St(this.savedBorders,n=>n.id).indexOf(e);r>-1&&this.savedBorders.splice(r,1)}checkSavedBorders(e){let r=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),r=!0):V(this.savedBorders,(i,s)=>{if(e.id===i.id)return this.savedBorders[s]=e,r=!0,!1}),r}checkCustomSelectionsFromContextMenu(e,r,n){let i=!1;return V(this.hot.selection.highlight.customSelections,s=>{if(e.id===s.settings.id){const o=this.hot.view._wt.selectionManager.getBorderInstances(s);return V(o,a=>{a.toggleHiddenClass(r,n)}),i=!0,!1}}),i}checkCustomSelections(e,r,n){const i=this.countHide(e);let s=!1;return i===4?(this.removeAllBorders(e.row,e.col),s=!0):V(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){if(o.visualCellRange=r,o.commit(),n){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);V(a,l=>{l.changeBorderStyle(n,e)})}return s=!0,!1}}),s}changeBorderSettings(){const e=this.hot.getSettings()[a0];if(Array.isArray(e)){const r=Mn(e);this.checkSettingsCohesion(r),r.length||(this.savedBorders=r),this.createCustomBorders(r)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const r=aie(e),n=lie(e);if(r&&n)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&r)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function xie(t){this.hot.getSettings()[a0]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(dR)},disabled(){const e=this.getSelectedRangeLast();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[mie(this),gie(this),hie(this),die(this),fie(this)]}})}function Rie(){this.changeBorderSettings()}function Eie(t,e){Tie(t,e),e.add(t)}function Tie(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function MS(t,e,r){return(e=_ie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _ie(t){var e=Aie(t,"string");return typeof e=="symbol"?e:e+""}function Aie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const xM="dragToScroll",Mie=100;var OS=new WeakSet;class Oie extends At{constructor(){super(...arguments),Eie(this,OS),MS(this,"boundaries",null),MS(this,"callback",null),MS(this,"listening",!1)}static get PLUGIN_KEY(){return xM}static get PLUGIN_PRIORITY(){return Mie}isEnabled(){return!!this.hot.getSettings()[xM]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>bM(OS,this,RM).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>bM(OS,this,RM).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,r){let n=0,i=0;r<this.boundaries.top?i=r-this.boundaries.top:r>this.boundaries.bottom&&(i=r-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let r=e;for(;r;)this.eventManager.addEventListener(r.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(r.document,"mousemove",n=>this.onMouseMove(n)),r=Au(r)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function RM(t){if(ml(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((r,n)=>{var i,s;const o=(i=e.scrollLeft)!==null&&i!==void 0?i:e.scrollX,a=(s=e.scrollTop)!==null&&s!==void 0?s:e.scrollY;e.scroll(o+Math.sign(r)*50,a+Math.sign(n)*20)}),this.listen()}function Iie(t,e){a2(t,e),e.add(t)}function Pie(t,e,r){a2(t,e),e.set(t,r)}function a2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IS(t,e,r){return(e=Nie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nie(t){var e=Die(t,"string");return typeof e=="symbol"?e:e+""}function Die(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hie(t,e){return t.get(Li(t,e))}function l2(t,e,r){return t.set(Li(t,e),r),r}function Li(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("afterDropdownMenuDefaultOptions");He.getSingleton().register("beforeDropdownMenuShow");He.getSingleton().register("afterDropdownMenuShow");He.getSingleton().register("afterDropdownMenuHide");He.getSingleton().register("afterDropdownMenuExecute");const l0="dropdownMenu",kie=230,jf="changeType",PS=l0;var Pv=new WeakMap,ms=new WeakSet;class Nv extends At{static get PLUGIN_KEY(){return l0}static get PLUGIN_PRIORITY(){return kie}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Mg,Og,ft,Pg,ft,xv,ft,Ig,ft,Fi]}constructor(e){super(e),Iie(this,ms),IS(this,"commandExecutor",new XH(this.hot)),IS(this,"itemsFactory",null),IS(this,"menu",null),Pie(this,Pv,!1),this.hot.addHook("afterGetColHeader",(r,n)=>Li(ms,this,Lie).call(this,r,n))}isEnabled(){return this.hot.getSettings()[l0]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new qH(this.hot,Nv.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Li(ms,e,jie).call(e,...s)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];return Li(ms,e,Uie).call(e,...s)});const r=this.hot.getSettings()[l0],n={items:this.itemsFactory.getItems(r)};this.registerEvents(),typeof r.callback=="function"&&this.commandExecutor.setCommonCallback(r.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(r);this.menu&&this.menu.destroy(),this.menu=new Ph(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:r.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",i),this.menu.setMenuItems(i),this.menu.addLocalHook("beforeOpen",()=>Li(ms,this,$ie).call(this)),this.menu.addLocalHook("afterOpen",()=>Li(ms,this,Bie).call(this)),this.menu.addLocalHook("afterSubmenuOpen",s=>Li(ms,this,Vie).call(this,s)),this.menu.addLocalHook("afterClose",()=>Li(ms,this,Wie).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var s=arguments.length,o=new Array(s),a=0;a<s;a++)o[a]=arguments[a];return e.executeCommand.call(e,...o)}),V(i,s=>this.commandExecutor.registerCommand(s.key,s))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),r=()=>{const{highlight:n}=this.hot.getSelectedRangeLast();if((n.isHeader()&&n.row===-1||n.isCell())&&n.col>=0){this.hot.selectColumns(n.col,n.col,-1);const{from:i}=this.hot.getSelectedRangeLast(),s=bv(this.menu.container,this.hot.rootDocument),o=this.hot.getCell(-1,i.col,!0).querySelector(`.${jf}`),a=o.getBoundingClientRect();this.open({left:a.left+s.left,top:a.top+o.offsetHeight+s.top},{left:a.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:PS},{keys:[["Shift","Alt","ArrowDown"]],callback:r,runOnlyIf:()=>{var n;const i=(n=this.hot.getSelectedRangeLast())===null||n===void 0?void 0:n.highlight;return i&&this.hot.selection.isCellVisible(i)&&i.isCell()&&!this.menu.isOpened()},group:PS}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(PS)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>Li(ms,this,Fie).call(this,e))}open(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(r=this.menu)!==null&&r!==void 0&&r.isOpened()||(this.menu.open(),ct(n,(i,s)=>{this.menu.setOffset(s,i)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];this.commandExecutor.execute(e,...n)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function u2(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function Fie(t){if(Qe(t.target,jf)){const e=bv(this.menu.container,this.hot.rootDocument),r=t.target.getBoundingClientRect();t.stopPropagation(),l2(Pv,this,!1),this.open({left:r.left+e.left,top:r.top+t.target.offsetHeight+e.top},{left:r.width,right:0,above:0,below:3})}}function Lie(t,e){const r=e.parentNode;if(!r)return;const n=r.parentNode.childNodes,i=Array.prototype.indexOf.call(n,r);if(t<0||i!==n.length-1)return;const s=e.querySelector(`.${jf}`);if(this.enabled&&s)return;if(!this.enabled){s&&s.parentNode.removeChild(s);return}const o=this.hot.rootDocument.createElement("button");o.className=jf,o.type="button",o.tabIndex=-1,this.hot.getSettings().ariaTags&&(qe(o,[Gu(),T0(" ")]),qe(e,[CN("menu")])),o.onclick=function(){return!1},e.firstChild.insertBefore(o,e.firstChild.firstChild)}function $ie(){this.hot.runHooks("beforeDropdownMenuShow",this)}function Bie(){this.hot.runHooks("afterDropdownMenuShow",this),Li(ms,this,u2).call(this,this.menu)}function Vie(t){Li(ms,this,u2).call(this,t)}function Wie(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function Uie(t){return Hie(Pv,this)?null:t}function jie(t){Qe(t.target,jf)&&l2(Pv,this,!0)}Nv.SEPARATOR={name:ft};function EM(t,e,r){return(e=zie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function zie(t){var e=Yie(t,"string");return typeof e=="symbol"?e:e+""}function Yie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Gie{constructor(e){EM(this,"hot",void 0),EM(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:r,endRow:n,endCol:i}=this._getDataRange(),s=this.options,o=[];return Ue(e,n,a=>{const l=[];!s.exportHiddenRows&&this._isHiddenRow(a)||(Ue(r,i,u=>{!s.exportHiddenColumns&&this._isHiddenColumn(u)||l.push(this.hot.getDataAtCell(a,u))}),o.push(l))}),o}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:r,endRow:n}=this._getDataRange(),i=this.hot.getRowHeader();Ue(r,n,s=>{!this.options.exportHiddenRows&&this._isHiddenRow(s)||e.push(i[s])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:r,endCol:n}=this._getDataRange(),i=this.hot.getColHeader();Ue(r,n,s=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(s)||e.push(i[s])})}return e}_getDataRange(){const e=this.hot.countCols()-1,r=this.hot.countRows()-1;let[n=0,i=0,s=r,o=e]=this.options.range;return n=Math.max(n,0),i=Math.max(i,0),s=Math.min(s,r),o=Math.min(o,e),{startRow:n,startCol:i,endRow:s,endCol:o}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function TM(t,e,r){return(e=Kie(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Kie(t){var e=Xie(t,"string");return typeof e=="symbol"?e:e+""}function Xie(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _E{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,r){TM(this,"dataProvider",void 0),TM(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(r),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let r=Ms(this.constructor.DEFAULT_OPTIONS);const n=new Date;return r=Dr(Ms(_E.DEFAULT_OPTIONS),r),r=Dr(r,e),r.filename=jb(r.filename,{YYYY:n.getFullYear(),MM:`${n.getMonth()+1}`.padStart(2,"0"),DD:`${n.getDate()}`.padStart(2,"0")}),r}}const qie="\r",Zie='"',Jie=`
`;class Qie extends _E{static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`}}export(){const e=this.options,r=this.dataProvider.getData();let n=this.dataProvider.getColumnHeaders();const i=n.length>0,s=this.dataProvider.getRowHeaders(),o=s.length>0;let a=e.bom?"\uFEFF":"";return i&&(n=St(n,l=>this._escapeCell(l,!0)),o&&(a+=e.columnDelimiter),a+=n.join(e.columnDelimiter),a+=e.rowDelimiter),V(r,(l,u)=>{u>0&&(a+=e.rowDelimiter),o&&(a+=this._escapeCell(s[u])+e.columnDelimiter),a+=l.map(c=>this._escapeCell(c)).join(e.columnDelimiter)}),a}_escapeCell(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=yr(e);return n!==""&&(r||n.indexOf(qie)>=0||n.indexOf(Zie)>=0||n.indexOf(Jie)>=0||n.indexOf(this.options.columnDelimiter)>=0)&&(n=n.replace(new RegExp('"',"g"),'""'),n=`"${n}"`),n}}const ese="csv",$1={[ese]:Qie};function tse(t,e,r){return typeof $1[t]=="function"?new $1[t](e,r):null}const rse="exportFile",nse=240;class ise extends At{static get PLUGIN_KEY(){return rse}static get PLUGIN_PRIORITY(){return nse}isEnabled(){return!0}exportAsString(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,r).export()}exportAsBlob(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,r))}downloadFile(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:n,rootWindow:i}=this.hot,s=this._createTypeFormatter(e,r),o=this._createBlob(s),a=i.URL||i.webkitURL,l=n.createElement("a"),u=`${s.options.filename}.${s.options.fileExtension}`;if(l.download!==void 0){const c=a.createObjectURL(o);l.style.display="none",l.setAttribute("href",c),l.setAttribute("download",u),n.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),n.body.removeChild(l),setTimeout(()=>{a.revokeObjectURL(c)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,u)}_createTypeFormatter(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!$1[e])throw new Error(`Export format type "${e}" is not supported.`);return tse(e,new Gie(this.hot),r)}_createBlob(e){let r=null;return typeof Blob<"u"&&(r=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),r}}function Mc(t,e,r){return(e=sse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sse(t){var e=ose(t,"string");return typeof e=="symbol"?e:e+""}function ose(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ng{constructor(e,r){let{id:n,stateless:i=!0}=r;Mc(this,"hot",void 0),Mc(this,"id",void 0),Mc(this,"elements",[]),Mc(this,"hidden",!1),Mc(this,"stateId",""),Mc(this,"state",void 0),this.hot=e,this.id=n,this.stateId=`Filters.component.${this.id}`,this.state=i?null:this.hot.columnIndexMapper.registerMap(this.stateId,new gv)}getElements(){return this.elements}reset(){V(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),V(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}Lt(Ng,wn);const zf={};function pl(t,e){if(!zf[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:r,descriptor:n}=zf[t];let i=e;return n.inputValuesDecorator&&(i=n.inputValuesDecorator(i)),function(s){return r.apply(s.meta.instance,[].concat([s],[i]))}}function bu(t){if(!zf[t])throw Error(`Filter condition "${t}" does not exist.`);return zf[t].descriptor}function kr(t,e,r){r.key=t,zf[t]={condition:e,descriptor:r}}const tn="none";function ase(){return!0}kr(tn,ase,{name:mv,inputsCount:0,showOperators:!1});const cf="empty";function lse(t){return br(t.value)}kr(cf,lse,{name:RR,inputsCount:0,showOperators:!0});const u0="not_empty";function use(t,e){return!pl(cf,e)(t)}kr(u0,use,{name:ER,inputsCount:0,showOperators:!0});const hf="eq";function cse(t,e){let[r]=e;return yr(t.value).toLocaleLowerCase(t.meta.locale)===yr(r)}kr(hf,cse,{name:TR,inputsCount:1,showOperators:!0});const c0="neq";function hse(t,e){return!pl(hf,e)(t)}kr(c0,hse,{name:_R,inputsCount:1,showOperators:!0});const c2="gt";function dse(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>n}kr(c2,dse,{name:PR,inputsCount:1,showOperators:!0});const h2="gte";function fse(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value>=n}kr(h2,fse,{name:NR,inputsCount:1,showOperators:!0});const d2="lt";function gse(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<n}kr(d2,gse,{name:DR,inputsCount:1,showOperators:!0});const f2="lte";function mse(t,e){let[r]=e,n=r;return t.meta.type==="numeric"&&(n=parseFloat(n,10)),t.value<=n}kr(f2,mse,{name:HR,inputsCount:1,showOperators:!0});const AE="date_after";function pse(t,e){let[r]=e;const n=Ce(t.value,t.meta.dateFormat),i=Ce(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)>=0}kr(AE,pse,{name:LR,inputsCount:1,showOperators:!0});const ME="date_before";function wse(t,e){let[r]=e;const n=Ce(t.value,t.meta.dateFormat),i=Ce(r,t.meta.dateFormat);return!n.isValid()||!i.isValid()?!1:n.diff(i)<=0}kr(ME,wse,{name:$R,inputsCount:1,showOperators:!0});const q0="between";function vse(t,e){let[r,n]=e,i=r,s=n;if(t.meta.type==="numeric"){const o=parseFloat(i,10),a=parseFloat(s,10);i=Math.min(o,a),s=Math.max(o,a)}else if(t.meta.type==="date"){const o=pl(ME,[s]),a=pl(AE,[i]);return o(t)&&a(t)}return t.value>=i&&t.value<=s}kr(q0,vse,{name:kR,inputsCount:2,showOperators:!0});const g2="not_between";function Cse(t,e){return!pl(q0,e)(t)}kr(g2,Cse,{name:FR,inputsCount:2,showOperators:!0});const m2="begins_with";function Sse(t,e){let[r]=e;return yr(t.value).toLocaleLowerCase(t.meta.locale).startsWith(yr(r))}kr(m2,Sse,{name:AR,inputsCount:1,showOperators:!0});const p2="ends_with";function yse(t,e){let[r]=e;return yr(t.value).toLocaleLowerCase(t.meta.locale).endsWith(yr(r))}kr(p2,yse,{name:MR,inputsCount:1,showOperators:!0});const OE="contains";function bse(t,e){let[r]=e;return yr(t.value).toLocaleLowerCase(t.meta.locale).indexOf(yr(r))>=0}kr(OE,bse,{name:OR,inputsCount:1,showOperators:!0});const w2="not_contains";function xse(t,e){return!pl(OE,e)(t)}kr(w2,xse,{name:IR,inputsCount:1,showOperators:!0});const v2="date_tomorrow";function Rse(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().subtract(-1,"days").startOf("day"),"d"):!1}kr(v2,Rse,{name:VR,inputsCount:0});const C2="date_today";function Ese(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().startOf("day"),"d"):!1}kr(C2,Ese,{name:BR,inputsCount:0});const S2="date_yesterday";function Tse(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().subtract(1,"days").startOf("day"),"d"):!1}kr(S2,Tse,{name:WR,inputsCount:0});zN();function _se(t,e){let r=t;return r===""&&(r=`(${e})`),r}const B1=new Set([1]).has(1),Ase=B1&&typeof Array.from=="function";function Dg(t){let e=t;return B1&&(e=new Set(e)),function(r){let n;return B1?n=e.has(r):n=!!~e.indexOf(r),n}}function y2(t){return t??""}function V1(t){let e=t;return Ase?e=Array.from(new Set(e)):e=Vb(e),e=e.sort((r,n)=>typeof r=="number"&&typeof n=="number"?r-n:r===n?0:r>n?1:-1),e}function _M(t,e,r,n){const i=[],s=t===e;let o;return s||(o=Dg(e)),V(t,a=>{let l=!1;(s||o(a))&&(l=!0);const u={checked:l,value:a,visualValue:_se(a,r)};n&&n(u),i.push(u)}),i}const xu="by_value";function Mse(t,e){let[r]=e;return r(t.value)}kr(xu,Mse,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[Dg(e)]},showOperators:!1});const Yf={};function Ose(t){if(!Yf[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Yf[t].func;return function(r,n){return e(r,n)}}function Ise(t){return Yf[t].name}function IE(t,e,r){Yf[t]={name:e,func:r}}const hl="conjunction",Pse=zR;function Nse(t,e){return t.every(r=>r.func(e))}IE(hl,Pse,Nse);const Z0="disjunction",Dse=pv;function Hse(t,e){return t.some(r=>r.func(e))}IE(Z0,Dse,Hse);const PE="disjunctionWithExtraCondition",kse=pv;function Fse(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(r=>r.func(e))&&t[t.length-1].func(e)}IE(PE,kse,Fse);const Lse="numeric",b2="text",$se="date",AM={[Lse]:[tn,ft,cf,u0,ft,hf,c0,ft,c2,h2,d2,f2,q0,g2],[b2]:[tn,ft,cf,u0,ft,hf,c0,ft,m2,p2,ft,OE,w2],[$se]:[tn,ft,cf,u0,ft,hf,c0,ft,ME,AE,q0,ft,v2,C2,S2]};function Bse(t){const e=[];let r=t;return AM[r]||(r=b2),V(AM[r],n=>{let i;n===ft?i={name:ft}:i=Ms(bu(n)),e.push(i)}),e}function Td(t,e,r){return(e=Vse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Vse(t){var e=Wse(t,"string");return typeof e=="symbol"?e:e+""}function Wse(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const NS="built",DS="building",MM=["click","input","keydown","keypress","keyup","focus","blur","change"];let Rs=class x2{static get DEFAULTS(){return Ms({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,r){Td(this,"hot",void 0),Td(this,"eventManager",new Xi(this)),Td(this,"options",void 0),Td(this,"_element",void 0),Td(this,"buildState",void 0),this.hot=e,this.options=Dr(x2.DEFAULTS,r),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===DS?this._element:this.buildState===NS?(this.update(),this._element):(this.buildState=DS,this.build(),this.buildState=NS,this._element)}isBuilt(){return this.buildState===NS}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Wn)?this.hot.getTranslatedPhrase(e):e}build(){const e=(r,n)=>{this.eventManager.addEventListener(r,n,i=>this.runLocalHooks(n,i,this))};if(this.buildState||(this.buildState=DS),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&ve(this._element,this.options.className),this.options.children.length)V(this.options.children,r=>this._element.appendChild(r.element));else if(this.options.wrapIt){const r=this.hot.rootDocument.createElement(this.options.tagName);r.setAttribute("data-hot-input",!0),ct(this.options,(n,i)=>{r[i]!==void 0&&i!=="className"&&i!=="tagName"&&i!=="children"&&(r[i]=this.translateIfPossible(n))}),this._element.appendChild(r),V(MM,n=>e(r,n))}else V(MM,r=>e(this._element,r))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};Lt(Rs,wn);function Use(t,e){R2(t,e),e.add(t)}function jse(t,e,r){R2(t,e),e.set(t,r)}function R2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rp(t,e){return t.get(NE(t,e))}function zse(t,e,r){return t.set(NE(t,e),r),r}function NE(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Oc=new WeakMap,OM=new WeakSet;class dl extends Rs{static get DEFAULTS(){return Ms({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,r){super(e,Dr(dl.DEFAULTS,r)),Use(this,OM),jse(this,Oc,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>NE(OM,this,Yse).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");zse(Oc,this,this._element.firstChild),ve(this._element,"htUIInput"),ve(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(rp(Oc,this).type=this.options.type,rp(Oc,this).placeholder=this.translateIfPossible(this.options.placeholder),rp(Oc,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&rp(Oc,this).focus()}}function Yse(t){this.options.value=t.target.value}function Gse(t,e){E2(t,e),e.add(t)}function _d(t,e,r){E2(t,e),e.set(t,r)}function E2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ic(t,e,r){return t.set(df(t,e),r),r}function mr(t,e){return t.get(df(t,e))}function df(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var jr=new WeakMap,np=new WeakMap,ip=new WeakMap,HS=new WeakMap,sp=new WeakMap,op=new WeakSet;class Gf extends Rs{static get DEFAULTS(){return Ms({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,r){super(e,Dr(Gf.DEFAULTS,r)),Gse(this,op),_d(this,jr,null),_d(this,np,[]),_d(this,ip,void 0),_d(this,HS,void 0),_d(this,sp,void 0),this.registerHooks()}getMenu(){return mr(jr,this)}registerHooks(){this.addLocalHook("click",()=>df(op,this,qse).call(this))}setItems(e){Ic(np,this,this.translateNames(e)),mr(jr,this)&&mr(jr,this).setMenuItems(mr(np,this))}translateNames(e){return V(e,r=>{r.name=this.translateIfPossible(r.name)}),e}build(){super.build(),Ic(jr,this,new Ph(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),mr(jr,this).setMenuItems(mr(np,this));const e=new Rs(this.hot,{className:"htUISelectCaption"}),r=new Rs(this.hot,{className:"htUISelectDropdown"});Ic(ip,this,e),Ic(HS,this,e.element),Ic(sp,this,r),this.hot.getSettings().ariaTags&&(qe(r.element,[Gu()]),qe(this._element,[vN()])),V([e,r],n=>this._element.appendChild(n.element)),mr(jr,this).addLocalHook("select",n=>df(op,this,Kse).call(this,n)),mr(jr,this).addLocalHook("afterClose",()=>df(op,this,Xse).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=mr(jr,this).hot.getTranslatedPhrase(mv),mr(HS,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();mr(jr,this)&&(mr(jr,this).open(),mr(jr,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),mr(jr,this).getNavigator().toFirstItem(),mr(jr,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:r=>{this.closeOptions(),this.runLocalHooks("tabKeydown",r)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){mr(jr,this)&&mr(jr,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){mr(jr,this)&&(mr(jr,this).destroy(),Ic(jr,this,null)),mr(ip,this)&&mr(ip,this).destroy(),mr(sp,this)&&mr(sp,this).destroy(),super.destroy()}}function Kse(t){t.name!==ft&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function Xse(){this.runLocalHooks("afterClose")}function qse(){this.openOptions()}function Zse(t,e){Jse(t,e),e.add(t)}function Jse(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function IM(t,e,r){return(e=Qse(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Qse(t){var e=eoe(t,"string");return typeof e=="symbol"?e:e+""}function eoe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PM(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var kS=new WeakSet;class W1 extends Ng{constructor(e,r){super(e,{id:r.id,stateless:!1}),Zse(this,kS),IM(this,"name",""),IM(this,"addSeparator",!1),this.name=r.name,this.addSeparator=r.addSeparator,this.elements.push(new Gf(this.hot,{menuContainer:r.menuContainer})),this.elements.push(new dl(this.hot,{placeholder:ZR})),this.elements.push(new dl(this.hot,{placeholder:JR})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>PM(kS,this,toe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),V(this.getInputElements(),e=>{e.addLocalHook("keydown",r=>PM(kS,this,roe).call(this,r))})}setState(e){if(this.reset(),!e)return;const r=Ms(e.command);r.name.startsWith(xr)&&(r.name=this.hot.getTranslatedPhrase(r.name)),this.getSelectElement().setValue(r),V(e.args,(n,i)=>{if(i>r.inputsCount-1)return!1;const s=this.getInputElement(i);s.setValue(n),s[r.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>s.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||bu(tn),r=[];return V(this.getInputElements(),(n,i)=>{e.inputsCount>i&&r.push(n.getValue())}),{command:e,args:r}}updateState(e,r){const n=bu(e?e.name:tn);this.state.setValueAtIndex(r,{command:n,args:e?e.args:[]}),e||V(this.getInputElements(),i=>i.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Gf)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof dl)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{ve(r.parentNode,"htFiltersMenuCondition"),this.addSeparator&&ve(r.parentNode,"border");const a=this.hot.rootDocument.createElement("div");return ve(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||V(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let r=[bu(tn)];if(e!==null){const{visualIndex:n}=e;r=Bse(this.hot.getDataType(0,n,this.hot.countRows(),n))}V(this.getInputElements(),n=>n.hide()),this.getSelectElement().setItems(r),super.reset(),this.getSelectElement().setValue(r[0])}}function toe(t){V(this.getInputElements(),(e,r)=>{e[t.inputsCount>r?"show":"hide"](),r===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function roe(t){Ah(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ji(t))}function NM(t,e,r){noe(t,e),e.set(t,r)}function noe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ad(t,e){return t.get(T2(t,e))}function DM(t,e,r){return t.set(T2(t,e),r),r}function T2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Pc=new WeakMap,FS=new WeakMap;class J0 extends Rs{static get DEFAULTS(){return Ms({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,r){super(e,Dr(J0.DEFAULTS,r)),NM(this,Pc,void 0),NM(this,FS,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),DM(FS,this,e),DM(Pc,this,this._element.firstChild),Ad(Pc,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(Ad(FS,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?Ad(Pc,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(Ad(Pc,this).checked=e)}focus(){this.isBuilt()&&Ad(Pc,this).focus()}}function ioe(t,e){soe(t,e),e.add(t)}function soe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ooe(t,e,r){return(e=aoe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function aoe(t){var e=loe(t,"string");return typeof e=="symbol"?e:e+""}function loe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function uoe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const HM=0;var kM=new WeakSet;class coe extends Ng{constructor(e,r){super(e,{id:r.id,stateless:!1}),ioe(this,kM),ooe(this,"name",""),this.name=r.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(ve(r.parentNode,"htFiltersMenuOperators"),V(this.elements,n=>r.appendChild(n.element)),r)}}buildOperatorsElement(){const e=[hl,Z0];V(e,r=>{const n=new J0(this.hot,{name:"operator",label:{htmlFor:r,textContent:Ise(r)},value:r,checked:r===e[HM],id:r});n.addLocalHook("change",i=>uoe(kM,this,hoe).call(this,i)),this.elements.push(n)})}setChecked(e){if(this.elements.length<e)throw Error(Ft`Radio button with index ${e} doesn't exist.`);V(this.elements,(r,n)=>{r.setChecked(n===e)})}getActiveOperationId(){const e=this.elements.find(r=>r instanceof J0&&r.isChecked());return e?e.getValue():hl}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&V(this.elements,r=>{r.setChecked(r.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:hl,r=arguments.length>1?arguments[1]:void 0,n=e;n===PE&&(n=Z0),this.state.setValueAtIndex(r,n)}reset(){this.setChecked(HM)}}function hoe(t){this.setState(t.target.value)}function doe(t,e,r){foe(t,e),e.set(t,r)}function foe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function LS(t,e){return t.get(_2(t,e))}function goe(t,e,r){return t.set(_2(t,e),r),r}function _2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Md=new WeakMap;class Kf extends Rs{static get DEFAULTS(){return Ms({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,r){super(e,Dr(Kf.DEFAULTS,r)),doe(this,Md,void 0)}build(){super.build(),goe(Md,this,this._element.firstChild)}update(){this.isBuilt()&&(LS(Md,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&LS(Md,this).focus()}activate(){LS(Md,this).click()}}function moe(t,e){A2(t,e),e.add(t)}function Nc(t,e,r){A2(t,e),e.set(t,r)}function A2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ot(t,e){return t.get(th(t,e))}function as(t,e,r){return t.set(th(t,e),r),r}function th(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const FM="multipleSelect.itemBox";var ps=new WeakMap,Pr=new WeakMap,$S=new WeakMap,Bo=new WeakMap,Na=new WeakMap,Da=new WeakMap,Od=new WeakSet;class Xf extends Rs{static get DEFAULTS(){return Ms({className:"htUIMultipleSelect",value:[]})}constructor(e,r){super(e,Dr(Xf.DEFAULTS,r)),moe(this,Od),Nc(this,ps,[]),Nc(this,Pr,void 0),Nc(this,$S,void 0),Nc(this,Bo,void 0),Nc(this,Na,void 0),Nc(this,Da,void 0),as(Bo,this,new dl(this.hot,{placeholder:qR,className:"htUIMultipleSelectSearch"})),as(Na,this,new Kf(this.hot,{textContent:YR,className:"htUISelectAll"})),as(Da,this,new Kf(this.hot,{textContent:GR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ot(Pr,this)}registerHooks(){ot(Bo,this).addLocalHook("keydown",e=>th(Od,this,woe).call(this,e)),ot(Bo,this).addLocalHook("input",e=>th(Od,this,poe).call(this,e)),ot(Na,this).addLocalHook("click",e=>th(Od,this,voe).call(this,e)),ot(Da,this).addLocalHook("click",e=>th(Od,this,Coe).call(this,e))}setItems(e){var r;as(ps,this,e),(r=ot(Pr,this))===null||r===void 0||r.loadData(ot(ps,this))}setLocale(e){as($S,this,e)}getLocale(){return ot($S,this)}getItems(){return[...ot(ps,this)]}getValue(){return yoe(ot(ps,this))}getSearchInputElement(){return ot(Bo,this)}getSelectAllElement(){return ot(Na,this)}getClearAllElement(){return ot(Da,this)}isSelectedAllValues(){return ot(ps,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,r=e.createElement("div"),n=new Rs(this.hot,{className:"htUISelectionControls",children:[ot(Na,this),ot(Da,this)]});this._element.appendChild(ot(Bo,this).element),this._element.appendChild(n.element),this._element.appendChild(r);const i=s=>{var o;if(!this._element)return;(o=ot(Pr,this))===null||o===void 0||o.destroy(),ve(s,"htUIMultipleSelectHot"),as(Pr,this,new this.hot.constructor(s,{data:ot(ps,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(u,c,h,d,f,m)=>{u.title=m.instance.getDataAtRowProp(c,m.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ot(Pr,this).listen()},colWidths:()=>ot(Pr,this).container.scrollWidth-qr(e),maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ot(Pr,this).init();const l=ot(Pr,this).getShortcutManager().getContext("grid");l.removeShortcutsByKeys(["Tab"]),l.removeShortcutsByKeys(["Shift","Tab"]),l.addShortcut({keys:[["Escape"]],callback:u=>{this.runLocalHooks("keydown",u,this)},group:FM}),l.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:u=>{ot(Pr,this).deselectCell(),this.runLocalHooks("keydown",u,this),this.runLocalHooks("listTabKeydown",u,this)},group:FM})};i(r),this.hot._registerTimeout(()=>i(r),100)}focus(){this.isBuilt()&&ot(Pr,this).listen()}reset(){ot(Bo,this).reset(),ot(Na,this).reset(),ot(Da,this).reset()}update(){this.isBuilt()&&(ot(Pr,this).loadData(Soe(ot(ps,this),this.options.value)),super.update())}destroy(){var e;(e=ot(Pr,this))===null||e===void 0||e.destroy(),ot(Bo,this).destroy(),ot(Da,this).destroy(),ot(Na,this).destroy(),as(Bo,this,null),as(Da,this,null),as(Na,this,null),as(Pr,this,null),as(ps,this,null),super.destroy()}}function poe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let r;e===""?r=[...ot(ps,this)]:r=ot(ps,this).filter(n=>`${n.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),ot(Pr,this).loadData(r)}function woe(t){this.runLocalHooks("keydown",t,this),tx(Ah,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),Ji(t),ot(Pr,this).listen(),ot(Pr,this).selectCell(0,0))}function voe(t){const e=[];t.preventDefault(),ot(Pr,this).getSourceData().forEach((r,n)=>{r.checked=!0,e.push(Dx(r,n)[0])}),ot(Pr,this).setSourceDataAtCell(e)}function Coe(t){const e=[];t.preventDefault(),ot(Pr,this).getSourceData().forEach((r,n)=>{r.checked=!1,e.push(Dx(r,n)[0])}),ot(Pr,this).setSourceDataAtCell(e)}function Soe(t,e){const r=Dg(e);return t.map(n=>(n.checked=r(n.value),n))}function yoe(t){const e=[];return t.forEach(r=>{r.checked&&e.push(r.value)}),e}function boe(t,e){xoe(t,e),e.add(t)}function xoe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Roe(t,e,r){return(e=Eoe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Eoe(t){var e=Toe(t,"string");return typeof e=="symbol"?e:e+""}function Toe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ap(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Id=new WeakSet;class _oe extends Ng{constructor(e,r){super(e,{id:r.id,stateless:!1}),boe(this,Id),Roe(this,"name",""),this.name=r.name,this.elements.push(new Xf(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>ap(Id,this,Aoe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,r)=>ap(Id,this,Moe).call(this,e,r))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===xu){const r=this.getMultipleSelectElement();r.setItems(e.itemsSnapshot),r.setValue(e.args[0]),r.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),r=e.getItems();return{command:{key:e.isSelectedAllValues()||!r.length?tn:xu},args:[e.getValue()],itemsSnapshot:r}}updateState(e){const r=(n,i,s,o,a)=>{const[l]=ha(i,h=>h.name===xu),u={},c=this.hot.getTranslatedPhrase(B0);if(l){const h=o(n,a),d=St(h,b=>b.value),f=new Map(h.map(b=>[b.value,this.hot.getCellMeta(b.meta.visualRow,b.meta.visualCol)])),m=V1(d);s&&(l.args[0]=s);const g=[],w=_M(m,l.args[0],c,b=>{b.checked&&g.push(b.value),ap(Id,this,LM).call(this,b,f)}),S=e.editedConditionStack.column;u.locale=this.hot.getCellMeta(0,S).locale,u.args=[g],u.command=bu(xu),u.itemsSnapshot=w}else u.args=[],u.command=bu(tn);this.state.setValueAtIndex(n,u)};r(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&r(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Xf)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r,n,i,s,o)=>{ve(r.parentNode,"htFiltersMenuValue");const a=this.hot.rootDocument.createElement("div");return ve(a,"htFiltersMenuLabel"),a.textContent=o,r.appendChild(a),r.parentElement.hasAttribute("ghost-table")||V(this.elements,l=>r.appendChild(l.element)),r}}}reset(){const e=this.hot.getTranslatedPhrase(B0),r=this._getColumnVisibleValues(),n=r.map(l=>l.value),i=new Map(r.map(l=>[l.value,l.meta])),s=V1(n),o=_M(s,s,e,l=>{ap(Id,this,LM).call(this,l,i)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(s);const a=this.hot.getPlugin("filters").getSelectedColumn();a!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,a.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:St(this.hot.getDataAtCol(e.visualIndex),(r,n)=>({value:y2(r),meta:this.hot.getCellMeta(n,e.visualIndex)}))}}function Aoe(t){Ah(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),Ji(t))}function LM(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function Moe(t,e){switch(e.type){case"numeric":return yH(t,e);default:return t}}var M2;function Ooe(t,e){Ioe(t,e),e.add(t)}function Ioe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Poe(t,e,r){return(e=Noe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Noe(t){var e=Doe(t,"string");return typeof e=="symbol"?e:e+""}function Doe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hoe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var $M=new WeakSet;class qf extends Ng{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,r){super(e,{id:r.id,stateless:!0}),Ooe(this,$M),Poe(this,"name",""),this.name=r.name,this.elements.push(new dl(this.hot,{type:"button",value:KR,className:"htUIButton htUIButtonOK",identifier:qf.BUTTON_OK})),this.elements.push(new dl(this.hot,{type:"button",value:XR,className:"htUIButton htUIButtonCancel",identifier:qf.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){V(this.elements,e=>{e.addLocalHook("click",(r,n)=>Hoe($M,this,koe).call(this,r,n))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,r)=>(ve(r.parentNode,"htFiltersMenuActionBar"),V(this.elements,n=>r.appendChild(n.element)),r)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}M2=qf;function koe(t,e){e.options.identifier===M2.BUTTON_OK?this.accept():this.cancel()}function lp(t,e,r){return(e=Foe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Foe(t){var e=Loe(t,"string");return typeof e=="symbol"?e:e+""}function Loe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const BM="ConditionCollection.filteringStates";class DE{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;lp(this,"hot",void 0),lp(this,"isMapRegistrable",void 0),lp(this,"filteringStates",new gv),lp(this,"previousConditionStack",null),this.hot=e,this.isMapRegistrable=r,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(BM,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,r){var n;const i=this.filteringStates.getValueAtIndex(r),s=(n=i==null?void 0:i.conditions)!==null&&n!==void 0?n:[],o=i==null?void 0:i.operation;return this.isMatchInConditions(s,e,o)}isMatchInConditions(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hl;return e.length?Ose(n)(e,r):!0}addCondition(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hl,i=arguments.length>3?arguments[3]:void 0;const s=this.hot.getCellMeta(0,e).locale,o=St(r.args,c=>typeof c=="string"?c.toLocaleLowerCase(s):c),a=r.name||r.command.key;this.previousConditionStack===null&&this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeAdd",e);const l=this.getOperation(e);if(l){if(l!==n)throw Error(Ft`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(er(Yf[n]))throw new Error(Ft`Unexpected operation named \`${n}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const u=this.getConditions(e);u.length===0?this.filteringStates.setValueAtIndex(e,{operation:n,conditions:[{name:a,args:o,func:pl(a,o)}]},i):u.push({name:a,args:o,func:pl(a,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var r,n;return(r=(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.conditions)!==null&&r!==void 0?r:[]}getOperation(e){var r;return(r=this.filteringStates.getValueAtIndex(e))===null||r===void 0?void 0:r.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[r]=e;return r})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return Hr(this.filteringStates.getEntries(),(e,r)=>{let[n,{operation:i,conditions:s}]=r;return e.push({column:n,operation:i,conditions:St(s,o=>{let{name:a,args:l}=o;return{name:a,args:l}})}),e},[])}importAllConditions(e){this.clean(),V(e,r=>{V(r.conditions,n=>this.addCondition(r.column,n))})}removeConditions(e){this.setPreviousConditionStack(this.exportAllConditions()),this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,r){const n=this.getConditions(e);return r?n.some(i=>i.name===r):n.length>0}setPreviousConditionStack(e){this.previousConditionStack=e}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(BM),this.filteringStates=null,this.clearLocalHooks()}}Lt(DE,wn);function VM(t,e,r){return(e=$oe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $oe(t){var e=Boe(t,"string");return typeof e=="symbol"?e:e+""}function Boe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class O2{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];VM(this,"conditionCollection",void 0),VM(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=r}filter(){let e=[];return V(this.conditionCollection.getFilteredColumns(),(r,n)=>{let i=this.columnDataFactory(r);n&&(i=this._getIntersectData(i,e)),e=this.filterByColumn(r,i)}),e}filterByColumn(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];return V(r,i=>{i!==void 0&&this.conditionCollection.isMatch(i,e)&&n.push(i)}),n}_getIntersectData(e,r){const n=[];return V(r,i=>{const s=i.meta.visualRow;e[s]!==void 0&&(n[s]=e[s])}),n}}function Voe(t,e){Woe(t,e),e.add(t)}function Woe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ql(t,e,r){return(e=Uoe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Uoe(t){var e=joe(t,"string");return typeof e=="symbol"?e:e+""}function joe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function BS(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var up=new WeakSet;class I2{constructor(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];Voe(this,up),ql(this,"hot",void 0),ql(this,"conditionCollection",void 0),ql(this,"columnDataFactory",void 0),ql(this,"changes",[]),ql(this,"grouping",!1),ql(this,"latestEditedColumnPosition",-1),ql(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=r,this.columnDataFactory=n,this.conditionCollection.addLocalHook("beforeRemove",i=>BS(up,this,zoe).call(this,i)),this.conditionCollection.addLocalHook("afterRemove",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("afterAdd",i=>this.updateStatesAtColumn(i)),this.conditionCollection.addLocalHook("beforeClean",()=>BS(up,this,Yoe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>BS(up,this,Goe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,V(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,r){var n=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const i=this.conditionCollection.exportAllConditions();let s=this.conditionCollection.getColumnStackPosition(e);s===-1&&(s=this.latestEditedColumnPosition);const o=i.slice(0,s),a=i.slice(s);a.length&&a[0].column===e&&a.shift();const l=LN(function(c,h){let d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const f=new DE(n.hot,!1),m=[].concat(c,d);f.importAllConditions(m);const g=n.columnDataFactory(h);let w;f.isEmpty()?w=g:w=new O2(f,b=>n.columnDataFactory(b)).filter(),w=St(w,b=>b.meta.visualRow);const S=Dg(w);return f.destroy(),ha(g,b=>S(b.meta.visualRow))})(o),u=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:u},dependentConditionStacks:a,filteredRowsFactory:l,conditionArgsChange:r})}destroy(){this.clearLocalHooks(),ct(this,(e,r)=>{this[r]=null})}}function zoe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function Yoe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function Goe(){V(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}Lt(I2,wn);function Koe(t){return JH({initialPage:0,size:()=>t.length,onItemSelect:(r,n)=>{const i=t[r];if(i instanceof Xf)return n;if(i.element&&!Mu(i.element))return!1;i.focus()}})}const Pd="filters";function Xoe(t,e){let r=-1;const n=Koe(e),i=l=>()=>{t.isOpened()&&t.getKeyboardShortcutsCtrl().listen(Pd),n.setCurrentPage(e.indexOf(l))};e.forEach(l=>{l instanceof Rs&&(l.addLocalHook("click",i(l)),l.addLocalHook("focus",i(l)),l.addLocalHook("afterClose",i(l)))}),t.addLocalHook("afterSelectionChange",l=>{l.key.startsWith("filter_")||n.clear()});function s(l){const u=t.getKeyboardShortcutsCtrl(),c=l.getKeyboardShortcutsCtrl();n.clear(),c.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:u.getContext(Pd),callback:()=>{l.isSubMenu()&&l.close(),u.listen(Pd)}}]),!l.isSubMenu()&&u.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:h=>{const d=t.getNavigator();d.getCurrentPage()>-1&&(r=d.getCurrentPage()),d.clear(),h.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{t.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:h=>{const d=e[n.getCurrentPage()];d instanceof Gf&&(d.openOptions(),h.preventDefault()),d instanceof Kf&&(d.activate(),h.preventDefault()),d instanceof Rs||h.preventDefault()}}],Pd)}t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s);function o(){t.focus(),t.getKeyboardShortcutsCtrl().listen(Pd)}function a(){return r}return{...n,listen:o,getLastMenuPage:a}}function qoe(t,e){P2(t,e),e.add(t)}function Zoe(t,e,r){P2(t,e),e.set(t,r)}function P2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Nd(t,e,r){return(e=Joe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Joe(t){var e=Qoe(t,"string");return typeof e=="symbol"?e:e+""}function Qoe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eae(t,e,r){return t.set(fi(t,e),r),r}function Dd(t,e){return t.get(fi(t,e))}function fi(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const U1="filters",tae=250,WM=U1;var Zl=new WeakMap,Pi=new WeakSet;class rae extends At{static get PLUGIN_KEY(){return U1}static get PLUGIN_PRIORITY(){return tae}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){super(e),qoe(this,Pi),Nd(this,"dropdownMenuPlugin",null),Nd(this,"conditionCollection",null),Nd(this,"conditionUpdateObserver",null),Nd(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),Nd(this,"filtersRowsMap",null),Zoe(this,Zl,void 0),this.hot.addHook("afterGetColHeader",(r,n)=>fi(Pi,this,lae).call(this,r,n))}isEnabled(){return!!this.hot.getSettings()[U1]}enablePlugin(){if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Tg),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const e=this.hot.getSettings().dropdownMenu,r=e&&e.uiContainer||this.hot.rootDocument.body,n=o=>(o.addLocalHook("accept",()=>fi(Pi,this,UM).call(this,"accept")),o.addLocalHook("cancel",()=>fi(Pi,this,UM).call(this,"cancel")),o.addLocalHook("change",a=>fi(Pi,this,aae).call(this,o,a)),o),i=()=>`${this.hot.getTranslatedPhrase(UR)}:`,s=()=>`${this.hot.getTranslatedPhrase(jR)}:`;if(!this.components.get("filter_by_condition")){const o=new W1(this.hot,{id:"filter_by_condition",name:i,addSeparator:!1,menuContainer:r});o.addLocalHook("afterClose",()=>fi(Pi,this,jM).call(this)),this.components.set("filter_by_condition",n(o))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new coe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const o=new W1(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:r});o.addLocalHook("afterClose",()=>fi(Pi,this,jM).call(this)),this.components.set("filter_by_condition2",n(o))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",n(new _oe(this.hot,{id:"filter_by_value",name:s}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",n(new qf(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new DE(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new I2(this.hot,this.conditionCollection,o=>this.getDataMapAtColumn(o)),this.conditionUpdateObserver.addLocalHook("update",o=>fi(Pi,this,uae).call(this,o))),this.components.forEach(o=>o.show()),this.addHook("afterDropdownMenuDefaultOptions",o=>fi(Pi,this,oae).call(this,o)),this.addHook("afterDropdownMenuShow",()=>fi(Pi,this,iae).call(this)),this.addHook("afterDropdownMenuHide",()=>fi(Pi,this,sae).call(this)),this.addHook("afterChange",o=>fi(Pi,this,nae).call(this,o)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!Dd(Zl,this)&&this.dropdownMenuPlugin.enabled){const o=this.dropdownMenuPlugin.menu,a=[{focus:()=>{const u=o.getNavigator(),c=Dd(Zl,this).getLastMenuPage();o.focus(),c>0?u.setCurrentPage(c):u.toFirstItem()}},...Array.from(this.components).map(u=>{let[,c]=u;return c.getElements()}).flat()];eae(Zl,this,Xoe(o,a));const l=u=>{Dd(Zl,this).listen(),u.preventDefault(),Ah(u.keyCode,"TAB")&&(u.shiftKey?Dd(Zl,this).toPreviousItem():Dd(Zl,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",l),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",l)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((r,n)=>{r.destroy(),this.components.set(n,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:WM})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(WM)}addCondition(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:hl;const s=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(s,{command:{key:r},args:n},i)}removeConditions(e){const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const r=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(r)}}filter(){const{navigableHeaders:e}=this.hot.getSettings(),r=this._createDataFilter(),n=!this.conditionCollection.isEmpty();let i=[];const s=this.conditionCollection.exportAllConditions();if(this.hot.runHooks("beforeFilter",s,this.conditionCollection.previousConditionStack)!==!1)if(n){const a=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),i=St(r.filter(),u=>u.meta.visualRow);const l=Dg(i);Ue(this.hot.countSourceRows()-1,u=>{l(u)||a.push(u)}),V(a,u=>{this.filtersRowsMap.setValueAtIndex(u,!0)})},!0),!e&&!i.length&&this.hot.deselectCell()}else this.filtersRowsMap.clear();this.hot.runHooks("afterFilter",s),this.conditionCollection.setPreviousConditionStack(null),this.hot.view.adjustElementsSize(),this.hot.render(),this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col)}getSelectedColumn(){var e;const r=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return r?{visualIndex:r.col,physicalIndex:this.hot.toPhysicalColumn(r.col)}:null}getDataMapAtColumn(e){const r=this.hot.toVisualColumn(e),n=[];return V(this.hot.getSourceDataAtCol(r),(i,s)=>{var o;const{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m}=this.hot.getCellMeta(s,r),g=(o=this.hot.getDataAtCell(this.hot.toVisualRow(s),r))!==null&&o!==void 0?o:i;n.push({meta:{row:a,col:l,visualCol:u,visualRow:c,type:h,instance:d,dateFormat:f,locale:m},value:y2(g)})}),n}updateValueComponentCondition(e){const r=this.hot.getDataAtCol(e),n=V1(r);this.conditionUpdateObserver.updateStatesAtColumn(e,n)}restoreComponents(e){var r;const n=(r=this.getSelectedColumn())===null||r===void 0?void 0:r.physicalIndex;e.forEach(i=>{i.isHidden()||i.restoreState(n)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,r,n,i){let s=e;return s===Z0&&r.command.key!==tn&&n.command.key!==tn&&i.command.key!==tn?s=PE:i.command.key!==tn&&(r.command.key===tn||n.command.key===tn)&&(s=hl),s}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:r}=e.getState(),n=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];r.showOperators?this.showComponents(...n):this.hideComponents(...n)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new O2(e,r=>this.getDataMapAtColumn(r))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const r=this.dropdownMenuPlugin.menu;for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return V(i,o=>{V(r.menuItems,(a,l)=>{a.key===o.getMenuItemDescriptor().key&&e.push(l)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const n=this.dropdownMenuPlugin.menu.hotMenu,i=n.getPlugin("hiddenRows");for(var s=arguments.length,o=new Array(s>1?s-1:0),a=1;a<s;a++)o[a-1]=arguments[a];const l=this.getIndexesOfComponents(...o);e?i.showRows(l):i.hideRows(l),n.render()}hideComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!1,...r)}showComponents(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.changeComponentsVisibility(!0,...r)}destroy(){this.enabled&&(this.components.forEach((e,r)=>{e!==null&&(e.destroy(),this.components.set(r,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function nae(t){t&&V(t,e=>{const[,r]=e,n=this.hot.propToCol(r);this.conditionCollection.hasConditions(n)&&this.updateValueComponentCondition(n)})}function iae(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function sae(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function oae(t){t.items.push({name:ft}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function UM(t){var e;if(t==="accept"){const n=this.getSelectedColumn();if(n===null){var r;(r=this.dropdownMenuPlugin)===null||r===void 0||r.close();return}const{physicalIndex:i}=n,s=this.components.get("filter_by_condition").getState(),o=this.components.get("filter_by_condition2").getState(),a=this.components.get("filter_by_value").getState(),l=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),s,o,a);this.conditionUpdateObserver.groupChanges();let u=this.conditionCollection.getColumnStackPosition(i);u===-1&&(u=void 0),this.conditionCollection.removeConditions(i),s.command.key!==tn&&(this.conditionCollection.addCondition(i,s,l,u),o.command.key!==tn&&this.conditionCollection.addCondition(i,o,l,u)),a.command.key!==tn&&this.conditionCollection.addCondition(i,a,l,u),this.conditionUpdateObserver.flush(),this.components.forEach(c=>c.saveState(i)),this.filtersRowsMap.clear(),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function aae(t,e){this.updateDependentComponentsVisibility(),t.constructor===W1&&!e.inputsCount&&this.setListeningDropdownMenu()}function jM(){this.setListeningDropdownMenu()}function lae(t,e){const r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)?ve(e,"htFiltersActive"):tt(e,"htFiltersActive")}function uae(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:r,column:n}}=t,i=r.filter(o=>o.name===xu),s=r.filter(o=>o.name!==xu);if(i.length>=2||s.length>=3)kt(Ft`The filter conditions have been applied properly, but couldnât be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const o=this.conditionCollection.getOperation(n);this.components.get("filter_by_condition").updateState(s[0],n),this.components.get("filter_by_condition2").updateState(s[1],n),this.components.get("filter_operators").updateState(o,n),this.components.get("filter_by_value").updateState(t)}}const N2="internal-use-in-handsontable",j1={licenseKey:N2,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function D2(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[Rn])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function H2(t){return Object.keys(t).reduce((e,r)=>(r!=="hyperformula"&&(e[r]=t[r]),e),{})}function cae(t){var e;const r=t[Rn],n=H2(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=D2(t);return{...j1,...n,...i}}function hae(t){var e;const r=t[Rn],n=H2(r!=null&&(e=r.engine)!==null&&e!==void 0&&e.hyperformula?r.engine:{}),i=D2(t);return{...n,...i}}function dae(t,e){return Object.keys(e).some(r=>e[r]!==void 0&&e[r]!==t[r])}function Dv(){const t="engine_relationship",e=Ds(Rn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function HE(){const t="shared_engine_usage",e=Ds(Rn);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function fae(t){const e=t.getSettings(),r=e[Rn],n=r==null?void 0:r.engine;if(r===!0||er(n))return null;if(typeof n.hyperformula=="function"||typeof n=="function"){var i;return gae((i=n.hyperformula)!==null&&i!==void 0?i:n,e,t)}else if(typeof n=="object"&&er(n.hyperformula)){const s=Dv(),o=HE().get(n);return s.has(n)||s.set(n,[]),s.get(n).push(t),o&&o.push(t.guid),n.getConfig().licenseKey||n.updateConfig({licenseKey:N2}),(n.getConfig().leapYear1900!==j1.leapYear1900||iv(n.getConfig().nullDate,j1.nullDate)===!1)&&kt(Ft`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),n}return null}function gae(t,e,r){const n=e[Rn],i=cae(e),s=Dv(),o=HE();mae(t,n.functions),pae(t,n.language);const a=t.buildEmpty(i);return s.set(a,[r]),o.set(a,[r.guid]),wae(a,n.namedExpressions),a.on("sheetAdded",()=>{a.rebuildAndRecalculate()}),a.on("sheetRemoved",()=>{a.rebuildAndRecalculate()}),a}function zM(t){var e;const r=Dv(),n=r.size===0?[]:Array.from((e=r.get(t))!==null&&e!==void 0?e:[]);return new Map(n.map(i=>[i.getPlugin("formulas").sheetId,i]))}function YM(t,e){if(t){const r=Dv(),n=r.get(t),i=HE(),s=i.get(t);n&&n.includes(e)&&(n.splice(n.indexOf(e),1),n.length===0&&r.delete(t)),s&&s.includes(e.guid)&&(s.splice(s.indexOf(e.guid),1),s.length===0&&(i.delete(t),t.destroy()))}}function mae(t,e){e&&e.forEach(r=>{const{name:n,plugin:i,translations:s}=r;try{t.registerFunction(n,i,s)}catch(o){kt(o.message)}})}function pae(t,e){if(e){const{langCode:r}=e;try{t.registerLanguage(r,e)}catch(n){kt(n.message)}}}function wae(t,e){e&&(t.suspendEvaluation(),e.forEach(r=>{const{name:n,expression:i,scope:s,options:o}=r;try{t.addNamedExpression(n,i,s,o)}catch(a){kt(a.message)}}),t.resumeEvaluation())}function vae(t,e){return(er(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const k2="DD/MM/YYYY";function F2(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function Cae(t){return F2(t)?t.substr(1):t}function Sae(t){return typeof t=="string"&&t.startsWith("=")}function kE(t,e){return typeof t=="string"&&e==="date"}function L2(t,e){return Ce(t,e,!0).isValid()}function $2(t,e){return Ce(t,e,!0).format(k2)}function yae(t,e){return Ce(t,k2,!0).format(e)}function B2(t,e){const n=new Date(Date.UTC(0,0,t+-1));return Ce(n).format(e)}function bae(t,e,r){const n=Array.from(Array(r).keys()).filter(s=>t.includes(s)===!1);if(e===0){var i;return(i=n[e])!==null&&i!==void 0?i:0}return n[e-1]+1}function xae(t,e){const r=[];return t.forEach(n=>{const i={from:n,to:e};r.forEach(s=>{const o=s.from>s.to,a=s.to<=i.from;s.from>i.from&&a&&o&&(i.from+=1)}),i.from>=e&&(e+=1),r.push(i)}),r}function Rae(t){return t.forEach((e,r)=>{t.slice(r+1).forEach(i=>{const s=i.from<i.to;i.from>e.from&&s&&(i.from-=1)})}),t}function FE(t,e,r){const n=xae(t,bae(t,e,r));return Rae(n)}function Jl(t,e,r){Eae(t,e),e.set(t,r)}function Eae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ar(t,e){return t.get(V2(t,e))}function Ha(t,e,r){return t.set(V2(t,e),r),r}function V2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Hd=new WeakMap,ka=new WeakMap,ui=new WeakMap,cp=new WeakMap,VS=new WeakMap,WS=new WeakMap,hp=new WeakMap;class GM{constructor(e,r,n){Jl(this,Hd,void 0),Jl(this,ka,void 0),Jl(this,ui,void 0),Jl(this,cp,[]),Jl(this,VS,[]),Jl(this,WS,void 0),Jl(this,hp,[]),Ha(Hd,this,e),Ha(ka,this,r),Ha(ui,this,n)}setRemovedHfIndexes(e){return Ha(hp,this,e.map(r=>{const n=ar(ka,this).getVisualFromPhysicalIndex(r);return this.getHfIndexFromVisualIndex(n)})),ar(hp,this)}getRemovedHfIndexes(){return ar(hp,this)}getHfIndexFromVisualIndex(e){const r=ar(ka,this).getIndexesSequence(),n=ar(ka,this).getNotTrimmedIndexes();return r.indexOf(n[e])}syncMoves(e){const n=`move${An(ar(Hd,this))}s`;ar(ui,this).getEngine().batch(()=>{e.forEach(i=>{const s=i.from!==i.to,o=i.from+1!==i.to;s&&o&&ar(ui,this).getEngine()[n](ar(ui,this).getSheetId(),i.from,1,i.to)})})}storeMovesInformation(e,r,n){n!==!1&&(Ha(VS,this,e.map(i=>this.getHfIndexFromVisualIndex(i))),Ha(WS,this,this.getHfIndexFromVisualIndex(r)))}calculateAndSyncMoves(e,r){if(ar(ui,this).isPerformingUndoRedo()||e===!1||r===!1)return;const n=FE(ar(VS,this),ar(WS,this),ar(ka,this).getNumberOfIndexes());ar(ui,this).getSheetId()===null?ar(ui,this).getPostponeAction(()=>this.syncMoves(n)):this.syncMoves(n)}getIndexesChangeSyncMethod(){const e=`set${An(ar(Hd,this))}Order`;return r=>{if(ar(ui,this).isPerformingUndoRedo())return;const n=ar(ka,this).getIndexesSequence();if(r==="update"&&n.length>0){const i=ar(cp,this).map(l=>n.indexOf(l)),s=ar(ui,this).getEngine().getSheetDimensions(ar(ui,this).getSheetId());let o;ar(Hd,this)==="row"?o=s.height:o=s.width;const a=i.length;for(let l=a;l<o;l+=1)i.push(l);ar(ui,this).getEngine()[e](ar(ui,this).getSheetId(),i)}Ha(cp,this,n)}}init(){Ha(cp,this,ar(ka,this).getIndexesSequence())}}function Ql(t,e,r){Tae(t,e),e.set(t,r)}function Tae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vo(t,e){return t.get(W2(t,e))}function eu(t,e,r){return t.set(W2(t,e),r),r}function W2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var dp=new WeakMap,fp=new WeakMap,US=new WeakMap,jS=new WeakMap,zS=new WeakMap,YS=new WeakMap,GS=new WeakMap;class _ae{constructor(e,r,n){Ql(this,dp,void 0),Ql(this,fp,void 0),Ql(this,US,void 0),Ql(this,jS,!1),Ql(this,zS,!1),Ql(this,YS,null),Ql(this,GS,null),eu(dp,this,new GM("row",e,this)),eu(fp,this,new GM("column",r,this)),eu(US,this,n)}getForAxis(e){return e==="row"?Vo(dp,this):Vo(fp,this)}setPerformUndo(e){eu(jS,this,e)}setPerformRedo(e){eu(zS,this,e)}isPerformingUndoRedo(){return Vo(jS,this)||Vo(zS,this)}getSheetId(){return Vo(GS,this)}getEngine(){return Vo(YS,this)}getPostponeAction(){return Vo(US,this)}setupSyncEndpoint(e,r){eu(YS,this,e),eu(GS,this,r),Vo(dp,this).init(),Vo(fp,this).init()}}function Aae(t,e){U2(t,e),e.add(t)}function Dc(t,e,r){return(e=Mae(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Mae(t){var e=Oae(t,"string");return typeof e=="symbol"?e:e+""}function Oae(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function KS(t,e,r){U2(t,e),e.set(t,r)}function U2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function wl(t,e,r){return t.set(Bt(t,e),r),r}function lh(t,e){return t.get(Bt(t,e))}function Bt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Rn="formulas",Iae=["maxRows","maxColumns","language"],Pae=260;He.getSingleton().register("afterNamedExpressionAdded");He.getSingleton().register("afterNamedExpressionRemoved");He.getSingleton().register("afterSheetAdded");He.getSingleton().register("afterSheetRemoved");He.getSingleton().register("afterSheetRenamed");He.getSingleton().register("afterFormulasValuesUpdate");const Nh=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var fa=new WeakMap,LE=new WeakMap,kd=new WeakMap,Gt=new WeakSet;class Nae extends At{constructor(){var e;super(...arguments),e=this,Aae(this,Gt),KS(this,fa,!1),KS(this,LE,!1),KS(this,kd,[["valuesUpdated",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bt(Gt,e,Xae).call(e,...n)}],["namedExpressionAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bt(Gt,e,qae).call(e,...n)}],["namedExpressionRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bt(Gt,e,Zae).call(e,...n)}],["sheetAdded",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bt(Gt,e,Jae).call(e,...n)}],["sheetRenamed",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bt(Gt,e,Qae).call(e,...n)}],["sheetRemoved",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Bt(Gt,e,ele).call(e,...n)}]]),Dc(this,"staticRegister",Ds("formulas")),Dc(this,"engine",null),Dc(this,"sheetName",null),Dc(this,"indexSyncer",null),Dc(this,"rowAxisSyncer",null),Dc(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return Rn}static get PLUGIN_PRIORITY(){return Pae}static get SETTING_KEYS(){return[Rn,...Iae]}get sheetId(){return this.sheetName===null?null:this.engine.getSheetId(this.sheetName)}isEnabled(){return!!this.hot.getSettings()[Rn]}enablePlugin(){var e,r=this;if(!this.enabled){if(this.engine=(e=fae(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){kt("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const n=this.addSheet(this.sheetName,this.hot.getSourceDataArray());n!==!1&&(this.sheetName=n)}this.addHook("beforeLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,KM).call(r,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,XM).call(r,...i)}),this.addHook("beforeUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,KM).call(r,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,XM).call(r,...i)}),this.addHook("modifyData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Fae).call(r,...i)}),this.addHook("modifySourceData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Lae).call(r,...i)}),this.addHook("beforeValidate",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Dae).call(r,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,$ae).call(r,...i)}),this.addHook("afterSetDataAtCell",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,qM).call(r,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,qM).call(r,...i)}),this.addHook("beforeCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Bae).call(r,...i)}),this.addHook("beforeCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Vae).call(r,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,jae).call(r,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,zae).call(r,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Wae).call(r,...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Uae).call(r,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Yae).call(r,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Gae).call(r,...i)}),this.indexSyncer=new _ae(this.hot.rowIndexMapper,this.hot.columnIndexMapper,n=>{this.hot.addHookOnce("init",()=>{n()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(n,i,s,o)=>{this.rowAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("beforeColumnMove",(n,i,s,o)=>{this.columnAxisSyncer.storeMovesInformation(n,i,o)}),this.hot.addHook("afterRowMove",(n,i,s,o,a)=>{this.rowAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("afterColumnMove",(n,i,s,o,a)=>{this.columnAxisSyncer.calculateAndSyncMoves(o,a)}),this.hot.addHook("beforeColumnFreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart,i)}),this.hot.addHook("afterColumnFreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.hot.addHook("beforeColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.storeMovesInformation([n],this.hot.getSettings().fixedColumnsStart-1,i)}),this.hot.addHook("afterColumnUnfreeze",(n,i)=>{this.columnAxisSyncer.calculateAndSyncMoves(i,i)}),this.addHook("afterCellMetaReset",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,kae).call(r,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Kae).call(r,...i)}),this.addHook("beforeAutofill",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return Bt(Gt,r,Hae).call(r,...i)}),lh(kd,this).forEach(n=>{let[i,s]=n;return this.engine.on(i,s)}),super.enablePlugin()}}disablePlugin(){lh(kd,this).forEach(e=>{let[r,n]=e;return this.engine.off(r,n)}),YM(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const r=hae(this.hot.getSettings());dae(this.engine.getConfig(),r)&&this.engine.updateConfig(r);const n=this.hot.getSettings()[Rn];if(ke(n)&&ke(n.sheetName)&&n.sheetName!==this.sheetName&&this.switchSheet(n.sheetName),!e.data&&this.sheetName===null){const i=this.hot.getSettings()[Rn].sheetName;i&&this.engine.doesSheetExist(i)?this.switchSheet(this.sheetName):this.sheetName=this.addSheet(i??void 0,this.hot.getSourceDataArray())}super.updatePlugin(e)}destroy(){lh(kd,this).forEach(e=>{var r;let[n,i]=e;return(r=this.engine)===null||r===void 0?void 0:r.off(n,i)}),wl(kd,this,null),YM(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,r){if(ke(r)&&!kD(r))return kt("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return kt("Sheet with the provided name already exists."),!1;try{const n=this.engine.addSheet(e??void 0);return r&&this.engine.setSheetContent(this.engine.getSheetId(n),r),n}catch(n){return kt(n.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){ux(`The sheet named \`${e}\` does not exist, switch aborted.`);return}this.sheetName=e;const r=this.engine.getSheetSerialized(this.sheetId);r.length>0&&this.hot.loadData(r,`${An(Rn)}.switchSheet`)}getCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const i=this.hot.toPhysicalRow(e),s=this.hot.toPhysicalColumn(r);return i!==null&&s!==null?this.engine.getCellType({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)}):"EMPTY"}isFormulaCellType(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:n,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r)})}renderDependentSheets(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=new Set;e.forEach(i=>{var s;const o=i==null||(s=i.address)===null||s===void 0?void 0:s.sheet;o!==void 0&&(n.has(o)||n.add(o))}),zM(this.engine).forEach((i,s)=>{if((r||s!==this.sheetId)&&n.has(s)){var o;i.render(),(o=i.view)===null||o===void 0||o.adjustElementsSize()}})}validateDependentCells(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=s=>{var o;const{row:a,col:l,sheet:u}=(o=s==null?void 0:s.address)!==null&&o!==void 0?o:{};return ke(u)?`${u}:${a}x${l}`:""},i=new Set(r.map(s=>n(s)));e.forEach(s=>{var o,a;const{row:l,col:u}=(o=s.address)!==null&&o!==void 0?o:{};if(ke(l)===!1||ke(u)===!1||l>=this.hot.countRows()||u>=this.hot.countCols())return;const c=s==null||(a=s.address)===null||a===void 0?void 0:a.sheet,h=n(s);if(c!==void 0&&!i.has(h)){const d=zM(this.engine).get(c);if(!d)return;d.validateCell(d.getDataAtCell(l,u),d.getCellMeta(l,u),()=>{})}})}syncChangeWithEngine(e,r,n){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(i)){kt(`Not possible to set cell data at ${JSON.stringify(i)}`);return}const s=this.hot.getCellMeta(e,r);return kE(n,s.type)&&(L2(n,s.dateFormat)?n=$2(n,s.dateFormat):Sae(n)===!1&&(n=`'${n}`)),this.engine.setCellContents(i,n)}}function Dae(t,e,r){const n=this.hot.propToCol(r);if(this.isFormulaCellType(e,n)){const i={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},s=this.hot.getCellMeta(e,n);let o=this.engine.getCellValue(i);return s.type==="date"&&xn(o)&&(o=B2(o,s.dateFormat)),typeof o=="object"&&o!==null?o.value:o}return t}function Hae(t,e,r){const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),{row:a,col:l}=r.getTopStartCorner(),{row:u,col:c}=r.getBottomEndCorner(),h={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(d)===!1)return!1;const f=this.engine.getFillRangeData(h,d),{row:m,col:g}=h.start,{row:w,col:S}=h.end,b=w-m+1,y=S-g+1;for(let _=0;_<f.length;_+=1)for(let P=0;P<f[_].length;P+=1){const z=f[_][P],I=m+_%b,W=g+P%y,L=this.hot.getCellMeta(I,W);kE(z,L.type)&&(z.startsWith("'")?f[_][P]=z.slice(1):this.isFormulaCellType(I,W,this.sheetId)===!1&&(f[_][P]=yae(z,L.dateFormat)))}return f}function KM(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(An(Rn))||wl(LE,this,er(this.hot.getSettings().data))}function kae(){const t=this.hot.getSourceDataArray();let e=!1;t.forEach((r,n)=>{r.forEach((i,s)=>{const o=this.hot.getCellMeta(n,s),a=o.dateFormat;kE(i,o.type)&&(e=!0,L2(i,a)?t[n][s]=$2(i,a):this.isFormulaCellType(n,s)===!1&&(t[n][s]=`'${i}`))})}),e===!0&&(wl(fa,this,!0),this.engine.setSheetContent(this.sheetId,t),wl(fa,this,!1))}function XM(t,e){if(!(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(An(Rn)))if(this.sheetName=vae(this.engine,this.hot.getSettings()[Rn].sheetName),lh(LE,this))this.switchSheet(this.sheetName);else{const n=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,n)){wl(fa,this,!0);const i=this.engine.setSheetContent(this.sheetId,n);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(i),wl(fa,this,!1)}}}function Fae(t,e,r,n){if(n!=="get"||lh(fa,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t);if(i===null||e===null)return;if(!this.isFormulaCellType(i,e)&&this.getCellType(i,e)!=="ARRAY"){F2(r.value)&&(r.value=Cae(r.value));return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o),l=this.hot.getCellsMeta().find(c=>c.visualRow===i&&c.visualCol===e);l===void 0&&(l={}),l.type==="date"&&xn(a)&&(a=B2(a,l.dateFormat));const u=typeof a=="object"&&a!==null?a.value:a;r.value=u}function Lae(t,e,r,n){if(n!=="get"||lh(fa,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const i=this.hot.toVisualRow(t),s=this.hot.propToCol(e);if(i===null||s===null||!this.isFormulaCellType(i,s)&&this.getCellType(i,s)!=="ARRAY")return;const a=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(a.width===0&&a.height===0)return;const l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};r.value=this.engine.getCellSerialized(l)}function qM(t,e){if(Nh(e))return;const r=[],n=[],i=this.engine.batch(()=>{t.forEach(s=>{let[o,a,,l]=s;const u=this.hot.propToCol(a),c=this.hot.toPhysicalRow(o),h=this.hot.toPhysicalColumn(u),d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId};c!==null&&h!==null?this.syncChangeWithEngine(o,u,l):r.push([o,u,l]),n.push({address:d})})});r.length&&this.hot.addHookOnce("afterChange",()=>{const s=this.engine.batch(()=>{r.forEach(o=>{let[a,l,u]=o;this.syncChangeWithEngine(a,l,u)})});this.renderDependentSheets(s,!0)}),this.renderDependentSheets(i),this.validateDependentCells(i,n)}function $ae(t,e){if(Nh(e))return;const r=[],n=[];t.forEach(i=>{let[s,o,,a]=i;const l=this.hot.propToCol(o);if(!xn(l))return;const u={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(l),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(u)){kt(`Not possible to set source cell data at ${JSON.stringify(u)}`);return}n.push({address:u}),r.push(...this.engine.setCellContents(u,a))}),this.renderDependentSheets(r),this.validateDependentCells(r,n)}function Bae(t,e){let r=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[r,e]))return!1}function Vae(t,e){let r=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(r=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[r,e]))return!1}function Wae(t,e,r){return this.rowAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveRows(this.sheetId,[s,1]))===!1?!1:void 0}function Uae(t,e,r){return this.columnAxisSyncer.setRemovedHfIndexes(r).every(s=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[s,1]))===!1?!1:void 0}function jae(t,e,r){if(Nh(r))return;const n=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function zae(t,e,r){if(Nh(r))return;const n=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(n)}function Yae(t,e,r,n){if(Nh(n))return;const i=this.rowAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeRows(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Gae(t,e,r,n){if(Nh(n))return;const i=this.columnAxisSyncer.getRemovedHfIndexes().sort((o,a)=>a-o),s=this.engine.batch(()=>{i.forEach(o=>{this.engine.removeColumns(this.sheetId,[o,1])})});this.renderDependentSheets(s)}function Kae(t,e,r){var n;wl(fa,this,!0);const i=this.hot.getSourceDataArray(r,0,r+(((n=e.__children)===null||n===void 0?void 0:n.length)||0),this.hot.countSourceCols());wl(fa,this,!1),i.forEach((s,o)=>{s.forEach((a,l)=>{this.engine.setCellContents({col:l,row:r+o,sheet:this.sheetId},[[a]])})})}function Xae(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function qae(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function Zae(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function Jae(t){this.hot.runHooks("afterSheetAdded",t)}function Qae(t,e){this.sheetName=e,this.hot.runHooks("afterSheetRenamed",t,e)}function ele(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function tle(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[,n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(SR,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.col,r.col),0),i=Math.max(e.col,r.col),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideColumns(s);const o=s[s.length-1],a=this.columnIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectColumns(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function rle(t){const e=[];return{key:"hidden_columns_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(yR,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.columnIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.columnIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countCols()||this.selectColumns(i,s)},disabled:!1,hidden(){const r=St(t.getHiddenColumns(),h=>this.toPhysicalColumn(h));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().col,s=n.getBottomEndCorner().col,o=this.columnIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>r.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countCols()));else{const h=this.countCols()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return V(c,h=>{e.push(this.toVisualColumn(h))}),e.length===0}}}function nle(t,e){j2(t,e),e.add(t)}function ZM(t,e,r){j2(t,e),e.set(t,r)}function j2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Si(t,e){return t.get(ja(t,e))}function Fd(t,e,r){return t.set(ja(t,e),r),r}function ja(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeHideColumns");He.getSingleton().register("afterHideColumns");He.getSingleton().register("beforeUnhideColumns");He.getSingleton().register("afterUnhideColumns");const XS="hiddenColumns",ile=310;var mo=new WeakMap,zs=new WeakMap,tu=new WeakSet;class sle extends At{constructor(){super(...arguments),nle(this,tu),ZM(this,mo,{}),ZM(this,zs,null)}static get PLUGIN_KEY(){return XS}static get PLUGIN_PRIORITY(){return ile}isEnabled(){return!!this.hot.getSettings()[XS]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[XS];ut(r)&&(Fd(mo,this,r),er(r.copyPasteEnabled)&&(r.copyPasteEnabled=!0)),Fd(zs,this,new fv),Si(zs,this).addLocalHook("init",()=>ja(tu,this,hle).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Si(zs,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ja(tu,e,cle).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,s)=>ja(tu,this,ale).call(this,n,i,s)),this.addHook("modifyColWidth",(n,i)=>ja(tu,this,ole).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return ja(tu,e,ule).call(e,...i)}),this.addHook("modifyCopyableRange",n=>ja(tu,this,lle).call(this,n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),Fd(mo,this,{}),super.disablePlugin(),this.resetCellsMeta()}showColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;const s=Si(zs,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(u=>this.hot.toPhysicalColumn(u));V(l,u=>{s[u]=!1}),i=Hr(s,(u,c,h)=>(c&&u.push(this.hot.toVisualColumn(h)),u),[])}this.hot.runHooks("beforeUnhideColumns",r,i,n&&o)!==!1&&(n&&o&&Si(zs,this).setValues(s),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",r,i,n&&o,n&&i.length<r.length))}showColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showColumns(r)}hideColumns(e){const r=this.getHiddenColumns(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideColumns",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{V(e,o=>{Si(zs,this).setValueAtIndex(this.hot.toPhysicalColumn(o),!0)})},!0),this.hot.runHooks("afterHideColumns",r,i,n,n&&i.length>r.length))}hideColumn(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideColumns(r)}getHiddenColumns(){return St(Si(zs,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return Si(zs,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const r=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){V(this.hot.getCellsMeta(),e=>{e&&(e.skipColumnOnPaste=!1)})}destroy(){Fd(mo,this,null),Fd(zs,this,null),super.destroy()}}function ole(t,e){if(this.isHidden(e))return 0;if(Si(mo,this).indicators&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function ale(t,e,r){if(Si(mo,this).copyPasteEnabled===!1&&this.isHidden(e)&&(r.skipColumnOnPaste=!0),this.isHidden(e-1))r.className=r.className||"",r.className.indexOf("afterHiddenColumn")===-1&&(r.className+=" afterHiddenColumn");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenColumn");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function lle(t){if(Si(mo,this).copyPasteEnabled)return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return V(t,n=>{let i=!0,s=0;Ue(n.startCol,n.endCol,o=>{this.isHidden(o)?(i||r(n.startRow,n.endRow,s,o-1),i=!0):(i&&(s=o),o===n.endCol&&r(n.startRow,n.endRow,s,o),i=!1)})}),e}function ule(t,e){if(!Si(mo,this).indicators||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&r.push("beforeHiddenColumn"),ve(e,r)}function cle(t){t.items.push({name:ft},tle(this),rle(this))}function hle(){Array.isArray(Si(mo,this).columns)&&this.hideColumns(Si(mo,this).columns)}function dle(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedLast();let r=0;if(Array.isArray(e)){const[n,,i]=e;n-i!==0&&(r=1)}return this.getTranslatedPhrase(bR,r)},callback(){const{from:e,to:r}=this.getSelectedRangeLast(),n=Math.max(Math.min(e.row,r.row),0),i=Math.max(e.row,r.row),s=[];for(let l=n;l<=i;l+=1)s.push(l);t.hideRows(s);const o=s[s.length-1],a=this.rowIndexMapper.getNearestNotHiddenIndex(o,1,!0);Number.isInteger(a)&&a>=0?this.selectRows(a):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function fle(t){const e=[];return{key:"hidden_rows_show",name(){const r=e.length>1?1:0;return this.getTranslatedPhrase(xR,r)},callback(){var r,n;if(e.length===0)return;let i=e[0],s=e[e.length-1];i=(r=this.rowIndexMapper.getNearestNotHiddenIndex(i-1,-1))!==null&&r!==void 0?r:0,s=(n=this.rowIndexMapper.getNearestNotHiddenIndex(s+1,1))!==null&&n!==void 0?n:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),s-i+1===this.countRows()||this.selectRows(i,s)},disabled:!1,hidden(){const r=St(t.getHiddenRows(),h=>this.toPhysicalRow(h));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||r.length<1)return!0;e.length=0;const n=this.getSelectedRangeLast(),i=n.getTopStartCorner().row,s=n.getBottomEndCorner().row,o=this.rowIndexMapper,a=o.getRenderableFromVisualIndex(i),l=o.getRenderableFromVisualIndex(s),u=o.getNotTrimmedIndexes(),c=[];if(i!==s){const h=s-i+1,d=l-a+1;if(h>d){const f=u.slice(i,s+1);c.push(...f.filter(m=>r.includes(m)))}}else if(a===0&&a<i)c.push(...u.slice(0,i));else if(a===null)c.push(...u.slice(0,this.countRows()));else{const h=this.countRows()-1,d=o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(h,-1));l===d&&h>s&&c.push(...u.slice(s+1))}return V(c,h=>{e.push(this.toVisualRow(h))}),e.length===0}}}function gle(t,e){z2(t,e),e.add(t)}function JM(t,e,r){z2(t,e),e.set(t,r)}function z2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vi(t,e){return t.get(za(t,e))}function Ld(t,e,r){return t.set(za(t,e),r),r}function za(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeHideRows");He.getSingleton().register("afterHideRows");He.getSingleton().register("beforeUnhideRows");He.getSingleton().register("afterUnhideRows");const qS="hiddenRows",mle=320;var ra=new WeakMap,Ys=new WeakMap,ru=new WeakSet;class ple extends At{constructor(){super(...arguments),gle(this,ru),JM(this,ra,{}),JM(this,Ys,null)}static get PLUGIN_KEY(){return qS}static get PLUGIN_PRIORITY(){return mle}isEnabled(){return!!this.hot.getSettings()[qS]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[qS];ut(r)&&(Ld(ra,this,r),er(r.copyPasteEnabled)&&(r.copyPasteEnabled=!0)),Ld(Ys,this,new fv),Vi(Ys,this).addLocalHook("init",()=>za(ru,this,ble).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Vi(Ys,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return za(ru,e,yle).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,s)=>za(ru,this,vle).call(this,n,i,s)),this.addHook("modifyRowHeight",(n,i)=>za(ru,this,wle).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return za(ru,e,Sle).call(e,...i)}),this.addHook("modifyCopyableRange",n=>za(ru,this,Cle).call(this,n)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap(this.pluginName),Ld(ra,this,{}),super.disablePlugin(),this.resetCellsMeta()}showRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;const s=Vi(Ys,this).getValues().slice(),o=e.length>0;if(n&&o){const l=e.map(u=>this.hot.toPhysicalRow(u));V(l,u=>{s[u]=!1}),i=Hr(s,(u,c,h)=>(c&&u.push(this.hot.toVisualRow(h)),u),[])}this.hot.runHooks("beforeUnhideRows",r,i,n&&o)!==!1&&(n&&o&&Vi(Ys,this).setValues(s),this.hot.runHooks("afterUnhideRows",r,i,n&&o,n&&i.length<r.length))}showRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.showRows(r)}hideRows(e){const r=this.getHiddenRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeHideRows",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{V(e,o=>{Vi(Ys,this).setValueAtIndex(this.hot.toPhysicalRow(o),!0)})},!0),this.hot.runHooks("afterHideRows",r,i,n,n&&i.length>r.length))}hideRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.hideRows(r)}getHiddenRows(){return St(Vi(Ys,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Vi(Ys,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const r=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(n=>Number.isInteger(n)&&n>=0&&n<r):!1}resetCellsMeta(){V(this.hot.getCellsMeta(),e=>{e&&(e.skipRowOnPaste=!1)})}destroy(){Ld(ra,this,null),Ld(Ys,this,null),super.destroy()}}function wle(t,e){return this.isHidden(e)?0:t}function vle(t,e,r){if(Vi(ra,this).copyPasteEnabled===!1&&this.isHidden(t)&&(r.skipRowOnPaste=!0),this.isHidden(t-1))r.className=r.className||"",r.className.indexOf("afterHiddenRow")===-1&&(r.className+=" afterHiddenRow");else if(r.className){const n=r.className.split(" ");if(n.length>0){const i=n.indexOf("afterHiddenRow");i>-1&&n.splice(i,1),r.className=n.join(" ")}}}function Cle(t){if(Vi(ra,this).copyPasteEnabled)return t;const e=[],r=(n,i,s,o)=>{e.push({startRow:n,endRow:i,startCol:s,endCol:o})};return V(t,n=>{let i=!0,s=0;Ue(n.startRow,n.endRow,o=>{this.isHidden(o)?(i||r(s,o-1,n.startCol,n.endCol),i=!0):(i&&(s=o),o===n.endRow&&r(s,o,n.startCol,n.endCol),i=!1)})}),e}function Sle(t,e){if(!Vi(ra,this).indicators||t<0)return;const r=[];t>=1&&this.isHidden(t-1)&&r.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&r.push("beforeHiddenRow"),ve(e,r)}function yle(t){t.items.push({name:ft},dle(this),fle(this))}function ble(){Array.isArray(Vi(ra,this).rows)&&this.hideRows(Vi(ra,this).rows)}function xle(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(nR)},callback(e,r){const[{start:{col:n}}]=r;t.freezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(r=!0),r}}}function Rle(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(iR)},callback(e,r){const[{start:{col:n}}]=r;t.unfreezeColumn(n),this.render(),this.view.adjustElementsSize()},hidden(){const e=this.getSelectedRange();let r=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(r=!0),r}}}function Ele(t,e){Y2(t,e),e.add(t)}function Tle(t,e,r){Y2(t,e),e.set(t,r)}function Y2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function z1(t,e){return t.get(Q0(t,e))}function ZS(t,e,r){return t.set(Q0(t,e),r),r}function Q0(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeColumnFreeze");He.getSingleton().register("afterColumnFreeze");He.getSingleton().register("beforeColumnUnfreeze");He.getSingleton().register("afterColumnUnfreeze");const QM="manualColumnFreeze",_le=110;var fu=new WeakMap,JS=new WeakSet;class Ale extends At{constructor(){super(...arguments),Ele(this,JS),Tle(this,fu,!1)}static get PLUGIN_KEY(){return QM}static get PLUGIN_PRIORITY(){return _le}isEnabled(){return!!this.hot.getSettings()[QM]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>Q0(JS,this,Mle).call(this,e)),this.addHook("beforeColumnMove",(e,r)=>Q0(JS,this,Ole).call(this,e,r)),super.enablePlugin())}disablePlugin(){ZS(fu,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart<this.hot.countCols()&&e>r.fixedColumnsStart-1;z1(fu,this)||ZS(fu,this,!0),this.hot.runHooks("beforeColumnFreeze",e,n)!==!1&&(n&&(this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart),r._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,n))}unfreezeColumn(e){const r=this.hot.getSettings(),n=r.fixedColumnsStart>0&&e<=r.fixedColumnsStart-1;z1(fu,this)||ZS(fu,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,n)!==!1&&(n&&(r._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,r.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,n))}}function Mle(t){t.items.push({name:"---------"},xle(this),Rle(this))}function Ole(t,e){if(z1(fu,this)){const r=this.hot.getSettings().fixedColumnsStart;if(e<r||t.some(n=>n<r))return!1}}function gp(t,e,r){return(e=Ile(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ile(t){var e=Ple(t,"string");return typeof e=="symbol"?e:e+""}function Ple(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const QS=0,eO=1,tO=2,Hc="px";let G2=class{constructor(e){gp(this,"hot",void 0),gp(this,"_element",null),gp(this,"state",QS),gp(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=tO}build(){this.state===QS&&(this._element=this.hot.rootDocument.createElement("div"),this.state=eO)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=QS}isAppended(){return this.state===tO}isBuilt(){return this.state>=eO}setPosition(e,r){xn(e)&&(this._element.style.top=e+Hc),xn(r)&&(this._element.style[this.inlineProperty]=r+Hc)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,r){xn(e)&&(this._element.style.width=e+Hc),xn(r)&&(this._element.style.height=r+Hc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){xn(e)&&(this._element.style.marginTop=e+Hc),xn(r)&&(this._element.style[`margin${An(this.inlineProperty)}`]=r+Hc)}getOffset(){const e=this._element.style,r=`margin${An(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[r]?parseInt(e[r],10):0}}};const Nle="ht__manualColumnMove--backlight";let Dle=class extends G2{build(){super.build(),ve(this._element,Nle)}};const Hle="ht__manualColumnMove--guideline";let kle=class extends G2{build(){super.build(),ve(this._element,Hle)}};function Fle(t,e){K2(t,e),e.add(t)}function ls(t,e,r){K2(t,e),e.set(t,r)}function K2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ri(t,e,r){return t.set(Ya(t,e),r),r}function $e(t,e){return t.get(Ya(t,e))}function Ya(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeColumnMove");He.getSingleton().register("afterColumnMove");const ey="manualColumnMove",Lle=120,rO="ht__manualColumnMove",ew="show-ui",Y1="on-moving--columns",G1="after-selection--columns";var Ln=new WeakMap,qa=new WeakMap,na=new WeakMap,h0=new WeakMap,nl=new WeakMap,Hn=new WeakMap,mp=new WeakMap,Hi=new WeakMap,Kc=new WeakMap,tw=new WeakMap,ff=new WeakMap,nu=new WeakSet;class $le extends At{constructor(){super(...arguments),Fle(this,nu),ls(this,Ln,new Dle(this.hot)),ls(this,qa,new kle(this.hot)),ls(this,na,[]),ls(this,h0,0),ls(this,nl,!1),ls(this,Hn,{}),ls(this,mp,void 0),ls(this,Hi,void 0),ls(this,Kc,void 0),ls(this,tw,void 0),ls(this,ff,void 0)}static get PLUGIN_KEY(){return ey}static get PLUGIN_PRIORITY(){return Lle}isEnabled(){return!!this.hot.getSettings()[ey]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ya(nu,e,Ble).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ya(nu,e,Wle).call(e,...n)}),this.addHook("afterScrollVertically",()=>Ya(nu,this,jle).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ya(nu,e,zle).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),ve(this.hot.rootElement,rO),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){tt(this.hot.rootElement,rO),this.unregisterEvents(),$e(Ln,this).destroy(),$e(qa,this).destroy(),super.disablePlugin()}moveColumn(e,r){return this.moveColumns([e],r)}moveColumns(e,r){const n=$e(mp,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeColumnMove",e,r,n,i);if(ri(mp,this,void 0),s===!1)return;i&&this.hot.columnIndexMapper.moveIndexes(e,r);const o=i&&this.isColumnOrderChanged(e,r);return this.hot.runHooks("afterColumnMove",e,r,n,i,o),o}dragColumn(e,r){return this.dragColumns([e],r)}dragColumns(e,r){const n=this.countFinalIndex(e,r);return ri(mp,this,r),this.moveColumns(e,n)}isMovePossible(e,r){const n=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isColumnOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Hr(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getColumnsWidth(e,r){const n=this.hot.columnIndexMapper;let i=0;for(let s=e;s<=r;s+=1){const o=n.getRenderableFromVisualIndex(s);s<0?i+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:o!==null&&(i+=this.hot.view._wt.wtTable.getStretchedColumnWidth(o)||0)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[ey];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveColumns(r,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,r){const n=[];return Ue(e,r,i=>{n.push(i)}),n}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart($e(Hi,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const r=this.hot.view._wt.wtTable,n=this.hot.view._wt.wtOverlays.scrollableElement,i=typeof n.scrollX=="number"?n.scrollX:n.scrollLeft;let s=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,$e(Hi,this)-1);const o=r.hider.offsetWidth,a=r.TBODY.offsetLeft,l=$e(Ln,this).getOffset().start,u=$e(Ln,this).getSize().width;let c=0,h=0;if(this.hot.isRtl()){const m=this.hot.rootWindow,g=tr(this.hot.rootElement),w=m.innerWidth-$e(Kc,this)-g;h=m.innerWidth-$e(Hn,this).eventPageX-w-(n.scrollX===void 0?i:0)}else h=$e(Hn,this).eventPageX-($e(Kc,this)-(n.scrollX===void 0?i:0));if($e(tw,this)&&(c=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart($e(Hi,this))&&(s+=i),s+=c,$e(Hi,this)<0)$e(ff,this)>0?$e(Hn,this).col=0:$e(Hn,this).col=e>0?e-1:e;else if($e(Hn,this).TD.offsetWidth/2+s<=h){const m=$e(Hi,this)>=$e(h0,this)?$e(h0,this)-1:$e(Hi,this);$e(Hn,this).col=m+1,s+=$e(Hn,this).TD.offsetWidth}else $e(Hn,this).col=$e(Hi,this);let d=h,f=s;h+u+l>=o?d=o-u-l:h+l<a+c&&(d=a+c+Math.abs(l)),s>=o-1?f=o-1:f===0?f=1:n.scrollX!==void 0&&$e(Hi,this)<$e(ff,this)&&(f-=$e(Kc,this)<=n.scrollX?$e(Kc,this):0),$e(Ln,this).setPosition(null,d),$e(qa,this).setPosition(null,f)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Ya(nu,this,Vle).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ya(nu,this,Ule).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){$e(Ln,this).build(),$e(qa,this).build()}destroy(){$e(Ln,this).destroy(),$e(qa,this).destroy(),super.destroy()}}function Ble(t,e,r,n){const i=this.hot.view._wt.wtTable,s=this.hot.selection.isSelectedByColumnHeader(),o=this.hot.getSelectedRangeLast(),a=Qe(t.target,"sortAction");if(!o||!s||$e(nl,this)||t.button!==0||a){ri(nl,this,!1),$e(na,this).length=0,tt(this.hot.rootElement,[Y1,ew]);return}const l=$e(qa,this).isBuilt()&&!$e(qa,this).isAppended(),u=$e(Ln,this).isBuilt()&&!$e(Ln,this).isAppended();l&&u&&($e(qa,this).appendTo(i.hider),$e(Ln,this).appendTo(i.hider));const{from:c,to:h}=o,d=Math.min(c.col,h.col),f=Math.max(c.col,h.col);if(e.row<0&&e.col>=d&&e.col<=f){n.column=!0,ri(nl,this,!0);const m=r.firstChild?eD(t,r.firstChild).x:t.offsetX;$e(Hn,this).eventPageX=t.pageX,ri(Hi,this,e.col),$e(Hn,this).TD=r,$e(Hn,this).col=e.col,ri(na,this,this.prepareColumnsToMoving(d,f)),ri(tw,this,!!this.hot.getSettings().rowHeaders),ri(h0,this,this.hot.countCols()),ri(ff,this,this.hot.getSettings().fixedColumnsStart),ri(Kc,this,Kr(this.hot.rootElement).left);const g=$e(tw,this)?-1:0,w=i.holder.scrollTop+i.getColumnHeaderHeight(0)+1,S=e.col<$e(ff,this),b=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),y=Math.abs(m-(this.hot.isRtl()?r.offsetWidth:0)),_=this.getColumnsWidth(d,e.col-1)+y,P=this.getColumnsWidth(g,d-1)+(S?b:0)+_;$e(Ln,this).setPosition(w,P),$e(Ln,this).setSize(this.getColumnsWidth(d,f),i.hider.offsetHeight-w),$e(Ln,this).setOffset(null,-_),ve(this.hot.rootElement,Y1)}else tt(this.hot.rootElement,G1),ri(nl,this,!1),$e(na,this).length=0}function Vle(t){$e(nl,this)&&($e(Hn,this).eventPageX=t.pageX,this.refreshPositions())}function Wle(t,e,r,n){!this.hot.getSelectedRangeLast()||!$e(nl,this)||($e(na,this).indexOf(e.col)>-1?tt(this.hot.rootElement,ew):ve(this.hot.rootElement,ew),n.row=!0,n.column=!0,n.cell=!0,ri(Hi,this,e.col),$e(Hn,this).TD=r)}function Ule(){const t=$e(Hn,this).col,e=$e(na,this).length;if(ri(Hi,this,void 0),ri(nl,this,!1),tt(this.hot.rootElement,[Y1,ew,G1]),this.hot.selection.isSelectedByColumnHeader()&&ve(this.hot.rootElement,G1),e<1||t===void 0)return;const r=$e(na,this)[0],n=this.hot.toPhysicalColumn(r),i=this.dragColumns($e(na,this),t);if($e(na,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualColumn(n),o=s+e-1;this.hot.selectColumns(s,o)}}function jle(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,r=t.holder.scrollTop,n=e+r;$e(Ln,this).setPosition(n),$e(Ln,this).setSize(null,t.hider.offsetHeight-n)}function zle(){this.moveBySettingsOrLoad()}function Yle(t,e){X2(t,e),e.add(t)}function Sn(t,e,r){X2(t,e),e.set(t,r)}function X2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tr(t,e,r){return t.set(ws(t,e),r),r}function Pe(t,e){return t.get(ws(t,e))}function ws(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const rw="manualColumnResize",Gle=130,nO="manualColumnWidths";var Xo=new WeakMap,pp=new WeakMap,pi=new WeakMap,nw=new WeakMap,ho=new WeakMap,Kle=new WeakMap,uh=new WeakMap,wp=new WeakMap,qn=new WeakMap,zo=new WeakMap,Hu=new WeakMap,iw=new WeakMap,gf=new WeakMap,mf=new WeakMap,Ci=new WeakMap,pf=new WeakMap,Gs=new WeakSet;class Xle extends At{static get PLUGIN_KEY(){return rw}static get PLUGIN_PRIORITY(){return Gle}constructor(e){super(e),Yle(this,Gs),Sn(this,Xo,null),Sn(this,pp,null),Sn(this,pi,[]),Sn(this,nw,null),Sn(this,ho,null),Sn(this,Kle,null),Sn(this,uh,null),Sn(this,wp,null),Sn(this,qn,this.hot.rootDocument.createElement("DIV")),Sn(this,zo,this.hot.rootDocument.createElement("DIV")),Sn(this,Hu,null),Sn(this,iw,!1),Sn(this,gf,0),Sn(this,mf,null),Sn(this,Ci,void 0),Sn(this,pf,void 0),ve(Pe(qn,this),"manualColumnResizer"),ve(Pe(zo,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[rw]}enablePlugin(){this.enabled||(Tr(Ci,this,new xl),Pe(Ci,this).addLocalHook("init",()=>ws(Gs,this,qle).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,Pe(Ci,this)),this.addHook("modifyColWidth",(e,r)=>ws(Gs,this,rue).call(this,e,r),1),this.addHook("beforeStretchingColumnWidth",(e,r)=>ws(Gs,this,nue).call(this,e,r)),this.addHook("beforeColumnResize",(e,r,n)=>ws(Gs,this,iue).call(this,e,r,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){Tr(pf,this,Pe(Ci,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",nO,Pe(Ci,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",nO,e),e.value}setManualSize(e,r){const n=Math.max(r,20),i=this.hot.toPhysicalColumn(e);return Pe(Ci,this).setValueAtIndex(i,n),n}clearManualSize(e){const r=this.hot.toPhysicalColumn(e);Pe(Ci,this).setValueAtIndex(r,null)}setupHandlePosition(e){if(!e.parentNode)return;Tr(Xo,this,e);const{_wt:r}=this.hot.view,n=r.wtTable.getCoords(Pe(Xo,this)),i=n.col;if(i<0)return;const s=Ar(Pe(Xo,this)),o=Pe(Xo,this).getBoundingClientRect(),a=i<r.getSetting("fixedColumnsStart");let l;a&&(l=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Pe(Xo,this),n.row,n.col)),l||(l=r.wtOverlays.topOverlay.getRelativeCellPosition(Pe(Xo,this),n.row,n.col)),Tr(pp,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(i)),Tr(pi,this,[]);const u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&u){const c=this.hot.getSelectedRange();V(c,h=>{const d=h.getTopStartCorner().col,f=h.getBottomEndCorner().col;Ue(d,f,m=>{Pe(pi,this).includes(m)||Pe(pi,this).push(m)})})}Pe(pi,this).includes(Pe(pp,this))||Tr(pi,this,[Pe(pp,this)]),Tr(wp,this,l.start-6),Tr(uh,this,parseInt(o.width,10)),Pe(qn,this).style.top=`${l.top}px`,Pe(qn,this).style[this.inlineDir]=`${Pe(wp,this)+Pe(uh,this)}px`,Pe(qn,this).style.height=`${s}px`,this.hot.rootElement.appendChild(Pe(qn,this))}refreshHandlePosition(){Pe(qn,this).style[this.inlineDir]=`${Pe(wp,this)+Pe(nw,this)}px`}setupGuidePosition(){const e=parseInt(Ar(Pe(qn,this)),10),r=parseInt(Pe(qn,this).style.top,10)+e,n=parseInt(this.hot.view.maximumVisibleElementHeight(0),10);ve(Pe(qn,this),"active"),ve(Pe(zo,this),"active"),Pe(zo,this).style.top=`${r}px`,this.refreshGuidePosition(),Pe(zo,this).style.height=`${n-e}px`,this.hot.rootElement.appendChild(Pe(zo,this))}refreshGuidePosition(){Pe(zo,this).style[this.inlineDir]=Pe(qn,this).style[this.inlineDir]}hideHandleAndGuide(){tt(Pe(qn,this),"active"),tt(Pe(zo,this),"active")}checkIfColumnHeader(e){const r=fl(e,["THEAD"],this.hot.rootElement),{topOverlay:n,topInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.THEAD,i.clone.wtTable.THEAD].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeColumnResize",Pe(ho,this),n,!0);s!==void 0&&Tr(ho,this,s),this.hot.getSettings().stretchH==="all"?this.clearManualSize(n):this.setManualSize(n,Pe(ho,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Pe(ho,this),n,!0),i&&e()};Pe(gf,this)>=2&&(Pe(pi,this).length>1?(V(Pe(pi,this),i=>{r(i)}),e()):V(Pe(pi,this),i=>{r(i,!0)})),Tr(gf,this,0),Tr(mf,this,null)}bindEvents(){const{rootWindow:e,rootElement:r}=this.hot;this.eventManager.addEventListener(r,"mouseover",n=>ws(Gs,this,Zle).call(this,n)),this.eventManager.addEventListener(r,"mousedown",n=>ws(Gs,this,Jle).call(this,n)),this.eventManager.addEventListener(e,"mousemove",n=>ws(Gs,this,Qle).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>ws(Gs,this,eue).call(this)),this.eventManager.addEventListener(Pe(qn,this),"contextmenu",()=>ws(Gs,this,tue).call(this))}destroy(){super.destroy()}}function qle(){const t=this.hot.getSettings()[rw],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((r,n)=>{Pe(Ci,this).setValueAtIndex(n,r)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((r,n)=>{Pe(Ci,this).setValueAtIndex(n,r)})},!0),Tr(pf,this,t)):t===!0&&Array.isArray(Pe(pf,this))&&this.hot.batchExecution(()=>{Pe(pf,this).forEach((r,n)=>{Pe(Ci,this).setValueAtIndex(n,r)})},!0)}function Zle(t){if(!Jb(t.target)&&Pe(iw,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const r=e.getAttribute("colspan");e&&(r===null||r==="1")&&(Pe(Hu,this)||this.setupHandlePosition(e))}}function Jle(t){t.target.parentNode===this.hot.rootElement&&Qe(t.target,"manualColumnResizer")&&(this.setupHandlePosition(Pe(Xo,this)),this.setupGuidePosition(),Tr(Hu,this,!0),Pe(mf,this)===null&&(Tr(mf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Pe(mf,this))),Tr(gf,this,Pe(gf,this)+1),this.startX=t.pageX,Tr(ho,this,Pe(uh,this)))}function Qle(t){if(Pe(Hu,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();Tr(nw,this,Pe(uh,this)+e),V(Pe(pi,this),r=>{Tr(ho,this,this.setManualSize(r,Pe(nw,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function eue(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeColumnResize",Pe(ho,this),r,!1),n&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",Pe(ho,this),r,!1)};Pe(Hu,this)&&(this.hideHandleAndGuide(),Tr(Hu,this,!1),Pe(ho,this)!==Pe(uh,this)&&(Pe(pi,this).length>1?(V(Pe(pi,this),n=>{e(n)}),t()):V(Pe(pi,this),n=>{e(n,!0)})),this.setupHandlePosition(Pe(Xo,this)))}function tue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Pe(qn,this)),this.hot.rootElement.removeChild(Pe(zo,this)),Tr(Hu,this,!1),Tr(iw,this,!0),this.hot._registerImmediate(()=>{Tr(iw,this,!1)})}function rue(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalColumn(e),i=Pe(Ci,this).getValueAtIndex(n);this.hot.getSettings()[rw]&&i&&(r=i)}return r}function nue(t,e){let r=Pe(Ci,this).getValueAtIndex(e);return r===null&&(r=t),r}function iue(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function ty(t,e,r){return(e=sue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function sue(t){var e=oue(t,"string");return typeof e=="symbol"?e:e+""}function oue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ry=0,iO=1,sO=2,kc="px";let q2=class{constructor(e){ty(this,"hot",void 0),ty(this,"_element",null),ty(this,"state",ry),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=sO}build(){this.state===ry&&(this._element=this.hot.rootDocument.createElement("div"),this.state=iO)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ry}isAppended(){return this.state===sO}isBuilt(){return this.state>=iO}setPosition(e,r){e!==void 0&&(this._element.style.top=e+kc),r!==void 0&&(this._element.style.left=r+kc)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,r){e&&(this._element.style.width=e+kc),r&&(this._element.style.height=r+kc)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,r){e&&(this._element.style.marginTop=e+kc),r&&(this._element.style.marginLeft=r+kc)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const aue="ht__manualRowMove--backlight";class lue extends q2{build(){super.build(),ve(this._element,aue)}}const uue="ht__manualRowMove--guideline";class cue extends q2{build(){super.build(),ve(this._element,uue)}}function hue(t,e){Z2(t,e),e.add(t)}function Fc(t,e,r){Z2(t,e),e.set(t,r)}function Z2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ru(t,e,r){return t.set(Ga(t,e),r),r}function it(t,e){return t.get(Ga(t,e))}function Ga(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeRowMove");He.getSingleton().register("afterRowMove");const ny="manualRowMove",due=140,oO="ht__manualRowMove",sw="show-ui",K1="on-moving--rows",X1="after-selection--rows";var $n=new WeakMap,Za=new WeakMap,ia=new WeakMap,il=new WeakMap,ni=new WeakMap,vp=new WeakMap,iu=new WeakSet;class fue extends At{constructor(){super(...arguments),hue(this,iu),Fc(this,$n,new lue(this.hot)),Fc(this,Za,new cue(this.hot)),Fc(this,ia,[]),Fc(this,il,void 0),Fc(this,ni,{}),Fc(this,vp,void 0)}static get PLUGIN_KEY(){return ny}static get PLUGIN_PRIORITY(){return due}isEnabled(){return!!this.hot.getSettings()[ny]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ga(iu,e,gue).call(e,...n)}),this.addHook("beforeOnCellMouseOver",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ga(iu,e,pue).call(e,...n)}),this.addHook("afterScrollHorizontally",()=>Ga(iu,this,vue).call(this)),this.addHook("afterLoadData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Ga(iu,e,Cue).call(e,...n)}),this.buildPluginUI(),this.registerEvents(),ve(this.hot.rootElement,oO),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){tt(this.hot.rootElement,oO),this.unregisterEvents(),it($n,this).destroy(),it(Za,this).destroy(),super.disablePlugin()}moveRow(e,r){return this.moveRows([e],r)}moveRows(e,r){const n=it(vp,this),i=this.isMovePossible(e,r),s=this.hot.runHooks("beforeRowMove",e,r,n,i);if(Ru(vp,this,void 0),s===!1)return;i&&this.hot.rowIndexMapper.moveIndexes(e,r);const o=i&&this.isRowOrderChanged(e,r);return this.hot.runHooks("afterRowMove",e,r,n,i,o),o}dragRow(e,r){return this.dragRows([e],r)}dragRows(e,r){const n=this.countFinalIndex(e,r);return Ru(vp,this,r),this.moveRows(e,n)}isMovePossible(e,r){const n=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),i=e.length+r>n,s=r<0,o=e.some(l=>l<0),a=e.some(l=>l>=n);return!(i||s||o||a)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}countFinalIndex(e,r){const n=Hr(e,(i,s)=>(s<r&&(i+=1),i),0);return r-n}getRowsHeight(e,r){const n=this.hot.rowIndexMapper;let i=0;for(let s=e;s<=r;s++){const o=n.getRenderableFromVisualIndex(s);o!==null&&(i+=this.hot.view._wt.wtTable.getRowHeight(o)||23)}return i}moveBySettingsOrLoad(){const e=this.hot.getSettings()[ny];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const r=this.persistentStateLoad();r.length&&this.moveRows(r,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeLast(),r=[];if(!e)return r;const{from:n,to:i}=e,s=Math.min(n.row,i.row),o=Math.max(n.row,i.row);return Ue(s,o,a=>{r.push(a)}),r}refreshPositions(){const e=it(ni,this).coords,r=this.hot.view.getFirstFullyVisibleRow(),n=this.hot.view.getLastFullyVisibleRow(),i=this.hot.countRows();this.isFixedRowTop(e.row)&&r>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1)),this.isFixedRowBottom(e.row)&&n<i&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n+1,1),void 0,!0);const s=this.hot.view._wt.wtTable,o=it(ni,this).TD,a=this.hot.rootElement,l=Kr(a),u=Ou(a),c=s.holder.scrollTop,h=this.hot.rootWindow!==u?u.scrollTop:0,d=l.top-h,f=it(ni,this).eventPageY-d+c,m=s.hider.offsetHeight,g=s.TBODY.offsetTop,w=it($n,this).getOffset().top,S=it($n,this).getSize().height,b=o.offsetHeight/2,y=o.offsetHeight;let _=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const P=f>=_+b;this.isFixedRowTop(e.row)&&(_+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?it(ni,this).row=r>0?r-1:r:P?(it(ni,this).row=e.row+1,_+=e.row===0?y-1:y):it(ni,this).row=e.row;let z=f,I=_;f+S+w>=m?z=m-S-w:f+w<g&&(z=g+Math.abs(w)),_>=m-1&&(I=m-1),it($n,this).setPosition(z),it(Za,this).setPosition(I)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",r=>Ga(iu,this,mue).call(this,r)),this.eventManager.addEventListener(e,"mouseup",()=>Ga(iu,this,wue).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){it($n,this).build(),it(Za,this).build()}destroy(){it($n,this).destroy(),it(Za,this).destroy(),super.destroy()}}function gue(t,e,r,n){const{wtTable:i,wtViewport:s}=this.hot.view._wt,o=this.hot.selection.isSelectedByRowHeader(),a=this.hot.getSelectedRangeLast();if(!a||!o||it(il,this)||t.button!==0){Ru(il,this,!1),it(ia,this).length=0,tt(this.hot.rootElement,[K1,sw]);return}const l=it(Za,this).isBuilt()&&!it(Za,this).isAppended(),u=it($n,this).isBuilt()&&!it($n,this).isAppended();l&&u&&(it(Za,this).appendTo(i.hider),it($n,this).appendTo(i.hider));const{from:c,to:h}=a,d=Math.min(c.row,h.row),f=Math.max(c.row,h.row);if(e.col<0&&e.row>=d&&e.row<=f){n.row=!0,Ru(il,this,!0),it(ni,this).eventPageY=t.pageY,it(ni,this).coords=e,it(ni,this).TD=r,Ru(ia,this,this.prepareRowsToMoving());const m=i.holder.scrollLeft+s.getRowHeaderWidth(),g=this.getRowsHeight(d,e.row-1)+t.offsetY;it($n,this).setPosition(null,m),it($n,this).setSize(i.hider.offsetWidth-m,this.getRowsHeight(d,f)),it($n,this).setOffset(-g,null),ve(this.hot.rootElement,K1),this.refreshPositions()}else tt(this.hot.rootElement,X1),Ru(il,this,!1),it(ia,this).length=0}function mue(t){it(il,this)&&(it(ni,this).eventPageY=t.pageY,this.refreshPositions())}function pue(t,e,r,n){!this.hot.getSelectedRangeLast()||!it(il,this)||(it(ia,this).indexOf(e.row)>-1?tt(this.hot.rootElement,sw):ve(this.hot.rootElement,sw),n.row=!0,n.column=!0,n.cell=!0,it(ni,this).coords=e,it(ni,this).TD=r)}function wue(){const t=it(ni,this).row,e=it(ia,this).length;if(Ru(il,this,!1),tt(this.hot.rootElement,[K1,sw,X1]),this.hot.selection.isSelectedByRowHeader()&&ve(this.hot.rootElement,X1),e<1||t===void 0)return;const r=it(ia,this)[0],n=this.hot.toPhysicalRow(r),i=this.dragRows(it(ia,this),t);if(it(ia,this).length=0,i===!0){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();const s=this.hot.toVisualRow(n),o=s+e-1;this.hot.selectRows(s,o)}}function vue(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),r=t.holder.scrollLeft,n=e+r;it($n,this).setPosition(null,n),it($n,this).setSize(t.hider.offsetWidth-n)}function Cue(){this.moveBySettingsOrLoad()}function Sue(t,e){J2(t,e),e.add(t)}function yn(t,e,r){J2(t,e),e.set(t,r)}function J2(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vr(t,e,r){return t.set(qo(t,e),r),r}function Ie(t,e){return t.get(qo(t,e))}function qo(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const ow="manualRowResize",yue=30,aO="manualRowHeights";var io=new WeakMap,Cp=new WeakMap,wi=new WeakMap,wf=new WeakMap,Ja=new WeakMap,$E=new WeakMap,ch=new WeakMap,Sp=new WeakMap,Nn=new WeakMap,eo=new WeakMap,ku=new WeakMap,aw=new WeakMap,vf=new WeakMap,Cf=new WeakMap,vs=new WeakMap,Sf=new WeakMap,Fa=new WeakSet;class bue extends At{static get PLUGIN_KEY(){return ow}static get PLUGIN_PRIORITY(){return yue}constructor(e){super(e),Sue(this,Fa),yn(this,io,null),yn(this,Cp,null),yn(this,wi,[]),yn(this,wf,null),yn(this,Ja,null),yn(this,$E,null),yn(this,ch,null),yn(this,Sp,null),yn(this,Nn,this.hot.rootDocument.createElement("DIV")),yn(this,eo,this.hot.rootDocument.createElement("DIV")),yn(this,ku,!1),yn(this,aw,!1),yn(this,vf,0),yn(this,Cf,null),yn(this,vs,void 0),yn(this,Sf,void 0),ve(Ie(Nn,this),"manualRowResizer"),ve(Ie(eo,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[ow]}enablePlugin(){this.enabled||(vr(vs,this,new xl),Ie(vs,this).addLocalHook("init",()=>qo(Fa,this,Mue).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Ie(vs,this)),this.addHook("modifyRowHeight",(e,r)=>qo(Fa,this,Aue).call(this,e,r)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){vr(Sf,this,Ie(vs,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",aO,Ie(vs,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",aO,e),e.value}setManualSize(e,r){const n=this.hot.toPhysicalRow(e),i=Math.max(r,vD);return Ie(vs,this).setValueAtIndex(n,i),i}getLastDesiredRowHeight(){return Ie(wf,this)}setupHandlePosition(e){vr(io,this,e);const{view:r}=this.hot,{_wt:n}=r,i=n.wtTable.getCoords(Ie(io,this)),s=i.row;if(s<0)return;const o=tr(Ie(io,this)),a=Ie(io,this).getBoundingClientRect(),l=s<n.getSetting("fixedRowsTop"),u=s>=r.countNotHiddenRowIndexes(0,1)-n.getSetting("fixedRowsBottom");let c;l?c=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Ie(io,this),i.row,i.col):u&&(c=n.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Ie(io,this),i.row,i.col)),c||(c=n.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Ie(io,this),i.row,i.col)),vr(Cp,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(s)),vr(wi,this,[]);const h=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&h){const d=this.hot.getSelectedRange();V(d,f=>{const m=f.getTopStartCorner().row,g=f.getBottomStartCorner().row;Ue(m,g,w=>{Ie(wi,this).includes(w)||Ie(wi,this).push(w)})})}Ie(wi,this).includes(Ie(Cp,this))||vr(wi,this,[Ie(Cp,this)]),vr(Sp,this,c.top-6),vr(ch,this,parseInt(a.height,10)),Ie(Nn,this).style.top=`${Ie(Sp,this)+Ie(ch,this)}px`,Ie(Nn,this).style[this.inlineDir]=`${c.start}px`,Ie(Nn,this).style.width=`${o}px`,this.hot.rootElement.appendChild(Ie(Nn,this))}refreshHandlePosition(){Ie(Nn,this).style.top=`${Ie(Sp,this)+Ie(wf,this)}px`}setupGuidePosition(){const e=parseInt(tr(Ie(Nn,this)),10),r=parseInt(Ie(Nn,this).style[this.inlineDir],10)+e,n=parseInt(this.hot.view.maximumVisibleElementWidth(0),10);ve(Ie(Nn,this),"active"),ve(Ie(eo,this),"active"),Ie(eo,this).style.top=Ie(Nn,this).style.top,Ie(eo,this).style[this.inlineDir]=`${r}px`,Ie(eo,this).style.width=`${n-e}px`,this.hot.rootElement.appendChild(Ie(eo,this))}refreshGuidePosition(){Ie(eo,this).style.top=Ie(Nn,this).style.top}hideHandleAndGuide(){tt(Ie(Nn,this),"active"),tt(Ie(eo,this),"active")}checkIfRowHeader(e){const r=fl(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:s}=this.hot.view._wt.wtOverlays;return[n.clone.wtTable.TBODY,i.clone.wtTable.TBODY,s.clone.wtTable.TBODY].includes(r)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const r=this.hot.view._wt.wtTable.getRowHeight(e);return r!==void 0&&Ie(Ja,this)<r?r:Ie(Ja,this)}afterMouseDownTimeout(){const e=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},r=(n,i)=>{const s=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!0);s!==void 0&&vr(Ja,this,s),this.setManualSize(n,Ie(Ja,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!0),i&&e()};Ie(vf,this)>=2&&(Ie(wi,this).length>1?(V(Ie(wi,this),i=>{r(i)}),e()):V(Ie(wi,this),i=>{r(i,!0)})),vr(vf,this,0),vr(Cf,this,null)}bindEvents(){const{rootElement:e,rootWindow:r}=this.hot;this.eventManager.addEventListener(e,"mouseover",n=>qo(Fa,this,xue).call(this,n)),this.eventManager.addEventListener(e,"mousedown",n=>qo(Fa,this,Rue).call(this,n)),this.eventManager.addEventListener(r,"mousemove",n=>qo(Fa,this,Eue).call(this,n)),this.eventManager.addEventListener(r,"mouseup",()=>qo(Fa,this,Tue).call(this)),this.eventManager.addEventListener(Ie(Nn,this),"contextmenu",()=>qo(Fa,this,_ue).call(this))}destroy(){super.destroy()}}function xue(t){if(!Jb(t.target)&&Ie(aw,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Ie(ku,this)||this.setupHandlePosition(e))}}function Rue(t){Qe(t.target,"manualRowResizer")&&(this.setupHandlePosition(Ie(io,this)),this.setupGuidePosition(),vr(ku,this,!0),Ie(Cf,this)===null&&(vr(Cf,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Ie(Cf,this))),vr(vf,this,Ie(vf,this)+1),vr($E,this,t.pageY),vr(Ja,this,Ie(ch,this)))}function Eue(t){Ie(ku,this)&&(vr(wf,this,Ie(ch,this)+(t.pageY-Ie($E,this))),V(Ie(wi,this),e=>{vr(Ja,this,this.setManualSize(e,Ie(wf,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function Tue(){const t=()=>{this.hot.forceFullRender=!0,this.hot.view.render(),this.hot.view.adjustElementsSize()},e=(r,n)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(r),r,!1),n&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(r),r,!1)};Ie(ku,this)&&(this.hideHandleAndGuide(),vr(ku,this,!1),Ie(Ja,this)!==Ie(ch,this)&&(Ie(wi,this).length>1?(V(Ie(wi,this),n=>{e(n)}),t()):V(Ie(wi,this),n=>{e(n,!0)})),this.setupHandlePosition(Ie(io,this)))}function _ue(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Ie(Nn,this)),this.hot.rootElement.removeChild(Ie(eo,this)),vr(ku,this,!1),vr(aw,this,!0),this.hot._registerImmediate(()=>{vr(aw,this,!1)})}function Aue(t,e){let r=t;if(this.enabled){const n=this.hot.toPhysicalRow(e),i=Ie(vs,this).getValueAtIndex(n);this.hot.getSettings()[ow]&&i&&(r=i)}return r}function Mue(){const t=this.hot.getSettings()[ow],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((r,n)=>{Ie(vs,this).setValueAtIndex(n,r)}):Array.isArray(t)?(t.forEach((r,n)=>{Ie(vs,this).setValueAtIndex(n,r)}),vr(Sf,this,t)):t===!0&&Array.isArray(Ie(Sf,this))&&Ie(Sf,this).forEach((r,n)=>{Ie(vs,this).setValueAtIndex(n,r)})},!0)}function Oue(t,e,r){Iue(t,e),e.set(t,r)}function Iue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function su(t,e,r){return(e=Pue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pue(t){var e=Nue(t,"string");return typeof e=="symbol"?e:e+""}function Nue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lO(t,e){return t.get(Q2(t,e))}function yp(t,e,r){return t.set(Q2(t,e),r),r}function Q2(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var ou=new WeakMap;class so{constructor(e,r,n,i,s,o){su(this,"row",void 0),su(this,"col",void 0),su(this,"rowspan",void 0),su(this,"colspan",void 0),su(this,"removed",!1),su(this,"cellCoordsFactory",void 0),su(this,"cellRangeFactory",void 0),Oue(this,ou,null),this.row=e,this.col=r,this.rowspan=n,this.colspan=i,this.cellCoordsFactory=s,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return Ft`The merged cell declared with {row: ${r}, col: ${n},\x20
      rowspan: ${i}, colspan: ${s}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:r,col:n}=e;return Ft`The merged cell declared at [${r}, ${n}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:r,col:n}=e;return Ft`The merged cell declared at [${r}, ${n}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:r,col:n}=e;return Ft`The merged cell declared at [${r}, ${n}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:r,col:n,rowspan:i,colspan:s}=e;return r<0||n<0||i<0||s<0}static isSingleCell(e){let{rowspan:r,colspan:n}=e;return n===1&&r===1}static containsZeroSpan(e){let{rowspan:r,colspan:n}=e;return n===0||r===0}static isOutOfBounds(e,r,n){return e.row<0||e.col<0||e.row>=r||e.row+e.rowspan-1>=r||e.col>=n||e.col+e.colspan-1>=n}normalize(e){const r=e.countRows(),n=e.countCols();this.row<0?this.row=0:this.row>r-1&&(this.row=r-1),this.col<0?this.col=0:this.col>n-1&&(this.col=n-1),this.row+this.rowspan>r-1&&(this.rowspan=r-this.row),this.col+this.colspan>n-1&&(this.colspan=n-this.col),yp(ou,this,null)}includes(e,r){return this.row<=e&&this.col<=r&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=r}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,r){const n=e[0]||e[1],i=r+Math.abs(e[0]||e[1])-1,s=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",a=Math.min(r,i),l=Math.max(r,i),u=this[o],c=this[o]+this[s]-1;if(u>=r&&(this[o]+=n),n>0)r<=c&&r>u&&(this[s]+=n);else if(n<0){if(a<=u&&l>=c)return this.removed=!0,yp(ou,this,null),!1;if(u>=a&&u<=l){const h=l-u+1,d=Math.abs(n)-h;this[o]-=d+n,this[s]-=h}else if(u<=a&&c>=l)this[s]+=n;else if(u<=a&&c>=a&&c<l){const h=c-a+1;this[s]-=h}}return yp(ou,this,null),!0}isFarther(e,r){return e?r==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:r==="up"?e.row>this.row:r==="right"?e.col+e.colspan-1<this.col+this.colspan-1:r==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return lO(ou,this)||yp(ou,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),lO(ou,this)}}function Due(t,e){Hue(t,e),e.add(t)}function Hue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function bp(t,e,r){return(e=kue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kue(t){var e=Fue(t,"string");return typeof e=="symbol"?e:e+""}function Fue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function au(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var La=new WeakSet;class lw{constructor(e){Due(this,La),bp(this,"plugin",void 0),bp(this,"mergedCells",[]),bp(this,"mergedCellsMatrix",new Map),bp(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:r,col:n}=e;return Ft`The merged cell declared at [${r}, ${n}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,r){var n;return this.mergedCellsMatrix.has(e)&&(n=this.mergedCellsMatrix.get(e).get(r))!==null&&n!==void 0?n:!1}getByRange(e){let r=!1;return V(this.mergedCells,n=>n.row<=e.from.row&&n.row+n.rowspan-1>=e.to.row&&n.col<=e.from.col&&n.col+n.colspan-1>=e.to.col?(r=n,r):!0),r}filterOverlappingMergeCells(e){const r=new Set;return this.mergedCells.forEach(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i;for(let u=s;u<s+l;u++)for(let c=o;c<o+a;c++)r.add(`r${u},c${c}`)}),e.filter(i=>{const{row:s,col:o,colspan:a,rowspan:l}=i,u=new Set;let c=!1;for(let h=s;h<s+l;h++){for(let d=o;d<o+a;d++){const f=`r${h},c${d}`;if(r.has(f)){kt(lw.IS_OVERLAPPING_WARNING(i)),c=!0;break}u.add(f)}if(c)break}return c||r.add(...u),!c})}getWithinRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:n,col:i}=e.getTopStartCorner(),{row:s,col:o}=e.getBottomEndCorner(),a=[];for(let l=n;l<=s;l++)for(let u=i;u<=o;u++){const c=this.get(l,u);c&&(r||!r&&c.row===l&&c.col===u)&&a.push(c)}return a}add(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=e.row,i=e.col,s=e.rowspan,o=e.colspan,a=new so(n,i,s,o,this.hot._createCellCoords,this.hot._createCellRange),l=this.get(n,i),u=r?!1:this.isOverlapping(a);return!l&&!u?(this.hot&&a.normalize(this.hot),this.mergedCells.push(a),au(La,this,uO).call(this,a),a):(kt(lw.IS_OVERLAPPING_WARNING(a)),!1)}remove(e,r){const n=this.get(e,r),i=n?this.mergedCells.indexOf(n):-1;return n&&i!==-1?(this.mergedCells.splice(i,1),au(La,this,Lue).call(this,n),n):!1}clear(){V(this.mergedCells,e=>{let{row:r,col:n,rowspan:i,colspan:s}=e;Ue(r,r+i,o=>{Ue(n,n+s,a=>{const l=this.hot.getCell(o,a);l&&(l.removeAttribute("rowspan"),l.removeAttribute("colspan"),l.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const r=e.getRange();for(let n=0;n<this.mergedCells.length;n++)if(this.mergedCells[n].getRange().overlaps(r))return!0;return!1}isFirstRenderableMergedCell(e,r){const n=this.get(e,r);return n&&this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)===r}getFirstRenderableCoords(e,r){const n=this.get(e,r);if(!n||this.isFirstRenderableMergedCell(e,r))return this.hot._createCellCoords(e,r);const i=this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),s=this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1);return this.hot._createCellCoords(i,s)}getStartMostColumnIndex(e,r){const n=au(La,this,xp).call(this,e,"col",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getEndMostColumnIndex(e,r){const n=au(La,this,xp).call(this,e,"col",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}getTopMostRowIndex(e,r){const n=au(La,this,xp).call(this,e,"row",-1);let i=r;for(let s=0;s<n.length;s++)if(n[s]<=r){i=n[s];break}return i}getBottomMostRowIndex(e,r){const n=au(La,this,xp).call(this,e,"row",1);let i=r;for(let s=0;s<n.length;s++)if(n[s]>=r){i=n[s];break}return i}shiftCollections(e,r,n){const i=[0,0];switch(e){case"right":i[0]+=n;break;case"left":i[0]-=n;break;case"down":i[1]+=n;break;case"up":i[1]-=n;break}const s=[];this.mergedCells.forEach(o=>{o.shift(i,r),o.removed&&s.push(o)}),s.forEach(o=>{this.mergedCells.splice(this.mergedCells.indexOf(o),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(o=>{au(La,this,uO).call(this,o)})}}function xp(t,e){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const n=new Map,i=r===1?t.getTopStartCorner():t.getBottomEndCorner(),s=r===1?t.getBottomEndCorner():t.getTopStartCorner();for(let o=i.row;r===1?o<=s.row:o>=s.row;o+=r)for(let a=i.col;r===1?a<=s.col:a>=s.col;a+=r){const l=e==="row"?o:a,u=this.get(o,a);let c=l;u&&(c=r===1?u[e]+u[`${e}span`]-1:u[e]),n.has(l)||n.set(l,new Set),n.get(l).add(c)}return Array.from(new Set(Array.from(n.entries()).filter(o=>{let[,a]=o;return a.size===1}).flatMap(o=>{let[,a]=o;return Array.from(a)})))}function uO(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(r,t)}function Lue(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let r=t.col;r<t.col+t.colspan;r++)this.mergedCellsMatrix.get(e).delete(r)}function iy(t,e,r){return(e=$ue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $ue(t){var e=Bue(t,"string");return typeof e=="symbol"?e:e+""}function Bue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vue{constructor(e){iy(this,"plugin",void 0),iy(this,"mergedCellsCollection",void 0),iy(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}correctSelectionAreaSize(e){if(e[0]===e[2]&&e[1]===e[3]){const r=this.mergedCellsCollection.get(e[0],e[1]);r&&(e[2]=e[0]+r.rowspan-1,e[3]=e[1]+r.colspan-1)}}getDirection(e,r){let n=null;return r[0]===e[0]&&r[1]===e[1]&&r[3]===e[3]?n="down":r[2]===e[2]&&r[1]===e[1]&&r[3]===e[3]?n="up":r[1]===e[1]&&r[2]===e[2]?n="right":n="left",n}snapDragArea(e,r,n,i){const s=r.slice(0),o=this.getAutofillSize(e,r,n),[a,l,u,c]=e,d=["up","down"].indexOf(n)>-1?u-a+1:c-l+1,f=Math.floor(o/d)*d,m=o-f,g=this.getFarthestCollection(e,r,n,i);if(g){if(n==="down"){const w=g.row+g.rowspan-a-m;s[2]+w>=this.plugin.hot.countRows()?s[2]-=m:s[2]+=m?w:0}else if(n==="right"){const w=g.col+g.colspan-l-m;s[3]+w>=this.plugin.hot.countCols()?s[3]-=m:s[3]+=m?w:0}else if(n==="up"){const w=u-m-g.row+1;s[0]+w<0?s[0]+=m:s[0]-=m?w:0}else if(n==="left"){const w=c-m-g.col+1;s[1]+w<0?s[1]+=m:s[1]-=m?w:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:n,foundMergedCells:i,fillSize:o,dragArea:s,cycleLength:d}),s}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Dr(this.currentFillData,e)}getAutofillSize(e,r,n){const[i,s,o,a]=e,[l,u,c,h]=r;switch(n){case"up":return i-l;case"down":return c-o;case"left":return s-u;case"right":return h-a;default:return null}}getDragArea(e,r,n){const[i,s,o,a]=e,[l,u,c,h]=r;switch(n){case"up":return[l,u,i-1,a];case"down":return[o+1,s,c,a];case"left":return[l,u,o,s-1];case"right":return[i,a+1,c,h];default:return null}}getFarthestCollection(e,r,n,i){const[s,o,a,l]=e,u=["up","down"].indexOf(n)>-1,c=u?a:l,h=u?s:o,d=this.getAutofillSize(e,r,n),f=u?a-s+1:l-o+1,m=Math.floor(d/f)*f,g=d-m;let w=null,S=null,b=null;switch(n){case"up":w="includesVertically",b=c-g+1;break;case"left":w="includesHorizontally",b=c-g+1;break;case"down":w="includesVertically",b=h+g-1;break;case"right":w="includesHorizontally",b=h+g-1;break}return V(i,y=>{y[w](b)&&y.isFarther(S,n)&&(S=y)}),S}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const r=this.getRangeFromChanges(e),n=this.currentFillData.foundMergedCells,i=this.currentFillData.dragDirection,s=(u,c)=>{switch(i){case"up":return u.row-c>=r.from.row;case"down":return u.row+u.rowspan-1+c<=r.to.row;case"left":return u.col-c>=r.from.column;case"right":return u.col+u.colspan-1+c<=r.to.column;default:return null}};let o=0,a=null,l=1;do for(let u=0;u<n.length;u+=1){if(a=n[u],o=l*this.currentFillData.cycleLength,s(a,o))switch(i){case"up":this.plugin.mergedCellsCollection.add({row:a.row-o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"down":this.plugin.mergedCellsCollection.add({row:a.row+o,rowspan:a.rowspan,col:a.col,colspan:a.colspan});break;case"left":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col-o,colspan:a.colspan});break;case"right":this.plugin.mergedCellsCollection.add({row:a.row,rowspan:a.rowspan,col:a.col+o,colspan:a.colspan});break}u===n.length-1&&(l+=1)}while(s(a,o));this.currentFillData=null,this.plugin.hot.render(),n.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const r={min:null,max:null},n={min:null,max:null};return V(e,i=>{const s=i[0],o=this.plugin.hot.propToCol(i[1]);(r.min===null||s<r.min)&&(r.min=s),(r.max===null||s>r.max)&&(r.max=s),(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o)}),{from:{row:r.min,column:n.min},to:{row:r.max,column:n.max}}}dragAreaOverlapsCollections(e,r,n){const i=this.getDragArea(e,r,n),[s,o,a,l]=i,u=this.plugin.hot._createCellCoords(s,o),c=this.plugin.hot._createCellCoords(a,l),h=this.plugin.hot._createCellRange(u,u,c);return this.mergedCellsCollection.getWithinRange(h,!0).length>0}}function sy(t,e,r){return(e=Wue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Wue(t){var e=Uue(t,"string");return typeof e=="symbol"?e:e+""}function Uue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jue{constructor(e){sy(this,"plugin",void 0),sy(this,"hot",void 0),sy(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,r,n,i){const s=Math.min(n[0],n[2]),o=Math.min(n[1],n[3]),a=Math.max(n[0],n[2]),l=Math.max(n[1],n[3]);if(i===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,r))return;const c=this.plugin.mergedCellsCollection.get(e,r);if(!c)return;const h=c.getLastRow(),d=c.getLastColumn();if(s<=c.row&&o<=c.col&&a>=h&&l>=d)return`${this.fullySelectedMergedCellClassName}-${i}`;if(this.isMergeCellFullySelected(c,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,r){const n=[];if(!r||!e)return!1;for(let i=0;i<e.rowspan;i+=1)for(let s=0;s<e.colspan;s+=1)n.push(this.hot._createCellCoords(e.row+i,e.col+s));for(let i=0;i<n.length;i+=1){const s=[];for(let o=0;o<r.length;o+=1)s[o]=r[o].includes(n[i]);if(!s.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let r=0;r<=7;r+=1)e.push(`${this.fullySelectedMergedCellClassName}-${r}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function zue(t){return{key:"mergeCells",name(){const e=this.getSelectedLast();if(e){const r=t.mergedCellsCollection.get(e[0],e[1]);if(r.row===e[0]&&r.col===e[1]&&r.row+r.rowspan-1===e[2]&&r.col+r.colspan-1===e[3])return this.getTranslatedPhrase(oR)}return this.getTranslatedPhrase(sR)},callback(){const e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;t.toggleMerge(e),this.selectCell(r.row,r.col,n.row,n.col,!1)},disabled(){const e=this.getSelectedLast();return e?so.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function yf(t,e,r){return(e=Yue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Yue(t){var e=Gue(t,"string");return typeof e=="symbol"?e:e+""}function Gue(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cO{constructor(e){yf(this,"data",void 0),yf(this,"next",null),yf(this,"prev",null),this.data=e}}class Rp{constructor(){yf(this,"first",null),yf(this,"last",null)}push(e){const r=new cO(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.last;this.last=r,r.prev=n,n.next=r}return r}unshift(e){const r=new cO(e);if(this.first===null)this.first=r,this.last=r;else{const n=this.first;this.first=r,r.next=n,n.prev=r}}inorder(e){let r=this.first;for(;r;){const n=e(r);if(r===this.last||n===!0)break;r=r.next}}remove(e){if(this.first===null)return!1;let r=this.first,n,i;for(;r;){if(r.data===e)return n=r.next,i=r.prev,n&&(n.prev=i),i&&(i.next=n),r===this.first&&(this.first=n),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,r=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,r=r.next,e===r)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(n,i){i&&(e(i,i.next),i.next=n)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const r=this.first;this.first=this.last,this.last=r}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,r=this.first,n;for(;e;)n=e.next,e.next=r,r.prev=e,r=e,e=n;this.first.next=null,this.last.prev=null,n=this.first,this.first=r,this.last=n}}function Kue(t,e){ek(t,e),e.add(t)}function lu(t,e,r){ek(t,e),e.set(t,r)}function ek(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pt(t,e){return t.get(uw(t,e))}function ci(t,e,r){return t.set(uw(t,e),r),r}function uw(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Ks=new WeakMap,Xs=new WeakMap,qs=new WeakMap,Zs=new WeakMap,q1=new WeakMap,Ep=new WeakMap,Tp=new WeakMap,oy=new WeakSet;class Xue{constructor(e){let{mergedCellsGetter:r,rowIndexMapper:n,columnIndexMapper:i}=e;Kue(this,oy),lu(this,Ks,new Rp),lu(this,Xs,new Rp),lu(this,qs,null),lu(this,Zs,null),lu(this,q1,null),lu(this,Ep,null),lu(this,Tp,null),ci(q1,this,r),ci(Ep,this,n),ci(Tp,this,i)}getCurrentVerticalNode(){return Pt(Zs,this).data}getFirstVerticalNode(){return Pt(Xs,this).first.data}getNextVerticalNode(){return Pt(Zs,this).next.data}getPrevVerticalNode(){return Pt(Zs,this).prev.data}getCurrentHorizontalNode(){return Pt(qs,this).data}getFirstHorizontalNode(){return Pt(Ks,this).first.data}getNextHorizontalNode(){return Pt(qs,this).next.data}getPrevHorizontalNode(){return Pt(qs,this).prev.data}setPrevNodeAsActive(){ci(Zs,this,Pt(Zs,this).prev),ci(qs,this,Pt(qs,this).prev)}setNextNodeAsActive(){ci(Zs,this,Pt(Zs,this).next),ci(qs,this,Pt(qs,this).next)}buildFocusOrder(e){const r=e.getTopStartCorner(),n=e.getBottomEndCorner(),i=new WeakSet;ci(Ks,this,new Rp);for(let o=r.row;o<=n.row;o++)if(!Pt(Ep,this).isHidden(o))for(let a=r.col;a<=n.col;a++){if(Pt(Tp,this).isHidden(a))continue;const l=uw(oy,this,hO).call(this,e,Pt(Ks,this),i,o,a);l&&ci(qs,this,l)}Pt(Ks,this).first&&(Pt(Ks,this).first.prev=Pt(Ks,this).last,Pt(Ks,this).last.next=Pt(Ks,this).first);const s=new WeakSet;ci(Xs,this,new Rp);for(let o=r.col;o<=n.col;o++)if(!Pt(Tp,this).isHidden(o))for(let a=r.row;a<=n.row;a++){if(Pt(Ep,this).isHidden(a))continue;const l=uw(oy,this,hO).call(this,e,Pt(Xs,this),s,a,o);l&&ci(Zs,this,l)}Pt(Xs,this).first&&(Pt(Xs,this).first.prev=Pt(Xs,this).last,Pt(Xs,this).last.next=Pt(Xs,this).first)}setActiveNode(e,r){return Pt(Ks,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return ci(qs,this,n),!1}),Pt(Xs,this).inorder(n=>{const{rowStart:i,rowEnd:s,colStart:o,colEnd:a}=n.data;if(e>=i&&e<=s&&r>=o&&r<=a)return ci(Zs,this,n),!1}),this}}function hO(t,e,r,n,i){const s=t.getTopStartCorner(),o=t.getBottomEndCorner(),a=t.highlight.clone().normalize(),l=Pt(q1,this).call(this,n,i);if(l&&r.has(l))return null;const u={colStart:i,colEnd:i,rowStart:n,rowEnd:n};if(l){if(r.add(l),l.row<s.row||l.row+l.rowspan-1>o.row||l.col<s.col||l.col+l.colspan-1>o.col)return null;u.colStart=l.col,u.colEnd=l.col+l.colspan-1,u.rowStart=l.row,u.rowEnd=l.row+l.rowspan-1}const c=e.push(u);return n===a.row&&i===a.col||l&&a.row>=l.row&&a.row<=l.row+l.rowspan-1&&a.col>=l.col&&a.col<=l.col+l.colspan-1?c:null}function que(t){const{hot:e}=t,{rowIndexMapper:r,columnIndexMapper:n}=e;function i(){}function s(o,a,l){const u=t.mergedCellsCollection.get(a,l);if(!ut(u)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="";return}const{row:c,col:h,colspan:d,rowspan:f}=u,[m,g]=t.translateMergedCellToRenderable(c,f,h,d),w=r.getRenderableFromVisualIndex(a),S=n.getRenderableFromVisualIndex(l),b=m-w+1,y=g-S+1,_=r.getNearestNotHiddenIndex(c,1),P=n.getNearestNotHiddenIndex(h,1),z=Math.min(f,b),I=Math.min(d,y);_===a&&P===l?(o.setAttribute("rowspan",z),o.setAttribute("colspan",I)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}return{before:i,after:s}}function Zue(t,e){tk(t,e),e.add(t)}function _p(t,e,r){tk(t,e),e.set(t,r)}function tk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ay(t,e,r){return(e=Jue(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Jue(t){var e=Que(t,"string");return typeof e=="symbol"?e:e+""}function Que(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Zf(t,e,r){return t.set(Dt(t,e),r),r}function Qt(t,e){return t.get(Dt(t,e))}function Dt(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeMergeCells");He.getSingleton().register("afterMergeCells");He.getSingleton().register("beforeUnmergeCells");He.getSingleton().register("afterUnmergeCells");const bf="mergeCells",ece=150,dO=bf;var Ui=new WeakMap,ji=new WeakMap,fo=new WeakMap,fO=new WeakMap,$t=new WeakSet;class tce extends At{constructor(){super(...arguments),Zue(this,$t),ay(this,"mergedCellsCollection",null),ay(this,"autofillCalculations",null),ay(this,"selectionCalculations",null),_p(this,Ui,null),_p(this,ji,{row:0,col:0}),_p(this,fo,new Xue({mergedCellsGetter:(e,r)=>this.mergedCellsCollection.get(e,r),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_p(this,fO,que(this))}static get PLUGIN_KEY(){return bf}static get PLUGIN_PRIORITY(){return ece}isEnabled(){return!!this.hot.getSettings()[bf]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new lw(this),this.autofillCalculations=new Vue(this),this.selectionCalculations=new jue(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,rce).call(e,...n)}),this.addHook("modifyTransformFocus",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,ice).call(e,...n)}),this.addHook("modifyTransformStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,sce).call(e,...n)}),this.addHook("modifyTransformEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,oce).call(e,...n)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,ace).call(e,...n)}),this.addHook("beforeSetRangeStart",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,gO).call(e,...n)}),this.addHook("beforeSetRangeStartOnly",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,gO).call(e,...n)}),this.addHook("beforeSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,cce).call(e,...n)}),this.addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,hce).call(e,...n)}),this.addHook("afterSelectionEnd",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,dce).call(e,...n)}),this.addHook("modifyGetCellCoords",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,lce).call(e,...n)}),this.addHook("afterIsMultipleSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,nce).call(e,...n)}),this.addHook("afterRenderer",function(){return Qt(fO,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,uce).call(e,...n)}),this.addHook("afterGetCellMeta",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,fce).call(e,...n)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,gce).call(e,...n)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,mce).call(e,...n)}),this.addHook("modifyAutofillRange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,pce).call(e,...n)}),this.addHook("afterCreateCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,wce).call(e,...n)}),this.addHook("afterRemoveCol",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,vce).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,Cce).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,Sce).call(e,...n)}),this.addHook("afterChange",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,yce).call(e,...n)}),this.addHook("beforeDrawBorders",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,bce).call(e,...n)}),this.addHook("afterDrawSelection",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,xce).call(e,...n)}),this.addHook("beforeRemoveCellClassNames",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,Rce).call(e,...n)}),this.addHook("beforeBeginEditing",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,Ece).call(e,...n)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Dt($t,e,Tce).call(e,...n)}),this.addHook("beforeUndoStackChange",(r,n)=>{if(n==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){const e=this.hot.getSettings()[bf];this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(e),super.updatePlugin()}ifChromeForceRepaint(){if(!nx())return;const e=[];let r=[];this.mergedCellsCollection.mergedCells.forEach(n=>{const{row:i,rowspan:s}=n;for(let o=i+1;o<i+s;o++)r.push(o)}),r=[...new Set(r)],r.forEach(n=>{const i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(n);this.hot.view._wt.wtOverlays.getOverlays(!0).map(s=>(s==null?void 0:s.name)==="master"?s:s.clone.wtTable).forEach(s=>{const o=s.getRow(i);o&&(o.style.background=mh(o,"backgroundColor").replace(")",", 0.99)"),e.push(o))})}),this.hot._registerTimeout(()=>{e.forEach(n=>{n.style.background=mh(n,"backgroundColor").replace(", 0.99)",")")})},1)}validateSetting(e){return e?so.containsNegativeValues(e)?(kt(so.NEGATIVE_VALUES_WARNING(e)),!1):so.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(kt(so.IS_OUT_OF_BOUNDS_WARNING(e)),!1):so.isSingleCell(e)?(kt(so.IS_SINGLE_CELL(e)),!1):so.containsZeroSpan(e)?(kt(so.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(e){if(!Array.isArray(e))return;const r=e.filter(s=>this.validateSetting(s)),n=this.mergedCellsCollection.filterOverlappingMergeCells(r),i=[];n.forEach(s=>{const{row:o,col:a,rowspan:l,colspan:u}=s,c=this.hot._createCellCoords(o,a),h=this.hot._createCellCoords(o+l-1,a+u-1),d=this.hot._createCellRange(c,c,h);this.mergeRange(d,!0,!0);for(let f=o;f<o+l;f++)for(let m=a;m<a+u;m++)(f!==o||m!==a)&&i.push([f,m,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:r,to:n}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;const{from:r,to:n}=e;this.unmergeRange(e,!0),this.hot.selectCell(r.row,r.col,n.row,n.col,!1)}mergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=e.getTopStartCorner(),s=e.getBottomEndCorner(),o={row:i.row,col:i.col,rowspan:s.row-i.row+1,colspan:s.col-i.col+1},a=[];let l=null;return this.canMergeRange(o,r)?(this.hot.runHooks("beforeMergeCells",e,r),Ue(0,o.rowspan-1,c=>{Ue(0,o.colspan-1,h=>{let d=null;a[c]||(a[c]=[]),c===0&&h===0?d=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+c,o.col+h,"hidden",!0),a[c][h]=d})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),this.mergedCellsCollection.add(o,r)?(n?l=[o.row,o.col,a]:this.hot.populateFromArray(o.row,o.col,a,void 0,void 0,this.pluginName),r||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,r),l):!0):!1}unmergeRange(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const n=this.mergedCellsCollection.getWithinRange(e);n.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,r),V(n,i=>{this.mergedCellsCollection.remove(i.row,i.col),Ue(0,i.rowspan-1,s=>{Ue(0,i.colspan-1,o=>{this.hot.removeCellMeta(i.row+s,i.col+o,"hidden"),this.hot.removeCellMeta(i.row+s,i.col+o,"copyable")})}),this.hot.removeCellMeta(i.row,i.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,r),this.hot.render())}toggleMerge(e){const r=this.mergedCellsCollection.get(e.from.row,e.from.col);r.row===e.from.row&&r.col===e.from.col&&r.row+r.rowspan-1===e.to.row&&r.col+r.colspan-1===e.to.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.mergeRange(this.hot._createCellRange(s,s,o))}unmerge(e,r,n,i){const s=this.hot._createCellCoords(e,r),o=this.hot._createCellCoords(n,i);this.unmergeRange(this.hot._createCellRange(s,s,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const n=this.hot.getSelectedRangeLast();n&&!n.isSingleHeader()&&(this.toggleMerge(n),this.hot.render())},runOnlyIf:n=>!n.altKey,group:dO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(dO)}modifyViewportRowStart(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.startRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(ut(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.row,1));if(a<e.startRow){e.startRow=a,this.modifyViewportRowStart(e,r);return}}}}modifyViewportRowEnd(e,r){const n=this.hot.rowIndexMapper,i=n.getVisualFromRenderableIndex(e.endRow);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(i,s);if(ut(o)){const a=o.row+o.rowspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endRow){e.endRow=l,this.modifyViewportRowEnd(e,r);return}}}}modifyViewportColumnStart(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.startColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(ut(o)){const a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(o.col,1));if(a<e.startColumn){e.startColumn=a,this.modifyViewportColumnStart(e,r);return}}}}modifyViewportColumnEnd(e,r){const n=this.hot.columnIndexMapper,i=n.getVisualFromRenderableIndex(e.endColumn);for(let s=0;s<r;s+=1){const o=this.mergedCellsCollection.get(s,i);if(ut(o)){const a=o.col+o.colspan-1,l=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(a,-1));if(l>e.endColumn){e.endColumn=l,this.modifyViewportColumnEnd(e,r);return}}}}translateMergedCellToRenderable(e,r,n,i){const{rowIndexMapper:s,columnIndexMapper:o}=this.hot;let a,l;r===0?a=s.getNearestNotHiddenIndex(e,1):a=s.getNearestNotHiddenIndex(e+r-1,-1),i===0?l=o.getNearestNotHiddenIndex(n,1):l=o.getNearestNotHiddenIndex(n+i-1,-1);const u=e>=0?s.getRenderableFromVisualIndex(a):e,c=n>=0?o.getRenderableFromVisualIndex(l):n;return[u,c]}}function rce(){this.generateFromSettings(this.hot.getSettings()[bf]),this.hot.render()}function nce(t){if(t){const e=this.mergedCellsCollection.mergedCells,r=this.hot.getSelectedRangeLast(),n=r.getTopStartCorner(),i=r.getBottomEndCorner();for(let s=0;s<e.length;s+=1)if(n.row===e[s].row&&n.col===e[s].col&&i.row===e[s].row+e[s].rowspan-1&&i.col===e[s].col+e[s].colspan-1)return!1}return t}function ice(t){Qt(ji,this).row=t.row,Qt(ji,this).col=t.col}function sce(t){const e=this.hot.getSelectedRangeLast(),{highlight:r}=e,{columnIndexMapper:n,rowIndexMapper:i}=this.hot;Qt(Ui,this)&&(i.getRenderableFromVisualIndex(Qt(Ui,this).row)!==null&&(r.row=Qt(Ui,this).row),n.getRenderableFromVisualIndex(Qt(Ui,this).col)!==null&&(r.col=Qt(Ui,this).col),Zf(Ui,this,null));const s=this.mergedCellsCollection.get(r.row,r.col);if(!s)return;const o=s.col,a=s.col+s.colspan-1;if(t.col<0){const c=r.col>=o&&r.col<=a?o-1:a,h=n.getNearestNotHiddenIndex(c,-1);h===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,r.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,r.col)-1,1)}else if(t.col>0){const c=r.col>=o&&r.col<=a?a+1:o,h=n.getNearestNotHiddenIndex(c,1);h===null?t.col=this.hot.view.countRenderableColumnsInRange(r.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,h)-1,1)}const l=s.row,u=s.row+s.rowspan-1;if(t.row<0){const c=r.row>=l&&r.row<=u?l-1:u,h=i.getNearestNotHiddenIndex(c,-1);h===null?t.row=-this.hot.view.countRenderableRowsInRange(0,r.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,r.row)-1,1)}else if(t.row>0){const c=r.row>=l&&r.row<=u?u+1:l,h=i.getNearestNotHiddenIndex(c,1);h===null?t.row=this.hot.view.countRenderableRowsInRange(r.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,h)-1,1)}}function oce(t){const e=this.hot.getSelectedRangeLast(),r=e.clone(),{to:n}=e,{columnIndexMapper:i,rowIndexMapper:s}=this.hot,o=(a,l)=>{r.expand(this.hot._createCellCoords(a,l));for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)r.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange())};if(t.col<0){let a=this.mergedCellsCollection.getStartMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="E-W"&&r.getHorizontalDirection()==="E-W"&&(a=r.getTopStartCorner().col);const l=i.getNearestNotHiddenIndex(a,1);l!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,n.col)-1,1))}else if(t.col>0){let a=this.mergedCellsCollection.getEndMostColumnIndex(e,n.col)+t.col;o(n.row,a),e.getHorizontalDirection()==="W-E"&&r.getHorizontalDirection()==="W-E"&&(a=r.getBottomEndCorner().col);const l=i.getNearestNotHiddenIndex(a,-1);l!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,l)-1,1))}if(t.row<0){let a=this.mergedCellsCollection.getTopMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="S-N"&&r.getVerticalDirection()==="S-N"&&(a=r.getTopStartCorner().row);const l=s.getNearestNotHiddenIndex(a,1);l!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,n.row)-1,1))}else if(t.row>0){let a=this.mergedCellsCollection.getBottomMostRowIndex(e,n.row)+t.row;o(a,n.col),e.getVerticalDirection()==="N-S"&&r.getVerticalDirection()==="N-S"&&(a=r.getBottomStartCorner().row);const l=s.getNearestNotHiddenIndex(a,-1);l!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,l)-1,1))}}function ace(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Zf(Ui,this,e.clone());return}for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);for(let n=0;n<this.mergedCellsCollection.mergedCells.length;n+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[n].getRange(),!1);const r=this.mergedCellsCollection.get(e.row,e.col);Zf(Ui,this,e.clone()),r&&e.assign(r)}function lce(t,e){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:n,col:i,colspan:s,rowspan:o}=r;return[n,i,n+o-1,i+s-1]}function uce(t){t.items.push({name:"---------"},zue(this))}function gO(){Zf(Ui,this,null)}function cce(){if(Qt(Ui,this).isCell())return;const t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),r=t.getHorizontalDirection(),n=Qt(Ui,this).clone().normalize();Qt(fo,this).setActiveNode(n.row,n.col),Qt(ji,this).row>0||Qt(ji,this).col>0?Qt(fo,this).setPrevNodeAsActive():(r==="E-W"&&Qt(ji,this).col<0||e==="S-N"&&Qt(ji,this).row<0)&&Qt(fo,this).setNextNodeAsActive()}function hce(t,e){const r=this.hot.getSelectedRangeLast(),{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let s=null,o=null;if(Qt(ji,this).col<0){const{rowEnd:a,colEnd:l}=Qt(fo,this).getPrevHorizontalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(Qt(ji,this).col>0){const{rowStart:a,colStart:l}=Qt(fo,this).getNextHorizontalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}else if(Qt(ji,this).row<0){const{rowEnd:a,colEnd:l}=Qt(fo,this).getPrevVerticalNode();o=n.getNearestNotHiddenIndex(l,-1),s=i.getNearestNotHiddenIndex(a,-1)}else if(Qt(ji,this).row>0){const{rowStart:a,colStart:l}=Qt(fo,this).getNextVerticalNode();o=n.getNearestNotHiddenIndex(l,1),s=i.getNearestNotHiddenIndex(a,1)}if(s!==null||o!==null){const a=this.hot._createCellCoords(s,o),l=this.mergedCellsCollection.get(a.row,a.col),u=this.hot.selection.highlight.getFocus();t=a.row,e=a.col,l?r.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(l.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(l.col,1)}):r.highlight.assign(a),u.clear(),u.add(a).commit()}Qt(fo,this).setActiveNode(t,e),Zf(ji,this,{row:0,col:0})}function dce(){this.hot.getSelectedRangeLast().isHeader()||Qt(fo,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function fce(t,e,r){const n=this.mergedCellsCollection.get(t,e);n&&(n.row!==t||n.col!==e?r.copyable=!1:(r.rowspan=n.rowspan,r.colspan=n.colspan))}function gce(t){const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function mce(t){const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function pce(t,e){this.autofillCalculations.correctSelectionAreaSize(e);const r=this.autofillCalculations.getDirection(e,t);let n=t;if(this.autofillCalculations.dragAreaOverlapsCollections(e,n,r))return n=e,n;const i=this.hot._createCellCoords(e[0],e[1]),s=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,s),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0||(n=this.autofillCalculations.snapDragArea(e,n,r,a)),n}function wce(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function vce(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function Cce(t,e,r){r!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function Sce(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function yce(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function bce(t,e){if(e&&e==="area"){const r=this.hot.getSelectedRangeLast(),n=this.mergedCellsCollection.getWithinRange(r);V(n,i=>{r.getBottomEndCorner().row===i.getLastRow()&&r.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function xce(t,e,r,n){if(r)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,r,n)}function Rce(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function Ece(t,e,r,n){if(!(n instanceof MouseEvent))return;const i=this.hot.getSelectedRangeLast(),s=this.mergedCellsCollection.getByRange(i);if(!s)return;const o=this.hot._createCellCoords(s.row,s.col),a=this.hot._createCellCoords(s.row+s.rowspan-1,s.col+s.colspan-1);return this.hot.selection.getLayerLevel()===0&&i.isEqual(this.hot._createCellRange(o,o,a))}function Tce(t,e,r){if(this.hot.getSettings().rowHeaders||r==="bottom"||r==="bottom_inline_start_corner")return t;let n,i;if(r==="master")n=this.hot.view.getFirstRenderedVisibleColumn(),i=this.hot.view.getLastRenderedVisibleColumn();else{const d=this.hot.view.getOverlayByName(r);n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getFirstRenderedColumn()),i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,n))return t;const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(e,i),l=this.hot._createCellRange(o,o,a),u=this.mergedCellsCollection.getWithinRange(l),c=u.reduce((d,f)=>{let{rowspan:m}=f;return Math.max(d,m)},1);let h=0;return u.length>1&&u[0].rowspan<c&&(h=c-u[0].rowspan),u.forEach(d=>{var f;let{rowspan:m}=d,g=0;r==="top"||r==="top_inline_start_corner"?g=Math.min(c,this.hot.view.countNotHiddenFixedRowsTop()-e):g=m-h,t=Math.max((f=t)!==null&&f!==void 0?f:0,Dt($t,this,_ce).call(this,e,g))}),t}function _ce(t,e){const r=this.hot.view._wt.wtSettings.getSettingPure("defaultRowHeight"),n=this.hot.getPlugin("autoRowSize");let i=0;for(let o=t;o<t+e;o++)if(!this.hot.rowIndexMapper.isHidden(o)){var s;i+=(s=n==null?void 0:n.getRowHeight(o))!==null&&s!==void 0?s:r}return i}function Ace(t,e){return function(r,n){const[,...i]=r,[,...s]=n;return function o(a){const l=t[a],u=e[a],c=i[a],h=s[a],d=u.multiColumnSorting,m=(d.compareFunctionFactory?d.compareFunctionFactory:PH(u.type))(l,u,d)(c,h);if(m===po){const g=a+1;if(typeof e[g]<"u")return o(g)}return m}(0)}}function mO(){kt(Ft`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously. 
    Only \`multiColumnSorting\` will work. The \`columnSorting\` plugin will be disabled.`)}const rk="sort";function Mce(t,e,r){const n=[];return r===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&n.push(`${rk}-${t.getIndexOfColumnInSortQueue(e)+1}`),n}function Oce(t){const e=t.className.split(" "),r=new RegExp(`^${rk}-[0-9]{1,2}$`);return e.filter(n=>r.test(n))}function Ice(t,e,r){return(e=Pce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Pce(t){var e=Nce(t,"string");return typeof e=="symbol"?e:e+""}function Nce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const cw="multiColumnSorting",Dce=170,ly="columnSorting",pO=cw;IH(cw,Ace);class Hce extends VH{constructor(){super(...arguments),Ice(this,"pluginKey",cw)}static get PLUGIN_KEY(){return cw}static get PLUGIN_PRIORITY(){return Dce}isEnabled(){return super.isEnabled()}enablePlugin(){!this.enabled&&this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ly]&&(mO(),this.hot.getPlugin(ly).disablePlugin()),super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,Y0)),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.isHeader()},relativeToGroup:Rl,position:"before",group:pO})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pO)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];super.updateHeaderClasses(e,...n),tt(e,Oce(e)),this.enabled!==!1&&ve(e,Mce(...n))}onUpdateSettings(e){this.hot.getSettings()[this.pluginKey]&&this.hot.getSettings()[ly]&&mO(),super.onUpdateSettings(e)}onAfterOnCellMouseDown(e,r){EE(r.row,r.col,e)!==!1&&this.wasClickableHeaderClicked(e,r.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(r.col),this.sort(this.getNextSortConfig(r.col,Y0))):this.sort(this.getColumnNextConfig(r.col)))}}function wO(t,e,r){return(e=kce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function kce(t){var e=Fce(t,"string");return typeof e=="symbol"?e:e+""}function Fce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lce="multipleSelectionHandles",$ce=160;class Bce extends At{constructor(){super(...arguments),wO(this,"dragged",[]),wO(this,"lastSetCell",null)}static get PLUGIN_KEY(){return Lce}static get PLUGIN_PRIORITY(){return $ce}isEnabled(){return ea()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:r}=this.hot;function n(i){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const s=e.dragged.indexOf(i);if(s===-1)return!1;s===0?e.dragged=e.dragged.slice(0,1):s===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(r,"touchstart",i=>{let s;if(Qe(i.target,"topSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1;if(Qe(i.target,"bottomSelectionHandle-HitArea"))return s=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:s.getWidth(),height:s.getHeight(),direction:s.getDirection()},i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchend",i=>{if(Qe(i.target,"topSelectionHandle-HitArea"))return n.call(e,"top"),e.touchStartRange=void 0,i.preventDefault(),!1;if(Qe(i.target,"bottomSelectionHandle-HitArea"))return n.call(e,"bottom"),e.touchStartRange=void 0,i.preventDefault(),!1}),this.eventManager.addEventListener(r,"touchmove",i=>{const{rootDocument:s}=this.hot;let o,a,l,u,c,h;if(e.dragged.length===0)return;const d=s.elementFromPoint(i.touches[0].clientX,i.touches[0].clientY);!d||d===e.lastSetCell||((d.nodeName==="TD"||d.nodeName==="TH")&&(o=e.hot.getCoords(d),o.col===-1&&(o.col=0),a=e.hot.getSelectedRangeLast(),l=a.getWidth(),u=a.getHeight(),c=a.getDirection(),l===1&&u===1&&e.hot.selection.setRangeEnd(o),h=e.getCurrentRangeCoords(a,o,e.touchStartRange.direction,c,e.dragged[0]),h.start!==null&&e.hot.selection.setRangeStart(h.start),e.hot.selection.setRangeEnd(h.end),e.lastSetCell=d),i.preventDefault())})}getCurrentRangeCoords(e,r,n,i,s){const o=e.getTopStartCorner(),a=e.getBottomEndCorner(),l=e.getBottomStartCorner(),u=e.getTopEndCorner();let c={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":s==="top"?c={start:this.hot._createCellCoords(r.row,e.highlight.col),end:this.hot._createCellCoords(l.row,r.col)}:c={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,o.col)};break;case"SE-NW":s==="bottom"&&(c={start:this.hot._createCellCoords(a.row,r.col),end:this.hot._createCellCoords(r.row,o.col)});break}break;case"NW-SE":switch(i){case"NE-SW":s==="top"?c={start:r,end:l}:c.end=r;break;case"NW-SE":s==="top"?c={start:r,end:a}:c.end=r;break;case"SE-NW":s==="top"?c={start:r,end:o}:c.end=r;break;case"SW-NE":s==="top"?c={start:r,end:u}:c.end=r;break}break;case"SW-NE":switch(i){case"NW-SE":s==="bottom"?c={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(l.row,r.col)}:c={start:this.hot._createCellCoords(o.row,r.col),end:this.hot._createCellCoords(r.row,a.col)};break;case"SW-NE":s==="top"?c={start:this.hot._createCellCoords(e.highlight.row,r.col),end:this.hot._createCellCoords(r.row,a.col)}:c={start:this.hot._createCellCoords(r.row,o.col),end:this.hot._createCellCoords(o.row,r.col)};break;case"SE-NW":s==="bottom"?c={start:this.hot._createCellCoords(r.row,u.col),end:this.hot._createCellCoords(o.row,r.col)}:s==="top"&&(c={start:l,end:r});break}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":s==="top"&&(c.end=r);break;case"SE-NW":s==="top"?c.end=r:c={start:r,end:o};break}break}return c}isDragged(){return this.dragged.length>0}}function Z1(){let{label:t="",colspan:e=1,origColspan:r=1,collapsible:n=!1,crossHiddenColumns:i=[],isCollapsed:s=!1,isHidden:o=!1,isRoot:a=!1,isPlaceholder:l=!1,headerClassNames:u=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:r,collapsible:n,isCollapsed:s,crossHiddenColumns:i,isHidden:o,isRoot:a,isPlaceholder:l,headerClassNames:u}}function nk(){return{label:"",isPlaceholder:!0}}function Vce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const r=[];if(e===0)return r;V(t,i=>{const s=[];let o=0;r.push(s),V(i,a=>{const l=Z1();if(ut(a)){const{label:c,colspan:h,headerClassName:d}=a;l.label=yr(c),typeof h=="number"&&h>1&&(l.colspan=h,l.origColspan=h),typeof d=="string"&&(l.headerClassNames=[...d.split(" ")])}else l.label=yr(a);o+=l.origColspan;let u=!1;if(o>=e&&(l.colspan=l.origColspan-(o-e),l.origColspan=l.colspan,u=!0),s.push(l),l.colspan>1)for(let c=0;c<l.colspan-1;c++)s.push(nk());return!u})});const n=Math.max(...St(r,i=>i.length));return V(r,i=>{if(i.length<n){const s=St(new Array(n-i.length),()=>Z1());i.splice(i.length,0,...s)}}),r}function uy(t,e,r){Wce(t,e),e.set(t,r)}function Wce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function us(t,e){return t.get(ik(t,e))}function $d(t,e,r){return t.set(ik(t,e),r),r}function ik(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const vO=["label","collapsible"];var Wo=new WeakMap,uu=new WeakMap,cy=new WeakMap;class Uce{constructor(){uy(this,Wo,[]),uy(this,uu,0),uy(this,cy,1/0)}setColumnsLimit(e){$d(cy,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];$d(Wo,this,Vce(e,us(cy,this))),$d(uu,this,us(Wo,this).length)}getData(){return us(Wo,this)}mergeWith(e){V(e,r=>{let{row:n,col:i,...s}=r;const o=this.getHeaderSettings(n,i);o!==null&&Dr(o,s,vO)})}map(e){V(us(Wo,this),r=>{V(r,n=>{const i=e({...n});ut(i)&&Dr(n,i,vO)})})}getHeaderSettings(e,r){var n;if(e>=us(uu,this)||e<0)return null;const i=us(Wo,this)[e];return Array.isArray(i)===!1||r>=i.length?null:(n=i[r])!==null&&n!==void 0?n:null}getHeadersSettings(e,r){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=[];if(e>=us(uu,this)||e<0)return i;const s=us(Wo,this)[e];let o=0;for(let a=r;a<s.length;a++){const l=s[a];if(l.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(o+=l.colspan,i.push(l),l.colspan>1&&(a+=l.colspan-1),o===n)break;if(o>n)throw new Error("The last column settings cannot overlap the other header layers")}return i}getLayersCount(){return us(uu,this)}getColumnsCount(){return us(uu,this)>0?us(Wo,this)[0].length:0}clear(){$d(Wo,this,[]),$d(uu,this,0)}}function hy(t,e,r){return(e=jce(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jce(t){var e=zce(t,"string");return typeof e=="symbol"?e:e+""}function zce(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sk="DF-pre-order";function ok(t,e){let r=t.call(e,this);for(let n=0;n<this.childs.length;n++){if(r===!1)return!1;r=ok.call(this.childs[n],t,e)}return r}const Yce="DF-post-order";function ak(t,e){for(let r=0;r<this.childs.length;r++)if(ak.call(this.childs[r],t,e)===!1)return!1;return t.call(e,this)}const lk="BF";function Gce(t,e){const r=[this];function n(){if(r.length===0)return;const i=r.shift();r.push(...i.childs),t.call(e,i)!==!1&&n()}n()}const Kce=lk,CO=new Map([[sk,ok],[Yce,ak],[lk,Gce]]);class hw{constructor(e){hy(this,"data",{}),hy(this,"parent",null),hy(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const r=new hw({...e.data});for(let n=0;n<e.childs.length;n++)r.addChild(this.cloneTree(e.childs[n]));return r}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let r=0;r<e.childs.length;r++)this.addChild(e.childs[r])}walkDown(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Kce;if(!CO.has(r))throw new Error(`Traversal strategy "${r}" does not exist`);CO.get(r).call(this,e,this)}walkUp(e){const r=this,n=i=>{e.call(r,i)!==!1&&i.parent!==null&&n(i.parent)};n(this)}}function dy(t,e,r){Xce(t,e),e.set(t,r)}function Xce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pn(t,e){return t.get(uk(t,e))}function qce(t,e,r){return t.set(uk(t,e),r),r}function uk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Lc=new WeakMap,cu=new WeakMap,$c=new WeakMap;class Zce{constructor(e){dy(this,Lc,new Map),dy(this,cu,new Map),dy(this,$c,null),qce($c,this,e)}getRoots(){return Array.from(Pn(Lc,this).values())}getRootByColumn(e){let r;return Pn(cu,this).has(e)&&(r=Pn(Lc,this).get(Pn(cu,this).get(e))),r}getNode(e,r){const n=this.getRootByColumn(r);if(!n)return;const i=r-Pn(cu,this).get(r);let s=0,o;return n.walkDown(a=>{const{data:{origColspan:l,headerLevel:u}}=a;if(e===u){if(i>=s&&i<=s+l-1)return o=a,o.data.isRoot=r===o.data.columnIndex,!1;s+=l}}),o}rebuildTreeIndex(){let e=0;Pn(cu,this).clear(),V(Pn(Lc,this),r=>{let[,{data:{colspan:n}}]=r;for(let i=e;i<e+n;i++)Pn(cu,this).set(i,e);e+=n})}buildTree(){this.clear();const e=Pn($c,this).getColumnsCount();let r=0;for(;r<e;){const n=Pn($c,this).getHeaderSettings(0,r),i=new hw;Pn(Lc,this).set(r,i),this.buildLeaves(i,r,0,n.origColspan),r+=n.origColspan}this.rebuildTreeIndex()}buildLeaves(e,r,n){let i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const s=Pn($c,this).getHeadersSettings(n,r,i);n+=1,V(s,o=>{const a={...o,headerLevel:n-1,columnIndex:r};let l;n===1?(e.data=a,l=e):(l=new hw(a),e.addChild(l)),n<Pn($c,this).getLayersCount()&&this.buildLeaves(l,r,n,o.origColspan),r+=o.origColspan})}clear(){Pn(Lc,this).clear(),Pn(cu,this).clear()}}function ck(t,e){t.walkDown(r=>{let{data:n,childs:i}=r;if(!n.isHidden&&(e(n.columnIndex),i.length===0))for(let s=1;s<n.colspan;s++)e(n.columnIndex+s)})}function dw(t,e){let{childs:r}=t;if(r.length!==0)return r[0].data[e]}function fw(t){return dw(t,"origColspan")===t.data.origColspan}function BE(t){const{data:e,childs:r}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fw(t))return BE(r[0]);e.isCollapsed=!1;const i=r.slice(1),s=new Set;let o=0;if(i.length>0)V(i,a=>{a.replaceTreeWith(a.data.clonedTree),a.data.clonedTree=null;const l=a.data;o+=l.colspan,ck(a,u=>{s.add(u)})});else{const{colspan:a,origColspan:l,columnIndex:u}=e;o=l-a;for(let c=1;c<l;c++)s.add(u+c)}return t.walkUp(a=>{const{data:l}=a;l.colspan+=o,l.colspan>=l.origColspan?(l.colspan=l.origColspan,l.isCollapsed=!1):fw(a)&&(l.isCollapsed=dw(a,"isCollapsed"))}),{rollbackModification:()=>VE(t),affectedColumns:Array.from(s),colspanCompensation:o}}function VE(t){var e;const{data:r,childs:n}=t;if(r.isCollapsed||r.isHidden||r.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fw(t))return VE(n[0]);r.isCollapsed=!0;const s=n.slice(1),o=new Set;if(s.length>0)V(s,l=>{ck(l,u=>{o.add(u)}),l.data.clonedTree=l.cloneTree(),l.walkDown(u=>{let{data:c}=u;c.isHidden=!0})});else{const{origColspan:l,columnIndex:u}=r;for(let c=1;c<l;c++){const h=u+c;o.add(h)}}const a=r.colspan-((e=dw(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(l=>{const{data:u}=l;u.colspan-=a,u.colspan<=1?(u.colspan=1,u.isCollapsed=!0):fw(l)&&(u.isCollapsed=dw(l,"isCollapsed"))}),{rollbackModification:()=>BE(t),affectedColumns:Array.from(o),colspanCompensation:a}}function Jce(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ft`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.push(e),s.colspan>1?s.colspan-=1:s.isHidden=!0})}function Qce(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ft`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:r}=t.data;if(!r.includes(e))return;let n=!1;t.walkUp(i=>{const{data:{collapsible:s}}=i;if(s)return n=!0,!1}),!n&&t.walkUp(i=>{const{data:s}=i;s.crossHiddenColumns.splice(s.crossHiddenColumns.indexOf(e),1),!s.isHidden&&s.colspan<s.origColspan&&(s.colspan+=1),s.isHidden=!1})}const SO=new Map([["collapse",VE],["expand",BE],["hide-column",Jce],["show-column",Qce]]);function ehe(t,e,r){if(!SO.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return SO.get(t)(e,r)}function Ap(t){const e=[];return V(t,r=>{r.walkDown(n=>{const i=n.data,{origColspan:s,columnIndex:o,headerLevel:a,crossHiddenColumns:l}=i,u=rhe(e,a);let c=!1;for(let h=o;h<o+s;h++)if(l.includes(h)||c)u.push(nk());else{const f=the(i);f.isRoot=!0,u.push(f),c=!0}})}),e}function the(t){const{crossHiddenColumns:e,...r}=Z1(t);return r}function rhe(t,e){let r;return Array.isArray(t[e])?r=t[e]:(r=[],t[e]=r),r}function fy(t,e,r){nhe(t,e),e.set(t,r)}function nhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bd(t,e,r){return t.set(hk(t,e),r),r}function pr(t,e){return t.get(hk(t,e))}function hk(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Js=new WeakMap,Kn=new WeakMap,hu=new WeakMap;class ihe{constructor(){fy(this,Js,new Uce),fy(this,Kn,new Zce(pr(Js,this))),fy(this,hu,[[]])}setState(e){pr(Js,this).setData(e);let r=!1;try{pr(Kn,this).buildTree()}catch{pr(Kn,this).clear(),pr(Js,this).clear(),r=!0}return Bd(hu,this,Ap(pr(Kn,this).getRoots())),r}setColumnsLimit(e){pr(Js,this).setColumnsLimit(e)}mergeStateWith(e){const r=St(e,n=>{let{row:i,...s}=n;return{row:i<0?this.rowCoordsToLevel(i):i,...s}});pr(Js,this).mergeWith(r),pr(Kn,this).buildTree(),Bd(hu,this,Ap(pr(Kn,this).getRoots()))}mapState(e){pr(Js,this).map(e),pr(Kn,this).buildTree(),Bd(hu,this,Ap(pr(Kn,this).getRoots()))}mapNodes(e){return Hr(pr(Kn,this).getRoots(),(r,n)=>(n.walkDown(i=>{const s=e(i.data);s!==void 0&&r.push(s)}),r),[])}triggerNodeModification(e,r,n){r<0&&(r=this.rowCoordsToLevel(r));const i=pr(Kn,this).getNode(r,n);let s;return i&&(s=ehe(e,i,n),Bd(hu,this,Ap(pr(Kn,this).getRoots()))),s}triggerColumnModification(e,r){return this.triggerNodeModification(e,-1,r)}rowCoordsToLevel(e){if(e>=0)return null;const r=e+Math.max(this.getLayersCount(),1);return r<0?null:r}levelToRowCoords(e){if(e<0)return null;const r=e-Math.max(this.getLayersCount(),1);return r>=0?null:r}getHeaderSettings(e,r){var n,i;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(n=(i=pr(hu,this)[e])===null||i===void 0?void 0:i[r])!==null&&n!==void 0?n:null}getHeaderTreeNodeData(e,r){const n=this.getHeaderTreeNode(e,r);return n?{...n.data}:null}getHeaderTreeNode(e,r){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const n=pr(Kn,this).getNode(e,r);return n||null}findTopMostEntireHeaderLevel(e){var r;let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let s=!1,o=null;for(let a=e;a<=n;a++){const l=pr(Kn,this).getRootByColumn(a);if(!l)break;s=!0,l.walkDown(u=>{const{columnIndex:c,headerLevel:h,origColspan:d,isHidden:f}=u.data;f||d<=i&&c>=e&&c+d-1<=n&&(o===null||h<o)&&(o=h)},sk)}return s&&o===null?-1:this.levelToRowCoords((r=o)!==null&&r!==void 0?r:0)}findLeftMostColumnIndex(e,r){var n;const{isRoot:i}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0};if(i)return r;let s=r-1;for(;s>=0;){var o;const{isRoot:a}=(o=this.getHeaderSettings(e,s))!==null&&o!==void 0?o:{isRoot:!0};if(a)break;s-=1}return s}findRightMostColumnIndex(e,r){var n;const{isRoot:i,origColspan:s}=(n=this.getHeaderSettings(e,r))!==null&&n!==void 0?n:{isRoot:!0,origColspan:1};if(i)return r+s-1;let o=r+1;for(;o<this.getColumnsCount();){var a;const{isRoot:l}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(l)break;o+=1}return o-1}getLayersCount(){return pr(Js,this).getLayersCount()}getColumnsCount(){return pr(Js,this).getColumnsCount()}clear(){Bd(hu,this,[]),pr(Js,this).clear(),pr(Kn,this).clear()}}function Vd(t,e,r){return(e=she(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function she(t){var e=ohe(t,"string");return typeof e=="symbol"?e:e+""}function ohe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ahe{constructor(e,r){Vd(this,"hot",void 0),Vd(this,"nestedHeaderSettingsGetter",void 0),Vd(this,"layersCount",0),Vd(this,"container",void 0),Vd(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=r,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const e=this.container.querySelectorAll("tr:last-of-type th"),r=e.length;this.widthsMap.clear();for(let n=0;n<r;n++){const i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(n),s=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(s,e[n].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:r,columnIndexMapper:n}=this.hot,i=r.createDocumentFragment(),s=r.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,a=n.getRenderableIndexesLength();for(let l=0;l<this.layersCount;l++){const u=r.createElement("tr");for(let c=0;c<a;c++){let h=n.getVisualFromRenderableIndex(c);h===null&&(h=c);const d=r.createElement("th"),f=this.nestedHeaderSettingsGetter(l,h);if(f&&(!f.isPlaceholder||f.isHidden)){let m=f.label;o&&(m+='<button class="changeType"></button>'),Xu(d,m),d.colSpan=f.colspan,u.appendChild(d)}}s.appendChild(u)}i.appendChild(s),e.appendChild(i)}clear(){this.widthsMap.clear(),this.container=null}}function lhe(t,e){dk(t,e),e.add(t)}function yO(t,e,r){return(e=uhe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function uhe(t){var e=che(t,"string");return typeof e=="symbol"?e:e+""}function che(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mp(t,e,r){dk(t,e),e.set(t,r)}function dk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Eu(t,e,r){return t.set(wr(t,e),r),r}function Rt(t,e){return t.get(wr(t,e))}function wr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const bO="nestedHeaders",hhe=280;var Wt=new WeakMap,$a=new WeakMap,xf=new WeakMap,Hv=new WeakMap,Rr=new WeakSet;class dhe extends At{constructor(){super(...arguments),lhe(this,Rr),Mp(this,Wt,new ihe),Mp(this,$a,null),Mp(this,xf,null),Mp(this,Hv,!1),yO(this,"ghostTable",new ahe(this.hot,(e,r)=>this.getHeaderSettings(e,r))),yO(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return bO}static get PLUGIN_PRIORITY(){return hhe}isEnabled(){return!!this.hot.getSettings()[bO]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:r}=this.hot.getSettings();(!Array.isArray(r)||!Array.isArray(r[0]))&&kt(Ft`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>wr(Rr,this,Ahe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,Mhe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,phe).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,whe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,vhe).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,Che).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,She).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,yhe).call(e,...i)}),this.addHook("afterSelection",()=>wr(Rr,this,Op).call(this)),this.addHook("afterSelectionFocusSet",()=>wr(Rr,this,Op).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,fhe).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",n=>wr(Rr,this,xhe).call(this,n)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,Ehe).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,The).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,ghe).call(e,...i)}),this.addHook("beforeCopy",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,mhe).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,bhe).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,Rhe).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return wr(Rr,e,_he).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>wr(Rr,this,Op).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>wr(Rr,this,Op).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();Rt(Wt,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=Rt(Wt,this).setState(e)),this.detectedOverlappedHeaders&&kt(Ft`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((r,n)=>{const i=r===!0?"hide-column":"show-column";Rt(Wt,this).triggerColumnModification(i,n)}),!Rt($a,this)&&this.enabled&&Eu($a,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(r=>{r.forEach(n=>{let{op:i,index:s,newValue:o}=n;if(i==="replace"){const a=o===!0?"hide-column":"show-column";Rt(Wt,this).triggerColumnModification(a,s)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),Rt(Wt,this).clear(),Rt($a,this).unsubscribe(),Eu($a,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return Rt(Wt,this)}getLayersCount(){return Rt(Wt,this).getLayersCount()}getHeaderSettings(e,r){return Rt(Wt,this).getHeaderSettings(e,r)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,r=e.getSetting("columnHeaders").length,n=e.wtTable.THEAD,i=e.wtOverlays.topOverlay.clone.wtTable.THEAD,s=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let o=0;o<r;o++){const a=n.childNodes[o];if(!a)break;const l=i.childNodes[o],u=s?s.childNodes[o]:null;for(let c=0,h=a.childNodes.length;c<h;c++)a.childNodes[c].removeAttribute("colspan"),tt(a.childNodes[c],"hiddenHeader"),l&&l.childNodes[c]&&(l.childNodes[c].removeAttribute("colspan"),tt(l.childNodes[c],"hiddenHeader")),s&&u&&u.childNodes[c]&&(u.childNodes[c].removeAttribute("colspan"),tt(u.childNodes[c],"hiddenHeader"))}}headerRendererFactory(e){var r=this;const n=this.hot.view._wt.getSetting("fixedColumnsStart");return(i,s)=>{var o;const{columnIndexMapper:a,view:l}=this.hot;let u=a.getVisualFromRenderableIndex(i);u===null&&(u=i),s.removeAttribute("colspan"),tt(s,"hiddenHeader");const{colspan:c,isHidden:h,isPlaceholder:d,headerClassNames:f}=(o=Rt(Wt,this).getHeaderSettings(e,u))!==null&&o!==void 0?o:{label:""};if(d||h)ve(s,"hiddenHeader");else if(c>1){var m,g;const{wtOverlays:w}=l._wt,S=(m=w.topInlineStartCornerOverlay)===null||m===void 0?void 0:m.clone.wtTable.THEAD.contains(s),b=(g=w.inlineStartOverlay)===null||g===void 0?void 0:g.clone.wtTable.THEAD.contains(s),y=S||b?Math.min(c,n-i):c;y>1&&s.setAttribute("colspan",y)}if(this.hot.view.appendColHeader(u,s,function(){return r.getColumnHeaderValue(...arguments)},e),!d&&!h){const w=s.querySelector("div.relative");w&&f&&f.length>0&&(tt(w,this.hot.getColumnMeta(u).headerClassName),ve(w,f))}}}getColumnHeaderValue(e,r){var n;const{isHidden:i,isPlaceholder:s}=(n=Rt(Wt,this).getHeaderSettings(r,e))!==null&&n!==void 0?n:{};return s||i?"":this.hot.getColHeader(e,r)}destroy(){Eu(Wt,this,null),Rt($a,this)!==null&&(Rt($a,this).unsubscribe(),Eu($a,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return Rt(Wt,this).getHeaderTreeNodeData(e.row,e.col)}}function Op(){var t;const e=(t=this.hot)===null||t===void 0?void 0:t.getSelectedRangeLast();if(!e)return;const{highlight:r}=e;if(r.isHeader()&&r.col>=0){const i=Rt(Wt,this).findLeftMostColumnIndex(r.row,r.col),s=this.hot.selection.highlight.getFocus();s.visualCellRange.highlight.col=i,s.visualCellRange.from.col=i,s.visualCellRange.to.col=i,s.commit()}}function fhe(t){const e=this.hot.getSelectedRangeLast();if(!e)return t;const{highlight:r}=e;if(!(r.isHeader()&&r.col>=0))return t;const i=this.hot.view.getFirstFullyVisibleColumn(),s=this.hot.view.getLastFullyVisibleColumn(),o=Rt(Wt,this).findLeftMostColumnIndex(r.row,r.col),a=Rt(Wt,this).findRightMostColumnIndex(r.row,r.col);return o<i&&a>s?t:o<i?o:a}function ghe(t,e,r){const n=Rt(Wt,this).getHeaderTreeNodeData(e,t);if(!n)return t;const{columnCursor:i,selectionType:s,selectionWidth:o}=r,{isRoot:a,colspan:l}=Rt(Wt,this).getHeaderSettings(e,t);if(s===xx){if(!a)return n.columnIndex}else if(s===AD&&(l>o-i||!a))return null;return t}function mhe(t,e,r){let{columnHeadersCount:n}=r;if(n!==0)for(let s=0;s<e.length;s++){const{startRow:o,startCol:a,endRow:l,endCol:u}=e[s],c=l-o+1,h=a-u+1;if(o>=0||h===1)break;for(let d=a;d<=u;d++)for(let f=o;f<=l;f++){var i;const m=c+f,g=d-a;if(g===0)continue;((i=Rt(Wt,this).getHeaderTreeNodeData(f,d))===null||i===void 0?void 0:i.isRoot)===!1&&(t[m][g]="")}}}function phe(t,e,r,n){this._getHeaderTreeNodeDataByCoords(e)&&(n.column=!0)}function whe(t,e){const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;Eu(xf,this,e.clone()),Eu(Hv,this,!0);const{selection:n}=this.hot,i=n.isSelected()?n.getSelectedRange().current():null,s=[],{columnIndex:o,origColspan:a}=r,l=!n.inInSelection(e);t.shiftKey&&i?e.col<i.from.col?s.push(i.getTopEndCorner().col,o,e.row):e.col>i.from.col?s.push(i.getTopStartCorner().col,o+a-1,e.row):s.push(o,o+a-1,e.row):(av(t)||ml(t)&&l||QN(t))&&s.push(o,o+a-1,e.row),n.selectColumns(...s)}function vhe(t,e,r,n){if(!this.hot.view.isMouseDown())return;const i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;const{columnIndex:s,origColspan:o}=i,a=this.hot.getSelectedRangeLast(),l=a.getTopStartCorner(),u=a.getBottomEndCorner(),{from:c}=a;n.column=!0,n.cell=!0;const h=[],d=Ht(e.row,-1/0,-1);e.col<c.col?h.push(u.col,s,d):e.col>c.col?h.push(l.col,s+o-1,d):h.push(s,s+o-1,d),this.hot.selection.selectColumns(...h)}function Che(){Eu(Hv,this,!1)}function She(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!Rt(Hv,this)||!t)return;const e=this.hot.getSelectedRangeLast(),r=e.getTopStartCorner().col,n=e.getBottomEndCorner().col,{columnIndex:i,origColspan:s}=Rt(Wt,this).getHeaderTreeNodeData(Rt(xf,this).row,Rt(xf,this).col);if(e.setHighlight(Rt(xf,this)),s>e.getWidth()||i<r||i+s-1>n){const o=Rt(Wt,this).findTopMostEntireHeaderLevel(Ht(r,i,i+s-1),Ht(n,i,i+s-1));e.highlight.row=o,e.highlight.col=e.from.col}}function yhe(t){const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(r.isHeader()&&r.col>=0))return;const i=Rt(Wt,this).findLeftMostColumnIndex(r.row,r.col),s=Rt(Wt,this).findRightMostColumnIndex(r.row,r.col);if(t.col<0){const o=e.col>=i&&e.col<=s?i-1:s,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,-1);a===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(a,e.col)-1,1)}else if(t.col>0){const o=e.col>=i&&e.col<=s?s+1:i,a=this.hot.columnIndexMapper.getNearestNotHiddenIndex(o,1);a===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,a)-1,1)}}function bhe(t,e){const r=t.row,n=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),i=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),i&&(e.col=i.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),i&&(e.col=i.columnIndex+i.origColspan-1))}function xhe(t){t.length=0;for(let e=0;e<Rt(Wt,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}function Rhe(t){const e=Rt(Wt,this).getLayersCount();let r=t.startColumn,n=!!e;for(let i=0;i<e;i++){const s=Rt(Wt,this).findLeftMostColumnIndex(i,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(s);if(s>=0&&(n=!1),xn(o)&&o<t.startColumn){r=o;break}}t.startColumn=n?Rt(Wt,this).getHeaderTreeNodeData(0,r).columnIndex:r}function Ehe(t,e){const r=this.ghostTable.getWidth(e);return t>r?t:r}function The(t,e,r){var n;const{label:i}=(n=Rt(Wt,this).getHeaderTreeNodeData(r,e))!==null&&n!==void 0?n:{label:""};return i}function _he(t,e){if(t<0)return this.hot.getCell(t,Rt(Wt,this).findLeftMostColumnIndex(t,e),!0)}function Ahe(){this.updatePlugin()}function Mhe(t,e){e||this.updatePlugin()}function Wd(t,e,r){return(e=Ohe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ohe(t){var e=Ihe(t,"string");return typeof e=="symbol"?e:e+""}function Ihe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Phe{constructor(e,r){Wd(this,"hot",void 0),Wd(this,"data",null),Wd(this,"plugin",void 0),Wd(this,"parentReference",new WeakMap),Wd(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=r,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},Ue(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,r,n){this.cache.levels[r]||(this.cache.levels[r]=[],this.cache.levelCount+=1),this.cache.levels[r].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:n,row:this.cache.rows.length-1,level:r}),this.hasChildren(e)&&V(e.__children,i=>{this.cacheNode(i,r+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,r,n,i){let s=!1,o=r;if(isNaN(o)&&o.end)return o;let a=e;return a||(a={__children:this.data},s=!0,o-=1),n!=null&&o===n?{result:a,end:!0}:i!=null&&a===i?{result:o,end:!0}:(o+=1,a.__children&&V(a.__children,l=>{if(this.parentReference.set(l,s?null:a),o=this.readTreeNodes(l,o,n,i),isNaN(o)&&o.end)return!1}),o)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return ct(this.data[0],(r,n)=>{e[n]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let r=null;isNaN(e)?r=e:r=this.getDataObject(e);const n=this.getRowParent(e);return n==null?this.data.indexOf(r):n.__children.indexOf(r)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let r=0,n=e;return isNaN(n)||(n=this.getDataObject(n)),!n||!n.__children?0:(V(n.__children,i=>{r+=1,i.__children&&(r+=this.countChildren(i))}),r)}getRowParent(e){let r;return isNaN(e)?r=e:r=this.getDataObject(e),this.getRowObjectParent(r)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let r=null;return isNaN(e)?r=e:r=this.getDataObject(e),r?this.getRowObjectLevel(r):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let r=e;return isNaN(r)||(r=this.getDataObject(r)),!!(r.__children&&r.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,r){var n;return((n=e.__children)===null||n===void 0?void 0:n[r])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var r;let n=e;return isNaN(n)||(n=this.getDataObject(n)),n&&!!n.__children&&((r=n.__children)===null||r===void 0?void 0:r.length)!==0}addChild(e,r){let n=r;this.hot.runHooks("beforeAddChild",e,n);let i=null;e&&(i=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",i+this.countChildren(e)+1,1);let s=e;e||(s=this.mockParent()),s.__children||(s.__children=[]),n||(n=this.mockNode()),s.__children.push(n),this.rewriteCache();const o=this.getRowIndex(n);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,n)}addChildAtIndex(e,r,n){let i=n,s;if(i||(i=this.mockNode()),this.hot.runHooks("beforeAddChild",e,i,r),e){const a=this.getRowIndex(e)+r+1;this.hot.runHooks("beforeCreateRow",a,1),e.__children.splice(r,null,i),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(a,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",a,1),s=a}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",r,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),s=this.getRowIndex(this.data[r]);i=this.getDataObject(s),this.hot.runHooks("afterAddChild",e,i,r)}addSibling(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const n=this.translateTrimmedRow(e),i=this.getRowParent(n),s=this.getRowIndexWithinParent(n);switch(r){case"below":this.addChildAtIndex(i,s+1,null);break;case"above":this.addChildAtIndex(i,s,null);break}}detachFromParent(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=null;const i=[];Array.isArray(e)?(Ue(e[0],e[2],d=>{const f=this.translateTrimmedRow(d);i.push(this.getDataObject(f))}),Ue(0,i.length-2,d=>{this.detachFromParent(i[d],!1)}),n=i[i.length-1]):n=e;const s=this.getRowIndex(n),o=this.countChildren(n),a=this.getRowIndexWithinParent(n),l=this.getRowParent(n),u=this.getRowParent(l),c=this.getRowIndex(u);let h=null;if(this.hot.runHooks("beforeDetachChild",l,n),a!=null){const d=Array.from(new Array(s+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",s,o+1,d,this.plugin.pluginName),l.__children.splice(a,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",s,o+1,d,this.plugin.pluginName),u){h=c+this.countChildren(u);const f=this.getChild(u,this.countChildren(u)-1),m=this.getRowIndex(f);this.hot.runHooks("beforeCreateRow",m+1,o+1,this.plugin.pluginName),u.__children.push(n)}else h=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",h-2,o+1,this.plugin.pluginName),this.data.push(n)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",h-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,n,this.getRowIndex(n)),r&&this.hot.render()}filterData(e,r,n){const i=[];V(n,s=>{i.push(this.getDataObject(s))}),V(i,s=>{const o=this.getRowIndexWithinParent(s),a=this.getRowParent(s);a===null?this.data.splice(o,1):a.__children.splice(o,1)}),this.rewriteCache()}spliceData(e,r,n){const i=this.getDataObject(e-1);let s=null,o=e;i&&i.__children&&i.__children.length===0?(s=i,o=0):e<this.countAllRows()&&(s=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),s?n?s.__children.splice(o,r,...n):s.__children.splice(o,r):n?this.data.splice(o,r,...n):this.data.splice(o,r),this.rewriteCache()}syncRowWithRawSource(e){let r=e,n=null;do n=this.getRowParent(n),n!==null&&(r=n);while(n!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndex(r),"__children",r.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,r,n,i){const s=r===this.hot.countRows(),o=this.getRowParent(e),a=this.getRowIndexWithinParent(e),l=o.__children.slice(a,a+1),u=e>r;let c=s?this.getRowParent(r-1):this.getRowParent(r);c==null&&(c=this.getRowParent(r-1)),c==null&&(c=this.getDataObject(r-1)),c?c.__children||(c.__children=[]):(c=this.getDataObject(r),c.__children=[]);const h=s||n||i?c.__children.length:this.getRowIndexWithinParent(r),d=o===c;c.__children.splice(h,0,l[0]),o.__children.splice(a+(u&&d?1:0),1),this.syncRowWithRawSource(o),d||this.syncRowWithRawSource(c)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function xO(t,e,r){return(e=Nhe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nhe(t){var e=Dhe(t,"string");return typeof e=="symbol"?e:e+""}function Dhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WE{constructor(e,r){xO(this,"hot",void 0),xO(this,"plugin",void 0),this.hot=r,this.plugin=e}}class lo extends WE{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,r){super(e,r),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,r){const n=this.hot.toPhysicalRow(e),i=this.dataManager.getRowLevel(n),s=this.dataManager.getDataObject(n),o=r.getElementsByTagName("DIV")[0],a=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),u=this.hot.getSettings().ariaTags;if(V(l,c=>{c&&o.removeChild(c)}),ve(r,lo.CSS_CLASSES.indicatorContainer),i){const{rootDocument:c}=this.hot,h=a.cloneNode(!0);o.innerHTML="",Ue(0,i-1,()=>{const d=c.createElement("SPAN");ve(d,lo.CSS_CLASSES.emptyIndicator),o.appendChild(d)}),o.appendChild(h)}if(this.dataManager.hasChildren(s)){const c=this.hot.rootDocument.createElement("DIV");u&&qe(c,[Gu()]),ve(r,lo.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(n)?(ve(c,`${lo.CSS_CLASSES.button} ${lo.CSS_CLASSES.expandButton}`),u&&qe(r,[Yi(!1)])):(ve(c,`${lo.CSS_CLASSES.button} ${lo.CSS_CLASSES.collapseButton}`),u&&qe(r,[Yi(!0)])),o.appendChild(c)}}updateRowHeaderWidth(e){let r=e;r||(r=this.dataManager.cache.levelCount),this.rowHeaderWidthCache=Math.max(50,11+10*r+25),this.hot.render()}}class Hhe extends WE{constructor(e,r){var n;super(e,r),n=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;n.lastCollapsedRows=n.collapsedRows.slice(0),n.expandMultipleChildren(n.lastCollapsedRows,i)},shiftStash:function(i,s){let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;s==null&&(s=1/0),V(n.lastCollapsedRows,(a,l)=>{a>=i&&a<s&&(n.lastCollapsedRows[l]=a+o)})},applyStash:function(){let i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;n.collapseMultipleChildren(n.lastCollapsedRows,i),n.lastCollapsedRows=void 0},trimStash:(i,s)=>{Ue(i,i+s-1,o=>{const a=this.lastCollapsedRows.indexOf(o);a>-1&&this.lastCollapsedRows.splice(a,1)})}}}collapseChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(s)):(s=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(s)&&V(s.__children,l=>{i.push(this.dataManager.getRowIndex(l))}),a=this.collapseRows(i,!0,!1),n&&this.trimRows(a),r&&this.renderAndAdjust(),this.collapsedRows.indexOf(o)===-1&&this.collapsedRows.push(o),a}collapseMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];V(e,s=>{i.push(...this.collapseChildren(s,!1,!1))}),n&&this.trimRows(i),r&&this.renderAndAdjust()}collapseRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],r)}collapseRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return V(e,s=>{i.push(s),r&&this.collapseChildRows(s,i)}),n&&this.trimRows(i),i}collapseChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);V(i.__children,s=>{const o=this.dataManager.getRowIndex(s);r.push(o),this.collapseChildRows(o,r)})}n&&this.trimRows(r)}expandRow(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],r)}expandRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const i=[];return V(e,s=>{i.push(s),r&&this.expandChildRows(s,i)}),n&&this.untrimRows(i),i}expandChildRows(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const i=this.dataManager.getDataObject(e);V(i.__children,s=>{if(!this.isAnyParentCollapsed(s)){const o=this.dataManager.getRowIndex(s);r.push(o),this.expandChildRows(o,r)}})}n&&this.untrimRows(r)}expandChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];let s=null,o=null,a=null;return isNaN(e)?(s=e,o=this.dataManager.getRowIndex(e)):(s=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(s)&&V(s.__children,l=>{const u=this.dataManager.getRowIndex(l);i.push(u)}),a=this.expandRows(i,!0,!1),n&&this.untrimRows(a),r&&this.renderAndAdjust(),a}expandMultipleChildren(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=[];V(e,s=>{i.push(...this.expandChildren(s,!1,!1))}),n&&this.untrimRows(i),r&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),r=[];V(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.collapseMultipleChildren(r),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),r=[];V(e,n=>{this.dataManager.hasChildren(n)&&r.push(n)}),this.expandMultipleChildren(r),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{V(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{V(e,r=>{this.plugin.collapsedRowsMap.setValueAtIndex(r,!1)})},!0)}areChildrenCollapsed(e){let r=isNaN(e)?e:this.dataManager.getDataObject(e),n=!0;return r===null&&(r={__children:this.dataManager.data}),this.dataManager.hasChildren(r)&&V(r.__children,i=>{const s=this.dataManager.getRowIndex(i);if(!this.plugin.collapsedRowsMap.getValueAtIndex(s))return n=!1,!1}),n}isAnyParentCollapsed(e){let r=e;for(;r!==null;){r=this.dataManager.getRowParent(r);const n=this.dataManager.getRowIndex(r);if(this.collapsedRows.indexOf(n)>-1)return!0}return!1}toggleState(e,r){if(r.col>=0)return;const n=this.translateTrimmedRow(r.row);Qe(e.target,lo.CSS_CLASSES.button)&&(this.areChildrenCollapsed(n)?this.expandChildren(n):this.collapseChildren(n),Ji(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}function khe(t,e,r){Fhe(t,e),e.set(t,r)}function Fhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lhe(t,e,r){return(e=$he(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function $he(t){var e=Bhe(t,"string");return typeof e=="symbol"?e:e+""}function Bhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Vhe(t,e){return t.get(Whe(t,e))}function Whe(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var RO=new WeakMap;class Uhe extends WE{constructor(){super(...arguments),Lhe(this,"dataManager",this.plugin.dataManager),khe(this,RO,{row_above:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"above")},row_below:(e,r)=>{const n=r[r.length-1];this.dataManager.addSibling(n.start.row,"below")}})}appendOptions(e){const r=[{key:"add_child",name(){return this.getTranslatedPhrase(vR)},callback:()=>{const n=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),i=this.dataManager.getDataObject(n);this.dataManager.addChild(i)},disabled:()=>{const n=this.hot.getSelectedLast();return!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(CR)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{const n=this.hot.getSelectedLast(),i=this.dataManager.translateTrimmedRow(n[0]);return!this.dataManager.getRowParent(i)||!n||n[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return Ue(0,e.items.length-1,n=>{if(n===0)return V(r,(i,s)=>{e.items.splice(n+s,0,i)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return Ue(0,e.items.length-1,r=>{const n=Vhe(RO,this)[e.items[r].key];n!=null&&(e.items[r].callback=n)}),e}}function Ip(t,e,r){return(e=jhe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jhe(t){var e=zhe(t,"string");return typeof e=="symbol"?e:e+""}function zhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yhe{constructor(e){Ip(this,"plugin",void 0),Ip(this,"hot",void 0),Ip(this,"dataManager",void 0),Ip(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,r,n,i){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:r,dropIndex:n,movePossible:i}))return!1;this.movedToCollapsed=!1;const o=n===this.hot.countRows(),a=o?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(n);let l=!0;const u=e.map(m=>{if(!l)return!1;const g=this.dataManager.translateTrimmedRow(m);return l=this.shouldAllowMoving(g,a),g}),c=u.indexOf(a)===-1;if(!l||!c)return!1;const h=this.getBaseParent(u),d=this.getTargetParent(o,a),f=h===d;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(d),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(u,a,f),this.moveRows(u,a,d),this.dataManager.rewriteCache(),this.moveCellsMeta(u,a),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,r,n,i,i&&this.isRowOrderChanged(e,r)),this.hot.render(),this.selectCells(e,n),!1}displayAPICompatibilityWarning(e){const{rows:r,finalIndex:n,dropIndex:i,movePossible:s}=e;let o=!1;return er(i)&&(kt(Ft`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",r,n,i,s,!1),o=!0),o}shouldAllowMoving(e,r){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===r||r===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,r){let n=this.dataManager.getRowParent(e?r-1:r);return n==null&&(n=this.dataManager.getRowParent(r-1)),n}shiftCollapsibleParentsLocations(e,r,n){n||(Math.max(...e)<=r?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],r,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(r,e[0],e.length))}moveRows(e,r,n){const i=r===this.dataManager.getRowIndex(n)+this.dataManager.countChildren(n)+1;this.hot.batchRender(()=>{e.forEach(s=>{this.dataManager.moveRow(s,r,this.movedToCollapsed,i)})})}moveCellsMeta(e,r){const n=[],i=Math.max(...e)<r;e.forEach(s=>{n.push(this.hot.getCellMetaAtRow(s))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(r-(i?n.length:0),0,...n)}selectCells(e,r){const n=e.length;let i=0,s=0,o=null,a=null;if(this.movedToCollapsed){let l=null;e[n-1]<r?l=this.dataManager.translateTrimmedRow(r-n):l=this.dataManager.translateTrimmedRow(r);const u=this.dataManager.getRowParent(l===null?this.hot.countSourceRows()-1:l-1),c=this.dataManager.getRowIndex(u);i=this.dataManager.untranslateTrimmedRow(c),s=i}else e[n-1]<r?(s=r-1,i=s-n+1):(i=r,s=i+n-1);o=this.hot.selection,a=this.hot.countCols()-1,o.setRangeStart(this.hot._createCellCoords(i,0)),o.setRangeEnd(this.hot._createCellCoords(s,a),!0)}isRowOrderChanged(e,r){return e.some((n,i)=>n-i!==r)}}function Ghe(t,e){fk(t,e),e.add(t)}function EO(t,e,r){fk(t,e),e.set(t,r)}function fk(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gy(t,e,r){return(e=Khe(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Khe(t){var e=Xhe(t,"string");return typeof e=="symbol"?e:e+""}function Xhe(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function d0(t,e){return t.get(Yr(t,e))}function gw(t,e,r){return t.set(Yr(t,e),r),r}function Yr(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const mw="nestedRows",qhe=300,TO=mw,Zhe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var kv=new WeakMap,Bc=new WeakMap,Qr=new WeakSet;class Jhe extends At{constructor(){super(...arguments),Ghe(this,Qr),gy(this,"dataManager",null),gy(this,"headersUI",null),gy(this,"collapsedRowsMap",null),EO(this,kv,!1),EO(this,Bc,!1)}static get PLUGIN_KEY(){return mw}static get PLUGIN_PRIORITY(){return qhe}isEnabled(){return!!this.hot.getSettings()[mw]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Tg),this.dataManager=new Phe(this,this.hot),this.collapsingUI=new Hhe(this,this.hot),this.headersUI=new lo(this,this.hot),this.contextMenuUI=new Uhe(this,this.hot),this.rowMoveController=new Yhe(this),this.addHook("afterInit",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,dde).call(e,...n)}),this.addHook("beforeViewRender",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,fde).call(e,...n)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,tde).call(e,...n)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,rde).call(e,...n)}),this.addHook("afterGetRowHeader",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,nde).call(e,...n)}),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,ede).call(e,...n)}),this.addHook("beforeRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,ode).call(e,...n)}),this.addHook("afterRemoveRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,sde).call(e,...n)}),this.addHook("beforeAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,ade).call(e,...n)}),this.addHook("afterAddChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,lde).call(e,...n)}),this.addHook("beforeDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,ude).call(e,...n)}),this.addHook("afterDetachChild",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,cde).call(e,...n)}),this.addHook("modifyRowHeaderWidth",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,ide).call(e,...n)}),this.addHook("afterCreateRow",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,hde).call(e,...n)}),this.addHook("beforeRowMove",function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];return Yr(Qr,e,Qhe).call(e,...n)}),this.addHook("beforeLoadData",r=>Yr(Qr,this,_O).call(this,r)),this.addHook("beforeUpdateData",r=>Yr(Qr,this,_O).call(this,r)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeLast(),r=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(r)?this.collapsingUI.expandChildren(r):this.collapsingUI.collapseChildren(r),!1},runOnlyIf:()=>{var e,r;const n=(e=this.hot.getSelectedRangeLast())===null||e===void 0?void 0:e.highlight;return n&&((r=this.hot.getSelectedRangeLast())===null||r===void 0?void 0:r.isSingle())&&this.hot.selection.isCellVisible(n)&&n.col===-1&&n.row>=0},group:TO,relativeToGroup:Rl,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(TO)}disableCoreAPIModifiers(){gw(Bc,this,!0)}enableCoreAPIModifiers(){gw(Bc,this,!1)}onModifyRowData(e){if(!d0(Bc,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!d0(Bc,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,r,n){return d0(Bc,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,r,n),!1)}destroy(){super.destroy()}}function Qhe(t,e,r,n){return this.rowMoveController.onBeforeRowMove(t,e,r,n)}function ede(t,e,r){this.collapsingUI.toggleState(t,e,r)}function tde(t,e,r){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(r[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(r[0],null,-1*e),this.dataManager.filterData(t,e,r),gw(kv,this,!0),this.dataManager.getData().slice()}function rde(t){return this.contextMenuUI.appendOptions(t)}function nde(t,e){this.headersUI.appendLevelIndicators(t,e)}function ide(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function sde(t,e,r,n){n!==this.pluginName&&this.hot._registerTimeout(()=>{gw(kv,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function ode(t,e,r){const n=Array.from(r.reduce((i,s)=>{if(this.dataManager.isParent(s)){const o=this.dataManager.getDataObject(s).__children;return i.add(s),Array.isArray(o)&&o.forEach(a=>i.add(this.dataManager.getRowIndex(a))),i}return i.add(s)},new Set));r.length=0,r.push(...n)}function ade(){this.collapsingUI.collapsedRowsStash.stash()}function lde(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function ude(){this.collapsingUI.collapsedRowsStash.stash()}function cde(t,e,r){this.collapsingUI.collapsedRowsStash.shiftStash(r,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function hde(){this.dataManager.rewriteCache()}function dde(){this.headersUI.updateRowHeaderWidth()}function fde(t,e){d0(kv,this)&&(e.skipRender=!0)}function _O(t){if(!FD(t)){ux(Zhe),this.hot.getSettings()[mw]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function my(t,e,r){return(e=gde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function gde(t){var e=mde(t,"string");return typeof e=="symbol"?e:e+""}function mde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class pde{constructor(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;my(this,"rootWindow",void 0),my(this,"prefix",void 0),my(this,"savedKeys",[]),this.rootWindow=r,this.prefix=e,this.loadSavedKeys()}saveValue(e,r){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(r)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,r){const n=typeof e>"u"?r:e,i=this.rootWindow.localStorage.getItem(`${this.prefix}_${n}`);return i===null?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){V(this.savedKeys,(e,r)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[r]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),r=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=r||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function wde(t,e,r){return(e=vde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function vde(t){var e=Cde(t,"string");return typeof e=="symbol"?e:e+""}function Cde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}He.getSingleton().register("persistentStateSave");He.getSingleton().register("persistentStateLoad");He.getSingleton().register("persistentStateReset");const AO="persistentState",Sde=0;class yde extends At{constructor(){super(...arguments),wde(this,"storage",void 0)}static get PLUGIN_KEY(){return AO}static get PLUGIN_PRIORITY(){return Sde}isEnabled(){return!!this.hot.getSettings()[AO]}enablePlugin(){this.enabled||(this.storage||(this.storage=new pde(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,r)=>this.saveValue(e,r)),this.addHook("persistentStateLoad",(e,r)=>this.loadValue(e,r)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,r){r.value=this.storage.loadValue(e)}saveValue(e,r){this.storage.saveValue(e,r)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function bde(t,e){xde(t,e),e.add(t)}function xde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function py(t,e,r){return(e=Rde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Rde(t){var e=Ede(t,"string");return typeof e=="symbol"?e:e+""}function Ede(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function MO(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const wy="search",Tde=190,_de="htSearchResult",Ade=function(t,e,r,n,i){t.getCellMeta(e,r).isSearchResult=i},Mde=function(t,e,r){return er(t)||t===null||!t.toLocaleLowerCase||t.length===0||er(e)||e===null?!1:e.toString().toLocaleLowerCase(r.locale).indexOf(t.toLocaleLowerCase(r.locale))!==-1};var vy=new WeakSet;class Ode extends At{constructor(){super(...arguments),bde(this,vy),py(this,"callback",Ade),py(this,"queryMethod",Mde),py(this,"searchResultClass",_de)}static get PLUGIN_KEY(){return wy}static get PLUGIN_PRIORITY(){return Tde}isEnabled(){return this.hot.getSettings()[wy]}enablePlugin(){var e=this;if(this.enabled)return;const r=this.hot.getSettings()[wy];this.updatePluginSettings(r),this.addHook("beforeRenderer",function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return MO(vy,e,OO).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;const r=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return MO(vy,e,OO).call(e,...i)};this.hot.addHook("beforeRenderer",r),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",r)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const i=this.hot.countRows(),s=this.hot.countCols(),o=[],a=this.hot;return Ue(0,i-1,l=>{Ue(0,s-1,u=>{const c=this.hot.getDataAtCell(l,u),h=this.hot.getCellMeta(l,u),d=h.search.callback||r,m=(h.search.queryMethod||n)(e,c,h);if(m){const g={row:l,col:u,data:c};o.push(g)}d&&d(a,l,u,c,m)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){ut(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function OO(t,e,r,n,i,s){const o=s.className||[];let a=[];typeof o=="string"?a=o.split(" "):a.push(...o),this.isEnabled()&&s.isSearchResult?a.includes(this.searchResultClass)||a.push(`${this.searchResultClass}`):a.includes(this.searchResultClass)&&a.splice(a.indexOf(this.searchResultClass),1),s.className=a.join(" ")}function Ide(t,e){Pde(t,e),e.add(t)}function Pde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Pp(t,e,r){return(e=Nde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Nde(t){var e=Dde(t,"string");return typeof e=="symbol"?e:e+""}function Dde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cy(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const Hde="touchScroll",kde=200;var Np=new WeakSet;class Fde extends At{constructor(){super(...arguments),Ide(this,Np),Pp(this,"scrollbars",[]),Pp(this,"clones",[]),Pp(this,"lockedCollection",!1),Pp(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return Hde}static get PLUGIN_PRIORITY(){return kde}static get SETTING_KEYS(){return!0}isEnabled(){return rx()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Cy(Np,this,Lde).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Cy(Np,this,$de).call(this)),this.addHook("afterMomentumScroll",()=>Cy(Np,this,Bde).call(this))}}function Lde(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:r,topInlineStartCornerOverlay:n,bottomInlineStartCornerOverlay:i}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(r),n&&this.scrollbars.push(n),i&&i.clone&&this.scrollbars.push(i),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),r.needFullRender&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&i.clone&&this.clones.push(i.clone.wtTable.holder.parentNode)}function $de(){this.freezeOverlays=!0,V(this.clones,t=>{ve(t,"hide-tween")})}function Bde(){this.freezeOverlays=!1,V(this.clones,t=>{tt(t,"hide-tween"),ve(t,"show-tween")}),this.hot._registerTimeout(()=>{V(this.clones,t=>{tt(t,"show-tween")})},400),V(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function Vde(t,e){Wde(t,e),e.add(t)}function Wde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ude(t,e,r){return(e=jde(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function jde(t){var e=zde(t,"string");return typeof e=="symbol"?e:e+""}function zde(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yde(t,e,r){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}const f0="trimRows",Gde=330;var IO=new WeakSet;class Kde extends At{constructor(){super(...arguments),Vde(this,IO),Ude(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return f0}static get PLUGIN_PRIORITY(){return Gde}isEnabled(){return!!this.hot.getSettings()[f0]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Tg),this.trimmedRowsMap.addLocalHook("init",()=>Yde(IO,this,Xde).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[f0];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),V(e,r=>{this.trimmedRowsMap.setValueAtIndex(r,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;n&&(i=Array.from(new Set(r.concat(e)))),this.hot.runHooks("beforeTrimRow",r,i,n)!==!1&&(n&&this.hot.batchExecution(()=>{V(e,o=>{this.trimmedRowsMap.setValueAtIndex(o,!0)})},!0),this.hot.runHooks("afterTrimRow",r,i,n,n&&i.length>r.length))}trimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.trimRows(r)}untrimRows(e){const r=this.getTrimmedRows(),n=this.isValidConfig(e);let i=r;const s=this.trimmedRowsMap.getValues().slice(),o=e.length>0;n&&o&&(V(e,l=>{s[l]=!1}),i=Hr(s,(l,u,c)=>(u&&l.push(c),l),[])),this.hot.runHooks("beforeUntrimRow",r,i,n&&o)!==!1&&(n&&o&&this.trimmedRowsMap.setValues(s),this.hot.runHooks("afterUntrimRow",r,i,n&&o,n&&i.length<r.length))}untrimRow(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];this.untrimRows(r)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const r=this.hot.countSourceRows();return e.every(n=>Number.isInteger(n)&&n>=0&&n<r)}destroy(){super.destroy()}}function Xde(){const t=this.hot.getSettings()[f0];Array.isArray(t)&&this.hot.batchExecution(()=>{V(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}var gk={},qde=yl,Zde=gk,Jde=qde("iterator"),Qde=Array.prototype,efe=function(t){return t!==void 0&&(Zde.Array===t||Qde[Jde]===t)},tfe=XI,PO=Fw,rfe=Pw,nfe=gk,ife=yl,sfe=ife("iterator"),mk=function(t){if(!rfe(t))return PO(t,sfe)||PO(t,"@@iterator")||nfe[tfe(t)]},ofe=Is,afe=og,lfe=pa,ufe=kw,cfe=mk,hfe=TypeError,dfe=function(t,e){var r=arguments.length<2?cfe(t):e;if(afe(r))return lfe(ofe(r,t));throw new hfe(ufe(t)+" is not iterable")},ffe=hP,gfe=Is,mfe=pa,pfe=kw,wfe=efe,vfe=cg,NO=Dw,Cfe=dfe,Sfe=mk,DO=mb,yfe=TypeError,g0=function(t,e){this.stopped=t,this.result=e},HO=g0.prototype,bfe=function(t,e,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),s=!!(r&&r.IS_RECORD),o=!!(r&&r.IS_ITERATOR),a=!!(r&&r.INTERRUPTED),l=ffe(e,n),u,c,h,d,f,m,g,w=function(b){return u&&DO(u,"normal",b),new g0(!0,b)},S=function(b){return i?(mfe(b),a?l(b[0],b[1],w):l(b[0],b[1])):a?l(b,w):l(b)};if(s)u=t.iterator;else if(o)u=t;else{if(c=Sfe(t),!c)throw new yfe(pfe(t)+" is not iterable");if(wfe(c)){for(h=0,d=vfe(t);d>h;h++)if(f=S(t[h]),f&&NO(HO,f))return f;return new g0(!1)}u=Cfe(t,c)}for(m=s?t.next:u.next;!(g=gfe(m,u)).done;){try{f=S(g.value)}catch(b){DO(u,"throw",b)}if(typeof f=="object"&&f&&NO(HO,f))return f}return new g0(!1)},xfe=Os,Rfe=bl,Efe=Iw,Tfe=function(t,e,r){xfe?Rfe.f(t,e,Efe(0,r)):t[e]=r},_fe=pn,Afe=bfe,Mfe=Tfe;_fe({target:"Object",stat:!0},{fromEntries:function(e){var r={};return Afe(e,function(n,i){Mfe(r,n,i)},{AS_ENTRIES:!0}),r}});const pk="undoRedo",Ofe="undoRedo";function Ae(t){const e=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,this.enabled=!1,t.addHook("afterChange",function(n,i){const s=n&&n.length;if(!s||!n.find(l=>{const[,,u,c]=l;return u!==c}))return;const a=()=>{const l=n.reduce((c,h)=>(c.push([...h]),c),[]);V(l,c=>{c[1]=t.propToCol(c[1])});const u=s>1?this.getSelected():[[l[0][0],l[0][1]]];return new Ae.ChangeAction(l,u)};e.done(a,i)}),t.addHook("afterCreateRow",(n,i,s)=>{e.done(()=>new Ae.CreateRowAction(n,i),s)});const r=(n,i,s,o)=>{const a=["visualRow","visualCol","row","col","prop"],l=a.length,u=[];return Ue(s,o,c=>{Ue(n,i,h=>{const d=t.getCellMeta(h,c);if(Object.keys(d).length!==l){const f=Object.fromEntries(Object.entries(d).filter(m=>{let[g]=m;return a.includes(g)===!1}));u.push([d.visualRow,d.visualCol,f])}})}),u};t.addHook("beforeRemoveRow",(n,i,s,o)=>{const a=()=>{const l=t.toPhysicalRow(n),u=l+i-1,c=Mn(e.instance.getSourceData(l,0,l+i-1,e.instance.countSourceCols()-1));return new Ae.RemoveRowAction(l,c,t.getSettings().fixedRowsBottom,t.getSettings().fixedRowsTop,t.rowIndexMapper.getIndexesSequence(),r(l,u,0,t.countCols()-1))};e.done(a,o)}),t.addHook("afterCreateCol",(n,i,s)=>{e.done(()=>new Ae.CreateColumnAction(n,i),s)}),t.addHook("beforeRemoveCol",(n,i,s,o)=>{const a=()=>{const l=e.instance.getSourceDataArray(),u=(e.instance.countCols()+n)%e.instance.countCols(),c=u+i-1,h=[],d=[],f=[];Ue(l.length-1,w=>{const S=[],b=l[w];Ue(u,c,y=>{S.push(b[t.toPhysicalColumn(y)])}),h.push(S)}),Ue(i-1,w=>{f.push(t.toPhysicalColumn(u+w))}),Array.isArray(t.getSettings().colHeaders)&&Ue(i-1,w=>{d.push(t.getSettings().colHeaders[t.toPhysicalColumn(u+w)]||null)});const m=t.columnIndexMapper.getIndexesSequence(),g=t.rowIndexMapper.getIndexesSequence();return new Ae.RemoveColumnAction(u,f,h,d,m,g,t.getSettings().fixedColumnsStart,r(0,t.countRows(),u,c))};e.done(a,o)}),t.addHook("beforeCellAlignment",(n,i,s,o)=>{e.done(()=>new Ae.CellAlignmentAction(n,i,s,o))}),t.addHook("beforeFilter",(n,i)=>{e.done(()=>new Ae.FiltersAction(n,i))}),t.addHook("beforeRowMove",(n,i)=>{n!==!1&&e.done(()=>new Ae.RowMoveAction(n,i))}),t.addHook("beforeColumnMove",(n,i)=>{n!==!1&&e.done(()=>new Ae.ColumnMoveAction(n,i))}),t.addHook("beforeMergeCells",(n,i)=>{i||e.done(()=>new Ae.MergeCellsAction(t,n))}),t.addHook("afterUnmergeCells",(n,i)=>{i||e.done(()=>new Ae.UnmergeCellsAction(t,n))}),t.addHook("beforeColumnSort",(n,i,s)=>{s&&e.done(()=>new Ae.ColumnSortAction(n,i))}),t.addHook("afterInit",()=>{e.init()})}Ae.prototype.done=function(t,e){if(this.ignoreNewActions||e==="UndoRedo.undo"||e==="UndoRedo.redo"||e==="auto")return;const n=this.doneActions.slice();if(this.instance.runHooks("beforeUndoStackChange",n,e)===!1)return;const s=t(),o=this.undoneActions.slice();this.doneActions.push(s),this.instance.runHooks("afterUndoStackChange",n,this.doneActions.slice()),this.instance.runHooks("beforeRedoStackChange",o),this.undoneActions.length=0,this.instance.runHooks("afterRedoStackChange",o,this.undoneActions.slice())};Ae.prototype.undo=function(){if(this.isUndoAvailable()){const t=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",t);const e=this.doneActions.pop();this.instance.runHooks("afterUndoStackChange",t,this.doneActions.slice());const r=Mn(e);if(this.instance.runHooks("beforeUndo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",s),e.undo(this.instance,()=>{i.ignoreNewActions=!1,i.undoneActions.push(e)}),this.instance.runHooks("afterRedoStackChange",s,this.undoneActions.slice()),this.instance.runHooks("afterUndo",r)}};Ae.prototype.redo=function(){if(this.isRedoAvailable()){const t=this.undoneActions.slice();this.instance.runHooks("beforeRedoStackChange",t);const e=this.undoneActions.pop();this.instance.runHooks("afterRedoStackChange",t,this.undoneActions.slice());const r=Mn(e);if(this.instance.runHooks("beforeRedo",r)===!1)return;this.ignoreNewActions=!0;const i=this,s=this.doneActions.slice();this.instance.runHooks("beforeUndoStackChange",s),e.redo(this.instance,()=>{i.ignoreNewActions=!1,i.doneActions.push(e)}),this.instance.runHooks("afterUndoStackChange",s,this.doneActions.slice()),this.instance.runHooks("afterRedo",r)}};Ae.prototype.isUndoAvailable=function(){return this.doneActions.length>0};Ae.prototype.isRedoAvailable=function(){return this.undoneActions.length>0};Ae.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0};Ae.prototype.isEnabled=function(){return this.enabled};Ae.prototype.enable=function(){if(this.isEnabled())return;const t=this.instance;this.enabled=!0,Nfe(t),this.registerShortcuts(),t.addHook("afterChange",wk)};Ae.prototype.disable=function(){if(!this.isEnabled())return;const t=this.instance;this.enabled=!1,Dfe(t),this.unregisterShortcuts(),t.removeHook("afterChange",wk)};Ae.prototype.destroy=function(){this.clear(),this.instance=null,this.doneActions=null,this.undoneActions=null};Ae.Action=function(){};Ae.Action.prototype.undo=function(){};Ae.Action.prototype.redo=function(){};Ae.ChangeAction=function(t,e){this.changes=t,this.selected=e,this.actionType="change"};Ns(Ae.ChangeAction,Ae.Action);Ae.ChangeAction.prototype.undo=function(t,e){const r=Mn(this.changes),n=t.countEmptyRows(!0),i=t.countEmptyCols(!0);for(let o=0,a=r.length;o<a;o++)r[o].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.undo");for(let o=0,a=r.length;o<a;o++){const[l,u]=r[o];t.getSettings().minSpareRows&&l+1+t.getSettings().minSpareRows===t.countRows()&&n===t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(l+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&u+1+t.getSettings().minSpareCols===t.countCols()&&i===t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(u+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())}const s=t.getSelectedLast();if(s!==void 0){const[o,a]=r[0],[l,u]=s,c=t.view.getFirstFullyVisibleRow(),h=t.view.getFirstFullyVisibleColumn(),d=o>=c,f=a>=h;if((d&&f)===!1&&(l!==o||u!==a)===!0){const w={row:o,col:a};d===!1&&(w.verticalSnap="top"),f===!1&&(w.horizontalSnap="start"),t.scrollViewportTo(w)}}t.selectCells(this.selected,!1,!1)};Ae.ChangeAction.prototype.redo=function(t,e){const r=Mn(this.changes);for(let n=0,i=r.length;n<i;n++)r[n].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(r,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)};Ae.CreateRowAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_row"};Ns(Ae.CreateRowAction,Ae.Action);Ae.CreateRowAction.prototype.undo=function(t,e){const r=t.countRows(),n=t.getSettings().minSpareRows;this.index>=r&&this.index-n<r&&(this.index-=n),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")};Ae.CreateRowAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")};Ae.RemoveRowAction=function(t,e,r,n,i,s){this.index=t,this.data=e,this.actionType="remove_row",this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=i,this.removedCellMetas=s};Ns(Ae.RemoveRowAction,Ae.Action);Ae.RemoveRowAction.prototype.undo=function(t,e){const r=t.getSettings(),n=[];r.fixedRowsBottom=this.fixedRowsBottom,r.fixedRowsTop=this.fixedRowsTop,this.data.forEach((i,s)=>{Object.keys(i).forEach(o=>{const a=parseInt(o,10);n.push([this.index+s,isNaN(a)?o:a,i[o]])})}),t.alter("insert_row_above",this.index,this.data.length,"UndoRedo.undo"),this.removedCellMetas.forEach(i=>{let[s,o,a]=i;t.setCellMetaObject(s,o,a)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(n,null,null,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence)};Ae.RemoveRowAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.data.length,"UndoRedo.redo")};Ae.CreateColumnAction=function(t,e){this.index=t,this.amount=e,this.actionType="insert_col"};Ns(Ae.CreateColumnAction,Ae.Action);Ae.CreateColumnAction.prototype.undo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")};Ae.CreateColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")};Ae.RemoveColumnAction=function(t,e,r,n,i,s,o,a){this.index=t,this.indexes=e,this.data=r,this.amount=this.data[0].length,this.headers=n,this.columnPositions=i.slice(0),this.rowPositions=s.slice(0),this.actionType="remove_col",this.fixedColumnsStart=o,this.removedCellMetas=a};Ns(Ae.RemoveColumnAction,Ae.Action);Ae.RemoveColumnAction.prototype.undo=function(t,e){const r=t.getSettings();r.fixedColumnsStart=this.fixedColumnsStart;const n=this.indexes.slice(0).sort(),i=(u,c,h)=>h[this.indexes.indexOf(n[c])],s=this.data.length,o=[];for(let u=0;u<s;u++)o.push(St(this.data[u],i));const a=St(this.headers,i),l=[];t.alter("insert_col_start",this.indexes[0],this.indexes.length,"UndoRedo.undo"),V(t.getSourceDataArray(),(u,c)=>{V(n,(h,d)=>{u[h]=o[c][d],l.push([c,h,u[h]])})}),t.setSourceDataAtCell(l,void 0,void 0,"UndoRedo.undo"),typeof this.headers<"u"&&V(a,(u,c)=>{t.getSettings().colHeaders[n[c]]=u}),this.removedCellMetas.forEach(u=>{let[c,h,d]=u;t.setCellMetaObject(c,h,d)}),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),t.addHookOnce("afterViewRender",e),t.render()};Ae.RemoveColumnAction.prototype.redo=function(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")};Ae.CellAlignmentAction=function(t,e,r,n){this.stateBefore=t,this.range=e,this.type=r,this.alignment=n};Ae.CellAlignmentAction.prototype.undo=function(t,e){V(this.range,r=>{r.forAll((n,i)=>{n>=0&&i>=0&&t.setCellMeta(n,i,"className",this.stateBefore[n][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()};Ae.CellAlignmentAction.prototype.redo=function(t,e){Wa(this.range,this.type,this.alignment,(r,n)=>t.getCellMeta(r,n),(r,n,i,s)=>t.setCellMeta(r,n,i,s)),t.addHookOnce("afterViewRender",e),t.render()};Ae.FiltersAction=function(t,e){this.previousConditionsStack=e,this.conditionsStack=t,this.actionType="filter"};Ns(Ae.FiltersAction,Ae.Action);Ae.FiltersAction.prototype.undo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),this.previousConditionsStack&&r.conditionCollection.importAllConditions(this.previousConditionsStack),r.filter()};Ae.FiltersAction.prototype.redo=function(t,e){const r=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),r.conditionCollection.importAllConditions(this.conditionsStack),r.filter()};class Ife extends Ae.Action{constructor(e,r){super(),this.cellRange=r;const n=this.cellRange.getTopStartCorner(),i=this.cellRange.getBottomEndCorner();this.rangeData=e.getData(n.row,n.col,i.row,i.col)}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0);const i=this.cellRange.getTopStartCorner();e.populateFromArray(i.row,i.col,this.rangeData,void 0,void 0,"MergeCells")}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange)}}Ae.MergeCellsAction=Ife;class Pfe extends Ae.Action{constructor(e,r){super(),this.cellRange=r}undo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.mergeRange(this.cellRange,!0)}redo(e,r){const n=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",r),n.unmergeRange(this.cellRange,!0),e.render()}}Ae.UnmergeCellsAction=Pfe;Ae.RowMoveAction=function(t,e){this.rows=t.slice(),this.finalRowIndex=e,this.actionType="row_move"};Ns(Ae.RowMoveAction,Ae.Action);Ae.RowMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),FE(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),r.moveRow(o,s)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)};Ae.RowMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),r.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)};Ae.ColumnMoveAction=function(t,e){this.columns=t.slice(),this.finalColumnIndex=e,this.actionType="col_move"};Ns(Ae.ColumnMoveAction,Ae.Action);Ae.ColumnMoveAction.prototype.undo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),FE(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(i=>{let{from:s,to:o}=i;s<o&&(o-=1),r.moveColumn(o,s)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)};Ae.ColumnMoveAction.prototype.redo=function(t,e){const r=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),r.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)};Ae.ColumnSortAction=function(t,e){this.previousSortState=t,this.nextSortState=e};Ns(Ae.ColumnSortAction,Ae.Action);Ae.ColumnSortAction.prototype.undo=function(t,e){const r=t.getPlugin("columnSorting"),n=t.getPlugin("multiColumnSorting"),i=n.isEnabled()?n:r;this.previousSortState.length?i.sort(this.previousSortState):i.clearSort(),e()};Ae.ColumnSortAction.prototype.redo=function(t,e){const r=t.getPlugin("columnSorting"),n=t.getPlugin("multiColumnSorting");(n.isEnabled()?n:r).sort(this.nextSortState),e()};Ae.prototype.init=function(){const t=this.instance.getSettings().undo,e=typeof t>"u"||t;this.instance.undoRedo||(this.instance.undoRedo=this),e?this.instance.undoRedo.enable():this.instance.undoRedo.disable()};Ae.prototype.registerShortcuts=function(){const e=this.instance.getShortcutManager().getContext("grid"),n={runOnlyIf:i=>!i.altKey,group:pk};e.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],n)};Ae.prototype.unregisterShortcuts=function(){this.instance.getShortcutManager().getContext("grid").removeShortcutsByGroup(pk)};function wk(t,e){const r=this;if(e==="loadData")return r.undoRedo.clear()}function Nfe(t){t.undo=function(){return t.undoRedo.undo()},t.redo=function(){return t.undoRedo.redo()},t.isUndoAvailable=function(){return t.undoRedo.isUndoAvailable()},t.isRedoAvailable=function(){return t.undoRedo.isRedoAvailable()},t.clearUndo=function(){return t.undoRedo.clear()}}function Dfe(t){delete t.undo,delete t.redo,delete t.isUndoAvailable,delete t.isRedoAvailable,delete t.clearUndo}const Hg=He.getSingleton();Hg.add("afterUpdateSettings",function(){var t;(t=this.getPlugin("undoRedo"))===null||t===void 0||t.init()});Hg.register("beforeUndo");Hg.register("afterUndo");Hg.register("beforeRedo");Hg.register("afterRedo");Ae.PLUGIN_KEY=Ofe;Ae.SETTING_KEYS=!0;function Hfe(){Et(of),Et(cee),Et(af),Et(jee),Et(Jee),Et(VH),Et(Yte),Et(Ire),Et(Ov),Et(qne),Et(bie),Et(Oie),Et(Nv),Et(ise),Et(rae),Et(Nae),Et(sle),Et(ple),Et(Ale),Et($le),Et(Xle),Et(fue),Et(bue),Et(tce),Et(Hce),Et(Bce),Et(dhe),Et(Jhe),Et(yde),Et(Ode),Et(Fde),Et(Kde),Et(Ae)}function kfe(){$J(),nQ(),dQ(),PQ(),Hfe()}function Ffe(t){const e=typeof window>"u"?!1:window.jQuery;e&&(e.fn.handsontable=function(r){const n=this.first();let i=n.data("handsontable");if(typeof r!="string"){const u=r||{};return i?i.updateSettings(u):(i=new t.Core(n[0],u),n.data("handsontable",i),i.init()),n}let s;if(i)if(typeof i[r]<"u"){for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];s=i[r].call(i,...a),r==="destroy"&&n.removeData()}else throw new Error(`Handsontable do not provide action: ${r}`);return s})}var Sy,yy,by,xy,Ry;kfe();Ffe(rt);rt.__GhostTable=bE;rt._getListenersCounter=BY;rt._getRegisteredMapsCounter=uX;rt.EventManager=Xi;const Lfe=[G5,tY,qK,sQ,Jz,Hz,Z5,O9,Zz,Q5,iY,M9],$fe=[Iz,sY];rt.helper={};rt.dom={};V(Lfe,t=>{V(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(rt.helper[e]=t[e])})});V($fe,t=>{V(Object.getOwnPropertyNames(t),e=>{e.charAt(0)!=="_"&&(rt.dom[e]=t[e])})});rt.cellTypes=(Sy=rt.cellTypes)!==null&&Sy!==void 0?Sy:{};V(gq(),t=>{rt.cellTypes[t]=iE(t)});rt.cellTypes.registerCellType=Di;rt.cellTypes.getCellType=iE;rt.editors=(yy=rt.editors)!==null&&yy!==void 0?yy:{};V(DY(),t=>{rt.editors[`${An(t)}Editor`]=A0(t)});rt.editors.registerEditor=Jn;rt.editors.getEditor=A0;rt.renderers=(by=rt.renderers)!==null&&by!==void 0?by:{};V(z9(),t=>{const e=M0(t);t==="base"&&(rt.renderers.cellDecorator=e),rt.renderers[`${An(t)}Renderer`]=e});rt.renderers.registerRenderer=di;rt.renderers.getRenderer=M0;rt.validators=(xy=rt.validators)!==null&&xy!==void 0?xy:{};V(K9(),t=>{rt.validators[`${An(t)}Validator`]=px(t)});rt.validators.registerValidator=gu;rt.validators.getValidator=px;rt.plugins=(Ry=rt.plugins)!==null&&Ry!==void 0?Ry:{};V(mx(),t=>{rt.plugins[t]=bg(t)});rt.plugins[`${An(At.PLUGIN_KEY)}Plugin`]=At;rt.plugins.registerPlugin=Et;rt.plugins.getPlugin=bg;const Bfe=QF(),Vfe={rowHeaders:!0,columnSorting:!1,manualColumnResize:!0,comments:!0,autoWrapRow:!0,autoWrapCol:!0,height:"500px",width:"100%",licenseKey:"non-commercial-and-evaluation"},Wfe={dateFormat:"YYYY-MM-DD",correctFormat:!0,datePickerConfig:{i18n:{previousMonth:"ì´ì  ë¬",nextMonth:"ë¤ì ë¬",months:["1ì","2ì","3ì","4ì","5ì","6ì","7ì","8ì","9ì","10ì","11ì","12ì"],weekdays:["ì¼ìì¼","ììì¼","íìì¼","ììì¼","ëª©ìì¼","ê¸ìì¼","í ìì¼"],weekdaysShort:["ì¼","ì","í","ì","ëª©","ê¸","í "]},format:"YYYY-MM-DD",firstDay:1}},Ufe={dateFormat:"YYYY-MM-DD HH:mm",correctFormat:!0,datePickerConfig:{i18n:{previousMonth:"ì´ì  ë¬",nextMonth:"ë¤ì ë¬",months:["1ì","2ì","3ì","4ì","5ì","6ì","7ì","8ì","9ì","10ì","11ì","12ì"],weekdays:["ì¼ìì¼","ììì¼","íìì¼","ììì¼","ëª©ìì¼","ê¸ìì¼","í ìì¼"],weekdaysShort:["ì¼","ì","í","ì","ëª©","ê¸","í "]},format:"YYYY-MM-DD HH:mm",firstDay:1}},jfe={creator:"",createDt:"",updater:"",updateDt:"",startUpdateDt:"",endUpdateDt:""},zfe=["mode"],Yfe=[{data:"mode",type:"text",width:1,readOnly:!0,hidden:!0}],Gfe=["ë±ë¡ì","ë±ë¡ì¼ì","ìì ì","ìì ì¼ì"],Kfe=[{data:"creator",type:"text",width:100,readOnly:!0,editor:!1},{data:"createDt",type:"text",width:170,readOnly:!0,editor:!1},{data:"updater",type:"text",width:100,readOnly:!0,editor:!1},{data:"updateDt",type:"text",width:170,readOnly:!0,editor:!1}],Xfe={mode:"C"},qfe={creator:"",createDt:"",updater:"",updateDt:""},Zfe=t=>({columns:t,indicators:!0}),Jfe=({newRow:t,list:e,grid:r})=>("companyId"in t&&(t.companyId=Bfe.userInfo.companyId),e.unshift(t),r.loadData(e),e),Qfe=({selectedRow:t,grid:e})=>{t!==null&&(e.getDataAtRowProp(t,"mode")==="C"?e.alter("remove_row",t):e.setDataAtRowProp(t,"mode","D"))},ege=()=>{location.reload()},tge=({list:t,required:e})=>{if(t.filter(s=>e.some(o=>s[o]===null||s[o]===void 0||s[o]==="")).length>0){alert("ëª¨ë  íì í­ëª©ì ìë ¥í´ì¼ í©ëë¤.");return}const n=t.filter(s=>s.mode);if(n.length===0)return alert("ì ì¥í  ë°ì´í°ê° ììµëë¤."),null;const i={C:n.filter(s=>s.mode==="C").length,U:n.filter(s=>s.mode==="U").length,D:n.filter(s=>s.mode==="D").length};return confirm(`ë±ë¡ ${i.C}ê±´, ìì  ${i.U}ê±´, ì­ì  ${i.D}ê±´ì ì ì¥íìê² ìµëê¹?`)?n:null},rge=({row:t,col:e,grid:r,self:n,pk:i})=>{var a,l,u;const s={},o=n.instance.getDataAtRowProp(t,"mode")||"";if(r.getCell&&e===0){const c=(a=r.getCell(t,0))==null?void 0:a.parentNode;if(c)switch(c.classList.remove("row-updated"),c.classList.remove("row-deleted"),o){case"C":break;case"R":break;case"U":(l=c.classList)==null||l.add("row-updated");break;case"D":(u=c.classList)==null||u.add("row-deleted");break}}return o==="C"&&i.forEach(c=>{if(e===c)return s.readOnly=!1,s}),s},nge=({changes:t,source:e,gridProps:r,grid:n,self:i})=>{(e==="edit"||e==="CopyPaste.paste"||e==="Autofill.fill")&&(t==null||t.forEach(([s,o,a,l])=>{o!=="mode"&&(r.required.includes(o)&&!l?i.setCellMeta(s,i.propToCol(o),"className","cell-required"):i.removeCellMeta(s,i.propToCol(o),"className"),a!==l&&n.getSourceDataAtRow(s).mode!=="C"&&n.setDataAtRowProp(s,"mode","U"))}))},fye={defaultProps:Vfe,searchProps:jfe,datePickerConfig:Wfe,dateTimePickerConfig:Ufe,commonColumnNames:zfe,commonColumns:Yfe,auditColumnNames:Gfe,auditColumns:Kfe,commonAddColumns:Xfe,auditAddColumns:qfe,hiddenColumns:Zfe,afterChangeEvent:nge,cellsEvent:rge,add:Jfe,valid:tge,reload:ege,del:Qfe};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var pw={};pw.version="0.18.5";var vk=1252,ige=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ck=function(t){ige.indexOf(t)!=-1&&(vk=t)};function sge(){Ck(1252)}var Jf=function(t){Ck(t)};function oge(){Jf(1200),sge()}var Dp=function(e){return String.fromCharCode(e)},kO=function(e){return String.fromCharCode(e)},mu,sl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qf(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,u=0;u<t.length;)r=t.charCodeAt(u++),s=r>>2,n=t.charCodeAt(u++),o=(r&3)<<4|n>>4,i=t.charCodeAt(u++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),e+=sl.charAt(s)+sl.charAt(o)+sl.charAt(a)+sl.charAt(l);return e}function ga(t){var e="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<t.length;)s=sl.indexOf(t.charAt(u++)),o=sl.indexOf(t.charAt(u++)),r=s<<2|o>>4,e+=String.fromCharCode(r),a=sl.indexOf(t.charAt(u++)),n=(o&15)<<4|a>>2,a!==64&&(e+=String.fromCharCode(n)),l=sl.indexOf(t.charAt(u++)),i=(a&3)<<6|l,l!==64&&(e+=String.fromCharCode(i));return e}var Nt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ba=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,r){return r?new Buffer(e,r):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Fu(t){return Nt?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function FO(t){return Nt?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ss=function(e){return Nt?ba(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)&255})};function Fv(t){if(typeof ArrayBuffer>"u")return Ss(t);for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),n=0;n!=t.length;++n)r[n]=t.charCodeAt(n)&255;return e}function kg(t){if(Array.isArray(t))return t.map(function(n){return String.fromCharCode(n)}).join("");for(var e=[],r=0;r<t.length;++r)e[r]=String.fromCharCode(t[r]);return e.join("")}function age(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var cn=Nt?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:ba(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,r=0;for(e=0;e<t.length;++e)r+=t[e].length;var n=new Uint8Array(r),i=0;for(e=0,r=0;e<t.length;r+=i,++e)if(i=t[e].length,t[e]instanceof Uint8Array)n.set(t[e],r);else{if(typeof t[e]=="string")throw"wtf";n.set(new Uint8Array(t[e]),r)}return n}return[].concat.apply([],t.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function lge(t){for(var e=[],r=0,n=t.length+250,i=Fu(t.length+255),s=0;s<t.length;++s){var o=t.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=t.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(e.push(i.slice(0,r)),r=0,i=Fu(65535),n=65530)}return e.push(i.slice(0,r)),cn(e)}var Rf=/\u0000/g,Hp=/[\u0001-\u0006]/g;function hh(t){for(var e="",r=t.length-1;r>=0;)e+=t.charAt(r--);return e}function bs(t,e){var r=""+t;return r.length>=e?r:_r("0",e-r.length)+r}function UE(t,e){var r=""+t;return r.length>=e?r:_r(" ",e-r.length)+r}function ww(t,e){var r=""+t;return r.length>=e?r:r+_r(" ",e-r.length)}function uge(t,e){var r=""+Math.round(t);return r.length>=e?r:_r("0",e-r.length)+r}function cge(t,e){var r=""+t;return r.length>=e?r:_r("0",e-r.length)+r}var LO=Math.pow(2,32);function Vc(t,e){if(t>LO||t<-LO)return uge(t,e);var r=Math.round(t);return cge(r,e)}function vw(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var $O=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ey=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hge(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "',t}var Mr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"ä¸å/ä¸å "hh"æ"mm"å"ss"ç§ "'},BO={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},dge={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Cw(t,e,r){for(var n=t<0?-1:1,i=t*n,s=0,o=1,a=0,l=1,u=0,c=0,h=Math.floor(i);u<e&&(h=Math.floor(i),a=h*o+s,c=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=u,u=c;if(c>e&&(u>e?(c=l,a=s):(c=u,a=o)),!r)return[0,n*a,c];var d=Math.floor(n*a/c);return[d,n*a-d*c,c]}function kp(t,e,r){if(t>2958465||t<0)return null;var n=t|0,i=Math.floor(86400*(t-n)),s=0,o=[],a={D:n,T:i,u:86400*(t-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),e&&e.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Cge(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var Sk=new Date(1899,11,31,0,0,0),fge=Sk.getTime(),gge=new Date(1900,2,1,0,0,0);function yk(t,e){var r=t.getTime();return e?r-=1461*24*60*60*1e3:t>=gge&&(r+=24*60*60*1e3),(r-(fge+(t.getTimezoneOffset()-Sk.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function jE(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function mge(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function pge(t){var e=t<0?12:11,r=jE(t.toFixed(12));return r.length<=e||(r=t.toPrecision(10),r.length<=e)?r:t.toExponential(5)}function wge(t){var e=jE(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function vge(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),r;return e>=-4&&e<=-1?r=t.toPrecision(10+e):Math.abs(e)<=9?r=pge(t):e===10?r=t.toFixed(10).substr(0,12):r=wge(t),jE(mge(r.toUpperCase()))}function J1(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):vge(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return vl(14,yk(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function Cge(t,e){e[0]-=581;var r=t.getDay();return t<60&&(r=(r+6)%7),r}function Sge(t,e,r,n){var i="",s=0,o=0,a=r.y,l,u=0;switch(t){case 98:a=r.y+543;case 121:switch(e.length){case 1:case 2:l=a%100,u=2;break;default:l=a%1e4,u=4;break}break;case 109:switch(e.length){case 1:case 2:l=r.m,u=e.length;break;case 3:return Ey[r.m-1][1];case 5:return Ey[r.m-1][0];default:return Ey[r.m-1][2]}break;case 100:switch(e.length){case 1:case 2:l=r.d,u=e.length;break;case 3:return $O[r.q][0];default:return $O[r.q][1]}break;case 104:switch(e.length){case 1:case 2:l=1+(r.H+11)%12,u=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:l=r.H,u=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:l=r.M,u=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return r.u===0&&(e=="s"||e=="ss")?bs(r.S,e.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),e==="s"?s===0?"0":""+s/o:(i=bs(s,2+n),e==="ss"?i.substr(0,2):"."+i.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+e}u=e.length===3?1:2;break;case 101:l=a,u=1;break}var c=u>0?bs(l,u):"";return c}function ol(t){var e=3;if(t.length<=e)return t;for(var r=t.length%e,n=t.substr(0,r);r!=t.length;r+=e)n+=(n.length>0?",":"")+t.substr(r,e);return n}var bk=/%/g;function yge(t,e,r){var n=e.replace(bk,""),i=e.length-n.length;return aa(t,n,r*Math.pow(10,2*i))+_r("%",i)}function bge(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return aa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function xk(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+xk(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(e)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var Rk=/# (\?+)( ?)\/( ?)(\d+)/;function xge(t,e,r){var n=parseInt(t[4],10),i=Math.round(e*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?_r(" ",t[1].length+1+t[4].length):UE(o,t[1].length)+t[2]+"/"+t[3]+bs(a,t[4].length))}function Rge(t,e,r){return r+(e===0?"":""+e)+_r(" ",t[1].length+2+t[4].length)}var Ek=/^#*0*\.([0#]+)/,Tk=/\).*[0#]/,_k=/\(###\) ###\\?-####/;function kn(t){for(var e="",r,n=0;n!=t.length;++n)switch(r=t.charCodeAt(n)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(r)}return e}function VO(t,e){var r=Math.pow(10,e);return""+Math.round(t*r)/r}function WO(t,e){var r=t-Math.floor(t),n=Math.pow(10,e);return e<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Ege(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function Tge(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ni(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Tk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ni("n",n,r):"("+Ni("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return bge(t,e,r);if(e.indexOf("%")!==-1)return yge(t,e,r);if(e.indexOf("E")!==-1)return xk(e,r);if(e.charCodeAt(0)===36)return"$"+Ni(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+Vc(l,e.length);if(e.match(/^[#?]+$/))return i=Vc(r,0),i==="0"&&(i=""),i.length>e.length?i:kn(e.substr(0,e.length-i.length))+i;if(s=e.match(Rk))return xge(s,l,u);if(e.match(/^#+0+$/))return u+Vc(l,e.length-e.indexOf("0"));if(s=e.match(Ek))return i=VO(r,s[1].length).replace(/^([^\.]+)$/,"$1."+kn(s[1])).replace(/\.$/,"."+kn(s[1])).replace(/\.(\d*)$/,function(m,g){return"."+g+_r("0",kn(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+VO(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ol(Vc(l,0));if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ni(t,e,-r):ol(""+(Math.floor(r)+Ege(r,s[1].length)))+"."+bs(WO(r,s[1].length),s[1].length);if(s=e.match(/^#,#*,#0/))return Ni(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=hh(Ni(t,e.replace(/[\\-]/g,""),r)),o=0,hh(hh(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(e.match(_k))return i=Ni(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Cw(l,Math.pow(10,o)-1,!1),i=""+u,c=aa("n",s[1],a[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=ww(a[2],o),c.length<s[4].length&&(c=kn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Cw(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?UE(a[1],o)+s[2]+"/"+s[3]+ww(a[2],o):_r(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=Vc(r,0),e.length<=i.length?i:kn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,d=e.length-i.length-h;return kn(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return o=WO(r,s[1].length),r<0?"-"+Ni(t,e,-r):ol(Tge(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?bs(0,3-m.length):"")+m})+"."+bs(o,s[1].length);switch(e){case"###,##0.00":return Ni(t,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=ol(Vc(l,0));return f!=="0"?u+f:"";case"###,###.00":return Ni(t,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ni(t,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function _ge(t,e,r){for(var n=e.length-1;e.charCodeAt(n-1)===44;)--n;return aa(t,e.substr(0,n),r/Math.pow(10,3*(e.length-n)))}function Age(t,e,r){var n=e.replace(bk,""),i=e.length-n.length;return aa(t,n,r*Math.pow(10,2*i))+_r("%",i)}function Ak(t,e){var r,n=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ak(t,-e);var i=t.indexOf(".");i===-1&&(i=t.indexOf("E"));var s=Math.floor(Math.log(e)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(e/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(e)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else r=e.toExponential(n);return t.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),t.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function to(t,e,r){if(t.charCodeAt(0)===40&&!e.match(Tk)){var n=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?to("n",n,r):"("+to("n",n,-r)+")"}if(e.charCodeAt(e.length-1)===44)return _ge(t,e,r);if(e.indexOf("%")!==-1)return Age(t,e,r);if(e.indexOf("E")!==-1)return Ak(e,r);if(e.charCodeAt(0)===36)return"$"+to(t,e.substr(e.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),u=r<0?"-":"";if(e.match(/^00+$/))return u+bs(l,e.length);if(e.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>e.length?i:kn(e.substr(0,e.length-i.length))+i;if(s=e.match(Rk))return Rge(s,l,u);if(e.match(/^#+0+$/))return u+bs(l,e.length-e.indexOf("0"));if(s=e.match(Ek))return i=(""+r).replace(/^([^\.]+)$/,"$1."+kn(s[1])).replace(/\.$/,"."+kn(s[1])),i=i.replace(/\.(\d*)$/,function(m,g){return"."+g+_r("0",kn(s[1]).length-g.length)}),e.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),s=e.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=e.match(/^#{1,3},##0(\.?)$/))return u+ol(""+l);if(s=e.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+to(t,e,-r):ol(""+r)+"."+_r("0",s[1].length);if(s=e.match(/^#,#*,#0/))return to(t,e.replace(/^#,#*,/,""),r);if(s=e.match(/^([0#]+)(\\?-([0#]+))+$/))return i=hh(to(t,e.replace(/[\\-]/g,""),r)),o=0,hh(hh(e.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(e.match(_k))return i=to(t,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=Cw(l,Math.pow(10,o)-1,!1),i=""+u,c=aa("n",s[1],a[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=ww(a[2],o),c.length<s[4].length&&(c=kn(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=Cw(l,Math.pow(10,o)-1,!0),u+(a[0]||(a[1]?"":"0"))+" "+(a[1]?UE(a[1],o)+s[2]+"/"+s[3]+ww(a[2],o):_r(" ",2*o+1+s[2].length+s[3].length));if(s=e.match(/^[#0?]+$/))return i=""+r,e.length<=i.length?i:kn(e.substr(0,e.length-i.length))+i;if(s=e.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=e.indexOf(".")-o,d=e.length-i.length-h;return kn(e.substr(0,h)+i+e.substr(e.length-d))}if(s=e.match(/^00,000\.([#0]*0)$/))return r<0?"-"+to(t,e,-r):ol(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?bs(0,3-m.length):"")+m})+"."+bs(0,s[1].length);switch(e){case"###,###":case"##,###":case"#,###":var f=ol(""+l);return f!=="0"?u+f:"";default:if(e.match(/\.[0#?]*$/))return to(t,e.slice(0,e.lastIndexOf(".")),r)+kn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function aa(t,e,r){return(r|0)===r?to(t,e,r):Ni(t,e,r)}function Mge(t){for(var e=[],r=!1,n=0,i=0;n<t.length;++n)switch(t.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:e[e.length]=t.substr(i,n-i),i=n+1}if(e[e.length]=t.substr(i),r===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var Mk=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ok(t){for(var e=0,r="",n="";e<t.length;)switch(r=t.charAt(e)){case"G":vw(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"ä¸":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="ä¸å/ä¸å")return!0;++e;break;case"[":for(n=r;t.charAt(e++)!=="]"&&e<t.length;)n+=t.charAt(e);if(n.match(Mk))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(r=t.charAt(++e))>-1||r=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===r;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function Oge(t,e,r,n){for(var i=[],s="",o=0,a="",l="t",u,c,h,d="H";o<t.length;)switch(a=t.charAt(o)){case"G":if(!vw(t,o))throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=t.charCodeAt(++o))!==34&&o<t.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var f=t.charAt(++o),m=f==="("||f===")"?f:"t";i[i.length]={t:m,v:f},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:e},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(u==null&&(u=kp(e,r,t.charAt(o+1)==="2"),u==null))return"";i[i.length]={t:"X",v:t.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||u==null&&(u=kp(e,r),u==null))return"";for(s=a;++o<t.length&&t.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=d),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"ä¸":var g={t:a,v:a};if(u==null&&(u=kp(e,r)),t.substr(o,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",d="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",o+=5,d="h"):t.substr(o,5).toUpperCase()==="ä¸å/ä¸å"?(u!=null&&(g.v=u.H>=12?"ä¸å":"ä¸å"),g.t="T",o+=5,d="h"):(g.t="t",++o),u==null&&g.t==="T")return"";i[i.length]=g,l=a;break;case"[":for(s=a;t.charAt(o++)!=="]"&&o<t.length;)s+=t.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(Mk)){if(u==null&&(u=kp(e,r),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ok(t)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=a;++o<t.length&&(a=t.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<t.length&&"0#?.,E+-%".indexOf(a=t.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;t.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)s+=t.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=â¬acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+t);i[i.length]={t:"t",v:a},++o;break}var w=0,S=0,b;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=d,l="h",w<1&&(w=1);break;case"s":(b=i[o].v.match(/\.0+$/))&&(S=Math.max(S,b[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[o].v.match(/[Hh]/)&&(w=1),w<2&&i[o].v.match(/[Mm]/)&&(w=2),w<3&&i[o].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",_;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=Sge(i[o].t.charCodeAt(0),i[o].v,u,S),i[o].t="t";break;case"n":case"?":for(_=o+1;i[_]!=null&&((a=i[_].t)==="?"||a==="D"||(a===" "||a==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[o].v+=i[_].v,i[_]={v:"",t:";"},++_;y+=i[o].v,o=_-1;break;case"G":i[o].t="t",i[o].v=J1(e,r);break}var P="",z,I;if(y.length>0){y.charCodeAt(0)==40?(z=e<0&&y.charCodeAt(0)===45?-e:e,I=aa("n",y,z)):(z=e<0&&n>1?-e:e,I=aa("n",y,z),z<0&&i[0]&&i[0].t=="t"&&(I=I.substr(1),i[0].v="-"+i[0].v)),_=I.length-1;var W=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){W=o;break}var L=i.length;if(W===i.length&&I.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(_>=i[o].v.length-1?(_-=i[o].v.length,i[o].v=I.substr(_+1,i[o].v.length)):_<0?i[o].v="":(i[o].v=I.substr(0,_+1),_=-1),i[o].t="t",L=o);_>=0&&L<i.length&&(i[L].v=I.substr(0,_+1)+i[L].v)}else if(W!==i.length&&I.indexOf("E")===-1){for(_=I.indexOf(".")-1,o=W;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(c=i[o].v.indexOf(".")>-1&&o===W?i[o].v.indexOf(".")-1:i[o].v.length-1,P=i[o].v.substr(c+1);c>=0;--c)_>=0&&(i[o].v.charAt(c)==="0"||i[o].v.charAt(c)==="#")&&(P=I.charAt(_--)+P);i[o].v=P,i[o].t="t",L=o}for(_>=0&&L<i.length&&(i[L].v=I.substr(0,_+1)+i[L].v),_=I.indexOf(".")+1,o=W;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==W)){for(c=i[o].v.indexOf(".")>-1&&o===W?i[o].v.indexOf(".")+1:0,P=i[o].v.substr(0,c);c<i[o].v.length;++c)_<I.length&&(P+=I.charAt(_++));i[o].v=P,i[o].t="t",L=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(z=n>1&&e<0&&o>0&&i[o-1].v==="-"?-e:e,i[o].v=aa(i[o].t,i[o].v,z),i[o].t="t");var U="";for(o=0;o!==i.length;++o)i[o]!=null&&(U+=i[o].v);return U}var UO=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function jO(t,e){if(e==null)return!1;var r=parseFloat(e[2]);switch(e[1]){case"=":if(t==r)return!0;break;case">":if(t>r)return!0;break;case"<":if(t<r)return!0;break;case"<>":if(t!=r)return!0;break;case">=":if(t>=r)return!0;break;case"<=":if(t<=r)return!0;break}return!1}function Ige(t,e){var r=Mge(t),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof e!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=e>0?r[0]:e<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(UO),a=r[1].match(UO);return jO(e,o)?[n,r[0]]:jO(e,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function vl(t,e,r){r==null&&(r={});var n="";switch(typeof t){case"string":t=="m/d/yy"&&r.dateNF?n=r.dateNF:n=t;break;case"number":t==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Mr)[t],n==null&&(n=r.table&&r.table[BO[t]]||Mr[BO[t]]),n==null&&(n=dge[t]||"General");break}if(vw(n,0))return J1(e,r);e instanceof Date&&(e=yk(e,r.date1904));var i=Ige(n,e);if(vw(i[1]))return J1(e,r);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return Oge(i[1],e,r,i[0])}function Ik(t,e){if(typeof e!="number"){e=+e||-1;for(var r=0;r<392;++r){if(Mr[r]==null){e<0&&(e=r);continue}if(Mr[r]==t){e=r;break}}e<0&&(e=391)}return Mr[e]=t,e}function Lv(t){for(var e=0;e!=392;++e)t[e]!==void 0&&Ik(t[e],e)}function $v(){Mr=hge()}var Pk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Pge(t){var e=typeof t=="number"?Mr[t]:t;return e=e.replace(Pk,"(\\d+)"),new RegExp("^"+e+"$")}function Nge(t,e,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(e.match(Pk)||[]).forEach(function(h,d){var f=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=f;break;case"d":s=f;break;case"h":o=f;break;case"s":l=f;break;case"m":o>=0?a=f:i=f;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?u:n==-1&&i==-1&&s==-1?c:u+"T"+c}var Dge=function(){var t={};t.version="1.2.0";function e(){for(var I=0,W=new Array(256),L=0;L!=256;++L)I=L,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,W[L]=I;return typeof Int32Array<"u"?new Int32Array(W):W}var r=e();function n(I){var W=0,L=0,U=0,G=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(U=0;U!=256;++U)G[U]=I[U];for(U=0;U!=256;++U)for(L=I[U],W=256+U;W<4096;W+=256)L=G[W]=L>>>8^I[L&255];var X=[];for(U=1;U!=16;++U)X[U-1]=typeof Int32Array<"u"?G.subarray(U*256,U*256+256):G.slice(U*256,U*256+256);return X}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],u=i[4],c=i[5],h=i[6],d=i[7],f=i[8],m=i[9],g=i[10],w=i[11],S=i[12],b=i[13],y=i[14];function _(I,W){for(var L=W^-1,U=0,G=I.length;U<G;)L=L>>>8^r[(L^I.charCodeAt(U++))&255];return~L}function P(I,W){for(var L=W^-1,U=I.length-15,G=0;G<U;)L=y[I[G++]^L&255]^b[I[G++]^L>>8&255]^S[I[G++]^L>>16&255]^w[I[G++]^L>>>24]^g[I[G++]]^m[I[G++]]^f[I[G++]]^d[I[G++]]^h[I[G++]]^c[I[G++]]^u[I[G++]]^l[I[G++]]^a[I[G++]]^o[I[G++]]^s[I[G++]]^r[I[G++]];for(U+=15;G<U;)L=L>>>8^r[(L^I[G++])&255];return~L}function z(I,W){for(var L=W^-1,U=0,G=I.length,X=0,le=0;U<G;)X=I.charCodeAt(U++),X<128?L=L>>>8^r[(L^X)&255]:X<2048?(L=L>>>8^r[(L^(192|X>>6&31))&255],L=L>>>8^r[(L^(128|X&63))&255]):X>=55296&&X<57344?(X=(X&1023)+64,le=I.charCodeAt(U++)&1023,L=L>>>8^r[(L^(240|X>>8&7))&255],L=L>>>8^r[(L^(128|X>>2&63))&255],L=L>>>8^r[(L^(128|le>>6&15|(X&3)<<4))&255],L=L>>>8^r[(L^(128|le&63))&255]):(L=L>>>8^r[(L^(224|X>>12&15))&255],L=L>>>8^r[(L^(128|X>>6&63))&255],L=L>>>8^r[(L^(128|X&63))&255]);return~L}return t.table=r,t.bstr=_,t.buf=P,t.str=z,t}(),Xt=function(){var e={};e.version="1.2.1";function r(E,D){for(var A=E.split("/"),O=D.split("/"),H=0,k=0,oe=Math.min(A.length,O.length);H<oe;++H){if(k=A[H].length-O[H].length)return k;if(A[H]!=O[H])return A[H]<O[H]?-1:1}return A.length-O.length}function n(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:n(E.slice(0,-1));var D=E.lastIndexOf("/");return D===-1?E:E.slice(0,D+1)}function i(E){if(E.charAt(E.length-1)=="/")return i(E.slice(0,-1));var D=E.lastIndexOf("/");return D===-1?E:E.slice(D+1)}function s(E,D){typeof D=="string"&&(D=new Date(D));var A=D.getHours();A=A<<6|D.getMinutes(),A=A<<5|D.getSeconds()>>>1,E.write_shift(2,A);var O=D.getFullYear()-1980;O=O<<4|D.getMonth()+1,O=O<<5|D.getDate(),E.write_shift(2,O)}function o(E){var D=E.read_shift(2)&65535,A=E.read_shift(2)&65535,O=new Date,H=A&31;A>>>=5;var k=A&15;A>>>=4,O.setMilliseconds(0),O.setFullYear(A+1980),O.setMonth(k-1),O.setDate(H);var oe=D&31;D>>>=5;var me=D&63;return D>>>=6,O.setHours(D),O.setMinutes(me),O.setSeconds(oe<<1),O}function a(E){yi(E,0);for(var D={},A=0;E.l<=E.length-4;){var O=E.read_shift(2),H=E.read_shift(2),k=E.l+H,oe={};switch(O){case 21589:A=E.read_shift(1),A&1&&(oe.mtime=E.read_shift(4)),H>5&&(A&2&&(oe.atime=E.read_shift(4)),A&4&&(oe.ctime=E.read_shift(4))),oe.mtime&&(oe.mt=new Date(oe.mtime*1e3));break}E.l=k,D[O]=oe}return D}var l;function u(){return l||(l={})}function c(E,D){if(E[0]==80&&E[1]==75)return _o(E,D);if((E[0]|32)==109&&(E[1]|32)==105)return Wg(E,D);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var A=3,O=512,H=0,k=0,oe=0,me=0,se=0,ae=[],he=E.slice(0,512);yi(he,0);var ce=h(he);switch(A=ce[0],A){case 3:O=512;break;case 4:O=4096;break;case 0:if(ce[1]==0)return _o(E,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+A)}O!==512&&(he=E.slice(0,O),yi(he,28));var N=E.slice(0,O);d(he,A);var ie=he.read_shift(4,"i");if(A===3&&ie!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ie);he.l+=4,oe=he.read_shift(4,"i"),he.l+=4,he.chk("00100000","Mini Stream Cutoff Size: "),me=he.read_shift(4,"i"),H=he.read_shift(4,"i"),se=he.read_shift(4,"i"),k=he.read_shift(4,"i");for(var ne=-1,Se=0;Se<109&&(ne=he.read_shift(4,"i"),!(ne<0));++Se)ae[Se]=ne;var Ge=f(E,O);w(se,k,Ge,O,ae);var gt=b(Ge,oe,ae,O);gt[oe].name="!Directory",H>0&&me!==le&&(gt[me].name="!MiniFAT"),gt[ae[0]].name="!FAT",gt.fat_addrs=ae,gt.ssz=O;var ht={},hr=[],sr=[],Ao=[];y(oe,gt,Ge,hr,H,ht,sr,me),m(sr,Ao,hr),hr.shift();var Ra={FileIndex:sr,FullPaths:Ao};return D&&D.raw&&(Ra.raw={header:N,sectors:Ge}),Ra}function h(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(xe,"Header Signature: "),E.l+=16;var D=E.read_shift(2,"u");return[E.read_shift(2,"u"),D]}function d(E,D){var A=9;switch(E.l+=2,A=E.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+A);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+A);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+A)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function f(E,D){for(var A=Math.ceil(E.length/D)-1,O=[],H=1;H<A;++H)O[H-1]=E.slice(H*D,(H+1)*D);return O[A-1]=E.slice(A*D),O}function m(E,D,A){for(var O=0,H=0,k=0,oe=0,me=0,se=A.length,ae=[],he=[];O<se;++O)ae[O]=he[O]=O,D[O]=A[O];for(;me<he.length;++me)O=he[me],H=E[O].L,k=E[O].R,oe=E[O].C,ae[O]===O&&(H!==-1&&ae[H]!==H&&(ae[O]=ae[H]),k!==-1&&ae[k]!==k&&(ae[O]=ae[k])),oe!==-1&&(ae[oe]=O),H!==-1&&O!=ae[O]&&(ae[H]=ae[O],he.lastIndexOf(H)<me&&he.push(H)),k!==-1&&O!=ae[O]&&(ae[k]=ae[O],he.lastIndexOf(k)<me&&he.push(k));for(O=1;O<se;++O)ae[O]===O&&(k!==-1&&ae[k]!==k?ae[O]=ae[k]:H!==-1&&ae[H]!==H&&(ae[O]=ae[H]));for(O=1;O<se;++O)if(E[O].type!==0){if(me=O,me!=ae[me])do me=ae[me],D[O]=D[me]+"/"+D[O];while(me!==0&&ae[me]!==-1&&me!=ae[me]);ae[O]=-1}for(D[0]+="/",O=1;O<se;++O)E[O].type!==2&&(D[O]+="/")}function g(E,D,A){for(var O=E.start,H=E.size,k=[],oe=O;A&&H>0&&oe>=0;)k.push(D.slice(oe*X,oe*X+X)),H-=X,oe=pu(A,oe*4);return k.length===0?ge(0):cn(k).slice(0,E.size)}function w(E,D,A,O,H){var k=le;if(E===le){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var oe=A[E],me=(O>>>2)-1;if(!oe)return;for(var se=0;se<me&&(k=pu(oe,se*4))!==le;++se)H.push(k);w(pu(oe,O-4),D-1,A,O,H)}}function S(E,D,A,O,H){var k=[],oe=[];H||(H=[]);var me=O-1,se=0,ae=0;for(se=D;se>=0;){H[se]=!0,k[k.length]=se,oe.push(E[se]);var he=A[Math.floor(se*4/O)];if(ae=se*4&me,O<4+ae)throw new Error("FAT boundary crossed: "+se+" 4 "+O);if(!E[he])break;se=pu(E[he],ae)}return{nodes:k,data:JO([oe])}}function b(E,D,A,O){var H=E.length,k=[],oe=[],me=[],se=[],ae=O-1,he=0,ce=0,N=0,ie=0;for(he=0;he<H;++he)if(me=[],N=he+D,N>=H&&(N-=H),!oe[N]){se=[];var ne=[];for(ce=N;ce>=0;){ne[ce]=!0,oe[ce]=!0,me[me.length]=ce,se.push(E[ce]);var Se=A[Math.floor(ce*4/O)];if(ie=ce*4&ae,O<4+ie)throw new Error("FAT boundary crossed: "+ce+" 4 "+O);if(!E[Se]||(ce=pu(E[Se],ie),ne[ce]))break}k[N]={nodes:me,data:JO([se])}}return k}function y(E,D,A,O,H,k,oe,me){for(var se=0,ae=O.length?2:0,he=D[E].data,ce=0,N=0,ie;ce<he.length;ce+=128){var ne=he.slice(ce,ce+128);yi(ne,64),N=ne.read_shift(2),ie=XE(ne,0,N-ae),O.push(ie);var Se={name:ie,type:ne.read_shift(1),color:ne.read_shift(1),L:ne.read_shift(4,"i"),R:ne.read_shift(4,"i"),C:ne.read_shift(4,"i"),clsid:ne.read_shift(16),state:ne.read_shift(4,"i"),start:0,size:0},Ge=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);Ge!==0&&(Se.ct=_(ne,ne.l-8));var gt=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);gt!==0&&(Se.mt=_(ne,ne.l-8)),Se.start=ne.read_shift(4,"i"),Se.size=ne.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=le,Se.name=""),Se.type===5?(se=Se.start,H>0&&se!==le&&(D[se].name="!StreamData")):Se.size>=4096?(Se.storage="fat",D[Se.start]===void 0&&(D[Se.start]=S(A,Se.start,D.fat_addrs,D.ssz)),D[Se.start].name=Se.name,Se.content=D[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:se!==le&&Se.start!==le&&D[se]&&(Se.content=g(Se,D[se].data,(D[me]||{}).data))),Se.content&&yi(Se.content,0),k[ie]=Se,oe.push(Se)}}function _(E,D){return new Date((xi(E,D+4)/1e7*Math.pow(2,32)+xi(E,D)/1e7-11644473600)*1e3)}function P(E,D){return u(),c(l.readFileSync(E),D)}function z(E,D){var A=D&&D.type;switch(A||Nt&&Buffer.isBuffer(E)&&(A="buffer"),A||"base64"){case"file":return P(E,D);case"base64":return c(Ss(ga(E)),D);case"binary":return c(Ss(E),D)}return c(E,D)}function I(E,D){var A=D||{},O=A.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=O+"/",E.FileIndex[0]={name:O,type:5}),A.CLSID&&(E.FileIndex[0].clsid=A.CLSID),W(E)}function W(E){var D="Sh33tJ5";if(!Xt.find(E,"/"+D)){var A=ge(4);A[0]=55,A[1]=A[3]=50,A[2]=54,E.FileIndex.push({name:D,type:2,content:A,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+D),L(E)}}function L(E,D){I(E);for(var A=!1,O=!1,H=E.FullPaths.length-1;H>=0;--H){var k=E.FileIndex[H];switch(k.type){case 0:O?A=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(k.R*k.L*k.C)&&(A=!0),k.R>-1&&k.L>-1&&k.R==k.L&&(A=!0);break;default:A=!0;break}}if(!(!A&&!D)){var oe=new Date(1987,1,19),me=0,se=Object.create?Object.create(null):{},ae=[];for(H=0;H<E.FullPaths.length;++H)se[E.FullPaths[H]]=!0,E.FileIndex[H].type!==0&&ae.push([E.FullPaths[H],E.FileIndex[H]]);for(H=0;H<ae.length;++H){var he=n(ae[H][0]);O=se[he],O||(ae.push([he,{name:i(he).replace("/",""),type:1,clsid:Ze,ct:oe,mt:oe,content:null}]),se[he]=!0)}for(ae.sort(function(ie,ne){return r(ie[0],ne[0])}),E.FullPaths=[],E.FileIndex=[],H=0;H<ae.length;++H)E.FullPaths[H]=ae[H][0],E.FileIndex[H]=ae[H][1];for(H=0;H<ae.length;++H){var ce=E.FileIndex[H],N=E.FullPaths[H];if(ce.name=i(N).replace("/",""),ce.L=ce.R=ce.C=-(ce.color=1),ce.size=ce.content?ce.content.length:0,ce.start=0,ce.clsid=ce.clsid||Ze,H===0)ce.C=ae.length>1?1:-1,ce.size=0,ce.type=5;else if(N.slice(-1)=="/"){for(me=H+1;me<ae.length&&n(E.FullPaths[me])!=N;++me);for(ce.C=me>=ae.length?-1:me,me=H+1;me<ae.length&&n(E.FullPaths[me])!=n(N);++me);ce.R=me>=ae.length?-1:me,ce.type=1}else n(E.FullPaths[H+1]||"")==n(N)&&(ce.R=H+1),ce.type=2}}}function U(E,D){var A=D||{};if(A.fileType=="mad")return Ug(E,A);switch(L(E),A.fileType){case"zip":return Tl(E,A)}var O=function(ie){for(var ne=0,Se=0,Ge=0;Ge<ie.FileIndex.length;++Ge){var gt=ie.FileIndex[Ge];if(gt.content){var ht=gt.content.length;ht>0&&(ht<4096?ne+=ht+63>>6:Se+=ht+511>>9)}}for(var hr=ie.FullPaths.length+3>>2,sr=ne+7>>3,Ao=ne+127>>7,Ra=sr+Se+hr+Ao,Ea=Ra+127>>7,Gv=Ea<=109?0:Math.ceil((Ea-109)/127);Ra+Ea+Gv+127>>7>Ea;)Gv=++Ea<=109?0:Math.ceil((Ea-109)/127);var Mo=[1,Gv,Ea,Ao,hr,Se,ne,0];return ie.FileIndex[0].size=ne<<6,Mo[7]=(ie.FileIndex[0].start=Mo[0]+Mo[1]+Mo[2]+Mo[3]+Mo[4]+Mo[5])+(Mo[6]+7>>3),Mo}(E),H=ge(O[7]<<9),k=0,oe=0;{for(k=0;k<8;++k)H.write_shift(1,be[k]);for(k=0;k<8;++k)H.write_shift(2,0);for(H.write_shift(2,62),H.write_shift(2,3),H.write_shift(2,65534),H.write_shift(2,9),H.write_shift(2,6),k=0;k<3;++k)H.write_shift(2,0);for(H.write_shift(4,0),H.write_shift(4,O[2]),H.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),H.write_shift(4,0),H.write_shift(4,4096),H.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:le),H.write_shift(4,O[3]),H.write_shift(-4,O[1]?O[0]-1:le),H.write_shift(4,O[1]),k=0;k<109;++k)H.write_shift(-4,k<O[2]?O[1]+k:-1)}if(O[1])for(oe=0;oe<O[1];++oe){for(;k<236+oe*127;++k)H.write_shift(-4,k<O[2]?O[1]+k:-1);H.write_shift(-4,oe===O[1]-1?le:oe+1)}var me=function(ie){for(oe+=ie;k<oe-1;++k)H.write_shift(-4,k+1);ie&&(++k,H.write_shift(-4,le))};for(oe=k=0,oe+=O[1];k<oe;++k)H.write_shift(-4,Le.DIFSECT);for(oe+=O[2];k<oe;++k)H.write_shift(-4,Le.FATSECT);me(O[3]),me(O[4]);for(var se=0,ae=0,he=E.FileIndex[0];se<E.FileIndex.length;++se)he=E.FileIndex[se],he.content&&(ae=he.content.length,!(ae<4096)&&(he.start=oe,me(ae+511>>9)));for(me(O[6]+7>>3);H.l&511;)H.write_shift(-4,Le.ENDOFCHAIN);for(oe=k=0,se=0;se<E.FileIndex.length;++se)he=E.FileIndex[se],he.content&&(ae=he.content.length,!(!ae||ae>=4096)&&(he.start=oe,me(ae+63>>6)));for(;H.l&511;)H.write_shift(-4,Le.ENDOFCHAIN);for(k=0;k<O[4]<<2;++k){var ce=E.FullPaths[k];if(!ce||ce.length===0){for(se=0;se<17;++se)H.write_shift(4,0);for(se=0;se<3;++se)H.write_shift(4,-1);for(se=0;se<12;++se)H.write_shift(4,0);continue}he=E.FileIndex[k],k===0&&(he.start=he.size?he.start-1:le);var N=k===0&&A.root||he.name;if(ae=2*(N.length+1),H.write_shift(64,N,"utf16le"),H.write_shift(2,ae),H.write_shift(1,he.type),H.write_shift(1,he.color),H.write_shift(-4,he.L),H.write_shift(-4,he.R),H.write_shift(-4,he.C),he.clsid)H.write_shift(16,he.clsid,"hex");else for(se=0;se<4;++se)H.write_shift(4,0);H.write_shift(4,he.state||0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,0),H.write_shift(4,he.start),H.write_shift(4,he.size),H.write_shift(4,0)}for(k=1;k<E.FileIndex.length;++k)if(he=E.FileIndex[k],he.size>=4096)if(H.l=he.start+1<<9,Nt&&Buffer.isBuffer(he.content))he.content.copy(H,H.l,0,he.size),H.l+=he.size+511&-512;else{for(se=0;se<he.size;++se)H.write_shift(1,he.content[se]);for(;se&511;++se)H.write_shift(1,0)}for(k=1;k<E.FileIndex.length;++k)if(he=E.FileIndex[k],he.size>0&&he.size<4096)if(Nt&&Buffer.isBuffer(he.content))he.content.copy(H,H.l,0,he.size),H.l+=he.size+63&-64;else{for(se=0;se<he.size;++se)H.write_shift(1,he.content[se]);for(;se&63;++se)H.write_shift(1,0)}if(Nt)H.l=H.length;else for(;H.l<H.length;)H.write_shift(1,0);return H}function G(E,D){var A=E.FullPaths.map(function(se){return se.toUpperCase()}),O=A.map(function(se){var ae=se.split("/");return ae[ae.length-(se.slice(-1)=="/"?2:1)]}),H=!1;D.charCodeAt(0)===47?(H=!0,D=A[0].slice(0,-1)+D):H=D.indexOf("/")!==-1;var k=D.toUpperCase(),oe=H===!0?A.indexOf(k):O.indexOf(k);if(oe!==-1)return E.FileIndex[oe];var me=!k.match(Hp);for(k=k.replace(Rf,""),me&&(k=k.replace(Hp,"!")),oe=0;oe<A.length;++oe)if((me?A[oe].replace(Hp,"!"):A[oe]).replace(Rf,"")==k||(me?O[oe].replace(Hp,"!"):O[oe]).replace(Rf,"")==k)return E.FileIndex[oe];return null}var X=64,le=-2,xe="d0cf11e0a1b11ae1",be=[208,207,17,224,161,177,26,225],Ze="00000000000000000000000000000000",Le={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:le,FREESECT:-1,HEADER_SIGNATURE:xe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ze,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Ne(E,D,A){u();var O=U(E,A);l.writeFileSync(D,O)}function Me(E){for(var D=new Array(E.length),A=0;A<E.length;++A)D[A]=String.fromCharCode(E[A]);return D.join("")}function at(E,D){var A=U(E,D);switch(D&&D.type||"buffer"){case"file":return u(),l.writeFileSync(D.filename,A),A;case"binary":return typeof A=="string"?A:Me(A);case"base64":return Qf(typeof A=="string"?A:Me(A));case"buffer":if(Nt)return Buffer.isBuffer(A)?A:ba(A);case"array":return typeof A=="string"?Ss(A):A}return A}var v;function p(E){try{var D=E.InflateRaw,A=new D;if(A._processChunk(new Uint8Array([3,0]),A._finishFlushFlag),A.bytesRead)v=E;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function C(E,D){if(!v)return yt(E,D);var A=v.InflateRaw,O=new A,H=O._processChunk(E.slice(E.l),O._finishFlushFlag);return E.l+=O.bytesRead,H}function x(E){return v?v.deflateRawSync(E):ue(E)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],q=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function re(E){var D=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(D>>16|D>>8|D)&255}for(var fe=typeof Uint8Array<"u",de=fe?new Uint8Array(256):[],pe=0;pe<256;++pe)de[pe]=re(pe);function Oe(E,D){var A=de[E&255];return D<=8?A>>>8-D:(A=A<<8|de[E>>8&255],D<=16?A>>>16-D:(A=A<<8|de[E>>16&255],A>>>24-D))}function Be(E,D){var A=D&7,O=D>>>3;return(E[O]|(A<=6?0:E[O+1]<<8))>>>A&3}function ee(E,D){var A=D&7,O=D>>>3;return(E[O]|(A<=5?0:E[O+1]<<8))>>>A&7}function et(E,D){var A=D&7,O=D>>>3;return(E[O]|(A<=4?0:E[O+1]<<8))>>>A&15}function je(E,D){var A=D&7,O=D>>>3;return(E[O]|(A<=3?0:E[O+1]<<8))>>>A&31}function ye(E,D){var A=D&7,O=D>>>3;return(E[O]|(A<=1?0:E[O+1]<<8))>>>A&127}function Xe(E,D,A){var O=D&7,H=D>>>3,k=(1<<A)-1,oe=E[H]>>>O;return A<8-O||(oe|=E[H+1]<<8-O,A<16-O)||(oe|=E[H+2]<<16-O,A<24-O)||(oe|=E[H+3]<<24-O),oe&k}function Ve(E,D,A){var O=D&7,H=D>>>3;return O<=5?E[H]|=(A&7)<<O:(E[H]|=A<<O&255,E[H+1]=(A&7)>>8-O),D+3}function T(E,D,A){var O=D&7,H=D>>>3;return A=(A&1)<<O,E[H]|=A,D+1}function M(E,D,A){var O=D&7,H=D>>>3;return A<<=O,E[H]|=A&255,A>>>=8,E[H+1]=A,D+8}function B(E,D,A){var O=D&7,H=D>>>3;return A<<=O,E[H]|=A&255,A>>>=8,E[H+1]=A&255,E[H+2]=A>>>8,D+16}function Q(E,D){var A=E.length,O=2*A>D?2*A:D+5,H=0;if(A>=D)return E;if(Nt){var k=FO(O);if(E.copy)E.copy(k);else for(;H<E.length;++H)k[H]=E[H];return k}else if(fe){var oe=new Uint8Array(O);if(oe.set)oe.set(E);else for(;H<A;++H)oe[H]=E[H];return oe}return E.length=O,E}function j(E){for(var D=new Array(E),A=0;A<E;++A)D[A]=0;return D}function te(E,D,A){var O=1,H=0,k=0,oe=0,me=0,se=E.length,ae=fe?new Uint16Array(32):j(32);for(k=0;k<32;++k)ae[k]=0;for(k=se;k<A;++k)E[k]=0;se=E.length;var he=fe?new Uint16Array(se):j(se);for(k=0;k<se;++k)ae[H=E[k]]++,O<H&&(O=H),he[k]=0;for(ae[0]=0,k=1;k<=O;++k)ae[k+16]=me=me+ae[k-1]<<1;for(k=0;k<se;++k)me=E[k],me!=0&&(he[k]=ae[me+16]++);var ce=0;for(k=0;k<se;++k)if(ce=E[k],ce!=0)for(me=Oe(he[k],O)>>O-ce,oe=(1<<O+4-ce)-1;oe>=0;--oe)D[me|oe<<ce]=ce&15|k<<4;return O}var K=fe?new Uint16Array(512):j(512),Y=fe?new Uint16Array(32):j(32);if(!fe){for(var Z=0;Z<512;++Z)K[Z]=0;for(Z=0;Z<32;++Z)Y[Z]=0}(function(){for(var E=[],D=0;D<32;D++)E.push(5);te(E,Y,32);var A=[];for(D=0;D<=143;D++)A.push(8);for(;D<=255;D++)A.push(9);for(;D<=279;D++)A.push(7);for(;D<=287;D++)A.push(8);te(A,K,288)})();var J=function(){for(var D=fe?new Uint8Array(32768):[],A=0,O=0;A<q.length-1;++A)for(;O<q[A+1];++O)D[O]=A;for(;O<32768;++O)D[O]=29;var H=fe?new Uint8Array(259):[];for(A=0,O=0;A<F.length-1;++A)for(;O<F[A+1];++O)H[O]=A;function k(me,se){for(var ae=0;ae<me.length;){var he=Math.min(65535,me.length-ae),ce=ae+he==me.length;for(se.write_shift(1,+ce),se.write_shift(2,he),se.write_shift(2,~he&65535);he-- >0;)se[se.l++]=me[ae++]}return se.l}function oe(me,se){for(var ae=0,he=0,ce=fe?new Uint16Array(32768):[];he<me.length;){var N=Math.min(65535,me.length-he);if(N<10){for(ae=Ve(se,ae,+(he+N==me.length)),ae&7&&(ae+=8-(ae&7)),se.l=ae/8|0,se.write_shift(2,N),se.write_shift(2,~N&65535);N-- >0;)se[se.l++]=me[he++];ae=se.l*8;continue}ae=Ve(se,ae,+(he+N==me.length)+2);for(var ie=0;N-- >0;){var ne=me[he];ie=(ie<<5^ne)&32767;var Se=-1,Ge=0;if((Se=ce[ie])&&(Se|=he&-32768,Se>he&&(Se-=32768),Se<he))for(;me[Se+Ge]==me[he+Ge]&&Ge<250;)++Ge;if(Ge>2){ne=H[Ge],ne<=22?ae=M(se,ae,de[ne+1]>>1)-1:(M(se,ae,3),ae+=5,M(se,ae,de[ne-23]>>5),ae+=3);var gt=ne<8?0:ne-4>>2;gt>0&&(B(se,ae,Ge-F[ne]),ae+=gt),ne=D[he-Se],ae=M(se,ae,de[ne]>>3),ae-=3;var ht=ne<4?0:ne-2>>1;ht>0&&(B(se,ae,he-Se-q[ne]),ae+=ht);for(var hr=0;hr<Ge;++hr)ce[ie]=he&32767,ie=(ie<<5^me[he])&32767,++he;N-=Ge-1}else ne<=143?ne=ne+48:ae=T(se,ae,1),ae=M(se,ae,de[ne]),ce[ie]=he&32767,++he}ae=M(se,ae,0)-1}return se.l=(ae+7)/8|0,se.l}return function(se,ae){return se.length<8?k(se,ae):oe(se,ae)}}();function ue(E){var D=ge(50+Math.floor(E.length*1.1)),A=J(E,D);return D.slice(0,A)}var Ee=fe?new Uint16Array(32768):j(32768),De=fe?new Uint16Array(32768):j(32768),Ye=fe?new Uint16Array(128):j(128),nt=1,vt=1;function lt(E,D){var A=je(E,D)+257;D+=5;var O=je(E,D)+1;D+=5;var H=et(E,D)+4;D+=4;for(var k=0,oe=fe?new Uint8Array(19):j(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],se=1,ae=fe?new Uint8Array(8):j(8),he=fe?new Uint8Array(8):j(8),ce=oe.length,N=0;N<H;++N)oe[R[N]]=k=ee(E,D),se<k&&(se=k),ae[k]++,D+=3;var ie=0;for(ae[0]=0,N=1;N<=se;++N)he[N]=ie=ie+ae[N-1]<<1;for(N=0;N<ce;++N)(ie=oe[N])!=0&&(me[N]=he[ie]++);var ne=0;for(N=0;N<ce;++N)if(ne=oe[N],ne!=0){ie=de[me[N]]>>8-ne;for(var Se=(1<<7-ne)-1;Se>=0;--Se)Ye[ie|Se<<ne]=ne&7|N<<3}var Ge=[];for(se=1;Ge.length<A+O;)switch(ie=Ye[ye(E,D)],D+=ie&7,ie>>>=3){case 16:for(k=3+Be(E,D),D+=2,ie=Ge[Ge.length-1];k-- >0;)Ge.push(ie);break;case 17:for(k=3+ee(E,D),D+=3;k-- >0;)Ge.push(0);break;case 18:for(k=11+ye(E,D),D+=7;k-- >0;)Ge.push(0);break;default:Ge.push(ie),se<ie&&(se=ie);break}var gt=Ge.slice(0,A),ht=Ge.slice(A);for(N=A;N<286;++N)gt[N]=0;for(N=O;N<30;++N)ht[N]=0;return nt=te(gt,Ee,286),vt=te(ht,De,30),D}function Je(E,D){if(E[0]==3&&!(E[1]&3))return[Fu(D),2];for(var A=0,O=0,H=FO(D||1<<18),k=0,oe=H.length>>>0,me=0,se=0;!(O&1);){if(O=ee(E,A),A+=3,O>>>1)O>>1==1?(me=9,se=5):(A=lt(E,A),me=nt,se=vt);else{A&7&&(A+=8-(A&7));var ae=E[A>>>3]|E[(A>>>3)+1]<<8;if(A+=32,ae>0)for(!D&&oe<k+ae&&(H=Q(H,k+ae),oe=H.length);ae-- >0;)H[k++]=E[A>>>3],A+=8;continue}for(;;){!D&&oe<k+32767&&(H=Q(H,k+32767),oe=H.length);var he=Xe(E,A,me),ce=O>>>1==1?K[he]:Ee[he];if(A+=ce&15,ce>>>=4,!(ce>>>8&255))H[k++]=ce;else{if(ce==256)break;ce-=257;var N=ce<8?0:ce-4>>2;N>5&&(N=0);var ie=k+F[ce];N>0&&(ie+=Xe(E,A,N),A+=N),he=Xe(E,A,se),ce=O>>>1==1?Y[he]:De[he],A+=ce&15,ce>>>=4;var ne=ce<4?0:ce-2>>1,Se=q[ce];for(ne>0&&(Se+=Xe(E,A,ne),A+=ne),!D&&oe<ie&&(H=Q(H,ie+100),oe=H.length);k<ie;)H[k]=H[k-Se],++k}}}return D?[H,A+7>>>3]:[H.slice(0,k),A+7>>>3]}function yt(E,D){var A=E.slice(E.l||0),O=Je(A,D);return E.l+=O[1],O[0]}function rr(E,D){if(E)typeof console<"u"&&console.error(D);else throw new Error(D)}function _o(E,D){var A=E;yi(A,0);var O=[],H=[],k={FileIndex:O,FullPaths:H};I(k,{root:D.root});for(var oe=A.length-4;(A[oe]!=80||A[oe+1]!=75||A[oe+2]!=5||A[oe+3]!=6)&&oe>=0;)--oe;A.l=oe+4,A.l+=4;var me=A.read_shift(2);A.l+=6;var se=A.read_shift(4);for(A.l=se,oe=0;oe<me;++oe){A.l+=20;var ae=A.read_shift(4),he=A.read_shift(4),ce=A.read_shift(2),N=A.read_shift(2),ie=A.read_shift(2);A.l+=8;var ne=A.read_shift(4),Se=a(A.slice(A.l+ce,A.l+ce+N));A.l+=ce+N+ie;var Ge=A.l;A.l=ne+4,li(A,ae,he,k,Se),A.l=Ge}return k}function li(E,D,A,O,H){E.l+=2;var k=E.read_shift(2),oe=E.read_shift(2),me=o(E);if(k&8257)throw new Error("Unsupported ZIP encryption");for(var se=E.read_shift(4),ae=E.read_shift(4),he=E.read_shift(4),ce=E.read_shift(2),N=E.read_shift(2),ie="",ne=0;ne<ce;++ne)ie+=String.fromCharCode(E[E.l++]);if(N){var Se=a(E.slice(E.l,E.l+N));(Se[21589]||{}).mt&&(me=Se[21589].mt),((H||{})[21589]||{}).mt&&(me=H[21589].mt)}E.l+=N;var Ge=E.slice(E.l,E.l+ae);switch(oe){case 8:Ge=C(E,he);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+oe)}var gt=!1;k&8&&(se=E.read_shift(4),se==134695760&&(se=E.read_shift(4),gt=!0),ae=E.read_shift(4),he=E.read_shift(4)),ae!=D&&rr(gt,"Bad compressed size: "+D+" != "+ae),he!=A&&rr(gt,"Bad uncompressed size: "+A+" != "+he),xa(O,ie,Ge,{unsafe:!0,mt:me})}function Tl(E,D){var A=D||{},O=[],H=[],k=ge(1),oe=A.compression?8:0,me=0,se=0,ae=0,he=0,ce=0,N=E.FullPaths[0],ie=N,ne=E.FileIndex[0],Se=[],Ge=0;for(se=1;se<E.FullPaths.length;++se)if(ie=E.FullPaths[se].slice(N.length),ne=E.FileIndex[se],!(!ne.size||!ne.content||ie=="Sh33tJ5")){var gt=he,ht=ge(ie.length);for(ae=0;ae<ie.length;++ae)ht.write_shift(1,ie.charCodeAt(ae)&127);ht=ht.slice(0,ht.l),Se[ce]=Dge.buf(ne.content,0);var hr=ne.content;oe==8&&(hr=x(hr)),k=ge(30),k.write_shift(4,67324752),k.write_shift(2,20),k.write_shift(2,me),k.write_shift(2,oe),ne.mt?s(k,ne.mt):k.write_shift(4,0),k.write_shift(-4,Se[ce]),k.write_shift(4,hr.length),k.write_shift(4,ne.content.length),k.write_shift(2,ht.length),k.write_shift(2,0),he+=k.length,O.push(k),he+=ht.length,O.push(ht),he+=hr.length,O.push(hr),k=ge(46),k.write_shift(4,33639248),k.write_shift(2,0),k.write_shift(2,20),k.write_shift(2,me),k.write_shift(2,oe),k.write_shift(4,0),k.write_shift(-4,Se[ce]),k.write_shift(4,hr.length),k.write_shift(4,ne.content.length),k.write_shift(2,ht.length),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(4,0),k.write_shift(4,gt),Ge+=k.l,H.push(k),Ge+=ht.length,H.push(ht),++ce}return k=ge(22),k.write_shift(4,101010256),k.write_shift(2,0),k.write_shift(2,0),k.write_shift(2,ce),k.write_shift(2,ce),k.write_shift(4,Ge),k.write_shift(4,he),k.write_shift(2,0),cn([cn(O),cn(H),k])}var on={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function nr(E,D){if(E.ctype)return E.ctype;var A=E.name||"",O=A.match(/\.([^\.]+)$/);return O&&on[O[1]]||D&&(O=(A=D).match(/[\.\\]([^\.\\])+$/),O&&on[O[1]])?on[O[1]]:"application/octet-stream"}function Or(E){for(var D=Qf(E),A=[],O=0;O<D.length;O+=76)A.push(D.slice(O,O+76));return A.join(`\r
`)+`\r
`}function Wr(E){var D=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ae){var he=ae.charCodeAt(0).toString(16).toUpperCase();return"="+(he.length==1?"0"+he:he)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var A=[],O=D.split(`\r
`),H=0;H<O.length;++H){var k=O[H];if(k.length==0){A.push("");continue}for(var oe=0;oe<k.length;){var me=76,se=k.slice(oe,oe+me);se.charAt(me-1)=="="?me--:se.charAt(me-2)=="="?me-=2:se.charAt(me-3)=="="&&(me-=3),se=k.slice(oe,oe+me),oe+=me,oe<k.length&&(se+="="),A.push(se)}}return A.join(`\r
`)}function Zt(E){for(var D=[],A=0;A<E.length;++A){for(var O=E[A];A<=E.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+E[++A];D.push(O)}for(var H=0;H<D.length;++H)D[H]=D[H].replace(/[=][0-9A-Fa-f]{2}/g,function(k){return String.fromCharCode(parseInt(k.slice(1),16))});return Ss(D.join(`\r
`))}function Lh(E,D,A){for(var O="",H="",k="",oe,me=0;me<10;++me){var se=D[me];if(!se||se.match(/^\s*$/))break;var ae=se.match(/^(.*?):\s*([^\s].*)$/);if(ae)switch(ae[1].toLowerCase()){case"content-location":O=ae[2].trim();break;case"content-type":k=ae[2].trim();break;case"content-transfer-encoding":H=ae[2].trim();break}}switch(++me,H.toLowerCase()){case"base64":oe=Ss(ga(D.slice(me).join("")));break;case"quoted-printable":oe=Zt(D.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+H)}var he=xa(E,O.slice(A.length),oe,{unsafe:!0});k&&(he.ctype=k)}function Wg(E,D){if(Me(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var A=D&&D.root||"",O=(Nt&&Buffer.isBuffer(E)?E.toString("binary"):Me(E)).split(`\r
`),H=0,k="";for(H=0;H<O.length;++H)if(k=O[H],!!/^Content-Location:/i.test(k)&&(k=k.slice(k.indexOf("file")),A||(A=k.slice(0,k.lastIndexOf("/")+1)),k.slice(0,A.length)!=A))for(;A.length>0&&(A=A.slice(0,A.length-1),A=A.slice(0,A.lastIndexOf("/")+1),k.slice(0,A.length)!=A););var oe=(O[1]||"").match(/boundary="(.*?)"/);if(!oe)throw new Error("MAD cannot find boundary");var me="--"+(oe[1]||""),se=[],ae=[],he={FileIndex:se,FullPaths:ae};I(he);var ce,N=0;for(H=0;H<O.length;++H){var ie=O[H];ie!==me&&ie!==me+"--"||(N++&&Lh(he,O.slice(ce,H),A),ce=H)}return he}function Ug(E,D){var A=D||{},O=A.boundary||"SheetJS";O="------="+O;for(var H=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],k=E.FullPaths[0],oe=k,me=E.FileIndex[0],se=1;se<E.FullPaths.length;++se)if(oe=E.FullPaths[se].slice(k.length),me=E.FileIndex[se],!(!me.size||!me.content||oe=="Sh33tJ5")){oe=oe.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var ae=me.content,he=Nt&&Buffer.isBuffer(ae)?ae.toString("binary"):Me(ae),ce=0,N=Math.min(1024,he.length),ie=0,ne=0;ne<=N;++ne)(ie=he.charCodeAt(ne))>=32&&ie<128&&++ce;var Se=ce>=N*4/5;H.push(O),H.push("Content-Location: "+(A.root||"file:///C:/SheetJS/")+oe),H.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),H.push("Content-Type: "+nr(me,oe)),H.push(""),H.push(Se?Wr(he):Or(he))}return H.push(O+`--\r
`),H.join(`\r
`)}function zv(E){var D={};return I(D,E),D}function xa(E,D,A,O){var H=O&&O.unsafe;H||I(E);var k=!H&&Xt.find(E,D);if(!k){var oe=E.FullPaths[0];D.slice(0,oe.length)==oe?oe=D:(oe.slice(-1)!="/"&&(oe+="/"),oe=(oe+D).replace("//","/")),k={name:i(D),type:2},E.FileIndex.push(k),E.FullPaths.push(oe),H||Xt.utils.cfb_gc(E)}return k.content=A,k.size=A?A.length:0,O&&(O.CLSID&&(k.clsid=O.CLSID),O.mt&&(k.mt=O.mt),O.ct&&(k.ct=O.ct)),k}function $h(E,D){I(E);var A=Xt.find(E,D);if(A){for(var O=0;O<E.FileIndex.length;++O)if(E.FileIndex[O]==A)return E.FileIndex.splice(O,1),E.FullPaths.splice(O,1),!0}return!1}function Yv(E,D,A){I(E);var O=Xt.find(E,D);if(O){for(var H=0;H<E.FileIndex.length;++H)if(E.FileIndex[H]==O)return E.FileIndex[H].name=i(A),E.FullPaths[H]=A,!0}return!1}function Un(E){L(E,!0)}return e.find=G,e.read=z,e.parse=c,e.write=at,e.writeFile=Ne,e.utils={cfb_new:zv,cfb_add:xa,cfb_del:$h,cfb_mov:Yv,cfb_gc:Un,ReadShift:Tf,CheckField:qk,prep_blob:yi,bconcat:cn,use_zlib:p,_deflateRaw:ue,_inflateRaw:yt,consts:Le},e}();function Hge(t){return typeof t=="string"?Fv(t):Array.isArray(t)?age(t):t}function Fg(t,e,r){if(typeof Deno<"u"){if(r&&typeof e=="string")switch(r){case"utf8":e=new TextEncoder(r).encode(e);break;case"binary":e=Fv(e);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(t,e)}var n=r=="utf8"?tg(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,t);if(typeof Blob<"u"){var i=new Blob([Hge(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,t);if(typeof saveAs<"u")return saveAs(i,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(t);return a.open("w"),a.encoding="binary",Array.isArray(e)&&(e=kg(e)),a.write(e),a.close(),e}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+t)}function fn(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)Object.prototype.hasOwnProperty.call(t,e[n])&&r.push(e[n]);return r}function zO(t,e){for(var r=[],n=fn(t),i=0;i!==n.length;++i)r[t[n[i]][e]]==null&&(r[t[n[i]][e]]=n[i]);return r}function zE(t){for(var e=[],r=fn(t),n=0;n!==r.length;++n)e[t[r[n]]]=r[n];return e}function Bv(t){for(var e=[],r=fn(t),n=0;n!==r.length;++n)e[t[r[n]]]=parseInt(r[n],10);return e}function kge(t){for(var e=[],r=fn(t),n=0;n!==r.length;++n)e[t[r[n]]]==null&&(e[t[r[n]]]=[]),e[t[r[n]]].push(r[n]);return e}var Sw=new Date(1899,11,30,0,0,0);function si(t,e){var r=t.getTime(),n=Sw.getTime()+(t.getTimezoneOffset()-Sw.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Nk=new Date,Fge=Sw.getTime()+(Nk.getTimezoneOffset()-Sw.getTimezoneOffset())*6e4,YO=Nk.getTimezoneOffset();function Dk(t){var e=new Date;return e.setTime(t*24*60*60*1e3+Fge),e.getTimezoneOffset()!==YO&&e.setTime(e.getTime()+(e.getTimezoneOffset()-YO)*6e4),e}var GO=new Date("2017-02-19T19:06:09.000Z"),Hk=isNaN(GO.getFullYear())?new Date("2/19/17"):GO,Lge=Hk.getFullYear()==2017;function Bn(t,e){var r=new Date(t);if(Lge)return e>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):e<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(t instanceof Date)return t;if(Hk.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return t.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=t.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Vv(t,e){if(Nt&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var r={"â¬":"Â","â":"Â",Æ:"Â","â":"Â","â¦":"Â","â ":"Â","â¡":"Â","Ë":"Â","â°":"Â",Å :"Â","â¹":"Â",Å:"Â",Å½:"Â","â":"Â","â":"Â","â":"Â","â":"Â","â¢":"Â","â":"Â","â":"Â","Ë":"Â","â¢":"Â",Å¡:"Â","âº":"Â",Å:"Â",Å¾:"Â",Å¸:"Â"};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[â¬âÆââ¦â â¡Ëâ°Å â¹ÅÅ½âââââ¢ââËâ¢Å¡âºÅÅ¾Å¸]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=t.length;++i)n.push(String.fromCharCode(t[i]));return n.join("")}function oi(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=oi(t[r]));return e}function _r(t,e){for(var r="";r.length<e;)r+=t;return r}function la(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var r=1,n=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(e=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(e=Number(n)))?e/r:e}var $ge=["january","february","march","april","may","june","july","august","september","october","november","december"];function eg(t){var e=new Date(t),r=new Date(NaN),n=e.getYear(),i=e.getMonth(),s=e.getDate();if(isNaN(s))return r;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&$ge.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?e:t.match(/[^-0-9:,\/\\]/)?r:e}function wt(t,e,r){if(t.FullPaths){if(typeof r=="string"){var n;return Nt?n=ba(r):n=lge(r),Xt.utils.cfb_add(t,e,n)}Xt.utils.cfb_add(t,e,r)}else t.file(e,r)}function YE(){return Xt.utils.cfb_new()}var Vr=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Bge={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},GE=zE(Bge),KE=/[&<>'"]/g,Vge=/[\u0000-\u0008\u000b-\u001f]/g;function jt(t){var e=t+"";return e.replace(KE,function(r){return GE[r]}).replace(Vge,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function KO(t){return jt(t).replace(/ /g,"_x0020_")}var kk=/[\u0000-\u001f]/g;function Wge(t){var e=t+"";return e.replace(KE,function(r){return GE[r]}).replace(/\n/g,"<br/>").replace(kk,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Uge(t){var e=t+"";return e.replace(KE,function(r){return GE[r]}).replace(kk,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function jge(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function zge(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Ty(t){for(var e="",r=0,n=0,i=0,s=0,o=0,a=0;r<t.length;){if(n=t.charCodeAt(r++),n<128){e+=String.fromCharCode(n);continue}if(i=t.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,e+=String.fromCharCode(o);continue}if(s=t.charCodeAt(r++),n<240){e+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=t.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,e+=String.fromCharCode(55296+(a>>>10&1023)),e+=String.fromCharCode(56320+(a&1023))}return e}function XO(t){var e=Fu(2*t.length),r,n,i=1,s=0,o=0,a;for(n=0;n<t.length;n+=i)i=1,(a=t.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(t.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(t.charCodeAt(n+1)&63)*64+(t.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(t.charCodeAt(n+1)&63)*4096+(t.charCodeAt(n+2)&63)*64+(t.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(e[s++]=o&255,e[s++]=o>>>8,o=0),e[s++]=r%256,e[s++]=r>>>8;return e.slice(0,s).toString("ucs2")}function qO(t){return ba(t,"binary").toString("utf8")}var Fp="foo bar bazÃ¢ÂÂÃ°ÂÂÂ£",Ef=Nt&&(qO(Fp)==Ty(Fp)&&qO||XO(Fp)==Ty(Fp)&&XO)||Ty,tg=Nt?function(t){return ba(t,"utf8").toString("binary")}:function(t){for(var e=[],r=0,n=0,i=0;r<t.length;)switch(n=t.charCodeAt(r++),!0){case n<128:e.push(String.fromCharCode(n));break;case n<2048:e.push(String.fromCharCode(192+(n>>6))),e.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=t.charCodeAt(r++)-56320+(n<<10),e.push(String.fromCharCode(240+(i>>18&7))),e.push(String.fromCharCode(144+(i>>12&63))),e.push(String.fromCharCode(128+(i>>6&63))),e.push(String.fromCharCode(128+(i&63)));break;default:e.push(String.fromCharCode(224+(n>>12))),e.push(String.fromCharCode(128+(n>>6&63))),e.push(String.fromCharCode(128+(n&63)))}return e.join("")},Yge=function(){var t=[["nbsp"," "],["middot","Â·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<t.length;++i)n=n.replace(t[i][0],t[i][1]);return n}}(),Fk=/(^\s|\s$|\n)/;function hn(t,e){return"<"+t+(e.match(Fk)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function rg(t){return fn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Te(t,e,r){return"<"+t+(r!=null?rg(r):"")+(e!=null?(e.match(Fk)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Q1(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(r){if(e)throw r}return""}function Gge(t,e){switch(typeof t){case"string":var r=Te("vt:lpwstr",jt(t));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Te((t|0)==t?"vt:i4":"vt:r8",jt(String(t)));case"boolean":return Te("vt:bool",t?"true":"false")}if(t instanceof Date)return Te("vt:filetime",Q1(t));throw new Error("Unable to serialize "+t)}var rn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Dh=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],bi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Kge(t,e){for(var r=1-2*(t[e+7]>>>7),n=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),i=t[e+6]&15,s=5;s>=0;--s)i=i*256+t[e+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function Xge(t,e,r){var n=(e<0||1/e==-1/0?1:0)<<7,i=0,s=0,o=n?-e:e;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(e)?26985:0);for(var a=0;a<=5;++a,s/=256)t[r+a]=s&255;t[r+6]=(i&15)<<4|s&15,t[r+7]=i>>4|n}var ZO=function(t){for(var e=[],r=10240,n=0;n<t[0].length;++n)if(t[0][n])for(var i=0,s=t[0][n].length;i<s;i+=r)e.push.apply(e,t[0][n].slice(i,i+r));return e},JO=Nt?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:ba(e)})):ZO(t)}:ZO,QO=function(t,e,r){for(var n=[],i=e;i<r;i+=2)n.push(String.fromCharCode(qd(t,i)));return n.join("").replace(Rf,"")},XE=Nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("utf16le",e,r).replace(Rf,""):QO(t,e,r)}:QO,eI=function(t,e,r){for(var n=[],i=e;i<e+r;++i)n.push(("0"+t[i].toString(16)).slice(-2));return n.join("")},Lk=Nt?function(t,e,r){return Buffer.isBuffer(t)?t.toString("hex",e,e+r):eI(t,e,r)}:eI,tI=function(t,e,r){for(var n=[],i=e;i<r;i++)n.push(String.fromCharCode(Xc(t,i)));return n.join("")},Lg=Nt?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf8",r,n):tI(e,r,n)}:tI,$k=function(t,e){var r=xi(t,e);return r>0?Lg(t,e+4,e+4+r-1):""},Bk=$k,Vk=function(t,e){var r=xi(t,e);return r>0?Lg(t,e+4,e+4+r-1):""},Wk=Vk,Uk=function(t,e){var r=2*xi(t,e);return r>0?Lg(t,e+4,e+4+r-1):""},jk=Uk,zk=function(e,r){var n=xi(e,r);return n>0?XE(e,r+4,r+4+n):""},Yk=zk,Gk=function(t,e){var r=xi(t,e);return r>0?Lg(t,e+4,e+4+r):""},Kk=Gk,Xk=function(t,e){return Kge(t,e)},yw=Xk,qE=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};Nt&&(Bk=function(e,r){if(!Buffer.isBuffer(e))return $k(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},Wk=function(e,r){if(!Buffer.isBuffer(e))return Vk(e,r);var n=e.readUInt32LE(r);return n>0?e.toString("utf8",r+4,r+4+n-1):""},jk=function(e,r){if(!Buffer.isBuffer(e))return Uk(e,r);var n=2*e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n-1)},Yk=function(e,r){if(!Buffer.isBuffer(e))return zk(e,r);var n=e.readUInt32LE(r);return e.toString("utf16le",r+4,r+4+n)},Kk=function(e,r){if(!Buffer.isBuffer(e))return Gk(e,r);var n=e.readUInt32LE(r);return e.toString("utf8",r+4,r+4+n)},yw=function(e,r){return Buffer.isBuffer(e)?e.readDoubleLE(r):Xk(e,r)},qE=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Xc=function(t,e){return t[e]},qd=function(t,e){return t[e+1]*256+t[e]},qge=function(t,e){var r=t[e+1]*256+t[e];return r<32768?r:(65535-r+1)*-1},xi=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},pu=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},Zge=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Tf(t,e){var r="",n,i,s=[],o,a,l,u;switch(e){case"dbcs":if(u=this.l,Nt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*t).toString("utf16le");else for(l=0;l<t;++l)r+=String.fromCharCode(qd(this,u)),u+=2;t*=2;break;case"utf8":r=Lg(this,this.l,this.l+t);break;case"utf16le":t*=2,r=XE(this,this.l,this.l+t);break;case"wstr":return Tf.call(this,t,"dbcs");case"lpstr-ansi":r=Bk(this,this.l),t=4+xi(this,this.l);break;case"lpstr-cp":r=Wk(this,this.l),t=4+xi(this,this.l);break;case"lpwstr":r=jk(this,this.l),t=4+2*xi(this,this.l);break;case"lpp4":t=4+xi(this,this.l),r=Yk(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+xi(this,this.l),r=Kk(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,r="";(o=Xc(this,this.l+t++))!==0;)s.push(Dp(o));r=s.join("");break;case"_wstr":for(t=0,r="";(o=qd(this,this.l+t))!==0;)s.push(Dp(o)),t+=2;t+=2,r=s.join("");break;case"dbcs-cont":for(r="",u=this.l,l=0;l<t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Xc(this,u),this.l=u+1,a=Tf.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Dp(qd(this,u))),u+=2}r=s.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,l=0;l!=t;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return o=Xc(this,u),this.l=u+1,a=Tf.call(this,t-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Dp(Xc(this,u))),u+=1}r=s.join("");break;default:switch(t){case 1:return n=Xc(this,this.l),this.l++,n;case 2:return n=(e==="i"?qge:qd)(this,this.l),this.l+=2,n;case 4:case-4:return e==="i"||!(this[this.l+3]&128)?(n=(t>0?pu:Zge)(this,this.l),this.l+=4,n):(i=xi(this,this.l),this.l+=4,i);case 8:case-8:if(e==="f")return t==8?i=yw(this,this.l):i=yw([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;t=8;case 16:r=Lk(this,this.l,t);break}}return this.l+=t,r}var Jge=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24&255},Qge=function(t,e,r){t[r]=e&255,t[r+1]=e>>8&255,t[r+2]=e>>16&255,t[r+3]=e>>24&255},eme=function(t,e,r){t[r]=e&255,t[r+1]=e>>>8&255};function tme(t,e,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=e.length;++i)eme(this,e.charCodeAt(i),this.l+2*i);n=2*e.length}else if(r==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=e.length;++i)this[this.l+i]=e.charCodeAt(i)&255;n=e.length}else if(r==="hex"){for(;i<t;++i)this[this.l++]=parseInt(e.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+t,this.length);for(i=0;i<Math.min(e.length,t);++i){var o=e.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(t){case 1:n=1,this[this.l]=e&255;break;case 2:n=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:n=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:n=4,Jge(this,e,this.l);break;case 8:if(n=8,r==="f"){Xge(this,e,this.l);break}case 16:break;case-4:n=4,Qge(this,e,this.l);break}return this.l+=n,this}function qk(t,e){var r=Lk(this,this.l,t.length>>1);if(r!==t)throw new Error(e+"Expected "+t+" saw "+r);this.l+=t.length>>1}function yi(t,e){t.l=e,t.read_shift=Tf,t.chk=qk,t.write_shift=tme}function Co(t,e){t.l+=e}function ge(t){var e=Fu(t);return yi(e,0),e}function ii(){var t=[],e=Nt?256:2048,r=function(u){var c=ge(u);return yi(c,0),c},n=r(e),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&t.push(n),n=null)},s=function(u){return n&&u<n.length-n.l?n:(i(),n=r(Math.max(u+1,e)))},o=function(){return i(),cn(t)},a=function(u){i(),n=u,n.l==null&&(n.l=n.length),s(e)};return{next:s,push:a,end:o,_bufs:t}}function we(t,e,r,n){var i=+e,s;if(!isNaN(i)){n||(n=KCe[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=t.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&qE(r)&&t.push(r)}}function _f(t,e,r){var n=oi(t);if(e.s?(n.cRel&&(n.c+=e.s.c),n.rRel&&(n.r+=e.s.r)):(n.cRel&&(n.c+=e.c),n.rRel&&(n.r+=e.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function rI(t,e,r){var n=oi(t);return n.s=_f(n.s,e.s,r),n.e=_f(n.e,e.s,r),n}function Af(t,e){if(t.cRel&&t.c<0)for(t=oi(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=oi(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var r=zt(t);return!t.cRel&&t.cRel!=null&&(r=ime(r)),!t.rRel&&t.rRel!=null&&(r=rme(r)),r}function _y(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+Tn(t.s.c)+":"+(t.e.cRel?"":"$")+Tn(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+dn(t.s.r)+":"+(t.e.rRel?"":"$")+dn(t.e.r):Af(t.s,e.biff)+":"+Af(t.e,e.biff)}function ZE(t){return parseInt(nme(t),10)-1}function dn(t){return""+(t+1)}function rme(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function nme(t){return t.replace(/\$(\d+)$/,"$1")}function JE(t){for(var e=sme(t),r=0,n=0;n!==e.length;++n)r=26*r+e.charCodeAt(n)-64;return r-1}function Tn(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function ime(t){return t.replace(/^([A-Z])/,"$$$1")}function sme(t){return t.replace(/^\$([A-Z])/,"$1")}function ome(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function nn(t){for(var e=0,r=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=48&&i<=57?e=10*e+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:e-1}}function zt(t){for(var e=t.c+1,r="";e;e=(e-1)/26|0)r=String.fromCharCode((e-1)%26+65)+r;return r+(t.r+1)}function Ei(t){var e=t.indexOf(":");return e==-1?{s:nn(t),e:nn(t)}:{s:nn(t.slice(0,e)),e:nn(t.slice(e+1))}}function $r(t,e){return typeof e>"u"||typeof e=="number"?$r(t.s,t.e):(typeof t!="string"&&(t=zt(t)),typeof e!="string"&&(e=zt(e)),t==e?t:t+":"+e)}function ur(t){var e={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=t.length;for(r=0;n<s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.s.c=--r,r=0;n<s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(e.s.r=--r,n===s||i!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++n,r=0;n!=s&&!((i=t.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(e.e.c=--r,r=0;n!=s&&!((i=t.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return e.e.r=--r,e}function nI(t,e){var r=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=vl(t.z,r?si(e):e)}catch{}try{return t.w=vl((t.XF||{}).numFmtId||(r?14:0),r?si(e):e)}catch{return""+e}}function ma(t,e,r){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&r&&r.dateNF&&(t.z=r.dateNF),t.t=="e"?$g[t.v]||t.v:e==null?nI(t,t.v):nI(t,e))}function Ju(t,e){var r=e&&e.sheet?e.sheet:"Sheet1",n={};return n[r]=t,{SheetNames:[r],Sheets:n}}function Zk(t,e,r){var n=r||{},i=t?Array.isArray(t):n.dense,s=t||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?nn(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=ur(s["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),o==-1&&(u.e.r=o=c.e.r+1)}for(var h=0;h!=e.length;++h)if(e[h]){if(!Array.isArray(e[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=e[h].length;++d)if(!(typeof e[h][d]>"u")){var f={v:e[h][d]},m=o+h,g=a+d;if(u.s.r>m&&(u.s.r=m),u.s.c>g&&(u.s.c=g),u.e.r<m&&(u.e.r=m),u.e.c<g&&(u.e.c=g),e[h][d]&&typeof e[h][d]=="object"&&!Array.isArray(e[h][d])&&!(e[h][d]instanceof Date))f=e[h][d];else if(Array.isArray(f.v)&&(f.f=e[h][d][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Mr[14],n.cellDates?(f.t="d",f.w=vl(f.z,si(f.v))):(f.t="n",f.v=si(f.v),f.w=vl(f.z,f.v))):f.t="s";if(i)s[m]||(s[m]=[]),s[m][g]&&s[m][g].z&&(f.z=s[m][g].z),s[m][g]=f;else{var w=zt({c:g,r:m});s[w]&&s[w].z&&(f.z=s[w].z),s[w]=f}}}return u.s.c<1e7&&(s["!ref"]=$r(u)),s}function Hh(t,e){return Zk(null,t,e)}function ame(t){return t.read_shift(4,"i")}function Es(t,e){return e||(e=ge(4)),e.write_shift(4,t),e}function _n(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function sn(t,e){var r=!1;return e==null&&(r=!0,e=ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}function lme(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function ume(t,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function QE(t,e){var r=t.l,n=t.read_shift(1),i=_n(t),s=[],o={t:i,h:i};if(n&1){for(var a=t.read_shift(4),l=0;l!=a;++l)s.push(lme(t));o.r=s}else o.r=[{ich:0,ifnt:0}];return t.l=r+e,o}function cme(t,e){var r=!1;return e==null&&(r=!0,e=ge(15+4*t.t.length)),e.write_shift(1,0),sn(t.t,e),r?e.slice(0,e.l):e}var hme=QE;function dme(t,e){var r=!1;return e==null&&(r=!0,e=ge(23+4*t.t.length)),e.write_shift(1,1),sn(t.t,e),e.write_shift(4,1),ume({ich:0,ifnt:0},e),r?e.slice(0,e.l):e}function Qi(t){var e=t.read_shift(4),r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:r}}function Qu(t,e){return e==null&&(e=ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ec(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function tc(t,e){return e==null&&(e=ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var fme=_n,Jk=sn;function eT(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function bw(t,e){var r=!1;return e==null&&(r=!0,e=ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),r?e.slice(0,e.l):e}var gme=_n,eb=eT,tT=bw;function Qk(t){var e=t.slice(t.l,t.l+4),r=e[0]&1,n=e[0]&2;t.l+=4;var i=n===0?yw([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):pu(e,0)>>2;return r?i/100:i}function eF(t,e){e==null&&(e=ge(4));var r=0,n=0,i=t*100;if(t==(t|0)&&t>=-(1<<29)&&t<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)e.write_shift(-4,((r?i:t)<<2)+(r+2));else throw new Error("unsupported RkNumber "+t)}function tF(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function mme(t,e){return e||(e=ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var rc=tF,kh=mme;function Fh(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Lu(t,e){return(e||ge(8)).write_shift(8,t,"f")}function pme(t){var e={},r=t.read_shift(1),n=r>>>1,i=t.read_shift(1),s=t.read_shift(2,"i"),o=t.read_shift(1),a=t.read_shift(1),l=t.read_shift(1);switch(t.l++,n){case 0:e.auto=1;break;case 1:e.index=i;var u=Eme[i];u&&(e.rgb=gI(u));break;case 2:e.rgb=gI([o,a,l]);break;case 3:e.theme=i;break}return s!=0&&(e.tint=s>0?s/32767:s/32768),e}function xw(t,e){if(e||(e=ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var r=t.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),e.write_shift(2,r),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var n=t.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),e.write_shift(1,parseInt(n.slice(0,2),16)),e.write_shift(1,parseInt(n.slice(2,4),16)),e.write_shift(1,parseInt(n.slice(4,6),16)),e.write_shift(1,255)}return e}function wme(t){var e=t.read_shift(1);t.l++;var r={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return r}function vme(t,e){e||(e=ge(2));var r=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,r),e.write_shift(1,0),e}var rF=2,vi=3,Lp=11,Rw=19,$p=64,Cme=65,Sme=71,yme=4108,bme=4126,un=80,iI={1:{n:"CodePage",t:rF},2:{n:"Category",t:un},3:{n:"PresentationFormat",t:un},4:{n:"ByteCount",t:vi},5:{n:"LineCount",t:vi},6:{n:"ParagraphCount",t:vi},7:{n:"SlideCount",t:vi},8:{n:"NoteCount",t:vi},9:{n:"HiddenCount",t:vi},10:{n:"MultimediaClipCount",t:vi},11:{n:"ScaleCrop",t:Lp},12:{n:"HeadingPairs",t:yme},13:{n:"TitlesOfParts",t:bme},14:{n:"Manager",t:un},15:{n:"Company",t:un},16:{n:"LinksUpToDate",t:Lp},17:{n:"CharacterCount",t:vi},19:{n:"SharedDoc",t:Lp},22:{n:"HyperlinksChanged",t:Lp},23:{n:"AppVersion",t:vi,p:"version"},24:{n:"DigSig",t:Cme},26:{n:"ContentType",t:un},27:{n:"ContentStatus",t:un},28:{n:"Language",t:un},29:{n:"Version",t:un},255:{},2147483648:{n:"Locale",t:Rw},2147483651:{n:"Behavior",t:Rw},1919054434:{}},sI={1:{n:"CodePage",t:rF},2:{n:"Title",t:un},3:{n:"Subject",t:un},4:{n:"Author",t:un},5:{n:"Keywords",t:un},6:{n:"Comments",t:un},7:{n:"Template",t:un},8:{n:"LastAuthor",t:un},9:{n:"RevNumber",t:un},10:{n:"EditTime",t:$p},11:{n:"LastPrinted",t:$p},12:{n:"CreatedDate",t:$p},13:{n:"ModifiedDate",t:$p},14:{n:"PageCount",t:vi},15:{n:"WordCount",t:vi},16:{n:"CharCount",t:vi},17:{n:"Thumbnail",t:Sme},18:{n:"Application",t:un},19:{n:"DocSecurity",t:vi},255:{},2147483648:{n:"Locale",t:Rw},2147483651:{n:"Behavior",t:Rw},1919054434:{}};function xme(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var Rme=xme([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Eme=oi(Rme),$g={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Tme={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Bp={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function nF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function iF(t,e){var r=kge(Tme),n=[],i;n[n.length]=Vr,n[n.length]=Te("Types",null,{xmlns:rn.CT,"xmlns:xsd":rn.xsd,"xmlns:xsi":rn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Te("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){t[l]&&t[l].length>0&&(i=t[l][0],n[n.length]=Te("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Bp[l][e.bookType]||Bp[l].xlsx}))},o=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Bp[l][e.bookType]||Bp[l].xlsx})})},a=function(l){(t[l]||[]).forEach(function(u){n[n.length]=Te("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Mt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function sF(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function dh(t){var e=[Vr,Te("Relationships",null,{xmlns:rn.RELS})];return fn(t["!id"]).forEach(function(r){e[e.length]=Te("Relationship",null,t["!id"][r])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Ut(t,e,r,n,i,s){if(i||(i={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,i.Id="rId"+e,i.Type=n,i.Target=r,[Mt.HLINK,Mt.XPATH,Mt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),t["!id"][i.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][i.Id]=i,t[("/"+i.Target).replace("//","/")]=i,e}function _me(t){var e=[Vr];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<t.length;++r)e.push('  <manifest:file-entry manifest:full-path="'+t[r][0]+'" manifest:media-type="'+t[r][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function oI(t,e,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function Ame(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function Mme(t){var e=[Vr];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=t.length;++r)e.push(oI(t[r][0],t[r][1])),e.push(Ame("",t[r][0]));return e.push(oI("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function oF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+pw.version+"</meta:generator></office:meta></office:document-meta>"}var _u=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Ay(t,e,r,n,i){i[t]!=null||e==null||e===""||(i[t]=e,e=jt(e),n[n.length]=r?Te(t,e,r):hn(t,e))}function aF(t,e){var r=e||{},n=[Vr,Te("cp:coreProperties",null,{"xmlns:cp":rn.CORE_PROPS,"xmlns:dc":rn.dc,"xmlns:dcterms":rn.dcterms,"xmlns:dcmitype":rn.dcmitype,"xmlns:xsi":rn.xsi})],i={};if(!t&&!r.Props)return n.join("");t&&(t.CreatedDate!=null&&Ay("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Q1(t.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),t.ModifiedDate!=null&&Ay("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Q1(t.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=_u.length;++s){var o=_u[s],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:t?t[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&Ay(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var fh=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],lF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function uF(t){var e=[],r=Te;return t||(t={}),t.Application="SheetJS",e[e.length]=Vr,e[e.length]=Te("Properties",null,{xmlns:rn.EXT_PROPS,"xmlns:vt":rn.vt}),fh.forEach(function(n){if(t[n[1]]!==void 0){var i;switch(n[2]){case"string":i=jt(String(t[n[1]]));break;case"bool":i=t[n[1]]?"true":"false";break}i!==void 0&&(e[e.length]=r(n[0],i))}}),e[e.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=r("TitlesOfParts",r("vt:vector",t.SheetNames.map(function(n){return"<vt:lpstr>"+jt(n)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function cF(t){var e=[Vr,Te("Properties",null,{xmlns:rn.CUST_PROPS,"xmlns:vt":rn.vt})];if(!t)return e.join("");var r=1;return fn(t).forEach(function(i){++r,e[e.length]=Te("property",Gge(t[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:jt(i)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var aI={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function Ome(t,e){var r=[];return fn(aI).map(function(n){for(var i=0;i<_u.length;++i)if(_u[i][1]==n)return _u[i];for(i=0;i<fh.length;++i)if(fh[i][1]==n)return fh[i];throw n}).forEach(function(n){if(t[n[1]]!=null){var i=e&&e.Props&&e.Props[n[1]]!=null?e.Props[n[1]]:t[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(hn(aI[n[1]]||n[1],i))}}),Te("DocumentProperties",r.join(""),{xmlns:bi.o})}function Ime(t,e){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return t&&fn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)){for(var o=0;o<_u.length;++o)if(s==_u[o][1])return;for(o=0;o<fh.length;++o)if(s==fh[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var a=t[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(Te(KO(s),a,{"dt:dt":l}))}}),e&&fn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)&&!(t&&Object.prototype.hasOwnProperty.call(t,s))){var o=e[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(Te(KO(s),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+bi.o+'">'+i.join("")+"</"+n+">"}function Pme(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,r=e.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=ge(8);return o.write_shift(4,n),o.write_shift(4,i),o}function lI(t,e){var r=ge(4),n=ge(4);switch(r.write_shift(4,t==80?31:t),t){case 3:n.write_shift(-4,e);break;case 5:n=ge(8),n.write_shift(8,e,"f");break;case 11:n.write_shift(4,e?1:0);break;case 64:n=Pme(e);break;case 31:case 80:for(n=ge(4+2*(e.length+1)+(e.length%2?0:2)),n.write_shift(4,e.length+1),n.write_shift(0,e,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return cn([r,n])}var hF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function Nme(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function uI(t,e,r){var n=ge(8),i=[],s=[],o=8,a=0,l=ge(8),u=ge(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),o+=8+l.length,!e){u=ge(8),u.write_shift(4,0),i.unshift(u);var c=[ge(4)];for(c[0].write_shift(4,t.length),a=0;a<t.length;++a){var h=t[a][0];for(l=ge(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=cn(c),s.unshift(l),o+=8+l.length}for(a=0;a<t.length;++a)if(!(e&&!e[t[a][0]])&&!(hF.indexOf(t[a][0])>-1||lF.indexOf(t[a][0])>-1)&&t[a][1]!=null){var d=t[a][1],f=0;if(e){f=+e[t[a][0]];var m=r[f];if(m.p=="version"&&typeof d=="string"){var g=d.split(".");d=(+g[0]<<16)+(+g[1]||0)}l=lI(m.t,d)}else{var w=Nme(d);w==-1&&(w=31,d=String(d)),l=lI(w,d)}s.push(l),u=ge(8),u.write_shift(4,e?f:2+a),i.push(u),o+=8+l.length}var S=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,S),S+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),cn([n].concat(i).concat(s))}function cI(t,e,r,n,i,s){var o=ge(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Xt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,e,"hex"),o.write_shift(4,i?68:48);var l=uI(t,r,n);if(a.push(l),i){var u=uI(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(u)}return cn(a)}function Dme(t,e){e||(e=ge(t));for(var r=0;r<t;++r)e.write_shift(1,0);return e}function Hme(t,e){return t.read_shift(e)===1}function Fn(t,e){return e||(e=ge(2)),e.write_shift(2,+!!t),e}function dF(t){return t.read_shift(2,"u")}function $i(t,e){return e||(e=ge(2)),e.write_shift(2,t),e}function fF(t,e,r){return r||(r=ge(2)),r.write_shift(1,e=="e"?+t:+!!t),r.write_shift(1,e=="e"?1:0),r}function gF(t,e,r){var n=t.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=t.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?t.read_shift(n,i):"";return o}function kme(t){var e=t.t||"",r=ge(3);r.write_shift(2,e.length),r.write_shift(1,1);var n=ge(2*e.length);n.write_shift(2*e.length,e,"utf16le");var i=[r,n];return cn(i)}function Fme(t,e,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return t.read_shift(e,"cpstr");if(r.biff>=12)return t.read_shift(e,"dbcs-cont")}var i=t.read_shift(1);return i===0?n=t.read_shift(e,"sbcs-cont"):n=t.read_shift(e,"dbcs-cont"),n}function Lme(t,e,r){var n=t.read_shift(r&&r.biff==2?1:2);return n===0?(t.l++,""):Fme(t,n,r)}function $me(t,e,r){if(r.biff>5)return Lme(t,e,r);var n=t.read_shift(1);return n===0?(t.l++,""):t.read_shift(n,r.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function mF(t,e,r){return r||(r=ge(3+2*t.length)),r.write_shift(2,t.length),r.write_shift(1,1),r.write_shift(31,t,"utf16le"),r}function hI(t,e){e||(e=ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var r=0;r<t.length;++r)e.write_shift(2,t.charCodeAt(r));return e.write_shift(2,0),e}function Bme(t){var e=ge(512),r=0,n=t.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}e.write_shift(4,2),e.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)e.write_shift(4,o[r]);if(s==28)n=n.slice(1),hI(n,e);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));var a=i>-1?n.slice(0,i):n;for(e.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)e.write_shift(2,a.charCodeAt(r));e.write_shift(2,0),s&8&&hI(i>-1?n.slice(i+1):"",e)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)e.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(e.write_shift(2,l),e.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)e.write_shift(1,n.charCodeAt(r+3*l)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),r=0;r<6;++r)e.write_shift(4,0)}return e.slice(0,e.l)}function $u(t,e,r,n){return n||(n=ge(6)),n.write_shift(2,t),n.write_shift(2,e),n.write_shift(2,r||0),n}function Vme(t,e,r){var n=r.biff>8?4:2,i=t.read_shift(n),s=t.read_shift(n,"i"),o=t.read_shift(n,"i");return[i,s,o]}function Wme(t){var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(2),i=t.read_shift(2);return{s:{c:n,r:e},e:{c:i,r}}}function pF(t,e){return e||(e=ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function rT(t,e,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ge(i);return s.write_shift(2,n),s.write_shift(2,e),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function Ume(t,e){var r=!e||e.biff==8,n=ge(r?112:54);for(n.write_shift(e.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function jme(t,e){var r=!e||e.biff>=8?2:1,n=ge(8+r*t.name.length);n.write_shift(4,t.pos),n.write_shift(1,t.hs||0),n.write_shift(1,t.dt),n.write_shift(1,t.name.length),e.biff>=8&&n.write_shift(1,1),n.write_shift(r*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function zme(t,e){var r=ge(8);r.write_shift(4,t.Count),r.write_shift(4,t.Unique);for(var n=[],i=0;i<t.length;++i)n[i]=kme(t[i]);var s=cn([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function Yme(){var t=ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Gme(t){var e=ge(18),r=1718;return t&&t.RTL&&(r|=64),e.write_shift(2,r),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function Kme(t,e){var r=t.name||"Arial",n=e&&e.biff==5,i=n?15+r.length:16+2*r.length,s=ge(i);return s.write_shift(2,(t.sz||12)*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function Xme(t,e,r,n){var i=ge(10);return $u(t,e,n,i),i.write_shift(4,r),i}function qme(t,e,r,n,i){var s=!i||i.biff==8,o=ge(8+ +s+(1+s)*r.length);return $u(t,e,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function Zme(t,e,r,n){var i=r&&r.biff==5;n||(n=ge(i?3+e.length:5+2*e.length)),n.write_shift(2,t),n.write_shift(i?1:2,e.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*e.length,e,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}function Jme(t,e){var r=e.biff==8||!e.biff?4:2,n=ge(2*r+6);return n.write_shift(r,t.s.r),n.write_shift(r,t.e.r+1),n.write_shift(2,t.s.c),n.write_shift(2,t.e.c+1),n.write_shift(2,0),n}function dI(t,e,r,n){var i=r&&r.biff==5;n||(n=ge(i?16:20)),n.write_shift(2,0),t.style?(n.write_shift(2,t.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,t.numFmtId||0),n.write_shift(2,e<<4));var s=0;return t.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function Qme(t){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function epe(t,e,r,n,i,s){var o=ge(8);return $u(t,e,n,o),fF(r,s,o),o}function tpe(t,e,r,n){var i=ge(14);return $u(t,e,n,i),Lu(r,i),i}function rpe(t,e,r){if(r.biff<8)return npe(t,e,r);for(var n=[],i=t.l+e,s=t.read_shift(r.biff>8?4:2);s--!==0;)n.push(Vme(t,r.biff>8?12:6,r));if(t.l!=i)throw new Error("Bad ExternSheet: "+t.l+" != "+i);return n}function npe(t,e,r){t[t.l+1]==3&&t[t.l]++;var n=gF(t,e,r);return n.charCodeAt(0)==3?n.slice(1):n}function ipe(t){var e=ge(2+t.length*8);e.write_shift(2,t.length);for(var r=0;r<t.length;++r)pF(t[r],e);return e}function spe(t){var e=ge(24),r=nn(t[0]);e.write_shift(2,r.r),e.write_shift(2,r.r),e.write_shift(2,r.c),e.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)e.write_shift(1,parseInt(n[i],16));return cn([e,Bme(t[1])])}function ope(t){var e=t[1].Tooltip,r=ge(10+2*(e.length+1));r.write_shift(2,2048);var n=nn(t[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<e.length;++i)r.write_shift(2,e.charCodeAt(i));return r.write_shift(2,0),r}function ape(t){return t||(t=ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function lpe(t,e,r){if(!r.cellStyles)return Co(t,e);var n=r&&r.biff>=12?4:2,i=t.read_shift(n),s=t.read_shift(n),o=t.read_shift(n),a=t.read_shift(n),l=t.read_shift(2);n==2&&(t.l+=2);var u={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(u.level=l>>8&7),u}function upe(t,e){var r=ge(12);r.write_shift(2,e),r.write_shift(2,e),r.write_shift(2,t.width*256),r.write_shift(2,0);var n=0;return t.hidden&&(n|=1),r.write_shift(1,n),n=t.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function cpe(t){for(var e=ge(2*t),r=0;r<t;++r)e.write_shift(2,r+1);return e}function hpe(t,e,r){var n=ge(15);return Vg(n,t,e),n.write_shift(8,r,"f"),n}function dpe(t,e,r){var n=ge(9);return Vg(n,t,e),n.write_shift(2,r),n}var fpe=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=zE({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var u=[],c=Fu(1);switch(l.type){case"base64":c=Ss(ga(a));break;case"binary":c=Ss(a);break;case"buffer":case"array":c=a;break}yi(c,0);var h=c.read_shift(1),d=!!(h&136),f=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,d=!0;break;case 49:f=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,w=521;h==2&&(g=c.read_shift(2)),c.l+=3,h!=2&&(g=c.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(w=c.read_shift(2));var S=c.read_shift(2),b=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(b=t[c[c.l]]),c.l+=1,c.l+=2),m&&(c.l+=36);for(var y=[],_={},P=Math.min(c.length,h==2?521:w-10-(f?264:0)),z=m?32:11;c.l<P&&c[c.l]!=13;)switch(_={},_.name=mu.utils.decode(b,c.slice(c.l,c.l+z)).replace(/[\u0000\r\n].*$/g,""),c.l+=z,_.type=String.fromCharCode(c.read_shift(1)),h!=2&&!m&&(_.offset=c.read_shift(4)),_.len=c.read_shift(1),h==2&&(_.offset=c.read_shift(2)),_.dec=c.read_shift(1),_.name.length&&y.push(_),h!=2&&(c.l+=m?13:14),_.type){case"B":(!f||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(c[c.l]!==13&&(c.l=w-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=w;var I=0,W=0;for(u[0]=[],W=0;W!=y.length;++W)u[0][W]=y[W].name;for(;g-- >0;){if(c[c.l]===42){c.l+=S;continue}for(++c.l,u[++I]=[],W=0,W=0;W!=y.length;++W){var L=c.slice(c.l,c.l+y[W].len);c.l+=y[W].len,yi(L,0);var U=mu.utils.decode(b,L);switch(y[W].type){case"C":U.trim().length&&(u[I][W]=U.replace(/\s+$/,""));break;case"D":U.length===8?u[I][W]=new Date(+U.slice(0,4),+U.slice(4,6)-1,+U.slice(6,8)):u[I][W]=U;break;case"F":u[I][W]=parseFloat(U.trim());break;case"+":case"I":u[I][W]=m?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(U.trim().toUpperCase()){case"Y":case"T":u[I][W]=!0;break;case"N":case"F":u[I][W]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+U+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[I][W]="##MEMO##"+(m?parseInt(U.trim(),10):L.read_shift(4));break;case"N":U=U.replace(/\u0000/g,"").trim(),U&&U!="."&&(u[I][W]=+U||0);break;case"@":u[I][W]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":u[I][W]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":u[I][W]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[I][W]=-L.read_shift(-8,"f");break;case"B":if(f&&y[W].len==8){u[I][W]=L.read_shift(8,"f");break}case"G":case"P":L.l+=y[W].len;break;case"0":if(y[W].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[W].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=y,u}function n(a,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=Hh(r(a,u),u);return c["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,c}function i(a,l){try{return Ju(n(a,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var u=l||{};if(+u.codepage>=0&&Jf(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=ii(),h=Mw(a,{header:1,raw:!0,cellDates:!0}),d=h[0],f=h.slice(1),m=a["!cols"]||[],g=0,w=0,S=0,b=1;for(g=0;g<d.length;++g){if(((m[g]||{}).DBF||{}).name){d[g]=m[g].DBF.name,++S;continue}if(d[g]!=null){if(++S,typeof d[g]=="number"&&(d[g]=d[g].toString(10)),typeof d[g]!="string")throw new Error("DBF Invalid column name "+d[g]+" |"+typeof d[g]+"|");if(d.indexOf(d[g])!==g){for(w=0;w<1024;++w)if(d.indexOf(d[g]+"_"+w)==-1){d[g]+="_"+w;break}}}}var y=ur(a["!ref"]),_=[],P=[],z=[];for(g=0;g<=y.e.c-y.s.c;++g){var I="",W="",L=0,U=[];for(w=0;w<f.length;++w)f[w][g]!=null&&U.push(f[w][g]);if(U.length==0||d[g]==null){_[g]="?";continue}for(w=0;w<U.length;++w){switch(typeof U[w]){case"number":W="B";break;case"string":W="C";break;case"boolean":W="L";break;case"object":W=U[w]instanceof Date?"D":"C";break;default:W="C"}L=Math.max(L,String(U[w]).length),I=I&&I!=W?"C":W}L>250&&(L=250),W=((m[g]||{}).DBF||{}).type,W=="C"&&m[g].DBF.len>L&&(L=m[g].DBF.len),I=="B"&&W=="N"&&(I="N",z[g]=m[g].DBF.dec,L=m[g].DBF.len),P[g]=I=="C"||W=="N"?L:s[I]||0,b+=P[g],_[g]=I}var G=c.next(32);for(G.write_shift(4,318902576),G.write_shift(4,f.length),G.write_shift(2,296+32*S),G.write_shift(2,b),g=0;g<4;++g)G.write_shift(4,0);for(G.write_shift(4,0|(+e[vk]||3)<<8),g=0,w=0;g<d.length;++g)if(d[g]!=null){var X=c.next(32),le=(d[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);X.write_shift(1,le,"sbcs"),X.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),X.write_shift(4,w),X.write_shift(1,P[g]||s[_[g]]||0),X.write_shift(1,z[g]||0),X.write_shift(1,2),X.write_shift(4,0),X.write_shift(1,0),X.write_shift(4,0),X.write_shift(4,0),w+=P[g]||s[_[g]]||0}var xe=c.next(264);for(xe.write_shift(4,13),g=0;g<65;++g)xe.write_shift(4,0);for(g=0;g<f.length;++g){var be=c.next(b);for(be.write_shift(1,0),w=0;w<d.length;++w)if(d[w]!=null)switch(_[w]){case"L":be.write_shift(1,f[g][w]==null?63:f[g][w]?84:70);break;case"B":be.write_shift(8,f[g][w]||0,"f");break;case"N":var Ze="0";for(typeof f[g][w]=="number"&&(Ze=f[g][w].toFixed(z[w]||0)),S=0;S<P[w]-Ze.length;++S)be.write_shift(1,32);be.write_shift(1,Ze,"sbcs");break;case"D":f[g][w]?(be.write_shift(4,("0000"+f[g][w].getFullYear()).slice(-4),"sbcs"),be.write_shift(2,("00"+(f[g][w].getMonth()+1)).slice(-2),"sbcs"),be.write_shift(2,("00"+f[g][w].getDate()).slice(-2),"sbcs")):be.write_shift(8,"00000000","sbcs");break;case"C":var Le=String(f[g][w]!=null?f[g][w]:"").slice(0,P[w]);for(be.write_shift(1,Le,"sbcs"),S=0;S<P[w]-Le.length;++S)be.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}}(),gpe=function(){var t={AA:"Ã",BA:"Ã",CA:"Ã",DA:195,HA:"Ã",JA:197,AE:"Ã",BE:"Ã",CE:"Ã",HE:"Ã",AI:"Ã",BI:"Ã",CI:"Ã",HI:"Ã",AO:"Ã",BO:"Ã",CO:"Ã",DO:213,HO:"Ã",AU:"Ã",BU:"Ã",CU:"Ã",HU:"Ã",Aa:"Ã ",Ba:"Ã¡",Ca:"Ã¢",Da:227,Ha:"Ã¤",Ja:229,Ae:"Ã¨",Be:"Ã©",Ce:"Ãª",He:"Ã«",Ai:"Ã¬",Bi:"Ã­",Ci:"Ã®",Hi:"Ã¯",Ao:"Ã²",Bo:"Ã³",Co:"Ã´",Do:245,Ho:"Ã¶",Au:"Ã¹",Bu:"Ãº",Cu:"Ã»",Hu:"Ã¼",KC:"Ã",Kc:"Ã§",q:"Ã¦",z:"Å",a:"Ã",j:"Å",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+fn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,f){var m=t[f];return typeof m=="number"?kO(m):m},n=function(d,f,m){var g=f.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return g==59?d:kO(g)};t["|"]=254;function i(d,f){switch(f.type){case"base64":return s(ga(d),f);case"binary":return s(d,f);case"buffer":return s(Nt&&Buffer.isBuffer(d)?d.toString("binary"):kg(d),f);case"array":return s(Vv(d),f)}throw new Error("Unrecognized type "+f.type)}function s(d,f){var m=d.split(/[\n\r]+/),g=-1,w=-1,S=0,b=0,y=[],_=[],P=null,z={},I=[],W=[],L=[],U=0,G;for(+f.codepage>=0&&Jf(+f.codepage);S!==m.length;++S){U=0;var X=m[S].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(e,r),le=X.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),xe=le[0],be;if(X.length>0)switch(xe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":le[1].charAt(0)=="P"&&_.push(X.slice(3).replace(/;;/g,";"));break;case"C":var Ze=!1,Le=!1,Ne=!1,Me=!1,at=-1,v=-1;for(b=1;b<le.length;++b)switch(le[b].charAt(0)){case"A":break;case"X":w=parseInt(le[b].slice(1))-1,Le=!0;break;case"Y":for(g=parseInt(le[b].slice(1))-1,Le||(w=0),G=y.length;G<=g;++G)y[G]=[];break;case"K":be=le[b].slice(1),be.charAt(0)==='"'?be=be.slice(1,be.length-1):be==="TRUE"?be=!0:be==="FALSE"?be=!1:isNaN(la(be))?isNaN(eg(be).getDate())||(be=Bn(be)):(be=la(be),P!==null&&Ok(P)&&(be=Dk(be))),Ze=!0;break;case"E":Me=!0;var p=d0e(le[b].slice(1),{r:g,c:w});y[g][w]=[y[g][w],p];break;case"S":Ne=!0,y[g][w]=[y[g][w],"S5S"];break;case"G":break;case"R":at=parseInt(le[b].slice(1))-1;break;case"C":v=parseInt(le[b].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+X)}if(Ze&&(y[g][w]&&y[g][w].length==2?y[g][w][0]=be:y[g][w]=be,P=null),Ne){if(Me)throw new Error("SYLK shared formula cannot have own formula");var C=at>-1&&y[at][v];if(!C||!C[1])throw new Error("SYLK shared formula cannot find base");y[g][w][1]=f0e(C[1],{r:g-at,c:w-v})}break;case"F":var x=0;for(b=1;b<le.length;++b)switch(le[b].charAt(0)){case"X":w=parseInt(le[b].slice(1))-1,++x;break;case"Y":for(g=parseInt(le[b].slice(1))-1,G=y.length;G<=g;++G)y[G]=[];break;case"M":U=parseInt(le[b].slice(1))/20;break;case"F":break;case"G":break;case"P":P=_[parseInt(le[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=le[b].slice(1).split(" "),G=parseInt(L[0],10);G<=parseInt(L[1],10);++G)U=parseInt(L[2],10),W[G-1]=U===0?{hidden:!0}:{wch:U},nT(W[G-1]);break;case"C":w=parseInt(le[b].slice(1))-1,W[w]||(W[w]={});break;case"R":g=parseInt(le[b].slice(1))-1,I[g]||(I[g]={}),U>0?(I[g].hpt=U,I[g].hpx=yF(U)):U===0&&(I[g].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+X)}x<1&&(P=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+X)}}return I.length>0&&(z["!rows"]=I),W.length>0&&(z["!cols"]=W),f&&f.sheetRows&&(y=y.slice(0,f.sheetRows)),[y,z]}function o(d,f){var m=i(d,f),g=m[0],w=m[1],S=Hh(g,f);return fn(w).forEach(function(b){S[b]=w[b]}),S}function a(d,f){return Ju(o(d,f),f)}function l(d,f,m,g){var w="C;Y"+(m+1)+";X"+(g+1)+";K";switch(d.t){case"n":w+=d.v||0,d.f&&!d.F&&(w+=";E"+sT(d.f,{r:m,c:g}));break;case"b":w+=d.v?"TRUE":"FALSE";break;case"e":w+=d.w||d.v;break;case"d":w+='"'+(d.w||d.v)+'"';break;case"s":w+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(d,f){f.forEach(function(m,g){var w="F;W"+(g+1)+" "+(g+1)+" ";m.hidden?w+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Ew(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Tw(m.wpx)),typeof m.wch=="number"&&(w+=Math.round(m.wch))),w.charAt(w.length-1)!=" "&&d.push(w)})}function c(d,f){f.forEach(function(m,g){var w="F;";m.hidden?w+="M0;":m.hpt?w+="M"+20*m.hpt+";":m.hpx&&(w+="M"+20*_w(m.hpx)+";"),w.length>2&&d.push(w+"R"+(g+1))})}function h(d,f){var m=["ID;PWXL;N;E"],g=[],w=ur(d["!ref"]),S,b=Array.isArray(d),y=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&u(m,d["!cols"]),d["!rows"]&&c(m,d["!rows"]),m.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var _=w.s.r;_<=w.e.r;++_)for(var P=w.s.c;P<=w.e.c;++P){var z=zt({r:_,c:P});S=b?(d[_]||[])[P]:d[z],!(!S||S.v==null&&(!S.f||S.F))&&g.push(l(S,d,_,P))}return m.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:a,to_sheet:o,from_sheet:h}}(),mpe=function(){function t(s,o){switch(o.type){case"base64":return e(ga(s),o);case"binary":return e(s,o);case"buffer":return e(Nt&&Buffer.isBuffer(s)?s.toString("binary"):kg(s),o);case"array":return e(Vv(s),o)}throw new Error("Unrecognized type "+o.type)}function e(s,o){for(var a=s.split(`
`),l=-1,u=-1,c=0,h=[];c!==a.length;++c){if(a[c].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var d=a[c].trim().split(","),f=d[0],m=d[1];++c;for(var g=a[c]||"";(g.match(/["]/g)||[]).length&1&&c<a.length-1;)g+=`
`+a[++c];switch(g=g.trim(),+f){case-1:if(g==="BOT"){h[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][u]=!0:g==="FALSE"?h[l][u]=!1:isNaN(la(m))?isNaN(eg(m).getDate())?h[l][u]=m:h[l][u]=Bn(m):h[l][u]=la(m),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return Hh(t(s,o),o)}function n(s,o){return Ju(r(s,o),o)}var i=function(){var s=function(l,u,c,h,d){l.push(u),l.push(c+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},o=function(l,u,c,h){l.push(u+","+c),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],c=ur(l["!ref"]),h,d=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,c.e.r-c.s.r+1,""),s(u,"TUPLES",0,c.e.c-c.s.c+1,""),s(u,"DATA",0,0,"");for(var f=c.s.r;f<=c.e.r;++f){o(u,-1,0,"BOT");for(var m=c.s.c;m<=c.e.c;++m){var g=zt({r:f,c:m});if(h=d?(l[f]||[])[m]:l[g],!h){o(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?o(u,1,0,"="+h.f):o(u,1,0,""):o(u,0,w,"V");break;case"b":o(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=vl(h.z||Mr[14],si(Bn(h.v)))),o(u,0,h.w,"V");break;default:o(u,1,0,"")}}}o(u,-1,0,"EOD");var S=`\r
`,b=u.join(S);return b}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),wF=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var f=h.split(`
`),m=-1,g=-1,w=0,S=[];w!==f.length;++w){var b=f[w].trim().split(":");if(b[0]==="cell"){var y=nn(b[1]);if(S.length<=y.r)for(m=S.length;m<=y.r;++m)S[m]||(S[m]=[]);switch(m=y.r,g=y.c,b[2]){case"t":S[m][g]=t(b[3]);break;case"v":S[m][g]=+b[3];break;case"vtf":var _=b[b.length-1];case"vtc":switch(b[3]){case"nl":S[m][g]=!!+b[4];break;default:S[m][g]=+b[4];break}b[2]=="vtf"&&(S[m][g]=[S[m][g],_])}}}return d&&d.sheetRows&&(S=S.slice(0,d.sheetRows)),S}function n(h,d){return Hh(r(h,d),d)}function i(h,d){return Ju(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var d=[],f=[],m,g="",w=Ei(h["!ref"]),S=Array.isArray(h),b=w.s.r;b<=w.e.r;++b)for(var y=w.s.c;y<=w.e.c;++y)if(g=zt({r:b,c:y}),m=S?(h[b]||[])[y]:h[g],!(!m||m.v==null||m.t==="z")){switch(f=["cell",g,"t"],m.t){case"s":case"str":f.push(e(m.v));break;case"n":m.f?(f[2]="vtf",f[3]="n",f[4]=m.v,f[5]=e(m.f)):(f[2]="v",f[3]=m.v);break;case"b":f[2]="vt"+(m.f?"f":"c"),f[3]="nl",f[4]=m.v?"1":"0",f[5]=e(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var _=si(Bn(m.v));f[2]="vtc",f[3]="nd",f[4]=""+_,f[5]=m.w||vl(m.z||Mr[14],_);break;case"e":continue}d.push(f.join(":"))}return d.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function c(h){return[s,o,a,o,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:c}}(),ppe=function(){function t(c,h,d,f,m){m.raw?h[d][f]=c:c===""||(c==="TRUE"?h[d][f]=!0:c==="FALSE"?h[d][f]=!1:isNaN(la(c))?isNaN(eg(c).getDate())?h[d][f]=c:h[d][f]=Bn(c):h[d][f]=la(c))}function e(c,h){var d=h||{},f=[];if(!c||c.length===0)return f;for(var m=c.split(/[\r\n]/),g=m.length-1;g>=0&&m[g].length===0;)--g;for(var w=10,S=0,b=0;b<=g;++b)S=m[b].indexOf(" "),S==-1?S=m[b].length:S++,w=Math.max(w,S);for(b=0;b<=g;++b){f[b]=[];var y=0;for(t(m[b].slice(0,w).trim(),f,b,y,d),y=1;y<=(m[b].length-w)/10+1;++y)t(m[b].slice(w+(y-1)*10,w+y*10).trim(),f,b,y,d)}return d.sheetRows&&(f=f.slice(0,d.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(c){for(var h={},d=!1,f=0,m=0;f<c.length;++f)(m=c.charCodeAt(f))==34?d=!d:!d&&m in r&&(h[m]=(h[m]||0)+1);m=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&m.push([h[f],f]);if(!m.length){h=n;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&m.push([h[f],f])}return m.sort(function(g,w){return g[0]-w[0]||n[g[1]]-n[w[1]]}),r[m.pop()[1]]||44}function s(c,h){var d=h||{},f="",m=d.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(f=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(f=c.charAt(4),c=c.slice(6)):f=i(c.slice(0,1024)):d&&d.FS?f=d.FS:f=i(c.slice(0,1024));var w=0,S=0,b=0,y=0,_=0,P=f.charCodeAt(0),z=!1,I=0,W=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var L=d.dateNF!=null?Pge(d.dateNF):null;function U(){var G=c.slice(y,_),X={};if(G.charAt(0)=='"'&&G.charAt(G.length-1)=='"'&&(G=G.slice(1,-1).replace(/""/g,'"')),G.length===0)X.t="z";else if(d.raw)X.t="s",X.v=G;else if(G.trim().length===0)X.t="s",X.v=G;else if(G.charCodeAt(0)==61)G.charCodeAt(1)==34&&G.charCodeAt(G.length-1)==34?(X.t="s",X.v=G.slice(2,-1).replace(/""/g,'"')):g0e(G)?(X.t="n",X.f=G.slice(1)):(X.t="s",X.v=G);else if(G=="TRUE")X.t="b",X.v=!0;else if(G=="FALSE")X.t="b",X.v=!1;else if(!isNaN(b=la(G)))X.t="n",d.cellText!==!1&&(X.w=G),X.v=b;else if(!isNaN(eg(G).getDate())||L&&G.match(L)){X.z=d.dateNF||Mr[14];var le=0;L&&G.match(L)&&(G=Nge(G,d.dateNF,G.match(L)||[]),le=1),d.cellDates?(X.t="d",X.v=Bn(G,le)):(X.t="n",X.v=si(Bn(G,le))),d.cellText!==!1&&(X.w=vl(X.z,X.v instanceof Date?si(X.v):X.v)),d.cellNF||delete X.z}else X.t="s",X.v=G;if(X.t=="z"||(d.dense?(m[w]||(m[w]=[]),m[w][S]=X):m[zt({c:S,r:w})]=X),y=_+1,W=c.charCodeAt(y),g.e.c<S&&(g.e.c=S),g.e.r<w&&(g.e.r=w),I==P)++S;else if(S=0,++w,d.sheetRows&&d.sheetRows<=w)return!0}e:for(;_<c.length;++_)switch(I=c.charCodeAt(_)){case 34:W===34&&(z=!z);break;case P:case 10:case 13:if(!z&&U())break e;break}return _-y>0&&U(),m["!ref"]=$r(g),m}function o(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,h):Hh(e(c,h),h)}function a(c,h){var d="",f=h.type=="string"?[0,0,0,0]:ASe(c,h);switch(h.type){case"base64":d=ga(c);break;case"binary":d=c;break;case"buffer":h.codepage==65001?d=c.toString("utf8"):h.codepage&&typeof mu<"u"?d=mu.utils.decode(h.codepage,c):d=Nt&&Buffer.isBuffer(c)?c.toString("binary"):kg(c);break;case"array":d=Vv(c);break;case"string":d=c;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?d=Ef(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Ef(d):h.type=="binary"&&typeof mu<"u"&&h.codepage&&(d=mu.utils.decode(h.codepage,mu.utils.encode(28591,d))),d.slice(0,19)=="socialcalc:version:"?wF.to_sheet(h.type=="string"?d:Ef(d),h):o(d,h)}function l(c,h){return Ju(a(c,h),h)}function u(c){for(var h=[],d=ur(c["!ref"]),f,m=Array.isArray(c),g=d.s.r;g<=d.e.r;++g){for(var w=[],S=d.s.c;S<=d.e.c;++S){var b=zt({r:g,c:S});if(f=m?(c[g]||[])[S]:c[b],!f||f.v==null){w.push("          ");continue}for(var y=(f.w||(ma(f),f.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(S===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:u}}(),fI=function(){function t(p,C,x){if(p){yi(p,p.l||0);for(var R=x.Enum||at;p.l<p.length;){var F=p.read_shift(2),q=R[F]||R[65535],re=p.read_shift(2),fe=p.l+re,de=q.f&&q.f(p,re,x);if(p.l=fe,C(de,q,F))return}}}function e(p,C){switch(C.type){case"base64":return r(Ss(ga(p)),C);case"binary":return r(Ss(p),C);case"buffer":case"array":return r(p,C)}throw"Unsupported type "+C.type}function r(p,C){if(!p)return p;var x=C||{},R=x.dense?[]:{},F="Sheet1",q="",re=0,fe={},de=[],pe=[],Oe={s:{r:0,c:0},e:{r:0,c:0}},Be=x.sheetRows||0;if(p[2]==0&&(p[3]==8||p[3]==9)&&p.length>=16&&p[14]==5&&p[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(p[2]==2)x.Enum=at,t(p,function(ye,Xe,Ve){switch(Ve){case 0:x.vers=ye,ye>=4096&&(x.qpro=!0);break;case 6:Oe=ye;break;case 204:ye&&(q=ye);break;case 222:q=ye;break;case 15:case 51:x.qpro||(ye[1].v=ye[1].v.slice(1));case 13:case 14:case 16:Ve==14&&(ye[2]&112)==112&&(ye[2]&15)>1&&(ye[2]&15)<15&&(ye[1].z=x.dateNF||Mr[14],x.cellDates&&(ye[1].t="d",ye[1].v=Dk(ye[1].v))),x.qpro&&ye[3]>re&&(R["!ref"]=$r(Oe),fe[F]=R,de.push(F),R=x.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},re=ye[3],F=q||"Sheet"+(re+1),q="");var T=x.dense?(R[ye[0].r]||[])[ye[0].c]:R[zt(ye[0])];if(T){T.t=ye[1].t,T.v=ye[1].v,ye[1].z!=null&&(T.z=ye[1].z),ye[1].f!=null&&(T.f=ye[1].f);break}x.dense?(R[ye[0].r]||(R[ye[0].r]=[]),R[ye[0].r][ye[0].c]=ye[1]):R[zt(ye[0])]=ye[1];break}},x);else if(p[2]==26||p[2]==14)x.Enum=v,p[2]==14&&(x.qpro=!0,p.l=0),t(p,function(ye,Xe,Ve){switch(Ve){case 204:F=ye;break;case 22:ye[1].v=ye[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ye[3]>re&&(R["!ref"]=$r(Oe),fe[F]=R,de.push(F),R=x.dense?[]:{},Oe={s:{r:0,c:0},e:{r:0,c:0}},re=ye[3],F="Sheet"+(re+1)),Be>0&&ye[0].r>=Be)break;x.dense?(R[ye[0].r]||(R[ye[0].r]=[]),R[ye[0].r][ye[0].c]=ye[1]):R[zt(ye[0])]=ye[1],Oe.e.c<ye[0].c&&(Oe.e.c=ye[0].c),Oe.e.r<ye[0].r&&(Oe.e.r=ye[0].r);break;case 27:ye[14e3]&&(pe[ye[14e3][0]]=ye[14e3][1]);break;case 1537:pe[ye[0]]=ye[1],ye[0]==re&&(F=ye[1]);break}},x);else throw new Error("Unrecognized LOTUS BOF "+p[2]);if(R["!ref"]=$r(Oe),fe[q||F]=R,de.push(q||F),!pe.length)return{SheetNames:de,Sheets:fe};for(var ee={},et=[],je=0;je<pe.length;++je)fe[de[je]]?(et.push(pe[je]||de[je]),ee[pe[je]]=fe[pe[je]]||fe[de[je]]):(et.push(pe[je]),ee[pe[je]]={"!ref":"A1"});return{SheetNames:et,Sheets:ee}}function n(p,C){var x=C||{};if(+x.codepage>=0&&Jf(+x.codepage),x.type=="string")throw new Error("Cannot write WK1 to JS string");var R=ii(),F=ur(p["!ref"]),q=Array.isArray(p),re=[];_e(R,0,s(1030)),_e(R,6,l(F));for(var fe=Math.min(F.e.r,8191),de=F.s.r;de<=fe;++de)for(var pe=dn(de),Oe=F.s.c;Oe<=F.e.c;++Oe){de===F.s.r&&(re[Oe]=Tn(Oe));var Be=re[Oe]+pe,ee=q?(p[de]||[])[Oe]:p[Be];if(!(!ee||ee.t=="z"))if(ee.t=="n")(ee.v|0)==ee.v&&ee.v>=-32768&&ee.v<=32767?_e(R,13,f(de,Oe,ee.v)):_e(R,14,g(de,Oe,ee.v));else{var et=ma(ee);_e(R,15,h(de,Oe,et.slice(0,239)))}}return _e(R,1),R.end()}function i(p,C){var x=C||{};if(+x.codepage>=0&&Jf(+x.codepage),x.type=="string")throw new Error("Cannot write WK3 to JS string");var R=ii();_e(R,0,o(p));for(var F=0,q=0;F<p.SheetNames.length;++F)(p.Sheets[p.SheetNames[F]]||{})["!ref"]&&_e(R,27,Me(p.SheetNames[F],q++));var re=0;for(F=0;F<p.SheetNames.length;++F){var fe=p.Sheets[p.SheetNames[F]];if(!(!fe||!fe["!ref"])){for(var de=ur(fe["!ref"]),pe=Array.isArray(fe),Oe=[],Be=Math.min(de.e.r,8191),ee=de.s.r;ee<=Be;++ee)for(var et=dn(ee),je=de.s.c;je<=de.e.c;++je){ee===de.s.r&&(Oe[je]=Tn(je));var ye=Oe[je]+et,Xe=pe?(fe[ee]||[])[je]:fe[ye];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")_e(R,23,U(ee,je,re,Xe.v));else{var Ve=ma(Xe);_e(R,22,I(ee,je,re,Ve.slice(0,239)))}}++re}}return _e(R,1),R.end()}function s(p){var C=ge(2);return C.write_shift(2,p),C}function o(p){var C=ge(26);C.write_shift(2,4096),C.write_shift(2,4),C.write_shift(4,0);for(var x=0,R=0,F=0,q=0;q<p.SheetNames.length;++q){var re=p.SheetNames[q],fe=p.Sheets[re];if(!(!fe||!fe["!ref"])){++F;var de=Ei(fe["!ref"]);x<de.e.r&&(x=de.e.r),R<de.e.c&&(R=de.e.c)}}return x>8191&&(x=8191),C.write_shift(2,x),C.write_shift(1,F),C.write_shift(1,R),C.write_shift(2,0),C.write_shift(2,0),C.write_shift(1,1),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(4,0),C}function a(p,C,x){var R={s:{c:0,r:0},e:{c:0,r:0}};return C==8&&x.qpro?(R.s.c=p.read_shift(1),p.l++,R.s.r=p.read_shift(2),R.e.c=p.read_shift(1),p.l++,R.e.r=p.read_shift(2),R):(R.s.c=p.read_shift(2),R.s.r=p.read_shift(2),C==12&&x.qpro&&(p.l+=2),R.e.c=p.read_shift(2),R.e.r=p.read_shift(2),C==12&&x.qpro&&(p.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function l(p){var C=ge(8);return C.write_shift(2,p.s.c),C.write_shift(2,p.s.r),C.write_shift(2,p.e.c),C.write_shift(2,p.e.r),C}function u(p,C,x){var R=[{c:0,r:0},{t:"n",v:0},0,0];return x.qpro&&x.vers!=20768?(R[0].c=p.read_shift(1),R[3]=p.read_shift(1),R[0].r=p.read_shift(2),p.l+=2):(R[2]=p.read_shift(1),R[0].c=p.read_shift(2),R[0].r=p.read_shift(2)),R}function c(p,C,x){var R=p.l+C,F=u(p,C,x);if(F[1].t="s",x.vers==20768){p.l++;var q=p.read_shift(1);return F[1].v=p.read_shift(q,"utf8"),F}return x.qpro&&p.l++,F[1].v=p.read_shift(R-p.l,"cstr"),F}function h(p,C,x){var R=ge(7+x.length);R.write_shift(1,255),R.write_shift(2,C),R.write_shift(2,p),R.write_shift(1,39);for(var F=0;F<R.length;++F){var q=x.charCodeAt(F);R.write_shift(1,q>=128?95:q)}return R.write_shift(1,0),R}function d(p,C,x){var R=u(p,C,x);return R[1].v=p.read_shift(2,"i"),R}function f(p,C,x){var R=ge(7);return R.write_shift(1,255),R.write_shift(2,C),R.write_shift(2,p),R.write_shift(2,x,"i"),R}function m(p,C,x){var R=u(p,C,x);return R[1].v=p.read_shift(8,"f"),R}function g(p,C,x){var R=ge(13);return R.write_shift(1,255),R.write_shift(2,C),R.write_shift(2,p),R.write_shift(8,x,"f"),R}function w(p,C,x){var R=p.l+C,F=u(p,C,x);if(F[1].v=p.read_shift(8,"f"),x.qpro)p.l=R;else{var q=p.read_shift(2);_(p.slice(p.l,p.l+q),F),p.l+=q}return F}function S(p,C,x){var R=C&32768;return C&=-32769,C=(R?p:0)+(C>=8192?C-16384:C),(R?"":"$")+(x?Tn(C):dn(C))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(p,C){yi(p,0);for(var x=[],R=0,F="",q="",re="",fe="";p.l<p.length;){var de=p[p.l++];switch(de){case 0:x.push(p.read_shift(8,"f"));break;case 1:q=S(C[0].c,p.read_shift(2),!0),F=S(C[0].r,p.read_shift(2),!1),x.push(q+F);break;case 2:{var pe=S(C[0].c,p.read_shift(2),!0),Oe=S(C[0].r,p.read_shift(2),!1);q=S(C[0].c,p.read_shift(2),!0),F=S(C[0].r,p.read_shift(2),!1),x.push(pe+Oe+":"+q+F)}break;case 3:if(p.l<p.length){console.error("WK1 premature formula end");return}break;case 4:x.push("("+x.pop()+")");break;case 5:x.push(p.read_shift(2));break;case 6:{for(var Be="";de=p[p.l++];)Be+=String.fromCharCode(de);x.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:x.push("-"+x.pop());break;case 23:x.push("+"+x.pop());break;case 22:x.push("NOT("+x.pop()+")");break;case 20:case 21:fe=x.pop(),re=x.pop(),x.push(["AND","OR"][de-20]+"("+re+","+fe+")");break;default:if(de<32&&y[de])fe=x.pop(),re=x.pop(),x.push(re+y[de]+fe);else if(b[de]){if(R=b[de][1],R==69&&(R=p[p.l++]),R>x.length){console.error("WK1 bad formula parse 0x"+de.toString(16)+":|"+x.join("|")+"|");return}var ee=x.slice(-R);x.length-=R,x.push(b[de][0]+"("+ee.join(",")+")")}else return de<=7?console.error("WK1 invalid opcode "+de.toString(16)):de<=24?console.error("WK1 unsupported op "+de.toString(16)):de<=30?console.error("WK1 invalid opcode "+de.toString(16)):de<=115?console.error("WK1 unsupported function opcode "+de.toString(16)):console.error("WK1 unrecognized opcode "+de.toString(16))}}x.length==1?C[1].f=""+x[0]:console.error("WK1 bad formula parse |"+x.join("|")+"|")}function P(p){var C=[{c:0,r:0},{t:"n",v:0},0];return C[0].r=p.read_shift(2),C[3]=p[p.l++],C[0].c=p[p.l++],C}function z(p,C){var x=P(p);return x[1].t="s",x[1].v=p.read_shift(C-4,"cstr"),x}function I(p,C,x,R){var F=ge(6+R.length);F.write_shift(2,p),F.write_shift(1,x),F.write_shift(1,C),F.write_shift(1,39);for(var q=0;q<R.length;++q){var re=R.charCodeAt(q);F.write_shift(1,re>=128?95:re)}return F.write_shift(1,0),F}function W(p,C){var x=P(p);x[1].v=p.read_shift(2);var R=x[1].v>>1;if(x[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return x[1].v=R,x}function L(p,C){var x=P(p),R=p.read_shift(4),F=p.read_shift(4),q=p.read_shift(2);if(q==65535)return R===0&&F===3221225472?(x[1].t="e",x[1].v=15):R===0&&F===3489660928?(x[1].t="e",x[1].v=42):x[1].v=0,x;var re=q&32768;return q=(q&32767)-16446,x[1].v=(1-re*2)*(F*Math.pow(2,q+32)+R*Math.pow(2,q)),x}function U(p,C,x,R){var F=ge(14);if(F.write_shift(2,p),F.write_shift(1,x),F.write_shift(1,C),R==0)return F.write_shift(4,0),F.write_shift(4,0),F.write_shift(2,65535),F;var q=0,re=0,fe=0,de=0;return R<0&&(q=1,R=-R),re=Math.log2(R)|0,R/=Math.pow(2,re-31),de=R>>>0,de&2147483648||(R/=2,++re,de=R>>>0),R-=de,de|=2147483648,de>>>=0,R*=Math.pow(2,32),fe=R>>>0,F.write_shift(4,fe),F.write_shift(4,de),re+=16383+(q?32768:0),F.write_shift(2,re),F}function G(p,C){var x=L(p);return p.l+=C-14,x}function X(p,C){var x=P(p),R=p.read_shift(4);return x[1].v=R>>6,x}function le(p,C){var x=P(p),R=p.read_shift(8,"f");return x[1].v=R,x}function xe(p,C){var x=le(p);return p.l+=C-10,x}function be(p,C){return p[p.l+C-1]==0?p.read_shift(C,"cstr"):""}function Ze(p,C){var x=p[p.l++];x>C-1&&(x=C-1);for(var R="";R.length<x;)R+=String.fromCharCode(p[p.l++]);return R}function Le(p,C,x){if(!(!x.qpro||C<21)){var R=p.read_shift(1);p.l+=17,p.l+=1,p.l+=2;var F=p.read_shift(C-21,"cstr");return[R,F]}}function Ne(p,C){for(var x={},R=p.l+C;p.l<R;){var F=p.read_shift(2);if(F==14e3){for(x[F]=[0,""],x[F][0]=p.read_shift(2);p[p.l];)x[F][1]+=String.fromCharCode(p[p.l]),p.l++;p.l++}}return x}function Me(p,C){var x=ge(5+p.length);x.write_shift(2,14e3),x.write_shift(2,C);for(var R=0;R<p.length;++R){var F=p.charCodeAt(R);x[x.l++]=F>127?95:F}return x[x.l++]=0,x}var at={0:{n:"BOF",f:dF},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:be},222:{n:"SHEETNAMELP",f:Ze},65535:{n:""}},v={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:W},25:{n:"FORMULA19",f:G},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:X},38:{n:"??"},39:{n:"NUMBER27",f:le},40:{n:"FORMULA28",f:xe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:be},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Le},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:e}}(),wpe=/^\s|\s$|[\t\n\r]/;function vF(t,e){if(!e.bookSST)return"";var r=[Vr];r[r.length]=Te("sst",null,{xmlns:Dh[0],count:t.Count,uniqueCount:t.Unique});for(var n=0;n!=t.length;++n)if(t[n]!=null){var i=t[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(wpe)&&(s+=' xml:space="preserve"'),s+=">"+jt(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function vpe(t){return[t.read_shift(4),t.read_shift(4)]}function Cpe(t,e){return e||(e=ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var Spe=cme;function ype(t){var e=ii();we(e,159,Cpe(t));for(var r=0;r<t.length;++r)we(e,19,Spe(t[r]));return we(e,160),e.end()}function bpe(t){for(var e=[],r=t.split(""),n=0;n<r.length;++n)e[n]=r[n].charCodeAt(0);return e}function CF(t){var e=0,r,n=bpe(t),i=n.length+1,s,o,a,l,u;for(r=Fu(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=e&16384?1:0,l=e<<1&32767,u=a|l,e=u^o;return e^52811}var xpe=function(){function t(i,s){switch(s.type){case"base64":return e(ga(i),s);case"binary":return e(i,s);case"buffer":return e(Nt&&Buffer.isBuffer(i)?i.toString("binary"):kg(i),s);case"array":return e(Vv(i),s)}throw new Error("Unrecognized type "+s.type)}function e(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(a)&&(a[h]=[]);for(var d=/\\\w+\b/g,f=0,m,g=-1;m=d.exec(c);){switch(m[0]){case"\\cell":var w=c.slice(f,d.lastIndex-m[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var S={v:w,t:"s"};Array.isArray(a)?a[h][g]=S:a[zt({r:h,c:g})]=S}break}f=d.lastIndex}g>u.e.c&&(u.e.c=g)}),a["!ref"]=$r(u),a}function r(i,s){return Ju(t(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=ur(i["!ref"]),a,l=Array.isArray(i),u=o.s.r;u<=o.e.r;++u){s.push("\\trowd\\trautofit1");for(var c=o.s.c;c<=o.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=o.s.c;c<=o.e.c;++c){var h=zt({r:u,c});a=l?(i[u]||[])[c]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(ma(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:t,from_sheet:n}}();function gI(t){for(var e=0,r=1;e!=3;++e)r=r*256+(t[e]>255?255:t[e]<0?0:t[e]);return r.toString(16).toUpperCase().slice(1)}var Rpe=6,ua=Rpe;function Ew(t){return Math.floor((t+Math.round(128/ua)/256)*ua)}function Tw(t){return Math.floor((t-5)/ua*100+.5)/100}function tb(t){return Math.round((t*ua+5)/ua*256)/256}function nT(t){t.width?(t.wpx=Ew(t.width),t.wch=Tw(t.wpx),t.MDW=ua):t.wpx?(t.wch=Tw(t.wpx),t.width=tb(t.wch),t.MDW=ua):typeof t.wch=="number"&&(t.width=tb(t.wch),t.wpx=Ew(t.width),t.MDW=ua),t.customWidth&&delete t.customWidth}var Epe=96,SF=Epe;function _w(t){return t*96/SF}function yF(t){return t*SF/96}function Tpe(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)t[n]!=null&&(e[e.length]=Te("numFmt",null,{numFmtId:n,formatCode:jt(t[n])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Te("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function _pe(t){var e=[];return e[e.length]=Te("cellXfs",null),t.forEach(function(r){e[e.length]=Te("xf",null,r)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Te("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function bF(t,e){var r=[Vr,Te("styleSheet",null,{xmlns:Dh[0],"xmlns:vt":rn.vt})],n;return t.SSF&&(n=Tpe(t.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=_pe(e.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Ape(t,e){var r=t.read_shift(2),n=_n(t);return[r,n]}function Mpe(t,e,r){r||(r=ge(6+4*e.length)),r.write_shift(2,t),sn(e,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Ope(t,e,r){var n={};n.sz=t.read_shift(2)/20;var i=wme(t);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=t.read_shift(2);switch(s===700&&(n.bold=1),t.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(n.underline=o);var a=t.read_shift(1);a>0&&(n.family=a);var l=t.read_shift(1);switch(l>0&&(n.charset=l),t.l++,n.color=pme(t),t.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_n(t),n}function Ipe(t,e){e||(e=ge(25+4*32)),e.write_shift(2,t.sz*20),vme(t,e),e.write_shift(2,t.bold?700:400);var r=0;t.vertAlign=="superscript"?r=1:t.vertAlign=="subscript"&&(r=2),e.write_shift(2,r),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),xw(t.color,e);var n=0;return t.scheme=="major"&&(n=1),t.scheme=="minor"&&(n=2),e.write_shift(1,n),sn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var Ppe=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],My,Npe=Co;function mI(t,e){e||(e=ge(4*3+8*7+16*1)),My||(My=zE(Ppe));var r=My[t.patternType];r==null&&(r=40),e.write_shift(4,r);var n=0;if(r!=40)for(xw({auto:1},e),xw({auto:1},e);n<12;++n)e.write_shift(4,0);else{for(;n<4;++n)e.write_shift(4,0);for(;n<12;++n)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Dpe(t,e){var r=t.l+e,n=t.read_shift(2),i=t.read_shift(2);return t.l=r,{ixfe:n,numFmtId:i}}function xF(t,e,r){r||(r=ge(16)),r.write_shift(2,e||0),r.write_shift(2,t.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ud(t,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Hpe=Co;function kpe(t,e){return e||(e=ge(51)),e.write_shift(1,0),Ud(null,e),Ud(null,e),Ud(null,e),Ud(null,e),Ud(null,e),e.length>e.l?e.slice(0,e.l):e}function Fpe(t,e){return e||(e=ge(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,+t.builtinId),e.write_shift(1,0),bw(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Lpe(t,e,r){var n=ge(2052);return n.write_shift(4,t),bw(e,n),bw(r,n),n.length>n.l?n.slice(0,n.l):n}function $pe(t,e){if(e){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&++r}),r!=0&&(we(t,615,Es(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&we(t,44,Mpe(i,e[i]))}),we(t,616))}}function Bpe(t){var e=1;we(t,611,Es(e)),we(t,43,Ipe({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),we(t,612)}function Vpe(t){var e=2;we(t,603,Es(e)),we(t,45,mI({patternType:"none"})),we(t,45,mI({patternType:"gray125"})),we(t,604)}function Wpe(t){var e=1;we(t,613,Es(e)),we(t,46,kpe()),we(t,614)}function Upe(t){var e=1;we(t,626,Es(e)),we(t,47,xF({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),we(t,627)}function jpe(t,e){we(t,617,Es(e.length)),e.forEach(function(r){we(t,47,xF(r,0))}),we(t,618)}function zpe(t){var e=1;we(t,619,Es(e)),we(t,48,Fpe({xfId:0,builtinId:0,name:"Normal"})),we(t,620)}function Ype(t){var e=0;we(t,505,Es(e)),we(t,506)}function Gpe(t){var e=0;we(t,508,Lpe(e,"TableStyleMedium9","PivotStyleMedium4")),we(t,509)}function Kpe(t,e){var r=ii();return we(r,278),$pe(r,t.SSF),Bpe(r),Vpe(r),Wpe(r),Upe(r),jpe(r,e.cellXfs),zpe(r),Ype(r),Gpe(r),we(r,279),r.end()}function RF(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var r=[Vr];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ï¼­ï¼³ ï¼°ã´ã·ãã¯"/>',r[r.length]='<a:font script="Hang" typeface="ë§ì ê³ ë"/>',r[r.length]='<a:font script="Hans" typeface="å®ä½"/>',r[r.length]='<a:font script="Hant" typeface="æ°ç´°æé«"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Xpe(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:_n(t)}}function qpe(t){var e=ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),sn(t.name,e),e.slice(0,e.l)}function Zpe(t){for(var e=[],r=t.read_shift(4);r-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function Jpe(t){var e=ge(4+8*t.length);e.write_shift(4,t.length);for(var r=0;r<t.length;++r)e.write_shift(4,t[r][0]),e.write_shift(4,t[r][1]);return e}function Qpe(t,e){var r=ge(8+2*e.length);return r.write_shift(4,t),sn(e,r),r.slice(0,r.l)}function e0e(t){return t.l+=4,t.read_shift(4)!=0}function t0e(t,e){var r=ge(8);return r.write_shift(4,t),r.write_shift(4,1),r}function r0e(){var t=ii();return we(t,332),we(t,334,Es(1)),we(t,335,qpe({name:"XLDAPR",version:12e4,flags:3496657072})),we(t,336),we(t,339,Qpe(1,"XLDAPR")),we(t,52),we(t,35,Es(514)),we(t,4096,Es(0)),we(t,4097,$i(1)),we(t,36),we(t,53),we(t,340),we(t,337,t0e(1)),we(t,51,Jpe([[1,0]])),we(t,338),we(t,333),t.end()}function EF(){var t=[Vr];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function n0e(t){var e={};e.i=t.read_shift(4);var r={};r.r=t.read_shift(4),r.c=t.read_shift(4),e.r=zt(r);var n=t.read_shift(1);return n&2&&(e.l="1"),n&8&&(e.a="1"),e}var rh=1024;function TF(t,e){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Te("xml",null,{"xmlns:v":bi.v,"xmlns:o":bi.o,"xmlns:x":bi.x,"xmlns:mv":bi.mv}).replace(/\/>/,">"),Te("o:shapelayout",Te("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Te("v:shapetype",[Te("v:stroke",null,{joinstyle:"miter"}),Te("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];rh<t*1e3;)rh+=1e3;return e.forEach(function(s){var o=nn(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?Te("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Te("v:fill",l,a),c={on:"t",obscured:"t"};++rh,i=i.concat(["<v:shape"+rg({id:"_x0000_s"+rh,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Te("v:shadow",null,c),Te("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",hn("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),hn("x:AutoFill","False"),hn("x:Row",String(o.r)),hn("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function _F(t){var e=[Vr,Te("comments",null,{xmlns:Dh[0]})],r=[];return e.push("<authors>"),t.forEach(function(n){n[1].forEach(function(i){var s=jt(i.a);r.indexOf(s)==-1&&(r.push(s),e.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),e.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(jt(l.a))),s.push(l.t||"")}),e.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)e.push(hn("t",jt(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;e.push(hn("t",jt(o)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function i0e(t,e,r){var n=[Vr,Te("ThreadedComments",null,{xmlns:rn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&e.indexOf(o.a)==-1&&e.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(o.a)).slice(-12)+"}"),n.push(Te("threadedComment",hn("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function s0e(t){var e=[Vr,Te("personList",null,{xmlns:rn.TCMNT,"xmlns:x":Dh[0]}).replace(/[\/]>/,">")];return t.forEach(function(r,n){e.push(Te("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),e.push("</personList>"),e.join("")}function o0e(t){var e={};e.iauthor=t.read_shift(4);var r=rc(t);return e.rfx=r.s,e.ref=zt(r.s),t.l+=16,e}function a0e(t,e){return e==null&&(e=ge(36)),e.write_shift(4,t[1].iauthor),kh(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var l0e=_n;function u0e(t){return sn(t.slice(0,54))}function c0e(t){var e=ii(),r=[];return we(e,628),we(e,630),t.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),we(e,632,u0e(i.a)))})}),we(e,631),we(e,633),t.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:nn(n[0]),e:nn(n[0])};we(e,635,a0e([s,i])),i.t&&i.t.length>0&&we(e,637,dme(i)),we(e,636),delete i.iauthor})}),we(e,634),we(e,629),e.end()}function h0e(t,e){e.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Xt.utils.cfb_add(t,i,e.FileIndex[n].content)}})}var AF=["xlsb","xlsm","xlam","biff8","xla"],d0e=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,c=o.length>0?parseInt(o,10)|0:0;return a?c+=e.c:--c,l?u+=e.r:--u,i+(a?"":"$")+Tn(c)+(l?"":"$")+dn(u)}return function(i,s){return e=s,i.replace(t,r)}}(),iT=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,sT=function(){return function(e,r){return e.replace(iT,function(n,i,s,o,a,l){var u=JE(o)-(s?0:r.c),c=ZE(l)-(a?0:r.r),h=c==0?"":a?c+1:"["+c+"]",d=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+d})}}();function f0e(t,e){return t.replace(iT,function(r,n,i,s,o,a){return n+(i=="$"?i+s:Tn(JE(s)+e.c))+(o=="$"?o+a:dn(ZE(a)+e.r))})}function g0e(t){return t.length!=1}function Fr(t){t.l+=1}function Cl(t,e){var r=t.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function MF(t,e,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return OF(t);r.biff==12&&(n=4)}var i=t.read_shift(n),s=t.read_shift(n),o=Cl(t),a=Cl(t);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function OF(t){var e=Cl(t),r=Cl(t),n=t.read_shift(1),i=t.read_shift(1);return{s:{r:e[0],c:n,cRel:e[1],rRel:e[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function m0e(t,e,r){if(r.biff<8)return OF(t);var n=t.read_shift(r.biff==12?4:2),i=t.read_shift(r.biff==12?4:2),s=Cl(t),o=Cl(t);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function IF(t,e,r){if(r&&r.biff>=2&&r.biff<=5)return p0e(t);var n=t.read_shift(r&&r.biff==12?4:2),i=Cl(t);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function p0e(t){var e=Cl(t),r=t.read_shift(1);return{r:e[0],c:r,cRel:e[1],rRel:e[2]}}function w0e(t){var e=t.read_shift(2),r=t.read_shift(2);return{r:e,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function v0e(t,e,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return C0e(t);var i=t.read_shift(n>=12?4:2),s=t.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function C0e(t){var e=t.read_shift(2),r=t.read_shift(1),n=(e&32768)>>15,i=(e&16384)>>14;return e&=16383,n==1&&e>=8192&&(e=e-16384),i==1&&r>=128&&(r=r-256),{r:e,c:r,cRel:i,rRel:n}}function S0e(t,e,r){var n=(t[t.l++]&96)>>5,i=MF(t,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function y0e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}var o=MF(t,s,r);return[n,i,o]}function b0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function x0e(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=8;if(r)switch(r.biff){case 5:t.l+=12,s=6;break;case 12:s=12;break}return t.l+=s,[n,i]}function R0e(t,e,r){var n=(t[t.l++]&96)>>5,i=m0e(t,e-1,r);return[n,i]}function E0e(t,e,r){var n=(t[t.l++]&96)>>5;return t.l+=r.biff==2?6:r.biff==12?14:7,[n]}function pI(t){var e=t[t.l+1]&1,r=1;return t.l+=4,[e,r]}function T0e(t,e,r){t.l+=2;for(var n=t.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(t.read_shift(r&&r.biff==2?1:2));return i}function _0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function A0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=2,[n,t.read_shift(r&&r.biff==2?1:2)]}function M0e(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function O0e(t,e,r){var n=t[t.l+1]&255?1:0;return t.l+=r&&r.biff==2?3:4,[n]}function PF(t){var e=t.read_shift(1),r=t.read_shift(1);return[e,r]}function I0e(t){return t.read_shift(2),PF(t)}function P0e(t){return t.read_shift(2),PF(t)}function N0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=IF(t,0,r);return[n,i]}function D0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=v0e(t,0,r);return[n,i]}function H0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(2);r&&r.biff==5&&(t.l+=12);var s=IF(t,0,r);return[n,i,s]}function k0e(t,e,r){var n=(t[t.l]&96)>>5;t.l+=1;var i=t.read_shift(r&&r.biff<=3?1:2);return[kwe[i],HF[i],n]}function F0e(t,e,r){var n=t[t.l++],i=t.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,t.read_shift(1)]:L0e(t);return[i,(s[0]===0?HF:Hwe)[s[1]]]}function L0e(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function $0e(t,e,r){t.l+=r&&r.biff==2?3:4}function B0e(t,e,r){if(t.l++,r&&r.biff==12)return[t.read_shift(4,"i"),0];var n=t.read_shift(2),i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function V0e(t){return t.l++,$g[t.read_shift(1)]}function W0e(t){return t.l++,t.read_shift(2)}function U0e(t){return t.l++,t.read_shift(1)!==0}function j0e(t){return t.l++,Fh(t)}function z0e(t,e,r){return t.l++,gF(t,e-1,r)}function Y0e(t,e){var r=[t.read_shift(1)];if(e==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Hme(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:r[1]=$g[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:r[1]=Fh(t);break;case 2:r[1]=$me(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function G0e(t,e,r){for(var n=t.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?rc:Wme)(t));return i}function K0e(t,e,r){var n=0,i=0;r.biff==12?(n=t.read_shift(4),i=t.read_shift(4)):(i=1+t.read_shift(1),n=1+t.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=Y0e(t,r.biff);return o}function X0e(t,e,r){var n=t.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=t.read_shift(i);switch(r.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[n,0,s]}function q0e(t,e,r){if(r.biff==5)return Z0e(t);var n=t.read_shift(1)>>>5&3,i=t.read_shift(2),s=t.read_shift(4);return[n,i,s]}function Z0e(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2,"i");t.l+=8;var n=t.read_shift(2);return t.l+=12,[e,r,n]}function J0e(t,e,r){var n=t.read_shift(1)>>>5&3;t.l+=r&&r.biff==2?3:4;var i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function Q0e(t,e,r){var n=t.read_shift(1)>>>5&3,i=t.read_shift(r&&r.biff==2?1:2);return[n,i]}function ewe(t,e,r){var n=t.read_shift(1)>>>5&3;return t.l+=4,r.biff<8&&t.l--,r.biff==12&&(t.l+=2),[n]}function twe(t,e,r){var n=(t[t.l++]&96)>>5,i=t.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return t.l+=s,[n,i]}var rwe=Co,nwe=Co,iwe=Co;function Bg(t,e,r){return t.l+=2,[w0e(t)]}function oT(t){return t.l+=6,[]}var swe=Bg,owe=oT,awe=oT,lwe=Bg;function NF(t){return t.l+=2,[dF(t),t.read_shift(2)&1]}var uwe=Bg,cwe=NF,hwe=oT,dwe=Bg,fwe=Bg,gwe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function mwe(t){t.l+=2;var e=t.read_shift(2),r=t.read_shift(2),n=t.read_shift(4),i=t.read_shift(2),s=t.read_shift(2),o=gwe[r>>2&31];return{ixti:e,coltype:r&3,rt:o,idx:n,c:i,C:s}}function pwe(t){return t.l+=2,[t.read_shift(4)]}function wwe(t,e,r){return t.l+=5,t.l+=2,t.l+=r.biff==2?1:4,["PTGSHEET"]}function vwe(t,e,r){return t.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Cwe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function Swe(t){var e=t.read_shift(1)>>>5&3,r=t.read_shift(2);return[e,r]}function ywe(t){return t.l+=4,[0,0]}var wI={1:{n:"PtgExp",f:B0e},2:{n:"PtgTbl",f:iwe},3:{n:"PtgAdd",f:Fr},4:{n:"PtgSub",f:Fr},5:{n:"PtgMul",f:Fr},6:{n:"PtgDiv",f:Fr},7:{n:"PtgPower",f:Fr},8:{n:"PtgConcat",f:Fr},9:{n:"PtgLt",f:Fr},10:{n:"PtgLe",f:Fr},11:{n:"PtgEq",f:Fr},12:{n:"PtgGe",f:Fr},13:{n:"PtgGt",f:Fr},14:{n:"PtgNe",f:Fr},15:{n:"PtgIsect",f:Fr},16:{n:"PtgUnion",f:Fr},17:{n:"PtgRange",f:Fr},18:{n:"PtgUplus",f:Fr},19:{n:"PtgUminus",f:Fr},20:{n:"PtgPercent",f:Fr},21:{n:"PtgParen",f:Fr},22:{n:"PtgMissArg",f:Fr},23:{n:"PtgStr",f:z0e},26:{n:"PtgSheet",f:wwe},27:{n:"PtgEndSheet",f:vwe},28:{n:"PtgErr",f:V0e},29:{n:"PtgBool",f:U0e},30:{n:"PtgInt",f:W0e},31:{n:"PtgNum",f:j0e},32:{n:"PtgArray",f:E0e},33:{n:"PtgFunc",f:k0e},34:{n:"PtgFuncVar",f:F0e},35:{n:"PtgName",f:X0e},36:{n:"PtgRef",f:N0e},37:{n:"PtgArea",f:S0e},38:{n:"PtgMemArea",f:J0e},39:{n:"PtgMemErr",f:rwe},40:{n:"PtgMemNoMem",f:nwe},41:{n:"PtgMemFunc",f:Q0e},42:{n:"PtgRefErr",f:ewe},43:{n:"PtgAreaErr",f:b0e},44:{n:"PtgRefN",f:D0e},45:{n:"PtgAreaN",f:R0e},46:{n:"PtgMemAreaN",f:Cwe},47:{n:"PtgMemNoMemN",f:Swe},57:{n:"PtgNameX",f:q0e},58:{n:"PtgRef3d",f:H0e},59:{n:"PtgArea3d",f:y0e},60:{n:"PtgRefErr3d",f:twe},61:{n:"PtgAreaErr3d",f:x0e},255:{}},bwe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xwe={1:{n:"PtgElfLel",f:NF},2:{n:"PtgElfRw",f:dwe},3:{n:"PtgElfCol",f:swe},6:{n:"PtgElfRwV",f:fwe},7:{n:"PtgElfColV",f:lwe},10:{n:"PtgElfRadical",f:uwe},11:{n:"PtgElfRadicalS",f:hwe},13:{n:"PtgElfColS",f:owe},15:{n:"PtgElfColSV",f:awe},16:{n:"PtgElfRadicalLel",f:cwe},25:{n:"PtgList",f:mwe},29:{n:"PtgSxName",f:pwe},255:{}},Rwe={0:{n:"PtgAttrNoop",f:ywe},1:{n:"PtgAttrSemi",f:O0e},2:{n:"PtgAttrIf",f:A0e},4:{n:"PtgAttrChoose",f:T0e},8:{n:"PtgAttrGoto",f:_0e},16:{n:"PtgAttrSum",f:$0e},32:{n:"PtgAttrBaxcel",f:pI},33:{n:"PtgAttrBaxcel",f:pI},64:{n:"PtgAttrSpace",f:I0e},65:{n:"PtgAttrSpaceSemi",f:P0e},128:{n:"PtgAttrIfError",f:M0e},255:{}};function Ewe(t,e,r,n){if(n.biff<8)return Co(t,e);for(var i=t.l+e,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=K0e(t,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=G0e(t,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=t.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return e=i-t.l,e!==0&&s.push(Co(t,e)),s}function Twe(t,e,r){for(var n=t.l+e,i,s,o=[];n!=t.l;)e=n-t.l,s=t[t.l],i=wI[s]||wI[bwe[s]],(s===24||s===25)&&(i=(s===24?xwe:Rwe)[t[t.l+1]]),!i||!i.f?Co(t,e):o.push([i.n,i.f(t,e,r)]);return o}function _we(t){for(var e=[],r=0;r<t.length;++r){for(var n=t[r],i=[],s=0;s<n.length;++s){var o=n[s];if(o)switch(o[0]){case 2:i.push('"'+o[1].replace(/"/g,'""')+'"');break;default:i.push(o[1])}else i.push("")}e.push(i.join(","))}return e.join(";")}var Awe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Mwe(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function DF(t,e,r){if(!t)return"SH33TJSERR0";if(r.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var n=t.XTI[e];if(r.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(t[n[0]][0]){case 357:return i=n[1]==-1?"#REF":t.SheetNames[n[1]],n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 358:return r.SID!=null?t.SheetNames[r.SID]:"SH33TJSSAME"+t[n[0]][0];case 355:default:return"SH33TJSSRC"+t[n[0]][0]}switch(t[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":t.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+t.SheetNames[n[2]];case 14849:return t[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return t[n[0]][0][3]?(i=n[1]==-1?"#REF":t[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+t[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function vI(t,e,r){var n=DF(t,e,r);return n=="#REF"?n:Mwe(n,r)}function yh(t,e,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0},e:{c:0,r:0}},a=[],l,u,c,h=0,d=0,f,m="";if(!t[0]||!t[0][0])return"";for(var g=-1,w="",S=0,b=t[0].length;S<b;++S){var y=t[0][S];switch(y[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),u=a.pop(),g>=0){switch(t[0][g][1][0]){case 0:w=_r(" ",t[0][g][1][1]);break;case 1:w=_r("\r",t[0][g][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}u=u+w,g=-1}a.push(u+Awe[y[0]]+l);break;case"PtgIsect":l=a.pop(),u=a.pop(),a.push(u+" "+l);break;case"PtgUnion":l=a.pop(),u=a.pop(),a.push(u+","+l);break;case"PtgRange":l=a.pop(),u=a.pop(),a.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=_f(y[1][1],o,i),a.push(Af(c,s));break;case"PtgRefN":c=r?_f(y[1][1],r,i):y[1][1],a.push(Af(c,s));break;case"PtgRef3d":h=y[1][1],c=_f(y[1][2],o,i),m=vI(n,h,i),a.push(m+"!"+Af(c,s));break;case"PtgFunc":case"PtgFuncVar":var _=y[1][0],P=y[1][1];_||(_=0),_&=127;var z=_==0?[]:a.slice(-_);a.length-=_,P==="User"&&(P=z.shift()),a.push(P+"("+z.join(",")+")");break;case"PtgBool":a.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(y[1]);break;case"PtgNum":a.push(String(y[1]));break;case"PtgStr":a.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(y[1]);break;case"PtgAreaN":f=rI(y[1][1],r?{s:r}:o,i),a.push(_y(f,i));break;case"PtgArea":f=rI(y[1][1],o,i),a.push(_y(f,i));break;case"PtgArea3d":h=y[1][1],f=y[1][2],m=vI(n,h,i),a.push(m+"!"+_y(f,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=y[1][2];var I=(n.names||[])[d-1]||(n[0]||[])[d],W=I?I.Name:"SH33TJSNAME"+String(d);W&&W.slice(0,6)=="_xlfn."&&!i.xlfn&&(W=W.slice(6)),a.push(W);break;case"PtgNameX":var L=y[1][1];d=y[1][2];var U;if(i.biff<=5)L<0&&(L=-L),n[L]&&(U=n[L][d]);else{var G="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][d]&&n[L][d].itab>0&&(G=n.SheetNames[n[L][d].itab-1]+"!"):G=n.SheetNames[d-1]+"!"),n[L]&&n[L][d])G+=n[L][d].Name;else if(n[0]&&n[0][d])G+=n[0][d].Name;else{var X=(DF(n,L,i)||"").split(";;");X[d-1]?G=X[d-1]:G+="SH33TJSERRX"}a.push(G);break}U||(U={Name:"SH33TJSERRY"}),a.push(U.Name);break;case"PtgParen":var le="(",xe=")";if(g>=0){switch(w="",t[0][g][1][0]){case 2:le=_r(" ",t[0][g][1][1])+le;break;case 3:le=_r("\r",t[0][g][1][1])+le;break;case 4:xe=_r(" ",t[0][g][1][1])+xe;break;case 5:xe=_r("\r",t[0][g][1][1])+xe;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][g][1][0])}g=-1}a.push(le+a.pop()+xe);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":c={c:y[1][1],r:y[1][0]};var be={c:r.c,r:r.r};if(n.sharedf[zt(c)]){var Ze=n.sharedf[zt(c)];a.push(yh(Ze,o,be,n,i))}else{var Le=!1;for(l=0;l!=n.arrayf.length;++l)if(u=n.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){a.push(yh(u[1],o,be,n,i)),Le=!0;break}Le||a.push(y[1])}break;case"PtgArray":a.push("{"+_we(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=S;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var Ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&Ne.indexOf(t[0][S][0])==-1){y=t[0][g];var Me=!0;switch(y[1][0]){case 4:Me=!1;case 0:w=_r(" ",y[1][1]);break;case 5:Me=!1;case 1:w=_r("\r",y[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}a.push((Me?w:"")+a.pop()+(Me?"":w)),g=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function Owe(t){if(t==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Lu(t);return Lu(0)}function Iwe(t,e,r,n,i){var s=$u(e,r,i),o=Owe(t.v),a=ge(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var u=ge(t.bf.length),c=0;c<t.bf.length;++c)u[c]=t.bf[c];var h=cn([s,o,a,u]);return h}function Wv(t,e,r){var n=t.read_shift(4),i=Twe(t,n,r),s=t.read_shift(4),o=s>0?Ewe(t,s,i,r):null;return[i,o]}var Pwe=Wv,Uv=Wv,Nwe=Wv,Dwe=Wv,Hwe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},HF={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},kwe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Fwe(t){var e="of:="+t.replace(iT,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function Lwe(t){return t.replace(/\./,"!")}var Mf=typeof Map<"u";function aT(t,e,r){var n=0,i=t.length;if(r){if(Mf?r.has(e):Object.prototype.hasOwnProperty.call(r,e)){for(var s=Mf?r.get(e):r[e];n<s.length;++n)if(t[s[n]].t===e)return t.Count++,s[n]}}else for(;n<i;++n)if(t[n].t===e)return t.Count++,n;return t[i]={t:e},t.Count++,t.Unique++,r&&(Mf?(r.has(e)||r.set(e,[]),r.get(e).push(i)):(Object.prototype.hasOwnProperty.call(r,e)||(r[e]=[]),r[e].push(i))),i}function jv(t,e){var r={min:t+1,max:t+1},n=-1;return e.MDW&&(ua=e.MDW),e.width!=null?r.customWidth=1:e.wpx!=null?n=Tw(e.wpx):e.wch!=null&&(n=e.wch),n>-1?(r.width=tb(n),r.customWidth=1):e.width!=null&&(r.width=e.width),e.hidden&&(r.hidden=!0),e.level!=null&&(r.outlineLevel=r.level=e.level),r}function kF(t,e){if(t){var r=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=r[0]),t.right==null&&(t.right=r[1]),t.top==null&&(t.top=r[2]),t.bottom==null&&(t.bottom=r[3]),t.header==null&&(t.header=r[4]),t.footer==null&&(t.footer=r[5])}}function El(t,e,r){var n=r.revssf[e.z!=null?e.z:"General"],i=60,s=t.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){Ik(e.z,i),r.ssf[i]=e.z,r.revssf[e.z]=n=i;break}}for(i=0;i!=s;++i)if(t[i].numFmtId===n)return i;return t[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function $we(t,e,r){if(t&&t["!ref"]){var n=ur(t["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+t["!ref"])}}function Bwe(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',r=0;r!=t.length;++r)e+='<mergeCell ref="'+$r(t[r])+'"/>';return e+"</mergeCells>"}function Vwe(t,e,r,n,i){var s=!1,o={},a=null;if(n.bookType!=="xlsx"&&e.vbaraw){var l=e.SheetNames[r];try{e.Workbook&&(l=e.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,o.codeName=tg(jt(l))}if(t&&t["!outline"]){var u={summaryBelow:1,summaryRight:1};t["!outline"].above&&(u.summaryBelow=0),t["!outline"].left&&(u.summaryRight=0),a=(a||"")+Te("outlinePr",null,u)}!s&&!a||(i[i.length]=Te("sheetPr",a,o))}var Wwe=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Uwe=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jwe(t){var e={sheet:1};return Wwe.forEach(function(r){t[r]!=null&&t[r]&&(e[r]="1")}),Uwe.forEach(function(r){t[r]!=null&&!t[r]&&(e[r]="0")}),t.password&&(e.password=CF(t.password).toString(16).toUpperCase()),Te("sheetProtection",null,e)}function zwe(t){return kF(t),Te("pageMargins",null,t)}function Ywe(t,e){for(var r=["<cols>"],n,i=0;i!=e.length;++i)(n=e[i])&&(r[r.length]=Te("col",null,jv(i,n)));return r[r.length]="</cols>",r.join("")}function Gwe(t,e,r,n){var i=typeof t.ref=="string"?t.ref:$r(t.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ei(i);o.s.r==o.e.r&&(o.e.r=Ei(e["!ref"]).e.r,i=$r(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Te("autoFilter",null,{ref:i})}function Kwe(t,e,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Te("sheetViews",Te("sheetView",null,i),{})}function Xwe(t,e,r,n){if(t.c&&r["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var i="",s=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":i=t.v?"1":"0";break;case"n":i=""+t.v;break;case"e":i=$g[t.v];break;case"d":n&&n.cellDates?i=Bn(t.v,-1).toISOString():(t=oi(t),t.t="n",i=""+(t.v=si(Bn(t.v)))),typeof t.z>"u"&&(t.z=Mr[14]);break;default:i=t.v;break}var a=hn("v",jt(i)),l={r:e},u=El(n.cellXfs,t,n);switch(u!==0&&(l.s=u),t.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=hn("v",""+aT(n.Strings,t.v,n.revStrings)),l.t="s";break}l.t="str";break}if(t.t!=s&&(t.t=s,t.v=o),typeof t.f=="string"&&t.f){var c=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;a=Te("f",jt(t.f),c)+(t.v!=null?a:"")}return t.l&&r["!links"].push([e,t.l]),t.D&&(l.cm=1),Te("c",a,l)}function qwe(t,e,r,n){var i=[],s=[],o=ur(t["!ref"]),a="",l,u="",c=[],h=0,d=0,f=t["!rows"],m=Array.isArray(t),g={r:u},w,S=-1;for(d=o.s.c;d<=o.e.c;++d)c[d]=Tn(d);for(h=o.s.r;h<=o.e.r;++h){for(s=[],u=dn(h),d=o.s.c;d<=o.e.c;++d){l=c[d]+u;var b=m?(t[h]||[])[d]:t[l];b!==void 0&&(a=Xwe(b,l,t,e))!=null&&s.push(a)}(s.length>0||f&&f[h])&&(g={r:u},f&&f[h]&&(w=f[h],w.hidden&&(g.hidden=1),S=-1,w.hpx?S=_w(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(g.ht=S,g.customHeight=1),w.level&&(g.outlineLevel=w.level)),i[i.length]=Te("row",s.join(""),g))}if(f)for(;h<f.length;++h)f&&f[h]&&(g={r:h+1},w=f[h],w.hidden&&(g.hidden=1),S=-1,w.hpx?S=_w(w.hpx):w.hpt&&(S=w.hpt),S>-1&&(g.ht=S,g.customHeight=1),w.level&&(g.outlineLevel=w.level),i[i.length]=Te("row","",g));return i.join("")}function FF(t,e,r,n){var i=[Vr,Te("worksheet",null,{xmlns:Dh[0],"xmlns:r":rn.r})],s=r.SheetNames[t],o=0,a="",l=r.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",c=ur(u);if(c.e.c>16383||c.e.r>1048575){if(e.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=$r(c)}n||(n={}),l["!comments"]=[];var h=[];Vwe(l,r,t,e,i),i[i.length]=Te("dimension",null,{ref:u}),i[i.length]=Kwe(l,e,t,r),e.sheetFormat&&(i[i.length]=Te("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Ywe(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=qwe(l,e),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=jwe(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Gwe(l["!autofilter"],l,r,t)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Bwe(l["!merges"]));var d=-1,f,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(f={ref:g[0]},g[1].Target.charAt(0)!="#"&&(m=Ut(n,-1,jt(g[1].Target).replace(/#.*$/,""),Mt.HLINK),f["r:id"]="rId"+m),(d=g[1].Target.indexOf("#"))>-1&&(f.location=jt(g[1].Target.slice(d+1))),g[1].Tooltip&&(f.tooltip=jt(g[1].Tooltip)),i[i.length]=Te("hyperlink",null,f))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=zwe(l["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(i[i.length]=hn("ignoredErrors",Te("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(m=Ut(n,-1,"../drawings/drawing"+(t+1)+".xml",Mt.DRAW),i[i.length]=Te("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=h),l["!comments"].length>0&&(m=Ut(n,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Mt.VML),i[i.length]=Te("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function Zwe(t,e){var r={},n=t.l+e;r.r=t.read_shift(4),t.l+=4;var i=t.read_shift(2);t.l+=1;var s=t.read_shift(1);return t.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Jwe(t,e,r){var n=ge(145),i=(r["!rows"]||[])[t]||{};n.write_shift(4,t),n.write_shift(4,0);var s=320;i.hpx?s=_w(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var u={r:t,c:0},c=0;c<16;++c)if(!(e.s.c>c+1<<10||e.e.c<c<<10)){for(var h=-1,d=-1,f=c<<10;f<c+1<<10;++f){u.c=f;var m=Array.isArray(r)?(r[u.r]||[])[u.c]:r[zt(u)];m&&(h<0&&(h=f),d=f)}h<0||(++a,n.write_shift(4,h),n.write_shift(4,d))}var g=n.l;return n.l=l,n.write_shift(4,a),n.l=g,n.length>n.l?n.slice(0,n.l):n}function Qwe(t,e,r,n){var i=Jwe(n,r,e);(i.length>17||(e["!rows"]||[])[n])&&we(t,0,i)}var eve=rc,tve=kh;function rve(){}function nve(t,e){var r={},n=t[t.l];return++t.l,r.above=!(n&64),r.left=!(n&128),t.l+=18,r.name=fme(t),r}function ive(t,e,r){r==null&&(r=ge(84+4*t.length));var n=192;e&&(e.above&&(n&=-65),e.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return xw({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Jk(t,r),r.slice(0,r.l)}function sve(t){var e=Qi(t);return[e]}function ove(t,e,r){return r==null&&(r=ge(8)),Qu(e,r)}function ave(t){var e=ec(t);return[e]}function lve(t,e,r){return r==null&&(r=ge(4)),tc(e,r)}function uve(t){var e=Qi(t),r=t.read_shift(1);return[e,r,"b"]}function cve(t,e,r){return r==null&&(r=ge(9)),Qu(e,r),r.write_shift(1,t.v?1:0),r}function hve(t){var e=ec(t),r=t.read_shift(1);return[e,r,"b"]}function dve(t,e,r){return r==null&&(r=ge(5)),tc(e,r),r.write_shift(1,t.v?1:0),r}function fve(t){var e=Qi(t),r=t.read_shift(1);return[e,r,"e"]}function gve(t,e,r){return r==null&&(r=ge(9)),Qu(e,r),r.write_shift(1,t.v),r}function mve(t){var e=ec(t),r=t.read_shift(1);return[e,r,"e"]}function pve(t,e,r){return r==null&&(r=ge(8)),tc(e,r),r.write_shift(1,t.v),r.write_shift(2,0),r.write_shift(1,0),r}function wve(t){var e=Qi(t),r=t.read_shift(4);return[e,r,"s"]}function vve(t,e,r){return r==null&&(r=ge(12)),Qu(e,r),r.write_shift(4,e.v),r}function Cve(t){var e=ec(t),r=t.read_shift(4);return[e,r,"s"]}function Sve(t,e,r){return r==null&&(r=ge(8)),tc(e,r),r.write_shift(4,e.v),r}function yve(t){var e=Qi(t),r=Fh(t);return[e,r,"n"]}function bve(t,e,r){return r==null&&(r=ge(16)),Qu(e,r),Lu(t.v,r),r}function xve(t){var e=ec(t),r=Fh(t);return[e,r,"n"]}function Rve(t,e,r){return r==null&&(r=ge(12)),tc(e,r),Lu(t.v,r),r}function Eve(t){var e=Qi(t),r=Qk(t);return[e,r,"n"]}function Tve(t,e,r){return r==null&&(r=ge(12)),Qu(e,r),eF(t.v,r),r}function _ve(t){var e=ec(t),r=Qk(t);return[e,r,"n"]}function Ave(t,e,r){return r==null&&(r=ge(8)),tc(e,r),eF(t.v,r),r}function Mve(t){var e=Qi(t),r=QE(t);return[e,r,"is"]}function Ove(t){var e=Qi(t),r=_n(t);return[e,r,"str"]}function Ive(t,e,r){return r==null&&(r=ge(12+4*t.v.length)),Qu(e,r),sn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Pve(t){var e=ec(t),r=_n(t);return[e,r,"str"]}function Nve(t,e,r){return r==null&&(r=ge(8+4*t.v.length)),tc(e,r),sn(t.v,r),r.length>r.l?r.slice(0,r.l):r}function Dve(t,e,r){var n=t.l+e,i=Qi(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"b"];if(r.cellFormula){t.l+=2;var a=Uv(t,n-t.l,r);o[3]=yh(a,null,i,r.supbooks,r)}else t.l=n;return o}function Hve(t,e,r){var n=t.l+e,i=Qi(t);i.r=r["!row"];var s=t.read_shift(1),o=[i,s,"e"];if(r.cellFormula){t.l+=2;var a=Uv(t,n-t.l,r);o[3]=yh(a,null,i,r.supbooks,r)}else t.l=n;return o}function kve(t,e,r){var n=t.l+e,i=Qi(t);i.r=r["!row"];var s=Fh(t),o=[i,s,"n"];if(r.cellFormula){t.l+=2;var a=Uv(t,n-t.l,r);o[3]=yh(a,null,i,r.supbooks,r)}else t.l=n;return o}function Fve(t,e,r){var n=t.l+e,i=Qi(t);i.r=r["!row"];var s=_n(t),o=[i,s,"str"];if(r.cellFormula){t.l+=2;var a=Uv(t,n-t.l,r);o[3]=yh(a,null,i,r.supbooks,r)}else t.l=n;return o}var Lve=rc,$ve=kh;function Bve(t,e){return e==null&&(e=ge(4)),e.write_shift(4,t),e}function Vve(t,e){var r=t.l+e,n=rc(t),i=eT(t),s=_n(t),o=_n(t),a=_n(t);t.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function Wve(t,e){var r=ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));kh({s:nn(t[0]),e:nn(t[0])},r),tT("rId"+e,r);var n=t[1].Target.indexOf("#"),i=n==-1?"":t[1].Target.slice(n+1);return sn(i||"",r),sn(t[1].Tooltip||"",r),sn("",r),r.slice(0,r.l)}function Uve(){}function jve(t,e,r){var n=t.l+e,i=tF(t),s=t.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=Pwe(t,n-t.l,r);o[1]=a}else t.l=n;return o}function zve(t,e,r){var n=t.l+e,i=rc(t),s=[i];if(r.cellFormula){var o=Dwe(t,n-t.l,r);s[1]=o,t.l=n}else t.l=n;return s}function Yve(t,e,r){r==null&&(r=ge(18));var n=jv(t,e);r.write_shift(-4,t),r.write_shift(-4,t),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return e.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),e.level&&(i|=e.level<<8),r.write_shift(2,i),r}var LF=["left","right","top","bottom","header","footer"];function Gve(t){var e={};return LF.forEach(function(r){e[r]=Fh(t)}),e}function Kve(t,e){return e==null&&(e=ge(6*8)),kF(t),LF.forEach(function(r){Lu(t[r],e)}),e}function Xve(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function qve(t,e,r){r==null&&(r=ge(30));var n=924;return(((e||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Zve(t){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),kh(t,e),e}function Jve(t,e){return e==null&&(e=ge(16*4+2)),e.write_shift(2,t.password?CF(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?e.write_shift(4,t[r[0]]!=null&&!t[r[0]]?1:0):e.write_shift(4,t[r[0]]!=null&&t[r[0]]?0:1)}),e}function Qve(){}function eCe(){}function tCe(t,e,r,n,i,s,o){if(e.v===void 0)return!1;var a="";switch(e.t){case"b":a=e.v?"1":"0";break;case"d":e=oi(e),e.z=e.z||Mr[14],e.v=si(Bn(e.v)),e.t="n";break;case"n":case"e":a=""+e.v;break;default:a=e.v;break}var l={r,c:n};switch(l.s=El(i.cellXfs,e,i),e.l&&s["!links"].push([zt(l),e.l]),e.c&&s["!comments"].push([zt(l),e.c]),e.t){case"s":case"str":return i.bookSST?(a=aT(i.Strings,e.v,i.revStrings),l.t="s",l.v=a,o?we(t,18,Sve(e,l)):we(t,7,vve(e,l))):(l.t="str",o?we(t,17,Nve(e,l)):we(t,6,Ive(e,l))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?o?we(t,13,Ave(e,l)):we(t,2,Tve(e,l)):o?we(t,16,Rve(e,l)):we(t,5,bve(e,l)),!0;case"b":return l.t="b",o?we(t,15,dve(e,l)):we(t,4,cve(e,l)),!0;case"e":return l.t="e",o?we(t,14,pve(e,l)):we(t,3,gve(e,l)),!0}return o?we(t,12,lve(e,l)):we(t,1,ove(e,l)),!0}function rCe(t,e,r,n){var i=ur(e["!ref"]||"A1"),s,o="",a=[];we(t,145);var l=Array.isArray(e),u=i.e.r;e["!rows"]&&(u=Math.max(i.e.r,e["!rows"].length-1));for(var c=i.s.r;c<=u;++c){o=dn(c),Qwe(t,e,i,c);var h=!1;if(c<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){c===i.s.r&&(a[d]=Tn(d)),s=a[d]+o;var f=l?(e[c]||[])[d]:e[s];if(!f){h=!1;continue}h=tCe(t,f,c,d,n,e,h)}}we(t,146)}function nCe(t,e){!e||!e["!merges"]||(we(t,177,Bve(e["!merges"].length)),e["!merges"].forEach(function(r){we(t,176,$ve(r))}),we(t,178))}function iCe(t,e){!e||!e["!cols"]||(we(t,390),e["!cols"].forEach(function(r,n){r&&we(t,60,Yve(n,r))}),we(t,391))}function sCe(t,e){!e||!e["!ref"]||(we(t,648),we(t,649,Zve(ur(e["!ref"]))),we(t,650))}function oCe(t,e,r){e["!links"].forEach(function(n){if(n[1].Target){var i=Ut(r,-1,n[1].Target.replace(/#.*$/,""),Mt.HLINK);we(t,494,Wve(n,i))}}),delete e["!links"]}function aCe(t,e,r,n){if(e["!comments"].length>0){var i=Ut(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Mt.VML);we(t,551,tT("rId"+i)),e["!legacy"]=i}}function lCe(t,e,r,n){if(e["!autofilter"]){var i=e["!autofilter"],s=typeof i.ref=="string"?i.ref:$r(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=Ei(s);a.s.r==a.e.r&&(a.e.r=Ei(e["!ref"]).e.r,s=$r(a));for(var l=0;l<o.length;++l){var u=o[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),we(t,161,kh(ur(s))),we(t,162)}}function uCe(t,e,r){we(t,133),we(t,137,qve(e,r)),we(t,138),we(t,134)}function cCe(t,e){e["!protect"]&&we(t,535,Jve(e["!protect"]))}function hCe(t,e,r,n){var i=ii(),s=r.SheetNames[t],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[t].CodeName||a)}catch{}var l=ur(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],we(i,129),(r.vbaraw||o["!outline"])&&we(i,147,ive(a,o["!outline"])),we(i,148,tve(l)),uCe(i,o,r.Workbook),iCe(i,o),rCe(i,o,t,e),cCe(i,o),lCe(i,o,r,t),nCe(i,o),oCe(i,o,n),o["!margins"]&&we(i,476,Kve(o["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&sCe(i,o),aCe(i,o,t,n),we(i,130),i.end()}function dCe(t,e){t.l+=10;var r=_n(t);return{name:r}}var fCe=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function gCe(t){return!t.Workbook||!t.Workbook.WBProps?"false":zge(t.Workbook.WBProps.date1904)?"true":"false"}var mCe="][*?/\\".split("");function $F(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return mCe.forEach(function(n){if(t.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function pCe(t,e,r){t.forEach(function(n,i){$F(n);for(var s=0;s<i;++s)if(n==t[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=e&&e[i]&&e[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function wCe(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];pCe(t.SheetNames,e,!!t.vbaraw);for(var r=0;r<t.SheetNames.length;++r)$we(t.Sheets[t.SheetNames[r]],t.SheetNames[r],r)}function BF(t){var e=[Vr];e[e.length]=Te("workbook",null,{xmlns:Dh[0],"xmlns:r":rn.r});var r=t.Workbook&&(t.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(fCe.forEach(function(a){t.Workbook.WBProps[a[0]]!=null&&t.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=t.Workbook.WBProps[a[0]])}),t.Workbook.WBProps.CodeName&&(n.codeName=t.Workbook.WBProps.CodeName,delete n.CodeName)),e[e.length]=Te("workbookPr",null,n);var i=t.Workbook&&t.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(e[e.length]="<bookViews>",s=0;s!=t.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==t.SheetNames.length&&(s=0),e[e.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",s=0;s!=t.SheetNames.length;++s){var o={name:jt(t.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}e[e.length]=Te("sheet",null,o)}return e[e.length]="</sheets>",r&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(e[e.length]=Te("definedName",jt(a.Ref),l))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function vCe(t,e){var r={};return r.Hidden=t.read_shift(4),r.iTabID=t.read_shift(4),r.strRelID=eb(t),r.name=_n(t),r}function CCe(t,e){return e||(e=ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),tT(t.strRelID,e),sn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function SCe(t,e){var r={},n=t.read_shift(4);r.defaultThemeVersion=t.read_shift(4);var i=e>8?_n(t):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function yCe(t,e){e||(e=ge(72));var r=0;return t&&t.filterPrivacy&&(r|=8),e.write_shift(4,r),e.write_shift(4,0),Jk(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function bCe(t,e,r){var n=t.l+e;t.l+=4,t.l+=1;var i=t.read_shift(4),s=gme(t),o=Nwe(t,0,r),a=eT(t);t.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function xCe(t,e){we(t,143);for(var r=0;r!=e.SheetNames.length;++r){var n=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[r]&&e.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:e.SheetNames[r]};we(t,156,CCe(i))}we(t,144)}function RCe(t,e){e||(e=ge(127));for(var r=0;r!=4;++r)e.write_shift(4,0);return sn("SheetJS",e),sn(pw.version,e),sn(pw.version,e),sn("7262",e),e.length>e.l?e.slice(0,e.l):e}function ECe(t,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var r=120;return e.write_shift(1,r),e.length>e.l?e.slice(0,e.l):e}function TCe(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var r=e.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(we(t,135),we(t,158,ECe(i)),we(t,136))}}function _Ce(t,e){var r=ii();return we(r,131),we(r,128,RCe()),we(r,153,yCe(t.Workbook&&t.Workbook.WBProps||null)),TCe(r,t),xCe(r,t),we(r,132),r.end()}function ACe(t,e,r){return(e.slice(-4)===".bin"?_Ce:BF)(t)}function MCe(t,e,r,n,i){return(e.slice(-4)===".bin"?hCe:FF)(t,r,n,i)}function OCe(t,e,r){return(e.slice(-4)===".bin"?Kpe:bF)(t,r)}function ICe(t,e,r){return(e.slice(-4)===".bin"?ype:vF)(t,r)}function PCe(t,e,r){return(e.slice(-4)===".bin"?c0e:_F)(t)}function NCe(t){return(t.slice(-4)===".bin"?r0e:EF)()}function DCe(t,e){var r=[];return t.Props&&r.push(Ome(t.Props,e)),t.Custprops&&r.push(Ime(t.Props,t.Custprops)),r.join("")}function HCe(){return""}function kCe(t,e){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(n,i){var s=[];s.push(Te("NumberFormat",null,{"ss:Format":jt(Mr[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(Te("Style",s.join(""),o))}),Te("Styles",r.join(""))}function VF(t){return Te("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+sT(t.Ref,{r:0,c:0})})}function FCe(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,r=[],n=0;n<e.length;++n){var i=e[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(VF(i)))}return Te("Names",r.join(""))}function LCe(t,e,r,n){if(!t||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(VF(a)))}return s.join("")}function $Ce(t,e,r,n){if(!t)return"";var i=[];if(t["!margins"]&&(i.push("<PageSetup>"),t["!margins"].header&&i.push(Te("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&i.push(Te("Footer",null,{"x:Margin":t["!margins"].footer})),i.push(Te("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Te("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),t["!protect"]&&(i.push(hn("ProtectContents","True")),t["!protect"].objects&&i.push(hn("ProtectObjects","True")),t["!protect"].scenarios&&i.push(hn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?i.push(hn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&i.push(hn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":Te("WorksheetOptions",i.join(""),{xmlns:bi.x})}function BCe(t){return t.map(function(e){var r=jge(e.t||""),n=Te("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Te("Comment",n,{"ss:Author":e.a})}).join("")}function VCe(t,e,r,n,i,s,o){if(!t||t.v==null&&t.f==null)return"";var a={};if(t.f&&(a["ss:Formula"]="="+jt(sT(t.f,o))),t.F&&t.F.slice(0,e.length)==e){var l=nn(t.F.slice(e.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(t.l&&t.l.Target&&(a["ss:HRef"]=jt(t.l.Target),t.l.Tooltip&&(a["x:HRefScreenTip"]=jt(t.l.Tooltip))),r["!merges"])for(var u=r["!merges"],c=0;c!=u.length;++c)u[c].s.c!=o.c||u[c].s.r!=o.r||(u[c].e.c>u[c].s.c&&(a["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(a["ss:MergeDown"]=u[c].e.r-u[c].s.r));var h="",d="";switch(t.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(t.v);break;case"b":h="Boolean",d=t.v?"1":"0";break;case"e":h="Error",d=$g[t.v];break;case"d":h="DateTime",d=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Mr[14]);break;case"s":h="String",d=Uge(t.v||"");break}var f=El(n.cellXfs,t,n);a["ss:StyleID"]="s"+(21+f),a["ss:Index"]=o.c+1;var m=t.v!=null?d:"",g=t.t=="z"?"":'<Data ss:Type="'+h+'">'+m+"</Data>";return(t.c||[]).length>0&&(g+=BCe(t.c)),Te("Cell",g,a)}function WCe(t,e){var r='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=yF(e.hpt)),e.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(r+=' ss:Hidden="1"')),r+">"}function UCe(t,e,r,n){if(!t["!ref"])return"";var i=ur(t["!ref"]),s=t["!merges"]||[],o=0,a=[];t["!cols"]&&t["!cols"].forEach(function(w,S){nT(w);var b=!!w.width,y=jv(S,w),_={"ss:Index":S+1};b&&(_["ss:Width"]=Ew(y.width)),w.hidden&&(_["ss:Hidden"]="1"),a.push(Te("Column",null,_))});for(var l=Array.isArray(t),u=i.s.r;u<=i.e.r;++u){for(var c=[WCe(u,(t["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>u)&&!(s[o].e.c<h)&&!(s[o].e.r<u)){(s[o].s.c!=h||s[o].s.r!=u)&&(d=!0);break}if(!d){var f={r:u,c:h},m=zt(f),g=l?(t[u]||[])[h]:t[m];c.push(VCe(g,m,t,e,r,n,f))}}c.push("</Row>"),c.length>2&&a.push(c.join(""))}return a.join("")}function jCe(t,e,r){var n=[],i=r.SheetNames[t],s=r.Sheets[i],o=s?LCe(s,e,t,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?UCe(s,e,t,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push($Ce(s,e,t,r)),n.join("")}function zCe(t,e){e||(e={}),t.SSF||(t.SSF=oi(Mr)),t.SSF&&($v(),Lv(t.SSF),e.revssf=Bv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],El(e.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(DCe(t,e)),r.push(HCe()),r.push(""),r.push("");for(var n=0;n<t.SheetNames.length;++n)r.push(Te("Worksheet",jCe(n,e,t),{"ss:Name":jt(t.SheetNames[n])}));return r[2]=kCe(t,e),r[3]=FCe(t),Vr+Te("Workbook",r.join(""),{xmlns:bi.ss,"xmlns:o":bi.o,"xmlns:x":bi.x,"xmlns:ss":bi.ss,"xmlns:dt":bi.dt,"xmlns:html":bi.html})}var Oy={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function YCe(t,e){var r=[],n=[],i=[],s=0,o,a=zO(iI,"n"),l=zO(sI,"n");if(t.Props)for(o=fn(t.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Props[o[s]]]);if(t.Custprops)for(o=fn(t.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(t.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],t.Custprops[o[s]]]);var u=[];for(s=0;s<i.length;++s)hF.indexOf(i[s][0])>-1||lF.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);n.length&&Xt.utils.cfb_add(e,"/SummaryInformation",cI(n,Oy.SI,l,sI)),(r.length||u.length)&&Xt.utils.cfb_add(e,"/DocumentSummaryInformation",cI(r,Oy.DSI,a,iI,u.length?u:null,Oy.UDI))}function GCe(t,e){var r=e||{},n=Xt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Xt.utils.cfb_add(n,i,WF(t,r)),r.biff==8&&(t.Props||t.Custprops)&&YCe(t,n),r.biff==8&&t.vbaraw&&h0e(n,Xt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),n}var KCe={0:{f:Zwe},1:{f:sve},2:{f:Eve},3:{f:fve},4:{f:uve},5:{f:yve},6:{f:Ove},7:{f:wve},8:{f:Fve},9:{f:kve},10:{f:Dve},11:{f:Hve},12:{f:ave},13:{f:_ve},14:{f:mve},15:{f:hve},16:{f:xve},17:{f:Pve},18:{f:Cve},19:{f:QE},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:bCe},40:{},42:{},43:{f:Ope},44:{f:Ape},45:{f:Npe},46:{f:Hpe},47:{f:Dpe},48:{},49:{f:ame},50:{},51:{f:Zpe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:lpe},62:{f:Mve},63:{f:n0e},64:{f:Qve},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Co,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Xve},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:nve},148:{f:eve,p:16},151:{f:Uve},152:{},153:{f:SCe},154:{},155:{},156:{f:vCe},157:{},158:{},159:{T:1,f:vpe},160:{T:-1},161:{T:1,f:rc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Lve},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Xpe},336:{T:-1},337:{f:e0e,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:eb},357:{},358:{},359:{},360:{T:1},361:{},362:{f:rpe},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jve},427:{f:zve},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Gve},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:rve},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Vve},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:eb},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:l0e},633:{T:1},634:{T:-1},635:{T:1,f:o0e},636:{T:-1},637:{f:hme},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:dCe},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:eCe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function _e(t,e,r,n){var i=e;if(!isNaN(i)){var s=n||(r||[]).length||0,o=t.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&qE(r)&&t.push(r)}}function XCe(t,e,r,n){var i=(r||[]).length||0;if(i<=8224)return _e(t,e,r,i);var s=e;if(!isNaN(s)){for(var o=r.parts||[],a=0,l=0,u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;var c=t.next(4);for(c.write_shift(2,s),c.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u;l<i;){for(c=t.next(4),c.write_shift(2,60),u=0;u+(o[a]||8224)<=8224;)u+=o[a]||8224,a++;c.write_shift(2,u),t.push(r.slice(l,l+u)),l+=u}}}function Vg(t,e,r){return t||(t=ge(7)),t.write_shift(2,e),t.write_shift(2,r),t.write_shift(2,0),t.write_shift(1,0),t}function qCe(t,e,r,n){var i=ge(9);return Vg(i,t,e),fF(r,n||"b",i),i}function ZCe(t,e,r){var n=ge(8+2*r.length);return Vg(n,t,e),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function JCe(t,e,r,n){if(e.v!=null)switch(e.t){case"d":case"n":var i=e.t=="d"?si(Bn(e.v)):e.v;i==(i|0)&&i>=0&&i<65536?_e(t,2,dpe(r,n,i)):_e(t,3,hpe(r,n,i));return;case"b":case"e":_e(t,5,qCe(r,n,e.v,e.t));return;case"s":case"str":_e(t,4,ZCe(r,n,(e.v||"").slice(0,255)));return}_e(t,1,Vg(null,r,n))}function QCe(t,e,r,n){var i=Array.isArray(e),s=ur(e["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=$r(s)}for(var u=s.s.r;u<=s.e.r;++u){a=dn(u);for(var c=s.s.c;c<=s.e.c;++c){u===s.s.r&&(l[c]=Tn(c)),o=l[c]+a;var h=i?(e[u]||[])[c]:e[o];h&&JCe(t,h,u,c)}}}function eSe(t,e){for(var r=e||{},n=ii(),i=0,s=0;s<t.SheetNames.length;++s)t.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&t.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return _e(n,r.biff==4?1033:r.biff==3?521:9,rT(t,16,r)),QCe(n,t.Sheets[t.SheetNames[i]],i,r),_e(n,10),n.end()}function tSe(t,e,r){_e(t,49,Kme({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function rSe(t,e,r){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)e[i]!=null&&_e(t,1054,Zme(i,e[i],r))})}function nSe(t,e){var r=ge(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),_e(t,2151,r),r=ge(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),pF(ur(e["!ref"]||"A1"),r),r.write_shift(4,4),_e(t,2152,r)}function iSe(t,e){for(var r=0;r<16;++r)_e(t,224,dI({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(n){_e(t,224,dI(n,0,e))})}function sSe(t,e){for(var r=0;r<e["!links"].length;++r){var n=e["!links"][r];_e(t,440,spe(n)),n[1].Tooltip&&_e(t,2048,ope(n))}delete e["!links"]}function oSe(t,e){if(e){var r=0;e.forEach(function(n,i){++r<=256&&n&&_e(t,125,upe(jv(i,n),i))})}}function aSe(t,e,r,n,i){var s=16+El(i.cellXfs,e,i);if(e.v==null&&!e.bf){_e(t,513,$u(r,n,s));return}if(e.bf)_e(t,6,Iwe(e,r,n,i,s));else switch(e.t){case"d":case"n":var o=e.t=="d"?si(Bn(e.v)):e.v;_e(t,515,tpe(r,n,o,s));break;case"b":case"e":_e(t,517,epe(r,n,e.v,s,i,e.t));break;case"s":case"str":if(i.bookSST){var a=aT(i.Strings,e.v,i.revStrings);_e(t,253,Xme(r,n,a,s))}else _e(t,516,qme(r,n,(e.v||"").slice(0,255),s,i));break;default:_e(t,513,$u(r,n,s))}}function lSe(t,e,r){var n=ii(),i=r.SheetNames[t],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[t]||{},l=Array.isArray(s),u=e.biff==8,c,h="",d=[],f=ur(s["!ref"]||"A1"),m=u?65536:16384;if(f.e.c>255||f.e.r>=m){if(e.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}_e(n,2057,rT(r,16,e)),_e(n,13,$i(1)),_e(n,12,$i(100)),_e(n,15,Fn(!0)),_e(n,17,Fn(!1)),_e(n,16,Lu(.001)),_e(n,95,Fn(!0)),_e(n,42,Fn(!1)),_e(n,43,Fn(!1)),_e(n,130,$i(1)),_e(n,128,Qme()),_e(n,131,Fn(!1)),_e(n,132,Fn(!1)),u&&oSe(n,s["!cols"]),_e(n,512,Jme(f,e)),u&&(s["!links"]=[]);for(var g=f.s.r;g<=f.e.r;++g){h=dn(g);for(var w=f.s.c;w<=f.e.c;++w){g===f.s.r&&(d[w]=Tn(w)),c=d[w]+h;var S=l?(s[g]||[])[w]:s[c];S&&(aSe(n,S,g,w,e),u&&S.l&&s["!links"].push([c,S.l]))}}var b=a.CodeName||a.name||i;return u&&_e(n,574,Gme((o.Views||[])[0])),u&&(s["!merges"]||[]).length&&_e(n,229,ipe(s["!merges"])),u&&sSe(n,s),_e(n,442,mF(b)),u&&nSe(n,s),_e(n,10),n.end()}function uSe(t,e,r){var n=ii(),i=(t||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,l=r.biff==5;if(_e(n,2057,rT(t,5,r)),r.bookType=="xla"&&_e(n,135),_e(n,225,a?$i(1200):null),_e(n,193,Dme(2)),l&&_e(n,191),l&&_e(n,192),_e(n,226),_e(n,92,Ume("SheetJS",r)),_e(n,66,$i(a?1200:1252)),a&&_e(n,353,$i(0)),a&&_e(n,448),_e(n,317,cpe(t.SheetNames.length)),a&&t.vbaraw&&_e(n,211),a&&t.vbaraw){var u=o.CodeName||"ThisWorkbook";_e(n,442,mF(u))}_e(n,156,$i(17)),_e(n,25,Fn(!1)),_e(n,18,Fn(!1)),_e(n,19,$i(0)),a&&_e(n,431,Fn(!1)),a&&_e(n,444,$i(0)),_e(n,61,Yme()),_e(n,64,Fn(!1)),_e(n,141,$i(0)),_e(n,34,Fn(gCe(t)=="true")),_e(n,14,Fn(!0)),a&&_e(n,439,Fn(!1)),_e(n,218,$i(0)),tSe(n,t,r),rSe(n,t.SSF,r),iSe(n,r),a&&_e(n,352,Fn(!1));var c=n.end(),h=ii();a&&_e(h,140,ape()),a&&r.Strings&&XCe(h,252,zme(r.Strings)),_e(h,10);var d=h.end(),f=ii(),m=0,g=0;for(g=0;g<t.SheetNames.length;++g)m+=(a?12:11)+(a?2:1)*t.SheetNames[g].length;var w=c.length+m+d.length;for(g=0;g<t.SheetNames.length;++g){var S=s[g]||{};_e(f,133,jme({pos:w,hs:S.Hidden||0,dt:0,name:t.SheetNames[g]},r)),w+=e[g].length}var b=f.end();if(m!=b.length)throw new Error("BS8 "+m+" != "+b.length);var y=[];return c.length&&y.push(c),b.length&&y.push(b),d.length&&y.push(d),cn(y)}function cSe(t,e){var r=e||{},n=[];t&&!t.SSF&&(t.SSF=oi(Mr)),t&&t.SSF&&($v(),Lv(t.SSF),r.revssf=Bv(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,lT(r),r.cellXfs=[],El(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var i=0;i<t.SheetNames.length;++i)n[n.length]=lSe(i,r,t);return n.unshift(uSe(t,n,r)),cn(n)}function WF(t,e){for(var r=0;r<=t.SheetNames.length;++r){var n=t.Sheets[t.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Ei(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=e||{};switch(s.biff||2){case 8:case 5:return cSe(t,e);case 4:case 3:case 2:return eSe(t,e)}throw new Error("invalid type "+s.bookType+" for BIFF")}function hSe(t,e,r,n){for(var i=t["!merges"]||[],s=[],o=e.s.c;o<=e.e.c;++o){for(var a=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>r||i[u].s.c>o)&&!(i[u].e.r<r||i[u].e.c<o)){if(i[u].s.r<r||i[u].s.c<o){a=-1;break}a=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(a<0)){var c=zt({r,c:o}),h=n.dense?(t[r]||[])[o]:t[c],d=h&&h.v!=null&&(h.h||Wge(h.w||(ma(h),h.w)||""))||"",f={};a>1&&(f.rowspan=a),l>1&&(f.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+c,s.push(Te("td",d,f))}}var m="<tr>";return m+s.join("")+"</tr>"}var dSe='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',fSe="</body></html>";function gSe(t,e,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function UF(t,e){var r=e||{},n=r.header!=null?r.header:dSe,i=r.footer!=null?r.footer:fSe,s=[n],o=Ei(t["!ref"]);r.dense=Array.isArray(t),s.push(gSe(t,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(hSe(t,o,a,r));return s.push("</table>"+i),s.join("")}function jF(t,e,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?nn(n.origin):n.origin;i=o.r,s=o.c}var a=e.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(t["!ref"]){var c=Ei(t["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),i==-1&&(u.e.r=i=c.e.r+1)}var h=[],d=0,f=t["!rows"]||(t["!rows"]=[]),m=0,g=0,w=0,S=0,b=0,y=0;for(t["!cols"]||(t["!cols"]=[]);m<a.length&&g<l;++m){var _=a[m];if(CI(_)){if(n.display)continue;f[g]={hidden:!0}}var P=_.children;for(w=S=0;w<P.length;++w){var z=P[w];if(!(n.display&&CI(z))){var I=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Yge(z.innerHTML),W=z.getAttribute("data-z")||z.getAttribute("z");for(d=0;d<h.length;++d){var L=h[d];L.s.c==S+s&&L.s.r<g+i&&g+i<=L.e.r&&(S=L.e.c+1-s,d=-1)}y=+z.getAttribute("colspan")||1,((b=+z.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:g+i,c:S+s},e:{r:g+i+(b||1)-1,c:S+s+(y||1)-1}});var U={t:"s",v:I},G=z.getAttribute("data-t")||z.getAttribute("t")||"";I!=null&&(I.length==0?U.t=G||"z":n.raw||I.trim().length==0||G=="s"||(I==="TRUE"?U={t:"b",v:!0}:I==="FALSE"?U={t:"b",v:!1}:isNaN(la(I))?isNaN(eg(I).getDate())||(U={t:"d",v:Bn(I)},n.cellDates||(U={t:"n",v:si(U.v)}),U.z=n.dateNF||Mr[14]):U={t:"n",v:la(I)})),U.z===void 0&&W!=null&&(U.z=W);var X="",le=z.getElementsByTagName("A");if(le&&le.length)for(var xe=0;xe<le.length&&!(le[xe].hasAttribute("href")&&(X=le[xe].getAttribute("href"),X.charAt(0)!="#"));++xe);X&&X.charAt(0)!="#"&&(U.l={Target:X}),n.dense?(t[g+i]||(t[g+i]=[]),t[g+i][S+s]=U):t[zt({c:S+s,r:g+i})]=U,u.e.c<S+s&&(u.e.c=S+s),S+=y}}++g}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+i),t["!ref"]=$r(u),g>=l&&(t["!fullref"]=$r((u.e.r=a.length-m+g-1+i,u))),t}function zF(t,e){var r=e||{},n=r.dense?[]:{};return jF(n,t,e)}function mSe(t,e){return Ju(zF(t,e),e)}function CI(t){var e="",r=pSe(t);return r&&(e=r(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function pSe(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var wSe=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+rg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Vr+e}}(),SI=function(){var t=function(s){return jt(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,a){var l=[];l.push('      <table:table table:name="'+jt(o.SheetNames[a])+`" table:style-name="ta1">
`);var u=0,c=0,h=Ei(s["!ref"]||"A1"),d=s["!merges"]||[],f=0,m=Array.isArray(s);if(s["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var g="",w=s["!rows"]||[];for(u=0;u<h.s.r;++u)g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=h.e.r;++u){for(g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`>
`),c=0;c<h.s.c;++c)l.push(e);for(;c<=h.e.c;++c){var S=!1,b={},y="";for(f=0;f!=d.length;++f)if(!(d[f].s.c>c)&&!(d[f].s.r>u)&&!(d[f].e.c<c)&&!(d[f].e.r<u)){(d[f].s.c!=c||d[f].s.r!=u)&&(S=!0),b["table:number-columns-spanned"]=d[f].e.c-d[f].s.c+1,b["table:number-rows-spanned"]=d[f].e.r-d[f].s.r+1;break}if(S){l.push(r);continue}var _=zt({r:u,c}),P=m?(s[u]||[])[c]:s[_];if(P&&P.f&&(b["table:formula"]=jt(Fwe(P.f)),P.F&&P.F.slice(0,_.length)==_)){var z=Ei(P.F);b["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,b["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!P){l.push(e);continue}switch(P.t){case"b":y=P.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=P.v?"true":"false";break;case"n":y=P.w||String(P.v||0),b["office:value-type"]="float",b["office:value"]=P.v||0;break;case"s":case"str":y=P.v==null?"":P.v,b["office:value-type"]="string";break;case"d":y=P.w||Bn(P.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=Bn(P.v).toISOString(),b["table:style-name"]="ce1";break;default:l.push(e);continue}var I=t(y);if(P.l&&P.l.Target){var W=P.l.Target;W=W.charAt(0)=="#"?"#"+Lwe(W.slice(1)):W,W.charAt(0)!="#"&&!W.match(/^\w+:/)&&(W="../"+W),I=Te("text:a",I,{"xlink:href":W.replace(/&/g,"&amp;")})}l.push("          "+Te("table:table-cell",Te("text:p",I,{}),b)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var h=u["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;nT(h),h.ods=a;var d=u["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(u){return o.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var h=u["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[Vr],u=rg({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=rg({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(oF().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(n(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function YF(t,e){if(e.bookType=="fods")return SI(t,e);var r=YE(),n="",i=[],s=[];return n="mimetype",wt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",wt(r,n,SI(t,e)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",wt(r,n,wSe(t,e)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",wt(r,n,Vr+oF()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",wt(r,n,Mme(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",wt(r,n,_me(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Aw(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function vSe(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ss(tg(t))}function CSe(t,e){e:for(var r=0;r<=t.length-e.length;++r){for(var n=0;n<e.length;++n)if(t[r+n]!=e[n])continue e;return!0}return!1}function Sl(t){var e=t.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(e),n=0;return t.forEach(function(i){r.set(i,n),n+=i.length}),r}function SSe(t,e,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);t[e+15]|=n>>7,t[e+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)t[e+s]=i&255;t[e+15]|=r>=0?0:128}function ng(t,e){var r=e?e[0]:0,n=t[r]&127;e:if(t[r++]>=128&&(n|=(t[r]&127)<<7,t[r++]<128||(n|=(t[r]&127)<<14,t[r++]<128)||(n|=(t[r]&127)<<21,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,28),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,35),++r,t[r++]<128)||(n+=(t[r]&127)*Math.pow(2,42),++r,t[r++]<128)))break e;return e&&(e[0]=r),n}function Vt(t){var e=new Uint8Array(7);e[0]=t&127;var r=1;e:if(t>127){if(e[r-1]|=128,e[r]=t>>7&127,++r,t<=16383||(e[r-1]|=128,e[r]=t>>14&127,++r,t<=2097151)||(e[r-1]|=128,e[r]=t>>21&127,++r,t<=268435455)||(e[r-1]|=128,e[r]=t/256>>>21&127,++r,t<=34359738367)||(e[r-1]|=128,e[r]=t/65536>>>21&127,++r,t<=4398046511103))break e;e[r-1]|=128,e[r]=t/16777216>>>21&127,++r}return e.slice(0,r)}function gh(t){var e=0,r=t[e]&127;e:if(t[e++]>=128){if(r|=(t[e]&127)<<7,t[e++]<128||(r|=(t[e]&127)<<14,t[e++]<128)||(r|=(t[e]&127)<<21,t[e++]<128))break e;r|=(t[e]&127)<<28}return r}function Gr(t){for(var e=[],r=[0];r[0]<t.length;){var n=r[0],i=ng(t,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];t[r[0]++]>=128;);a=t.slice(l,r[0])}break;case 5:o=4,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=ng(t,r),a=t.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var u={data:a,type:s};e[i]==null?e[i]=[u]:e[i].push(u)}return e}function ln(t){var e=[];return t.forEach(function(r,n){r.forEach(function(i){i.data&&(e.push(Vt(n*8+i.type)),i.type==2&&e.push(Vt(i.data.length)),e.push(i.data))})}),Sl(e)}function cs(t){for(var e,r=[],n=[0];n[0]<t.length;){var i=ng(t,n),s=Gr(t.slice(n[0],n[0]+i));n[0]+=i;var o={id:gh(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Gr(a.data),u=gh(l[3][0].data);o.messages.push({meta:l,data:t.slice(n[0],n[0]+u)}),n[0]+=u}),(e=s[3])!=null&&e[0]&&(o.merge=gh(s[3][0].data)>>>0>0),r.push(o)}return r}function Wc(t){var e=[];return t.forEach(function(r){var n=[];n[1]=[{data:Vt(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Vt(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Vt(o.data.length)}],n[2].push({data:ln(o.meta),type:2})});var s=ln(n);e.push(Vt(s.length)),e.push(s),i.forEach(function(o){return e.push(o)})}),Sl(e)}function ySe(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var r=[0],n=ng(e,r),i=[];r[0]<e.length;){var s=e[r[0]]&3;if(s==0){var o=e[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=e[r[0]],a>1&&(o|=e[r[0]+1]<<8),a>2&&(o|=e[r[0]+2]<<16),a>3&&(o|=e[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(e.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,u=0;if(s==1?(u=(e[r[0]]>>2&7)+4,l=(e[r[0]++]&224)<<3,l|=e[r[0]++]):(u=(e[r[0]++]>>2)+1,s==2?(l=e[r[0]]|e[r[0]+1]<<8,r[0]+=2):(l=(e[r[0]]|e[r[0]+1]<<8|e[r[0]+2]<<16|e[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Sl(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var c=Sl(i);if(c.length!=n)throw new Error("Unexpected length: ".concat(c.length," != ").concat(n));return c}function hs(t){for(var e=[],r=0;r<t.length;){var n=t[r++],i=t[r]|t[r+1]<<8|t[r+2]<<16;r+=3,e.push(ySe(n,t.slice(r,r+i))),r+=i}if(r!==t.length)throw new Error("data is not a valid framed stream!");return Sl(e)}function Uc(t){for(var e=[],r=0;r<t.length;){var n=Math.min(t.length-r,268435455),i=new Uint8Array(4);e.push(i);var s=Vt(n),o=s.length;e.push(s),n<=60?(o++,e.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,e.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,e.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,e.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,e.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),e.push(t.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return Sl(e)}function Iy(t,e){var r=new Uint8Array(32),n=Aw(r),i=12,s=0;switch(r[0]=5,t.t){case"n":r[1]=2,SSe(r,i,t.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,t.v?1:0,!0),s|=2,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[1]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Py(t,e){var r=new Uint8Array(32),n=Aw(r),i=12,s=0;switch(r[0]=3,t.t){case"n":r[2]=2,n.setFloat64(i,t.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,t.v?1:0,!0),s|=32,i+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));r[2]=3,n.setUint32(i,e.indexOf(t.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+t.t}return n.setUint32(4,s,!0),r.slice(0,i)}function Ba(t){var e=Gr(t);return ng(e[1][0].data)}function bSe(t,e,r){var n,i,s,o;if(!((n=t[6])!=null&&n[0])||!((i=t[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=t[8])==null?void 0:s[0])==null?void 0:o.data)&&gh(t[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,u=Aw(t[7][0].data),c=0,h=[],d=Aw(t[4][0].data),f=0,m=[],g=0;g<e.length;++g){if(e[g]==null){u.setUint16(g*2,65535,!0),d.setUint16(g*2,65535);continue}u.setUint16(g*2,c,!0),d.setUint16(g*2,f,!0);var w,S;switch(typeof e[g]){case"string":w=Iy({t:"s",v:e[g]},r),S=Py({t:"s",v:e[g]},r);break;case"number":w=Iy({t:"n",v:e[g]},r),S=Py({t:"n",v:e[g]},r);break;case"boolean":w=Iy({t:"b",v:e[g]},r),S=Py({t:"b",v:e[g]},r);break;default:throw new Error("Unsupported value "+e[g])}h.push(w),c+=w.length,m.push(S),f+=S.length,++l}for(t[2][0].data=Vt(l);g<t[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),d.setUint16(g*2,65535,!0);return t[6][0].data=Sl(h),t[3][0].data=Sl(m),l}function xSe(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ei(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat($r(n)));var s=Mw(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(C){return C.forEach(function(x){typeof x=="string"&&o.push(x)})});var a={},l=[],u=Xt.read(e.numbers,{type:"base64"});u.FileIndex.map(function(C,x){return[C,u.FullPaths[x]]}).forEach(function(C){var x=C[0],R=C[1];if(x.type==2&&x.name.match(/\.iwa/)){var F=x.content,q=hs(F),re=cs(q);re.forEach(function(fe){l.push(fe.id),a[fe.id]={deps:[],location:R,type:gh(fe.messages[0].meta[1][0].data)}})}}),l.sort(function(C,x){return C-x});var c=l.filter(function(C){return C>1}).map(function(C){return[C,Vt(C)]});u.FileIndex.map(function(C,x){return[C,u.FullPaths[x]]}).forEach(function(C){var x=C[0];if(C[1],!!x.name.match(/\.iwa/)){var R=cs(hs(x.content));R.forEach(function(F){F.messages.forEach(function(q){c.forEach(function(re){F.messages.some(function(fe){return gh(fe.meta[1][0].data)!=11006&&CSe(fe.data,re[1])})&&a[re[0]].deps.push(F.id)})})})}});for(var h=Xt.find(u,a[1].location),d=cs(hs(h.content)),f,m=0;m<d.length;++m){var g=d[m];g.id==1&&(f=g)}var w=Ba(Gr(f.messages[0].data)[1][0].data);for(h=Xt.find(u,a[w].location),d=cs(hs(h.content)),m=0;m<d.length;++m)g=d[m],g.id==w&&(f=g);for(w=Ba(Gr(f.messages[0].data)[2][0].data),h=Xt.find(u,a[w].location),d=cs(hs(h.content)),m=0;m<d.length;++m)g=d[m],g.id==w&&(f=g);for(w=Ba(Gr(f.messages[0].data)[2][0].data),h=Xt.find(u,a[w].location),d=cs(hs(h.content)),m=0;m<d.length;++m)g=d[m],g.id==w&&(f=g);var S=Gr(f.messages[0].data);{S[6][0].data=Vt(n.e.r+1),S[7][0].data=Vt(n.e.c+1);var b=Ba(S[46][0].data),y=Xt.find(u,a[b].location),_=cs(hs(y.content));{for(var P=0;P<_.length&&_[P].id!=b;++P);if(_[P].id!=b)throw"Bad ColumnRowUIDMapArchive";var z=Gr(_[P].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var I=0;I<=n.e.c;++I){var W=[];W[1]=W[2]=[{type:0,data:Vt(I+420690)}],z[1].push({type:2,data:ln(W)}),z[2].push({type:0,data:Vt(I)}),z[3].push({type:0,data:Vt(I)})}z[4]=[],z[5]=[],z[6]=[];for(var L=0;L<=n.e.r;++L)W=[],W[1]=W[2]=[{type:0,data:Vt(L+726270)}],z[4].push({type:2,data:ln(W)}),z[5].push({type:0,data:Vt(L)}),z[6].push({type:0,data:Vt(L)});_[P].messages[0].data=ln(z)}y.content=Uc(Wc(_)),y.size=y.content.length,delete S[46];var U=Gr(S[4][0].data);{U[7][0].data=Vt(n.e.r+1);var G=Gr(U[1][0].data),X=Ba(G[2][0].data);y=Xt.find(u,a[X].location),_=cs(hs(y.content));{if(_[0].id!=X)throw"Bad HeaderStorageBucket";var le=Gr(_[0].messages[0].data);for(L=0;L<s.length;++L){var xe=Gr(le[2][0].data);xe[1][0].data=Vt(L),xe[4][0].data=Vt(s[L].length),le[2][L]={type:le[2][0].type,data:ln(xe)}}_[0].messages[0].data=ln(le)}y.content=Uc(Wc(_)),y.size=y.content.length;var be=Ba(U[2][0].data);y=Xt.find(u,a[be].location),_=cs(hs(y.content));{if(_[0].id!=be)throw"Bad HeaderStorageBucket";for(le=Gr(_[0].messages[0].data),I=0;I<=n.e.c;++I)xe=Gr(le[2][0].data),xe[1][0].data=Vt(I),xe[4][0].data=Vt(n.e.r+1),le[2][I]={type:le[2][0].type,data:ln(xe)};_[0].messages[0].data=ln(le)}y.content=Uc(Wc(_)),y.size=y.content.length;var Ze=Ba(U[4][0].data);(function(){for(var C=Xt.find(u,a[Ze].location),x=cs(hs(C.content)),R,F=0;F<x.length;++F){var q=x[F];q.id==Ze&&(R=q)}var re=Gr(R.messages[0].data);{re[3]=[];var fe=[];o.forEach(function(Oe,Be){fe[1]=[{type:0,data:Vt(Be)}],fe[2]=[{type:0,data:Vt(1)}],fe[3]=[{type:2,data:vSe(Oe)}],re[3].push({type:2,data:ln(fe)})})}R.messages[0].data=ln(re);var de=Wc(x),pe=Uc(de);C.content=pe,C.size=C.content.length})();var Le=Gr(U[3][0].data);{var Ne=Le[1][0];delete Le[2];var Me=Gr(Ne.data);{var at=Ba(Me[2][0].data);(function(){for(var C=Xt.find(u,a[at].location),x=cs(hs(C.content)),R,F=0;F<x.length;++F){var q=x[F];q.id==at&&(R=q)}var re=Gr(R.messages[0].data);{delete re[6],delete Le[7];var fe=new Uint8Array(re[5][0].data);re[5]=[];for(var de=0,pe=0;pe<=n.e.r;++pe){var Oe=Gr(fe);de+=bSe(Oe,s[pe],o),Oe[1][0].data=Vt(pe),re[5].push({data:ln(Oe),type:2})}re[1]=[{type:0,data:Vt(n.e.c+1)}],re[2]=[{type:0,data:Vt(n.e.r+1)}],re[3]=[{type:0,data:Vt(de)}],re[4]=[{type:0,data:Vt(n.e.r+1)}]}R.messages[0].data=ln(re);var Be=Wc(x),ee=Uc(Be);C.content=ee,C.size=C.content.length})()}Ne.data=ln(Me)}U[3][0].data=ln(Le)}S[4][0].data=ln(U)}f.messages[0].data=ln(S);var v=Wc(d),p=Uc(v);return h.content=p,h.size=h.content.length,u}function RSe(t){return function(r){for(var n=0;n!=t.length;++n){var i=t[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function lT(t){RSe([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function ESe(t,e){return e.bookType=="ods"?YF(t,e):e.bookType=="numbers"?xSe(t,e):e.bookType=="xlsb"?TSe(t,e):_Se(t,e)}function TSe(t,e){rh=1024,t&&!t.SSF&&(t.SSF=oi(Mr)),t&&t.SSF&&($v(),Lv(t.SSF),e.revssf=Bv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Mf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r=e.bookType=="xlsb"?"bin":"xml",n=AF.indexOf(e.bookType)>-1,i=nF();lT(e=e||{});var s=YE(),o="",a=0;if(e.cellXfs=[],El(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",wt(s,o,aF(t.Props,e)),i.coreprops.push(o),Ut(e.rels,2,o,Mt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}for(t.Props.Worksheets=t.Props.SheetNames.length,wt(s,o,uF(t.Props)),i.extprops.push(o),Ut(e.rels,3,o,Mt.EXT_PROPS),t.Custprops!==t.Props&&fn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",wt(s,o,cF(t.Custprops)),i.custprops.push(o),Ut(e.rels,4,o,Mt.CUST_PROPS)),a=1;a<=t.SheetNames.length;++a){var c={"!id":{}},h=t.Sheets[t.SheetNames[a-1]],d=(h||{})["!type"]||"sheet";switch(d){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,wt(s,o,MCe(a-1,o,e,t,c)),i.sheets.push(o),Ut(e.wbrels,-1,"worksheets/sheet"+a+"."+r,Mt.WS[0])}if(h){var f=h["!comments"],m=!1,g="";f&&f.length>0&&(g="xl/comments"+a+"."+r,wt(s,g,PCe(f,g)),i.comments.push(g),Ut(c,-1,"../comments"+a+"."+r,Mt.CMNT),m=!0),h["!legacy"]&&m&&wt(s,"xl/drawings/vmlDrawing"+a+".vml",TF(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&wt(s,sF(o),dh(c))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,wt(s,o,ICe(e.Strings,o,e)),i.strs.push(o),Ut(e.wbrels,-1,"sharedStrings."+r,Mt.SST)),o="xl/workbook."+r,wt(s,o,ACe(t,o)),i.workbooks.push(o),Ut(e.rels,1,o,Mt.WB),o="xl/theme/theme1.xml",wt(s,o,RF(t.Themes,e)),i.themes.push(o),Ut(e.wbrels,-1,"theme/theme1.xml",Mt.THEME),o="xl/styles."+r,wt(s,o,OCe(t,o,e)),i.styles.push(o),Ut(e.wbrels,-1,"styles."+r,Mt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",wt(s,o,t.vbaraw),i.vba.push(o),Ut(e.wbrels,-1,"vbaProject.bin",Mt.VBA)),o="xl/metadata."+r,wt(s,o,NCe(o)),i.metadata.push(o),Ut(e.wbrels,-1,"metadata."+r,Mt.XLMETA),wt(s,"[Content_Types].xml",iF(i,e)),wt(s,"_rels/.rels",dh(e.rels)),wt(s,"xl/_rels/workbook."+r+".rels",dh(e.wbrels)),delete e.revssf,delete e.ssf,s}function _Se(t,e){rh=1024,t&&!t.SSF&&(t.SSF=oi(Mr)),t&&t.SSF&&($v(),Lv(t.SSF),e.revssf=Bv(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Mf?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var r="xml",n=AF.indexOf(e.bookType)>-1,i=nF();lT(e=e||{});var s=YE(),o="",a=0;if(e.cellXfs=[],El(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",wt(s,o,aF(t.Props,e)),i.coreprops.push(o),Ut(e.rels,2,o,Mt.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var l=[],u=0;u<t.SheetNames.length;++u)(t.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(t.SheetNames[u]);t.Props.SheetNames=l}t.Props.Worksheets=t.Props.SheetNames.length,wt(s,o,uF(t.Props)),i.extprops.push(o),Ut(e.rels,3,o,Mt.EXT_PROPS),t.Custprops!==t.Props&&fn(t.Custprops||{}).length>0&&(o="docProps/custom.xml",wt(s,o,cF(t.Custprops)),i.custprops.push(o),Ut(e.rels,4,o,Mt.CUST_PROPS));var c=["SheetJ5"];for(e.tcid=0,a=1;a<=t.SheetNames.length;++a){var h={"!id":{}},d=t.Sheets[t.SheetNames[a-1]],f=(d||{})["!type"]||"sheet";switch(f){case"chart":default:o="xl/worksheets/sheet"+a+"."+r,wt(s,o,FF(a-1,e,t,h)),i.sheets.push(o),Ut(e.wbrels,-1,"worksheets/sheet"+a+"."+r,Mt.WS[0])}if(d){var m=d["!comments"],g=!1,w="";if(m&&m.length>0){var S=!1;m.forEach(function(b){b[1].forEach(function(y){y.T==!0&&(S=!0)})}),S&&(w="xl/threadedComments/threadedComment"+a+"."+r,wt(s,w,i0e(m,c,e)),i.threadedcomments.push(w),Ut(h,-1,"../threadedComments/threadedComment"+a+"."+r,Mt.TCMNT)),w="xl/comments"+a+"."+r,wt(s,w,_F(m)),i.comments.push(w),Ut(h,-1,"../comments"+a+"."+r,Mt.CMNT),g=!0}d["!legacy"]&&g&&wt(s,"xl/drawings/vmlDrawing"+a+".vml",TF(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&wt(s,sF(o),dh(h))}return e.Strings!=null&&e.Strings.length>0&&(o="xl/sharedStrings."+r,wt(s,o,vF(e.Strings,e)),i.strs.push(o),Ut(e.wbrels,-1,"sharedStrings."+r,Mt.SST)),o="xl/workbook."+r,wt(s,o,BF(t)),i.workbooks.push(o),Ut(e.rels,1,o,Mt.WB),o="xl/theme/theme1.xml",wt(s,o,RF(t.Themes,e)),i.themes.push(o),Ut(e.wbrels,-1,"theme/theme1.xml",Mt.THEME),o="xl/styles."+r,wt(s,o,bF(t,e)),i.styles.push(o),Ut(e.wbrels,-1,"styles."+r,Mt.STY),t.vbaraw&&n&&(o="xl/vbaProject.bin",wt(s,o,t.vbaraw),i.vba.push(o),Ut(e.wbrels,-1,"vbaProject.bin",Mt.VBA)),o="xl/metadata."+r,wt(s,o,EF()),i.metadata.push(o),Ut(e.wbrels,-1,"metadata."+r,Mt.XLMETA),c.length>1&&(o="xl/persons/person.xml",wt(s,o,s0e(c)),i.people.push(o),Ut(e.wbrels,-1,"persons/person.xml",Mt.PEOPLE)),wt(s,"[Content_Types].xml",iF(i,e)),wt(s,"_rels/.rels",dh(e.rels)),wt(s,"xl/_rels/workbook."+r+".rels",dh(e.wbrels)),delete e.revssf,delete e.ssf,s}function ASe(t,e){var r="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":r=ga(t.slice(0,12));break;case"binary":r=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function GF(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Fg(e.file,Xt.write(t,{type:Nt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Xt.write(t,e)}function MSe(t,e){var r=oi(e||{}),n=ESe(t,r);return OSe(n,r)}function OSe(t,e){var r={},n=Nt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(r.compression="DEFLATE"),e.password)r.type=n;else switch(e.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+e.type)}var i=t.FullPaths?Xt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!e.compression}):t.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(e.type=="binary"||e.type=="base64")return i;i=new Uint8Array(Fv(i))}return e.password&&typeof encrypt_agile<"u"?GF(encrypt_agile(i,e.password),e):e.type==="file"?Fg(e.file,i):e.type=="string"?Ef(i):i}function ISe(t,e){var r=e||{},n=GCe(t,r);return GF(n,r)}function ro(t,e,r){r||(r="");var n=r+t;switch(e.type){case"base64":return Qf(tg(n));case"binary":return tg(n);case"string":return t;case"file":return Fg(e.file,n,"utf8");case"buffer":return Nt?ba(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):ro(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function PSe(t,e){switch(e.type){case"base64":return Qf(t);case"binary":return t;case"string":return t;case"file":return Fg(e.file,t,"binary");case"buffer":return Nt?ba(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Vp(t,e){switch(e.type){case"string":case"base64":case"binary":for(var r="",n=0;n<t.length;++n)r+=String.fromCharCode(t[n]);return e.type=="base64"?Qf(r):e.type=="string"?Ef(r):r;case"file":return Fg(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function KF(t,e){oge(),wCe(t);var r=oi(e||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=KF(t,r);return r.type="array",Fv(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=t.SheetNames.indexOf(r.sheet),!t.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return ro(zCe(t,r),r);case"slk":case"sylk":return ro(gpe.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"htm":case"html":return ro(UF(t.Sheets[t.SheetNames[i]],r),r);case"txt":return PSe(XF(t.Sheets[t.SheetNames[i]],r),r);case"csv":return ro(uT(t.Sheets[t.SheetNames[i]],r),r,"\uFEFF");case"dif":return ro(mpe.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"dbf":return Vp(fpe.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"prn":return ro(ppe.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"rtf":return ro(xpe.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"eth":return ro(wF.from_sheet(t.Sheets[t.SheetNames[i]],r),r);case"fods":return ro(YF(t,r),r);case"wk1":return Vp(fI.sheet_to_wk1(t.Sheets[t.SheetNames[i]],r),r);case"wk3":return Vp(fI.book_to_wk3(t,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Vp(WF(t,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),ISe(t,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return MSe(t,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function NSe(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(t.bookType=r.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function DSe(t,e,r){var n={};return n.type="file",n.file=e,NSe(n),KF(t,n)}function HSe(t,e,r,n,i,s,o,a){var l=dn(r),u=a.defval,c=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!o||t[r])for(var f=e.s.c;f<=e.e.c;++f){var m=o?t[r][f]:t[n[f]+l];if(m===void 0||m.t===void 0){if(u===void 0)continue;s[f]!=null&&(d[s[f]]=u);continue}var g=m.v;switch(m.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[f]!=null){if(g==null)if(m.t=="e"&&g===null)d[s[f]]=null;else if(u!==void 0)d[s[f]]=u;else if(c&&g===null)d[s[f]]=null;else continue;else d[s[f]]=c&&(m.t!=="n"||m.t==="n"&&a.rawNumbers!==!1)?g:ma(m,g,a);g!=null&&(h=!1)}}return{row:d,isempty:h}}function Mw(t,e){if(t==null||t["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},u=e||{},c=u.range!=null?u.range:t["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof c){case"string":l=ur(c);break;case"number":l=ur(t["!ref"]),l.s.r=c;break;default:l=c}n>0&&(i=0);var h=dn(l.s.r),d=[],f=[],m=0,g=0,w=Array.isArray(t),S=l.s.r,b=0,y={};w&&!t[S]&&(t[S]=[]);var _=u.skipHidden&&t["!cols"]||[],P=u.skipHidden&&t["!rows"]||[];for(b=l.s.c;b<=l.e.c;++b)if(!(_[b]||{}).hidden)switch(d[b]=Tn(b),r=w?t[S][b]:t[d[b]+h],n){case 1:s[b]=b-l.s.c;break;case 2:s[b]=d[b];break;case 3:s[b]=u.header[b-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=ma(r,null,u),g=y[o]||0,!g)y[o]=1;else{do a=o+"_"+g++;while(y[a]);y[o]=g,y[a]=1}s[b]=a}for(S=l.s.r+i;S<=l.e.r;++S)if(!(P[S]||{}).hidden){var z=HSe(t,l,S,d,n,s,w,u);(z.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(f[m++]=z.row)}return f.length=m,f}var yI=/"/g;function kSe(t,e,r,n,i,s,o,a){for(var l=!0,u=[],c="",h=dn(r),d=e.s.c;d<=e.e.c;++d)if(n[d]){var f=a.dense?(t[r]||[])[d]:t[n[d]+h];if(f==null)c="";else if(f.v!=null){l=!1,c=""+(a.rawNumbers&&f.t=="n"?f.v:ma(f,null,a));for(var m=0,g=0;m!==c.length;++m)if((g=c.charCodeAt(m))===i||g===s||g===34||a.forceQuotes){c='"'+c.replace(yI,'""')+'"';break}c=="ID"&&(c='"ID"')}else f.f!=null&&!f.F?(l=!1,c="="+f.f,c.indexOf(",")>=0&&(c='"'+c.replace(yI,'""')+'"')):c="";u.push(c)}return a.blankrows===!1&&l?null:u.join(o)}function uT(t,e){var r=[],n=e??{};if(t==null||t["!ref"]==null)return"";var i=ur(t["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];n.dense=Array.isArray(t);for(var d=n.skipHidden&&t["!cols"]||[],f=n.skipHidden&&t["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(d[m]||{}).hidden||(h[m]=Tn(m));for(var g=0,w=i.s.r;w<=i.e.r;++w)(f[w]||{}).hidden||(c=kSe(t,i,w,h,o,l,s,n),c!=null&&(n.strip&&(c=c.replace(u,"")),(c||n.blankrows!==!1)&&r.push((g++?a:"")+c)));return delete n.dense,r.join("")}function XF(t,e){e||(e={}),e.FS="	",e.RS=`
`;var r=uT(t,e);return r}function FSe(t){var e="",r,n="";if(t==null||t["!ref"]==null)return[];var i=ur(t["!ref"]),s="",o=[],a,l=[],u=Array.isArray(t);for(a=i.s.c;a<=i.e.c;++a)o[a]=Tn(a);for(var c=i.s.r;c<=i.e.r;++c)for(s=dn(c),a=i.s.c;a<=i.e.c;++a)if(e=o[a]+s,r=u?(t[c]||[])[a]:t[e],n="",r!==void 0){if(r.F!=null){if(e=r.F,!r.f)continue;n=r.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=e+"="+n}return l}function qF(t,e,r){var n=r||{},i=+!n.skipHeader,s=t||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?nn(n.origin):n.origin;o=l.r,a=l.c}var u,c={s:{c:0,r:0},e:{c:a,r:o+e.length-1+i}};if(s["!ref"]){var h=ur(s["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),o==-1&&(o=h.e.r+1,c.e.r=o+e.length-1+i)}else o==-1&&(o=0,c.e.r=e.length-1+i);var d=n.header||[],f=0;e.forEach(function(g,w){fn(g).forEach(function(S){(f=d.indexOf(S))==-1&&(d[f=d.length]=S);var b=g[S],y="z",_="",P=zt({c:a+f,r:o+w+i});u=ig(s,P),b&&typeof b=="object"&&!(b instanceof Date)?s[P]=b:(typeof b=="number"?y="n":typeof b=="boolean"?y="b":typeof b=="string"?y="s":b instanceof Date?(y="d",n.cellDates||(y="n",b=si(b)),_=n.dateNF||Mr[14]):b===null&&n.nullError&&(y="e",b=0),u?(u.t=y,u.v=b,delete u.w,delete u.R,_&&(u.z=_)):s[P]=u={t:y,v:b},_&&(u.z=_))})}),c.e.c=Math.max(c.e.c,a+d.length-1);var m=dn(o);if(i)for(f=0;f<d.length;++f)s[Tn(f+a)+m]={t:"s",v:d[f]};return s["!ref"]=$r(c),s}function LSe(t,e){return qF(null,t,e)}function ig(t,e,r){if(typeof e=="string"){if(Array.isArray(t)){var n=nn(e);return t[n.r]||(t[n.r]=[]),t[n.r][n.c]||(t[n.r][n.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?ig(t,zt(e)):ig(t,zt({r:e,c:r||0}))}function $Se(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var r=t.SheetNames.indexOf(e);if(r>-1)return r;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function BSe(){return{SheetNames:[],Sheets:{}}}function VSe(t,e,r,n){var i=1;if(!r)for(;i<=65535&&t.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&t.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&t.SheetNames.indexOf(r=o+i)!=-1;++i);}if($F(r),t.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return t.SheetNames.push(r),t.Sheets[r]=e,r}function WSe(t,e,r){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var n=$Se(t,e);switch(t.Workbook.Sheets[n]||(t.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}t.Workbook.Sheets[n].Hidden=r}function USe(t,e){return t.z=e,t}function ZF(t,e,r){return e?(t.l={Target:e},r&&(t.l.Tooltip=r)):delete t.l,t}function jSe(t,e,r){return ZF(t,"#"+e,r)}function zSe(t,e,r){t.c||(t.c=[]),t.c.push({t:e,a:r||"SheetJS"})}function YSe(t,e,r,n){for(var i=typeof e!="string"?e:ur(e),s=typeof e=="string"?e:$r(e),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=ig(t,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return t}var Ny={encode_col:Tn,encode_row:dn,encode_cell:zt,encode_range:$r,decode_col:JE,decode_row:ZE,split_cell:ome,decode_cell:nn,decode_range:Ei,format_cell:ma,sheet_add_aoa:Zk,sheet_add_json:qF,sheet_add_dom:jF,aoa_to_sheet:Hh,json_to_sheet:LSe,table_to_sheet:zF,table_to_book:mSe,sheet_to_csv:uT,sheet_to_txt:XF,sheet_to_json:Mw,sheet_to_html:UF,sheet_to_formulae:FSe,sheet_to_row_object_array:Mw,sheet_get_cell:ig,book_new:BSe,book_append_sheet:VSe,book_set_sheet_visibility:WSe,cell_set_number_format:USe,cell_set_hyperlink:ZF,cell_set_internal_link:jSe,cell_add_comment:zSe,sheet_set_array_formula:YSe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const GSe=(t,e)=>{if(!confirm("ìì ë¤ì´ë¡ë ë°ê² ìµëê¹?"))return;const n=Ny.book_new(),i=t.getSettings().columns,s=t.getColHeader(),o=t.getData();let a=[];if(o.forEach(h=>{let d={};h.forEach((f,m)=>{s[m]!=="mode"&&(d[s[m]]=f)}),a.push(d)}),a.length===0){console.error("ìì ë°ì´í°ê° ììµëë¤.");return}const l=Ny.json_to_sheet(a),u=i&&Array.isArray(i)?i.map((h,d)=>({width:(s[d]?s[d].length:0)*4})):[];l["!cols"]=u,Ny.book_append_sheet(n,l,e);const c=`${e}_${cT.format(new Date,cT.DATE_FORMAT_NUMBER)}.xlsx`;DSe(n,c)},gye={excelExport:GSe},KSe={class:"pagination"},XSe=["onClick"],Dy=10,qSe=eL({__name:"Pagination",props:{currentPage:{type:Number,required:!0},lastPage:{type:Number,required:!0}},emits:["update:page"],setup(t,{emit:e}){const r=t,n=e,i=tL(()=>{const o=Math.floor((r.currentPage-1)/Dy)*Dy+1,a=Math.min(o+Dy-1,r.lastPage),l=[];for(let u=o;u<=a;u++)l.push(u);return l}),s=o=>{o<1||o>r.lastPage||n("update:page",o)};return(o,a)=>(Kv(),Xv("div",KSe,[zg("span",{class:"icon first",onClick:a[0]||(a[0]=()=>{t.currentPage!==1&&s(1)})}," ï "),zg("span",{class:"icon pre",onClick:a[1]||(a[1]=()=>{t.currentPage!==1&&s(t.currentPage-1)})}," ï "),(Kv(!0),Xv(rL,null,nL(i.value,l=>(Kv(),Xv("span",{key:l,onClick:u=>s(l),class:iL(["page",{active:l===t.currentPage}])},sL(l),11,XSe))),128)),zg("span",{class:"icon next",onClick:a[2]||(a[2]=()=>{t.currentPage!==t.lastPage&&s(t.currentPage+1)})}," ï "),zg("span",{class:"icon last",onClick:a[3]||(a[3]=()=>{t.currentPage!==t.lastPage&&s(t.lastPage)})}," ï ")]))}}),mye=oL(qSe,[["__scopeId","data-v-4bd7d63c"]]);export{rt as H,mye as P,gye as e,fye as g};
