(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[428],{25:(e,t,i)=>{"use strict";var r,n,o=i(42620),s=i(53469),l=o.process,a=o.Deno,h=l&&l.versions||a&&a.version,u=h&&h.v8;u&&(n=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!n&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(n=+r[1]),e.exports=n},241:(e,t,i)=>{"use strict";var r=i(82309),n=i(99365),o=i(7411),s=i(2048),l=Object;e.exports=s?function(e){return"symbol"==typeof e}:function(e){var t=r("Symbol");return n(t)&&o(t.prototype,l(e))}},255:(e,t,i)=>{"use strict";i.d(t,{A:()=>S}),i(41658),i(12252),i(20775);var r=i(19857);i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var n=i(59149);function o(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,o="string"==typeof t.type?(0,n.r0)(t.type):t.type;if(e._automaticallyAssignedMetaProps&&(0,r.objectEach)(t,(t,i)=>void e._automaticallyAssignedMetaProps.delete(i)),!(0,r.isObject)(o))return;i!==e||e._automaticallyAssignedMetaProps||(e._automaticallyAssignedMetaProps=new Set);let s={};(0,r.objectEach)(o,(t,n)=>{var o,l;"CELL_TYPE"!==n&&((null===(o=i._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(n))||!(0,r.hasOwnProperty)(i,n))&&(s[n]=t,null===(l=e._automaticallyAssignedMetaProps)||void 0===l||l.add(n))}),(0,r.extend)(e,s)}function s(e){return Number.isInteger(e)&&e>=0}function l(e,t){if(!e())throw Error(`Assertion failed: ${t}`)}var a=i(5322);function h(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class u{constructor(e){h(this,"metaCtor",class{}),h(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,r.extend)(this.meta,(0,a.A)()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var t;(0,r.extend)(this.meta,e),o(this.meta,{...e,type:null!==(t=e.type)&&void 0!==t?t:this.meta.type},e)}}class c{constructor(e){!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"meta",void 0);let t=e.getMetaConstructor();this.meta=new t}getMeta(){return this.meta}updateMeta(e){(0,r.extend)(this.meta,e),o(this.meta,e,e)}}function d(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(19398),i(29954);class g{constructor(e){d(this,"valueFactory",void 0),d(this,"data",[]),d(this,"index",[]),d(this,"holes",new Set),this.valueFactory=e}obtain(e){let t;l(()=>s(e),"Expecting an unsigned number.");let i=this._getStorageIndexByKey(e);if(i>=0)void 0===(t=this.data[i])&&(t=this.valueFactory(e),this.data[i]=t);else if(t=this.valueFactory(e),this.holes.size>0){let i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=t,this.index[e]=i}else this.data.push(t),this.index[e]=this.data.length-1;return t}insert(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(()=>s(e)||null==e,"Expecting an unsigned number or null/undefined argument.");let i=[],r=this.data.length;for(let e=0;e<t;e++)i.push(r+e),this.data.push(void 0);let n=null==e?this.index.length:e;this.index=[...this.index.slice(0,n),...i,...this.index.slice(n)]}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(()=>s(e)||null==e,"Expecting an unsigned number or null/undefined argument.");let i=this.index.splice(null==e?this.index.length-t:e,t);for(let e=0;e<i.length;e++){let t=i[e];"number"==typeof t&&this.holes.add(t)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,t)=>void 0!==e&&!this.holes.has(t))[Symbol.iterator]()}entries(){let e=[];for(let t=0;t<this.data.length;t++){let i=this._getKeyByStorageIndex(t);-1!==i&&void 0!==this.data[t]&&e.push([i,this.data[t]])}let t=0;return{next:()=>{if(t<e.length){let i=e[t];return t+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function f(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let p=["data","width"];class m{constructor(e){f(this,"globalMeta",void 0),f(this,"metas",new g(()=>this._createMeta())),this.globalMeta=e,this.metas=new g(()=>this._createMeta())}updateMeta(e,t){let i=this.getMeta(e);(0,r.extend)(i,t),o(i,t)}createColumn(e,t){this.metas.insert(e,t)}removeColumn(e,t){this.metas.remove(e,t)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function i(){}(0,r.inherit)(i,e);for(let e=0;e<t.length;e++)i.prototype[t[e]]=void 0;return i}(this.globalMeta.getMetaConstructor(),p).prototype}}var w=i(78887);function y(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class b{constructor(e){y(this,"columnMeta",void 0),y(this,"metas",new g(()=>this._createRow())),this.columnMeta=e}updateMeta(e,t,i){let n=this.getMeta(e,t);(0,r.extend)(n,i),o(n,i)}createRow(e,t){this.metas.insert(e,t)}createColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,t)}removeRow(e,t){this.metas.remove(e,t)}removeColumn(e,t){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,t)}getMeta(e,t,i){let r=this.metas.obtain(e).obtain(t);return void 0===i?r:r[i]}setMeta(e,t,i,r){var n;let o=this.metas.obtain(e).obtain(t);null===(n=o._automaticallyAssignedMetaProps)||void 0===n||n.delete(i),o[i]=r}removeMeta(e,t,i){let r=this.metas.obtain(e).obtain(t);delete r[i]}getMetas(){let e=[],t=Array.from(this.metas.values());for(let i=0;i<t.length;i++)(0,w.isDefined)(t[i])&&e.push(...t[i].values());return e}getMetasAtRow(e){l(()=>s(e),"Expecting an unsigned number.");let t=new Map(this.metas);return t.has(e)?Array.from(t.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new g(e=>this._createMeta(e))}_createMeta(e){return new(this.columnMeta.getMetaConstructor(e))}}var C=i(81174);class S{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=e,this.globalMeta=new u(e),this.tableMeta=new c(this.globalMeta),this.columnMeta=new m(this.globalMeta),this.cellMeta=new b(this.columnMeta),i.forEach(e=>new e(this)),this.globalMeta.updateMeta(t)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,t){this.columnMeta.updateMeta(e,t)}getCellMeta(e,t,i){let r=this.cellMeta.getMeta(e,t);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=t,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,t,i){if("string"!=typeof i)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,t,i)}setCellMeta(e,t,i,r){this.cellMeta.setMeta(e,t,i,r)}updateCellMeta(e,t,i){this.cellMeta.updateMeta(e,t,i)}removeCellMeta(e,t,i){this.cellMeta.removeMeta(e,t,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(e,t)}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(e,t)}createColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(e,t),this.columnMeta.createColumn(e,t)}removeColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(e,t),this.columnMeta.removeColumn(e,t)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}(0,r.mixin)(S,C.A)},808:(e,t,i)=>{"use strict";i.d(t,{$L:()=>O,Lm:()=>o,Ln:()=>p,Um:()=>M,Wg:()=>m,X9:()=>s,dL:()=>V,jP:()=>b,n9:()=>x,oM:()=>C,zy:()=>T});var r=i(10156);class n{constructor(e,t,i){this.pos=e,this.delInfo=t,this.recover=i}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class o{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&o.empty)return o.empty}recover(e){let t=0,i=65535&e;if(!this.inverted)for(let e=0;e<i;e++)t+=this.ranges[3*e+2]-this.ranges[3*e+1];return this.ranges[3*i]+t+(e-(65535&e))/65536}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,i){let r=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>e)break;let h=this.ranges[l+o],u=this.ranges[l+s],c=a+h;if(e<=c){let o=h?e==a?-1:e==c?1:t:t,s=a+r+(o<0?0:u);if(i)return s;let d=e==(t<0?a:c)?null:l/3+(e-a)*65536,g=e==a?2:e==c?1:4;return(t<0?e!=a:e!=c)&&(g|=8),new n(s,g,d)}r+=u-h}return i?e+r:new n(e+r,0,null)}touches(e,t){let i=0,r=65535&t,n=this.inverted?2:1,o=this.inverted?1:2;for(let t=0;t<this.ranges.length;t+=3){let s=this.ranges[t]-(this.inverted?i:0);if(s>e)break;let l=this.ranges[t+n];if(e<=s+l&&t==3*r)return!0;i+=this.ranges[t+o]-l}return!1}forEach(e){let t=this.inverted?2:1,i=this.inverted?1:2;for(let r=0,n=0;r<this.ranges.length;r+=3){let o=this.ranges[r],s=o-(this.inverted?n:0),l=o+(this.inverted?0:n),a=this.ranges[r+t],h=this.ranges[r+i];e(s,s+a,l,l+h),n+=h-a}}invert(){return new o(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?o.empty:new o(e<0?[0,-e,0]:[0,0,e])}}o.empty=new o([]);class s{constructor(e,t,i=0,r=e?e.length:0){this.mirror=t,this.from=i,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new s(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,i=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?i+r:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,i=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?i-r-1:void 0)}}invert(){let e=new s;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let i=this.from;i<this.to;i++)e=this._maps[i].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,i){let r=0;for(let i=this.from;i<this.to;i++){let n=this._maps[i].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(i);if(null!=t&&t>i&&t<this.to){i=t,e=this._maps[t].recover(n.recover);continue}}r|=n.delInfo,e=n.pos}return i?e:new n(e,r,null)}}let l=Object.create(null);class a{getMap(){return o.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw RangeError("Invalid input for Step.fromJSON");let i=l[t.stepType];if(!i)throw RangeError(`No step type ${t.stepType} defined`);return i.fromJSON(e,t)}static jsonID(e,t){if(e in l)throw RangeError("Duplicate use of step JSON ID "+e);return l[e]=t,t.prototype.jsonID=e,t}}class h{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new h(e,null)}static fail(e){return new h(null,e)}static fromReplace(e,t,i,n){try{return h.ok(e.replace(t,i,n))}catch(e){if(e instanceof r.vI)return h.fail(e.message);throw e}}}function u(e,t,i){let n=[];for(let r=0;r<e.childCount;r++){let o=e.child(r);o.content.size&&(o=o.copy(u(o.content,t,o))),o.isInline&&(o=t(o,i,r)),n.push(o)}return r.FK.fromArray(n)}class c extends a{constructor(e,t,i){super(),this.from=e,this.to=t,this.mark=i}apply(e){let t=e.slice(this.from,this.to),i=e.resolve(this.from),n=i.node(i.sharedDepth(this.to)),o=new r.Ji(u(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,n),t.openStart,t.openEnd);return h.fromReplace(e,this.from,this.to,o)}invert(){return new d(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return t.deleted&&i.deleted||t.pos>=i.pos?null:new c(t.pos,i.pos,this.mark)}merge(e){return e instanceof c&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new c(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new c(t.from,t.to,e.markFromJSON(t.mark))}}a.jsonID("addMark",c);class d extends a{constructor(e,t,i){super(),this.from=e,this.to=t,this.mark=i}apply(e){let t=e.slice(this.from,this.to),i=new r.Ji(u(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return h.fromReplace(e,this.from,this.to,i)}invert(){return new c(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return t.deleted&&i.deleted||t.pos>=i.pos?null:new d(t.pos,i.pos,this.mark)}merge(e){return e instanceof d&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new d(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new d(t.from,t.to,e.markFromJSON(t.mark))}}a.jsonID("removeMark",d);class g extends a{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return h.fail("No node at mark step's position");let i=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return h.fromReplace(e,this.pos,this.pos+1,new r.Ji(r.FK.from(i),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(e))return new g(this.pos,t.marks[i]);return new g(this.pos,this.mark)}}return new f(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new g(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new g(t.pos,e.markFromJSON(t.mark))}}a.jsonID("addNodeMark",g);class f extends a{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return h.fail("No node at mark step's position");let i=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return h.fromReplace(e,this.pos,this.pos+1,new r.Ji(r.FK.from(i),0,+!t.isLeaf))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new g(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new f(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new f(t.pos,e.markFromJSON(t.mark))}}a.jsonID("removeNodeMark",f);class p extends a{constructor(e,t,i,r=!1){super(),this.from=e,this.to=t,this.slice=i,this.structure=r}apply(e){return this.structure&&w(e,this.from,this.to)?h.fail("Structure replace would overwrite content"):h.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new o([this.from,this.to-this.from,this.slice.size])}invert(e){return new p(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),i=e.mapResult(this.to,-1);return t.deletedAcross&&i.deletedAcross?null:new p(t.pos,Math.max(t.pos,i.pos),this.slice,this.structure)}merge(e){if(!(e instanceof p)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart)if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;else{let t=this.slice.size+e.slice.size==0?r.Ji.empty:new r.Ji(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new p(e.from,this.to,t,this.structure)}{let t=this.slice.size+e.slice.size==0?r.Ji.empty:new r.Ji(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new p(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new p(t.from,t.to,r.Ji.fromJSON(e,t.slice),!!t.structure)}}a.jsonID("replace",p);class m extends a{constructor(e,t,i,r,n,o,s=!1){super(),this.from=e,this.to=t,this.gapFrom=i,this.gapTo=r,this.slice=n,this.insert=o,this.structure=s}apply(e){if(this.structure&&(w(e,this.from,this.gapFrom)||w(e,this.gapTo,this.to)))return h.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return h.fail("Gap is not a flat range");let i=this.slice.insertAt(this.insert,t.content);return i?h.fromReplace(e,this.from,this.to,i):h.fail("Content does not fit in gap")}getMap(){return new o([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new m(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),i=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),n=this.to==this.gapTo?i.pos:e.map(this.gapTo,1);return t.deletedAcross&&i.deletedAcross||r<t.pos||n>i.pos?null:new m(t.pos,i.pos,r,n,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new m(t.from,t.to,t.gapFrom,t.gapTo,r.Ji.fromJSON(e,t.slice),t.insert,!!t.structure)}}function w(e,t,i){let r=e.resolve(t),n=i-t,o=r.depth;for(;n>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,n--;if(n>0){let e=r.node(o).maybeChild(r.indexAfter(o));for(;n>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,n--}}return!1}function y(e,t,i,n=i.contentMatch,o=!0){let s=e.doc.nodeAt(t),l=[],a=t+1;for(let t=0;t<s.childCount;t++){let h=s.child(t),u=a+h.nodeSize,c=n.matchType(h.type);if(c){n=c;for(let t=0;t<h.marks.length;t++)i.allowsMarkType(h.marks[t].type)||e.step(new d(a,u,h.marks[t]));if(o&&h.isText&&"pre"!=i.whitespace){let e,t=/\r?\n|\r/g,n;for(;e=t.exec(h.text);)n||(n=new r.Ji(r.FK.from(i.schema.text(" ",i.allowedMarks(h.marks))),0,0)),l.push(new p(a+e.index,a+e.index+e[0].length,n))}}else l.push(new p(a,u,r.Ji.empty));a=u}if(!n.validEnd){let t=n.fillBefore(r.FK.empty,!0);e.replace(a,a,new r.Ji(t,0,0))}for(let t=l.length-1;t>=0;t--)e.step(l[t])}function b(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let i=e.depth;;--i){let r=e.$from.node(i),n=e.$from.index(i),o=e.$to.indexAfter(i);if(i<e.depth&&r.canReplace(n,o,t))return i;if(0==i||r.type.spec.isolating||!((0==n||r.canReplace(n,r.childCount))&&(o==r.childCount||r.canReplace(0,o))))break}return null}function C(e,t,i=null,r=e){let n=function(e,t){let{parent:i,startIndex:r,endIndex:n}=e,o=i.contentMatchAt(r).findWrapping(t);if(!o)return null;let s=o.length?o[0]:t;return i.canReplaceWith(r,n,s)?o:null}(e,t),o=n&&function(e,t){let{parent:i,startIndex:r,endIndex:n}=e,o=i.child(r),s=t.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:t).contentMatch;for(let e=r;l&&e<n;e++)l=l.matchType(i.child(e).type);return l&&l.validEnd?s:null}(r,t);return o?n.map(S).concat({type:t,attrs:i}).concat(o.map(S)):null}function S(e){return{type:e,attrs:null}}function E(e,t,i,r){t.forEach((n,o)=>{if(n.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(n.text);){let n=e.mapping.slice(r).map(i+1+o+s.index);e.replaceWith(n,n+1,t.type.schema.linebreakReplacement.create())}}})}function R(e,t,i,r){t.forEach((n,o)=>{if(n.type==n.type.schema.linebreakReplacement){let n=e.mapping.slice(r).map(i+1+o);e.replaceWith(n,n+1,t.type.schema.text("\n"))}})}function T(e,t,i=1,r){let n=e.resolve(t),o=n.depth-i,s=r&&r[r.length-1]||n.parent;if(o<0||n.parent.type.spec.isolating||!n.parent.canReplace(n.index(),n.parent.childCount)||!s.type.validContent(n.parent.content.cutByIndex(n.index(),n.parent.childCount)))return!1;for(let e=n.depth-1,t=i-2;e>o;e--,t--){let i=n.node(e),o=n.index(e);if(i.type.spec.isolating)return!1;let s=i.content.cutByIndex(o,i.childCount),l=r&&r[t+1];l&&(s=s.replaceChild(0,l.type.create(l.attrs)));let a=r&&r[t]||i;if(!i.canReplace(o+1,i.childCount)||!a.type.validContent(s))return!1}let l=n.indexAfter(o),a=r&&r[0];return n.node(o).canReplaceWith(l,l,a?a.type:n.node(o+1).type)}function x(e,t){let i=e.resolve(t),r=i.index();return function(e,t){return!!(e&&t&&!e.isLeaf&&function(e,t){t.content.size||e.type.compatibleContent(t.type);let i=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let n=0;n<t.childCount;n++){let o=t.child(n),s=o.type==r?e.type.schema.nodes.text:o.type;if(!(i=i.matchType(s))||!e.type.allowsMarks(o.marks))return!1}return i.validEnd}(e,t))}(i.nodeBefore,i.nodeAfter)&&i.parent.canReplace(r,r+1)}a.jsonID("replaceAround",m);function M(e,t,i){let r=e.resolve(t);if(!i.content.size)return t;let n=i.content;for(let e=0;e<i.openStart;e++)n=n.firstChild.content;for(let e=1;e<=(0==i.openStart&&i.size?2:1);e++)for(let t=r.depth;t>=0;t--){let i=t==r.depth?0:r.pos<=(r.start(t+1)+r.end(t+1))/2?-1:1,o=r.index(t)+ +(i>0),s=r.node(t),l=!1;if(1==e)l=s.canReplace(o,o,n);else{let e=s.contentMatchAt(o).findWrapping(n.firstChild.type);l=e&&s.canReplaceWith(o,o,e[0])}if(l)return 0==i?r.pos:i<0?r.before(t+1):r.after(t+1)}return null}function O(e,t,i=t,n=r.Ji.empty){if(t==i&&!n.size)return null;let o=e.resolve(t),s=e.resolve(i);return k(o,s,n)?new p(t,i,n):new I(o,s,n).fit()}function k(e,t,i){return!i.openStart&&!i.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),i.content)}class I{constructor(e,t,i){this.$from=e,this.$to=t,this.unplaced=i,this.frontier=[],this.placed=r.FK.empty;for(let t=0;t<=e.depth;t++){let i=e.node(t);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(t))})}for(let t=e.depth;t>0;t--)this.placed=r.FK.from(e.node(t).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,i=this.$from,n=this.close(e<0?this.$to:i.doc.resolve(e));if(!n)return null;let o=this.placed,s=i.depth,l=n.depth;for(;s&&l&&1==o.childCount;)o=o.firstChild.content,s--,l--;let a=new r.Ji(o,s,l);return e>-1?new m(i.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||i.pos!=this.$to.pos?new p(i.pos,n.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,i=0,r=this.unplaced.openEnd;i<e;i++){let n=t.firstChild;if(t.childCount>1&&(r=0),n.type.spec.isolating&&r<=i){e=i;break}t=n.content}for(let t=1;t<=2;t++)for(let i=1==t?e:this.unplaced.openStart;i>=0;i--){let e,n=null,o=(i?(n=H(this.unplaced.content,i-1).firstChild).content:this.unplaced.content).firstChild;for(let e=this.depth;e>=0;e--){let{type:s,match:l}=this.frontier[e],a,h=null;if(1==t&&(o?l.matchType(o.type)||(h=l.fillBefore(r.FK.from(o),!1)):n&&s.compatibleContent(n.type)))return{sliceDepth:i,frontierDepth:e,parent:n,inject:h};if(2==t&&o&&(a=l.findWrapping(o.type)))return{sliceDepth:i,frontierDepth:e,parent:n,wrap:a};if(n&&l.matchType(n.type))break}}}openMore(){let{content:e,openStart:t,openEnd:i}=this.unplaced,n=H(e,t);return!!n.childCount&&!n.firstChild.isLeaf&&(this.unplaced=new r.Ji(e,t+1,Math.max(i,n.size+t>=e.size-i?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:i}=this.unplaced,n=H(e,t);if(n.childCount<=1&&t>0){let o=e.size-t<=t+n.size;this.unplaced=new r.Ji(A(e,t-1,1),t-1,o?t-1:i)}else this.unplaced=new r.Ji(A(e,t,1),t,i)}placeNodes({sliceDepth:e,frontierDepth:t,parent:i,inject:n,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let e=0;e<o.length;e++)this.openFrontierNode(o[e]);let s=this.unplaced,l=i?i.content:s.content,a=s.openStart-e,h=0,u=[],{match:c,type:d}=this.frontier[t];if(n){for(let e=0;e<n.childCount;e++)u.push(n.child(e));c=c.matchFragment(n)}let g=l.size+e-(s.content.size-s.openEnd);for(;h<l.childCount;){let e=l.child(h),t=c.matchType(e.type);if(!t)break;(++h>1||0==a||e.content.size)&&(c=t,u.push(function e(t,i,n){if(i<=0)return t;let o=t.content;return i>1&&(o=o.replaceChild(0,e(o.firstChild,i-1,1==o.childCount?n-1:0))),i>0&&(o=t.type.contentMatch.fillBefore(o).append(o),n<=0&&(o=o.append(t.type.contentMatch.matchFragment(o).fillBefore(r.FK.empty,!0)))),t.copy(o)}(e.mark(d.allowedMarks(e.marks)),1==h?a:0,h==l.childCount?g:-1)))}let f=h==l.childCount;f||(g=-1),this.placed=N(this.placed,t,r.FK.from(u)),this.frontier[t].match=c,f&&g<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let e=0,t=l;e<g;e++){let e=t.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),t=e.content}this.unplaced=f?0==e?r.Ji.empty:new r.Ji(A(s.content,e-1,1),e-1,g<0?s.openEnd:e-1):new r.Ji(A(s.content,e,h),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!P(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return -1;let{depth:i}=this.$to,r=this.$to.after(i);for(;i>1&&r==this.$to.end(--i);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:i,type:r}=this.frontier[t],n=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),o=P(e,t,r,i,n);if(o){for(let i=t-1;i>=0;i--){let{match:t,type:r}=this.frontier[i],n=P(e,i,r,t,!0);if(!n||n.childCount)continue e}return{depth:t,fit:o,move:n?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=N(this.placed,t.depth,t.fit)),e=t.move;for(let i=t.depth+1;i<=e.depth;i++){let t=e.node(i),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(i));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e,t=null,i){let n=this.frontier[this.depth];n.match=n.match.matchType(e),this.placed=N(this.placed,this.depth,r.FK.from(e.create(t,i))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(r.FK.empty,!0);e.childCount&&(this.placed=N(this.placed,this.frontier.length,e))}}function A(e,t,i){return 0==t?e.cutByIndex(i,e.childCount):e.replaceChild(0,e.firstChild.copy(A(e.firstChild.content,t-1,i)))}function N(e,t,i){return 0==t?e.append(i):e.replaceChild(e.childCount-1,e.lastChild.copy(N(e.lastChild.content,t-1,i)))}function H(e,t){for(let i=0;i<t;i++)e=e.firstChild.content;return e}function P(e,t,i,r,n){let o=e.node(t),s=n?e.indexAfter(t):e.index(t);if(s==o.childCount&&!i.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!function(e,t,i){for(let r=i;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(i,o.content,s)?l:null}function _(e,t){let i=[],r=Math.min(e.depth,t.depth);for(let n=r;n>=0;n--){let r=e.start(n);if(r<e.pos-(e.depth-n)||t.end(n)>t.pos+(t.depth-n)||e.node(n).type.spec.isolating||t.node(n).type.spec.isolating)break;(r==t.start(n)||n==e.depth&&n==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&n&&t.start(n-1)==r-1)&&i.push(n)}return i}class L extends a{constructor(e,t,i){super(),this.pos=e,this.attr=t,this.value=i}apply(e){let t=e.nodeAt(this.pos);if(!t)return h.fail("No node at attribute step's position");let i=Object.create(null);for(let e in t.attrs)i[e]=t.attrs[e];i[this.attr]=this.value;let n=t.type.create(i,null,t.marks);return h.fromReplace(e,this.pos,this.pos+1,new r.Ji(r.FK.from(n),0,+!t.isLeaf))}getMap(){return o.empty}invert(e){return new L(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new L(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new L(t.pos,t.attr,t.value)}}a.jsonID("attr",L);class D extends a{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let i=e.type.create(t,e.content,e.marks);return h.ok(i)}getMap(){return o.empty}invert(e){return new D(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new D(t.attr,t.value)}}a.jsonID("docAttr",D);let F=class extends Error{};(F=function e(t){let i=Error.call(this,t);return i.__proto__=e.prototype,i}).prototype=Object.create(Error.prototype),F.prototype.constructor=F,F.prototype.name="TransformError";class V{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new s}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new F(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,i=r.Ji.empty){let n=O(this.doc,e,t,i);return n&&this.step(n),this}replaceWith(e,t,i){return this.replace(e,t,new r.Ji(r.FK.from(i),0,0))}delete(e,t){return this.replace(e,t,r.Ji.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,i){return!function(e,t,i,n){if(!n.size)return e.deleteRange(t,i);let o=e.doc.resolve(t),s=e.doc.resolve(i);if(k(o,s,n))return e.step(new p(t,i,n));let l=_(o,e.doc.resolve(i));0==l[l.length-1]&&l.pop();let a=-(o.depth+1);l.unshift(a);for(let e=o.depth,t=o.pos-1;e>0;e--,t--){let i=o.node(e).type.spec;if(i.defining||i.definingAsContext||i.isolating)break;l.indexOf(e)>-1?a=e:o.before(e)==t&&l.splice(1,0,-e)}let h=l.indexOf(a),u=[],c=n.openStart;for(let e=n.content,t=0;;t++){let i=e.firstChild;if(u.push(i),t==n.openStart)break;e=i.content}for(let e=c-1;e>=0;e--){var d;let t=u[e],i=(d=t.type).spec.defining||d.spec.definingForContent;if(i&&!t.sameMarkup(o.node(Math.abs(a)-1)))c=e;else if(i||!t.type.isTextblock)break}for(let t=n.openStart;t>=0;t--){let a=(t+c+1)%(n.openStart+1),d=u[a];if(d)for(let t=0;t<l.length;t++){let u=l[(t+h)%l.length],c=!0;u<0&&(c=!1,u=-u);let g=o.node(u-1),f=o.index(u-1);if(g.canReplaceWith(f,f,d.type,d.marks))return e.replace(o.before(u),c?s.after(u):i,new r.Ji(function e(t,i,n,o,s){if(i<n){let r=t.firstChild;t=t.replaceChild(0,r.copy(e(r.content,i+1,n,o,r)))}if(i>o){let e=s.contentMatchAt(0),i=e.fillBefore(t).append(t);t=i.append(e.matchFragment(i).fillBefore(r.FK.empty,!0))}return t}(n.content,0,n.openStart,a),a,n.openEnd))}}let g=e.steps.length;for(let r=l.length-1;r>=0&&(e.replace(t,i,n),!(e.steps.length>g));r--){let e=l[r];e<0||(t=o.before(e),i=s.after(e))}}(this,e,t,i),this}replaceRangeWith(e,t,i){return!function(e,t,i,n){if(!n.isInline&&t==i&&e.doc.resolve(t).parent.content.size){let r=function(e,t,i){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),i))return t;if(0==r.parentOffset)for(let e=r.depth-1;e>=0;e--){let t=r.index(e);if(r.node(e).canReplaceWith(t,t,i))return r.before(e+1);if(t>0)return null}if(r.parentOffset==r.parent.content.size)for(let e=r.depth-1;e>=0;e--){let t=r.indexAfter(e);if(r.node(e).canReplaceWith(t,t,i))return r.after(e+1);if(t<r.node(e).childCount)break}return null}(e.doc,t,n.type);null!=r&&(t=i=r)}e.replaceRange(t,i,new r.Ji(r.FK.from(n),0,0))}(this,e,t,i),this}deleteRange(e,t){return!function(e,t,i){let r=e.doc.resolve(t),n=e.doc.resolve(i),o=_(r,n);for(let t=0;t<o.length;t++){let i=o[t],s=t==o.length-1;if(s&&0==i||r.node(i).type.contentMatch.validEnd)return e.delete(r.start(i),n.end(i));if(i>0&&(s||r.node(i-1).canReplace(r.index(i-1),n.indexAfter(i-1))))return e.delete(r.before(i),n.after(i))}for(let o=1;o<=r.depth&&o<=n.depth;o++)if(t-r.start(o)==r.depth-o&&i>r.end(o)&&n.end(o)-i!=n.depth-o&&r.start(o-1)==n.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),n.index(o-1)))return e.delete(r.before(o),i);e.delete(t,i)}(this,e,t),this}lift(e,t){return!function(e,t,i){let{$from:n,$to:o,depth:s}=t,l=n.before(s+1),a=o.after(s+1),h=l,u=a,c=r.FK.empty,d=0;for(let e=s,t=!1;e>i;e--)t||n.index(e)>0?(t=!0,c=r.FK.from(n.node(e).copy(c)),d++):h--;let g=r.FK.empty,f=0;for(let e=s,t=!1;e>i;e--)t||o.after(e+1)<o.end(e)?(t=!0,g=r.FK.from(o.node(e).copy(g)),f++):u++;e.step(new m(h,u,l,a,new r.Ji(c.append(g),d,f),c.size-d,!0))}(this,e,t),this}join(e,t=1){return!function(e,t,i){let n=null,{linebreakReplacement:o}=e.doc.type.schema,s=e.doc.resolve(t-i),l=s.node().type;if(o&&l.inlineContent){let e="pre"==l.whitespace,t=!!l.contentMatch.matchType(o);e&&!t?n=!1:!e&&t&&(n=!0)}let a=e.steps.length;if(!1===n){let r=e.doc.resolve(t+i);R(e,r.node(),r.before(),a)}l.inlineContent&&y(e,t+i-1,l,s.node().contentMatchAt(s.index()),null==n);let h=e.mapping.slice(a),u=h.map(t-i);if(e.step(new p(u,h.map(t+i,-1),r.Ji.empty,!0)),!0===n){let t=e.doc.resolve(u);E(e,t.node(),t.before(),e.steps.length)}}(this,e,t),this}wrap(e,t){return!function(e,t,i){let n=r.FK.empty;for(let e=i.length-1;e>=0;e--){if(n.size){let t=i[e].type.contentMatch.matchFragment(n);if(!t||!t.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=r.FK.from(i[e].type.create(i[e].attrs,n))}let o=t.start,s=t.end;e.step(new m(o,s,o,s,new r.Ji(n,0,0),i.length,!0))}(this,e,t),this}setBlockType(e,t=e,i,n=null){return!function(e,t,i,n,o){if(!n.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,i,(t,i)=>{var l,a,h;let u,c,d="function"==typeof o?o(t):o;if(t.isTextblock&&!t.hasMarkup(n,d)&&(l=e.doc,a=e.mapping.slice(s).map(i),h=n,c=(u=l.resolve(a)).index(),u.parent.canReplaceWith(c,c+1,h))){let o=null;if(n.schema.linebreakReplacement){let e="pre"==n.whitespace,t=!!n.contentMatch.matchType(n.schema.linebreakReplacement);e&&!t?o=!1:!e&&t&&(o=!0)}!1===o&&R(e,t,i,s),y(e,e.mapping.slice(s).map(i,1),n,void 0,null===o);let l=e.mapping.slice(s),a=l.map(i,1),h=l.map(i+t.nodeSize,1);return e.step(new m(a,h,a+1,h-1,new r.Ji(r.FK.from(n.create(d,null,t.marks)),0,0),1,!0)),!0===o&&E(e,t,i,s),!1}})}(this,e,t,i,n),this}setNodeMarkup(e,t,i=null,n){return!function(e,t,i,n,o){let s=e.doc.nodeAt(t);if(!s)throw RangeError("No node at given position");i||(i=s.type);let l=i.create(n,null,o||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,l);if(!i.validContent(s.content))throw RangeError("Invalid content for node type "+i.name);e.step(new m(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new r.Ji(r.FK.from(l),0,0),1,!0))}(this,e,t,i,n),this}setNodeAttribute(e,t,i){return this.step(new L(e,t,i)),this}setDocAttribute(e,t){return this.step(new D(e,t)),this}addNodeMark(e,t){return this.step(new g(e,t)),this}removeNodeMark(e,t){let i=this.doc.nodeAt(e);if(!i)throw RangeError("No node at position "+e);if(t instanceof r.CU)t.isInSet(i.marks)&&this.step(new f(e,t));else{let r=i.marks,n,o=[];for(;n=t.isInSet(r);)o.push(new f(e,n)),r=n.removeFromSet(r);for(let e=o.length-1;e>=0;e--)this.step(o[e])}return this}split(e,t=1,i){return!function(e,t,i=1,n){let o=e.doc.resolve(t),s=r.FK.empty,l=r.FK.empty;for(let e=o.depth,t=o.depth-i,a=i-1;e>t;e--,a--){s=r.FK.from(o.node(e).copy(s));let t=n&&n[a];l=r.FK.from(t?t.type.create(t.attrs,l):o.node(e).copy(l))}e.step(new p(t,t,new r.Ji(s.append(l),i,i),!0))}(this,e,t,i),this}addMark(e,t,i){var r;let n,o,s,l;return r=this,s=[],l=[],r.doc.nodesBetween(e,t,(r,a,h)=>{if(!r.isInline)return;let u=r.marks;if(!i.isInSet(u)&&h.type.allowsMarkType(i.type)){let h=Math.max(a,e),g=Math.min(a+r.nodeSize,t),f=i.addToSet(u);for(let e=0;e<u.length;e++)u[e].isInSet(f)||(n&&n.to==h&&n.mark.eq(u[e])?n.to=g:s.push(n=new d(h,g,u[e])));o&&o.to==h?o.to=g:l.push(o=new c(h,g,i))}}),s.forEach(e=>r.step(e)),l.forEach(e=>r.step(e)),this}removeMark(e,t,i){var n;let o,s;return n=this,o=[],s=0,n.doc.nodesBetween(e,t,(n,l)=>{if(!n.isInline)return;s++;let a=null;if(i instanceof r.sX){let e=n.marks,t;for(;t=i.isInSet(e);)(a||(a=[])).push(t),e=t.removeFromSet(e)}else i?i.isInSet(n.marks)&&(a=[i]):a=n.marks;if(a&&a.length){let i=Math.min(l+n.nodeSize,t);for(let t=0;t<a.length;t++){let r=a[t],n;for(let e=0;e<o.length;e++){let t=o[e];t.step==s-1&&r.eq(o[e].style)&&(n=t)}n?(n.to=i,n.step=s):o.push({style:r,from:Math.max(l,e),to:i,step:s})}}}),o.forEach(e=>n.step(new d(e.from,e.to,e.style))),this}clearIncompatible(e,t,i){return y(this,e,t,i),this}}},927:(e,t,i)=>{"use strict";i.d(t,{v:()=>n,z:()=>o}),i(12252),i(29954);var r=i(95061);function n(e,t){return(0,r.arrayMap)(e,e=>e-t.filter(t=>t<e).length)}function o(e,t){let i=t[0],n=t.length;return(0,r.arrayMap)(e,e=>e>=i?e+n:e)}},1354:(e,t,i)=>{"use strict";i.d(t,{p:()=>p}),i(41658),i(19398);var r=i(93924),n=i(75708);i(12252),i(29954),i(20775);var o=i(18045),s=i(15616),l=i(19857),a=i(95061),h=i(13455),u=i(78887);function c(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class d{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,t,i){c(this,"hot",void 0),c(this,"metaManager",void 0),c(this,"tableMeta",void 0),c(this,"dataSource",void 0),c(this,"duckSchema",void 0),c(this,"colToPropCache",void 0),c(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=t,this.refreshDuckSchema(),this.createMap()}createMap(){let e,t=this.getSchema();if(void 0===t)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let i=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,i){let r=0,n=0,o=!1;if("function"==typeof i){let e=(0,l.deepObjectSize)(t);r=e>0?e:this.countFirstRowKeys(),o=!0}else r=Math.min(this.tableMeta.maxCols,i.length);for(e=0;e<r;e++){let t=o?i(e):i[e];if((0,l.isObject)(t)){if(void 0!==t.data){let i=o?n:e;this.colToPropCache[i]=t.data,this.propToColCache.set(t.data,i)}n+=1}}}else this.recursiveDuckColumns(t)}countFirstRowKeys(){return(0,s.countFirstRowKeys)(this.dataSource)}recursiveDuckColumns(e,t,i){let r,n=t,o=i;return void 0===n&&(n=0,o=""),"object"!=typeof e||Array.isArray(e)||(0,l.objectEach)(e,(e,t)=>{null===e?(r=o+t,this.colToPropCache.push(r),this.propToColCache.set(r,n),n+=1):n=this.recursiveDuckColumns(e,n,`${t}.`)}),n}colToProp(e){if(!1===Number.isInteger(e))return e;let t=this.hot.toPhysicalColumn(e);return null===t?e:this.colToPropCache&&(0,u.isDefined)(this.colToPropCache[t])?this.colToPropCache[t]:t}propToCol(e){let t=this.propToColCache.get(e);if((0,u.isDefined)(t))return this.hot.toVisualColumn(t);let i=this.hot.toVisualColumn(e);return null===i?e:i}getSchema(){let e=this.tableMeta.dataSchema;return e?"function"==typeof e?e():e:(0,this.duckSchema)}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,l.duckSchema)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.hot.countSourceRows(),o=n,s=0,a=e;if(("number"!=typeof a||a>=n)&&(a=n),a<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a)),!1===this.hot.runHooks("beforeCreateRow",a,t,i)||null===o)return{delta:0};let u=this.tableMeta.maxRows,c=this.getSchema().length,d=[];for(;s<t&&n+s<u;){let e=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?e=(0,l.deepClone)(this.getSchema()):(e=[],(0,h.rangeEach)(c-1,()=>e.push(null))):"function"===this.hot.dataType?e=this.tableMeta.dataSchema(a+s):(e={},(0,l.deepExtend)(e,this.getSchema())),d.push(e),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,n)),this.spliceData(o,0,d);let g=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==e?this.metaManager.createRow(null,s):"auto"!==i&&this.metaManager.createRow(o,t)),this.hot.runHooks("afterCreateRow",g,s,i),{delta:s,startPhysicalIndex:o}}createCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let n=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols(),l=e;if(("number"!=typeof l||l>=s)&&(l=s),!1===this.hot.runHooks("beforeCreateCol",l,t,i))return{delta:0};let a=s;l<this.hot.countCols()&&(a=this.hot.toPhysicalColumn(l));let h=this.hot.countSourceRows(),u=this.hot.countCols(),c=0,d=a;"end"===r&&(d=Math.min(d+1,s));let g=d;for(;c<t&&u<o;){if("number"!=typeof l||l>=u)if(h>0)for(let e=0;e<h;e+=1)void 0===n[e]&&(n[e]=[]),n[e].push(null);else n.push([null]);else for(let e=0;e<h;e++)n[e].splice(d,0,null);c+=1,d+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(l,c),c>0&&(null==e?this.metaManager.createColumn(null,c):"auto"!==i&&this.metaManager.createColumn(g,t));let f=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",f,c,i),this.refreshDuckSchema(),{delta:c,startPhysicalIndex:g}}removeRow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-t,n=this.visualRowsToPhysical(r,t),o=this.hot.countSourceRows();if(r=(o+r)%o,!1===this.hot.runHooks("beforeRemoveRow",r,n.length,n,i))return!1;let s=n.length;if(this.filterData(r,s,n),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);let e=(0,u.isDefined)(this.tableMeta.columns)||(0,u.isDefined)(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||e||this.hot.columnIndexMapper.setIndexesSequence([])}return n.slice(0).sort((e,t)=>t-e).forEach(e=>{this.metaManager.removeRow(e,1)}),this.hot.runHooks("afterRemoveRow",r,s,n,i),!0}removeCol(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");let r="number"!=typeof e?-t:e;r=(this.hot.countCols()+r)%this.hot.countCols();let n=this.visualColumnsToPhysical(r,t),o=n.slice(0).sort((e,t)=>t-e);if(!1===this.hot.runHooks("beforeRemoveCol",r,t,n,i))return!1;let s=!0,l=o.length,a=this.dataSource;for(let e=0;e<l;e++)s&&n[0]!==n[e]-e&&(s=!1);if(s)for(let e=0,i=this.hot.countSourceRows();e<i;e++)a[e].splice(n[0],t),0===e&&this.metaManager.removeColumn(n[0],t);else for(let e=0,t=this.hot.countSourceRows();e<t;e++)for(let t=0;t<l;t++)a[e].splice(o[t],1),0===e&&this.metaManager.removeColumn(o[t],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,t,n,i),this.refreshDuckSchema(),!0}spliceCol(e,t,i){let r=this.hot.getDataAtCol(e),n=r.slice(t,t+i),o=r.slice(t+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.extendArray)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return(0,a.to2dArray)(l),this.hot.populateFromArray(t,e,l,null,null,"spliceCol"),n}spliceRow(e,t,i){let r=this.hot.getSourceDataAtRow(e),n=r.slice(t,t+i),o=r.slice(t+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.extendArray)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return this.hot.populateFromArray(e,t,[l],null,null,"spliceRow"),n}spliceData(e,t,i){if(!1!==this.hot.runHooks("beforeDataSplice",e,t,i)){let t=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,t.forEach(e=>this.dataSource.push(e))}}filterData(e,t,i){let r=this.hot.runHooks("filterData",e,t,i);!1===Array.isArray(r)&&(r=this.dataSource.filter((e,t)=>-1===i.indexOf(t))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,t){let i=this.hot.toPhysicalRow(e),r=this.dataSource[i],n=this.hot.runHooks("modifyRowData",i);r=isNaN(n)?n:r;let{dataDotNotation:o}=this.hot.getSettings(),s=null;if(r&&r.hasOwnProperty&&(0,l.hasOwnProperty)(r,t))s=r[t];else if(o&&"string"==typeof t&&t.indexOf(".")>-1){let e=r;if(!e)return null;let i=t.split(".");for(let t=0,r=i.length;t<r;t++)if(void 0===(e=e[i[t]]))return null;s=e}else"function"==typeof t&&(s=t(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){let e=(0,l.createObjectPropListener)(s);this.hot.runHooks("modifyData",i,this.propToCol(t),e,"get"),e.isTouched()&&(s=e.value)}return s}getCopyable(e,t){return this.hot.getCellMeta(e,this.propToCol(t)).copyable?this.get(e,t):""}set(e,t,i){let r=this.hot.toPhysicalRow(e),n=i,o=this.dataSource[r],s=this.hot.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.hot.hasHook("modifyData")){let e=(0,l.createObjectPropListener)(n);this.hot.runHooks("modifyData",r,this.propToCol(t),e,"set"),e.isTouched()&&(n=e.value)}let{dataDotNotation:a}=this.hot.getSettings();if(o&&o.hasOwnProperty&&(0,l.hasOwnProperty)(o,t))o[t]=n;else if(a&&"string"==typeof t&&t.indexOf(".")>-1){let e,i=o,r=0,s=t.split(".");for(r=0,e=s.length-1;r<e;r++){if("__proto__"===s[r]||"constructor"===s[r]||"prototype"===s[r])return;void 0===i[s[r]]&&(i[s[r]]={}),i=i[s[r]]}i[s[r]]=n}else if("function"==typeof t)t(this.dataSource.slice(r,r+1)[0],n);else{if("__proto__"===t||"constructor"===t||"prototype"===t)return;o[t]=n}}visualRowsToPhysical(e,t){let i=this.hot.countSourceRows(),r=[],n=(i+e)%i,o=t;for(;n<i&&o;)r.push(this.hot.toPhysicalRow(n)),o-=1,n+=1;return r}visualColumnsToPhysical(e,t){let i=this.hot.countCols(),r=[],n=(i+e)%i,o=t;for(;n<i&&o;){let e=this.hot.toPhysicalColumn(n);r.push(e),o-=1,n+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let t=0;t<this.hot.countCols();t++)this.set(e,this.colToProp(t),"")}getLength(){let e=this.tableMeta.maxRows;return Math.min(this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),e<0||0===e?0:e||1/0)}getAll(){let e={row:0,col:0},t={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-t.row!=0||this.hot.countSourceRows()?this.getRange(e,t,d.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(e,t,i){let r,n,o,s=[],l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];let h=i===d.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(l-1,0),Math.max(e.row,t.row)),c=Math.min(Math.max(a-1,0),Math.max(e.col,t.col));for(r=Math.min(e.row,t.row);r<=u;r++){o=[];let i=r>=0?this.hot.toPhysicalRow(r):r;for(n=Math.min(e.col,t.col);n<=c&&null!==i;n++)o.push(h.call(this,r,this.colToProp(n)));null!==i&&s.push(o)}return s}getText(e,t){return(0,o.A)(this.getRange(e,t,d.DESTINATION_RENDERER))}getCopyableText(e,t){return(0,o.A)(this.getRange(e,t,d.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var g=i(33787),f=i(91748);function p(e,t,i,o){let{hotInstance:s,dataMap:a,dataSource:h,internalSource:u,source:c,metaManager:p,firstRun:m}=o,w=(0,r.toUpperCaseFirst)(u),y=s.getSettings();Array.isArray(y.dataSchema)?s.dataType="array":(0,n.isFunction)(y.dataSchema)?s.dataType="function":s.dataType="object",a&&a.destroy(),e=s.runHooks(`before${w}`,e,m,c);let b=new d(s,e,p);if(t(b),"object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else if(null===e){let t,i=b.getSchema();e=[];let r=0,n=0;for(r=0,n=y.startRows;r<n;r++)if(("object"===s.dataType||"function"===s.dataType)&&y.dataSchema)t=(0,l.deepClone)(i),e.push(t);else if("array"===s.dataType)t=(0,l.deepClone)(i[0]),e.push(t);else{t=[];for(let e=0,i=y.startCols;e<i;e++)t.push(null);e.push(t)}}else throw Error(`${u} only accepts array of objects or array of arrays (${typeof e} given)`);Array.isArray(e[0])&&(s.dataType="array"),y.data=e,b.dataSource=e,h.data=e,h.dataType=s.dataType,h.colToProp=b.colToProp.bind(b),h.propToCol=b.propToCol.bind(b),h.countCachedColumns=b.countCachedColumns.bind(b),i(b),s.runHooks(`after${w}`,e,m,c),m||(s.runHooks("afterChange",null,u),s.render()),s.getSettings().ariaTags&&(0,g.setAttribute)(s.rootElement,[(0,f.DZ)(-1),(0,f.Nb)(s.countCols()+(s.view?s.countRowHeaders():0))])}},1416:(e,t,i)=>{"use strict";var r=i(94272),n=i(16954),o=i(71310),s=i(15743),l=i(6497),a=n.add,h=n.has,u=n.remove;e.exports=function(e){var t=r(this),i=s(e).getIterator(),n=o(t);return l(i,function(e){h(t,e)?u(n,e):a(n,e)}),n}},1728:(e,t,i)=>{"use strict";var r=i(76494),n=i(24201);e.exports=function(e,t){r(t)&&"cause"in t&&n(e,"cause",t.cause)}},1730:(e,t,i)=>{"use strict";var r=i(42620),n=i(62495),o=i(99365),s=i(28060),l=i(53469),a=i(13928),h=i(46724),u=r.Function,c=/MSIE .\./.test(l)||"BUN"===s&&function(){var e=r.Bun.version.split(".");return e.length<3||"0"===e[0]&&(e[1]<3||"3"===e[1]&&"0"===e[2])}();e.exports=function(e,t){var i=t?2:1;return c?function(r,s){var l=h(arguments.length,1)>i,c=o(r)?r:u(r),d=l?a(arguments,i):[],g=l?function(){n(c,this,d)}:c;return t?e(g,s):e(g)}:e}},2048:(e,t,i)=>{"use strict";e.exports=i(11609)&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},2254:(e,t,i)=>{"use strict";var r=i(85592);e.exports=Array.isArray||function(e){return"Array"===r(e)}},2769:(e,t,i)=>{"use strict";var r=i(14412),n=i(2254),o=TypeError,s=Object.getOwnPropertyDescriptor;e.exports=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}()?function(e,t){if(n(e)&&!s(e,"length").writable)throw new o("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},3422:(e,t,i)=>{"use strict";i.d(t,{A:()=>iA}),i(41658),i(19398);var r=i(33787),n=i(57555),o=i(13115),s=i(75708),l=i(23544),a=i(59594),h=i(78887);function u(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function c(e,t){return e.get(g(e,t))}function d(e,t,i){return e.set(g(e,t),i),i}function g(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var f=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,C=new WeakMap,S=new WeakMap,E=new WeakMap,R=new WeakMap;class T{constructor(e,t,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;u(this,f,void 0),u(this,p,void 0),u(this,m,void 0),u(this,w,void 0),u(this,y,void 0),u(this,b,void 0),u(this,C,void 0),u(this,S,void 0),u(this,E,[null,null]),u(this,R,[null,null]),d(f,this,i),d(p,this,t),d(m,this,n),d(w,this,o),d(y,this,s),d(b,this,r),d(C,this,e),this.registerEvents()}registerEvents(){c(b,this).addEventListener(c(m,this).holder,"contextmenu",e=>this.onContextMenu(e)),c(b,this).addEventListener(c(m,this).TABLE,"mouseover",e=>this.onMouseOver(e)),c(b,this).addEventListener(c(m,this).TABLE,"mouseout",e=>this.onMouseOut(e));let e=()=>{c(b,this).addEventListener(c(m,this).holder,"touchstart",e=>this.onTouchStart(e)),c(b,this).addEventListener(c(m,this).holder,"touchend",e=>this.onTouchEnd(e)),this.momentumScrolling||(this.momentumScrolling={}),c(b,this).addEventListener(c(m,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||c(f,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,c(f,this).getSetting("onAfterMomentumScroll"))},200)})};(0,a.isMobileBrowser)()?e():((0,l.isTouchSupported)()&&e(),c(b,this).addEventListener(c(m,this).holder,"mouseup",e=>this.onMouseUp(e)),c(b,this).addEventListener(c(m,this).holder,"mousedown",e=>this.onMouseDown(e)))}selectedCellWasTouched(e){let t=this.parentCell(e).coords;if(c(S,this)&&t){let[e,i]=[t.row,c(S,this).from.row],[r,n]=[t.col,c(S,this).from.col];return e===i&&r===n}return!1}parentCell(e){let t={},i=c(m,this).TABLE,n=(0,r.closestDown)(e,["TD","TH"],i);return n?(t.coords=c(m,this).getCoords(n),t.TD=n):(0,r.hasClass)(e,"wtBorder")&&(0,r.hasClass)(e,"current")?(t.coords=c(w,this).getFocusSelection().cellRange.highlight,t.TD=c(m,this).getCell(t.coords)):(0,r.hasClass)(e,"wtBorder")&&(0,r.hasClass)(e,"area")&&c(w,this).getAreaSelection().cellRange&&(t.coords=c(w,this).getAreaSelection().cellRange.to,t.TD=c(m,this).getCell(t.coords)),t}onMouseDown(e){let t=c(p,this).rootDocument.activeElement,i=(0,s.partial)(r.getParent,e.target),n=e.target;if(!["TD","TH"].includes(t.nodeName)&&(n===t||i(0)===t||i(1)===t))return;let o=this.parentCell(n);(0,r.hasClass)(n,"corner")?c(f,this).getSetting("onCellCornerMouseDown",e,n):o.TD&&c(f,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(0===e.button||this.touchApplied)&&o.TD&&(c(R,this)[0]=o.TD,clearTimeout(c(E,this)[0]),c(E,this)[0]=setTimeout(()=>{c(R,this)[0]=null},1e3))}onContextMenu(e){if(c(f,this).has("onCellContextMenu")){let t=this.parentCell(e.target);t.TD&&this.callListener("onCellContextMenu",e,t.coords,t.TD)}}onMouseOver(e){if(!c(f,this).has("onCellMouseOver"))return;let t=c(m,this).TABLE,i=(0,r.closestDown)(e.target,["TD","TH"],t),n=c(y,this)||this;i&&i!==n.lastMouseOver&&(0,r.isChildOf)(i,t)&&(n.lastMouseOver=i,this.callListener("onCellMouseOver",e,c(m,this).getCoords(i),i))}onMouseOut(e){if(!c(f,this).has("onCellMouseOut"))return;let t=c(m,this).TABLE,i=(0,r.closestDown)(e.target,["TD","TH"],t),n=(0,r.closestDown)(e.relatedTarget,["TD","TH"],t),o=c(y,this)||this;i&&i!==n&&(0,r.isChildOf)(i,t)&&(this.callListener("onCellMouseOut",e,c(m,this).getCoords(i),i),null===n&&(o.lastMouseOver=null))}onMouseUp(e){let t=this.parentCell(e.target);t.TD&&c(f,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,t.coords,t.TD),(0===e.button||this.touchApplied)&&(t.TD===c(R,this)[0]&&t.TD===c(R,this)[1]?((0,r.hasClass)(e.target,"corner")?this.callListener("onCellCornerDblClick",e,t.coords,t.TD):this.callListener("onCellDblClick",e,t.coords,t.TD),c(R,this)[0]=null,c(R,this)[1]=null):t.TD===c(R,this)[0]&&(c(R,this)[1]=t.TD,clearTimeout(c(E,this)[1]),c(E,this)[1]=setTimeout(()=>{c(R,this)[1]=null},500)))}onTouchStart(e){d(S,this,c(w,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var t;let i=e.target,r=null===(t=this.parentCell(i))||void 0===t?void 0:t.coords,n=(0,h.isDefined)(r)&&r.row>=0&&r.col>=0;e.cancelable&&n&&c(f,this).getSetting("isDataViewInstance")&&((0,a.isIOS)()&&((0,a.isChromeWebKit)()||(0,a.isFirefoxWebKit)())&&this.selectedCellWasTouched(i)&&!["A","BUTTON","INPUT"].includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()),this.onMouseUp(e),this.touchApplied=!1}callListener(e,t,i,r){let n=c(f,this).getSettingPure(e);n&&n(t,i,r,c(C,this).call(this))}destroy(){clearTimeout(c(E,this)[0]),clearTimeout(c(E,this)[1]),c(b,this).destroy()}}i(12252),i(20775),i(43942);var x=i(95061),M=i(79791),O=i(57193);function k(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class I{constructor(e,t,i){k(this,"offset",void 0),k(this,"total",void 0),k(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function A(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class N{constructor(e,t,i){A(this,"offset",void 0),A(this,"total",void 0),A(this,"countTH",void 0),this.offset=e,this.total=t,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function H(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class P{constructor(){H(this,"currentSize",0),H(this,"nextSize",0),H(this,"currentOffset",0),H(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}function _(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class L{constructor(){_(this,"size",new P),_(this,"workingSpace",0),_(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=1,e.workingSpace=2,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=2,e.workingSpace=1,this.sharedSize=e.getViewSize()}}i(69607);class D{constructor(e,t){!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"order",[]),this.order=[...Array(t).keys()].map(t=>e+t)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}class F{constructor(e){!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"sizeSet",void 0),this.sizeSet=e}diff(){let{sizeSet:e}=this,{currentSize:t,nextSize:i}=e.getViewSize(),r=Math.max(i,t);if(0===r)return[];let{currentOffset:n,nextOffset:o}=e.getViewSize(),s=new D(n,t),l=new D(o,i),a=[];for(let t=0;t<r;t++){let n=s.get(t),o=l.get(t);if(-1===o)a.push(["remove",n]);else if(-1===n)!e.isShared()||e.isShared()&&e.isPlaceOn(2)?a.push(["append",o]):a.push(["prepend",o]);else if(o>n)s.has(o)&&(s.remove(o),i<=s.length&&(r-=1)),a.push(["replace",o,n]);else if(o<n){let e=s.prepend(o);a.push(["insert_before",o,n,e])}else a.push(["none",o])}return a}}function V(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class W{constructor(e,t){V(this,"rootNode",void 0),V(this,"nodesPool",void 0),V(this,"sizeSet",new L),V(this,"collectedNodes",[]),V(this,"viewDiffer",new F(this.sizeSet)),V(this,"leads",[]),this.rootNode=e,this.nodesPool=t}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){let e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){let{rootNode:t}=this,[i,r,n,o]=e,s=this.nodesPool(r);switch(this.collectedNodes.push(s),i){case"prepend":t.insertBefore(s,t.firstChild);break;case"append":t.appendChild(s);break;case"insert_before":t.insertBefore(s,this.nodesPool(n)),t.removeChild(this.nodesPool(o));break;case"replace":t.replaceChild(s,this.nodesPool(n));break;case"remove":t.removeChild(s)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class B extends W{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function j(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class z{constructor(e){j(this,"nodeType",void 0),j(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,t){let i="number"==typeof t?`${e}x${t}`:e.toString();if(this.pool.has(i))return this.pool.get(i);let r=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,r),r}}function U(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ${constructor(e,t){U(this,"nodesPool",null),U(this,"nodeType",void 0),U(this,"rootNode",void 0),U(this,"table",null),U(this,"renderedNodes",0),this.nodesPool="string"==typeof e?new z(e):null,this.nodeType=e,this.rootNode=t}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}var G=i(91748);function Y(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class K extends ${constructor(){super("TH"),Y(this,"orderViews",new WeakMap),Y(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new B(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e)),this.orderViews.set(e,t)),t}render(){let{rowsToRender:e,rowHeaderFunctions:t,rowHeadersCount:i,rows:n,cells:o}=this.table;for(let s=0;s<e;s++){let e=this.table.renderedRowToSource(s),l=n.getRenderedNode(s);this.sourceRowIndex=e;let a=this.obtainOrderView(l),h=o.obtainOrderView(l);a.appendView(h).setSize(i).setOffset(0).start();for(let n=i-1;n>=0;n--){a.render();let i=a.getCurrentNode();i.className="",i.removeAttribute("style"),(0,r.removeAttribute)(i,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.setAttribute)(i,[(0,G.Nf)(),(0,G.D9)(),(0,G.wD)(n+1),(0,G.vC)(-1)]),t[n](e,i,n)}a.end()}}}class X extends ${constructor(e){super(null,e)}adjust(){let{columnHeadersCount:e,rowHeadersCount:t}=this.table,i=this.rootNode.firstChild;if(e){let{columnsToRender:r}=this.table,n=r+t;for(let t=0;t<e;t++){for((i=this.rootNode.childNodes[t])||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<n;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)i.removeChild(i.lastChild),this.renderedNodes-=1}let o=this.rootNode.childNodes.length;if(o>e)for(let t=e;t<o;t++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&(0,r.empty)(i)}render(){let{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&(0,r.setAttribute)(this.rootNode,[(0,G.t0)()]);for(let t=0;t<e;t+=1){let{columnHeaderFunctions:e,columnsToRender:i,rowHeadersCount:n}=this.table,o=this.rootNode.childNodes[t];this.table.isAriaEnabled()&&(0,r.setAttribute)(o,[(0,G.Sb)(),(0,G.Qg)(t+1)]);for(let s=-1*n;s<i;s+=1){let i=this.table.renderedColumnToSource(s),l=o.childNodes[s+n];l.className="",l.removeAttribute("style"),(0,r.removeAttribute)(l,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.setAttribute)(l,[(0,G.wD)(s+1+this.table.rowHeadersCount),(0,G.vC)(-1),(0,G.Jg)(),...s>=0?[(0,G.L2)()]:[(0,G.Sb)()]]),e[t](i,l,t)}}}}var q=i(83457);let J=!1;class Z extends ${constructor(e){super(null,e)}adjust(){let{columnsToRender:e,rowHeadersCount:t}=this.table,i=e+t;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:e,rowHeadersCount:t}=this.table;!J&&e>1e3&&(J=!0,(0,O.R8)((0,q.O)`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let e=0;e<t;e++){let t=this.table.renderedColumnToSource(e),i=this.table.columnUtils.getHeaderWidth(t);this.rootNode.childNodes[e].style.width=`${i}px`}for(let i=0;i<e;i++){let e=this.table.renderedColumnToSource(i),r=this.table.columnUtils.getWidth(e);this.rootNode.childNodes[i+t].style.width=`${r}px`}let i=this.rootNode.firstChild;i&&(0,r.addClass)(i,"rowHeader")}}let Q={rowEven:"ht__row_even",rowOdd:"ht__row_odd"},ee=!1;class et extends ${constructor(e){super("TR",e),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"orderView",void 0),this.orderView=new W(e,e=>this.nodesPool.obtain(e))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){let{rowsToRender:e}=this.table;!ee&&e>1e3&&(ee=!0,(0,O.R8)((0,q.O)`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,r.setAttribute)(this.rootNode,[(0,G.t0)()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<e;n++){this.orderView.render();let e=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(n);if(this.table.isAriaEnabled()){var t,i;(0,r.setAttribute)(e,[(0,G.Sb)(),(0,G.Qg)(o+(null!==(t=null===(i=this.table.rowUtils)||void 0===i||null===(i=i.dataAccessObject)||void 0===i?void 0:i.columnHeaders.length)&&void 0!==t?t:0)+1)])}(o+1)%2==0?(0,r.hasClass)(e,Q.rowEven)||((0,r.removeClass)(e,Q.rowOdd),(0,r.addClass)(e,Q.rowEven)):(0,r.hasClass)(e,Q.rowOdd)||((0,r.removeClass)(e,Q.rowEven),(0,r.addClass)(e,Q.rowOdd))}this.orderView.end()}}function ei(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class er extends ${constructor(){super("TD"),ei(this,"orderViews",new WeakMap),ei(this,"sourceRowIndex",0)}obtainOrderView(e){let t;return this.orderViews.has(e)?t=this.orderViews.get(e):(t=new B(e,e=>this.nodesPool.obtain(this.sourceRowIndex,e),this.nodeType),this.orderViews.set(e,t)),t}render(){let{rowsToRender:e,columnsToRender:t,rows:i,rowHeaders:n}=this.table;for(let l=0;l<e;l++){let e=this.table.renderedRowToSource(l),a=i.getRenderedNode(l);this.sourceRowIndex=e;let h=this.obtainOrderView(a),u=n.obtainOrderView(a);h.prependView(u).setSize(t).setOffset(0).start();for(let i=0;i<t;i++){h.render();let t=this.table.renderedColumnToSource(i),n=h.getCurrentNode();if((0,r.hasClass)(n,"hide")||(n.className=""),n.removeAttribute("style"),n.removeAttribute("dir"),(0,r.removeAttribute)(n,[RegExp("aria-(.*)"),/role/]),this.table.cellRenderer(e,t,n),this.table.isAriaEnabled()){var o,s;(0,r.setAttribute)(n,[...n.hasAttribute("role")?[]:[(0,G.g)()],(0,G.vC)(-1),(0,G.wD)(t+(null!==(o=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==o?o:0)+1)])}}h.end()}}}function en(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class eo{constructor(e){let{cellRenderer:t,stylesHandler:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};en(this,"rootNode",void 0),en(this,"rootDocument",void 0),en(this,"rowHeaders",null),en(this,"columnHeaders",null),en(this,"colGroup",null),en(this,"rows",null),en(this,"cells",null),en(this,"rowFilter",null),en(this,"columnFilter",null),en(this,"rowUtils",null),en(this,"columnUtils",null),en(this,"rowsToRender",0),en(this,"columnsToRender",0),en(this,"rowHeaderFunctions",[]),en(this,"rowHeadersCount",0),en(this,"columnHeaderFunctions",[]),en(this,"columnHeadersCount",0),en(this,"cellRenderer",void 0),en(this,"activeOverlayName",void 0),en(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=t,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,t){this.rowUtils=e,this.columnUtils=t}setViewportSize(e,t){this.rowsToRender=e,this.columnsToRender=t}setFilters(e,t){this.rowFilter=e,this.columnFilter=t}setHeaderContentRenderers(e,t){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=t,this.columnHeadersCount=t.length}setRenderers(){let{rowHeaders:e,columnHeaders:t,colGroup:i,rows:r,cells:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setTable(this),t.setTable(this),i.setTable(this),r.setTable(this),n.setTable(this),this.rowHeaders=e,this.columnHeaders=t,this.colGroup=i,this.rows=r,this.cells=n}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:e,rows:t}=this;for(let i=0;i<e;i++){let e=t.getRenderedNode(i),r=this.rowUtils;if(e.firstChild){let t=this.renderedRowToSource(i),n=r.getHeightByOverlayName(t,this.activeOverlayName),o=+!this.stylesHandler.areCellsBorderBox();n?e.firstChild.style.height=`${n-o}px`:e.firstChild.style.height=""}}}}class es{constructor(){let{TABLE:e,THEAD:t,COLGROUP:i,TBODY:r,rowUtils:n,columnUtils:o,cellRenderer:s,stylesHandler:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new eo(e,{cellRenderer:s,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new K,columnHeaders:new X(t),colGroup:new Z(i),rows:new et(r),cells:new er}),this.renderer.setAxisUtils(n,o)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,t){return this.renderer.setFilters(e,t),this}setViewportSize(e,t){return this.renderer.setViewportSize(e,t),this}setHeaderContentRenderers(e,t){return this.renderer.setHeaderContentRenderers(e,t),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function el(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ea{constructor(e,t){el(this,"dataAccessObject",void 0),el(this,"wtSettings",void 0),el(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=t}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let t=this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return void 0!==i&&(t=t?Math.max(t,i):i),t}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){let{wtSettings:e}=this,t=e.getSetting("rowHeaderWidth");if(null!=(t=e.getSetting("onModifyRowHeaderWidth",t))){let i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let e=0;e<i;e++){let i=Array.isArray(t)?t[e]:t;i=null==i?r:i,this.headerWidths.set(e,i)}}}}function eh(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class eu{constructor(e,t){eh(this,"dataAccessObject",void 0),eh(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=t}getHeight(e){let t=this.wtSettings.getSetting("rowHeight",e),i=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==i&&(t=void 0===t?i:Math.max(t,i)),t}getHeightByOverlayName(e,t){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,t),r=this.dataAccessObject.wtViewport.oversizedRows[e];return void 0!==r&&(i=void 0===i?r:Math.max(i,r)),i}}let ec="bottom",ed="inline_start",eg="top_inline_start_corner",ef="bottom_inline_start_corner",ep=["top",ec,ed,eg,ef],em=new Map([["top","ht_clone_top"],[ec,`ht_clone_${ec}`],[ed,`ht_clone_${ed} ht_clone_left`],[eg,`ht_clone_${eg} ht_clone_top_left_corner`],[ef,`ht_clone_${ef} ht_clone_bottom_left_corner`]]);function ew(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ey{constructor(e,t,i,n,o){ew(this,"wtSettings",null),ew(this,"domBindings",void 0),ew(this,"TBODY",null),ew(this,"THEAD",null),ew(this,"COLGROUP",null),ew(this,"hasTableHeight",!0),ew(this,"hasTableWidth",!0),ew(this,"isTableVisible",!1),ew(this,"tableOffset",0),ew(this,"holderOffset",0),this.domBindings=i,this.isMaster="master"===o,this.name=o,this.dataAccessObject=e,this.facadeGetter=t,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,(0,r.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new eu(this.dataAccessObject,this.wtSettings),this.columnUtils=new ea(this.dataAccessObject,this.wtSettings),this.tableRenderer=new es({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(e){return this.name===e}fixTableDomTree(){let e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){let t,i=e.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.hasClass)(i,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",i&&i.insertBefore(t,e),t.appendChild(e)),t.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(t,[(0,G.gg)()]),t}createHider(e){let t,i=e.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.hasClass)(i,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).className="wtHider",i&&i.insertBefore(t,e),t.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(t,[(0,G.gg)()]),t}createHolder(e){let t,i=e.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.hasClass)(i,"wtHolder")||((t=this.domBindings.rootDocument.createElement("div")).style.position="relative",t.className="wtHolder",(0,r.setAttribute)(t,[(0,G.vC)(-1)]),i&&i.insertBefore(t,e),this.isMaster&&(t.parentNode.className+="ht_master handsontable",t.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(t.parentNode,[(0,G.gg)()])),t.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(t,[(0,G.gg)()]),t}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:t}=this,{wtOverlays:i,wtViewport:n}=this.dataAccessObject,o=t.getSetting("totalRows"),s=t.getSetting("totalColumns"),l=t.getSetting("rowHeaders"),a=l.length,h=t.getSetting("columnHeaders"),u=h.length,c=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=(0,r.offset)(this.holder),c=n.createCalculators(c),a&&!t.getSetting("fixedColumnsStart"))){let e=i.inlineStartOverlay.getScrollPosition(),t=this.correctHeaderWidth;this.correctHeaderWidth=0!==e,t!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=(0,r.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let e=Math.max(this.getFirstRenderedRow(),0),t=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new N(e,o,u),this.columnFilter=new I(t,s,a);let c=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let e={};this.wtSettings.getSetting("beforeDraw",!0,e),c=!0!==e.skipRender}c&&(this.tableRenderer.setHeaderContentRenderers(l,h),(this.is(ec)||this.is(ef))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(ec))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||n.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(ec)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){let t,i,n,o=this.columnFilter.renderedToSource(e),s=this.wtSettings.getSetting("columnHeaders").length,l=this.dataAccessObject.stylesHandler.getDefaultRowHeight(),a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,t=this.getColumnHeaderHeight(s),(i=this.getColumnHeader(o,s))&&(n=(0,r.innerHeight)(i),(!t&&l<n||t<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=n),Array.isArray(a)?null!==a[s]&&void 0!==a[s]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(a[s]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]||a))}adjustColumnHeaderHeights(){let{wtSettings:e}=this,t=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let e=0,n=r.length;e<n;e++)if(i[e]){if(!t[e]||0===t[e].childNodes.length)return;t[e].childNodes[0].style.height=`${i[e]}px`}}resetOversizedRows(){let{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject;if((this.isMaster||this.is(ec))&&!e.getSetting("externalRowCalculator")){let e=this.getRenderedRowsCount();for(let i=0;i<e;i++){let e=this.rowFilter.renderedToSource(i);t.oversizedRows&&t.oversizedRows[e]&&(t.oversizedRows[e]=void 0)}}}getCell(e){let t=e.row,i=e.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",t,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([t,i]=r),this.isRowBeforeRenderedRows(t))return -1;if(this.isRowAfterRenderedRows(t))return -2;if(this.isColumnBeforeRenderedColumns(i))return -3;if(this.isColumnAfterRenderedColumns(i))return -4;let n=this.getRow(t);if(!n&&t>=0)throw Error("TR was expected to be rendered but is not");let o=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw Error("TD or TH was expected to be rendered but is not");return o}getRow(e){var t,i;let r=null,n=null;return e<0?(r=null===(t=this.rowFilter)||void 0===t?void 0:t.sourceRowToVisibleColHeadedRow(e),n=this.THEAD):(r=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(e),n=this.TBODY),void 0!==r&&void 0!==n&&!(n.childNodes.length<r+1)&&n.childNodes[r]}getColumnHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.THEAD.childNodes[t];return null==i?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){let t=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(e=>{let r=e.childNodes[i];r&&t.push(r)}),t}getRowHeader(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(t>=this.wtSettings.getSetting("rowHeaders").length)return;let i=this.rowFilter.sourceToRendered(e),r=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):i,n=(i<0?this.THEAD:this.TBODY).childNodes[r];return null==n?void 0:n.childNodes[t]}getRowHeaders(e){let t=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){let i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],n=null==i?void 0:i.childNodes[r];n&&t.push(n)}return t}getCoords(e){let t=e;if("TD"!==t.nodeName&&"TH"!==t.nodeName&&(t=(0,r.closest)(t,["TD","TH"])),null===t)return null;let i=t.parentNode;if(!i)return null;let n=i.parentNode,o=(0,r.index)(i),s=t.cellIndex;(0,r.overlayContainsElement)(eg,t,this.wtRootElement)||(0,r.overlayContainsElement)("top",t,this.wtRootElement)?"THEAD"===n.nodeName&&(o-=n.childNodes.length):(0,r.overlayContainsElement)(ef,t,this.wtRootElement)||(0,r.overlayContainsElement)(ec,t,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-n.childNodes.length+o:n===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),(0,r.overlayContainsElement)(eg,t,this.wtRootElement)||(0,r.overlayContainsElement)(ed,t,this.wtRootElement)||(0,r.overlayContainsElement)(ef,t,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));let l=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return l&&Array.isArray(l)&&([o,s]=l),this.wot.createCellCoords(o,s)}markOversizedRows(){let e,t,i,n,o;if(this.wtSettings.getSetting("externalRowCalculator"))return;let s=this.TBODY.childNodes.length,l=s*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),a=(0,r.innerHeight)(this.TBODY)-1,h=this.wot.stylesHandler.areCellsBorderBox(),u=h?r.outerHeight:r.innerHeight,c=+!h,d=+!!h;if(l!==a||this.wtSettings.getSetting("fixedRowsBottom"))for(;s;){s-=1,i=this.rowFilter.renderedToSource(s),e=this.getRowHeight(i),o=(n=this.getTrForRow(i)).querySelector("th");let r=0===i?d:0;t=o?u(o):u(n)-c,(!e&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<t-r||e<t)&&(h||(t+=1),this.dataAccessObject.wtViewport.oversizedRows[i]=t)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){return!(e>=0)&&Math.abs(e)<=this.wtSettings.getSetting("rowHeaders").length}isRowHeaderRendered(e){return!(e>=0)&&Math.abs(e)<=this.wtSettings.getSetting("columnHeaders").length}isRowBeforeRenderedRows(e){let t=this.getFirstRenderedRow();return e<0&&t<=0?!this.isRowHeaderRendered(e):e<t}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){let t=this.getFirstRenderedColumn();return e<0&&t<=0?!this.isColumnHeaderRendered(e):e<t}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&0>this.columnFilter.sourceToRendered(e)&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,r.outerWidth)(this.TABLE)}getHeight(){return(0,r.outerHeight)(this.TABLE)}getTotalWidth(){let e=(0,r.outerWidth)(this.hider);return 0!==e?e:this.getWidth()}getTotalHeight(){let e=(0,r.outerHeight)(this.hider);return 0!==e?e:this.getHeight()}isVisible(){return(0,r.isVisible)(this.TABLE)}_modifyRowHeaderWidth(e){let t=(0,s.isFunction)(e)?e():null;return Array.isArray(t)?(t=[...t])[t.length-1]=this._correctRowHeaderWidth(t[t.length-1]):t=this._correctRowHeaderWidth(t),t}_correctRowHeaderWidth(e){let t=e;return"number"!=typeof e&&(t=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(t+=1),t}}let ev=ey;var eb=i(19857);let eC={getFirstRenderedRow(){return 0===this.getRenderedRowsCount()?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,eb.defineGetter)(eC,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});let eS={getFirstRenderedColumn(){let e=this.dataAccessObject.startColumnRendered;return null===e?-1:e},getFirstVisibleColumn(){let e=this.dataAccessObject.startColumnVisible;return null===e?-1:e},getFirstPartiallyVisibleColumn(){let e=this.dataAccessObject.startColumnPartiallyVisible;return null===e?-1:e},getLastRenderedColumn(){let e=this.dataAccessObject.endColumnRendered;return null===e?-1:e},getLastVisibleColumn(){let e=this.dataAccessObject.endColumnVisible;return null===e?-1:e},getLastPartiallyVisibleColumn(){let e=this.dataAccessObject.endColumnPartiallyVisible;return null===e?-1:e},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,eb.defineGetter)(eS,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});class eE extends ev{constructor(e,t,i,r){super(e,t,i,r,"top")}}(0,eb.mixin)(eE,eC),(0,eb.mixin)(eE,eS);var eR=i(93924);function eT(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var ex=new WeakSet;class eM{constructor(e){!function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,ex),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,t,i){if(e.col<0||e.row<0)return!1;let r=this.scrollViewportHorizontally(e.col,t),n=this.scrollViewportVertically(e.row,i);return r||n}scrollViewportHorizontally(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;let n=(0,eb.createObjectPropListener)(t);if(!Number.isInteger(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,n))||e<0||e>r)return!1;t=n.value;let{fixedColumnsStart:o,inlineStartOverlay:s}=this.dataAccessObject,l="auto"===t;if(l&&e<o)return!1;let a=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn(),u=!1;return(l&&(e<a||e>h)||!l)&&(u=s.scrollTo(e,l?e>=this.getLastPartiallyVisibleColumn():"end"===t)),u}scrollViewportVertically(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;let n=(0,eb.createObjectPropListener)(t);if(!Number.isInteger(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,n))||e<0||e>r)return!1;t=n.value;let{fixedRowsBottom:o,fixedRowsTop:s,topOverlay:l}=this.dataAccessObject,a="auto"===t;if(a&&(e<s||e>r-o-1))return!1;let h=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=!1;return(a&&(e<h||e>u)||!a)&&(c=l.scrollTo(e,a?e>=this.getLastPartiallyVisibleRow():"bottom"===t)),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return eT(ex,this,ek).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return eT(ex,this,ek).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return eT(ex,this,eO).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return eT(ex,this,eO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function eO(e){let{wtSettings:t,inlineStartOverlay:i,wtTable:n,wtViewport:o,totalColumns:s,rootWindow:l}=this.dataAccessObject;if(i.mainTableScrollableElement===l){let a=t.getSetting("rtlMode"),h=null;if(a){let e=n.TABLE.getBoundingClientRect(),t=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(e.right-t)}else h=(0,r.offset)(n.wtRootElement).left;let u=Math.abs((0,r.getScrollLeft)(l,l));if(h>u){let t=(0,r.innerWidth)(l),n=o.getRowHeaderWidth();for(let r=1;r<=s;r++)if(h+(n+=i.sumCellSizes(r-1,r))-u>=t){e=r-2;break}}}return e}function ek(e){let{topOverlay:t,wtTable:i,wtViewport:n,totalRows:o,rootWindow:s}=this.dataAccessObject;if(t.mainTableScrollableElement===s){let l=(0,r.offset)(i.wtRootElement),a=(0,r.getScrollTop)(s,s);if(l.top>a){let i=(0,r.innerHeight)(s),h=n.getColumnHeaderHeight();for(let r=1;r<=o;r++)if(h+=t.sumCellSizes(r-1,r),l.top+h-a>=i){e=r-2;break}}}return e}var eI=i(73183),eA=i(71190);function eN(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class eH{get eventManager(){return new n.A(this)}constructor(e,t){eN(this,"wtTable",void 0),eN(this,"wtScroll",void 0),eN(this,"wtViewport",void 0),eN(this,"wtOverlays",void 0),eN(this,"selectionManager",void 0),eN(this,"wtEvent",void 0),eN(this,"guid",`wt_${(0,eR.randomString)()}`),eN(this,"drawInterrupted",!1),eN(this,"drawn",!1),eN(this,"activeOverlayName","master"),eN(this,"domBindings",void 0),eN(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=t,this.wtScroll=new eM(this.createScrollDao())}findOriginalHeaders(){let e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let t=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;t<i;t++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[t].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(t,i){(0,r.fastInnerText)(i,e[t])}])}}createCellCoords(e,t){return new eI.A(e,t,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,t,i){return new eA.A(e,t,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,!this.wtTable.isVisible()||(0,r.hasZeroHeight)(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t)return this.wtTable.getCell(e);let i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<o&&e.row>=i-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else if(e.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);else if(e.row<i&&e.row>=i-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e);return this.wtTable.getCell(e)}scrollViewport(e,t,i){return this.wtScroll.scrollViewport(e,t,i)}scrollViewportHorizontally(e,t){return this.wtScroll.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this.wtScroll.scrollViewportVertically(e,t)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get stylesHandler(){return e.stylesHandler},get drawn(){return e.drawn},set drawn(v){e.drawn=v},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function eP(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class e_ extends eH{constructor(e,t,i){super(e,t),eP(this,"cloneSource",void 0),eP(this,"cloneOverlay",void 0);let r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new T(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}class eL{constructor(e,t,i,n,o){!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[t]=null}(this,"wtSettings",null),(0,eb.defineGetter)(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=t,this.wtSettings=n;let{TABLE:s,hider:l,spreader:a,holder:h,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=a,this.holder=h,this.wtRootElement=u,this.trimmingContainer=(0,r.getTrimmingContainer)(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){"before"===e&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==e||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,r.getTrimmingContainer)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:e}=this.wot,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,r.getScrollableElement)(e.TABLE)}getRelativeCellPosition(e,t,i){if(!1===this.clone.wtTable.holder.contains(e)){(0,O.R8)(`The provided element is not a child of the ${this.type} overlay`);return}let r=this.mainTableScrollableElement===this.domBindings.rootWindow,n=i<this.wtSettings.getSetting("fixedColumnsStart"),o=t<this.wtSettings.getSetting("fixedRowsTop"),s=t>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(e),top:e.offsetTop},u=null;return r?this.getRelativeCellPositionWithinWindow(o,n,h,a):this.getRelativeCellPositionWithinHolder(o,s,n,h,a)}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,t,i,n){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(t){let e=o.left;this.isRtl()&&(e=this.domBindings.rootWindow.innerWidth-(o.left+o.width+(0,r.getScrollbarWidth)())),s=e<=0?-1*e:0}else s=n.start;return l=e?this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:n.top,{start:i.start+s,top:i.top+l}}getRelativeCellPositionWithinHolder(e,t,i,r,n){let o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,l=0;if(i||(s=o.horizontal-n.start),t){let e=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-+this.clone.wtTable.TABLE.getBoundingClientRect().top+e.top}else e||(l=o.vertical-n.top);return{start:r.start-s,top:r.top-l}}makeClone(){if(-1===ep.indexOf(this.type))throw Error(`Clone type "${this.type}" is not supported.`);let{wtTable:e,wtSettings:t}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),l=e.wtRootElement.parentNode;o.className=`${em.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,t.getSetting("ariaTags")&&(0,r.setAttribute)(o,[(0,G.gg)()]),s.className=e.TABLE.className,e.TABLE.getAttribute("role")&&s.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(s),l.appendChild(o);let a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&"top"===this.type||"vertical"===a&&this.type===ed?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=(0,r.getScrollableElement)(e.TABLE),new e_(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){let t=this.clone.cloneSource;t.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),t.activeOverlayName="master"}}reset(){let e=this.clone.wtTable.holder,t=this.clone.wtTable.hider,i=e.style;[i,t.style,e.parentNode.style].forEach(e=>{e.width="",e.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}let eD=e=>{let t=e.stylesHandler;if(t.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});let i=t.getCSSVariableValue("cell-autofill-size");return Object.freeze({width:i,height:i,borderWidth:t.getCSSVariableValue("cell-autofill-border-width"),borderStyle:"solid",borderColor:t.getCSSVariableValue("cell-autofill-border-color")})};class eF extends eL{constructor(e,t,i,r){super(e,t,"top",i,r),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:-1,enumerable:!0,configurable:!0,writable:!0}):e[t]=-1}(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new eE(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode,{rootWindow:t}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),n=0,o=!1;if(this.trimmingContainer!==t||i&&"vertical"===i)n=this.getScrollPosition(),(0,r.resetCssTransform)(e);else{let{wtTable:t}=this.wot;o=Math.ceil(t.hider.getBoundingClientRect().bottom)===e.offsetHeight,n=this.getOverlayOffset(),(0,r.setOverlayPosition)(e,"0px",`${n}px`)}let s=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),s}setScrollPosition(e){let{rootWindow:t}=this.domBindings,i=this.mainTableScrollableElement,n=!1;if(i===t&&e!==t.scrollY){let i=t.scrollY;t.scrollTo((0,r.getWindowScrollLeft)(t),e),n=i!==t.scrollY}else if(e!==i.scrollTop){let t=i.scrollTop;i.scrollTop=e,n=t!==i.scrollTop}return n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){let i=this.wot.stylesHandler.getDefaultRowHeight(),r=e,n=0;for(;r<t;){let e=this.wot.wtTable.getRowHeight(r);n+=void 0===e?i:e,r+=1}return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===s){let n=t.getWorkspaceWidth();t.hasVerticalScroll()&&(n-=(0,r.getScrollbarWidth)(i)),n=Math.min(n,e.wtRootElement.scrollWidth),o.width=`${n}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=(0,r.outerHeight)(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,t=eD(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(t.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===e)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let{wot:i,wtSettings:n}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,s=n.getSetting("columnHeaders"),l=+(0===n.getSetting("fixedRowsTop")&&s.length>0&&!(0,r.hasClass)(o.parentNode,"innerBorderTop")),a=this.getTableParentOffset(),h=0;if(t&&this.wot.wtTable.getRowHeight(e)>this.wot.wtViewport.getViewportHeight()&&(t=!1),t&&o.offsetHeight!==o.clientHeight&&(h=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),t){let t=n.getSetting("fixedRowsBottom"),r=n.getSetting("totalRows");a+=this.sumCellSizes(0,e+1),a-=i.wtViewport.getViewportHeight()-this.sumCellSizes(r-t,r),a+=1,a+=l}else a+=this.sumCellSizes(n.getSetting("fixedRowsTop"),e);return a+=h,(0,r.getMaximumScrollTop)(this.mainTableScrollableElement)===a-l&&l>0&&this.wot.wtOverlays.expandHiderVerticallyBy(l),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){let e=this.wot.wtTable.getTotalHeight(),t=this.clone.wtTable.getTotalHeight();(i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>e-t&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{wtSettings:i}=this,n=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),s="horizontal"===i.getSetting("preventOverflow");o?(0,r.removeClass)(n,"emptyColumns"):(0,r.addClass)(n,"emptyColumns");let l=!1;if(!t&&!s){let t=i.getSetting("fixedRowsTop"),o=this.cachedFixedRowsTop!==t,s=i.getSetting("columnHeaders");if((o||0===t)&&s.length>0){let t=(0,r.hasClass)(n,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||0===i.getSetting("totalRows")?((0,r.addClass)(n,"innerBorderTop"),l=!t):((0,r.removeClass)(n,"innerBorderTop"),l=t)}}return l}}let eV={getFirstRenderedRow(){let e=this.getRenderedRowsCount();return 0===e?-1:this.wtSettings.getSetting("totalRows")-e},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return 0===this.getRenderedRowsCount()?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,eb.defineGetter)(eV,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});class eW extends ev{constructor(e,t,i,r){super(e,t,i,r,ec)}}(0,eb.mixin)(eW,eV),(0,eb.mixin)(eW,eS);class eB extends eL{constructor(e,t,i,r){super(e,t,ec,i,r),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:-1,enumerable:!0,configurable:!0,writable:!0}):e[t]=-1}(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new eW(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,t=this.clone.wtTable.holder.parentNode;t.style.top="";let i=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==e||r&&"vertical"===r?(i=this.getScrollPosition(),this.repositionOverlay()):(i=this.getOverlayOffset(),t.style.bottom=`${i}px`);let n=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),n}repositionOverlay(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=(0,r.getScrollbarWidth)(i)),n.style.bottom=`${o}px`}setScrollPosition(e){let{rootWindow:t}=this.domBindings,i=this.mainTableScrollableElement,n=!1;if(i===t&&e!==t.scrollY){let e=t.scrollY;t.scrollTo((0,r.getWindowScrollLeft)(t),top),n=e!==t.scrollY}else if(e!==i.scrollTop){let t=i.scrollTop;i.scrollTop=e,n=t!==i.scrollTop}return n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,t){let{wtTable:i,stylesHandler:r}=this.wot,n=r.getDefaultRowHeight(),o=e,s=0;for(;o<t;){let e=i.getRowHeight(o);s+=void 0===e?n:e,o+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===s){let n=t.getWorkspaceWidth();t.hasVerticalScroll()&&(n-=(0,r.getScrollbarWidth)(i)),n=Math.min(n,e.wtRootElement.scrollWidth),o.width=`${n}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=(0,r.outerHeight)(this.clone.wtTable.TABLE);e.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){let e=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===e)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let e=this.isRtl()?"right":"left",{spreader:t}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?t.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:t.style[e]=""}scrollTo(e,t){let i=this.getTableParentOffset(),n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;t&&n.offsetHeight!==n.clientHeight&&(o=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),t?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===e&&(!t||"vertical"!==t)){let e=this.wot.wtTable.getTotalHeight(),t=this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;(i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+e,0))>e-t&&(i=0)}return i}adjustHeaderBordersPosition(e){let t=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==t,n=this.wtSettings.getSetting("columnHeaders"),o=!1;if((i||0===t)&&n.length>0){let t=this.wot.wtTable.holder.parentNode,i=(0,r.hasClass)(t,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||0===this.wtSettings.getSetting("totalRows")?((0,r.addClass)(t,"innerBorderBottom"),o=!i):((0,r.removeClass)(t,"innerBorderBottom"),o=i)}return o}}let ej={getFirstRenderedRow(){let e=this.dataAccessObject.startRowRendered;return null===e?-1:e},getFirstVisibleRow(){let e=this.dataAccessObject.startRowVisible;return null===e?-1:e},getFirstPartiallyVisibleRow(){let e=this.dataAccessObject.startRowPartiallyVisible;return null===e?-1:e},getLastRenderedRow(){let e=this.dataAccessObject.endRowRendered;return null===e?-1:e},getLastVisibleRow(){let e=this.dataAccessObject.endRowVisible;return null===e?-1:e},getLastPartiallyVisibleRow(){let e=this.dataAccessObject.endRowPartiallyVisible;return null===e?-1:e},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,eb.defineGetter)(ej,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});let ez={getFirstRenderedColumn(){return 0===this.getRenderedColumnsCount()?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,eb.defineGetter)(ez,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});class eU extends ev{constructor(e,t,i,r){super(e,t,i,r,ed)}}(0,eb.mixin)(eU,ej),(0,eb.mixin)(eU,ez);class e$ extends eL{constructor(e,t,i,r){super(e,t,ed,i,r)}createTable(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new eU(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,i=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==t||n&&"horizontal"===n?(o=this.getScrollPosition(),(0,r.resetCssTransform)(i)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,r.setOverlayPosition)(i,`${o}px`,"0px"));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(e){let{rootWindow:t}=this.domBindings,i=!1;this.isRtl()&&(e=-e);let n=this.mainTableScrollableElement;if(n===t&&e!==t.scrollX){let n=t.scrollX;t.scrollTo(e,(0,r.getWindowScrollTop)(t)),i=n!==t.scrollX}else if(e!==n.scrollLeft){let t=n.scrollLeft;n.scrollLeft=e,i=t!==n.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,t){let i=this.wtSettings.getSetting("defaultColumnWidth"),r=e,n=0;for(;r<t;)n+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===s){let n=t.getWorkspaceHeight();t.hasHorizontalScroll()&&(n-=(0,r.getScrollbarWidth)(i)),n=Math.min(n,e.wtRootElement.scrollHeight),o.height=`${n}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;let l=(0,r.outerWidth)(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){let{holder:e}=this.clone.wtTable,t=eD(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(t.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){let e=this.wtSettings.getSetting("totalColumns"),t=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(0===e)this.spreader.style[t]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,t){let{wtSettings:i}=this,n=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=+(0===o&&n.length>0&&!(0,r.hasClass)(s.parentNode,"innerBorderInlineStart")),a=this.getTableParentOffset(),h=0;return t&&this.wot.wtTable.getColumnWidth(e)>this.wot.wtViewport.getViewportWidth()&&(t=!1),t&&s.offsetWidth!==s.clientWidth&&(h=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),t?(a+=this.sumCellSizes(0,e+1),a-=this.wot.wtViewport.getViewportWidth(),a+=l):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),a+=h,(0,r.getMaximumScrollLeft)(this.mainTableScrollableElement)===a-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(a)}getTableParentOffset(){let e=this.wtSettings.getSetting("preventOverflow"),t=0;return e||this.trimmingContainer!==this.domBindings.rootWindow||(t=this.wot.wtTable.holderOffset.left),t}getScrollPosition(){return Math.abs((0,r.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:e}=this.domBindings,t=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===e&&(!t||"horizontal"!==t)){i=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let e=this.wot.wtTable.getTotalWidth();i>e-this.clone.wtTable.getTotalWidth()&&(i=0)}return i}adjustHeaderBordersPosition(e){let{wtSettings:t}=this,i=this.wot.wtTable.holder.parentNode,n=t.getSetting("rowHeaders"),o=t.getSetting("fixedColumnsStart"),s=t.getSetting("totalRows"),l="vertical"===t.getSetting("preventOverflow");s?(0,r.removeClass)(i,"emptyRows"):(0,r.addClass)(i,"emptyRows");let a=!1;if(!l){if(o&&!n.length)(0,r.addClass)(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){let t=(0,r.hasClass)(i,"innerBorderInlineStart");e?((0,r.addClass)(i,"innerBorderLeft innerBorderInlineStart"),a=!t):((0,r.removeClass)(i,"innerBorderLeft innerBorderInlineStart"),a=t)}}return a}}class eG extends ev{constructor(e,t,i,r){super(e,t,i,r,eg)}}function eY(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}(0,eb.mixin)(eG,eC),(0,eb.mixin)(eG,ez);class eK extends eL{constructor(e,t,i,r,n,o){super(e,t,eg,i,r),eY(this,"topOverlay",void 0),eY(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new eG(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let t=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();(0,r.setOverlayPosition)(e,`${t}px`,`${i}px`)}else(0,r.resetCssTransform)(e);let t=(0,r.outerHeight)(this.clone.wtTable.TABLE),i=(0,r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(t=0),e.style.height=`${t}px`,e.style.width=`${i}px`,!1}}class eX extends ev{constructor(e,t,i,r){super(e,t,i,r,ef)}}(0,eb.mixin)(eX,eV),(0,eb.mixin)(eX,ez);class eq extends eL{constructor(e,t,i,r,n,o){super(e,t,ef,i,r),this.bottomOverlay=n,this.inlineStartOverlay=o}createTable(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return new eX(...t)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(t.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let e=this.inlineStartOverlay.getOverlayOffset(),i=this.bottomOverlay.getOverlayOffset();t.style[this.isRtl()?"right":"left"]=`${e}px`,t.style.bottom=`${i}px`}else(0,r.resetCssTransform)(t),this.repositionOverlay();let i=(0,r.outerHeight)(this.clone.wtTable.TABLE),n=(0,r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),t.style.height=`${i}px`,t.style.width=`${n}px`,!1}repositionOverlay(){let{wtTable:e,wtViewport:t}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;t.hasVerticalScroll()||(o+=t.getWorkspaceHeight()-e.getTotalHeight()),t.hasVerticalScroll()&&t.hasHorizontalScroll()&&(o+=(0,r.getScrollbarWidth)(i)),n.style.bottom=`${o}px`}}function eJ(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function eZ(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function eQ(e,t,i){return e.set(e1(e,t),i),i}function e0(e,t){return e.get(e1(e,t))}function e1(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var e2=new WeakMap,e3=new WeakMap,e5=new WeakMap,e9=new WeakMap;class e8{constructor(e,t,i,n,o,s){eZ(this,"wot",null),eJ(this,e2,[]),eZ(this,"topOverlay",null),eZ(this,"bottomOverlay",null),eZ(this,"inlineStartOverlay",null),eZ(this,"topInlineStartCornerOverlay",null),eZ(this,"bottomInlineStartCornerOverlay",null),eZ(this,"browserLineHeight",void 0),eZ(this,"wtSettings",null),eJ(this,e3,!1),eJ(this,e5,0),eJ(this,e9,null),eZ(this,"resizeObserver",new ResizeObserver(e=>{(0,l.requestAnimationFrame)(()=>{Array.isArray(e)&&e.length&&(eQ(e5,this,e0(e5,this)+1),100===e0(e5,this)&&((0,O.R8)("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==e0(e9,this)&&clearTimeout(e0(e9,this)),eQ(e9,this,setTimeout(()=>{eQ(e5,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=n,this.domBindings=i,this.facadeGetter=t,this.wtTable=s;let{rootDocument:a,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=(0,r.getScrollbarWidth)(a);let u="hidden"===h.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=u?s.holder:(0,r.getScrollableElement)(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=[...e0(e2,this)];return e&&t.push(this.wtTable),t}initBrowserLineHeight(){let{rootWindow:e,rootDocument:t}=this.domBindings,i=e.getComputedStyle(t.body),r=parseInt(i.lineHeight,10),n=1.2*parseInt(i.fontSize,10);this.browserLineHeight=r||n}initOverlays(){let e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new eF(...e),this.bottomOverlay=new eB(...e),this.inlineStartOverlay=new e$(...e),this.topInlineStartCornerOverlay=new eK(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new eq(...e,this.bottomOverlay,this.inlineStartOverlay),eQ(e2,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){eQ(e3,this,e0(e2,this).reduce((e,t)=>t.hasRenderingStateChanged()||e,!1)),e0(e2,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),e0(e2,this).forEach(e=>{let t=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),t&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let e,{rootDocument:t,rootWindow:i}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(t.documentElement,"keydown",e=>this.onKeyDown(e)),this.eventManager.addEventListener(t.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(t,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",e=>this.onTableScroll(e),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",e=>this.onTableScroll(e),{passive:!0});let o=i.devicePixelRatio&&i.devicePixelRatio>1,s=this.scrollableElement===i,h=this.wtSettings.getSetting("preventWheel"),u={passive:s};(h||o||!(0,a.isChrome)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",e=>this.onCloneWheel(e,h),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(e=>{this.eventManager.addEventListener(e.clone.wtTable.holder,"wheel",e=>this.onCloneWheel(e,h),u)}),this.eventManager.addEventListener(i,"resize",()=>{(0,l.requestAnimationFrame)(()=>{clearTimeout(e),this.wtSettings.getSetting("onWindowResize"),e=setTimeout(()=>{eQ(e5,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){let t=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,n=e.target;(!this.keyPressed||(r===t||n===t||e.target.contains(r))&&(i===t||n===t||e.target.contains(i)))&&this.syncScrollPositions(e)}onCloneWheel(e,t){let{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=e.target,s=n!==i&&o!==i&&!o.contains(n),l=r!==i&&o!==i&&!o.contains(r);if(this.keyPressed&&(s||l)||this.scrollableElement===i)return;let a=this.translateMouseWheelToScroll(e);(t||this.scrollableElement!==i&&a)&&e.preventDefault()}onKeyDown(e){this.keyPressed=(0,M.isKey)(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let t=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;1===e.deltaMode&&(i+=i*this.browserLineHeight,t+=t*this.browserLineHeight);let r=this.scrollVertically(t),n=this.scrollHorizontally(i);return r||n}scrollVertically(e){let t=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,t!==this.scrollableElement.scrollTop}scrollHorizontally(e){let t=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,t!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let e=this.topOverlay.clone.wtTable.holder,t=this.inlineStartOverlay.clone.wtTable.holder,i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;let t=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;t&&(t.scrollLeft=i)}this.verticalScrolling&&(t.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!e0(e3,this))return;let{scrollLeft:e,scrollTop:t}=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=e),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=e),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=t),eQ(e3,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:e}=this,{rootWindow:t}=this.domBindings;"hidden"===t.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=e.holder:this.scrollableElement=(0,r.getScrollableElement)(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){let e=this.wtTable.spreader,t=e.clientWidth,i=e.clientHeight,r=t!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=t,this.spreaderLastSize.height=i),r}adjustElementsSize(){let{wtViewport:e}=this.wot,{wtTable:t}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,n=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=e.getRowHeaderWidth(),l=e.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,a=s+this.inlineStartOverlay.sumCellSizes(0,n),h=t.hider.style,u=+!!(!r&&this.scrollableElement.scrollTop>Math.max(0,l-t.holder.clientHeight)),c=+!!(!r&&this.scrollableElement.scrollLeft>Math.max(0,a-t.holder.clientWidth));h.width=`${a+c}px`,h.height=`${l+u}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){let{wtTable:t}=this;t.hider.style.height=`${parseInt(t.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){let{wtTable:t}=this;t.hider.style.width=`${parseInt(t.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;let t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return(0,x.arrayEach)(t,t=>{t&&t.clone&&t.clone.wtTable.TABLE.contains(e)&&(i=t.clone)}),i}syncOverlayTableClassNames(){let e=this.wtTable.TABLE,t=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,x.arrayEach)(t,t=>{t&&(t.clone.wtTable.TABLE.className=e.className)})}}function e4(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class e7{constructor(e){e4(this,"settings",{}),e4(this,"defaults",Object.freeze(this.getDefaults())),(0,eb.objectEach)(this.defaults,(t,i)=>{if(void 0!==e[i])this.settings[i]=e[i];else if(void 0===t)throw Error(`A required setting "${i}" was not provided`);else this.settings[i]=t})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(e,t,i)=>{let n=this.getSetting("data",e,t);(0,r.fastInnerText)(i,null==n?"":n)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(e,t){return void 0===t?(0,eb.objectEach)(e,(e,t)=>{this.settings[t]=e}):this.settings[e]=t,this}getSetting(e,t,i,r,n){return"function"==typeof this.settings[e]?this.settings[e](t,i,r,n):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class e6 extends ev{constructor(e,t,i,r){super(e,t,i,r,"master")}alignOverlaysWithTrimmingContainer(){let e=(0,r.getTrimmingContainer)(this.wtRootElement),{rootWindow:t}=this.domBindings;if(e===t)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let i=e.parentElement,n=(0,r.getStyle)(e,"height",t),o=(0,r.getStyle)(e,"overflow",t),s=this.holder.style,{scrollWidth:l,scrollHeight:a}=e,h=e.offsetWidth,u=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){let r=e.cloneNode(!1);r.style.overflow="auto",r.style.position="absolute",e.nextElementSibling?i.insertBefore(r,e.nextElementSibling):i.appendChild(r);let n=parseInt(t.getComputedStyle(r).height,10);i.removeChild(r),0===n&&(u=0)}u=Math.min(u,a),s.height="auto"===n?"auto":`${u}px`,h=Math.min(h,l),s.width=`${h}px`,s.overflow="",this.hasTableHeight="auto"===s.height||u>0,this.hasTableWidth=h>0}this.isTableVisible=(0,r.isVisible)(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:e}=this,{wtViewport:t}=this.dataAccessObject,i="master",r=e.getSetting("columnHeaders").length;if(r&&!t.hasOversizedColumnHeadersMarked[i]){let n=e.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount();for(let e=0;e<r;e++)for(let e=-1*n;e<o;e++)this.markIfOversizedColumnHeader(e);t.hasOversizedColumnHeadersMarked[i]=!0}}}function te(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}(0,eb.mixin)(e6,ej),(0,eb.mixin)(e6,eS),i(85522);class tt{constructor(){te(this,"count",0),te(this,"startRow",0),te(this,"endRow",0),te(this,"startPosition",0),te(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:t}=e;this.count=t,this.endRow=this.count-1}process(){}finalize(){}}function ti(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(72979),i(70527);class tr{constructor(){ti(this,"count",0),ti(this,"startRow",null),ti(this,"endRow",null),ti(this,"startPosition",null),ti(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:n}=t;i<=r&&(this.startRow=e),i>=r&&i<=n&&null===this.startRow&&(this.startRow=e),this.endRow=e}finalize(e){var t;let{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:n,totalRows:o,needReverse:s,startPositions:l,rowHeight:a}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){let e=l[this.endRow]+a-l[this.startRow-1];if(this.startRow-=1,e>=r-n)break}this.startPosition=null!==(t=l[this.startRow])&&void 0!==t?t:null,i+r-n<0||i>l.at(-1)+a?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function tn(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class to extends tr{constructor(){super(...arguments),tn(this,"rowStartOffset",0),tn(this,"rowEndOffset",0)}finalize(e){var t;super.finalize(e);let{overrideFn:i,totalRows:r,startPositions:n}=e;if(null!==this.startRow&&"function"==typeof i){let e=this.startRow,t=this.endRow;i(this),this.rowStartOffset=e-this.startRow,this.rowEndOffset=this.endRow-t}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(t=n[this.startRow])&&void 0!==t?t:null,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function ts(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tl{constructor(){ts(this,"count",0),ts(this,"startRow",null),ts(this,"endRow",null),ts(this,"startPosition",null),ts(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:n,rowHeight:o}=t;i>=r&&i+o<=n&&(null===this.startRow&&(this.startRow=e),this.endRow=e)}finalize(e){var t;let{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:n,totalRows:o,needReverse:s,startPositions:l,rowHeight:a}=e;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){let e=l[this.endRow]+a-l[this.startRow-1];if(e<=r-n&&(this.startRow-=1),e>=r-n)break}this.startPosition=null!==(t=l[this.startRow])&&void 0!==t?t:null,i+r-n<(null===this.startRow?0:e.getRowHeight(this.startRow))||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function ta(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class th{constructor(){ta(this,"count",0),ta(this,"startColumn",0),ta(this,"endColumn",0),ta(this,"startPosition",0),ta(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:t}=e;this.count=t,this.endColumn=this.count-1}process(){}finalize(){}}function tu(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tc{constructor(){tu(this,"count",0),tu(this,"startColumn",null),tu(this,"endColumn",null),tu(this,"startPosition",null),tu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:n}=t;i<=r&&(this.startColumn=e),i>=r&&i<=r+(r>0?n+1:n)&&(null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=e),this.endColumn=e}finalize(e){var t;let{scrollOffset:i,viewportWidth:r,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=e;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){let e=a[this.endColumn]+h-a[this.startColumn-1];if(this.startColumn-=1,e>r)break}this.startPosition=null!==(t=a[this.startColumn])&&void 0!==t?t:null,i+r-(o>0?r+1:r)<-1*n||i>a.at(-1)+h||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function td(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tg extends tc{constructor(){super(...arguments),td(this,"columnStartOffset",0),td(this,"columnEndOffset",0)}finalize(e){var t;super.finalize(e);let{overrideFn:i,totalColumns:r,startPositions:n}=e;if(null!==this.startColumn&&"function"==typeof i){let e=this.startColumn,t=this.endColumn;i(this),this.columnStartOffset=e-this.startColumn,this.columnEndOffset=this.endColumn-t}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(t=n[this.startColumn])&&void 0!==t?t:null,r<this.endColumn&&(this.endColumn=r-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function tf(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tp{constructor(){tf(this,"count",0),tf(this,"startColumn",null),tf(this,"endColumn",null),tf(this,"startPosition",null),tf(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,t){let{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:n,columnWidth:o}=t;i>=r&&i+o<=r+(r>0?n+1:n)&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var t;let{scrollOffset:i,viewportWidth:r,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=e;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){let e=a[this.endColumn]+h-a[this.startColumn-1];if(e<=r&&(this.startColumn-=1),e>=r)break}this.startPosition=null!==(t=a[this.startColumn])&&void 0!==t?t:null;let u=null===this.startColumn?0:e.getColumnWidth(this.startColumn);i+r-(o>0?r+1:r)<-1*n||i>a.at(-1)||-1*i-r>-1*u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}var tm=i(27704);function tw(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ty extends tm.C{constructor(e){let{calculationTypes:t,viewportHeight:i,scrollOffset:r,totalRows:n,defaultRowHeight:o,rowHeightFn:s,overrideFn:l,horizontalScrollbarHeight:a}=e;super(t),tw(this,"viewportHeight",0),tw(this,"scrollOffset",0),tw(this,"zeroBasedScrollOffset",0),tw(this,"totalRows",0),tw(this,"rowHeightFn",null),tw(this,"rowHeight",0),tw(this,"overrideFn",null),tw(this,"horizontalScrollbarHeight",0),tw(this,"innerViewportHeight",0),tw(this,"totalCalculatedHeight",0),tw(this,"startPositions",[]),tw(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=n,this.rowHeightFn=s,this.overrideFn=l,this.horizontalScrollbarHeight=null!=a?a:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){let t=this.rowHeightFn(e);return isNaN(t)?this.defaultHeight:t}}var tv=i(67758);class tb{constructor(e,t,i,r,n){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=t,this.wtSettings=i,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new tt:new to],["fullyVisible",()=>new tl],["partiallyVisible",()=>new tr]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new th:new tg],["fullyVisible",()=>new tp],["partiallyVisible",()=>new tc]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let e=this.domBindings.rootDocument,t=this.dataAccessObject.topOverlayTrimmingContainer,i=0;return t===this.domBindings.rootWindow?e.documentElement.clientHeight:(0,r.outerHeight)(t)>0&&t.clientHeight>0?t.clientHeight:1/0}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;let t=this.getColumnHeaderHeight();return t>0&&(e-=t),e}getWorkspaceWidth(){let e,{rootDocument:t,rootWindow:i}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;if(r===i){let i=this.wtSettings.getSetting("totalColumns");e=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,i)>e&&(e=t.documentElement.clientWidth)}else e=r.clientWidth;return e}getViewportWidth(){let e=this.getWorkspaceWidth();if(e===1/0)return e;let t=this.getRowHeaderWidth();return t>0?e-t:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){let e=this.domBindings.rootDocument.documentElement;return e.scrollHeight>e.clientHeight}let{holder:e,hider:t}=this.wtTable,i=e.clientHeight,r=t.offsetHeight;return i<r||r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){let e=this.domBindings.rootDocument.documentElement;return e.scrollWidth>e.clientWidth}let{holder:e,hider:t}=this.wtTable,i=e.clientWidth,r=t.offsetWidth;return i<r||r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,t){let i=0,r=e;for(;r<t;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return(0,r.offset)(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,r.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){let e=this.wtSettings.getSetting("rowHeaderWidth"),t=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=t.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(t.length){let e=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,n=t.length;i<n;i++)e?(this.rowHeaderWidth+=(0,r.outerWidth)(e),e=e.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:n,wtTable:o}=this,s=this.getViewportHeight();this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,a=n.getSetting("fixedRowsTop"),h=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return a&&l>=0&&(l+=t=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s-=t),h&&this.dataAccessObject.bottomOverlay.clone&&(s-=t=this.dataAccessObject.bottomOverlay.sumCellSizes(u-h,u)),e=o.holder.clientHeight===o.holder.offsetHeight?0:(0,r.getScrollbarWidth)(this.domBindings.rootDocument),new ty({calculationTypes:i.map(e=>[e,this.rowsCalculatorTypes.get(e)()]),viewportHeight:s,scrollOffset:l,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:e=>o.getRowHeight(e),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:e})}createColumnsCalculator(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:t,wtTable:i}=this,n=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=t.getSetting("fixedColumnsStart");if(s&&o>=0){let e=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=e,n-=e}return i.holder.clientWidth!==i.holder.offsetWidth&&(n-=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),new tv.U({calculationTypes:e.map(e=>[e,this.columnsCalculatorTypes.get(e)()]),viewportWidth:n,scrollOffset:o,totalColumns:t.getSetting("totalColumns"),columnWidthFn:e=>i.getColumnWidth(e),overrideFn:t.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:t}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!t.getSetting("renderAllRows")){let t=i.getResultsFor("fullyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(t)}if(e&&!t.getSetting("renderAllColumns")){let t=r.getResultsFor("fullyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(t)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){let e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),t=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=t.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e){if(!this.rowsVisibleCalculator)return!1;let{startRow:t,endRow:i}=e;if(null===t&&null===i){if(!e.isVisibleInTrimmingContainer)return!0;t=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}let{startRow:r,endRow:n,rowStartOffset:o,rowEndOffset:s}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,a=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(a)&&a>0?(t=Math.max(0,t-Math.min(o,a)),i=Math.min(l,i+Math.min(s,a))):"auto"===a&&(t=Math.max(0,t-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(s/2))),!(t<r)&&(t!==r||!(t>0))&&!(i>n)&&(i!==n||!(i<l))}areAllProposedVisibleColumnsAlreadyRendered(e){if(!this.columnsVisibleCalculator)return!1;let{startColumn:t,endColumn:i}=e;if(null===t&&null===i){if(!e.isVisibleInTrimmingContainer)return!0;t=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}let{startColumn:r,endColumn:n,columnStartOffset:o,columnEndOffset:s}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,a=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(a)&&a>0?(t=Math.max(0,t-Math.min(o,a)),i=Math.min(l,i+Math.min(s,a))):"auto"===a&&(t=Math.max(0,t-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(s/2))),!(t<r)&&(t!==r||!(t>0))&&!(i>n)&&(i!==n||!(i<l))}resetHasOversizedColumnHeadersMarked(){(0,eb.objectEach)(this.hasOversizedColumnHeadersMarked,(e,t,i)=>{i[t]=void 0})}}function tC(e,t,i){tS(e,t),t.set(e,i)}function tS(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function tE(e,t){return e.get(tT(e,t))}function tR(e,t,i){return e.set(tT(e,t),i),i}function tT(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}i(87426),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var tx=new WeakMap,tM=new WeakMap,tO=new WeakSet;class tk{constructor(){!function(e,t){tS(e,t),t.add(e)}(this,tO),tC(this,tx,void 0),tC(this,tM,void 0)}setActiveOverlay(e){return tR(tM,this,e),this}setActiveSelection(e){return tR(tx,this,e),this}scan(){let e=tE(tx,this).settings.selectionType,t=new Set;return"active-header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"area"===e?this.scanCellsRange(e=>t.add(e)):"focus"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e)),this.scanCellsRange(e=>t.add(e))):"fill"===e?this.scanCellsRange(e=>t.add(e)):"header"===e?(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanRowsInHeadersRange(e=>t.add(e))):"row"===e?(this.scanRowsInHeadersRange(e=>t.add(e)),this.scanRowsInCellsRange(e=>t.add(e))):"column"===e&&(this.scanColumnsInHeadersRange(e=>t.add(e)),this.scanColumnsInCellsRange(e=>t.add(e))),t}scanColumnsInHeadersRange(e){let[t,i,r,n]=tE(tx,this).getCorners(),{wtTable:o}=tE(tM,this),s=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount(),a=0;for(let h=-o.getRowHeadersCount();h<s;h++){let s=o.columnFilter.renderedToSource(h);if(!(s<i)&&!(s>n)){for(let h=-l;h<0;h++){if(h<t||h>r)continue;let u=h+l,c=o.getColumnHeader(s,u),d=tE(tM,this).getSetting("onBeforeHighlightingColumnHeader",s,u,{selectionType:tE(tx,this).settings.selectionType,columnCursor:a,selectionWidth:n-i+1});null!==d&&(d!==s&&(c=o.getColumnHeader(d,u)),e(c))}a+=1}}}scanRowsInHeadersRange(e){let[t,i,r,n]=tE(tx,this).getCorners(),{wtTable:o}=tE(tM,this),s=o.getRenderedRowsCount(),l=o.getRowHeadersCount(),a=0;for(let h=-o.getColumnHeadersCount();h<s;h++){let s=o.rowFilter.renderedToSource(h);if(!(s<t)&&!(s>r)){for(let h=-l;h<0;h++){if(h<i||h>n)continue;let u=h+l,c=o.getRowHeader(s,u),d=tE(tM,this).getSetting("onBeforeHighlightingRowHeader",s,u,{selectionType:tE(tx,this).settings.selectionType,rowCursor:a,selectionHeight:r-t+1});null!==d&&(d!==s&&(c=o.getRowHeader(d,u)),e(c))}a+=1}}}scanCellsRange(e){let{wtTable:t}=tE(tM,this);tT(tO,this,tI).call(this,(i,n)=>{let o=t.getCell(tE(tM,this).createCellCoords(i,n)),s=tE(tM,this).getSetting("onAfterDrawSelection",i,n,tE(tx,this).settings.layerLevel);"string"==typeof s&&(0,r.addClass)(o,s),e(o)})}scanRowsInCellsRange(e){let[t,,i]=tE(tx,this).getCorners(),{wtTable:r}=tE(tM,this);tT(tO,this,tA).call(this,(n,o)=>{n>=t&&n<=i&&e(r.getCell(tE(tM,this).createCellCoords(n,o)))})}scanColumnsInCellsRange(e){let[,t,,i]=tE(tx,this).getCorners(),{wtTable:r}=tE(tM,this);tT(tO,this,tA).call(this,(n,o)=>{o>=t&&o<=i&&e(r.getCell(tE(tM,this).createCellCoords(n,o)))})}}function tI(e){let[t,i,n,o]=tE(tx,this).getCorners();if(t<0&&n<0||i<0&&o<0)return;let{wtTable:s}=tE(tM,this),l=t!==n||i!==o;if(i=Math.max(i,0),o=Math.max(o,0),t=Math.max(t,0),n=Math.max(n,0),l){if(i=Math.max(i,s.getFirstRenderedColumn()),o=Math.min(o,s.getLastRenderedColumn()),t=Math.max(t,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),o<i||n<t)return}else{let e=s.getCell(tE(tM,this).createCellCoords(t,i));if(!(0,r.isHTMLElement)(e))return}for(let r=t;r<=n;r+=1)for(let t=i;t<=o;t+=1)e(r,t)}function tA(e){let{wtTable:t}=tE(tM,this),i=t.getRenderedRowsCount(),r=t.getRenderedColumnsCount();for(let n=0;n<i;n+=1){let i=t.rowFilter.renderedToSource(n);for(let n=0;n<r;n+=1)e(i,t.columnFilter.renderedToSource(n))}}class tN{constructor(e,t){if(!t)return;this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=t,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=eD(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(t),this.registerListeners()}registerListeners(){let e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let e=0,t=this.main.childNodes.length;e<t;e++){let t=this.main.childNodes[e];this.eventManager.addEventListener(t,"mouseenter",t=>this.onMouseEnter(t,this.main.childNodes[e]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,t){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),(0,o.stopImmediatePropagation)(e);let i=this,r=this.wot.rootDocument.body,n=t.getBoundingClientRect();t.style.display="none",this.eventManager.addEventListener(r,"mousemove",function e(o){(function(e){if(e.clientY<Math.floor(n.top)||e.clientY>Math.ceil(n.top+n.height)||e.clientX<Math.floor(n.left)||e.clientX>Math.ceil(n.left+n.width))return!0})(o)&&(i.eventManager.removeEventListener(r,"mousemove",e),t.style.display="block")})}createBorders(e){let{rootDocument:t}=this.wot;this.main=t.createElement("div");let i=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let n=0;n<5;n++){let o=i[n],s=t.createElement("div");s.className=`wtBorder ${this.settings.className||""}`,this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(r=s.style).backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:e.border.color,r.height=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${e.border.width}px`,r.width=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${e.border.width}px`,this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,a.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:n}=this.wot,o=n.bordersHolder;o||((o=t.createElement("div")).className="htBorders",n.bordersHolder=o,n.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:e,stylesHandler:t}=this.wot,i=t.getCSSVariableValue("cell-mobile-handle-size"),r=t.getCSSVariableValue("cell-mobile-handle-border-radius"),n=t.getCSSVariableValue("cell-mobile-handle-background-color"),o=t.getCSSVariableValue("cell-mobile-handle-border-width"),s=t.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let l={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,eb.objectEach)(l,(e,t)=>{this.selectionHandles.styles.bottomHitArea[t]=e,this.selectionHandles.styles.topHitArea[t]=e});let a=t.isClassicTheme()?{position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${r}px`,background:`${n}`,border:`${o}px solid ${s}`};(0,eb.objectEach)(a,(e,t)=>{this.selectionHandles.styles.bottom[t]=e,this.selectionHandles.styles.top[t]=e}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,t){let i=this.wot.selectionManager.getAreaSelection();return!!i.cellRange&&(e!==i.cellRange.to.row||t!==i.cellRange.to.col)}updateMultipleSelectionHandlesPosition(e,t,i,r,n,o){let s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:l,topHitArea:a,bottom:h,bottomHitArea:u}=this.selectionHandles.styles,c=parseInt(l.borderWidth,10),d=parseInt(l.width,10),g=parseInt(a.width,10),f=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();l.top=`${parseInt(i-d-1,10)}px`,l[s]=`${parseInt(r-d-1,10)}px`,a.top=`${parseInt(i-g/4*3,10)}px`,a[s]=`${parseInt(r-g/4*3,10)}px`;let m=Math.min(parseInt(r+n,10),f-d-2*c),w=Math.min(parseInt(r+n-g/4,10),f-g-2*c);h[s]=`${m}px`,u[s]=`${w}px`;let y=Math.min(parseInt(i+o,10),p-d-2*c),b=Math.min(parseInt(i+o-g/4,10),p-g-2*c);h.top=`${y}px`,u.top=`${b}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",a.display="block",this.isPartRange(e,t)?(h.display="none",u.display="none"):(h.display="block",u.display="block")):(l.display="none",h.display="none",a.display="none",u.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||t===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",a.zIndex="9999"):(l.zIndex="",a.zIndex="")}appear(e){let t;if(this.disabled)return;let[i,n,o,s]=e;if(i<0&&o<0||n<0&&s<0){this.disappear();return}let{wtTable:l,rootDocument:h,rootWindow:u}=this.wot,c=i!==o||n!==s,d=l.getFirstRenderedRow(),g=l.getLastRenderedRow(),f=l.getFirstRenderedColumn(),p=l.getLastRenderedColumn();if(f<0&&p<0||d<0&&g<0){this.disappear();return}if(c){if(n=Math.max(n,f),s=Math.min(s,p),i=Math.max(i,d),o=Math.min(o,g),s<n||o<i){this.disappear();return}t=l.getCell(this.wot.createCellCoords(i,n))}else if(t=l.getCell(this.wot.createCellCoords(i,n)),!(0,r.isHTMLElement)(t)){this.disappear();return}let m=c?l.getCell(this.wot.createCellCoords(o,s)):t,w=(0,r.offset)(t),y=c?(0,r.offset)(m):w,b=(0,r.offset)(l.TABLE),C=w.top,S=w.left,E=this.wot.wtSettings.getSetting("rtlMode"),R=0,T=0;if(E){let e=(0,r.outerWidth)(l.TABLE),i=(0,r.outerWidth)(t),n=u.innerWidth-b.left-e;T=S+i-y.left,R=u.innerWidth-S-i-n-1}else T=y.left+(0,r.outerWidth)(m)-S,R=S-b.left-1;if(this.isEntireColumnSelected(i,o)){let e=i,r=this.getDimensionsFromHeader("columns",n,s,e,b),o=null;r&&([o,R,T]=r),o&&(t=o)}let x=C-b.top-1,M=y.top+(0,r.outerHeight)(m)-C;if(this.isEntireRowSelected(n,s)){let e=n,r=this.getDimensionsFromHeader("rows",i,o,e,b),s=null;r&&([s,x,M]=r),s&&(t=s)}let O=u.getComputedStyle(t);parseInt(O.borderTopWidth,10)>0&&(x+=1,M=M>0?M-1:0),parseInt(O[E?"borderRightWidth":"borderLeftWidth"],10)>0&&(R+=1,T=T>0?T-1:0);let k=E?"right":"left";this.topStyle.top=`${x}px`,this.topStyle[k]=`${R}px`,this.topStyle.width=`${T}px`,this.topStyle.display="block",this.startStyle.top=`${x}px`,this.startStyle[k]=`${R}px`,this.startStyle.height=`${M}px`,this.startStyle.display="block";let I=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${x+M-I}px`,this.bottomStyle[k]=`${R}px`,this.bottomStyle.width=`${T}px`,this.bottomStyle.display="block",this.endStyle.top=`${x}px`,this.endStyle[k]=`${R+T-I}px`,this.endStyle.height=`${M+1}px`,this.endStyle.display="block";let A=this.settings.border.cornerVisible;A="function"==typeof A?A(this.settings.layerLevel):A;let N=this.wot.getSetting("onModifyGetCellCoords",o,s,!1,"render"),[H,P]=[o,s];if(N&&Array.isArray(N)&&([,,H,P]=N),(0,a.isMobileBrowser)()||!A||this.isPartRange(H,P))this.cornerStyle.display="none";else{this.cornerStyle.top=`${x+M+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[k]=`${R+T+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let e=(0,r.getTrimmingContainer)(l.TABLE),t=e===u;t&&(e=h.documentElement);let i=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,n=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),a=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){let o=t?m.getBoundingClientRect().left:m.offsetLeft,s=!1,l=0;(E?o-parseInt(this.cornerDefaultStyle.width,10)/2<0:o+(0,r.outerWidth)(m)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,r.innerWidth)(e))&&(this.cornerStyle[k]=`${Math.floor(R+T+this.cornerCenterPointOffset-n-i)}px`,this.cornerStyle[E?"borderLeftWidth":"borderRightWidth"]=0)}if(o===this.wot.getSetting("totalRows")-1){let n=(t?m.getBoundingClientRect().top:m.offsetTop)+(0,r.outerHeight)(m)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,r.innerHeight)(e),o=this.wot.stylesHandler.isClassicTheme();if(n){let e=Math.floor(x+M+this.cornerCenterPointOffset-a-i);o?(this.cornerStyle.top=`${e}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${e-1}px`}}this.cornerStyle.display="block"}(0,a.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,s,x,R,T,M)}isEntireColumnSelected(e,t){return e===this.wot.wtTable.getFirstRenderedRow()&&t===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,t){return e===this.wot.wtTable.getFirstRenderedColumn()&&t===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,t,i,n,o){let{wtTable:s}=this.wot,l=s.wtRootElement.parentNode,a=null,h=null,u=null,c=null,d=null,g=null,f=null,p=null;switch(e){case"rows":a=function(){return s.getRowHeader(...arguments)},h=function(){return(0,r.outerHeight)(...arguments)},u="ht__selection--rows",g="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},h=function(){return(0,r.outerWidth)(...arguments)},u="ht__selection--columns",g="left"}if(l.classList.contains(u)){let e=this.wot.getSetting("columnHeaders").length;if(f=a(t,e-n),p=a(i,e-n),!f||!p)return!1;let s=(0,r.offset)(f),l=(0,r.offset)(p);return f&&p&&(c=s[g]-o[g]-1,d=l[g]+h(p)-s[g]),[f,c,d]}return!1}changeBorderStyle(e,t){let i=this[e].style,n=t[e];!n||n.hide?(0,r.addClass)(this[e],"hidden"):((0,r.hasClass)(this[e],"hidden")&&(0,r.removeClass)(this[e],"hidden"),i.backgroundColor=n.color,("top"===e||"bottom"===e)&&(i.height=`${n.width}px`),("start"===e||"end"===e)&&(i.width=`${n.width}px`))}changeBorderToDefaultStyle(e){let t=this[e].style;t.backgroundColor="#000",t.width="1px",t.height="1px"}toggleHiddenClass(e,t){this.changeBorderToDefaultStyle(e),t?(0,r.addClass)(this[e],"hidden"):(0,r.removeClass)(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,a.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function tH(e,t,i){tP(e,t),t.set(e,i)}function tP(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function t_(e,t){return e.get(tD(e,t))}function tL(e,t,i){return e.set(tD(e,t),i),i}function tD(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var tF=new WeakMap,tV=new WeakMap,tW=new WeakMap,tB=new WeakMap,tj=new WeakMap,tz=new WeakMap,tU=new WeakSet;class t${constructor(e){!function(e,t){tP(e,t),t.add(e)}(this,tU),tH(this,tF,void 0),tH(this,tV,void 0),tH(this,tW,new tk),tH(this,tB,new WeakMap),tH(this,tj,new WeakSet),tH(this,tz,new Map),tL(tV,this,e)}setActiveOverlay(e){return tL(tF,this,e),t_(tW,this).setActiveOverlay(t_(tF,this)),t_(tB,this).has(t_(tF,this))||t_(tB,this).set(t_(tF,this),new Set),this}getFocusSelection(){return null!==t_(tV,this)?t_(tV,this).getFocus():null}getAreaSelection(){return null!==t_(tV,this)?t_(tV,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(t_(tz,this).has(e)){let t=t_(tz,this).get(e);if(t.has(t_(tF,this)))return t.get(t_(tF,this));let i=new tN(t_(tF,this),e.settings);return t.set(t_(tF,this),i),i}let t=new tN(t_(tF,this),e.settings);return t_(tz,this).set(e,new Map([[t_(tF,this),t]])),t}getBorderInstances(e){var t,i;return Array.from(null!==(t=null===(i=t_(tz,this).get(e))||void 0===i?void 0:i.values())&&void 0!==t?t:[])}destroyBorders(e){t_(tz,this).get(e).forEach(e=>e.destroy()),t_(tz,this).delete(e)}render(e){if(null===t_(tV,this))return;e&&tD(tU,this,tG).call(this);let t=Array.from(t_(tV,this)),i=new Map,n=new Map;for(let e=0;e<t.length;e++){let r=t[e],{className:o,headerAttributes:s,createLayers:l,selectionType:a}=r.settings;t_(tj,this).has(r)||(t_(tj,this).add(r),r.addLocalHook("destroy",()=>this.destroyBorders(r)));let h=this.getBorderInstance(r);if(r.isEmpty()){null==h||h.disappear();continue}o&&t_(tW,this).setActiveSelection(r).scan().forEach(e=>{if(i.has(e)){let t=i.get(e);t.has(o)&&!0===l?t.set(o,t.get(o)+1):t.set(o,1)}else i.set(e,new Map([[o,1]]));s&&(n.has(e)||n.set(e,[]),"TH"===e.nodeName&&n.get(e).push(...s))});let u=r.getCorners();t_(tF,this).getSetting("onBeforeDrawBorders",u,a),null==h||h.appear(u)}i.forEach((e,t)=>{var i;let n=Array.from(e).map(e=>{let[t,i]=e;return 1===i?t:[t,...Array.from({length:i-1},(e,i)=>`${t}-${i+1}`)]}).flat();n.forEach(e=>t_(tB,this).get(t_(tF,this)).add(e)),(0,r.addClass)(t,n),"TD"===t.nodeName&&Array.isArray(null===(i=t_(tV,this).options)||void 0===i?void 0:i.cellAttributes)&&(0,r.setAttribute)(t,t_(tV,this).options.cellAttributes)}),Array.from(n.keys()).forEach(e=>{(0,r.setAttribute)(e,[...n.get(e)])})}}function tG(){let e=t_(tB,this).get(t_(tF,this)),t=t_(tF,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(t))for(let i=0;i<t.length;i++)e.add(t[i]);e.forEach(e=>{var t,i;let n=t_(tF,this).wtTable.TABLE.querySelectorAll(`.${e}`),o=[];Array.isArray(null===(t=t_(tV,this).options)||void 0===t?void 0:t.cellAttributes)&&(o=t_(tV,this).options.cellAttributes.map(e=>e[0])),Array.isArray(null===(i=t_(tV,this).options)||void 0===i?void 0:i.headerAttributes)&&(o=[...o,...t_(tV,this).options.headerAttributes.map(e=>e[0])]);for(let t=0,i=n.length;t<i;t++)(0,r.removeClass)(n[t],e),(0,r.removeAttribute)(n[t],o)}),e.clear()}function tY(e,t,i){tK(e,t),t.set(e,i)}function tK(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function tX(e,t){return e.get(tJ(e,t))}function tq(e,t,i){return e.set(tJ(e,t),i),i}function tJ(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var tZ=new WeakMap,tQ=new WeakMap,t0=new WeakMap,t1=new WeakMap,t2=new WeakMap,t3=new WeakMap,t5=new WeakMap,t9=new WeakSet;class t8{constructor(e){!function(e,t){tK(e,t),t.add(e)}(this,t9),tY(this,tZ,void 0),tY(this,tQ,void 0),tY(this,t0,void 0),tY(this,t1,void 0),tY(this,t2,!0),tY(this,t3,{}),tY(this,t5,{}),tq(tQ,this,e.rootTable.parentElement.parentElement),tq(t1,this,e.rootDocument)}isClassicTheme(){return tX(t2,this)}getCSSVariableValue(e){var t;if(tX(t2,this))return null;if(tX(t3,this)[`--ht-${e}`])return tX(t3,this)[`--ht-${e}`];let i=null!==(t=tJ(t9,this,it).call(this,`--ht-${e}`))&&void 0!==t?t:tJ(t9,this,ii).call(this,`--ht-${e}`);if(null!==i)return tX(t3,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var t;return null===(t=tX(t5,this))||void 0===t?void 0:t.td[e]}getDefaultRowHeight(){if(tX(t2,this))return 23;let e=tJ(t9,this,t4).call(this);return!e&&(0,r.hasClass)(tX(tQ,this),"ht-wrapper")?((0,O.R8)(`The "${tX(tZ,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. \
Import the correct CSS files in order to use that theme.`),tq(t2,this,!0),this.useTheme(),23):e}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(e){if(!e){tJ(t9,this,t6).call(this),tq(t2,this,!0),tq(tZ,this,e||void 0);return}e&&e!==tX(tZ,this)&&(tX(tZ,this)&&tJ(t9,this,ir).call(this),tq(tZ,this,e),tq(t2,this,!1),tJ(t9,this,t7).call(this),tJ(t9,this,t6).call(this))}getThemeName(){return tX(tZ,this)}removeClassNames(){(0,r.hasClass)(tX(tQ,this),tX(tZ,this))&&(0,r.removeClass)(tX(tQ,this),tX(tZ,this))}}function t4(){let e=this.getCSSVariableValue("line-height"),t=this.getCSSVariableValue("cell-vertical-padding"),i=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===e||null===t||isNaN(i)?null:e+2*t+i}function t7(){(0,r.removeClass)(tX(tQ,this),/ht-theme-.*/g),(0,r.addClass)(tX(tQ,this),tX(tZ,this))}function t6(){this.isClassicTheme()||tq(t0,this,getComputedStyle(tX(tQ,this)));let e=tJ(t9,this,ie).call(this,["box-sizing","border-bottom-width"]);tX(t5,this).td={...tX(t5,this).td,"box-sizing":e["box-sizing"],"border-bottom-width":e["border-bottom-width"]}}function ie(e){let t=tX(t1,this),i=tX(tQ,this),r=t.createElement("table"),n=t.createElement("tbody"),o=t.createElement("tr"),s=t.createElement("tr"),l=t.createElement("td");s.appendChild(l),n.appendChild(o),n.appendChild(s),r.appendChild(n),i.appendChild(r);let a=getComputedStyle(l),h={};return e.forEach(e=>{h[e]=a.getPropertyValue(e)}),i.removeChild(r),h}function it(e){let t=Math.ceil(parseFloat(tJ(t9,this,ii).call(this,e)));return Number.isNaN(t)?null:t}function ii(e){let t=tX(t0,this).getPropertyValue(e);return""===t?null:t}function ir(){tq(t5,this,{}),tq(t3,this,{}),tq(t2,this,!0)}class io extends eH{constructor(e,t){super(e,new e7(t)),this.stylesHandler=new t8(this.domBindings);let i=this.wtSettings.getSetting("facade",this);this.wtTable=new e6(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new tb(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new t$(this.wtSettings.getSetting("selections")),this.wtEvent=new T(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new e8(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let e=[],t=[];(0,eb.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(i,r)=>{this.wtSettings.getSetting(r).length&&t.push(i),e.push(i)}),(0,r.removeClass)(this.wtTable.wtRootElement.parentNode,e),(0,r.addClass)(this.wtTable.wtRootElement.parentNode,t)}getOverlayByName(e){var t;if(!ep.includes(e))return null;let i=e.replace(/_([a-z])/g,e=>e[1].toUpperCase());return null!==(t=this.wtOverlays[`${i}Overlay`])&&void 0!==t?t:null}getViewportDao(){let e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class is{constructor(e){e instanceof eH?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=e=>{let t=new is(e);return()=>t},this._wot=new io(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(e,t){return this._wot.createCellCoords(e,t)}createCellRange(e,t,i){return this._wot.createCellRange(e,t,i)}draw(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(e),this}getCell(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(e,t)}scrollViewport(e,t,i){return this._wot.scrollViewport(e,t,i)}scrollViewportHorizontally(e,t){return this._wot.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wot.scrollViewportVertically(e,t)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,t){return this._wot.wtSettings.update(e,t),this}getSetting(e,t,i,r,n){return this._wot.wtSettings.getSetting(e,t,i,r,n)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function il(e){let{isShiftKey:t,isLeftClick:i,isRightClick:r,coords:n,selection:o,controller:s,cellCoordsFactory:l}=e,a=o.isSelected()?o.getSelectedRange().current():null,h=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),t&&a)n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(n):(h||u)&&n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(l(n.row,n.col)):h&&n.row<0&&!s.column?o.setRangeEnd(l(a.to.row,n.col)):u&&n.col<0&&!s.row?o.setRangeEnd(l(n.row,a.to.col)):(!h&&!u&&n.col<0||h&&n.col<0)&&!s.row?o.selectRows(Math.max(a.from.row,0),n.row,n.col):(!h&&!u&&n.row<0||u&&n.row<0)&&!s.column&&o.selectColumns(Math.max(a.from.col,0),n.col,n.row);else{let e=!o.inInSelection(n),t=i||r&&e;n.row<0&&n.col>=0&&!s.column?t&&o.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!s.row?t&&o.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!s.cell?t&&o.setRangeStart(n):n.col<0&&n.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}let ia=new Map([["mousedown",il],["mouseover",function(e){let{isLeftClick:t,coords:i,selection:r,controller:n,cellCoordsFactory:o}=e;if(!t)return;let s=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),a=r.tableProps.countCols(),h=r.tableProps.countRows();r.markSource("mouse"),l&&!n.column?r.setRangeEnd(o(h-1,i.col)):s&&!n.row?r.setRangeEnd(o(i.row,a-1)):n.cell||r.setRangeEnd(i),r.markEndSource()}],["touchstart",il]]);function ih(e,t){let{coords:i,selection:r,controller:n,cellCoordsFactory:s}=t;ia.get(e.type)({coords:i,selection:r,controller:n,cellCoordsFactory:s,isShiftKey:e.shiftKey,isLeftClick:(0,o.isLeftClick)(e)||"touchstart"===e.type,isRightClick:(0,o.isRightClick)(e)})}var iu=i(36425);function ic(e,t,i){id(e,t),t.set(e,i)}function id(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function ig(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ip(e,t){return e.get(iw(e,t))}function im(e,t,i){return e.set(iw(e,t),i),i}function iw(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var iy=new WeakMap,iv=new WeakMap,ib=new WeakMap,iC=new WeakMap,iS=new WeakMap,iE=new WeakMap,iR=new WeakMap,iT=new WeakMap,ix=new WeakSet;class iM{constructor(e){!function(e,t){id(e,t),t.add(e)}(this,ix),ig(this,"hot",void 0),ig(this,"eventManager",void 0),ig(this,"settings",void 0),ig(this,"THEAD",void 0),ig(this,"TBODY",void 0),ig(this,"_wt",void 0),ig(this,"activeWt",void 0),ic(this,iy,0),ic(this,iv,0),ig(this,"postponedAdjustElementsSize",!1),ic(this,ib,!1),ic(this,iC,void 0),ic(this,iS,void 0),ic(this,iE,0),ic(this,iR,0),ic(this,iT,null),this.hot=e,this.eventManager=new n.A(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){let e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!e),iw(ix,this,iI).call(this),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(e,t){let i=this._wt.getCell(e,t);return i<0?null:i}scrollViewport(e,t,i){return this._wt.scrollViewport(e,t,i)}scrollViewportHorizontally(e,t){return this._wt.scrollViewportHorizontally(e,t)}scrollViewportVertically(e,t){return this._wt.scrollViewportVertically(e,t)}createElements(){let{rootElement:e,rootDocument:t}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),(0,r.addClass)(e,"handsontable"),im(iS,this,t.createElement("TABLE")),(0,r.addClass)(ip(iS,this),"htCore"),this.hot.getSettings().tableClassName&&(0,r.addClass)(ip(iS,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,r.setAttribute)(ip(iS,this),[(0,G.gg)()]),(0,r.setAttribute)(e,[(0,G.ax)(),(0,G.DZ)(-1),(0,G.Nb)(this.hot.countCols()),(0,G.L4)()])),this.THEAD=t.createElement("THEAD"),ip(iS,this).appendChild(this.THEAD),this.TBODY=t.createElement("TBODY"),ip(iS,this).appendChild(this.TBODY),this.hot.table=ip(iS,this),this.hot.container.insertBefore(ip(iS,this),this.hot.container.firstChild)}registerEvents(){let{rootElement:e,rootDocument:t,selection:i,rootWindow:n}=this.hot,s=t.documentElement;this.eventManager.addEventListener(e,"mousedown",e=>{im(ib,this,!0),this.isTextSelectionAllowed(e.target)||((0,r.clearTextSelection)(n),e.preventDefault(),n.focus())}),this.eventManager.addEventListener(e,"mouseup",()=>{im(ib,this,!1)}),this.eventManager.addEventListener(e,"mousemove",e=>{ip(ib,this)&&!this.isTextSelectionAllowed(e.target)&&(this.settings.fragmentSelection&&(0,r.clearTextSelection)(n),e.preventDefault())}),this.eventManager.addEventListener(s,"keyup",e=>{i.isInProgress()&&!e.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",n=>{i.isInProgress()&&(0,o.isLeftClick)(n)&&i.finish(),im(iC,this,!1);let s=(0,r.isOutsideInput)(t.activeElement);(0,r.isInput)(t.activeElement)&&!s||!s&&(i.isSelected()||i.isSelectedByAnyHeader()||e.contains(n.target)||(0,o.isRightClick)(n))||this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",e=>{i.isInProgress()&&(0,o.isRightClick)(e)&&(i.finish(),im(iC,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),im(iC,this,!1)}),this.eventManager.addEventListener(s,"mousedown",i=>{let n=i.target,o=i.x||i.clientX,l=i.y||i.clientY,a=i.target;if(ip(iC,this)||!e||!this.hot.view)return;let{holder:h}=this._wt.wtTable;if(a===h){let e=(0,r.getScrollbarWidth)(t);if(t.elementFromPoint(o+e,l)!==h||t.elementFromPoint(o,l+e)!==h)return}else for(;a!==s;){if(null===a){if(i.isTargetWebComponent)break;return}if(a===e)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(n):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let l=(0,r.getParentWindow)(n);for(;null!==l;)this.eventManager.addEventListener(l.document.documentElement,"click",()=>{this.hot.unlisten()}),l=(0,r.getParentWindow)(l);this.eventManager.addEventListener(ip(iS,this),"selectstart",e=>{this.settings.fragmentSelection||(0,r.isInput)(e.target)||e.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:t,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(t,i))}translateFromRenderableToVisualIndex(e,t){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;return null===i&&(i=e),null===r&&(r=t),[i,r]}countRenderableIndexes(e,t){let i=Math.min(e.getNotTrimmedIndexesLength(),t),r=e.getNearestNotHiddenIndex(i-1,-1);return null===r?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,t){return this.countNotHiddenIndexes(e,t,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,t,i,r){if(isNaN(e)||e<0)return 0;let n=i.getNearestNotHiddenIndex(e,t),o=i.getRenderableFromVisualIndex(n);if(!Number.isInteger(o))return 0;let s=0;return t<0?s=o+1:t>0&&(s=r-o),s}countNotHiddenFixedColumnsStart(){let e=this.hot.countCols(),t=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(t,-1)}countNotHiddenFixedRowsTop(){let e=this.hot.countRows(),t=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(t,-1)}countNotHiddenFixedRowsBottom(){let e=Math.max(this.hot.countRows()-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(e,1)}countRenderableColumnsInRange(e,t){let i=0;for(let r=e;r<=t;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}countRenderableRowsInRange(e,t){let i=0;for(let r=e;r<=t;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(e){var t;let i=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");i&&(0,r.addClass)(i,e)}removeClassNameFromLicenseElement(e){var t;let i=null===(t=this.hot.rootElement.parentNode)||void 0===t?void 0:t.querySelector(".hot-display-license-info");i&&(0,r.removeClass)(i,e)}isMainTableNotFullyCoveredByOverlays(){let e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),t=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>t}initializeWalkontable(){let e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:ip(iS,this),isDataViewInstance:()=>(0,iu.yn)(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(e,t)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(e,t)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let e=[];return this.hot.hasRowHeaders()&&e.push((e,t)=>{let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e;this.appendRowHeader(i,t)}),this.hot.runHooks("afterGetRowHeaderRenderers",e),im(iv,this,e.length),this.hot.getSettings().ariaTags&&iw(ix,this,iO).call(this)===this.hot.countCols()&&iw(ix,this,ik).call(this,ip(iv,this)),e},columnHeaders:()=>{let e=[];return this.hot.hasColHeaders()&&e.push((e,t)=>{let i=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;this.appendColHeader(i,t)}),this.hot.runHooks("afterGetColumnHeaderRenderers",e),im(iy,this,e.length),e},columnWidth:e=>{let t=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getColWidth(null===t?e:t)},rowHeight:e=>{let t=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e);return this.hot.getRowHeight(null===t?e:t)},rowHeightByOverlayName:(e,t)=>{let i=this.hot.rowIndexMapper.getVisualFromRenderableIndex(e),r=null===i?e:i;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(r),r,t)},cellRenderer:(e,t,i)=>{let[r,n]=this.translateFromRenderableToVisualIndex(e,t),o=this.hot.runHooks("modifyGetCellCoords",r,n,!1,"meta"),s=r,l=n;Array.isArray(o)&&([s,l]=o);let a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l),u=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,a)),this.hot.runHooks("beforeRenderer",i,r,n,h,u,a),this.hot.getCellRenderer(a)(this.hot,i,r,n,h,u,a),this.hot.runHooks("afterRenderer",i,r,n,h,u,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,r.isVisible)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(e,t,i,r)=>{let n=this.translateFromRenderableToVisualCoords(t),s={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,im(iC,this,!0),im(iT,this,{x:e.clientX,y:e.clientY}),this.hot.runHooks("beforeOnCellMouseDown",e,n,i,s),(0,o.isImmediatePropagationStopped)(e)||(ih(e,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseDown",e,n,i),this.activeWt=this._wt)},onCellContextMenu:(e,t,i,r)=>{let n=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,im(iC,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",e,n,i),(0,o.isImmediatePropagationStopped)(e)||(this.hot.runHooks("afterOnCellContextMenu",e,n,i),this.activeWt=this._wt)},onCellMouseOut:(e,t,i,r)=>{let n=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",e,n,i),(0,o.isImmediatePropagationStopped)(e)||(this.hot.runHooks("afterOnCellMouseOut",e,n,i),this.activeWt=this._wt)},onCellMouseOver:(e,t,i,r)=>{let n=this.translateFromRenderableToVisualCoords(t),s={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",e,n,i,s),(0,o.isImmediatePropagationStopped)(e)||(ip(iC,this)&&(!ip(iT,this)||ip(iT,this).x!==e.clientX||ip(iT,this).y!==e.clientY)&&ih(e,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(e,t)=>this.hot._createCellCoords(e,t)}),this.hot.runHooks("afterOnCellMouseOver",e,n,i),this.activeWt=this._wt,im(iT,this,null))},onCellMouseUp:(e,t,i,r)=>{let n=this.translateFromRenderableToVisualCoords(t);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",e,n,i),(0,o.isImmediatePropagationStopped)(e)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",e,n,i),this.activeWt=this._wt)},onCellCornerMouseDown:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",e)},onCellCornerDblClick:e=>{e.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",e)},beforeDraw:(e,t)=>this.beforeRender(e,t),onDraw:e=>this.afterRender(e),onBeforeViewportScrollVertically:(e,t)=>{let i=this.hot.rowIndexMapper,r=e<0,n=e;return r||null!==(n=i.getVisualFromRenderableIndex(e))?(n=this.hot.runHooks("beforeViewportScrollVertically",n,t),this.hot.runHooks("beforeViewportScroll"),r)?n:i.getRenderableFromVisualIndex(n):e},onBeforeViewportScrollHorizontally:(e,t)=>{let i=this.hot.columnIndexMapper,r=e<0,n=e;return r||null!==(n=i.getVisualFromRenderableIndex(e))?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n,t),this.hot.runHooks("beforeViewportScroll"),r)?n:i.getRenderableFromVisualIndex(n):e},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(e,t,i)=>{let r=this.hot.rowIndexMapper,n=e<0,o=e;n||(o=r.getVisualFromRenderableIndex(e));let s=this.hot.runHooks("beforeHighlightingRowHeader",o,t,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(e,t,i)=>{let r=this.hot.columnIndexMapper,n=e<0,o=e;n||(o=r.getVisualFromRenderableIndex(e));let s=this.hot.runHooks("beforeHighlightingColumnHeader",o,t,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(e,t,i)=>{let r,[n,o]=this.translateFromRenderableToVisualIndex(e,t),s=this.hot.selection.getSelectedRange();if(s.size()>0){let e=s.peekByIndex(null!=i?i:0);r=[e.from.row,e.from.col,e.to.row,e.to.col]}return this.hot.runHooks("afterDrawSelection",n,o,r,i)},onBeforeDrawBorders:(e,t)=>{let[i,r,n,o]=e,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,t)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:e=>this.hot.runHooks("modifyRowHeaderWidth",e),onModifyGetCellCoords:(e,t,i,r)=>{let n=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,s=t>=0?o.getVisualFromRenderableIndex(t):t,l=e>=0?n.getVisualFromRenderableIndex(e):e,a=this.hot.runHooks("modifyGetCellCoords",l,s,i,r);if(Array.isArray(a)){let[e,t,i,r]=a;return[e>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(e,1)):e,t>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(t,1)):t,i>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1)):i,r>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r]}},onModifyGetCoordsElement:(e,t)=>{let i=this.hot.rowIndexMapper,r=this.hot.columnIndexMapper,n=t>=0?r.getVisualFromRenderableIndex(t):t,o=e>=0?i.getVisualFromRenderableIndex(e):e,s=this.hot.runHooks("modifyGetCoordsElement",o,n);if(Array.isArray(s)){let[e,t]=s;return[e>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(e,1)):e,t>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(t,1)):t]}},viewportRowCalculatorOverride:e=>{let t=this.settings.viewportRowRenderingOffset;if("auto"===t&&this.settings.fixedRowsTop&&(t=10),t>0||"auto"===t){let i=this.countRenderableRows(),r=e.startRow,n=e.endRow;if("number"==typeof t)e.startRow=Math.max(r-t,0),e.endRow=Math.min(n+t,i-1);else if("auto"===t){let t=Math.max(1,Math.ceil(n/i*12));e.startRow=Math.max(r-t,0),e.endRow=Math.min(n+t,i-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:e=>{let t=this.settings.viewportColumnRenderingOffset;if("auto"===t&&this.settings.fixedColumnsStart&&(t=10),t>0||"auto"===t){let i=this.countRenderableColumns(),r=e.startColumn,n=e.endColumn;if("number"==typeof t&&(e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(n+t,i-1)),"auto"===t){let t=Math.max(1,Math.ceil(n/i*6));e.startColumn=Math.max(r-t,0),e.endColumn=Math.min(n+t,i-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",e)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let e=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||e}};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new is(e),this.activeWt=this._wt;let t=this._wt.wtTable.spreader,{width:i,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,n),this.eventManager.addEventListener(t,"mousedown",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(t,"contextmenu",e=>{e.target===t&&3===e.which&&e.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){if((0,r.isInput)(e))return!0;let t=(0,r.isChildOf)(e,this._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&t||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&t||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return ip(iC,this)}isSelectedOnlyCell(){var e,t;return null!==(e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingleCell())&&void 0!==e&&e}isCellEdited(){let e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,t){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,t)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,t){if(t.firstChild){let i=t.firstChild;if(!(0,r.hasClass)(i,"relative")){(0,r.empty)(t),this.appendRowHeader(e,t);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{let{rootDocument:i,getRowHeader:r}=this.hot,n=i.createElement("div"),o=i.createElement("span");n.className="relative",o.className="rowHeader",this.updateCellHeader(o,e,r),n.appendChild(o),t.appendChild(n)}this.hot.runHooks("afterGetRowHeader",e,t)}appendColHeader(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=()=>{let t=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return t?t.split(" "):[]};if(t.firstChild){let s=t.firstChild;(0,r.hasClass)(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),e,i,n),s.className="",(0,r.addClass)(s,["relative",...o()])):((0,r.empty)(t),this.appendColHeader(e,t,i,n))}else{let{rootDocument:s}=this.hot,l=s.createElement("div"),a=s.createElement("span"),h=o();l.classList.add("relative",...h),a.className="colHeader",this.settings.ariaTags&&((0,r.setAttribute)(l,...(0,G.gg)()),(0,r.setAttribute)(a,...(0,G.gg)())),this.updateCellHeader(a,e,i,n),l.appendChild(a),t.appendChild(l)}this.hot.runHooks("afterGetColHeader",e,t,n)}updateCellHeader(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t,s=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&((0,r.hasClass)(e,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(t):(0,r.hasClass)(e,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(t))),o>-1?(0,r.fastInnerHTML)(e,i(t,n)):((0,r.fastInnerText)(e,String.fromCharCode(160)),(0,r.addClass)(e,"cornerHeader"))}maximumVisibleElementWidth(e){let t=this._wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0}maximumVisibleElementHeight(e){let t=this._wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0}setLastSize(e,t){im(iE,this,e),im(iR,this,t)}getLastSize(){return{width:ip(iE,this),height:ip(iR,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;let e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;let e=this.hot.rowIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;let e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;let e=this.hot.columnIndexMapper,t=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(null!=t?t:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return ip(iy,this)}getRowHeadersCount(){return ip(iv,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var t;return(null!==(t=this._wt.wtOverlays.getParentOverlay(e))&&void 0!==t?t:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function iO(){return parseInt(this.hot.rootElement.getAttribute((0,G.Nb)()[0]),10)}function ik(e){let t=iw(ix,this,iO).call(this)+e;(0,r.setAttribute)(this.hot.rootElement,...(0,G.Nb)(t))}function iI(){let e=this.hot.rootElement;this.hasVerticalScroll()?(0,r.addClass)(e,"htHasScrollY"):(0,r.removeClass)(e,"htHasScrollY"),this.hasHorizontalScroll()?(0,r.addClass)(e,"htHasScrollX"):(0,r.removeClass)(e,"htHasScrollX")}let iA=iM},4083:(e,t,i)=>{"use strict";var r=i(42620),n=i(56963),o=r.RegExp;e.exports={correct:!n(function(){var e=!0;try{o(".","d")}catch(t){e=!1}var t={},i="",r=e?"dgimsy":"gimsy",n=function(e,r){Object.defineProperty(t,e,{get:function(){return i+=r,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var l in e&&(s.hasIndices="d"),s)n(l,s[l]);return Object.getOwnPropertyDescriptor(o.prototype,"flags").get.call(t)!==r||i!==r})}},4230:(e,t,i)=>{"use strict";var r=i(67297),n=i(99365),o=i(76494),s=TypeError;e.exports=function(e,t){var i,l;if("string"===t&&n(i=e.toString)&&!o(l=r(i,e))||n(i=e.valueOf)&&!o(l=r(i,e))||"string"!==t&&n(i=e.toString)&&!o(l=r(i,e)))return l;throw new s("Can't convert object to primitive value")}},4389:e=>{"use strict";e.exports={}},5383:e=>{"use strict";var t=Math.ceil,i=Math.floor;e.exports=Math.trunc||function(e){var r=+e;return(r>0?i:t)(r)}},6213:(e,t,i)=>{"use strict";var r=i(8883);e.exports=function(){var e=r(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t}},6497:(e,t,i)=>{"use strict";var r=i(67297);e.exports=function(e,t,i){for(var n,o,s=i?e:e.iterator,l=e.next;!(n=r(l,s)).done;)if(void 0!==(o=t(n.value)))return o}},7107:(e,t,i)=>{"use strict";var r=i(42620),n=i(87699),o=i(95467),s=i(39584),l=i(11609),a=i(2048),h=r.Symbol,u=n("wks"),c=a?h.for||h:h&&h.withoutSetter||s;e.exports=function(e){return o(u,e)||(u[e]=l&&o(h,e)?h[e]:c("Symbol."+e)),u[e]}},7346:(e,t,i)=>{"use strict";i.d(t,{B:()=>r,b:()=>n});let r="gridDefault",n="editorManager.handlingEditor"},7411:(e,t,i)=>{"use strict";e.exports=i(93840)({}.isPrototypeOf)},7475:e=>{"use strict";e.exports=function(e){return{iterator:e,next:e.next,done:!1}}},7537:(e,t)=>{"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor;t.f=r&&!i.call({1:2},1)?function(e){var t=r(this,e);return!!t&&t.enumerable}:i},7687:(e,t,i)=>{"use strict";var r=i(42620),n=Object.defineProperty;e.exports=function(e,t){try{n(r,e,{value:t,configurable:!0,writable:!0})}catch(i){r[e]=t}return t}},7729:(e,t,i)=>{"use strict";i.d(t,{b6:()=>b,ZS:()=>E,tN:()=>S,mk:()=>R});var r=function(){};r.prototype.append=function(e){return e.length?(e=r.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},r.prototype.prepend=function(e){return e.length?r.from(e).append(this):this},r.prototype.appendInner=function(e){return new o(this,e)},r.prototype.slice=function(e,t){return(void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t)?r.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},r.prototype.get=function(e){if(!(e<0)&&!(e>=this.length))return this.getInner(e)},r.prototype.forEach=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=this.length),t<=i?this.forEachInner(e,t,i,0):this.forEachInvertedInner(e,t,i,0)},r.prototype.map=function(e,t,i){void 0===t&&(t=0),void 0===i&&(i=this.length);var r=[];return this.forEach(function(t,i){return r.push(e(t,i))},t,i),r},r.from=function(e){return e instanceof r?e:e&&e.length?new n(e):r.empty};var n=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var i={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,i){return 0==e&&i==this.length?this:new t(this.values.slice(e,i))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,i,r){for(var n=t;n<i;n++)if(!1===e(this.values[n],r+n))return!1},t.prototype.forEachInvertedInner=function(e,t,i,r){for(var n=t-1;n>=i;n--)if(!1===e(this.values[n],r+n))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},i.length.get=function(){return this.values.length},i.depth.get=function(){return 0},Object.defineProperties(t.prototype,i),t}(r);r.empty=new n([]);var o=function(e){function t(t,i){e.call(this),this.left=t,this.right=i,this.length=t.length+i.length,this.depth=Math.max(t.depth,i.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,i,r){var n=this.left.length;if(t<n&&!1===this.left.forEachInner(e,t,Math.min(i,n),r)||i>n&&!1===this.right.forEachInner(e,Math.max(t-n,0),Math.min(this.length,i)-n,r+n))return!1},t.prototype.forEachInvertedInner=function(e,t,i,r){var n=this.left.length;if(t>n&&!1===this.right.forEachInvertedInner(e,t-n,Math.max(i,n)-n,r+n)||i<n&&!1===this.left.forEachInvertedInner(e,Math.min(t,n),i,r))return!1},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var i=this.left.length;return t<=i?this.left.slice(e,t):e>=i?this.right.slice(e-i,t-i):this.left.slice(e,i).append(this.right.slice(0,t-i))},t.prototype.leafAppend=function(e){var i=this.right.leafAppend(e);if(i)return new t(this.left,i)},t.prototype.leafPrepend=function(e){var i=this.left.leafPrepend(e);if(i)return new t(i,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(r),s=i(808),l=i(52571);class a{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){let i,r,n,o;if(0==this.eventCount)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}t&&(r=(i=this.remapping(s,this.items.length)).maps.length);let l=e.tr,u=[],c=[];return this.items.forEach((e,t)=>{if(!e.step){i||(r=(i=this.remapping(s,t+1)).maps.length),r--,c.push(e);return}if(i){c.push(new h(e.map));let t=e.step.map(i.slice(r)),n;t&&l.maybeStep(t).doc&&(n=l.mapping.maps[l.mapping.maps.length-1],u.push(new h(n,void 0,void 0,u.length+c.length))),r--,n&&i.appendMap(n,r)}else l.maybeStep(e.step);if(e.selection)return n=i?e.selection.map(i.slice(r)):e.selection,o=new a(this.items.slice(0,s).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:o,transform:l,selection:n}}addTransform(e,t,i,r){var n,o;let s,l=[],u=this.eventCount,d=this.items,g=!r&&d.length?d.get(d.length-1):null;for(let i=0;i<e.steps.length;i++){let n=e.steps[i].invert(e.docs[i]),o=new h(e.mapping.maps[i],n,t),s;(s=g&&g.merge(o))&&(o=s,i?l.pop():d=d.slice(0,d.length-1)),l.push(o),t&&(u++,t=void 0),r||(g=o)}let f=u-i.depth;return f>c&&(n=d,o=f,n.forEach((e,t)=>{if(e.selection&&0==o--)return s=t,!1}),d=n.slice(s),u-=f),new a(d.append(l),u)}remapping(e,t){let i=new s.X9;return this.items.forEach((t,r)=>{let n=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?i.maps.length-t.mirrorOffset:void 0;i.appendMap(t.map,n)},e,t),i}addMaps(e){return 0==this.eventCount?this:new a(this.items.append(e.map(e=>new h(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let i=[],r=Math.max(0,this.items.length-t),n=e.mapping,o=e.steps.length,s=this.eventCount;this.items.forEach(e=>{e.selection&&s--},r);let l=t;this.items.forEach(t=>{let r=n.getMirror(--l);if(null==r)return;o=Math.min(o,r);let a=n.maps[r];if(t.step){let o=e.steps[r].invert(e.docs[r]),u=t.selection&&t.selection.map(n.slice(l+1,r));u&&s++,i.push(new h(a,o,u))}else i.push(new h(a))},r);let u=[];for(let e=t;e<o;e++)u.push(new h(n.maps[e]));let c=new a(this.items.slice(0,r).append(u).append(i),s);return c.emptyItemCount()>500&&(c=c.compress(this.items.length-i.length)),c}emptyItemCount(){let e=0;return this.items.forEach(t=>{!t.step&&e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),i=t.maps.length,n=[],o=0;return this.items.forEach((r,s)=>{if(s>=e)n.push(r),r.selection&&o++;else if(r.step){let e=r.step.map(t.slice(i)),s=e&&e.getMap();if(i--,s&&t.appendMap(s,i),e){let l=r.selection&&r.selection.map(t.slice(i));l&&o++;let a=new h(s.invert(),e,l),u,c=n.length-1;(u=n.length&&n[c].merge(a))?n[c]=u:n.push(a)}}else r.map&&i--},this.items.length,0),new a(r.from(n.reverse()),o)}}a.empty=new a(r.empty,0);class h{constructor(e,t,i,r){this.map=e,this.step=t,this.selection=i,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new h(t.getMap().invert(),t,this.selection)}}}class u{constructor(e,t,i,r,n){this.done=e,this.undone=t,this.prevRanges=i,this.prevTime=r,this.prevComposition=n}}let c=20;function d(e){let t=[];for(let i=e.length-1;i>=0&&0==t.length;i--)e[i].forEach((e,i,r,n)=>t.push(r,n));return t}function g(e,t){if(!e)return null;let i=[];for(let r=0;r<e.length;r+=2){let n=t.map(e[r],1),o=t.map(e[r+1],-1);n<=o&&i.push(n,o)}return i}let f=!1,p=null;function m(e){let t=e.plugins;if(p!=t){f=!1,p=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){f=!0;break}}return f}let w=new l.hs("history"),y=new l.hs("closeHistory");function b(e={}){return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new l.k_({key:w,state:{init:()=>new u(a.empty,a.empty,null,0,-1),apply:(t,i,r)=>(function(e,t,i,r){let n=i.getMeta(w),o;if(n)return n.historyState;i.getMeta(y)&&(e=new u(e.done,e.undone,null,0,-1));let s=i.getMeta("appendedTransaction");if(0==i.steps.length)return e;if(s&&s.getMeta(w))if(s.getMeta(w).redo)return new u(e.done.addTransform(i,void 0,r,m(t)),e.undone,d(i.mapping.maps),e.prevTime,e.prevComposition);else return new u(e.done,e.undone.addTransform(i,void 0,r,m(t)),null,e.prevTime,e.prevComposition);if(!1===i.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))if(o=i.getMeta("rebased"))return new u(e.done.rebased(i,o),e.undone.rebased(i,o),g(e.prevRanges,i.mapping),e.prevTime,e.prevComposition);else return new u(e.done.addMaps(i.mapping.maps),e.undone.addMaps(i.mapping.maps),g(e.prevRanges,i.mapping),e.prevTime,e.prevComposition);{let n=i.getMeta("composition"),o=0==e.prevTime||!s&&e.prevComposition!=n&&(e.prevTime<(i.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let i=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let n=0;n<t.length;n+=2)e<=t[n+1]&&r>=t[n]&&(i=!0)}),i}(i,e.prevRanges)),l=s?g(e.prevRanges,i.mapping):d(i.mapping.maps);return new u(e.done.addTransform(i,o?t.selection.getBookmark():void 0,r,m(t)),a.empty,l,i.time,null==n?e.prevComposition:n)}})(i,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let i=t.inputType,r="historyUndo"==i?S:"historyRedo"==i?E:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function C(e,t){return(i,r)=>{let n=w.getState(i);if(!n||0==(e?n.undone:n.done).eventCount)return!1;if(r){let o=function(e,t,i){let r=m(t),n=w.get(t).spec.config,o=(i?e.undone:e.done).popEvent(t,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),l=(i?e.done:e.undone).addTransform(o.transform,t.selection.getBookmark(),n,r),a=new u(i?l:o.remaining,i?o.remaining:l,null,0,-1);return o.transform.setSelection(s).setMeta(w,{redo:i,historyState:a})}(n,i,e);o&&r(t?o.scrollIntoView():o)}return!0}}let S=C(!1,!0),E=C(!0,!0);function R(e){let t=w.getState(e);return t?t.done.eventCount:0}C(!1,!1),C(!0,!1)},8496:(e,t,i)=>{"use strict";var r=i(93840),n=i(50320);e.exports=function(e,t,i){try{return r(n(Object.getOwnPropertyDescriptor(e,t)[i]))}catch(e){}}},8883:(e,t,i)=>{"use strict";var r=i(76494),n=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(n(e)+" is not an object")}},9234:(e,t,i)=>{"use strict";var r=i(14412),n=i(56963);e.exports=r&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},9329:(e,t,i)=>{"use strict";var r=i(82309),n=i(93840),o=i(97156),s=i(22229),l=i(8883),a=n([].concat);e.exports=r("Reflect","ownKeys")||function(e){var t=o.f(l(e)),i=s.f;return i?a(t,i(e)):t}},10027:(e,t,i)=>{"use strict";var r=i(7107),n=i(54733),o=r("iterator"),s=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||s[o]===e)}},10156:(e,t,i)=>{"use strict";function r(e){this.content=e}i.d(t,{S4:()=>B,ZF:()=>q,FK:()=>n,CU:()=>a,sX:()=>F,bP:()=>R,u$:()=>S,vI:()=>h,Sj:()=>V,Ji:()=>u}),r.prototype={constructor:r,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return -1},get:function(e){var t=this.find(e);return -1==t?void 0:this.content[t+1]},update:function(e,t,i){var n=i&&i!=e?this.remove(i):this,o=n.find(e),s=n.content.slice();return -1==o?s.push(i||e,t):(s[o+1]=t,i&&(s[o]=i)),new r(s)},remove:function(e){var t=this.find(e);if(-1==t)return this;var i=this.content.slice();return i.splice(t,2),new r(i)},addToStart:function(e,t){return new r([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var i=this.remove(e).content.slice();return i.push(e,t),new r(i)},addBefore:function(e,t,i){var n=this.remove(t),o=n.content.slice(),s=n.find(e);return o.splice(-1==s?o.length:s,0,t,i),new r(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=r.from(e)).size?new r(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=r.from(e)).size?new r(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=r.from(e);for(var i=0;i<e.content.length;i+=2)t=t.remove(e.content[i]);return t},toObject:function(){var e={};return this.forEach(function(t,i){e[t]=i}),e},get size(){return this.content.length>>1}},r.from=function(e){if(e instanceof r)return e;var t=[];if(e)for(var i in e)t.push(i,e[i]);return new r(t)};class n{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let t=0;t<e.length;t++)this.size+=e[t].nodeSize}nodesBetween(e,t,i,r=0,n){for(let o=0,s=0;s<t;o++){let l=this.content[o],a=s+l.nodeSize;if(a>e&&!1!==i(l,r+s,n||null,o)&&l.content.size){let n=s+1;l.nodesBetween(Math.max(0,e-n),Math.min(l.content.size,t-n),i,r+n)}s=a}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,i,r){let n="",o=!0;return this.nodesBetween(e,t,(s,l)=>{let a=s.isText?s.text.slice(Math.max(e,l)-l,t-l):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&a||s.isTextblock)&&i&&(o?o=!1:n+=i),n+=a},0),n}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,i=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(i)&&(r[r.length-1]=t.withText(t.text+i.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new n(r,this.size+e.size)}cut(e,t=this.size){if(0==e&&t==this.size)return this;let i=[],r=0;if(t>e)for(let n=0,o=0;o<t;n++){let s=this.content[n],l=o+s.nodeSize;l>e&&((o<e||l>t)&&(s=s.isText?s.cut(Math.max(0,e-o),Math.min(s.text.length,t-o)):s.cut(Math.max(0,e-o-1),Math.min(s.content.size,t-o-1))),i.push(s),r+=s.nodeSize),o=l}return new n(i,r)}cutByIndex(e,t){return e==t?n.empty:0==e&&t==this.content.length?this:new n(this.content.slice(e,t))}replaceChild(e,t){let i=this.content[e];if(i==t)return this;let r=this.content.slice(),o=this.size+t.nodeSize-i.nodeSize;return r[e]=t,new n(r,o)}addToStart(e){return new n([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new n(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,i=0;t<this.content.length;t++){let r=this.content[t];e(r,i,t),i+=r.nodeSize}}findDiffStart(e,t=0){return function e(t,i,r){for(let n=0;;n++){if(n==t.childCount||n==i.childCount)return t.childCount==i.childCount?null:r;let o=t.child(n),s=i.child(n);if(o==s){r+=o.nodeSize;continue}if(!o.sameMarkup(s))return r;if(o.isText&&o.text!=s.text){for(let e=0;o.text[e]==s.text[e];e++)r++;return r}if(o.content.size||s.content.size){let t=e(o.content,s.content,r+1);if(null!=t)return t}r+=o.nodeSize}}(this,e,t)}findDiffEnd(e,t=this.size,i=e.size){return function e(t,i,r,n){for(let o=t.childCount,s=i.childCount;;){if(0==o||0==s)return o==s?null:{a:r,b:n};let l=t.child(--o),a=i.child(--s),h=l.nodeSize;if(l==a){r-=h,n-=h;continue}if(!l.sameMarkup(a))return{a:r,b:n};if(l.isText&&l.text!=a.text){let e=0,t=Math.min(l.text.length,a.text.length);for(;e<t&&l.text[l.text.length-e-1]==a.text[a.text.length-e-1];)e++,r--,n--;return{a:r,b:n}}if(l.content.size||a.content.size){let t=e(l.content,a.content,r-1,n-1);if(t)return t}r-=h,n-=h}}(this,e,t,i)}findIndex(e,t=-1){if(0==e)return s(0,e);if(e==this.size)return s(this.content.length,e);if(e>this.size||e<0)throw RangeError(`Position ${e} outside of fragment (${this})`);for(let i=0,r=0;;i++){let n=r+this.child(i).nodeSize;if(n>=e){if(n==e||t>0)return s(i+1,n);return s(i,r)}r=n}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return n.empty;if(!Array.isArray(t))throw RangeError("Invalid input for Fragment.fromJSON");return new n(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return n.empty;let t,i=0;for(let r=0;r<e.length;r++){let n=e[r];i+=n.nodeSize,r&&n.isText&&e[r-1].sameMarkup(n)?(t||(t=e.slice(0,r)),t[t.length-1]=n.withText(t[t.length-1].text+n.text)):t&&t.push(n)}return new n(t||e,i)}static from(e){if(!e)return n.empty;if(e instanceof n)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new n([e],e.nodeSize);throw RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}n.empty=new n([],0);let o={index:0,offset:0};function s(e,t){return o.index=e,o.offset=t,o}function l(e,t){if(e===t)return!0;if(!(e&&"object"==typeof e)||!(t&&"object"==typeof t))return!1;let i=Array.isArray(e);if(Array.isArray(t)!=i)return!1;if(i){if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!l(e[i],t[i]))return!1}else{for(let i in e)if(!(i in t)||!l(e[i],t[i]))return!1;for(let i in t)if(!(i in e))return!1}return!0}class a{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,i=!1;for(let r=0;r<e.length;r++){let n=e[r];if(this.eq(n))return e;if(this.type.excludes(n.type))t||(t=e.slice(0,r));else{if(n.type.excludes(this.type))return e;!i&&n.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),i=!0),t&&t.push(n)}}return t||(t=e.slice()),i||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&l(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw RangeError("Invalid input for Mark.fromJSON");let i=e.marks[t.type];if(!i)throw RangeError(`There is no mark type ${t.type} in this schema`);let r=i.create(t.attrs);return i.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let i=0;i<e.length;i++)if(!e[i].eq(t[i]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return a.none;if(e instanceof a)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}a.none=[];class h extends Error{}class u{constructor(e,t,i){this.content=e,this.openStart=t,this.openEnd=i}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let i=function e(t,i,r,n){let{index:o,offset:s}=t.findIndex(i),l=t.maybeChild(o);if(s==i||l.isText)return n&&!n.canReplace(o,o,r)?null:t.cut(0,i).append(r).append(t.cut(i));let a=e(l.content,i-s-1,r);return a&&t.replaceChild(o,l.copy(a))}(this.content,e+this.openStart,t);return i&&new u(i,this.openStart,this.openEnd)}removeBetween(e,t){return new u(function e(t,i,r){let{index:n,offset:o}=t.findIndex(i),s=t.maybeChild(n),{index:l,offset:a}=t.findIndex(r);if(o==i||s.isText){if(a!=r&&!t.child(l).isText)throw RangeError("Removing non-flat range");return t.cut(0,i).append(t.cut(r))}if(n!=l)throw RangeError("Removing non-flat range");return t.replaceChild(n,s.copy(e(s.content,i-o-1,r-o-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return u.empty;let i=t.openStart||0,r=t.openEnd||0;if("number"!=typeof i||"number"!=typeof r)throw RangeError("Invalid input for Slice.fromJSON");return new u(n.fromJSON(e,t.content),i,r)}static maxOpen(e,t=!0){let i=0,r=0;for(let r=e.firstChild;r&&!r.isLeaf&&(t||!r.type.spec.isolating);r=r.firstChild)i++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new u(e,i,r)}}function c(e,t){if(!t.type.compatibleContent(e.type))throw new h("Cannot join "+t.type.name+" onto "+e.type.name)}function d(e,t,i){let r=e.node(i);return c(r,t.node(i)),r}function g(e,t){let i=t.length-1;i>=0&&e.isText&&e.sameMarkup(t[i])?t[i]=e.withText(t[i].text+e.text):t.push(e)}function f(e,t,i,r){let n=(t||e).node(i),o=0,s=t?t.index(i):n.childCount;e&&(o=e.index(i),e.depth>i?o++:e.textOffset&&(g(e.nodeAfter,r),o++));for(let e=o;e<s;e++)g(n.child(e),r);t&&t.depth==i&&t.textOffset&&g(t.nodeBefore,r)}function p(e,t){return e.type.checkContent(t),e.copy(t)}function m(e,t,i){let r=[];return f(null,e,i,r),e.depth>i&&g(p(d(e,t,i+1),m(e,t,i+1)),r),f(t,null,i,r),new n(r)}u.empty=new u(n.empty,0,0);class w{constructor(e,t,i){this.pos=e,this.path=t,this.parentOffset=i,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let i=this.pos-this.path[this.path.length-1],r=e.child(t);return i?e.child(t).cut(i):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let i=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let t=0;t<e;t++)r+=i.child(t).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return a.none;if(this.textOffset)return e.child(t).marks;let i=e.maybeChild(t-1),r=e.maybeChild(t);if(!i){let e=i;i=r,r=e}let n=i.marks;for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let i=t.marks,r=e.parent.maybeChild(e.index());for(var n=0;n<i.length;n++)!1!==i[n].type.spec.inclusive||r&&i[n].isInSet(r.marks)||(i=i[n--].removeFromSet(i));return i}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let i=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);i>=0;i--)if(e.pos<=this.end(i)&&(!t||t(this.node(i))))return new S(this,e,i);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw RangeError("Position "+t+" out of range");let i=[],r=0,n=t;for(let t=e;;){let{index:e,offset:o}=t.content.findIndex(n),s=n-o;if(i.push(t,e,r+o),!s||(t=t.child(e)).isText)break;n=s-1,r+=o+1}return new w(t,i,n)}static resolveCached(e,t){let i=C.get(e);if(i)for(let e=0;e<i.elts.length;e++){let r=i.elts[e];if(r.pos==t)return r}else C.set(e,i=new y);let r=i.elts[i.i]=w.resolve(e,t);return i.i=(i.i+1)%b,r}}class y{constructor(){this.elts=[],this.i=0}}let b=12,C=new WeakMap;class S{constructor(e,t,i){this.$from=e,this.$to=t,this.depth=i}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let E=Object.create(null);class R{constructor(e,t,i,r=a.none){this.type=e,this.attrs=t,this.marks=r,this.content=i||n.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,i,r=0){this.content.nodesBetween(e,t,i,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,i,r){return this.content.textBetween(e,t,i,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,i){return this.type==e&&l(this.attrs,t||e.defaultAttrs||E)&&a.sameSet(this.marks,i||a.none)}copy(e=null){return e==this.content?this:new R(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new R(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,i=!1){if(e==t)return u.empty;let r=this.resolve(e),n=this.resolve(t),o=i?0:r.sharedDepth(t),s=r.start(o);return new u(r.node(o).content.cut(r.pos-s,n.pos-s),r.depth-o,n.depth-o)}replace(e,t,i){var r=this.resolve(e),o=this.resolve(t);if(i.openStart>r.depth)throw new h("Inserted content deeper than insertion position");if(r.depth-i.openStart!=o.depth-i.openEnd)throw new h("Inconsistent open depths");return function e(t,i,r,o){let s=t.index(o),l=t.node(o);if(s==i.index(o)&&o<t.depth-r.openStart){let n=e(t,i,r,o+1);return l.copy(l.content.replaceChild(s,n))}if(!r.content.size)return p(l,m(t,i,o));if(r.openStart||r.openEnd||t.depth!=o||i.depth!=o){let{start:e,end:s}=function(e,t){let i=t.depth-e.openStart,r=t.node(i).copy(e.content);for(let e=i-1;e>=0;e--)r=t.node(e).copy(n.from(r));return{start:r.resolveNoCache(e.openStart+i),end:r.resolveNoCache(r.content.size-e.openEnd-i)}}(r,t);return p(l,function e(t,i,r,o,s){let l=t.depth>s&&d(t,i,s+1),a=o.depth>s&&d(r,o,s+1),h=[];return f(null,t,s,h),l&&a&&i.index(s)==r.index(s)?(c(l,a),g(p(l,e(t,i,r,o,s+1)),h)):(l&&g(p(l,m(t,i,s+1)),h),f(i,r,s,h),a&&g(p(a,m(r,o,s+1)),h)),f(o,null,s,h),new n(h)}(t,e,s,i,o))}{let e=t.parent,n=e.content;return p(e,n.cut(0,t.parentOffset).append(r.content).append(n.cut(i.parentOffset)))}}(r,o,i,0)}nodeAt(e){for(let t=this;;){let{index:i,offset:r}=t.content.findIndex(e);if(!(t=t.maybeChild(i)))return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:i}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:i}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:i}=this.content.findIndex(e);if(i<e)return{node:this.content.child(t),index:t,offset:i};let r=this.content.child(t-1);return{node:r,index:t-1,offset:i-r.nodeSize}}resolve(e){return w.resolveCached(this,e)}resolveNoCache(e){return w.resolve(this,e)}rangeHasMark(e,t,i){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(i.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),x(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,i=n.empty,r=0,o=i.childCount){let s=this.contentMatchAt(e).matchFragment(i,r,o),l=s&&s.matchFragment(this.content,t);if(!l||!l.validEnd)return!1;for(let e=r;e<o;e++)if(!this.type.allowsMarks(i.child(e).marks))return!1;return!0}canReplaceWith(e,t,i,r){if(r&&!this.type.allowsMarks(r))return!1;let n=this.contentMatchAt(e).matchType(i),o=n&&n.matchFragment(this.content,t);return!!o&&o.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=a.none;for(let t=0;t<this.marks.length;t++){let i=this.marks[t];i.type.checkAttrs(i.attrs),e=i.addToSet(e)}if(!a.sameSet(e,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){let i;if(!t)throw RangeError("Invalid input for Node.fromJSON");if(t.marks){if(!Array.isArray(t.marks))throw RangeError("Invalid mark data for Node.fromJSON");i=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw RangeError("Invalid text node in JSON");return e.text(t.text,i)}let r=n.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,r,i);return o.type.checkAttrs(o.attrs),o}}R.prototype.text=void 0;class T extends R{constructor(e,t,i,r){if(super(e,t,null,r),!i)throw RangeError("Empty text nodes are not allowed");this.text=i}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):x(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new T(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new T(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function x(e,t){for(let i=e.length-1;i>=0;i--)t=e[i].type.name+"("+t+")";return t}class M{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){var i;let r,n=new O(e,t);if(null==n.next)return M.empty;let o=function e(t){let i=[];do i.push(function(t){let i=[];do i.push(function(t){let i=function(t){if(t.eat("(")){let i=e(t);return t.eat(")")||t.err("Missing closing paren"),i}if(/\W/.test(t.next))t.err("Unexpected token '"+t.next+"'");else{let e=(function(e,t){let i=e.nodeTypes,r=i[t];if(r)return[r];let n=[];for(let e in i){let r=i[e];r.isInGroup(t)&&n.push(r)}return 0==n.length&&e.err("No node type or group '"+t+"' found"),n})(t,t.next).map(e=>(null==t.inline?t.inline=e.isInline:t.inline!=e.isInline&&t.err("Mixing inline and block content"),{type:"name",value:e}));return t.pos++,1==e.length?e[0]:{type:"choice",exprs:e}}}(t);for(;;)if(t.eat("+"))i={type:"plus",expr:i};else if(t.eat("*"))i={type:"star",expr:i};else if(t.eat("?"))i={type:"opt",expr:i};else if(t.eat("{"))i=function(e,t){let i=k(e),r=i;return e.eat(",")&&(r="}"!=e.next?k(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:i,max:r,expr:t}}(t,i);else break;return i}(t));while(t.next&&")"!=t.next&&"|"!=t.next);return 1==i.length?i[0]:{type:"seq",exprs:i}}(t));while(t.eat("|"));return 1==i.length?i[0]:{type:"choice",exprs:i}}(n);n.next&&n.err("Unexpected trailing text");let s=(i=function(e){let t=[[]];return n(function e(t,o){if("choice"==t.type)return t.exprs.reduce((t,i)=>t.concat(e(i,o)),[]);if("seq"==t.type)for(let r=0;;r++){let s=e(t.exprs[r],o);if(r==t.exprs.length-1)return s;n(s,o=i())}else if("star"==t.type){let s=i();return r(o,s),n(e(t.expr,s),s),[r(s)]}else if("plus"==t.type){let s=i();return n(e(t.expr,o),s),n(e(t.expr,s),s),[r(s)]}else if("opt"==t.type)return[r(o)].concat(e(t.expr,o));else if("range"==t.type){let s=o;for(let r=0;r<t.min;r++){let r=i();n(e(t.expr,s),r),s=r}if(-1==t.max)n(e(t.expr,s),s);else for(let o=t.min;o<t.max;o++){let o=i();r(s,o),n(e(t.expr,s),o),s=o}return[r(s)]}else if("name"==t.type)return[r(o,void 0,t.value)];else throw Error("Unknown expr type")}(e,0),i()),t;function i(){return t.push([])-1}function r(e,i,r){let n={term:r,to:i};return t[e].push(n),n}function n(e,t){e.forEach(e=>e.to=t)}}(o),r=Object.create(null),function e(t){let n=[];t.forEach(e=>{i[e].forEach(({term:e,to:t})=>{let r;if(e){for(let t=0;t<n.length;t++)n[t][0]==e&&(r=n[t][1]);A(i,t).forEach(t=>{r||n.push([e,r=[]]),-1==r.indexOf(t)&&r.push(t)})}})});let o=r[t.join(",")]=new M(t.indexOf(i.length-1)>-1);for(let t=0;t<n.length;t++){let i=n[t][1].sort(I);o.next.push({type:n[t][0],next:r[i.join(",")]||e(i)})}return o}(A(i,0)));return function(e,t){for(let i=0,r=[e];i<r.length;i++){let e=r[i],n=!e.validEnd,o=[];for(let t=0;t<e.next.length;t++){let{type:i,next:s}=e.next[t];o.push(i.name),n&&!(i.isText||i.hasRequiredAttrs())&&(n=!1),-1==r.indexOf(s)&&r.push(s)}n&&t.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,n),s}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,i=e.childCount){let r=this;for(let n=t;r&&n<i;n++)r=r.matchType(e.child(n).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let i=0;i<e.next.length;i++)if(this.next[t].type==e.next[i].type)return!0;return!1}fillBefore(e,t=!1,i=0){let r=[this];return function o(s,l){let a=s.matchFragment(e,i);if(a&&(!t||a.validEnd))return n.from(l.map(e=>e.createAndFill()));for(let e=0;e<s.next.length;e++){let{type:t,next:i}=s.next[e];if(!(t.isText||t.hasRequiredAttrs())&&-1==r.indexOf(i)){r.push(i);let e=o(i,l.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),i=[{match:this,type:null,via:null}];for(;i.length;){let r=i.shift(),n=r.match;if(n.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<n.next.length;e++){let{type:o,next:s}=n.next[e];o.isLeaf||o.hasRequiredAttrs()||o.name in t||r.type&&!s.validEnd||(i.push({match:o.contentMatch,type:o,via:r}),t[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return!function t(i){e.push(i);for(let r=0;r<i.next.length;r++)-1==e.indexOf(i.next[r].next)&&t(i.next[r].next)}(this),e.map((t,i)=>{let r=i+(t.validEnd?"*":" ")+" ";for(let i=0;i<t.next.length;i++)r+=(i?", ":"")+t.next[i].type.name+"->"+e.indexOf(t.next[i].next);return r}).join("\n")}}M.empty=new M(!0);class O{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw SyntaxError(e+" (in content expression '"+this.string+"')")}}function k(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function I(e,t){return t-e}function A(e,t){let i=[];return function t(r){let n=e[r];if(1==n.length&&!n[0].term)return t(n[0].to);i.push(r);for(let e=0;e<n.length;e++){let{term:r,to:o}=n[e];r||-1!=i.indexOf(o)||t(o)}}(t),i.sort(I)}function N(e){let t=Object.create(null);for(let i in e){let r=e[i];if(!r.hasDefault)return null;t[i]=r.default}return t}function H(e,t){let i=Object.create(null);for(let r in e){let n=t&&t[r];if(void 0===n){let t=e[r];if(t.hasDefault)n=t.default;else throw RangeError("No value supplied for attribute "+r)}i[r]=n}return i}function P(e,t,i,r){for(let r in t)if(!(r in e))throw RangeError(`Unsupported attribute ${r} for ${i} of type ${r}`);for(let i in e){let r=e[i];r.validate&&r.validate(t[i])}}function _(e,t){let i=Object.create(null);if(t)for(let r in t)i[r]=new D(e,r,t[r]);return i}class L{constructor(e,t,i){this.name=e,this.schema=t,this.spec=i,this.markSet=null,this.groups=i.group?i.group.split(" "):[],this.attrs=_(e,i.attrs),this.defaultAttrs=N(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(i.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==M.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:H(this.attrs,e)}create(e=null,t,i){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new R(this,this.computeAttrs(e),n.from(t),a.setFrom(i))}createChecked(e=null,t,i){return t=n.from(t),this.checkContent(t),new R(this,this.computeAttrs(e),t,a.setFrom(i))}createAndFill(e=null,t,i){if(e=this.computeAttrs(e),(t=n.from(t)).size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),o=r&&r.fillBefore(n.empty,!0);return o?new R(this,e,t.append(o),a.setFrom(i)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let t=0;t<e.childCount;t++)if(!this.allowsMarks(e.child(t).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){P(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){let t;if(null==this.markSet)return e;for(let i=0;i<e.length;i++)this.allowsMarkType(e[i].type)?t&&t.push(e[i]):t||(t=e.slice(0,i));return t?t.length?t:a.none:e}static compile(e,t){let i=Object.create(null);e.forEach((e,r)=>i[e]=new L(e,t,r));let r=t.spec.topNode||"doc";if(!i[r])throw RangeError("Schema is missing its top node type ('"+r+"')");if(!i.text)throw RangeError("Every schema needs a 'text' type");for(let e in i.text.attrs)throw RangeError("The text node type should not have attributes");return i}}class D{constructor(e,t,i){this.hasDefault=Object.prototype.hasOwnProperty.call(i,"default"),this.default=i.default,this.validate="string"==typeof i.validate?function(e,t,i){let r=i.split("|");return i=>{let n=null===i?"null":typeof i;if(0>r.indexOf(n))throw RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${n}`)}}(e,t,i.validate):i.validate}get isRequired(){return!this.hasDefault}}class F{constructor(e,t,i,r){this.name=e,this.rank=t,this.schema=i,this.spec=r,this.attrs=_(e,r.attrs),this.excluded=null;let n=N(this.attrs);this.instance=n?new a(this,n):null}create(e=null){return!e&&this.instance?this.instance:new a(this,H(this.attrs,e))}static compile(e,t){let i=Object.create(null),r=0;return e.forEach((e,n)=>i[e]=new F(e,r++,t,n)),i}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){P(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class V{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=r.from(e.nodes),t.marks=r.from(e.marks||{}),this.nodes=L.compile(this.spec.nodes,this),this.marks=F.compile(this.spec.marks,this);let i=Object.create(null);for(let e in this.nodes){if(e in this.marks)throw RangeError(e+" can not be both a node and a mark");let t=this.nodes[e],r=t.spec.content||"",n=t.spec.marks;if(t.contentMatch=i[r]||(i[r]=M.parse(r,this.nodes)),t.inlineContent=t.contentMatch.inlineContent,t.spec.linebreakReplacement){if(this.linebreakReplacement)throw RangeError("Multiple linebreak nodes defined");if(!t.isInline||!t.isLeaf)throw RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=t}t.markSet="_"==n?null:n?W(this,n.split(" ")):""!=n&&t.inlineContent?null:[]}for(let e in this.marks){let t=this.marks[e],i=t.spec.excludes;t.excluded=null==i?[t]:""==i?[]:W(this,i.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,i,r){if("string"==typeof e)e=this.nodeType(e);else if(e instanceof L){if(e.schema!=this)throw RangeError("Node type from different schema used ("+e.name+")")}else throw RangeError("Invalid node type: "+e);return e.createChecked(t,i,r)}text(e,t){let i=this.nodes.text;return new T(i,i.defaultAttrs,e,a.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return R.fromJSON(this,e)}markFromJSON(e){return a.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw RangeError("Unknown node type: "+e);return t}}function W(e,t){let i=[];for(let r=0;r<t.length;r++){let n=t[r],o=e.marks[n],s=o;if(o)i.push(o);else for(let t in e.marks){let r=e.marks[t];("_"==n||r.spec.group&&r.spec.group.split(" ").indexOf(n)>-1)&&i.push(s=r)}if(!s)throw SyntaxError("Unknown mark type: '"+t[r]+"'")}return i}class B{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let i=this.matchedStyles=[];t.forEach(e=>{if(null!=e.tag)this.tags.push(e);else if(null!=e.style){let t=/[^=]*/.exec(e.style)[0];0>i.indexOf(t)&&i.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let i=e.nodes[t.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let i=new Y(this,t,!1);return i.addAll(e,a.none,t.from,t.to),i.finish()}parseSlice(e,t={}){let i=new Y(this,t,!0);return i.addAll(e,a.none,t.from,t.to),u.maxOpen(i.finish())}matchTag(e,t,i){for(let o=i?this.tags.indexOf(i)+1:0;o<this.tags.length;o++){var r,n;let i=this.tags[o];if(r=e,n=i.tag,(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,n)&&(void 0===i.namespace||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let t=i.getAttrs(e);if(!1===t)continue;i.attrs=t||void 0}return i}}}matchStyle(e,t,i,r){for(let n=r?this.styles.indexOf(r)+1:0;n<this.styles.length;n++){let r=this.styles[n],o=r.style;if(0==o.indexOf(e)&&(!r.context||i.matchesContext(r.context))&&(!(o.length>e.length)||61==o.charCodeAt(e.length)&&o.slice(e.length+1)==t)){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function i(e){let i=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<i)break}t.splice(r,0,e)}for(let t in e.marks){let r=e.marks[t].spec.parseDOM;r&&r.forEach(e=>{i(e=K(e)),e.mark||e.ignore||e.clearMark||(e.mark=t)})}for(let t in e.nodes){let r=e.nodes[t].spec.parseDOM;r&&r.forEach(e=>{i(e=K(e)),e.node||e.ignore||e.mark||(e.node=t)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new B(e,B.schemaRules(e)))}}let j={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},z={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},U={ol:!0,ul:!0};function $(e,t,i){return null!=t?+!!t|2*("full"===t):e&&"pre"==e.whitespace?3:-5&i}class G{constructor(e,t,i,r,n,o){this.type=e,this.attrs=t,this.marks=i,this.solid=r,this.options=o,this.content=[],this.activeMarks=a.none,this.match=n||(4&o?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(n.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let t=this.type.contentMatch,i;return(i=t.findWrapping(e.type))?(this.match=t,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e=this.content[this.content.length-1],t;e&&e.isText&&(t=/[ \t\r\n\u000c]+$/.exec(e.text))&&(e.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=e.withText(e.text.slice(0,e.text.length-t[0].length)))}let t=n.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(n.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!j.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Y{constructor(e,t,i){this.parser=e,this.options=t,this.isOpen=i,this.open=0,this.localPreserveWS=!1;let r=t.topNode,n,o=$(null,t.preserveWhitespace,0)|4*!!i;n=r?new G(r.type,r.attrs,a.none,!0,t.topMatch||r.type.contentMatch,o):i?new G(null,null,a.none,!0,null,o):new G(e.schema.topNodeType,null,a.none,!0,null,o),this.nodes=[n],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let i=e.nodeValue,r=this.top,n=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===n||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(i)){if(n)i="full"!==n?i.replace(/\r?\n|\r/g," "):i.replace(/\r\n?/g,"\n");else if(i=i.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(i)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],n=e.previousSibling;(!t||n&&"BR"==n.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(i=i.slice(1))}i&&this.insertNode(this.parser.schema.text(i),t,!/\S/.test(i)),this.findInText(e)}else this.findInside(e)}addElement(e,t,i){let r=this.localPreserveWS,n=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let o=e.nodeName.toLowerCase(),s;U.hasOwnProperty(o)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,i=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&U.hasOwnProperty(e)&&i?(i.appendChild(t),t=i):"li"==e?i=t:e&&(i=null)}}(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,i));t:if(l?l.ignore:z.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let i,r=this.needsBlock;if(j.hasOwnProperty(o))n.content.length&&n.content[0].isInline&&this.open&&(this.open--,n=this.top),i=!0,n.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break t}let s=l&&l.skip?t:this.readStyles(e,t);s&&this.addAll(e,s),i&&this.sync(n),this.needsBlock=r}else{let i=this.readStyles(e,t);i&&this.addElementByRule(e,l,i,!1===l.consuming?s:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let i=e.style;if(i&&i.length)for(let e=0;e<this.parser.matchedStyles.length;e++){let r=this.parser.matchedStyles[e],n=i.getPropertyValue(r);if(n)for(let e;;){let i=this.parser.matchStyle(r,n,this,e);if(!i)break;if(i.ignore)return null;if(t=i.clearMark?t.filter(e=>!i.clearMark(e)):t.concat(this.parser.schema.marks[i.mark].create(i.attrs)),!1===i.consuming)e=i;else break}}return t}addElementByRule(e,t,i,r){let n,o;if(t.node)if((o=this.parser.schema.nodes[t.node]).isLeaf)this.insertNode(o.create(t.attrs),i,"BR"==e.nodeName)||this.leafFallback(e,i);else{let e=this.enter(o,t.attrs||null,i,t.preserveWhitespace);e&&(n=!0,i=e)}else{let e=this.parser.schema.marks[t.mark];i=i.concat(e.create(t.attrs))}let s=this.top;if(o&&o.isLeaf)this.findInside(e);else if(r)this.addElement(e,i,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,i,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,i),this.findAround(e,r,!1)}n&&this.sync(s)&&this.open--}addAll(e,t,i,r){let n=i||0;for(let o=i?e.childNodes[i]:e.firstChild,s=null==r?null:e.childNodes[r];o!=s;o=o.nextSibling,++n)this.findAtPoint(e,n),this.addDOM(o,t);this.findAtPoint(e,n)}findPlace(e,t,i){let r,n;for(let t=this.open,o=0;t>=0;t--){let s=this.nodes[t],l=s.findWrapping(e);if(l&&(!r||r.length>l.length+o)&&(r=l,n=s,!l.length))break;if(s.solid){if(i)break;o+=2}}if(!r)return null;this.sync(n);for(let e=0;e<r.length;e++)t=this.enterInner(r[e],null,t,!1);return t}insertNode(e,t,i){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,i);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let i=a.none;for(let n of r.concat(e.marks))(t.type?t.type.allowsMarkType(n.type):X(n.type,e.type))&&(i=n.addToSet(i));return t.content.push(e.mark(i)),!0}return!1}enter(e,t,i,r){let n=this.findPlace(e.create(t),i,!1);return n&&(n=this.enterInner(e,t,i,!0,r)),n}enterInner(e,t,i,r=!1,n){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(e);let s=$(e,n,o.options);4&o.options&&0==o.content.length&&(s|=4);let l=a.none;return i=i.filter(t=>(o.type?!o.type.allowsMarkType(t.type):!X(t.type,e))||(l=t.addToSet(l),!1)),this.nodes.push(new G(e,t,l,r,null,s)),this.open++,i}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--)if(this.nodes[t]==e)return this.open=t,!0;else this.localPreserveWS&&(this.nodes[t].options|=1);return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let i=this.nodes[t].content;for(let t=i.length-1;t>=0;t--)e+=i[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==e&&this.find[i].offset==t&&(this.find[i].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,i){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)&&t.compareDocumentPosition(this.find[r].node)&(i?2:4)&&(this.find[r].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),i=this.options.context,r=!this.isOpen&&(!i||i.parent.type==this.nodes[0].type),n=-(i?i.depth+1:0)+ +!r,o=(e,s)=>{for(;e>=0;e--){let l=t[e];if(""==l){if(e==t.length-1||0==e)continue;for(;s>=n;s--)if(o(e-1,s))return!0;return!1}{let e=s>0||0==s&&r?this.nodes[s].type:i&&s>=n?i.node(s-n).type:null;if(!e||e.name!=l&&!e.isInGroup(l))return!1;s--}}return!0};return o(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(let e in this.parser.schema.nodes){let t=this.parser.schema.nodes[e];if(t.isTextblock&&t.defaultAttrs)return t}}}function K(e){let t={};for(let i in e)t[i]=e[i];return t}function X(e,t){let i=t.schema.nodes;for(let r in i){let n=i[r];if(!n.allowsMarkType(e))continue;let o=[],s=e=>{o.push(e);for(let i=0;i<e.edgeCount;i++){let{type:r,next:n}=e.edge(i);if(r==t||0>o.indexOf(n)&&s(n))return!0}};if(s(n.contentMatch))return!0}}class q{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},i){i||(i=Z(t).createDocumentFragment());let r=i,n=[];return e.forEach(e=>{if(n.length||e.marks.length){let i=0,o=0;for(;i<n.length&&o<e.marks.length;){let t=e.marks[o];if(!this.marks[t.type.name]){o++;continue}if(!t.eq(n[i][0])||!1===t.type.spec.spanning)break;i++,o++}for(;i<n.length;)r=n.pop()[1];for(;o<e.marks.length;){let i=e.marks[o++],s=this.serializeMark(i,e.isInline,t);s&&(n.push([i,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),i}serializeNodeInner(e,t){let{dom:i,contentDOM:r}=ee(Z(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return i}serializeNode(e,t={}){let i=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let n=this.serializeMark(e.marks[r],e.isInline,t);n&&((n.contentDOM||n.dom).appendChild(i),i=n.dom)}return i}serializeMark(e,t,i={}){let r=this.marks[e.type.name];return r&&ee(Z(i),r(e,t),null,e.attrs)}static renderSpec(e,t,i=null,r){return ee(e,t,i,r)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new q(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=J(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return J(e.marks)}}function J(e){let t={};for(let i in e){let r=e[i].spec.toDOM;r&&(t[i]=r)}return t}function Z(e){return e.document||window.document}let Q=new WeakMap;function ee(e,t,i,r){let n,o,s;if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let l=t[0],a;if("string"!=typeof l)throw RangeError("Invalid array passed to renderSpec");if(r&&(void 0===(o=Q.get(r))&&Q.set(r,(s=null,function e(t){if(t&&"object"==typeof t)if(Array.isArray(t))if("string"==typeof t[0])s||(s=[]),s.push(t);else for(let i=0;i<t.length;i++)e(t[i]);else for(let i in t)e(t[i])}(r),o=s)),a=o)&&a.indexOf(t)>-1)throw RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let h=l.indexOf(" ");h>0&&(i=l.slice(0,h),l=l.slice(h+1));let u=i?e.createElementNS(i,l):e.createElement(l),c=t[1],d=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){for(let e in d=2,c)if(null!=c[e]){let t=e.indexOf(" ");t>0?u.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):u.setAttribute(e,c[e])}}for(let o=d;o<t.length;o++){let s=t[o];if(0===s){if(o<t.length-1||o>d)throw RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}{let{dom:t,contentDOM:o}=ee(e,s,i,r);if(u.appendChild(t),o){if(n)throw RangeError("Multiple content holes");n=o}}}return{dom:u,contentDOM:n}}},10932:(e,t,i)=>{"use strict";i.d(t,{q:()=>o}),i(19398);var r=i(12522),n=i(95061);class o extends r._{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(e)}getTrimmedIndexes(){return(0,n.arrayReduce)(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}}},11055:(e,t,i)=>{"use strict";i.r(t),i.d(t,{_dataToHTML:()=>l,htmlToGridSettings:()=>a,instanceToHTML:()=>s}),i(19398),i(81698),i(12252),i(29954),i(85522),i(43942);var r=i(78887);let n={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},o=RegExp(Object.keys(n).map(e=>`(${e})`).join("|"),"gi");function s(e){let t=e.hasColHeaders(),i=e.hasRowHeaders(),n=[t?-1:0,i?-1:0,e.countRows()-1,e.countCols()-1],o=e.getData(...n),s=o.length,l=s>0?o[0].length:0,a=["<table>","</table>"],h=t?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=+!!i,d=+!!t;for(let n=0;n<s;n+=1){let s=t&&0===n,a=[];for(let t=0;t<l;t+=1){let l=!s&&i&&0===t,h="";if(s)h=`<th>${e.getColHeader(t-c)}</th>`;else if(l)h=`<th>${e.getRowHeader(n-d)}</th>`;else{let i=o[n][t],{hidden:s,rowspan:l,colspan:a}=e.getCellMeta(n-d,t-c);if(!s){let e=[];if(l&&e.push(`rowspan="${l}"`),a&&e.push(`colspan="${a}"`),(0,r.isEmpty)(i))h=`<td ${e.join(" ")}></td>`;else{let t=i.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");h=`<td ${e.join(" ")}>${t}</td>`}}}a.push(h)}let g=["<tr>",...a,"</tr>"].join("");s?h.splice(1,0,g):u.splice(-1,0,g)}return a.splice(1,0,h.join(""),u.join("")),a.join("")}function l(e){let t=e.length,i=["<table>"];for(let n=0;n<t;n+=1){let o=e[n],s=o.length,l=[];0===n&&i.push("<tbody>");for(let e=0;e<s;e+=1){let t=o[e],i=(0,r.isEmpty)(t)?"":t.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,e=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(e.length-1)} </span>`).replace(/\t/gi,"&#9;");l.push(`<td>${i}</td>`)}i.push("<tr>",...l,"</tr>"),n+1===t&&i.push("</tbody>")}return i.push("</table>"),i.join("")}function a(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r={},s=i.createDocumentFragment(),l=i.createElement("div");s.appendChild(l);let a=e;if("string"==typeof a){let e=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,e=>{let t=e.match(/<td\b[^>]*?>/g)[0],i=e.substring(t.length,e.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${t}${i}</td>`});l.insertAdjacentHTML("afterbegin",`${e}`),a=l.querySelector("table")}if(!a||"TABLE"!==((t=a)&&t.nodeName||""))return;let h=l.querySelector('meta[name$="enerator"]'),u=null!==a.querySelector("tbody th"),c=a.querySelector("tr"),d=c?Array.from(c.cells).reduce((e,t)=>e+t.colSpan,0)-+!!u:0,g=a.tFoot&&Array.from(a.tFoot.rows)||[],f=[],p=!1,m=0,w=0;if(a.tHead){let e=Array.from(a.tHead.rows).filter(e=>{let t=null!==e.querySelector("td");return t&&f.push(e),!t});p=(m=e.length)>0,m>1?r.nestedHeaders=Array.from(e).reduce((e,t)=>{let i=Array.from(t.cells).reduce((e,t,i)=>{if(u&&0===i)return e;let{colSpan:r,innerHTML:n}=t;return e.push(r>1?{label:n,colspan:r}:n),e},[]);return e.push(i),e},[]):p&&(r.colHeaders=Array.from(e[0].children).reduce((e,t,i)=>(u&&0===i||e.push(t.innerHTML),e),[]))}f.length&&(r.fixedRowsTop=f.length),g.length&&(r.fixedRowsBottom=g.length);let y=[...f,...Array.from(a.tBodies).reduce((e,t)=>(e.push(...Array.from(t.rows)),e),[]),...g],b=Array(w=y.length);for(let e=0;e<w;e++)b[e]=Array(d);let C=[],S=[];for(let e=0;e<w;e++){let t=Array.from(y[e].cells),i=t.length;for(let r=0;r<i;r++){let i=t[r],{nodeName:s,innerHTML:l,rowSpan:a,colSpan:u}=i,c=b[e].findIndex(e=>void 0===e);if("TD"===s){if(a>1||u>1){for(let t=e;t<e+a;t++)if(t<w)for(let e=c;e<c+u;e++)b[t][e]=null;let t=i.getAttribute("style");t&&t.includes("mso-ignore:colspan")||C.push({col:c,row:e,rowspan:a,colspan:u})}let t="";t=h&&/excel/gi.test(h.content)?l.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):l.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),b[e][c]=t.replace(o,e=>n[e])}else S.push(l)}}return C.length&&(r.mergeCells=C),S.length&&(r.rowHeaders=S),b.length&&(r.data=b),r}},11351:(e,t,i)=>{"use strict";var r=i(54076),n=i(93840),o=i(50320),s=i(13517),l=i(16526),a=i(66212),h=i(81315),u=Array,c=n(a("Array","sort"));r({target:"Array",proto:!0},{toSorted:function(e){return void 0!==e&&o(e),c(l(u,s(this)),e)}}),h("toSorted")},11609:(e,t,i)=>{"use strict";var r=i(25),n=i(56963),o=i(42620).String;e.exports=!!Object.getOwnPropertySymbols&&!n(function(){var e=Symbol("symbol detection");return!o(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&r&&r<41})},12252:(e,t,i)=>{"use strict";i(79031)},12522:(e,t,i)=>{"use strict";i.d(t,{_:()=>o});var r=i(82505),n=i(59932);class o extends r.n{insert(e,t){this.indexedValues=(0,n.N)(this.indexedValues,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){this.indexedValues=(0,n.H)(this.indexedValues,e),super.remove(e)}}},13115:(e,t,i)=>{"use strict";i.r(t),i.d(t,{isImmediatePropagationStopped:()=>o,isLeftClick:()=>l,isRightClick:()=>s,isTouchEvent:()=>a,offsetRelativeTo:()=>h,stopImmediatePropagation:()=>n});var r=i(33787);function n(e){e.isImmediatePropagationEnabled=!1,e.cancelBubble=!0}function o(e){return!1===e.isImmediatePropagationEnabled}function s(e){return 2===e.button}function l(e){return 0===e.button}function a(e){return e instanceof TouchEvent}function h(e,t){let i={x:e.offsetX,y:e.offsetY},n=e.target;if(!(0,r.isHTMLElement)(t)||n!==t&&n.contains(t))return i;for(;n!==t;)i.x+=n.offsetLeft,i.y+=n.offsetTop,n=n.offsetParent;return i}},13455:(e,t,i)=>{"use strict";function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=typeof e;if("number"===i)return!isNaN(e)&&isFinite(e);if("string"===i){if(0===e.length)return!1;if(1===e.length)return/\d/.test(e);let i=Array.from(new Set([".",...t])).map(e=>`\\${e}`).join("|");return RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(e.trim())}return"object"===i&&!!e&&"number"==typeof e.valueOf()&&!(e instanceof Date)}function n(e){return r(e,[","])}function o(e,t,i){let r=-1;for("function"==typeof t?(i=t,t=e):r=e-1;++r<=t&&!1!==i(r););}function s(e,t,i){let r=e+1;for("function"==typeof t&&(i=t,t=0);--r>=t&&!1!==i(r););}function l(e,t){return parseInt(e*(t=isNaN(t=parseInt(t.toString().replace("%",""),10))?0:t)/100,10)}function a(e,t,i){return Math.min(e,t)===e?t:Math.max(e,i)===e?i:e}i.r(t),i.d(t,{clamp:()=>a,isNumeric:()=>r,isNumericLike:()=>n,rangeEach:()=>o,rangeEachReverse:()=>s,valueAccordingPercent:()=>l}),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(85522)},13517:(e,t,i)=>{"use strict";var r=i(35889),n=i(16604);e.exports=function(e){return r(n(e))}},13928:(e,t,i)=>{"use strict";e.exports=i(93840)([].slice)},14412:(e,t,i)=>{"use strict";e.exports=!i(56963)(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},15030:(e,t,i)=>{"use strict";var r=i(54076),n=i(56963),o=i(16528);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("intersection",function(e){return 2===e.size&&e.has(1)&&e.has(2)})||n(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))})},{intersection:o})},15567:(e,t,i)=>{"use strict";var r=i(42620),n=i(76494),o=r.document,s=n(o)&&n(o.createElement);e.exports=function(e){return s?o.createElement(e):{}}},15616:(e,t,i)=>{"use strict";i.r(t),i.d(t,{countFirstRowKeys:()=>d,createEmptySpreadsheetData:()=>u,createSpreadsheetData:()=>a,createSpreadsheetObjectData:()=>h,dataRowToChangesArray:()=>c,isArrayOfArrays:()=>g,isArrayOfObjects:()=>f,spreadsheetColumnIndex:()=>l,spreadsheetColumnLabel:()=>s}),i(19398),i(12252),i(63723),i(20775);var r=i(19857);let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=n.length;function s(e){let t,i=e+1,r="";for(;i>0;)r=String.fromCharCode(65+(t=(i-1)%o))+r,i=parseInt((i-t)/o,10);return r}function l(e){let t=0;if(e)for(let i=0,r=e.length-1;i<e.length;i+=1,r-=1)t+=o**r*(n.indexOf(e[i])+1);return t-1}function a(){let e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=[];for(e=0;e<i;e++){let i=[];for(t=0;t<r;t++)i.push(s(t)+(e+1));n.push(i)}return n}function h(){let e,t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=[];for(e=0;e<i;e++){let i={};for(t=0;t<r;t++)i[`prop${t}`]=s(t)+(e+1);n.push(i)}return n}function u(e,t){let i,r=[];for(let n=0;n<e;n++){i=[];for(let e=0;e<t;e++)i.push("");r.push(i)}return r}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=e,r=[];return Array.isArray(e)&&Array.isArray(e[0])||(i=[e]),i.forEach((e,i)=>{Array.isArray(e)?e.forEach((e,n)=>{r.push([i+t,n,e])}):Object.keys(e).forEach(n=>{r.push([i+t,n,e[n]])})}),r}function d(e){let t=0;return Array.isArray(e)&&(e[0]&&Array.isArray(e[0])?t=e[0].length:e[0]&&(0,r.isObject)(e[0])&&(t=(0,r.deepObjectSize)(e[0]))),t}function g(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>Array.isArray(e)))}function f(e){return!!(Array.isArray(e)&&e.length&&e.every(e=>"object"==typeof e&&!Array.isArray(e)&&null!==e))}},15625:(e,t,i)=>{"use strict";var r=i(82309),n=i(95467),o=i(24201),s=i(7411),l=i(65847),a=i(37e3),h=i(98590),u=i(55415),c=i(27643),d=i(1728),g=i(91615),f=i(14412),p=i(72255);e.exports=function(e,t,i,m){var w="stackTraceLimit",y=m?2:1,b=e.split("."),C=b[b.length-1],S=r.apply(null,b);if(S){var E=S.prototype;if(!p&&n(E,"cause")&&delete E.cause,!i)return S;var R=r("Error"),T=t(function(e,t){var i=c(m?t:e,void 0),r=m?new S(e):new S;return void 0!==i&&o(r,"message",i),g(r,T,r.stack,2),this&&s(E,this)&&u(r,this,T),arguments.length>y&&d(r,arguments[y]),r});if(T.prototype=E,"Error"!==C?l?l(T,R):a(T,R,{name:!0}):f&&w in S&&(h(T,S,w),h(T,S,"prepareStackTrace")),a(T,S),!p)try{E.name!==C&&o(E,"name",C),E.constructor=T}catch(e){}return T}}},15743:(e,t,i)=>{"use strict";var r=i(50320),n=i(8883),o=i(67297),s=i(42665),l=i(7475),a="Invalid size",h=RangeError,u=TypeError,c=Math.max,d=function(e,t){this.set=e,this.size=c(t,0),this.has=r(e.has),this.keys=r(e.keys)};d.prototype={getIterator:function(){return l(n(o(this.keys,this.set)))},includes:function(e){return o(this.has,this.set,e)}},e.exports=function(e){n(e);var t=+e.size;if(t!=t)throw new u(a);var i=s(t);if(i<0)throw new h(a);return new d(e,i)}},16526:(e,t,i)=>{"use strict";var r=i(94948);e.exports=function(e,t,i){for(var n=0,o=arguments.length>2?i:r(t),s=new e(o);o>n;)s[n]=t[n++];return s}},16528:(e,t,i)=>{"use strict";var r=i(94272),n=i(16954),o=i(57580),s=i(15743),l=i(69905),a=i(6497),h=n.Set,u=n.add,c=n.has;e.exports=function(e){var t=r(this),i=s(e),n=new h;return o(t)>i.size?a(i.getIterator(),function(e){c(t,e)&&u(n,e)}):l(t,function(e){i.includes(e)&&u(n,e)}),n}},16569:(e,t,i)=>{"use strict";var r=i(76494);e.exports=function(e){return r(e)||null===e}},16604:(e,t,i)=>{"use strict";var r=i(56135),n=TypeError;e.exports=function(e){if(r(e))throw new n("Can't call method on "+e);return e}},16683:(e,t,i)=>{"use strict";var r=i(95467),n=i(99365),o=i(33325),s=i(37889),l=i(60009),a=s("IE_PROTO"),h=Object,u=h.prototype;e.exports=l?h.getPrototypeOf:function(e){var t=o(e);if(r(t,a))return t[a];var i=t.constructor;return n(i)&&t instanceof i?i.prototype:t instanceof h?u:null}},16880:(e,t,i)=>{"use strict";i.d(t,{R:()=>R}),i(41658),i(19398);var r=i(95061),n=i(93924),o=i(57193),s=i(83457),l=i(75708);let a=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],h=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),u=new Map([[]]);function c(e,t,i){d(e,t),t.set(e,i)}function d(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function g(e,t,i){return e.set(p(e,t),i),i}function f(e,t){return e.get(p(e,t))}function p(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}i(11351),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(29954),i(21591),i(20775);var m=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakSet;class C{constructor(){!function(e,t){d(e,t),t.add(e)}(this,b),c(this,m,new Map),c(this,w,new Map),c(this,y,new Set),a.forEach(e=>p(b,this,S).call(this,e))}getHooks(e){var t;return null!==(t=f(m,this).get(e))&&void 0!==t?t:[]}add(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};f(m,this).has(e)||(p(b,this,S).call(this,e),a.push(e));let r=f(m,this).get(e);if(r.find(e=>e.callback===t))return;let n=Number.isInteger(i.orderIndex)?i.orderIndex:0,o=!!i.runOnce,s=!!i.initialHook,l=!1;if(s){let e=r.find(e=>e.initialHook);e&&(e.callback=t,l=!0)}if(!l){r.push({callback:t,orderIndex:n,runOnce:o,initialHook:s,skip:!1});let i=f(y,this).has(e);i||0===n||(i=!0,f(y,this).add(e)),i&&r.length>1&&f(m,this).set(e,r.toSorted((e,t)=>e.orderIndex-t.orderIndex))}}has(e){return f(m,this).has(e)&&f(m,this).get(e).length>0}remove(e,t){if(!f(m,this).has(e))return!1;let i=f(m,this).get(e),r=i.find(e=>e.callback===t);if(r){let t=f(w,this).get(e);return r.skip=!0,(t+=1)>100&&(f(m,this).set(e,i.filter(e=>!e.skip)),t=0),f(w,this).set(e,t),!0}return!1}destroy(){f(m,this).clear(),f(w,this).clear(),g(m,this,null),g(w,this,null)}}function S(e){f(m,this).set(e,[]),f(w,this).set(e,0)}let E=(0,s.O)`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class R{constructor(){!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"globalBucket",new C)}static getSingleton(){return T}getBucket(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new C),e.pluginHookBucket):this.globalBucket}add(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?(0,r.arrayEach)(t,t=>this.add(e,t,i)):(h.has(e)&&(0,o.R8)((0,n.substitute)(E,{hookName:e,removedInVersion:h.get(e)})),u.has(e)&&(0,o.R8)(u.get(e)),this.getBucket(i).add(e,t,{orderIndex:s,runOnce:!1})),this}once(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return Array.isArray(t)?(0,r.arrayEach)(t,t=>this.once(e,t,i)):this.getBucket(i).add(e,t,{orderIndex:n,runOnce:!0}),this}addAsFixed(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)?(0,r.arrayEach)(t,t=>this.addAsFixed(e,t,i)):this.getBucket(i).add(e,t,{initialHook:!0}),this}remove(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(i).remove(e,t)}has(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(t).has(e)}run(e,t,i,r,n,o,s,a){{let h=this.getBucket().getHooks(t),u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,l.fastCall)(h[c].callback,e,i,r,n,o,s,a);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(t,h[c].callback),c+=1}}{let h=this.getBucket(e).getHooks(t),u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,l.fastCall)(h[c].callback,e,i,r,n,o,s,a);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(t,h[c].callback,e),c+=1}}return i}destroy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||a.push(e)}deregister(e){this.isRegistered(e)&&a.splice(a.indexOf(e),1)}isDeprecated(e){return u.has(e)||h.has(e)}isRegistered(e){return a.indexOf(e)>=0}getRegistered(){return a}}let T=new R},16932:(e,t,i)=>{"use strict";i.d(t,{ML:()=>d,NB:()=>f,Qz:()=>l,_e:()=>g,ay:()=>s,f7:()=>p}),i(41658),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(75036);var r=i(71190),n=i(95061),o=i(78887);let s=0,l=1,a=[3,2],h=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],u=Symbol("root"),c=Symbol("child");function d(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;if(t!==u&&t!==c)throw Error("The second argument is used internally only and cannot be overwritten.");let i=Array.isArray(e),n=t===u,o=s;if(i){let t=e[0];0===e.length?o=l:n&&t instanceof r.A?o=3:n&&Array.isArray(t)?o=d(t,c):e.length>=2&&e.length<=4&&!e.some((e,t)=>!h[t].includes(typeof e))&&(o=2)}return o}function g(e){let{createCellCoords:t,createCellRange:i,keepDirection:r=!1,propToCol:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a.includes(e))throw Error("Unsupported selection ranges schema type was provided.");return function(s){let l=3===e,a=l?s.from.row:s[0],h=l?s.from.col:s[1],u=l?s.to.row:s[2],c=l?s.to.col:s[3];if("function"==typeof n&&("string"==typeof h&&(h=n(h)),"string"==typeof c&&(c=n(c))),(0,o.isUndefined)(u)&&(u=a),(0,o.isUndefined)(c)&&(c=h),!r){let e=a,t=h,i=u,r=c;a=Math.min(e,i),h=Math.min(t,r),u=Math.max(e,i),c=Math.max(t,r)}let d=t(a,h);return i(d,d,t(u,c))}}function f(e){let t=d(e.getSelected());if(t===s||t===l)return[];let i=g(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;(0,n.arrayEach)(e.getSelected(),e=>{let{from:t,to:o}=i(e),s=Math.max(t.col,0),l=o.col-s+1;(0,n.arrayEach)(Array.from(Array(l),(e,t)=>s+t),e=>{r.has(e)||r.add(e)})});let o=Array.from(r).sort((e,t)=>e-t);return(0,n.arrayReduce)(o,(e,t,i,r)=>(0!==i&&t===r[i-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[])}function p(e){let t=d(e.getSelected());if(t===s||t===l)return[];let i=g(t,{createCellCoords:e._createCellCoords.bind(e),createCellRange:e._createCellRange.bind(e)}),r=new Set;(0,n.arrayEach)(e.getSelected(),e=>{let{from:t,to:o}=i(e),s=Math.max(t.row,0),l=o.row-s+1;(0,n.arrayEach)(Array.from(Array(l),(e,t)=>s+t),e=>{r.has(e)||r.add(e)})});let o=Array.from(r).sort((e,t)=>e-t);return(0,n.arrayReduce)(o,(e,t,i,r)=>(0!==i&&t===r[i-1]+1?e[e.length-1][1]+=1:e.push([t,1]),e),[])}},16954:(e,t,i)=>{"use strict";var r=i(93840),n=Set.prototype;e.exports={Set:Set,add:r(n.add),has:r(n.has),remove:r(n.delete),proto:n}},17480:(e,t,i)=>{"use strict";i.d(t,{sd:()=>m,f4:()=>p,Mt:()=>w,F3:()=>y}),i(41658);var r=i(93924);i(12252),i(85522);var n=i(13455),o=i(75708);let s=new Map([["asc",[-1,1]],["desc",[1,-1]]]),l=e=>`The priority '${e}' is already declared in a map.`,a=e=>`The priority '${e}' is not a number.`;var h=i(89658);i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);let u=e=>`'${e}' value is already declared in a unique set.`,c=e=>`There is already registered "${e}" plugin.`,d=function(){let{errorPriorityExists:e,errorPriorityNaN:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new Map;return e=(0,o.isFunction)(e)?e:l,t=(0,o.isFunction)(t)?t:a,{addItem:function(r,o){if(!(0,n.isNumeric)(r))throw Error(t(r));if(i.has(r))throw Error(e(r));i.set(r,o)},getItems:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",[t,r]=s.get(e)||s.get("asc");return[...i].sort((e,i)=>e[0]<i[0]?t:r).map(e=>e[1])}}}({errorPriorityExists:e=>`There is already registered plugin on priority "${e}".`,errorPriorityNaN:e=>`The priority "${e}" is not a number.`}),g=function(){let{errorItemExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Set;return e=(0,o.isFunction)(e)?e:u,{addItem:function(i){if(t.has(i))throw Error(e(i));t.add(i)},clear:function(){t.clear()},getItems:function(){return[...t]}}}({errorItemExists:c}),f=(0,h.u)({errorIdExists:c});function p(){return[...d.getItems(),...g.getItems()]}function m(e){let t=(0,r.toUpperCaseFirst)(e);return f.getItem(t)}function w(e){return!!m(e)}function y(e,t,i){var n,o,s;[e,t,i]=(n=e,o=t,s=i,"function"==typeof n&&(n=(o=n).PLUGIN_KEY,s=o.PLUGIN_PRIORITY),[n,o,s]),void 0===m(e)&&function(e,t,i){let n=(0,r.toUpperCaseFirst)(e);if(f.hasItem(n))throw Error(c(n));void 0===i?g.addItem(n):d.addItem(i,n),f.addItem(n,t)}(e,t,i)}},18045:(e,t,i)=>{"use strict";i.d(t,{A:()=>l,q:()=>s});let r=/^(\r\n|\n\r|\r|\n)/,n=/^[^\t\r\n]+/,o=/^\t/;function s(e){let t,i=[[""]];if(0===e.length)return i;let s=0,l=0;for(;e.length>0&&t!==e.length;)if(t=e.length,e.match(o))e=e.replace(o,""),s+=1,i[l][s]="";else if(e.match(r))e=e.replace(r,""),s=0,i[l+=1]=[""];else{let t="";if(e.startsWith('"')){let i=0,r=!0;for(;r;){let n=e.slice(0,1);'"'===n&&(i+=1),t+=n,(0===(e=e.slice(1)).length||e.match(/^[\t\r\n]/)&&i%2==0)&&(r=!1)}t=t.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,e=>Array(Math.floor(e.length/2)).fill('"').join(""))}else{let i=e.match(n);t=i?i[0]:"",e=e.slice(t.length)}i[l][s]=t}return i}function l(e){let t,i,r,n,o,s="";for(t=0,i=e.length;t<i;t+=1){for(r=0,n=e[t].length;r<n;r+=1)r>0&&(s+="	"),"string"==typeof(o=e[t][r])?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:null==o?s+="":s+=o;t!==i-1&&(s+="\n")}return s}},19398:(e,t,i)=>{"use strict";var r=i(54076),n=i(33325),o=i(94948),s=i(2769),l=i(42947);r({target:"Array",proto:!0,arity:1,forced:i(56963)(function(){return 0x100000001!==[].push.call({length:0x100000000},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}}()},{push:function(e){var t=n(this),i=o(t),r=arguments.length;l(i+r);for(var a=0;a<r;a++)t[i]=arguments[a],i++;return s(t,i),i}})},19857:(e,t,i)=>{"use strict";i.r(t),i.d(t,{clone:()=>l,createObjectPropListener:()=>m,deepClone:()=>s,deepExtend:()=>function e(t,i){d(i,(r,n)=>{i[n]&&"object"==typeof i[n]?(t[n]||(Array.isArray(i[n])?t[n]=[]:"[object Date]"===Object.prototype.toString.call(i[n])?t[n]=i[n]:t[n]={}),e(t[n],i[n])):t[n]=i[n]})},deepObjectSize:()=>p,defineGetter:()=>c,duckSchema:()=>function e(t){let i;return Array.isArray(t)?i=t.length?Array(t.length).fill(null):[]:(i={},d(t,(t,r)=>{"__children"!==r&&(t&&"object"==typeof t&&!Array.isArray(t)?i[r]=e(t):Array.isArray(t)?t.length&&"object"==typeof t[0]&&!Array.isArray(t[0])?i[r]=[e(t[0])]:i[r]=[]:i[r]=null)})),i},extend:()=>o,getProperty:()=>g,hasOwnProperty:()=>w,inherit:()=>n,isObject:()=>u,isObjectEqual:()=>h,mixin:()=>a,objectEach:()=>d,setProperty:()=>f}),i(41658),i(19398),i(89750),i(12252),i(20775);var r=i(95061);function n(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e}function o(e,t,i){let r=Array.isArray(i);return d(t,(t,n)=>{(!1===r||i.includes(n))&&(e[n]=t)}),e}function s(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e}function l(e){let t={};return d(e,(e,i)=>{t[i]=e}),t}function a(e){e.MIXINS||(e.MIXINS=[]);for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return(0,r.arrayEach)(i,t=>{e.MIXINS.push(t.MIXIN_NAME),d(t,(t,i)=>{if(void 0!==e.prototype[i])throw Error(`Mixin conflict. Property '${i}' already exist and cannot be overwritten.`);"function"==typeof t?e.prototype[i]=t:Object.defineProperty(e.prototype,i,{get:function(e,t){let i=`_${e}`,r=e=>{let t=e;return(Array.isArray(t)||u(t))&&(t=s(t)),t};return function(){return void 0===this[i]&&(this[i]=r(t)),this[i]}}(i,t),set:function(e){let t=`_${e}`;return function(e){this[t]=e}}(i),configurable:!0})})}),e}function h(e,t){return JSON.stringify(e)===JSON.stringify(t)}function u(e){return"[object Object]"===Object.prototype.toString.call(e)}function c(e,t,i,r){r.value=i,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(e,t,r)}function d(e,t){for(let i in e)if((!e.hasOwnProperty||e.hasOwnProperty&&Object.prototype.hasOwnProperty.call(e,i))&&!1===t(e[i],i,e))break;return e}function g(e,t){let i=t.split("."),r=e;return d(i,e=>{if(void 0===(r=r[e]))return r=void 0,!1}),r}function f(e,t,i){if("string"!=typeof t)return;let r=t.split("."),n=e;r.forEach((e,t)=>{"__proto__"!==e&&"constructor"!==e&&"prototype"!==e&&(t!==r.length-1?(w(n,e)||(n[e]={}),n=n[e]):n[e]=i)})}function p(e){if(!u(e))return 0;let t=function(e){let i=0;return u(e)?d(e,(e,r)=>{"__children"!==r&&(i+=t(e))}):i+=1,i};return t(e)}function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",i=`_${t}`,r={_touched:!1,[i]:e,isTouched(){return this._touched}};return Object.defineProperty(r,t,{get(){return this[i]},set(e){this._touched=!0,this[i]=e},enumerable:!0,configurable:!0}),r}function w(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},20775:(e,t,i)=>{"use strict";i(63462)},21413:(e,t,i)=>{"use strict";i.d(t,{A:()=>n});let r=new Map;function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";r.has(e)||r.set(e,new Map);let t=r.get(e);return{register:function(e,i){t.set(e,i)},getItem:function(e){return t.get(e)},hasItem:function(e){return t.has(e)},getNames:function(){return[...t.keys()]},getValues:function(){return[...t.values()]}}}},21591:(e,t,i)=>{"use strict";i(26122)},22229:(e,t)=>{"use strict";t.f=Object.getOwnPropertySymbols},23544:(e,t,i)=>{"use strict";let r;function n(e){return window.requestAnimationFrame(e)}function o(e){window.cancelAnimationFrame(e)}function s(){return"ontouchstart"in window}function l(){return"undefined"!=typeof window}function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r||(r="object"==typeof Intl?new Intl.Collator(e,t).compare:"function"==typeof String.prototype.localeCompare?(e,t)=>`${e}`.localeCompare(t):(e,t)=>e===t?0:e>t?-1:1)}i.r(t),i.d(t,{cancelAnimationFrame:()=>o,getComparisonFunction:()=>a,isCSR:()=>l,isTouchSupported:()=>s,requestAnimationFrame:()=>n})},23967:(e,t,i)=>{"use strict";i.d(t,{_:()=>P}),i(41658),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(29954),i(75036);var r=i(95061),n=i(57496),o=i(44065),s=i(82505),l=i(88215),a=i(12522),h=i(10932);let u=new Map([["hiding",o.o],["index",s.n],["linkedPhysicalIndexToValue",l.z],["physicalIndexToValue",a._],["trimming",h.q]]);var c=i(33774);i(19398);var d=i(41973),g=i(78887);function f(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class p extends d.p{constructor(e,t){super(),f(this,"mergedValuesCache",[]),f(this,"aggregationFunction",void 0),f(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=t}getMergedValues(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===e)return this.mergedValuesCache;if(0===this.getLength())return[];let t=(0,r.arrayMap)(this.get(),e=>e.getValues()),i=[],n=(0,g.isDefined)(t[0])&&t[0].length||0;for(let e=0;e<n;e+=1){let r=[];for(let i=0;i<this.getLength();i+=1)r.push(t[i][e]);i.push(r)}return(0,r.arrayMap)(i,this.aggregationFunction)}getMergedValueAtIndex(e,t){let i=this.getMergedValues(t)[e];return(0,g.isDefined)(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}var m=i(81174),w=i(19857);function y(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}i(20775);var b=new WeakMap;class C{constructor(){!function(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}(this,b,[])}subscribe(e){return this.addLocalHook("change",e),this._write(b.get(y(b,this))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){b.set(y(b,this),e)}}function S(e,t){let i=[],r=0,n=0;for(;r<e.length&&n<t.length;r++,n++)e[r]!==t[n]&&i.push({op:"replace",index:n,oldValue:e[r],newValue:t[n]});for(;r<t.length;r++)i.push({op:"insert",index:r,oldValue:void 0,newValue:t[r]});for(;n<e.length;n++)i.push({op:"remove",index:n,oldValue:e[n],newValue:void 0});return i}function E(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function R(e,t){return e.get(x(e,t))}function T(e,t,i){return e.set(x(e,t),i),i}function x(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}(0,w.mixin)(C,m.A);var M=new WeakMap,O=new WeakMap,k=new WeakMap,I=new WeakMap,A=new WeakMap;class N{constructor(){let{initialIndexValue:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};E(this,M,new Set),E(this,O,[]),E(this,k,[]),E(this,I,!1),E(this,A,!1),T(A,this,null!=e&&e)}createObserver(){let e=new C;return R(M,this).add(e),e.addLocalHook("unsubscribe",()=>{R(M,this).delete(e)}),e._writeInitialChanges(S(R(O,this),R(k,this))),e}emit(e){let t=R(k,this);R(I,this)&&R(O,this).length===e.length||(0===e.length?e=Array(t.length).fill(R(A,this)):T(O,this,Array(e.length).fill(R(A,this))),R(I,this)||(T(I,this,!0),t=R(O,this)));let i=S(t,e);R(M,this).forEach(e=>e._write(i)),T(k,this,e)}}function H(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class P{constructor(){H(this,"indexesSequence",new n.K),H(this,"trimmingMapsCollection",new p(e=>e.some(e=>!0===e),!1)),H(this,"hidingMapsCollection",new p(e=>e.some(e=>!0===e),!1)),H(this,"variousMapsCollection",new d.p),H(this,"hidingChangesObservable",new N({initialIndexValue:!1})),H(this,"notTrimmedIndexesCache",[]),H(this,"notHiddenIndexesCache",[]),H(this,"isBatched",!1),H(this,"indexesSequenceChanged",!1),H(this,"indexesChangeSource",void 0),H(this,"trimmedIndexesChanged",!1),H(this,"hiddenIndexesChanged",!1),H(this,"renderablePhysicalIndexesCache",[]),H(this,"fromPhysicalToVisualIndexesCache",new Map),H(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if("hiding"!==e)throw Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,t,i){return this.registerMap(e,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!u.has(e))throw Error(`The provided map type ("${e}") does not exist.`);return new(u.get(e))(t)}(t,i))}registerMap(e,t){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);t instanceof h.q?this.trimmingMapsCollection.register(e,t):t instanceof o.o?this.hidingMapsCollection.register(e,t):this.variousMapsCollection.register(e,t);let i=this.getNumberOfIndexes();return i>0&&t.init(i),t}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){let t=this.notTrimmedIndexesCache[e];return(0,g.isDefined)(t)?t:null}getPhysicalFromRenderableIndex(e){let t=this.renderablePhysicalIndexesCache[e];return(0,g.isDefined)(t)?t:null}getVisualFromPhysicalIndex(e){let t=this.fromPhysicalToVisualIndexesCache.get(e);return(0,g.isDefined)(t)?t:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){let t=this.fromVisualToRenderableIndexesCache.get(e);return(0,g.isDefined)(t)?t:null}getNearestNotHiddenIndex(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(e))return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;let r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),n=-1;return -1===(n=t>0?r.findIndex(t=>t>e):r.reverse().findIndex(t=>t<e))?i?this.getNearestNotHiddenIndex(e,-t,!1):null:(0,r[n])}initToLength(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...Array(e).keys()],this.notHiddenIndexesCache=[...Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){let t=this.getNumberOfIndexes();if(e<t){let t=[...Array(this.getNumberOfIndexes()-e).keys()].map(t=>t+e);this.removeIndexes(t)}else this.insertIndexes(t,e-t)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===e?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(e=>!1===this.isTrimmed(e))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===e?this.notHiddenIndexesCache:this.getIndexesSequence().filter(e=>!1===this.isHidden(e))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===e?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(e=>!1===this.isHidden(e))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,t){"number"==typeof e&&(e=[e]);let i=(0,r.arrayMap)(e,e=>this.getPhysicalFromVisualIndex(e)),n=this.getNotTrimmedIndexesLength(),o=e.length,s=(0,c.H)(this.getIndexesSequence(),i),l=s.filter(e=>!1===this.isTrimmed(e)),a=s.indexOf(l[l.length-1])+1;if(t+o<n){let e=l[t];a=s.indexOf(e)}this.indexesChangeSource="move",this.setIndexesSequence((0,c.N)(s,a,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,t){let i=this.getNotTrimmedIndexes()[e],n=(0,g.isDefined)(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=(0,r.arrayMap)(Array(t).fill(n),(e,t)=>e+t);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===e||!1===this.isBatched&&!0===t)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let t=0;t<e;t+=1){let e=this.getPhysicalFromVisualIndex(t);this.fromPhysicalToVisualIndexesCache.set(e,t)}}cacheFromVisualToRenderableIndexes(){let e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let t=0;t<e;t+=1){let e=this.getPhysicalFromRenderableIndex(t),i=this.getVisualFromPhysicalIndex(e);this.fromVisualToRenderableIndexesCache.set(i,t)}}}(0,w.mixin)(P,m.A)},24113:(e,t,i)=>{"use strict";i.d(t,{nF:()=>d,bN:()=>b,W5:()=>S,E9:()=>E,Mj:()=>R,Lp:()=>C,eb:()=>y});var r=i(19857),n=i(95061),o=i(78887),s=i(84536),l=i(21413);let{register:a,getValues:h}=(0,l.A)("phraseFormatters");a("pluralize",function(e,t){return Array.isArray(e)&&Number.isInteger(t)?e[t]:e});var u=i(95696);let c={languageCode:"en-US",[u.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[u.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[u.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[u.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[u.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[u.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[u.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[u.CONTEXTMENU_ITEMS_UNDO]:"Undo",[u.CONTEXTMENU_ITEMS_REDO]:"Redo",[u.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[u.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[u.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[u.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[u.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[u.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[u.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[u.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[u.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[u.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[u.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[u.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[u.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[u.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[u.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[u.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[u.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[u.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[u.CONTEXTMENU_ITEMS_COPY]:"Copy",[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[u.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[u.CONTEXTMENU_ITEMS_CUT]:"Cut",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[u.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[u.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[u.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[u.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[u.FILTERS_CONDITIONS_NONE]:"None",[u.FILTERS_CONDITIONS_EMPTY]:"Is empty",[u.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[u.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[u.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[u.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[u.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[u.FILTERS_CONDITIONS_CONTAINS]:"Contains",[u.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[u.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[u.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[u.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[u.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[u.FILTERS_CONDITIONS_BETWEEN]:"Is between",[u.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[u.FILTERS_CONDITIONS_AFTER]:"After",[u.FILTERS_CONDITIONS_BEFORE]:"Before",[u.FILTERS_CONDITIONS_TODAY]:"Today",[u.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[u.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[u.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[u.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[u.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[u.FILTERS_LABELS_CONJUNCTION]:"And",[u.FILTERS_LABELS_DISJUNCTION]:"Or",[u.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[u.FILTERS_BUTTONS_CLEAR]:"Clear",[u.FILTERS_BUTTONS_OK]:"OK",[u.FILTERS_BUTTONS_CANCEL]:"Cancel",[u.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[u.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[u.CHECKBOX_CHECKED]:"Checked",[u.CHECKBOX_UNCHECKED]:"Unchecked"},d=u,g=c.languageCode,{register:f,getItem:p,hasItem:m,getValues:w}=(0,l.A)("languagesDictionaries");function y(e,t){var i,n;let o=e,l=t;return(0,r.isObject)(e)&&(o=(l=e).languageCode),i=o,n=l,i!==g&&(0,s.DW)(n,p(g)),f(o,(0,r.deepClone)(l)),(0,r.deepClone)(l)}function b(e){return m(e)?(0,r.deepClone)(p(e)):null}function C(e){return m(e)}function S(){return w()}function E(e,t,i){var r,s;let l,a=b(e);if(null===a)return null;let u=a[t];if((0,o.isUndefined)(u))return null;let c=(r=u,s=i,l=r,(0,n.arrayEach)(h(),e=>{l=e(r,s)}),l);return Array.isArray(c)?c[0]:c}function R(e){let t=(0,s.Jn)(e);return!m(t)&&(t=g,(0,s.A$)(e)),t}y(c)},24201:(e,t,i)=>{"use strict";var r=i(14412),n=i(24851),o=i(32138);e.exports=r?function(e,t,i){return n.f(e,t,o(1,i))}:function(e,t,i){return e[t]=i,e}},24696:(e,t,i)=>{"use strict";function r(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,{Z:()=>o}),i(41658),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(20775);var n=new WeakMap;class o{constructor(e){r(this,"metaManager",void 0),r(this,"usageTracker",new Set),r(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(e){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===e)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),function(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}(this,n,(e,t,i)=>{if(!i)throw Error(`The \`${e}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,t)=>{let{initOnly:i,target:r,onChange:o}=e,s="string"==typeof r,l=s?r:t,a=`_${l}`;if(this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[l],o)this.installPropWatcher(t,a,o),s&&this.installPropWatcher(r,a,o);else if(i)this.installPropWatcher(t,a,n.get(function(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}(n,this))),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(t)})}installPropWatcher(e,t,i){let r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[t]},set(n){let o=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,n,o),this[t]=n},enumerable:!0,configurable:!0})}}},24711:(e,t,i)=>{"use strict";var r=i(14412),n=i(56963),o=i(15567);e.exports=!r&&!n(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},24771:(e,t,i)=>{"use strict";var r=i(94272),n=i(16954).has,o=i(57580),s=i(15743),l=i(69905),a=i(6497),h=i(76093);e.exports=function(e){var t=r(this),i=s(e);if(o(t)<=i.size)return!1!==l(t,function(e){if(i.includes(e))return!1},!0);var u=i.getIterator();return!1!==a(u,function(e){if(n(t,e))return h(u,"normal",!1)})}},24851:(e,t,i)=>{"use strict";var r=i(14412),n=i(24711),o=i(9234),s=i(8883),l=i(64409),a=TypeError,h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",d="configurable",g="writable";t.f=r?o?function(e,t,i){if(s(e),t=l(t),s(i),"function"==typeof e&&"prototype"===t&&"value"in i&&g in i&&!i[g]){var r=u(e,t);r&&r[g]&&(e[t]=i.value,i={configurable:d in i?i[d]:r[d],enumerable:c in i?i[c]:r[c],writable:!1})}return h(e,t,i)}:h:function(e,t,i){if(s(e),t=l(t),s(i),n)try{return h(e,t,i)}catch(e){}if("get"in i||"set"in i)throw new a("Accessors not supported");return"value"in i&&(e[t]=i.value),e}},25737:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("some",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(e){l(this);try{s(e)}catch(e){h(this,"throw",e)}if(u)return n(u,this,e);var t=a(this),i=0;return o(t,function(t,r){if(e(t,i++))return r()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},26122:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("find",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{find:function(e){l(this);try{s(e)}catch(e){h(this,"throw",e)}if(u)return n(u,this,e);var t=a(this),i=0;return o(t,function(t,r){if(e(t,i++))return r(t)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},26464:e=>{!function(){"use strict";var t={928:function(e,t,i){var r=i(322);e.exports=function(e,t,i){var n,o;if(i=i||0,!r(t))return -1;if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e,i);for(o=t.length,n=i;i>=0&&n<o;n+=1)if(t[n]===e)return n;return -1}},690:function(e,t,i){var r=i(322),n=i(893),o=i(956);e.exports=function(e,t,i){r(e)?n(e,t,i):o(e,t,i)}},893:function(e){e.exports=function(e,t,i){var r=0,n=e.length;for(i=i||null;r<n&&!1!==t.call(i,e[r],r,e);r+=1);}},956:function(e){e.exports=function(e,t,i){var r;for(r in i=i||null,e)if(e.hasOwnProperty(r)&&!1===t.call(i,e[r],r,e))break}},990:function(e,t,i){var r=i(893);e.exports=function(e){var t;try{t=Array.prototype.slice.call(e)}catch(i){t=[],r(e,function(e){t.push(e)})}return t}},24:function(e,t,i){var r=i(322),n=i(929);e.exports=function(e,t){if(t=(t=r(t)?t.join(" "):t).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),n(e.className.baseVal)){e.className=t;return}e.className.baseVal=t}},204:function(e,t,i){var r=i(690),n=i(928),o=i(902),s=i(24);e.exports=function(e){var t,i=Array.prototype.slice.call(arguments,1),l=e.classList,a=[];if(l){r(i,function(t){e.classList.add(t)});return}(t=o(e))&&(i=[].concat(t.split(/\s+/),i)),r(i,function(e){0>n(e,a)&&a.push(e)}),s(e,a)}},522:function(e,t,i){var r=i(758),n=i(690);e.exports=function(e,t,i){var o=e.style;if(r(t)){o[t]=i;return}n(t,function(e,t){o[t]=e})}},902:function(e,t,i){var r=i(929);e.exports=function(e){return e&&e.className?r(e.className.baseVal)?e.className:e.className.baseVal:""}},714:function(e,t,i){var r=i(928),n=i(902);e.exports=function(e,t){return e.classList?e.classList.contains(t):r(t,n(e).split(/\s+/))>-1}},462:function(e,t,i){var r=i(893),n=i(928),o=i(902),s=i(24);e.exports=function(e){var t,i,l=Array.prototype.slice.call(arguments,1),a=e.classList;if(a){r(l,function(e){a.remove(e)});return}t=o(e).split(/\s+/),i=[],r(t,function(e){0>n(e,l)&&i.push(e)}),s(e,i)}},322:function(e){e.exports=function(e){return e instanceof Array}},294:function(e){e.exports=function(e){return e instanceof Function}},758:function(e){e.exports=function(e){return"string"==typeof e||e instanceof String}},929:function(e){e.exports=function(e){return void 0===e}}},i={};function r(e){var n=i[e];if(void 0!==n)return n.exports;var o=i[e]={exports:{}};return t[e](o,o.exports,r),o.exports}r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},r.d=function(e,t){for(var i in t)r.o(t,i)&&!r.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};var n={};!function(){r.d(n,{default:function(){return M}});var e=r(294),t=r.n(e),i=r(758),o=r.n(i),s=function(e,t){for(var i=0,r=t.length,n=e.length;i<r;i++,n++)e[n]=t[i];return e};function l(e,t,i){var r,n=t.pmView,l=[];return(r=[],e.descendants(function(e,t){e.isBlock&&"codeBlock"===e.type.name&&r.push({node:e,pos:t})}),r).forEach(function(e){var t=e.pos,r=e.node,a=r.attrs.language,h=i.languages[a],u=function e(t){return t.reduce(function(t,i){return t.concat(Array.isArray(i)?e(i):i)},[])}(function e(t,i){return(void 0===i&&(i=[]),o()(t))?[{text:t,classes:i}]:t.map(function(t){var r=t.type,n=t.alias,l=[],a=[];r&&(l=["token",r]),n&&(a=o()(n)?[n]:n);var h=s(s(s([],i),l),a);return o()(t)?{text:t,classes:h}:e(t.content,h)})}(h?i.tokenize(r.textContent,h):[])),c=t+1;u.forEach(function(e){var t=e.text,i=e.classes,r=c,o=r+t.length;c=o;var s=i.join(" "),a=n.Decoration.inline(r,o,{class:s});s.length&&l.push(a)})}),n.DecorationSet.create(e,l)}var a=r(204),h=r.n(a);function u(e){return parseInt(e,10)}function c(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e.map(function(e){return"toastui-editor-"+e}).join(" ")}var d=r(522),g=r.n(d),f=r(462),p=r.n(f),m=r(714),w=r.n(m),y=r(990),b=r.n(y),C=r(928),S=r.n(C),E="data-language",R=function(){function e(e,t,i){var r=this;this.buttons=[],this.prevStoredLanguage="",this.onSelectToggleButton=function(e){var t,i,n,o,s=getComputedStyle(e.target,":after"),l=e.offsetX,a=e.offsetY;t=u(s.left),i=u(s.top),n=u(s.width)+u(s.paddingLeft)+u(s.paddingRight),o=u(s.height)+u(s.paddingTop)+u(s.paddingBottom),l>=t&&l<=t+n&&a>=i&&a<=i+o&&(e.preventDefault(),r.toggleFocus())},this.onSelectLanguageButtons=function(e){var t=e.target.getAttribute(E);t&&r.selectLanguage(t)},this.handleKeydown=function(e){var t=e.key;"ArrowUp"===t?(r.selectPrevLanguage(),e.preventDefault()):"ArrowDown"===t?(r.selectNextLanguage(),e.preventDefault()):"Enter"===t||"Tab"===t?(r.storeInputLanguage(),e.preventDefault()):r.hideList()},this.showLangugaeSelectBox=function(e,t){var i=e.top,n=e.right;t&&r.setLanguage(t),r.show();var o=r.input.parentElement.getBoundingClientRect().width;g()(r.wrapper,{top:i+10+"px",left:n-o-10+"px"}),r.toggleFocus()},this.rootEl=e,this.eventEmitter=t,this.languages=i,this.createElement(),this.bindDOMEvent(),this.bindEvent()}return e.prototype.createElement=function(){this.wrapper=document.createElement("div"),h()(this.wrapper,c("code-block-language")),this.createInputElement(),this.createLanguageListElement(),this.rootEl.appendChild(this.wrapper),this.hide()},e.prototype.createInputElement=function(){var e=document.createElement("span");h()(e,c("code-block-language-input"));var t=document.createElement("input");t.type="text",t.setAttribute("maxlength","20"),this.input=t,e.appendChild(this.input),this.wrapper.appendChild(e)},e.prototype.createLanguageListElement=function(){this.list=document.createElement("div"),h()(this.list,c("code-block-language-list"));var e=document.createElement("div");h()(e,"buttons"),e.innerHTML=this.languages.map(function(e){return'<button type="button" data-language="'+e+'">'+e+"</button>"}).join(""),this.buttons=b()(e.children),this.list.appendChild(e),this.wrapper.appendChild(this.list),this.activateButtonByIndex(0),this.hideList()},e.prototype.bindDOMEvent=function(){var e=this;this.wrapper.addEventListener("mousedown",this.onSelectToggleButton),this.input.addEventListener("keydown",this.handleKeydown),this.input.addEventListener("focus",function(){return e.activateSelectBox()}),this.input.addEventListener("blur",function(){return e.inactivateSelectBox()}),this.list.addEventListener("mousedown",this.onSelectLanguageButtons)},e.prototype.bindEvent=function(){this.eventEmitter.listen("showCodeBlockLanguages",this.showLangugaeSelectBox)},e.prototype.activateSelectBox=function(){h()(this.wrapper,"active"),g()(this.list,{display:"block"})},e.prototype.inactivateSelectBox=function(){this.input.value=this.prevStoredLanguage,p()(this.wrapper,"active"),this.hideList()},e.prototype.toggleFocus=function(){w()(this.wrapper,"active")?this.input.blur():this.input.focus()},e.prototype.storeInputLanguage=function(){var e=this.input.value;this.setLanguage(e),this.hideList(),this.eventEmitter.emit("selectLanguage",e)},e.prototype.activateButtonByIndex=function(e){this.currentButton&&p()(this.currentButton,"active"),this.buttons.length&&(this.currentButton=this.buttons[e],this.input.value=this.currentButton.getAttribute(E),h()(this.currentButton,"active"),this.currentButton.scrollIntoView())},e.prototype.selectLanguage=function(e){this.input.value=e,this.storeInputLanguage()},e.prototype.selectPrevLanguage=function(){var e=S()(this.currentButton,this.buttons)-1;e<0&&(e=this.buttons.length-1),this.activateButtonByIndex(e)},e.prototype.selectNextLanguage=function(){var e=S()(this.currentButton,this.buttons)+1;e>=this.buttons.length&&(e=0),this.activateButtonByIndex(e)},e.prototype.hideList=function(){g()(this.list,{display:"none"})},e.prototype.show=function(){g()(this.wrapper,{display:"inline-block"})},e.prototype.hide=function(){g()(this.wrapper,{display:"none"})},e.prototype.setLanguage=function(e){this.prevStoredLanguage=e,this.input.value=e;var t=this.buttons.filter(function(t){return t.getAttribute(E)===e});if(t.length){var i=S()(t[0],this.buttons);this.activateButtonByIndex(i)}},e.prototype.destroy=function(){var e;(e=this.wrapper).parentNode&&e.parentNode.removeChild(e),this.eventEmitter.removeEventHandler("showCodeBlockLanguages",this.showLangugaeSelectBox)},e}(),T=function(){return(T=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},x=function(){function e(e,i,r,n,o){var s=this;this.node=e,this.view=i,this.getPos=r,this.eventEmitter=n,this.languages=o,this.contentDOM=null,this.languageSelectBox=null,this.onSelectLanguage=function(e){s.languageEditing&&s.changeLanguage(e)},this.onClickEditingButton=function(e){if("none"!==getComputedStyle(e.target,":after").backgroundImage&&t()(s.getPos)){var i=s.view.coordsAtPos(s.getPos());s.openLanguageSelectBox(i)}},this.finishLanguageEditing=function(){s.languageEditing&&s.reset()},this.node=e,this.view=i,this.getPos=r,this.eventEmitter=n,this.languageEditing=!1,this.languages=o,this.createElement(),this.bindDOMEvent(),this.bindEvent()}return e.prototype.createElement=function(){var e=this.node.attrs.language,t=document.createElement("div");t.setAttribute("data-language",e||"text"),h()(t,c("ww-code-block-highlighting"));var i=this.createCodeBlockElement(),r=i.firstChild;e&&(h()(i,"language-"+e),h()(r,"language-"+e)),t.appendChild(i),this.dom=t,this.contentDOM=r},e.prototype.createCodeBlockElement=function(){var e,t,i,r=document.createElement("pre"),n=document.createElement("code"),o=this.node.attrs.language,s=(t=(e=this.node.attrs).htmlAttrs,i=e.classNames,T(T({},t),{class:i?i.join(" "):null}));return o&&n.setAttribute("data-language",o),Object.keys(s).forEach(function(e){s[e]&&r.setAttribute(e,s[e])}),r.appendChild(n),r},e.prototype.bindDOMEvent=function(){this.dom&&(this.dom.addEventListener("click",this.onClickEditingButton),this.view.dom.addEventListener("mousedown",this.finishLanguageEditing),window.addEventListener("resize",this.finishLanguageEditing))},e.prototype.bindEvent=function(){this.eventEmitter.listen("selectLanguage",this.onSelectLanguage),this.eventEmitter.listen("scroll",this.finishLanguageEditing),this.eventEmitter.listen("finishLanguageEditing",this.finishLanguageEditing)},e.prototype.openLanguageSelectBox=function(e){this.languageSelectBox=new R(this.view.dom.parentElement,this.eventEmitter,this.languages),this.eventEmitter.emit("showCodeBlockLanguages",e,this.node.attrs.language),this.languageEditing=!0},e.prototype.changeLanguage=function(e){if(t()(this.getPos)){this.reset();var i=this.getPos(),r=this.view.state.tr;r.setNodeMarkup(i,null,{language:e}),this.view.dispatch(r)}},e.prototype.reset=function(){this.languageSelectBox&&(this.languageSelectBox.destroy(),this.languageSelectBox=null),this.languageEditing=!1},e.prototype.stopEvent=function(){return!0},e.prototype.update=function(e){return!!e.sameMarkup(this.node)&&(this.node=e,!0)},e.prototype.destroy=function(){this.reset(),this.dom&&(this.dom.removeEventListener("click",this.onClickEditingButton),this.view.dom.removeEventListener("mousedown",this.finishLanguageEditing),window.removeEventListener("resize",this.finishLanguageEditing)),this.eventEmitter.removeEventHandler("selectLanguage",this.onSelectLanguage),this.eventEmitter.removeEventHandler("scroll",this.finishLanguageEditing),this.eventEmitter.removeEventHandler("finishLanguageEditing",this.finishLanguageEditing)},e}();window.Prism=window.Prism||{},window.Prism.manual=!0;var M=function(e,i){if(i){var r=e.eventEmitter,n=i.highlighter;r.addEventType("showCodeBlockLanguages"),r.addEventType("selectLanguage"),r.addEventType("finishLanguageEditing");var o=n.languages,s=Object.keys(o).filter(function(e){return!t()(o[e])});return{toHTMLRenderers:{codeBlock:function(e){var t=e.fenceLength,i=e.info,r=i?i.split(/\s+/):[],o=[],s={};t>3&&(s["data-backticks"]=t);var l=e.literal;if(r.length&&r[0].length){var a=r[0];o.push("lang-"+a),s["data-language"]=a;var h=n.languages[a];h&&(l=n.highlight(e.literal,h,a))}return[{type:"openTag",tagName:"pre",classNames:o},{type:"openTag",tagName:"code",attributes:s},{type:"html",content:l},{type:"closeTag",tagName:"code"},{type:"closeTag",tagName:"pre"}]}},wysiwygPlugins:[function(){return new e.pmState.Plugin({state:{init:function(t,i){return l(i.doc,e,n)},apply:function(t,i){return t.docChanged?l(t.doc,e,n):i.map(t.mapping,t.doc)}},props:{decorations:function(e){return this.getState(e)}}})}],wysiwygNodeViews:{codeBlock:function(e,t,i,r){return new x(e,t,i,r,s)}}}}return{}}}(),e.exports=n.default}()},27226:(e,t,i)=>{"use strict";var r=i(94272),n=i(16954),o=i(71310),s=i(57580),l=i(15743),a=i(69905),h=i(6497),u=n.has,c=n.remove;e.exports=function(e){var t=r(this),i=l(e),n=o(t);return s(t)<=i.size?a(t,function(e){i.includes(e)&&c(n,e)}):h(i.getIterator(),function(e){u(n,e)&&c(n,e)}),n}},27643:(e,t,i)=>{"use strict";var r=i(80763);e.exports=function(e,t){return void 0===e?arguments.length<2?"":t:r(e)}},27704:(e,t,i)=>{"use strict";function r(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i.d(t,{C:()=>n}),i(41658),i(12252),i(20775);class n{constructor(e){r(this,"calculationTypes",[]),r(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(t=>{let[i,r]=t;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,t){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,t)})}_finalize(e){this.calculationTypes.forEach(t=>{let[,i]=t;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}},27764:(e,t,i)=>{"use strict";var r=i(40392),n=i(99365),o=i(85592),s=i(7107)("toStringTag"),l=Object,a="Arguments"===o(function(){return arguments}()),h=function(e,t){try{return e[t]}catch(e){}};e.exports=r?o:function(e){var t,i,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=h(t=l(e),s))?i:a?o(t):"Object"===(r=o(t))&&n(t.callee)?"Arguments":r}},28060:(e,t,i)=>{"use strict";var r=i(42620),n=i(53469),o=i(85592),s=function(e){return n.slice(0,e.length)===e};e.exports=s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===o(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},29239:(e,t,i)=>{"use strict";i.d(t,{c:()=>y}),i(41658);var r=i(57193),n=i(33787),o=i(75708);function s(e,t,i){l(e,t),t.set(e,i)}function l(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function a(e,t){return e.get(u(e,t))}function h(e,t,i){return e.set(u(e,t),i),i}function u(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let c=Object.freeze({CELL:"cell",MIXED:"mixed"});var d=new WeakMap,g=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakSet;class y{constructor(e){var t=this;!function(e,t){l(e,t),t.add(e)}(this,w),s(this,d,void 0),s(this,g,void 0),s(this,f,1),s(this,p,null),s(this,m,new Map);let i=e.getSettings();h(d,this,e),h(g,this,i.imeFastEdit?c.MIXED:c.CELL),a(d,this).addHook("afterUpdateSettings",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u(w,t,E).call(t,...i)}),a(d,this).addHook("afterSelection",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u(w,t,C).call(t,...i)}),a(d,this).addHook("afterSelectionFocusSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u(w,t,C).call(t,...i)}),a(d,this).addHook("afterSelectionEnd",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u(w,t,S).call(t,...i)})}getFocusMode(){return a(g,this)}setFocusMode(e){Object.values(c).includes(e)?h(g,this,e):(0,r.R8)(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return a(f,this)}setRefocusDelay(e){h(f,this,e)}setRefocusElementGetter(e){h(p,this,e)}getRefocusElement(){var e;return"function"==typeof a(p,this)?a(p,this).call(this):null===(e=a(d,this).getActiveEditor())||void 0===e?void 0:e.TEXTAREA}focusOnHighlightedCell(e){let t=e=>{var t,i;let r=null===(t=a(d,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!r)return;let o=a(d,this).runHooks("modifyFocusedElement",r.row,r.col,e);(0,n.isHTMLElement)(o)||(o=e),o&&!(null!==(i=a(d,this).getActiveEditor())&&void 0!==i&&i.isOpened())&&o.focus({preventScroll:!0})};e?t(e):u(w,this,b).call(this,e=>t(e))}refocusToEditorTextarea(){var e,t,i;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a(f,this);a(d,this).getSettings().imeFastEdit&&!(null!==(e=a(d,this).getActiveEditor())&&void 0!==e&&e.isOpened())&&(null===(t=a(d,this).getActiveEditor())||void 0===t||null===(i=t.refreshValue)||void 0===i||i.call(t),a(m,this).has(r)||a(m,this).set(r,(0,o.debounce)(()=>{if(!a(d,this).isDestroyed){var e;null===(e=this.getRefocusElement())||void 0===e||e.select()}},r)),a(m,this).get(r)())}}function b(e){var t;let i=null===(t=a(d,this).getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!i||!a(d,this).selection.isCellVisible(i)){e(null);return}let r=a(d,this).getCell(i.row,i.col,!0);null===r?a(d,this).addHookOnce("afterScroll",()=>{e(a(d,this).getCell(i.row,i.col,!0))}):e(r)}function C(){u(w,this,b).call(this,e=>{let{activeElement:t}=a(d,this).rootDocument;t&&(0,n.isOutsideInput)(t)&&t.blur(),this.focusOnHighlightedCell(e)})}function S(){u(w,this,b).call(this,e=>{this.getFocusMode()===c.MIXED&&(null==e?void 0:e.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function E(e){"boolean"==typeof e.imeFastEdit&&this.setFocusMode(e.imeFastEdit?c.MIXED:c.CELL)}},29440:(e,t,i)=>{"use strict";var r,n=i(8883),o=i(72887),s=i(66627),l=i(4389),a=i(56899),h=i(15567),u=i(37889),c="prototype",d="script",g=u("IE_PROTO"),f=function(){},p=function(e){return"<"+d+">"+e+"</"+d+">"},m=function(e){e.write(p("")),e.close();var t=e.parentWindow.Object;return e=null,t},w=function(){var e,t=h("iframe");return t.style.display="none",a.appendChild(t),t.src=String("java"+d+":"),(e=t.contentWindow.document).open(),e.write(p("document.F=Object")),e.close(),e.F},y=function(){try{r=new ActiveXObject("htmlfile")}catch(e){}y="undefined"!=typeof document?document.domain&&r?m(r):w():m(r);for(var e=s.length;e--;)delete y[c][s[e]];return y()};l[g]=!0,e.exports=Object.create||function(e,t){var i;return null!==e?(f[c]=n(e),i=new f,f[c]=null,i[g]=e):i=y(),void 0===t?i:o.f(i,t)}},29954:(e,t,i)=>{"use strict";i(67043)},30832:function(e){e.exports=function(){"use strict";var e="millisecond",t="second",i="minute",r="hour",n="week",o="month",s="quarter",l="year",a="date",h="Invalid Date",u=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,i){var r=String(e);return!r||r.length>=t?e:""+Array(t+1-r.length).join(i)+e},g="en",f={};f[g]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],i=e%100;return"["+e+(t[(i-20)%10]||t[i]||t[0])+"]"}};var p="$isDayjsObject",m=function(e){return e instanceof C||!(!e||!e[p])},w=function e(t,i,r){var n;if(!t)return g;if("string"==typeof t){var o=t.toLowerCase();f[o]&&(n=o),i&&(f[o]=i,n=o);var s=t.split("-");if(!n&&s.length>1)return e(s[0])}else{var l=t.name;f[l]=t,n=l}return!r&&n&&(g=n),n||!r&&g},y=function(e,t){if(m(e))return e.clone();var i="object"==typeof t?t:{};return i.date=e,i.args=arguments,new C(i)},b={s:d,z:function(e){var t=-e.utcOffset(),i=Math.abs(t);return(t<=0?"+":"-")+d(Math.floor(i/60),2,"0")+":"+d(i%60,2,"0")},m:function e(t,i){if(t.date()<i.date())return-e(i,t);var r=12*(i.year()-t.year())+(i.month()-t.month()),n=t.clone().add(r,o),s=i-n<0,l=t.clone().add(r+(s?-1:1),o);return+(-(r+(i-n)/(s?n-l:l-n))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(h){return({M:o,y:l,w:n,d:"day",D:a,h:r,m:i,s:t,ms:e,Q:s})[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};b.l=w,b.i=m,b.w=function(e,t){return y(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var C=function(){function d(e){this.$L=w(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[p]=!0}var g=d.prototype;return g.parse=function(e){this.$d=function(e){var t=e.date,i=e.utc;if(null===t)return new Date(NaN);if(b.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var r=t.match(u);if(r){var n=r[2]-1||0,o=(r[7]||"0").substring(0,3);return i?new Date(Date.UTC(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(t)}(e),this.init()},g.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},g.$utils=function(){return b},g.isValid=function(){return this.$d.toString()!==h},g.isSame=function(e,t){var i=y(e);return this.startOf(t)<=i&&i<=this.endOf(t)},g.isAfter=function(e,t){return y(e)<this.startOf(t)},g.isBefore=function(e,t){return this.endOf(t)<y(e)},g.$g=function(e,t,i){return b.u(e)?this[t]:this.set(i,e)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(e,s){var h=this,u=!!b.u(s)||s,c=b.p(e),d=function(e,t){var i=b.w(h.$u?Date.UTC(h.$y,t,e):new Date(h.$y,t,e),h);return u?i:i.endOf("day")},g=function(e,t){return b.w(h.toDate()[e].apply(h.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(t)),h)},f=this.$W,p=this.$M,m=this.$D,w="set"+(this.$u?"UTC":"");switch(c){case l:return u?d(1,0):d(31,11);case o:return u?d(1,p):d(0,p+1);case n:var y=this.$locale().weekStart||0,C=(f<y?f+7:f)-y;return d(u?m-C:m+(6-C),p);case"day":case a:return g(w+"Hours",0);case r:return g(w+"Minutes",1);case i:return g(w+"Seconds",2);case t:return g(w+"Milliseconds",3);default:return this.clone()}},g.endOf=function(e){return this.startOf(e,!1)},g.$set=function(n,s){var h,u=b.p(n),c="set"+(this.$u?"UTC":""),d=((h={}).day=c+"Date",h[a]=c+"Date",h[o]=c+"Month",h[l]=c+"FullYear",h[r]=c+"Hours",h[i]=c+"Minutes",h[t]=c+"Seconds",h[e]=c+"Milliseconds",h)[u],g="day"===u?this.$D+(s-this.$W):s;if(u===o||u===l){var f=this.clone().set(a,1);f.$d[d](g),f.init(),this.$d=f.set(a,Math.min(this.$D,f.daysInMonth())).$d}else d&&this.$d[d](g);return this.init(),this},g.set=function(e,t){return this.clone().$set(e,t)},g.get=function(e){return this[b.p(e)]()},g.add=function(e,s){var a,h=this;e=Number(e);var u=b.p(s),c=function(t){var i=y(h);return b.w(i.date(i.date()+Math.round(t*e)),h)};if(u===o)return this.set(o,this.$M+e);if(u===l)return this.set(l,this.$y+e);if("day"===u)return c(1);if(u===n)return c(7);var d=((a={})[i]=6e4,a[r]=36e5,a[t]=1e3,a)[u]||1,g=this.$d.getTime()+e*d;return b.w(g,this)},g.subtract=function(e,t){return this.add(-1*e,t)},g.format=function(e){var t=this,i=this.$locale();if(!this.isValid())return i.invalidDate||h;var r=e||"YYYY-MM-DDTHH:mm:ssZ",n=b.z(this),o=this.$H,s=this.$m,l=this.$M,a=i.weekdays,u=i.months,d=i.meridiem,g=function(e,i,n,o){return e&&(e[i]||e(t,r))||n[i].slice(0,o)},f=function(e){return b.s(o%12||12,e,"0")},p=d||function(e,t,i){var r=e<12?"AM":"PM";return i?r.toLowerCase():r};return r.replace(c,function(e,r){return r||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return b.s(t.$y,4,"0");case"M":return l+1;case"MM":return b.s(l+1,2,"0");case"MMM":return g(i.monthsShort,l,u,3);case"MMMM":return g(u,l);case"D":return t.$D;case"DD":return b.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return g(i.weekdaysMin,t.$W,a,2);case"ddd":return g(i.weekdaysShort,t.$W,a,3);case"dddd":return a[t.$W];case"H":return String(o);case"HH":return b.s(o,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return p(o,s,!0);case"A":return p(o,s,!1);case"m":return String(s);case"mm":return b.s(s,2,"0");case"s":return String(t.$s);case"ss":return b.s(t.$s,2,"0");case"SSS":return b.s(t.$ms,3,"0");case"Z":return n}return null}(e)||n.replace(":","")})},g.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},g.diff=function(e,a,h){var u,c=this,d=b.p(a),g=y(e),f=(g.utcOffset()-this.utcOffset())*6e4,p=this-g,m=function(){return b.m(c,g)};switch(d){case l:u=m()/12;break;case o:u=m();break;case s:u=m()/3;break;case n:u=(p-f)/6048e5;break;case"day":u=(p-f)/864e5;break;case r:u=p/36e5;break;case i:u=p/6e4;break;case t:u=p/1e3;break;default:u=p}return h?u:b.a(u)},g.daysInMonth=function(){return this.endOf(o).$D},g.$locale=function(){return f[this.$L]},g.locale=function(e,t){if(!e)return this.$L;var i=this.clone(),r=w(e,t,!0);return r&&(i.$L=r),i},g.clone=function(){return b.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},d}(),S=C.prototype;return y.prototype=S,[["$ms",e],["$s",t],["$m",i],["$H",r],["$W","day"],["$M",o],["$y",l],["$D",a]].forEach(function(e){S[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),y.extend=function(e,t){return e.$i||(e(t,C,y),e.$i=!0),y},y.locale=w,y.isDayjs=m,y.unix=function(e){return y(1e3*e)},y.en=f[g],y.Ls=f,y.p={},y}()},31338:(e,t,i)=>{"use strict";var r=i(67297),n=i(29440),o=i(24201),s=i(42001),l=i(7107),a=i(82831),h=i(38896),u=i(66163).IteratorPrototype,c=i(91337),d=i(76093),g=i(65911),f=l("toStringTag"),p="IteratorHelper",m="WrapForValidIterator",w="normal",y="throw",b=a.set,C=function(e){var t=a.getterFor(e?m:p);return s(n(u),{next:function(){var i=t(this);if(e)return i.nextHandler();if(i.done)return c(void 0,!0);try{var r=i.nextHandler();return i.returnHandlerResult?r:c(r,i.done)}catch(e){throw i.done=!0,e}},return:function(){var i=t(this),n=i.iterator;if(i.done=!0,e){var o=h(n,"return");return o?r(o,n):c(void 0,!0)}if(i.inner)try{d(i.inner.iterator,w)}catch(e){return d(n,y,e)}if(i.openIters)try{g(i.openIters,w)}catch(e){return d(n,y,e)}return n&&d(n,w),c(void 0,!0)}})},S=C(!0),E=C(!1);o(E,f,"Iterator Helper"),e.exports=function(e,t,i){var r=function(r,n){n?(n.iterator=r.iterator,n.next=r.next):n=r,n.type=t?m:p,n.returnHandlerResult=!!i,n.nextHandler=e,n.counter=0,n.done=!1,b(this,n)};return r.prototype=t?S:E,r}},32138:e=>{"use strict";e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},32730:(e,t,i)=>{"use strict";var r=i(42665),n=Math.min;e.exports=function(e){var t=r(e);return t>0?n(t,0x1fffffffffffff):0}},32886:(e,t,i)=>{"use strict";i.d(t,{J:()=>n});var r=i(33787);function n(e){let{classNames:t}=(0,r.findFirstParentWithClass)(e,/ht-theme-[a-zA-Z0-9_-]+/);return t.pop()}},33325:(e,t,i)=>{"use strict";var r=i(16604),n=Object;e.exports=function(e){return n(r(e))}},33773:(e,t,i)=>{"use strict";i.d(t,{b7:()=>u,_T:()=>h}),i(41658);var r=i(78887),n=i(19857);i(19398);var o=i(95061);let s={_hooksStorage:Object.create(null),addHook(e,t){return this._hooksStorage[e]||(this._hooksStorage[e]=[]),this.hot.addHook(e,t),this._hooksStorage[e].push(t),this},removeHooksByKey(e){(0,o.arrayEach)(this._hooksStorage[e]||[],t=>{this.hot.removeHook(e,t)})},clearHooks(){(0,n.objectEach)(this._hooksStorage,(e,t)=>this.removeHooksByKey(t)),this._hooksStorage={}}};(0,n.defineGetter)(s,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var l=i(33787);function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let h=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class u{static get EDITOR_TYPE(){return"base"}constructor(e){a(this,"hot",void 0),a(this,"state",h.VIRGIN),a(this,"_opened",!1),a(this,"_fullEditMode",!1),a(this,"_closeCallback",null),a(this,"TD",null),a(this,"row",null),a(this,"col",null),a(this,"prop",null),a(this,"originalValue",null),a(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,t,i,r,n,o){this.TD=r,this.row=e,this.col=t,this.prop=i,this.originalValue=n,this.cellProperties=o,this.state=this.isOpened()?this.state:h.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,t){let i,r,n,o;if(t){let e=this.hot.getSelectedLast();i=Math.max(Math.min(e[0],e[2]),0),r=Math.max(Math.min(e[1],e[3]),0),n=Math.max(e[0],e[2]),o=Math.max(e[1],e[3])}else[i,r,n,o]=[this.row,this.col,null,null];let s=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(s)&&([i,r]=s),this.hot.populateFromArray(i,r,e,n,o,"edit")}beginEditing(e,t){if(this.state!==h.VIRGIN)return;let i=this.hot,n=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=h.EDITING,this.isInFullEditMode()){let t="string"==typeof e?e:(0,r.stringify)(this.originalValue);this.setValue(t)}this.open(t),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),i.view.scrollViewport(i._createCellCoords(n,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(e,t,i){let r;if(i){let e=this._closeCallback;this._closeCallback=t=>{e&&e(t),i(t),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===h.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===h.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}let i=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof i?String.prototype.trim.call(i||""):i]]:[[i]],this.state=h.WAITING,this.saveValue(r,t),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",e=>{this.state=h.FINISHED,this.discardEditor(e)}):(this.state=h.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=h.FINISHED,this.discardEditor()}discardEditor(e){this.state===h.FINISHED&&(!1===e&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=h.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=h.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===h.WAITING}getEditedCellRect(){var e;let t=this.getEditedCell();if(!t)return;let{wtOverlays:i,wtViewport:r}=this.hot.view._wt,n=this.hot.rootWindow,o=(0,l.offset)(t),s=(0,l.outerWidth)(t),a=(0,l.offset)(this.hot.rootElement),h=(0,l.outerWidth)(this.hot.rootElement),u=i.topOverlay.holder,c=i.inlineStartOverlay.holder,d=u!==n?u.scrollTop:0,g=c!==n?c.scrollLeft:0,f=n.innerWidth-a.left-h,{wtTable:p}=null!==(e=i.getParentOverlay(t))&&void 0!==e?e:this.hot.view._wt,m=p.name,w=["master","inline_start"].includes(m)?d:0,y=["master","top","bottom"].includes(m)?g:0,b=+(o.top!==a.top),C=o.top-a.top-b-w,S=0;S=this.hot.isRtl()?n.innerWidth-o.left-s-f-1+y:o.left-a.left-1-y,["top","top_inline_start_corner"].includes(m)&&(C+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(S+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));let E=this.hot.hasColHeaders(),R=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),T=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),x=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&R<=0||R===x)&&(C+=1),T<=0&&(S+=1);let M=r.rowsRenderCalculator.startPosition,O=r.columnsRenderCalculator.startPosition,k=Math.abs(i.inlineStartOverlay.getScrollPosition()),I=i.topOverlay.getScrollPosition(),A=(0,l.getScrollbarWidth)(this.hot.rootDocument),N=t.offsetTop;if(["inline_start","master"].includes(m)&&(N+=M-I),["bottom","bottom_inline_start_corner"].includes(m)){let{wtViewport:e,wtTable:t}=i.bottomOverlay.clone;N+=e.getWorkspaceHeight()-t.getHeight()-A}let H=t.offsetLeft;this.hot.isRtl()?H=(H>=0?p.getWidth()-t.offsetLeft:Math.abs(H))+(O-k-s):["top","master","bottom"].includes(m)&&(H+=O-k);let P=n.getComputedStyle(this.TD),_=parseInt(P[this.hot.isRtl()?"borderRightWidth":"borderLeftWidth"],10)>0?0:1,L=parseInt(P.borderTopWidth,10)>0?0:1,D=(0,l.outerWidth)(t)+_,F=(0,l.outerHeight)(t)+L,V=(0,l.hasVerticalScrollbar)(u)?A:0,W=(0,l.hasHorizontalScrollbar)(c)?A:0,B=this.hot.view.maximumVisibleElementWidth(H)-V+_;return{top:C,start:S,height:F,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(N)-W+L,this.hot.view.getDefaultRowHeight()),width:D,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let e=this.hot.countRows(),t="";return this.row<this.hot.getSettings().fixedRowsTop?t=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?t=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(t="inline-start"),t}}(0,n.mixin)(u,s)},33774:(e,t,i)=>{"use strict";i.d(t,{H:()=>o,N:()=>n});var r=i(95061);function n(e,t,i){return[...e.slice(0,t),...i,...e.slice(t)]}function o(e,t){return(0,r.arrayFilter)(e,e=>!1===t.includes(e))}},33787:(e,t,i)=>{"use strict";let r;i.r(t),i.d(t,{HTML_CHARACTERS:()=>x,addClass:()=>C,addEvent:()=>$,clearTextSelection:()=>q,closest:()=>c,closestDown:()=>d,empty:()=>T,fastInnerHTML:()=>M,fastInnerText:()=>O,findFirstParentWithClass:()=>g,getCaretPosition:()=>Y,getCssTransform:()=>ei,getFrameElement:()=>a,getMaximumScrollLeft:()=>D,getMaximumScrollTop:()=>L,getParent:()=>s,getParentWindow:()=>h,getScrollLeft:()=>P,getScrollTop:()=>H,getScrollableElement:()=>_,getScrollbarWidth:()=>Z,getSelectionEndPosition:()=>K,getSelectionText:()=>X,getStyle:()=>V,getTrimmingContainer:()=>F,getWindowScrollLeft:()=>N,getWindowScrollTop:()=>A,hasAccessToParentWindow:()=>u,hasClass:()=>b,hasHorizontalScrollbar:()=>ee,hasVerticalScrollbar:()=>Q,hasZeroHeight:()=>k,index:()=>p,innerHeight:()=>z,innerWidth:()=>U,isChildOf:()=>f,isDetached:()=>el,isHTMLElement:()=>ed,isInput:()=>en,isInternalElement:()=>l,isOutsideInput:()=>eo,isVisible:()=>function e(t){let i=t.ownerDocument.documentElement,r=t.ownerDocument.defaultView,n=t;for(;n!==i;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(!n.host)return!1;else{if(n.host.impl)return e(n.host.impl);if(n.host)return e(n.host);throw Error("Lost in Web Components world")}if("none"===r.getComputedStyle(n).display)return!1;n=n.parentNode}return!0},makeElementContentEditableAndSelectItsContent:()=>eh,matchesCSSRules:()=>W,observeVisibilityChangeOnce:()=>ea,offset:()=>I,outerHeight:()=>j,outerWidth:()=>B,overlayContainsElement:()=>m,removeAttribute:()=>R,removeClass:()=>S,removeContentEditableFromElementAndDeselect:()=>eu,removeEvent:()=>G,removeTextNodes:()=>function e(t){if(3===t.nodeType)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){let i=t.childNodes;for(let t=i.length-1;t>=0;t--)e(i[t])}},resetCssTransform:()=>er,runWithSelectedContendEditableElement:()=>ec,selectElementIfAllowed:()=>es,setAttribute:()=>E,setCaretPosition:()=>J,setOverlayPosition:()=>et}),i(41658),i(19398),i(12252),i(29954),i(20775);var n=i(93924),o=i(91748);function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=-1,r=null,n=e;for(;null!==n;){if(i===t){r=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(i+=1,n=n.parentNode)}return r}function l(e,t){let i=e.closest(".handsontable");return!!i&&(i.parentNode===t||i===t)}function a(e){return Object.getPrototypeOf(e.parent)&&e.frameElement}function h(e){return a(e)&&e.parent}function u(e){return!!Object.getPrototypeOf(e.parent)}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:n}=Node,o=e;for(;null!=o&&o!==i;){let{nodeType:e,nodeName:i}=o;if(e===r&&(t.includes(i)||t.includes(o)))return o;let{host:s}=o;o=s&&e===n?s:o.parentNode}return null}function d(e,t,i){let r=[],n=e;for(;n&&(n=c(n,t,i))&&(!i||i.contains(n));)r.push(n),n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode;let o=r.length;return o?r[o-1]:null}function g(e,t){let i={element:void 0,classNames:[]},r=e;for(;null!==r&&r!==e.ownerDocument.documentElement&&!i.element;){if("string"==typeof t&&r.classList.contains(t))i.element=r,i.classNames.push(t);else if(t instanceof RegExp){let e=Array.from(r.classList).filter(e=>t.test(e));e.length&&(i.element=r,i.classNames.push(...e))}r=r.parentElement}return i}function f(e,t){let i=e.parentNode,r=[];for("string"==typeof t?r=e.defaultView?Array.prototype.slice.call(e.querySelectorAll(t),0):Array.prototype.slice.call(e.ownerDocument.querySelectorAll(t),0):r.push(t);null!==i;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function p(e){let t=0,i=e;if(i.previousSibling)for(;i=i.previousSibling;)t+=1;return t}function m(e,t,i){let r=i.parentElement.querySelector(`.ht_clone_${e}`);return r?r.contains(t):null}function w(e){return e&&e.length?e.filter(e=>!!e):[]}function y(e,t){if(!e||!e.length)return t?{regexFree:[],regexes:[]}:[];let i=[],r=[];return r.push(...e.filter(e=>{let r=e instanceof RegExp;return r&&t&&i.push(e),!r})),t?{regexFree:r,regexes:i}:r}function b(e,t){return void 0!==e.classList&&"string"==typeof t&&""!==t&&e.classList.contains(t)}function C(e,t){"string"==typeof t&&(t=t.split(" ")),(t=w(t)).length>0&&e.classList.add(...t)}function S(e,t){"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:i,regexes:r}=y(t,!0);(i=w(i)).length>0&&e.classList.remove(...i),r.forEach(t=>{e.classList.forEach(i=>{t.test(i)&&e.classList.remove(i)})})}function E(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;Array.isArray(t)||(t=[[t,i]]),t.forEach(t=>{Array.isArray(t)&&""!==t[0]&&e.setAttribute(...t)})}function R(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof t?t=t.split(" "):t instanceof RegExp&&(t=[t]);let{regexFree:i,regexes:r}=y(t,!0);i.forEach(t=>{""!==t&&e.removeAttribute(t)}),r.forEach(t=>{e.getAttributeNames().forEach(i=>{t.test(i)&&e.removeAttribute(i)})})}function T(e){let t;for(;t=e.lastChild;)e.removeChild(t)}let x=/(<(.*)>|&(.*);)/;function M(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];x.test(t)?e.innerHTML=i?(0,n.sanitize)(t):t:O(e,t)}function O(e,t){let i=e.firstChild;i&&3===i.nodeType&&null===i.nextSibling?i.textContent=t:(T(e),e.appendChild(e.ownerDocument.createTextNode(t)))}function k(e){let t=e.ownerDocument.defaultView,i=e;for(;i.parentNode;){if("0px"===i.style.height||"0"===i.style.height)return"hidden"===t.getComputedStyle(i).overflow;i=i.parentNode}return!1}function I(e){let t,i,r,n=e.ownerDocument,o=n.defaultView,s=n.documentElement,l=e;for(t=l.offsetLeft,i=l.offsetTop,r=l;(l=l.offsetParent)&&l!==n.body&&"offsetLeft"in l;)t+=l.offsetLeft,i+=l.offsetTop,r=l;return r&&"fixed"===r.style.position&&(t+=o.pageXOffset||s.scrollLeft,i+=o.pageYOffset||s.scrollTop),{left:t,top:i}}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return e.scrollY}function N(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return e.scrollX}function H(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?A(t):e.scrollTop}function P(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e===t?N(t):e.scrollLeft}function _(e){let t=e.ownerDocument,i=t?t.defaultView:void 0;t||(i=(t=e.document?e.document:e).defaultView);let r=["auto","scroll"],n=e.parentNode;for(;n&&n.style&&t.body!==n;){let{overflow:e,overflowX:t,overflowY:o}=n.style;if([e,t,o].includes("scroll")||({overflow:e,overflowX:t,overflowY:o}=i.getComputedStyle(n),r.includes(e)||r.includes(t)||r.includes(o))||n.clientHeight<=n.scrollHeight+1&&(r.includes(o)||r.includes(e))||n.clientWidth<=n.scrollWidth+1&&(r.includes(t)||r.includes(e)))return n;n=n.parentNode}return i}function L(e){return e.scrollHeight-e.clientHeight}function D(e){return e.scrollWidth-e.clientWidth}function F(e){let t=e.ownerDocument,i=t.defaultView,r=e.parentNode;for(;r&&r.style&&t.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;let e=i.getComputedStyle(r),t=["scroll","hidden","auto"],n=e.getPropertyValue("overflow"),o=e.getPropertyValue("overflow-y"),s=e.getPropertyValue("overflow-x");if(t.includes(n)||t.includes(o)||t.includes(s))return r;r=r.parentNode}return i}function V(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!e)return;if(e===i)return"width"===t?`${i.innerWidth}px`:"height"===t?`${i.innerHeight}px`:void 0;let r=e.style[t];if(""!==r&&void 0!==r)return r;let n=i.getComputedStyle(e);if(""!==n[t]&&void 0!==n[t])return n[t]}function W(e,t){let{selectorText:i}=t,r=!1;return t.type===CSSRule.STYLE_RULE&&i&&(e.msMatchesSelector?r=e.msMatchesSelector(i):e.matches&&(r=e.matches(i))),r}function B(e){return e.offsetWidth}function j(e){return e.offsetHeight}function z(e){return e.clientHeight||e.innerHeight}function U(e){return e.clientWidth||e.innerWidth}function $(e,t,i){e.addEventListener(t,i,!1)}function G(e,t,i){e.removeEventListener(t,i,!1)}function Y(e){return e.selectionStart?e.selectionStart:0}function K(e){return e.selectionEnd?e.selectionEnd:0}function X(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,t=e.document,i="";return e.getSelection?i=e.getSelection().toString():t.selection&&"Control"!==t.selection.type&&(i=t.selection.createRange().text),i}function q(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;e.getSelection&&(e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges())}function J(e,t,i){if(void 0===i&&(i=t),e.setSelectionRange){e.focus();try{e.setSelectionRange(t,i)}catch(o){let r=e.parentNode,n=r.style.display;r.style.display="block",e.setSelectionRange(t,i),r.style.display=n}}}function Z(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===r&&(r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=e.createElement("div");t.style.height="200px",t.style.width="100%";let i=e.createElement("div");i.style.boxSizing="content-box",i.style.height="150px",i.style.left="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.width="200px",i.style.visibility="hidden",i.appendChild(t),(e.body||e.documentElement).appendChild(i);let r=t.offsetWidth;i.style.overflow="scroll";let n=t.offsetWidth;return r===n&&(n=i.clientWidth),(e.body||e.documentElement).removeChild(i),r-n}(e)),r}function Q(e){return e instanceof Window?e.document.body.scrollHeight>e.innerHeight:e.offsetWidth!==e.clientWidth}function ee(e){return e instanceof Window?e.document.body.scrollWidth>e.innerWidth:e.offsetHeight!==e.clientHeight}function et(e,t,i){e.style.transform=`translate3d(${t},${i},0)`}function ei(e){let t;return e.style.transform&&""!==(t=e.style.transform)?["transform",t]:-1}function er(e){e.style.transform&&""!==e.style.transform&&(e.style.transform="")}function en(e){return e&&(["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1||"true"===e.contentEditable)}function eo(e){return en(e)&&!1===e.hasAttribute("data-hot-input")}function es(e){eo(e.ownerDocument.activeElement)||e.select()}function el(e){return!e.parentNode}function ea(e,t){new IntersectionObserver((i,r)=>{i.forEach(i=>{i.isIntersecting&&null!==e.offsetParent&&(t(),r.unobserve(e))})},{root:e.ownerDocument.body}).observe(e)}function eh(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e.ownerDocument,n=r.createRange(),s=r.defaultView.getSelection();E(e,"contenteditable",!0),i&&E(e,...(0,o.MG)()),t&&C(e,"invisibleSelection"),n.selectNodeContents(e),s.removeAllRanges(),s.addRange(n)}function eu(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=e.ownerDocument.defaultView.getSelection();e.hasAttribute("aria-hidden")&&e.removeAttribute("aria-hidden"),i.removeAllRanges(),t&&S(e,"invisibleSelection"),e.removeAttribute("contenteditable")}function ec(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];eh(e,i),t(),eu(e,i)}function ed(e){var t;let i=null==e||null===(t=e.ownerDocument)||void 0===t?void 0:t.defaultView.Element;return!!(i&&null!==i&&e instanceof i)}},33920:(e,t,i)=>{"use strict";i.d(t,{s:()=>R}),i(41658);var r=i(89658),n=i(13115);i(19398),i(12252),i(29954),i(20775),i(85522);let o=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),s=e=>e.map(e=>{let t=e.toLowerCase();return o.has(t)?o.get(t):t}).sort().join("+"),l=e=>e.split("+"),a=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),h=e=>{let{which:t,key:i}=e;if(a.has(t))return a.get(t);let r=String.fromCharCode(t).toLowerCase();return/^[a-z0-9]$/.test(r)?r:i.toLowerCase()};var u=i(78887),c=i(75708),d=i(19857),g=i(83457);let f=Symbol("shortcut-context");function p(e){return(0,d.isObject)(e)&&e.__kindOf===f}let m=e=>{let t=(0,r.u)({errorIdExists:t=>`The "${t}" shortcut is already registered in the "${e}" context.`}),i=function(){let{keys:e,callback:i,group:r,runOnlyIf:n=()=>!0,captureCtrl:o=!1,preventDefault:l=!0,stopPropagation:a=!1,relativeToGroup:h,position:d,forwardToContext:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,u.isUndefined)(r))throw Error("You need to define the shortcut's group.");if(!1===(0,c.isFunction)(i))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(e))throw Error((0,g.O)`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let m={callback:i,group:r,runOnlyIf:n,captureCtrl:o,preventDefault:l,stopPropagation:a};(0,u.isDefined)(h)&&(m.relativeToGroup=h,m.position=d),p(f)&&(m.forwardToContext=f),e.forEach(e=>{let i=s(e);if(t.hasItem(i)){let e=t.getItem(i),r=e.findIndex(e=>e.group===h);-1!==r?"before"===d?r-=1:r+=1:r=e.length,e.splice(r,0,m)}else t.addItem(i,[m])})},n=e=>{let i=s(e);t.removeItem(i)};return{__kindOf:f,addShortcut:i,addShortcuts:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.forEach(e=>{(0,d.objectEach)(t,(i,r)=>{!1===Object.prototype.hasOwnProperty.call(e,r)&&(e[r]=t[r])}),i(e)})},getShortcuts:e=>{let i=s(e),r=t.getItem(i);return(0,u.isDefined)(r)?r.slice():[]},hasShortcut:e=>{let i=s(e);return t.hasItem(i)},removeShortcutsByKeys:n,removeShortcutsByGroup:e=>{t.getItems().forEach(t=>{let[i,r]=t,o=r.filter(t=>t.group!==e);0===o.length?n(l(i)):(r.length=0,r.push(...o))})}}};i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var w=i(33787),y=i(59594);let b=["meta","alt","shift","control"],C=function(){let e=new Set;return{press(t){e.add(t)},release(t){e.delete(t)},releaseAll(){e.clear()},isPressed:t=>e.has(t)}}(),S=[],E=0,R=e=>{let{ownerWindow:t,handleEvent:i,beforeKeyDown:o,afterKeyDown:s}=e,l=(0,r.u)({errorIdExists:e=>`The "${e}" context name is already registered.`}),a="grid",u=()=>a,c=e=>l.getItem(e),d=!1,f=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u(),r=p(i)?i:c(i),o=!1;if(!r.hasShortcut(t))return o;let s=r.getShortcuts(t);for(let i=0;i<s.length;i++){let{callback:r,runOnlyIf:l,preventDefault:a,stopPropagation:h,captureCtrl:u,forwardToContext:c}=s[i];if(!0===l(e)){if(d=u,o=!1===r(e,t),d=!1,a&&e.preventDefault(),h&&((0,n.stopImmediatePropagation)(e),e.stopPropagation()),o)break;c&&f(e,t,c)}}return o},R=function(e,t,i,r,o){let s=e=>b.includes(e),l=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];return e.altKey&&i.push("alt"),t&&(e.ctrlKey||e.metaKey)?i.push("control/meta"):(e.ctrlKey&&i.push("control"),e.metaKey&&i.push("meta")),e.shiftKey&&i.push("shift"),i},a=e=>{if(!1===t(e)||!1===i(e)||229===e.keyCode||"string"!=typeof e.key||(0,n.isImmediatePropagationStopped)(e))return;let a=h(e),u=[];s(a)||(u=l(e)),!o(e,[a].concat(u))&&((0,y.isMacOS)()&&u.includes("meta")||!(0,y.isMacOS)()&&u.includes("control"))&&o(e,[a].concat(l(e,!0))),r(e)},u=e=>{if("string"==typeof e.key){let t=h(e);s(t)&&C.press(t)}},c=e=>{if("string"==typeof e.key){let t=h(e);s(t)&&C.release(t)}},d=()=>{C.releaseAll()};return{mount:()=>{let t=e;for(E+=1;t;)1===E&&(t.document.documentElement.addEventListener("keydown",u),S.push({event:"keydown",listener:u}),t.document.documentElement.addEventListener("keyup",c),S.push({event:"keyup",listener:c})),t.document.documentElement.addEventListener("keydown",a),t.document.documentElement.addEventListener("blur",d),t=(0,w.getParentWindow)(t)},unmount:()=>{let t=e;for(E-=1;t;){if(0===E){for(let e=0;e<S.length;e++){let{event:i,listener:r}=S[e];t.document.documentElement.removeEventListener(i,r)}S.length=0}t.document.documentElement.removeEventListener("keydown",a),t.document.documentElement.removeEventListener("blur",d),t=(0,w.getParentWindow)(t)}},isPressed:e=>C.isPressed(e),releasePressedKeys:()=>C.releaseAll()}}(t,i,o,s,f);return R.mount(),{addContext:e=>{let t=m(e);return l.addItem(e,t),t},getActiveContextName:u,getContext:c,setActiveContextName:e=>{if(!l.hasItem(e))throw Error((0,g.O)`You've tried to activate the "${e}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=e},isCtrlPressed:()=>!d&&(R.isPressed("control")||R.isPressed("meta")),releasePressedKeys:()=>R.releasePressedKeys(),destroy:()=>R.unmount()}}},34175:(e,t,i)=>{"use strict";var r=i(56963),n=i(32138);e.exports=!r(function(){var e=Error("a");return!("stack"in e)||(Object.defineProperty(e,"stack",n(1,7)),7!==e.stack)})},34323:(e,t,i)=>{"use strict";var r=i(93840),n=i(56963),o=i(99365),s=i(95467),l=i(14412),a=i(58958).CONFIGURABLE,h=i(72132),u=i(82831),c=u.enforce,d=u.get,g=String,f=Object.defineProperty,p=r("".slice),m=r("".replace),w=r([].join),y=l&&!n(function(){return 8!==f(function(){},"length",{value:8}).length}),b=String(String).split("String"),C=e.exports=function(e,t,i){"Symbol("===p(g(t),0,7)&&(t="["+m(g(t),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(t="get "+t),i&&i.setter&&(t="set "+t),(!s(e,"name")||a&&e.name!==t)&&(l?f(e,"name",{value:t,configurable:!0}):e.name=t),y&&i&&s(i,"arity")&&e.length!==i.arity&&f(e,"length",{value:i.arity});try{i&&s(i,"constructor")&&i.constructor?l&&f(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch(e){}var r=c(e);return s(r,"source")||(r.source=w(b,"string"==typeof t?t:"")),e};Function.prototype.toString=C(function(){return o(this)&&d(this).source||h(this)},"toString")},34498:(e,t,i)=>{"use strict";var r=i(53469);e.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},34760:(e,t,i)=>{"use strict";i(93277)},34988:(e,t,i)=>{"use strict";var r=i(99365),n=i(24851),o=i(34323),s=i(7687);e.exports=function(e,t,i,l){l||(l={});var a=l.enumerable,h=void 0!==l.name?l.name:t;if(r(i)&&o(i,h,l),l.global)a?e[t]=i:s(t,i);else{try{l.unsafe?e[t]&&(a=!0):delete e[t]}catch(e){}a?e[t]=i:n.f(e,t,{value:i,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return e}},35889:(e,t,i)=>{"use strict";var r=i(93840),n=i(56963),o=i(85592),s=Object,l=r("".split);e.exports=n(function(){return!s("z").propertyIsEnumerable(0)})?function(e){return"String"===o(e)?l(e,""):s(e)}:s},36096:(e,t,i)=>{"use strict";var r=i(16569),n=String,o=TypeError;e.exports=function(e){if(r(e))return e;throw new o("Can't set "+n(e)+" as a prototype")}},36425:(e,t,i)=>{"use strict";i.d(t,{JP:()=>o,K5:()=>s,Wz:()=>n,yn:()=>l});let r=new WeakMap,n=Symbol("rootInstance");function o(e){r.set(e,!0)}function s(e){return e===n}function l(e){return r.has(e)}},37e3:(e,t,i)=>{"use strict";var r=i(95467),n=i(9329),o=i(64897),s=i(24851);e.exports=function(e,t,i){for(var l=n(t),a=s.f,h=o.f,u=0;u<l.length;u++){var c=l[u];r(e,c)||i&&r(i,c)||a(e,c,h(t,c))}}},37412:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("every",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(e){l(this);try{s(e)}catch(e){h(this,"throw",e)}if(u)return n(u,this,e);var t=a(this),i=0;return!o(t,function(t,r){if(!e(t,i++))return r()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},37889:(e,t,i)=>{"use strict";var r=i(87699),n=i(39584),o=r("keys");e.exports=function(e){return o[e]||(o[e]=n(e))}},38516:(e,t,i)=>{"use strict";var r=i(67297),n=i(8883),o=i(7475),s=i(95283);e.exports=function(e,t){t&&"string"==typeof e||n(e);var i=s(e);return o(n(void 0!==i?r(i,e):e))}},38896:(e,t,i)=>{"use strict";var r=i(50320),n=i(56135);e.exports=function(e,t){var i=e[t];return n(i)?void 0:r(i)}},39584:(e,t,i)=>{"use strict";var r=i(93840),n=0,o=Math.random(),s=r(1.1.toString);e.exports=function(e){return"Symbol("+(void 0===e?"":e)+")_"+s(++n+o,36)}},39615:(e,t,i)=>{"use strict";var r=i(7411),n=TypeError;e.exports=function(e,t){if(r(t,e))return e;throw new n("Incorrect invocation")}},40392:(e,t,i)=>{"use strict";var r=i(7107)("toStringTag"),n={};n[r]="z",e.exports="[object z]"===String(n)},40949:(e,t,i)=>{"use strict";var r=i(93840),n=Error,o=r("".replace),s=String(new n("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,a=l.test(s);e.exports=function(e,t){if(a&&"string"==typeof e&&!n.prepareStackTrace)for(;t--;)e=o(e,l,"");return e}},41312:(e,t,i)=>{"use strict";var r=i(94272),n=i(57580),o=i(69905),s=i(15743);e.exports=function(e){var t=r(this),i=s(e);return!(n(t)>i.size)&&!1!==o(t,function(e){if(!i.includes(e))return!1},!0)}},41658:(e,t,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(62495),s=i(15625),l="WebAssembly",a=n[l],h=7!==Error("e",{cause:7}).cause,u=function(e,t){var i={};i[e]=s(e,t,h),r({global:!0,constructor:!0,arity:1,forced:h},i)},c=function(e,t){if(a&&a[e]){var i={};i[e]=s(l+"."+e,t,h),r({target:l,stat:!0,constructor:!0,arity:1,forced:h},i)}};u("Error",function(e){return function(t){return o(e,this,arguments)}}),u("EvalError",function(e){return function(t){return o(e,this,arguments)}}),u("RangeError",function(e){return function(t){return o(e,this,arguments)}}),u("ReferenceError",function(e){return function(t){return o(e,this,arguments)}}),u("SyntaxError",function(e){return function(t){return o(e,this,arguments)}}),u("TypeError",function(e){return function(t){return o(e,this,arguments)}}),u("URIError",function(e){return function(t){return o(e,this,arguments)}}),c("CompileError",function(e){return function(t){return o(e,this,arguments)}}),c("LinkError",function(e){return function(t){return o(e,this,arguments)}}),c("RuntimeError",function(e){return function(t){return o(e,this,arguments)}})},41973:(e,t,i)=>{"use strict";i.d(t,{o:()=>a,p:()=>l}),i(41658),i(12252),i(20775);var r=i(78887),n=i(19857),o=i(81174);let s=0;class l{constructor(){!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"collection",new Map)}register(e,t){!1===this.collection.has(e)&&(this.collection.set(e,t),t.addLocalHook("change",()=>this.runLocalHooks("change",t)),s+=1)}unregister(e){let t=this.collection.get(e);(0,r.isDefined)(t)&&(t.destroy(),this.collection.delete(e),this.runLocalHooks("change",t),s-=1)}unregisterAll(){this.collection.forEach((e,t)=>this.unregister(t)),this.collection.clear()}get(e){return(0,r.isUndefined)(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(t=>{t.remove(e)})}insertToEvery(e,t){this.collection.forEach(i=>{i.insert(e,t)})}initEvery(e){this.collection.forEach(t=>{t.init(e)})}}function a(){return s}(0,n.mixin)(l,o.A)},42001:(e,t,i)=>{"use strict";var r=i(34988);e.exports=function(e,t,i){for(var n in t)r(e,n,t[n],i);return e}},42220:(e,t,i)=>{"use strict";i.d(t,{Ay:()=>wF});var r,n,o,s,l,a={};i.r(a),i.d(a,{getNormalizedDate:()=>ti});var h=i(52763),u=i(36425),c=i(5322),d=i(16880),g=i(24113),f=i(59149);i(41658);var p=i(33773),m=i(57555),w=i(59594),y=i(33787),b=i(13455);function C(e,t,i){e.addEventListener(t,i,!1)}function S(e,t,i){e.removeEventListener(t,i,!1)}function E(e){return e.ownerDocument.defaultView.getComputedStyle(e)}function R(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:e=>e.value,...i},n=e.body,o=e.createTextNode(""),s=e.createElement("span");function l(){var e,i;o.textContent=r.textContent(t),s.style.position="absolute",s.style.fontSize=E(t).fontSize,s.style.fontFamily=E(t).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);let l=parseInt((null===(e=E(t))||void 0===e?void 0:e.paddingInlineStart)||0,10),a=parseInt((null===(i=E(t))||void 0===i?void 0:i.paddingInlineEnd)||0,10),h=s.clientWidth+l+a+1;n.removeChild(s);let u=t.style;u.height=`${r.minHeight}px`,r.minWidth>h?u.width=`${r.minWidth}px`:h>r.maxWidth?u.width=`${r.maxWidth}px`:u.width=`${h}px`;let c=t.scrollHeight?t.scrollHeight-1:0;r.minHeight>c?u.height=`${r.minHeight}px`:r.maxHeight<c?(u.height=`${r.maxHeight}px`,u.overflowY="visible"):u.height=`${c}px`}function a(){e.defaultView.setTimeout(l,0)}return{init:function(e,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t=e;if(i&&i.minHeight)if("inherit"===i.minHeight)r.minHeight=t.clientHeight;else{let e=parseInt(i.minHeight,10);isNaN(e)||(r.minHeight=e)}if(i&&i.maxHeight)if("inherit"===i.maxHeight)r.maxHeight=t.clientHeight;else{let e=parseInt(i.maxHeight,10);isNaN(e)||(r.maxHeight=e)}if(i&&i.minWidth)if("inherit"===i.minWidth)r.minWidth=t.clientWidth;else{let e=parseInt(i.minWidth,10);isNaN(e)||(r.minWidth=e)}if(i&&i.maxWidth)if("inherit"===i.maxWidth)r.maxWidth=t.clientWidth;else{let e=parseInt(i.maxWidth,10);isNaN(e)||(r.maxWidth=e)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(o)),"TEXTAREA"===t.nodeName&&(t.style.resize="none",t.style.height=`${r.minHeight}px`,t.style.minWidth=`${r.minWidth}px`,t.style.maxWidth=`${r.maxWidth}px`,t.style.overflowY="hidden"),n&&(C(t,"input",l),C(t,"keydown",a)),l()},resize:l,unObserve(){S(t,"input",l),S(t,"keydown",a)}}}var T=i(78887);function x(e,t){let i=(0,y.getCaretPosition)(t),r=t.value.split("\n"),n=i,o=0;for(let t=0;t<r.length;t++){let s=r[t];0!==t&&(o+=r[t-1].length+1);let l=o+s.length;if("home"===e?n=o:"end"===e&&(n=l),i<=l)break}(0,y.setCaretPosition)(t,n)}var M=i(91748);function O(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let k="ht_editor_hidden",I="textEditor";class A extends p.b7{static get EDITOR_TYPE(){return"text"}constructor(e){super(e),O(this,"eventManager",new m.A(this)),O(this,"autoResize",R(this.hot.rootDocument)),O(this,"TEXTAREA",void 0),O(this,"textareaStyle",void 0),O(this,"TEXTAREA_PARENT",void 0),O(this,"textareaParentStyle",void 0),O(this,"layerClass",void 0),this.eventManager=new m.A(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,y.isInternalElement)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,t,i,r,n,o){let s=this.state;if(super.prepare(e,t,i,r,n,o),!o.readOnly){this.refreshDimensions(!0);let{allowInvalid:e}=o;e&&!this.isOpened()&&(this.TEXTAREA.value=""),s===p._T.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(e,t){this.state===p._T.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,t))}focus(){this.TEXTAREA.select(),(0,y.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),(0,y.setAttribute)(this.TEXTAREA,[["data-hot-input",""],(0,M.vC)(-1)]),(0,y.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),(0,y.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,y.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&(0,y.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,y.addClass)(this.TEXTAREA_PARENT,k),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,w.isEdge)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,y.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,y.addClass)(this.TEXTAREA_PARENT,k)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";let e=this.TEXTAREA_PARENT.childNodes,t=!1;(0,b.rangeEach)(e.length-1,i=>{let r=e[i];if((0,y.hasClass)(r,"handsontableEditor"))return t=!0,!1}),(0,y.hasClass)(this.TEXTAREA_PARENT,k)&&(0,y.removeClass)(this.TEXTAREA_PARENT,k),t?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,y.addClass)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){let e=this.hot.toPhysicalRow(this.row),t=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==p._T.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}let{top:t,start:i,width:r,maxWidth:n,height:o,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${t}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();let l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,n),minHeight:Math.min(o,s),maxWidth:n,maxHeight:s},!0)}bindEvents(){(0,w.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===p._T.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===p._T.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let e=this.hot.getShortcutManager().getContext("editor"),t=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};e.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(t(),!1),runOnlyIf:e=>!this.hot.selection.isMultiple()&&!e.altKey},{keys:[["Meta","Enter"]],callback:()=>(t(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(t(),!1)},{keys:[["Home"]],callback:(e,t)=>{let[i]=t;x(i,this.TEXTAREA)}},{keys:[["End"]],callback:(e,t)=>{let[i]=t;x(i,this.TEXTAREA)}}],{runOnlyIf:()=>(0,T.isDefined)(this.hot.getSelected()),group:I})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(I)}}function N(e,t,i,r,n,o,s){let l=s.ariaTags,a=[],h=[],u=[],c=[];s.className&&(0,y.addClass)(t,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&c.push((0,M.u8)())):l&&u.push((0,M.u8)()[0]),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&c.push((0,M.PF)())):(h.push(s.invalidCellClassName),l&&u.push((0,M.PF)()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!o&&s.placeholder&&a.push(s.placeholderCellClassName),(0,y.removeClass)(t,h),(0,y.addClass)(t,a),(0,y.removeAttribute)(t,u),(0,y.setAttribute)(t,c)}function H(e,t,i,r,n,o,s){N.apply(this,[e,t,i,r,n,o,s]);let l=o;!l&&s.placeholder&&(l=s.placeholder),l=(0,T.stringify)(l),s.trimWhitespace&&(l=l.trim()),(0,y.fastInnerText)(t,l)}i(19398),N.RENDERER_TYPE="base",H.RENDERER_TYPE="text";let P={CELL_TYPE:"text",editor:A,renderer:H};var _=i(73183),L=i(71190);function D(e,t){let i=new h.A(e,t||{},u.Wz);return i.init(),i}(0,f.Gk)(P),D.editors={BaseEditor:p.b7},D.Core=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new h.A(e,t,u.Wz)},D.DefaultSettings=(0,c.A)(),D.hooks=d.R.getSingleton(),D.CellCoords=_.A,D.CellRange=L.A,D.packageName="handsontable",D.buildDate="24/04/2025 10:59:00",D.version="15.3.0",D.languages={dictionaryKeys:g.nF,getLanguageDictionary:g.bN,getLanguagesDictionaries:g.W5,registerLanguageDictionary:g.eb,getTranslatedPhrase:g.E9},i(12252),i(29954),i(21591),i(43942);var F=i(13115),V=i(19857),W=i(7346);let B="handsontableEditor";class j extends A{static get EDITOR_TYPE(){return"handsontable"}open(){super.open();let e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),"none"===e.display&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,y.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,t,i,r,n,o){super.prepare(e,t,i,r,n,o);let s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(e,t){let i=this.getSourceData(t.row,t.col);void 0!==i&&s.setValue(i),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,V.extend)(l,o.handsontable),this.htOptions=l}beginEditing(e,t){let i=this.hot.getSettings().onBeginEditing;i&&!1===i()||super.beginEditing(e,t)}createElements(){super.createElements();let e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,t,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let e=this.htEditor.getValue();void 0!==e&&this.setValue(e)}super.finishEditing(e,t,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;null===(e=this.htEditor)||void 0===e||e.destroy()}),this.hot.addHook("afterSetTheme",(e,t)=>{if(!t){var i;null===(i=this.htEditor)||void 0===i||i.useTheme(e)}})}registerShortcuts(){let e=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();let t={group:B,relativeToGroup:W.b,position:"before"},i=(e,t)=>{let i=this.htEditor;if(void 0!==e&&(e<0||i.flipped&&e>i.countRows()-1?i.deselectCell():i.selectCell(e,0),i.getData().length))return t.preventDefault(),(0,F.stopImmediatePropagation)(t),this.hot.listen(),this.TEXTAREA.focus(),!1};e.addShortcuts([{keys:[["ArrowUp"]],callback:e=>{let t,r,n=this.htEditor;return!n.getSelectedLast()&&n.flipped?t=n.countRows()-1:n.getSelectedLast()&&(t=n.flipped?Math.max(0,n.getSelectedLast()[0]-1):n.getSelectedLast()[0]-1),i(t,e)},preventDefault:!1},{keys:[["ArrowDown"]],callback:e=>{let t,r=this.htEditor;return r.getSelectedLast()||r.flipped?r.getSelectedLast()&&(r.flipped?t=r.getSelectedLast()[0]+1:!r.flipped&&(t=Math.min(r.countRows()-1,r.getSelectedLast()[0]+1))):t=0,i(t,e)},preventDefault:!1}],t)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(B)}}var z=i(95061),U=i(93924),$=i(79791),G=i(75708);function Y(e,t,i){K(e,t),t.set(e,i)}function K(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function X(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function q(e,t){return e.get(J(e,t))}function J(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var Z=new WeakMap,Q=new WeakMap,ee=new WeakSet;class et extends j{constructor(){super(...arguments),function(e,t){K(e,t),t.add(e)}(this,ee),X(this,"query",null),X(this,"strippedChoices",[]),X(this,"rawChoices",[]),Y(this,Z,this.hot.guid.slice(0,9)),Y(this,Q,(0,G.debounce)(()=>{this.focus()},100)),X(this,"sortByRelevance",function(e,t,i){let r,n,o,s,l=[],a=[],h=e.length,u=t.length;if(0===h){for(o=0;o<u;o++)a.push(o);return a}for(o=0;o<u;o++){if(n=(0,U.stripTags)((0,T.stringify)(t[o])),i)s=n.indexOf(e);else{let t=this.cellProperties.locale;s=n.toLocaleLowerCase(t).indexOf(e.toLocaleLowerCase(t))}-1!==s&&(r=n.length-s-h,l.push({baseIndex:o,index:s,charsLeft:r,value:n}))}for(l.sort((e,t)=>{if(-1===t.index)return -1;if(-1===e.index)return 1;if(e.index<t.index)return -1;if(t.index<e.index)return 1;if(e.index===t.index){if(e.charsLeft<t.charsLeft)return -1;else if(e.charsLeft>t.charsLeft)return 1}return 0}),o=0,u=l.length;o<u;o++)a.push(l[o].baseIndex);return a})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){let e=this.rawChoices.find(e=>this.stripValueIfNeeded(e)===this.TEXTAREA.value);return(0,T.isDefined)(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),(0,y.addClass)(this.htContainer,"autocompleteEditor"),(0,y.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.TEXTAREA,[(0,M.ZW)(),(0,M.B6)(),(0,M.wP)("listbox"),(0,M.gq)()])}prepare(e,t,i,r,n,o){super.prepare(e,t,i,r,n,o),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.TEXTAREA,[(0,M.dV)("false"),(0,M.Ku)(`${q(Z,this)}-listbox-${e}-${t}`)])}open(){super.open();let e=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,t=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null==i?void 0:i.length,{row:n,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",e=>this.onBeforeKeyDown(e)),this.htEditor.addHook("afterScroll",q(Q,this)),this.htEditor.updateSettings({colWidths:e?[(0,y.outerWidth)(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(e,n,o,s,l,a,h)=>{let u,c;H(e,n,o,s,l,a,h);let{filteringCaseSensitive:d,allowHtml:g,locale:f}=this.cellProperties,p=this.query,m=(0,T.stringify)(a);m&&!g&&-1!==(u=!0===d?m.indexOf(p):m.toLocaleLowerCase(f).indexOf(p.toLocaleLowerCase(f)))&&(c=m.substr(u,p.length),m=m.replace(c,`<strong>${c}</strong>`)),t&&(0,y.setAttribute)(n,[(0,M.n)(),...i?[(0,M.DY)(r)]:[],...i?[(0,M.Vy)(i.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${o}-${s}`]]),n.innerHTML=m},afterSelectionEnd:(e,i)=>{if(t){let t=e=>{(0,y.setAttribute)(e,[(0,M.H0)()]),(0,y.setAttribute)(this.TEXTAREA,...(0,M.VN)(e.id))},r=this.htEditor.getCell(e,i,!0);null!==r?t(r):this.htEditor.addHookOnce("afterScrollVertically",()=>{t(this.htEditor.getCell(e,i,!0))})}}}),t&&((0,y.setAttribute)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,M.gg)()),(0,y.setAttribute)(this.htEditor.rootElement,[(0,M.$o)(),(0,M.S2)("polite"),(0,M.rE)("text"),["id",`${q(Z,this)}-listbox-${n}-${o}`]]),(0,y.setAttribute)(this.TEXTAREA,...(0,M.dV)("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.TEXTAREA,[(0,M.dV)("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){let t=this.cellProperties.source;this.query=e,"function"==typeof t?t.call(this.cellProperties,e,e=>{this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))}):Array.isArray(t)?(this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))):this.updateChoicesList([])}updateChoicesList(e){let t=(0,y.getCaretPosition)(this.TEXTAREA),i=(0,y.getSelectionEndPosition)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,n=this.cellProperties.filter,o=null,s=null,l=e;r&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));let a=Array.isArray(o)?o.length:0;if(!1===n)a&&(s=o[0]);else{let e=[];for(let t=0,i=l.length;t<i&&(!r||!(a<=t));t++)a?e.push(l[o[t]]):e.push(l[t]);s=0,l=e}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData((0,z.pivot)([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),(0,y.setCaretPosition)(this.TEXTAREA,t,t===i?void 0:i)}flipDropdownIfNeeded(){let e=this.getEditedCellRect(),t=e.height,i=e.top;this.hot.view.isVerticallyScrollableByWindow()&&(i=Math.max(i+(this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY),0));let r=this.getHeight(),n=this.hot.view.getWorkspaceHeight()-i-t,o=r>n&&i>n+t;return o?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(o?i:n,r),o}limitDropdownIfNeeded(e,t){if(t>e){let i=0,r=0,n=0,o=null;do i+=n=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),r+=1;while(i<e);o=i-n,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+t-o}px`),this.setDropdownHeight(i-n)}}flipDropdown(e){let t=this.htEditor.rootElement.style;t.position="absolute",t.top=`${-e}px`,this.htEditor.flipped=!0}unflipDropdown(){let e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),J(ee,this,ei).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),J(ee,this,ei).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){"number"==typeof e?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){let e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderTopWidth,10)+parseInt(e.borderBottomWidth,10);return Array.from({length:Math.min(this.cellProperties.visibleRows,this.strippedChoices.length)},(e,t)=>t).reduce((e,t)=>e+(this.htEditor.getRowHeight(t)||this.htEditor.view.getDefaultRowHeight()),0)+t+1}getWidth(){let e=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),t=parseInt(e.borderInlineStartWidth,10)+parseInt(e.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+t}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){let{allowHtml:t}=this.cellProperties,i=(0,z.arrayMap)(e,e=>(0,T.stringify)(e));return(0,z.arrayMap)(i,e=>t?e:(0,U.stripTags)(e))}allowKeyEventPropagation(e){let t=this.htEditor.getSelectedRangeLast(),i={row:t?t.from.row:-1},r=!1;return e===$.KEY_CODES.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),e===$.KEY_CODES.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(e){if((0,$.isPrintableChar)(e.keyCode)||e.keyCode===$.KEY_CODES.BACKSPACE||e.keyCode===$.KEY_CODES.DELETE||e.keyCode===$.KEY_CODES.INSERT){let t=10;e.keyCode===$.KEY_CODES.C&&(e.ctrlKey||e.metaKey)||(this.isOpened()||(t+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},t))}}}function ei(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+(0,y.getScrollbarWidth)(this.hot.rootDocument)})}class er extends p.b7{static get EDITOR_TYPE(){return"checkbox"}beginEditing(e,t){if(t&&"mouseup"===t.type&&"TD"===t.target.nodeName){let e=this.TD.querySelector('input[type="checkbox"]');(0,y.hasClass)(e,"htBadValue")||e.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var en=i(82940);let eo=()=>window,es=()=>window.document,el=(e,t)=>window.setTimeout(e,t),ea=function(e,t,i,r){e.addEventListener(t,i,!!r)},eh=function(e,t,i,r){e.removeEventListener(t,i,!!r)},eu=function(e,t){return -1!==(" "+e.className+" ").indexOf(" "+t+" ")},ec=function(e,t){eu(e,t)||(e.className=""===e.className?t:e.className+" "+t)},ed=function(e,t){var i;e.className=(i=(" "+e.className+" ").replace(" "+t+" "," ")).trim?i.trim():i.replace(/^\s+|\s+$/g,"")},eg=function(e){return/Array/.test(Object.prototype.toString.call(e))},ef=function(e){return/Date/.test(Object.prototype.toString.call(e))&&!isNaN(e.getTime())},ep=function(e){let t=e.getDay();return 0===t||6===t},em=function(e,t){return[31,e%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31][t]},ew=function(e){ef(e)&&e.setHours(0,0,0,0)},ey=function(e,t){return e.getTime()===t.getTime()},ev=function(e,t,i){let r,n;for(r in t)(n=void 0!==e[r])&&"object"==typeof t[r]&&null!==t[r]&&void 0===t[r].nodeName?ef(t[r])?i&&(e[r]=new Date(t[r].getTime())):eg(t[r])?i&&(e[r]=t[r].slice(0)):e[r]=ev({},t[r],i):(i||!n)&&(e[r]=t[r]);return e},eb=function(e,t,i){let r=es().createEvent("HTMLEvents");r.initEvent(t,!0,!1),r=ev(r,i),e.dispatchEvent(r)},eC=function(e){return e.month<0&&(e.year-=Math.ceil(Math.abs(e.month)/12),e.month+=12),e.month>11&&(e.year+=Math.floor(Math.abs(e.month)/12),e.month-=12),e},eS={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},eE=function(e,t,i){for(t+=e.firstDay;t>=7;)t-=7;return i?e.i18n.weekdaysShort[t]:e.i18n.weekdays[t]},eR=function(e){let t=[],i="false";if(e.isEmpty)if(!e.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';else t.push("is-outside-current-month"),e.enableSelectionDaysInNextAndPreviousMonths||t.push("is-selection-disabled");return e.isDisabled&&t.push("is-disabled"),e.isToday&&t.push("is-today"),e.isSelected&&(t.push("is-selected"),i="true"),e.hasEvent&&t.push("has-event"),e.isInRange&&t.push("is-inrange"),e.isStartRange&&t.push("is-startrange"),e.isEndRange&&t.push("is-endrange"),'<td data-day="'+e.day+'" class="'+t.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+e.year+'" data-pika-month="'+e.month+'" data-pika-day="'+e.day+'">'+e.day+"</button></td>"},eT=function(e,t){e.setHours(0,0,0,0);let i=e.getDate(),r=e.getDay(),n=t-1,o=function(e){return(e+7-1)%7};e.setDate(i+n-o(r));let s=new Date(e.getFullYear(),0,t);return 1+Math.round(((e.getTime()-s.getTime())/864e5-n+o(s.getDay()))/7)},ex=function(e,t,i,r,n){let o=new Date(r,i,t);return'<td class="pika-week">'+(e.hasMoment?e.moment(o).isoWeek():eT(o,n))+"</td>"},eM=function(e){let t,i=[];for(e.showWeekNumber&&i.push("<th></th>"),t=0;t<7;t++)i.push('<th scope="col"><abbr title="'+eE(e,t)+'">'+eE(e,t,!0)+"</abbr></th>");return"<thead><tr>"+(e.isRTL?i.reverse():i).join("")+"</tr></thead>"},eO=function(e,t,i,r,n,o){let s,l,a,h=e._o,u=i===h.minYear,c=i===h.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',g,f,p=!0,m=!0;for(a=[],s=0;s<12;s++)a.push('<option value="'+(i===n?s-t:12+s-t)+'"'+(s===r?' selected="selected"':"")+(u&&s<h.minMonth||c&&s>h.maxMonth?' disabled="disabled"':"")+">"+h.i18n.months[s]+"</option>");for(g='<div class="pika-label">'+h.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",eg(h.yearRange)?(s=h.yearRange[0],l=h.yearRange[1]+1):(s=i-h.yearRange,l=1+i+h.yearRange),a=[];s<l&&s<=h.maxYear;s++)s>=h.minYear&&a.push('<option value="'+s+'"'+(s===i?' selected="selected"':"")+">"+s+"</option>");return f='<div class="pika-label">'+i+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",h.showMonthAfterYear?d+=f+g:d+=g+f,u&&(0===r||h.minMonth>=r)&&(p=!1),c&&(11===r||h.maxMonth<=r)&&(m=!1),0===t&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),t===e._o.numberOfMonths-1&&(d+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),d+"</div>"};function ek(e){let t=this,i=t.config(e);t._onMouseDown=function(e){if(!t._v)return;let r=(e=e||eo().event).target||e.srcElement;if(r)if(!eu(r,"is-disabled")&&(!eu(r,"pika-button")||eu(r,"is-empty")||eu(r.parentNode,"is-disabled")?eu(r,"pika-prev")?t.prevMonth():eu(r,"pika-next")&&t.nextMonth():(t.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),i.bound&&el(function(){t.hide(),i.blurFieldOnSelect&&i.field&&i.field.blur()},100))),eu(r,"pika-select"))t._c=!0;else{if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t._onChange=function(e){let i=(e=e||eo().event).target||e.srcElement;i&&(eu(i,"pika-select-month")?t.gotoMonth(i.value):eu(i,"pika-select-year")&&t.gotoYear(i.value))},t._onKeyChange=function(e){if(e=e||eo().event,t.isVisible())switch(e.keyCode){case 13:case 27:i.field&&i.field.blur();break;case 37:t.adjustDate("subtract",1);break;case 38:t.adjustDate("subtract",7);break;case 39:t.adjustDate("add",1);break;case 40:t.adjustDate("add",7);break;case 8:case 46:t.setDate(null)}},t._parseFieldValue=function(){if(i.parse)return i.parse(i.field.value,i.format);if(!this.hasMoment)return new Date(Date.parse(i.field.value));{let e=this.moment(i.field.value,i.format,i.formatStrict);return e&&e.isValid()?e.toDate():null}},t._onInputChange=function(e){let i;e.firedBy===t||(ef(i=t._parseFieldValue())&&t.setDate(i),t._v||t.show())},t._onInputFocus=function(){t.show()},t._onInputClick=function(){t.show()},t._onInputBlur=function(){let e=es().activeElement;do if(eu(e,"pika-single"))return;while(e=e.parentNode);t._c||(t._b=el(function(){t.hide()},50)),t._c=!1},t._onClick=function(e){let r=(e=e||eo().event).target||e.srcElement,n=r;if(r){!hasEventListeners&&eu(r,"pika-select")&&!r.onchange&&(r.setAttribute("onchange","return;"),ea(r,"change",t._onChange));do if(eu(n,"pika-single")||n===i.trigger)return;while(n=n.parentNode);t._v&&r!==i.trigger&&n!==i.trigger&&t.hide()}},t.el=es().createElement("div"),t.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),ea(t.el,"mousedown",t._onMouseDown,!0),ea(t.el,"touchend",t._onMouseDown,!0),ea(t.el,"change",t._onChange),i.keyboardInput&&ea(es(),"keydown",t._onKeyChange),i.field&&(i.container?i.container.appendChild(t.el):i.bound?es().body.appendChild(t.el):i.field.parentNode.insertBefore(t.el,i.field.nextSibling),ea(i.field,"change",t._onInputChange),i.defaultDate||(i.defaultDate=t._parseFieldValue(),i.setDefaultDate=!0));let r=i.defaultDate;ef(r)?i.setDefaultDate?t.setDate(r,!0):t.gotoDate(r):t.gotoDate(new Date),i.bound?(this.hide(),t.el.className+=" is-bound",ea(i.trigger,"click",t._onInputClick),ea(i.trigger,"focus",t._onInputFocus),ea(i.trigger,"blur",t._onInputBlur)):this.show()}function eI(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function eA(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}ek.prototype={config:function(e){this._o||(this._o=ev({},eS,!0));let t=ev(this._o,e,!0);t.isRTL=!!t.isRTL,t.field=t.field&&t.field.nodeName?t.field:null,t.theme="string"==typeof t.theme&&t.theme?t.theme:null,t.bound=!!(void 0!==t.bound?t.field&&t.bound:t.field),t.trigger=t.trigger&&t.trigger.nodeName?t.trigger:t.field,t.disableWeekends=!!t.disableWeekends,t.disableDayFn="function"==typeof t.disableDayFn?t.disableDayFn:null;let i=parseInt(t.numberOfMonths,10)||1;if(t.numberOfMonths=i>4?4:i,ef(t.minDate)||(t.minDate=!1),ef(t.maxDate)||(t.maxDate=!1),t.minDate&&t.maxDate&&t.maxDate<t.minDate&&(t.maxDate=t.minDate=!1),t.minDate&&this.setMinDate(t.minDate),t.maxDate&&this.setMaxDate(t.maxDate),eg(t.yearRange)){let e=new Date().getFullYear()-10;t.yearRange[0]=parseInt(t.yearRange[0],10)||e,t.yearRange[1]=parseInt(t.yearRange[1],10)||e}else t.yearRange=Math.abs(parseInt(t.yearRange,10))||eS.yearRange,t.yearRange>100&&(t.yearRange=100);return t},toString:function(e){return(e=e||this._o.format,ef(this._d))?this._o.toString?this._o.toString(this._d,e):this.hasMoment?this.moment(this._d).format(e):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(e,t){this.hasMoment&&this.moment.isMoment(e)&&this.setDate(e.toDate(),t)},useMoment:function(e){this.hasMoment=!0,this.moment=e},getDate:function(){return ef(this._d)?new Date(this._d.getTime()):null},setDate:function(e,t){if(!e)return this._d=null,this._o.field&&(this._o.field.value="",eb(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof e&&(e=new Date(Date.parse(e))),!ef(e))return;let i=this._o.minDate,r=this._o.maxDate;ef(i)&&e<i?e=i:ef(r)&&e>r&&(e=r),this._d=new Date(e.getTime()),ew(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),eb(this._o.field,"change",{firedBy:this})),t||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(e){let t=!0;if(ef(e)){if(this.calendars){let i=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),n=e.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),t=n<i.getTime()||r.getTime()<n}t&&(this.calendars=[{month:e.getMonth(),year:e.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(e,t){let i,r=this.getDate()||new Date,n=24*parseInt(t)*36e5;"add"===e?i=new Date(r.valueOf()+n):"subtract"===e&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=eC(this.calendars[0]);for(let e=1;e<this._o.numberOfMonths;e++)this.calendars[e]=eC({month:this.calendars[0].month+e,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(e){isNaN(e)||(this.calendars[0].month=parseInt(e,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(e){isNaN(e)||(this.calendars[0].year=parseInt(e,10),this.adjustCalendars())},setMinDate:function(e){e instanceof Date?(ew(e),this._o.minDate=e,this._o.minYear=e.getFullYear(),this._o.minMonth=e.getMonth()):(this._o.minDate=eS.minDate,this._o.minYear=eS.minYear,this._o.minMonth=eS.minMonth,this._o.startRange=eS.startRange),this.draw()},setMaxDate:function(e){e instanceof Date?(ew(e),this._o.maxDate=e,this._o.maxYear=e.getFullYear(),this._o.maxMonth=e.getMonth()):(this._o.maxDate=eS.maxDate,this._o.maxYear=eS.maxYear,this._o.maxMonth=eS.maxMonth,this._o.endRange=eS.endRange),this.draw()},setStartRange:function(e){this._o.startRange=e},setEndRange:function(e){this._o.endRange=e},draw:function(e){if(!this._v&&!e)return;let t=this._o,i=t.minYear,r=t.maxYear,n=t.minMonth,o=t.maxMonth,s="",l;this._y<=i&&(this._y=i,!isNaN(n)&&this._m<n&&(this._m=n)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let e=0;e<t.numberOfMonths;e++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+eO(this,e,this.calendars[e].year,this.calendars[e].month,this.calendars[0].year,l)+this.render(this.calendars[e].year,this.calendars[e].month,l)+"</div>";this.el.innerHTML=s,t.bound&&"hidden"!==t.field.type&&el(function(){t.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),t.bound&&t.field.setAttribute("aria-label",t.ariaLabel)},adjustPosition:function(){let e,t,i,r,n,o,s,l,a,h,u;this._o.container||(this.el.style.position="absolute",e=this._o.trigger,t=this.el.offsetWidth,i=this.el.offsetHeight,r=eo().innerWidth||es().documentElement.clientWidth,n=eo().innerHeight||es().documentElement.clientHeight,o=es().body.scrollTop||es().documentElement.scrollTop,h=!0,u=!0,s=(a=e.getBoundingClientRect()).left+eo().pageXOffset,l=a.bottom+eo().pageYOffset,(this._o.reposition&&s+t>r||this._o.position.indexOf("right")>-1&&s-t+e.offsetWidth>0)&&(s=s-t+e.offsetWidth,h=!1),(this._o.reposition&&l+i>n+o||this._o.position.indexOf("top")>-1&&l-i-e.offsetHeight>0)&&(l=l-i-e.offsetHeight,u=!1),s<0&&(s=0),l<0&&(l=0),this.el.style.left=s+"px",this.el.style.top=l+"px",ec(this.el,h?"left-aligned":"right-aligned"),ec(this.el,u?"bottom-aligned":"top-aligned"),ed(this.el,h?"right-aligned":"left-aligned"),ed(this.el,u?"top-aligned":"bottom-aligned"))},render:function(e,t,i){var r,n,o,s;let l=this._o,a=new Date,h=em(e,t),u=new Date(e,t,1).getDay(),c=[],d=[];ew(a),l.firstDay>0&&(u-=l.firstDay)<0&&(u+=7);let g=0===t?11:t-1,f=11===t?0:t+1,p=0===t?e-1:e,m=11===t?e+1:e,w=em(p,g),y=h+u,b=y;for(;b>7;)b-=7;y+=7-b;let C=!1;for(let i=0,o=0;i<y;i++){let s=new Date(e,t,1+(i-u)),y=!!ef(this._d)&&ey(s,this._d),b=ey(s,a),S=-1!==l.events.indexOf(s.toDateString()),E=i<u||i>=h+u,R=1+(i-u),T=t,x=e,M=l.startRange&&ey(l.startRange,s),O=l.endRange&&ey(l.endRange,s),k=l.startRange&&l.endRange&&l.startRange<s&&s<l.endRange,I=l.minDate&&s<l.minDate||l.maxDate&&s>l.maxDate||l.disableWeekends&&ep(s)||l.disableDayFn&&l.disableDayFn(s);E&&(i<u?(R=w+R,T=g,x=p):(R-=h,T=f,x=m));let A={day:R,month:T,year:x,hasEvent:S,isSelected:y,isToday:b,isDisabled:I,isEmpty:E,isStartRange:M,isEndRange:O,isInRange:k,showDaysInNextAndPreviousMonths:l.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:l.enableSelectionDaysInNextAndPreviousMonths};if(l.pickWholeWeek&&y&&(C=!0),d.push(eR(A)),7==++o){l.showWeekNumber&&d.unshift(ex(this,i-u,t,e,l.firstWeekOfYearMinDays)),c.push((r=d,n=l.isRTL,'<tr class="pika-row'+(l.pickWholeWeek?" pick-whole-week":"")+(C?" is-selected":"")+'">'+(n?r.reverse():r).join("")+"</tr>")),d=[],o=0,C=!1}}return o=l,s=c,'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+eM(o)+"<tbody>"+s.join("")+"</tbody></table>"},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),ed(this.el,"is-hidden"),this._o.bound&&(ea(es(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let e=this._v;!1!==e&&(this._o.bound&&eh(es(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),ec(this.el,"is-hidden"),this._v=!1,void 0!==e&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let e=this._o;this.hide(),eh(this.el,"mousedown",this._onMouseDown,!0),eh(this.el,"touchend",this._onMouseDown,!0),eh(this.el,"change",this._onChange),e.keyboardInput&&eh(es(),"keydown",this._onKeyChange),e.field&&(eh(e.field,"change",this._onInputChange),e.bound&&(eh(e.trigger,"click",this._onInputClick),eh(e.trigger,"focus",this._onInputFocus),eh(e.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};let eN="date",eH="dateEditor";var eP=new WeakSet;class e_ extends A{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,eP),eI(this,"parentDestroyed",!1),eI(this,"$datePicker",null)}static get EDITOR_TYPE(){return eN}init(){if("function"!=typeof en)throw Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,t)=>{t||((0,y.removeClass)(this.datePicker,/ht-theme-.*/g),(0,y.addClass)(this.datePicker,e))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,y.addClass)(this.datePicker,"htDatepickerHolder");let e=this.hot.getCurrentThemeName();(0,y.removeClass)(this.datePicker,/ht-theme-.*/g),(0,y.addClass)(this.datePicker,e),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{(0,y.hasClass)(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){let e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,t,i,r,n,o){super.prepare(e,t,i,r,n,o)}open(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),t.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:eH})}close(){var e;this._opened=!1,null!==(e=this.$datePicker)&&void 0!==e&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{let e=this.hot._getEditorManager();e.closeEditor(),this.hot.view.render(),e.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(eH),super.close()}finishEditing(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(e,t)}showDatepicker(e){let t,i=eA(eP,this,eL).call(this),r=this.hot.view.isMouseDown(),n=!!e&&(0,$.isFunctionKey)(e.keyCode);this.datePicker.style.display="block",this.$datePicker=new ek(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(en),this.$datePicker._onInputFocus=function(){},this.originalValue?(en(t=this.originalValue,i,!0).isValid()&&this.$datePicker.setMoment(en(t,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),n||r||this.setValue("")):this.cellProperties.defaultDate?(en(t=this.cellProperties.defaultDate,i,!0).isValid()&&this.$datePicker.setMoment(en(t,i),!0),n||r||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;let t=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,V.deepExtend)(i,this.cellProperties.datePickerConfig);let r=i.onSelect,n=i.onClose;return i.field=t,i.trigger=t,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=null!==(e=i.format)&&void 0!==e?e:eA(eP,this,eL).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=e=>{let t=e;isNaN(t.getTime())||(t=en(t).format(eA(eP,this,eL).call(this))),this.setValue(t),r&&r(),(0,w.isMobileBrowser)()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},i}refreshDimensions(e){var t;if(super.refreshDimensions(e),this.state!==p._T.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}let{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:n}=this.hot.view._wt,{wtTable:o}=null!==(t=n.getParentOverlay(this.TD))&&void 0!==t?t:this.hot.view._wt,s=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),h=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=l&&this.col>=a&&this.col<=h){let e=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+e.top+(0,y.outerHeight)(this.TD)}px`;let t=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?t+=e.right-(0,y.outerWidth)(this.datePicker):t+=e.left,this.datePickerStyle.left=`${t}px`}else this.hideDatepicker()}}function eL(){var e;return null!==(e=this.cellProperties.dateFormat)&&void 0!==e?e:"DD/MM/YYYY"}class eD extends et{static get EDITOR_TYPE(){return"dropdown"}prepare(e,t,i,r,n,o){o.filter=!1,o.strict=!0,super.prepare(e,t,i,r,n,o)}}class eF extends A{static get EDITOR_TYPE(){return"numeric"}}class eV extends A{constructor(){super(...arguments),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"autoResize",R(this.hot.rootDocument,{textContent:e=>"".repeat(e.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,y.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}let eW="ht_editor_visible",eB="selectEditor";class ej extends p.b7{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";let e=this.hot.rootDocument.createElement("DIV"),t=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",t&&e.setAttribute(...(0,M.MG)()),e.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),(0,y.addClass)(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",(0,y.hasClass)(this.selectWrapper,eW)&&(0,y.removeClass)(this.selectWrapper,eW),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,t,i,r,n,o){let s;super.prepare(e,t,i,r,n,o);let l=this.cellProperties.selectOptions;s="function"==typeof l?this.prepareOptions(l(this.row,this.col,this.prop)):this.prepareOptions(l),(0,y.empty)(this.select),(0,V.objectEach)(s,(e,t)=>{let i=this.hot.rootDocument.createElement("OPTION");i.value=t,(0,y.fastInnerHTML)(i,e),this.select.appendChild(i)})}prepareOptions(e){let t={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)t[e[i]]=e[i];else"object"==typeof e&&(t=e);return t}refreshValue(){let e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==p._T.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:e,start:t,width:i,height:r}=this.getEditedCellRect(),n=this.selectWrapper.style;n.height=`${r}px`,n.width=`${i}px`,n.top=`${e}px`,n[this.hot.isRtl()?"right":"left"]=`${t}px`,n.margin="0px",(0,y.addClass)(this.selectWrapper,eW)}registerShortcuts(){let e=this.hot.getShortcutManager().getContext("editor");this.isInFullEditMode()&&e.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{let e=this.select.selectedIndex-1;e>=0&&(this.select[e].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let e=this.select.selectedIndex+1;e<=this.select.length-1&&(this.select[e].selected=!0)}}],{group:eB})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(eB)}}class ez extends A{static get EDITOR_TYPE(){return"time"}prepare(e,t,i,r,n,o){super.prepare(e,t,i,r,n,o),this.TEXTAREA.dir="ltr"}}var eU=i(99206);function e$(e,t,i,r,n,o,s){N.apply(this,[e,t,i,r,n,o,s]),(0,y.fastInnerHTML)(t,null==o?"":o,!1)}function eG(e,t,i,r,n,o,s){let{rootDocument:l}=e,a=s.allowHtml?e$:H,h=l.createElement("DIV"),u=e.getSettings().ariaTags;if(h.className="htAutocompleteArrow",u&&h.setAttribute(...(0,M.MG)()),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[e,t,i,r,n,o,s]),t.firstChild||t.appendChild(l.createTextNode(String.fromCharCode(160))),t.insertBefore(h,t.firstChild),(0,y.addClass)(t,"htAutocomplete"),!e.acArrowListener){let n=new m.A(e);e.acArrowListener=function(n){(0,y.hasClass)(n.target,"htAutocompleteArrow")&&e.view._wt.getSetting("onCellDblClick",null,e._createCellCoords(i,r),t)},n.addEventListener(e.rootElement,"mousedown",e.acArrowListener),e.addHookOnce("afterDestroy",()=>{n.destroy()})}}function eY(e,t,i,r,n,o,s){eG.apply(this,[e,t,i,r,n,o,s])}e$.RENDERER_TYPE="html",eG.RENDERER_TYPE="autocomplete",eY.RENDERER_TYPE="dropdown",i(63723),i(85522);var eK=i(95696);let eX=new WeakMap,eq=new WeakMap,eJ="data-row",eZ="data-col",eQ="checkbox";function e0(e,t,i,r,n,o,s){let{rootDocument:l}=e,a=e.getSettings().ariaTags;N.apply(this,[e,t,i,r,n,o,s]),function(e){let t=eq.get(e);if(!t){let{rootElement:i}=e;(t=new m.A(e)).addEventListener(i,"click",t=>(function(e,t){let{target:i}=e;if(!e1(i)||!i.hasAttribute(eJ)||!i.hasAttribute(eZ))return;let r=parseInt(i.getAttribute(eJ),10),n=parseInt(i.getAttribute(eZ),10);t.getCellMeta(r,n).readOnly&&e.preventDefault()})(t,e)),t.addEventListener(i,"mouseup",t=>(function(e,t){let{target:i}=e;e1(i)&&i.hasAttribute(eJ)&&i.hasAttribute(eZ)&&setTimeout(t.listen,10)})(t,e)),t.addEventListener(i,"change",t=>(function(e,t){let{target:i}=e;if(!e1(i)||!i.hasAttribute(eJ)||!i.hasAttribute(eZ))return;let r=parseInt(i.getAttribute(eJ),10),n=parseInt(i.getAttribute(eZ),10),o=t.getCellMeta(r,n);if(!o.readOnly){let i=null;i=e.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,t.setDataAtCell(r,n,i)}})(t,e)),eq.set(e,t)}}(e);let h=function(e){let t=e.createElement("input");return t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("tabindex","-1"),t.cloneNode(!1)}(l),u=s.label,c=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),(0,y.empty)(t),o===s.checkedTemplate||(0,T.stringify)(o).toLocaleLowerCase(s.locale)===(0,T.stringify)(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:o===s.uncheckedTemplate||(0,T.stringify)(o).toLocaleLowerCase(s.locale)===(0,T.stringify)(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:(0,T.isEmpty)(o)?(0,y.addClass)(h,"noValue"):(h.style.display="none",(0,y.addClass)(h,"htBadValue"),c=!0),(0,y.setAttribute)(h,[[eJ,i],[eZ,r]]),a&&(0,y.setAttribute)(h,[(0,M.SM)(h.checked?e.getTranslatedPhrase(eK.CHECKBOX_CHECKED):e.getTranslatedPhrase(eK.CHECKBOX_UNCHECKED)),(0,M.Xq)(h.checked),(0,M.Pk)()]),!c&&u){let s="";if(u.value)s="function"==typeof u.value?u.value.call(this,i,r,n,o):u.value;else if(u.property){let t=e.getDataAtRowProp(i,u.property);s=null!==t?t:""}let a=function(e,t,i){let r=e.createElement("label");r.className=`htCheckboxRendererLabel ${i?"fullWidth":""}`;let n=e.createTextNode(t);if(i){let t=e.createElement("span");t.appendChild(n),r.appendChild(t)}else r.appendChild(n);return r.cloneNode(!0)}(l,s,!0!==u.separated);"before"===u.position?u.separated?(t.appendChild(a),t.appendChild(h)):(a.appendChild(h),h=a):u.position&&"after"!==u.position||(u.separated?(t.appendChild(h),t.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}function d(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=e.getSelectedRange(),r=[],n=new Map,o=[],s=0;if(i){for(let l=0;l<i.length;l++){let{row:a,col:h}=i[l].getTopStartCorner(),{row:u,col:c}=i[l].getBottomEndCorner();for(let i=a;i<=u;i+=1)for(let l=h;l<=c;l+=1){let a=e.getCellMeta(i,l);if(a.hidden)continue;let h={checkedTemplate:a.checkedTemplate,uncheckedTemplate:a.uncheckedTemplate};if("checkbox"!==a.type){!0!==t||a.readOnly||(n.has(r.length)?n.set(r.length,[...n.get(r.length),[i,l,null]]):n.set(r.length,[[i,l,null]]));continue}if(!0===a.readOnly)continue;void 0===a.checkedTemplate&&(a.checkedTemplate=!0),void 0===a.uncheckedTemplate&&(a.uncheckedTemplate=!1);let u=e.getDataAtCell(i,l);!1===t?[a.checkedTemplate,a.checkedTemplate.toString()].includes(u)?o.push([i,l,a.uncheckedTemplate,h]):[a.uncheckedTemplate,a.uncheckedTemplate.toString(),null,void 0].includes(u)&&o.push([i,l,a.checkedTemplate,h]):o.push([i,l,a.uncheckedTemplate,h]),s+=1}r.push(s),s=0}(o=o.every(e=>{let[,,t]=e;return t===o[0][2]})?o.map(e=>{let[t,i,r]=e;return[t,i,r]}):o.map(e=>{let[t,i,,r]=e;return[t,i,r.checkedTemplate]})).length>0&&r.forEach((t,i)=>{let r=o.splice(0,t);n.size&&n.has(i)&&(r=[...r,...n.get(i)]),e.setDataAtCell(r)})}}function g(){let t=e.getSelectedRange();if(t){for(let i=0;i<t.length;i++){let r=t[i].getTopStartCorner(),n=t[i].getBottomEndCorner();for(let t=r.row;t<=n.row;t++)for(let i=r.col;i<=n.col;i++){if(e.getCellMeta(t,i).readOnly)continue;let r=e.getCell(t,i);if((0,y.isHTMLElement)(r)&&r.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}u&&(!u||u.separated)||t.appendChild(h),c&&t.appendChild(l.createTextNode("#bad-value#")),eX.has(e)||(eX.set(e,!0),function(){let t=e.getShortcutManager().getContext("grid"),i={group:"checkboxRenderer",relativeToGroup:W.b,position:"before"};t.addShortcuts([{keys:[["space"]],callback:()=>(d(),!g()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!g()),runOnlyIf:()=>{let t=e.getSelectedRangeLast();return e.getSettings().enterBeginsEditing&&(null==t?void 0:t.highlight.isCell())&&!e.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!g()),runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()}}],i)}())}function e1(e){return"INPUT"===e.tagName&&"checkbox"===e.getAttribute("type")}function e2(e,t,i,r,n,o,s){eG.apply(this,[e,t,i,r,n,o,s])}d.R.getSingleton().add("modifyAutoColumnSizeSeed",function(e,t,i){let{label:r,type:n,row:o,column:s,prop:l}=t;if(n===eQ){if(r){let{value:t,property:n}=r,a=i;if(t)a="function"==typeof t?t(o,s,l,i):t;else if(n){let e=this.getDataAtRowProp(o,n);a=null!==e?e:i}e=a}return e}}),e0.RENDERER_TYPE=eQ,e2.RENDERER_TYPE="handsontable";var e3=i(78420);function e5(e,t){if((0,b.isNumeric)(e)){let i=t.numericFormat,r=i&&i.culture||"-",n=i&&i.pattern;if(void 0!==r&&!e3.A.languages()[r]){let e=r.replace("-",""),t=e3.A.allLanguages?e3.A.allLanguages[r]:e3.A[e];t&&e3.A.registerLanguage(t)}e3.A.setLanguage(r),e=(0,e3.A)(e).format(n||"0")}return e}function e9(e,t,i,r,n,o,s){let l=o;if((0,b.isNumeric)(l)){let e=[];if(Array.isArray(s.className))e=s.className;else{var a;let t=null!==(a=s.className)&&void 0!==a?a:"";t.length&&(e=t.split(" "))}l=e5(l,s),0>e.indexOf("htLeft")&&0>e.indexOf("htCenter")&&0>e.indexOf("htRight")&&0>e.indexOf("htJustify")&&e.push("htRight"),0>e.indexOf("htNumeric")&&e.push("htNumeric"),s.className=e.join(" "),t.dir="ltr"}H(e,t,i,r,n,l,s)}function e8(e,t,i,r,n,o,s){H.apply(this,[e,t,i,r,n,o,s]);let l=s.hashLength||t.innerHTML.length,a=s.hashSymbol||"*",h="";(0,b.rangeEach)(l-1,()=>{h+=a}),(0,y.fastInnerHTML)(t,h)}function e4(e,t,i,r,n,o,s){H.apply(this,[e,t,i,r,n,o,s])}function e7(e,t,i,r,n,o,s){H.apply(this,[e,t,i,r,n,o,s]),t.dir="ltr"}e9.RENDERER_TYPE="numeric",e8.RENDERER_TYPE="password",e4.RENDERER_TYPE="select",e7.RENDERER_TYPE="time";var e6=i(46420);function te(e,t){let i=e;if(null==i&&(i=""),this.allowEmpty&&""===i){t(!0);return}this.strict&&this.source?"function"==typeof this.source?this.source(i,tt(i,t)):tt(i,t)(this.source):t(!0)}function tt(e,t){return function(i){let r=!1;for(let t=0,n=i.length;t<n;t++)if(e===i[t]){r=!0;break}t(r)}}function ti(e){let t=new Date(e);return isNaN(new Date(`${e}T00:00`).getDate())?t:new Date(t.getTime()+6e4*t.getTimezoneOffset())}function tr(e,t){let i=(0,eU.L3)(eN,this.instance),r=e,n=!0;null==r&&(r="");let o=en(r,this.dateFormat||i.defaultDateFormat,!0).isValid(),s=en(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(s=!0,o=!0),s||(n=!1),!s&&o&&(n=!0),s&&!o)if(!0===this.correctFormat){let e=function(e,t){let i,r=en(ti(e)),n=en(e,t),o=e.search(/[A-Za-z]/g)>-1;return(r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?r:n).format(t)}(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"dateValidator"),n=!0}else n=!1;t(n)}function tn(e,t){te.apply(this,[e,t])}function to(e,t){let i=e;null==i&&(i=""),t(!!this.allowEmpty&&""===i||""!==i&&(0,b.isNumeric)(e))}te.VALIDATOR_TYPE="autocomplete",tr.VALIDATOR_TYPE="date",tn.VALIDATOR_TYPE="dropdown",to.VALIDATOR_TYPE="numeric";let ts=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function tl(e,t){let i=this.timeFormat||"h:mm:ss a",r=!0,n=e;null===n&&(n=""),n=/^\d{3,}$/.test(n)?parseInt(n,10):n;let o=/^\d{1,2}$/.test(n);o&&(n+=":00");let s=en(n,ts,!0).isValid()?en(n):en(n,i),l=s.isValid(),a=en(n,i,!0).isValid()&&!o;if(this.allowEmpty&&""===n&&(l=!0,a=!0),l||(r=!1),!l&&a&&(r=!0),l&&!a)if(!0===this.correctFormat){let e=s.format(i);this.instance.setDataAtCell(this.visualRow,this.visualCol,e,"timeValidator"),r=!0}else r=!1;t(r)}tl.VALIDATOR_TYPE="time";var ta=i(85917);function th(e,t,i,r,n,o,s){eG.apply(this,[e,t,i,r,n,o,s])}th.RENDERER_TYPE="date";i(20775);var tu=i(17480);function tc(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function td(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function tg(e,t){return e.get(tf(e,t))}function tf(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let tp=new Map([["plugin",tu.Mt],["cell-type",f.L4],["editor",eU.aZ],["renderer",e6.sl],["validator",ta.tR]]),tm=Symbol("mainSetting"),tw=[],ty=null;var tv=new WeakMap,tb=new WeakSet;class tC{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(e){!function(e,t){tc(e,t),t.add(e)}(this,tb),td(this,"eventManager",new m.A(this)),td(this,"pluginName",null),td(this,"pluginsInitializedCallbacks",[]),td(this,"isPluginsReady",!1),td(this,"enabled",!1),td(this,"initialized",!1),function(e,t,i){tc(e,t),t.set(e,i)}(this,tv,{}),(0,V.defineGetter)(this,"hot",e,{writable:!1}),ty=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",e=>this.onUpdateSettings(e)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let e=this.constructor.PLUGIN_DEPS,t=Array.isArray(e)?e:[];if(t.length>0){let e=[];if(t.forEach(t=>{let[i,r]=t.split(":");if(!tp.has(i))throw Error(`Unknown plugin dependency type "${i}" was found.`);tp.get(i)(r)||e.push(` - ${r} (${i})`)}),e.length>0){let t=`The ${this.pluginName} plugin requires the following modules:
${e.join("\n")}
`;tw.push(t)}}if(ty||(ty=(0,tu.f4)()),ty.indexOf(this.pluginName)>=0&&ty.splice(ty.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),0===ty.length){if(tw.length>0){let e=`${tw.join("\n")}
You have to import and register them manually.`;throw tw.length=0,Error(e)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;null===(e=this.eventManager)||void 0===e||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){var t,i;let r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(void 0===e)return r;let n=this.constructor.DEFAULT_SETTINGS;return(Array.isArray(r)||(0,V.isObject)(r))&&n[tm]===e?Array.isArray(r)?r:null!==(t=r[e])&&void 0!==t?t:n[e]:(0,V.isObject)(r)&&null!==(i=r[e])&&void 0!==i?i:n[e]}addHook(e,t,i){tg(tv,this)[e]=tg(tv,this)[e]||[];let r=tg(tv,this)[e];this.hot.addHook(e,t,i),r.push(t),tg(tv,this)[e]=r}removeHooks(e){(0,z.arrayEach)(tg(tv,this)[e]||[],t=>{this.hot.removeHook(e,t)})}clearHooks(){let e=tg(tv,this);(0,V.objectEach)(e,(e,t)=>this.removeHooks(t)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){(0,z.arrayEach)(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){let t=tf(tb,this,tS).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&t&&this.updatePlugin(e))}updatePlugin(){}destroy(){var e;null===(e=this.eventManager)||void 0===e||e.destroy(),this.clearHooks(),(0,V.objectEach)(this,(e,t)=>{"hot"!==t&&(this[t]=null)}),delete this.t,delete this.hot}}function tS(e){if(!e)return!1;let t=this.constructor.SETTING_KEYS;if("boolean"==typeof t)return t;for(let i=0;i<t.length;i++)if(void 0!==e[t[i]])return!0;return!1}var tE=i(23544);function tR(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tT{constructor(e){tR(this,"hot",null),tR(this,"container",null),tR(this,"injected",!1),tR(this,"rows",[]),tR(this,"columns",[]),tR(this,"samples",null),tR(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,t){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={row:e};this.rows.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),0===e&&(0,y.addClass)(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){if(null!=this.hot.getColHeader(0)){let t={row:-1};this.rows.push(t),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),t.table=this.table.table}}addColumn(e,t){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={col:e};this.columns.push(i),this.samples=t,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(e)&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),(0,z.arrayEach)(this.rows,t=>{let{height:i}=t.table.getBoundingClientRect();e(t.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),(0,z.arrayEach)(this.columns,t=>{let{width:i}=t.table.getBoundingClientRect();e(t.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,t){this.settings||(this.settings={}),this.settings[e]=t}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){let t=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&t.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{(0,z.arrayEach)(i.strings,i=>{t.appendChild(this.createColElement(i.col,e))})}),t}createRow(e){let{rootDocument:t}=this.hot,i=t.createDocumentFragment(),r=t.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(r=>{(0,z.arrayEach)(r.strings,r=>{let n=r.col,o=this.hot.getCellMeta(e,n),s=this.hot.getCellRenderer(o),l=t.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,e,n,this.hot.colToProp(n),r.value,o),i.appendChild(l)})}),i}appendColumnHeadersRow(){let{rootDocument:e}=this.hot,t=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){let r=e.createElement("th");i.push([-1,r]),t.appendChild(r)}this.samples.forEach(r=>{(0,z.arrayEach)(r.strings,r=>{let n=r.col,o=e.createElement("th");i.push([n,o]),t.appendChild(o)})}),this.table.tHead.appendChild(t),(0,z.arrayEach)(i,e=>{let[t,i]=e;this.hot.view.appendColHeader(t,i)})}createCol(e){let{rootDocument:t}=this.hot,i=t.createDocumentFragment();return this.samples.forEach(r=>{(0,z.arrayEach)(r.strings,r=>{let n=r.row,o=this.hot.getCellMeta(n,e),s=this.hot.getCellRenderer(o),l=t.createElement("td"),a=t.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,n,e,this.hot.colToProp(e),r.value,o),a.appendChild(l),i.appendChild(a)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,t){let i=this.hot.rootDocument.createElement("col"),r=0;t>=0&&e>=0&&(r=this.hot.getCellMeta(t,e).colspan);let n=this.hot.getColWidth(e);if(r>1)for(let t=e+1;t<e+r;t++)n+=this.hot.getColWidth(t);return i.style.width=`${n}px`,i}createTable(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:t}=this.hot,i=t.createDocumentFragment(),r=t.createElement("table"),n=t.createElement("thead"),o=t.createElement("tbody"),s=t.createElement("colgroup"),l=t.createElement("tr"),a=t.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(l.appendChild(a),n.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(n),this.isVertical()&&o.appendChild(l),r.appendChild(o),(0,y.addClass)(r,e),i.appendChild(r),{fragment:i,table:r,tHead:n,tBody:o,colGroup:s,tr:l,th:a}}createContainer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:t}=this.hot,i=t.createDocumentFragment(),r=t.createElement("div"),n=`htGhostTable htAutoSize ${e.trim()}`;return(0,y.addClass)(r,n),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function tx(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class tM{static get SAMPLE_COUNT(){return 3}constructor(e){tx(this,"samples",null),tx(this,"dataFactory",null),tx(this,"customSampleCount",null),tx(this,"allowDuplicates",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:tM.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}generateRowSamples(e,t){return this.generateSamples("row",t,e)}generateColumnSamples(e,t){return this.generateSamples("col",t,e)}generateSamples(e,t,i){let r=new Map,{from:n,to:o}="number"==typeof i?{from:i,to:i}:i;return(0,b.rangeEach)(n,o,i=>{let n=this.generateSample(e,t,i);r.set(i,n)}),r}generateSample(e,t,i){if("row"!==e&&"col"!==e)throw Error("Unsupported sample type");let r=new Map,n="row"===e?"col":"row",o=[];return(0,b.rangeEach)(t.from,t.to,t=>{let s,l="row"===e?this.dataFactory(i,t):this.dataFactory(t,i);if(!1===l)return;let{value:a,bundleSeed:h}=l,u="string"==typeof h&&h.length>0;s=u?h:(0,V.isObject)(a)?`${Object.keys(a).length}`:Array.isArray(a)?`${a.length}`:`${(0,T.stringify)(a).length}`,r.has(s)||r.set(s,{needed:this.getSampleCount(),strings:[]});let c=r.get(s);c.needed&&(!(o.indexOf(a)>-1)||this.allowDuplicates||u)&&(c.strings.push({value:a,[n]:t}),o.push(a),c.needed-=1)}),r}}var tO=i(67758),tk=i(12522);function tI(e,t,i){tA(e,t),t.set(e,i)}function tA(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function tN(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function tH(e,t){return e.get(t_(e,t))}function tP(e,t,i){return e.set(t_(e,t),i),i}function t_(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("modifyAutoColumnSizeSeed");let tL="autoColumnSize";var tD=new WeakMap,tF=new WeakMap,tV=new WeakMap,tW=new WeakSet;class tB extends tC{static get PLUGIN_KEY(){return tL}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),function(e,t){tA(e,t),t.add(e)}(this,tW),tN(this,"ghostTable",new tT(this.hot)),tN(this,"samplesGenerator",new tM((e,t)=>{let i=this.hot.toPhysicalRow(e),r=this.hot.toPhysicalColumn(t);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(r))return!1;let n=this.hot.getCellMeta(e,t),o="";n.spanned||(o=this.hot.getDataAtCell(e,t));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,n,o)),{value:o,bundleSeed:s}})),tN(this,"inProgress",!1),tN(this,"measuredColumns",0),tN(this,"columnWidthsMap",new tk._),tI(this,tD,!1),tI(this,tF,[]),tI(this,tV,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(e,t,i)=>t_(tW,this,tK).call(this,e,t,i))}isEnabled(){return!1!==this.hot.getSettings()[tL]&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));let t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return t_(tW,e,tG).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return t_(tW,e,tY).call(e,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return t_(tW,e,tq).call(e,...i)}),this.addHook("beforeRender",()=>t_(tW,this,t$).call(this)),this.addHook("modifyColWidth",(e,t)=>this.getColumnWidth(t,e)),this.addHook("init",()=>t_(tW,this,tX).call(this)),super.enablePlugin()}updatePlugin(){tP(tV,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,t,i)=>t_(tW,this,tK).call(this,e,t,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;let e=this.getFirstVisibleColumn(),t=this.getLastVisibleColumn();if(-1===e||-1===t)return;let i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:t},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof e?{from:e,to:e}:e,n="number"==typeof t?{from:t,to:t}:t;(0,b.rangeEach)(r.from,r.to,e=>{let t=this.hot.toPhysicalColumn(e);null===t&&(t=e),(i||null===this.columnWidthsMap.getValueAtIndex(t)&&!this.hot._getColWidthFromSettings(t))&&t_(tW,this,tz).call(this,e,n)}),this.ghostTable.columns.length&&(t_(tW,this,tU).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0,r=this.hot.countCols()-1,n=null;this.inProgress=!0;let o=()=>{if(!this.hot){(0,tE.cancelAnimationFrame)(n),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+tB.CALCULATION_STEP,r)},e,t),(i=i+tB.CALCULATION_STEP+1)<r?n=(0,tE.requestAnimationFrame)(o):((0,tE.cancelAnimationFrame)(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},e,t),i=s+1),i<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){let e=this.hot.getSettings()[tL],t=tB.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return(0,V.isObject)(e)&&(t=e.syncLimit,(0,U.isPercentValue)(t)?t=(0,b.valueAccordingPercent)(i,t):t>>=0),Math.min(t,i)}getColumnWidth(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&"number"==typeof r&&(r=Math.max(r,tO.j))),r}getFirstVisibleColumn(){var e;return null!==(e=this.hot.getFirstRenderedVisibleColumn())&&void 0!==e?e:-1}getLastVisibleColumn(){var e;return null!==(e=this.hot.getLastRenderedVisibleColumn())&&void 0!==e?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((e,t,i)=>{let r=tH(tF,this).length;return(r-1<i||tH(tF,this)[i]!==t)&&e.push(this.hot.toVisualColumn(i)),r-1<i?tH(tF,this).push(t):tH(tF,this)[i]=t,e},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.columnWidthsMap.setValueAtIndex(e,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function tj(e){let t={from:0,to:this.hot.countRows()-1};e.forEach(e=>{let i=this.hot.toPhysicalColumn(e);null===i||this.hot._getColWidthFromSettings(i)||t_(tW,this,tz).call(this,e,t)}),this.ghostTable.columns.length&&(t_(tW,this,tU).call(this),this.ghostTable.clean())}function tz(e,t){this.samplesGenerator.generateColumnSamples(e,t).forEach((e,t)=>this.ghostTable.addColumn(t,e))}function tU(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((e,t)=>{let i=this.hot.toPhysicalColumn(e);this.columnWidthsMap.setValueAtIndex(i,t)})},!0)}function t$(){this.calculateVisibleColumnsWidth(),this.inProgress||(t_(tW,this,tj).call(this,tH(tV,this)),tP(tV,this,[]))}function tG(e,t){t||this.recalculateAllColumnsWidth()}function tY(e){let t=e.reduce((e,t)=>{let[,i]=t,r=this.hot.propToCol(i);return Number.isInteger(r)&&-1===e.indexOf(r)&&e.push(r),e},[]);tH(tV,this).push(...t)}function tK(e,t,i){let r=e;return i&&(this.calculateColumnsWidth(t,void 0,!0),r=this.getColumnWidth(t,void 0,!1)),r}function tX(){tP(tF,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),tP(tD,this,!0)}function tq(e){if(!tH(tD,this))return;let t=e.reduce((e,t)=>{var i;let r=null===(i=t.address)||void 0===i?void 0:i.col;if(Number.isInteger(r)){let t=this.hot.toVisualColumn(r);-1===e.indexOf(t)&&e.push(t)}return e},[]);tH(tV,this).push(...t)}let tJ={horizontal:"horizontal",vertical:"vertical"};function tZ(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function tQ(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("modifyAutofillRange"),d.R.getSingleton().register("beforeAutofill"),d.R.getSingleton().register("afterAutofill");let t0="autofill",t1=["fillHandle"];var t2=new WeakSet;class t3 extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,t2),tZ(this,"addingStarted",!1),tZ(this,"mouseDownOnCellCorner",!1),tZ(this,"mouseDragOutside",!1),tZ(this,"handleDraggedCells",0),tZ(this,"directions",[]),tZ(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return t0}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[t0,...t1]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>tQ(t2,this,t9).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>tQ(t2,this,t5).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,t)=>tQ(t2,this,t8).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=this.hot.getSelectedRangeLast(),{row:t,col:i}=e.getTopStartCorner(),{row:r,col:n}=e.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:t,startCol:i,endRow:r,endCol:n}]),s=[],l=[],a=[];return(0,z.arrayEach)(o,e=>{for(let t=e.startRow;t<=e.endRow;t+=1)-1===s.indexOf(t)&&s.push(t);for(let t=e.startCol;t<=e.endCol;t+=1)-1===l.indexOf(t)&&l.push(t)}),(0,z.arrayEach)(s,e=>{let t=[];(0,z.arrayEach)(l,i=>{t.push(this.hot.getCopyableData(e,i))}),a.push(t)}),a}fillIn(){var e;let t,i,r;if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[n,o,s,l]=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.getSelectedRangeLast(),h=a.getTopStartCorner(),u=a.getBottomEndCorner();this.resetSelectionOfDraggedArea();let c=[h.row,h.col,u.row,u.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,n),Math.min(h.col,o),Math.max(u.row,s),Math.max(u.col,l)],c),{directionOfDrag:g,startOfDragCoords:f,endOfDragCoords:p}=(e=(e,t)=>this.hot._createCellCoords(e,t),d[0]===c[0]&&d[1]<c[1]?(r="left",t=e(d[0],d[1]),i=e(d[2],c[1]-1)):d[2]===c[2]&&d[0]===c[0]&&d[3]>c[3]?(r="right",t=e(d[0],c[3]+1),i=e(d[2],d[3])):d[0]<c[0]&&d[1]===c[1]?(r="up",t=e(d[0],d[1]),i=e(c[0]-1,d[3])):d[2]>c[2]&&d[1]===c[1]&&(r="down",t=e(c[2]+1,d[1]),i=e(d[2],d[3])),t&&t.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:t,endOfDragCoords:i});if(f&&f.row>-1&&f.col>-1){let e=this.getSelectionData(),t=a.clone(),i=this.hot._createCellRange(f,f,p),r=this.hot.runHooks("beforeAutofill",e,t,i,g);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let n=r;if(["up","left"].indexOf(g)>-1&&(1!==r.length||0!==r[0].length))if(n=[],"up"===g){let e=p.row-f.row+1,t=e%r.length;for(let i=0;i<e;i++)n.push(r[(i+(r.length-t))%r.length])}else{let e=p.col-f.col+1,t=e%r[0].length;for(let i=0;i<r.length;i++){n.push([]);for(let o=0;o<e;o++)n[i].push(r[i][(o+(r[i].length-t))%r[i].length])}}this.hot.populateFromArray(f.row,f.col,n,p.row,p.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",n,t,i,g),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){let t=this.hot.getSelectedRangeLast(),i=t.getBottomEndCorner(),r=e;if(this.directions.includes(tJ.vertical)&&this.directions.includes(tJ.horizontal)){let n=t.getTopStartCorner();(i.col<=e.col||n.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||n.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(tJ.vertical))r=this.hot._createCellCoords(e.row,i.col);else{if(!this.directions.includes(tJ.horizontal))return;r=this.hot._createCellCoords(i.row,e.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){let t=this.getCoordsOfDragAndDropBorders(e);t&&this.redrawBorders(t)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){let e=this.hot.getSelectedLast(),t=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&t[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){let t,i=this.hot.getData(),r=this.hot.countRows();for(let n=e[2]+1;n<r;n++){for(let t=e[1];t<=e[3];t++){let e=i[n][t];if(!(0,T.isEmpty)(e))return -1}let r=i[n][e[1]-1],o=i[n][e[3]+1];(0,T.isEmpty)(r)&&(0,T.isEmpty)(o)||(t=n)}return t}addSelectionFromStartAreaToSpecificRowIndex(e,t){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(t,e[3])).commit()}setSelection(e){this.hot.selectCell(...(0,z.arrayMap)(e,e=>Math.max(e,0)),!1,!1)}selectAdjacent(){let e=this.hot.getSelectedLast(),t=this.getIndexOfLastAdjacentFilledInRow(e);return -1!==t&&void 0!==t&&(this.addSelectionFromStartAreaToSpecificRowIndex(e,t),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){let{documentElement:t}=this.hot.rootDocument,i=(0,y.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||t.scrollTop)+(0,y.outerHeight)(this.hot.table),r=(0,y.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||t.scrollLeft)+(0,y.outerWidth)(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>tQ(t2,this,t4).call(this)),this.eventManager.addEventListener(e,"mousemove",e=>tQ(t2,this,t7).call(this,e))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let e=function(e){let t={};return!0===e?(t.directions=Object.keys(tJ),t.autoInsertRow=!0):(0,V.isObject)(e)?((0,T.isDefined)(e.autoInsertRow)?e.direction===tJ.horizontal?t.autoInsertRow=!1:t.autoInsertRow=e.autoInsertRow:t.autoInsertRow=!1,(0,T.isDefined)(e.direction)?t.directions=[e.direction]:t.directions=Object.keys(tJ)):"string"==typeof e?(t.directions=[e],t.autoInsertRow=!0):(t.directions=[],t.autoInsertRow=!1),t}(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function t5(){this.selectAdjacent()&&this.fillIn()}function t9(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function t8(e){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(e),this.addNewRowIfNeeded())}function t4(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function t7(e){let t=this.getIfMouseWasDraggedOutside(e);!1===this.addingStarted&&this.handleDraggedCells>0&&t?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function t6(e,t,i){ie(e,t),t.set(e,i)}function ie(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function it(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ii(e,t,i){return e.set(io(e,t),i),i}function ir(e,t){return e.get(io(e,t))}function io(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let is="autoRowSize";var il=new WeakMap,ia=new WeakMap,ih=new WeakSet;class iu extends tC{static get PLUGIN_KEY(){return is}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),function(e,t){ie(e,t),t.add(e)}(this,ih),it(this,"headerHeight",null),it(this,"ghostTable",new tT(this.hot)),it(this,"samplesGenerator",new tM((e,t)=>{let i,r=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(t);return!(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(n))&&(!(e>=0)||!(t>=0)||!this.hot.getCellMeta(e,t).hidden)&&(e>=0?i=this.hot.getDataAtCell(e,t):-1===e&&(i=this.hot.getColHeader(t)),{value:i})})),it(this,"inProgress",!1),it(this,"measuredRows",0),it(this,"rowHeightsMap",new tk._),t6(this,il,[]),t6(this,ia,!1),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(e,t,i)=>io(ih,this,ig).call(this,e,t,i))}isEnabled(){let e=this.hot.getSettings()[is];return!0===e||(0,V.isObject)(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));let t=this.getSetting("samplingRatio");t&&!isNaN(t)&&this.samplesGenerator.setSampleCount(parseInt(t,10)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return io(ih,e,ip).call(e,...i)}),this.addHook("beforeChangeRender",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return io(ih,e,im).call(e,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return io(ih,e,iy).call(e,...i)}),this.addHook("beforeRender",()=>io(ih,this,id).call(this)),this.addHook("modifyRowHeight",(e,t)=>this.getRowHeight(t,e)),this.addHook("init",()=>io(ih,this,iw).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(e,t,i)=>io(ih,this,ig).call(this,e,t,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;let e=this.getFirstVisibleRow(),t=this.getLastVisibleRow();if(-1===e||-1===t)return;let i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:t},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof e?{from:e,to:e}:e,n="number"==typeof t?{from:t,to:t}:t;if(null!==this.hot.getColHeader(0)){let e=this.samplesGenerator.generateRowSamples(-1,n);this.ghostTable.addColumnHeadersRow(e.get(-1))}(0,b.rangeEach)(r.from,r.to,e=>{let t=this.hot.toPhysicalRow(e);null===t&&(t=e),(i||null===this.rowHeightsMap.getValueAtIndex(t))&&this.samplesGenerator.generateRowSamples(e,n).forEach((e,t)=>this.ghostTable.addRow(t,e))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{e<0?this.headerHeight=t:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(e),t)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0,r=this.hot.countRows()-1,n=null;this.inProgress=!0;let o=()=>{if(!this.hot){(0,tE.cancelAnimationFrame)(n),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+iu.CALCULATION_STEP,r)},e,t),(i=i+iu.CALCULATION_STEP+1)<r?n=(0,tE.requestAnimationFrame)(o):((0,tE.cancelAnimationFrame)(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},e,t),i=s+1),i<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){let e=this.hot.getSettings()[is],t=iu.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return(0,V.isObject)(e)&&(t=e.syncLimit,(0,U.isPercentValue)(t)?t=(0,b.valueAccordingPercent)(i,t):t>>=0),Math.min(t,i)}getRowHeight(e,t){let i=e<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(e)),r=t;return null!==i&&i>(t||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return null!==(e=this.hot.getFirstRenderedVisibleRow())&&void 0!==e?e:-1}getLastVisibleRow(){var e;return null!==(e=this.hot.getLastRenderedVisibleRow())&&void 0!==e?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){let{from:t,to:i}="number"==typeof e?{from:e,to:e}:e;this.hot.batchExecution(()=>{(0,b.rangeEach)(Math.min(t,i),Math.max(t,i),e=>{this.rowHeightsMap.setValueAtIndex(e,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>null===e).length}destroy(){this.ghostTable.clean(),super.destroy()}}function ic(e){let t={from:0,to:this.hot.countCols()-1};e.forEach(e=>{this.samplesGenerator.generateRowSamples(e,t).forEach((e,t)=>this.ghostTable.addRow(t,e))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((e,t)=>{let i=this.hot.toPhysicalRow(e);this.rowHeightsMap.setValueAtIndex(i,t)})},!0),this.ghostTable.clean())}function id(){this.calculateVisibleRowsHeight(),this.inProgress||(io(ih,this,ic).call(this,ir(il,this)),ii(il,this,[]))}function ig(e,t,i){let r=e;return i&&(this.calculateRowsHeight(t,void 0,!0),r=this.getRowHeight(t)),r}function ip(e,t){t||this.recalculateAllRowsHeight()}function im(e){let t=e.reduce((e,t)=>{let[i]=t;return -1===e.indexOf(i)&&e.push(i),e},[]);ir(il,this).push(...t)}function iw(){this.recalculateAllRowsHeight(),ii(ia,this,!0)}function iy(e){if(!ir(ia,this))return;let t=e.reduce((e,t)=>{var i;let r=null===(i=t.address)||void 0===i?void 0:i.row;if(Number.isInteger(r)){let t=this.hot.toVisualRow(r);-1===e.indexOf(t)&&e.push(t)}return e},[]);ir(il,this).push(...t)}var iv=i(33774),ib=i(59932);let iC=new Map([["indexesSequence",{getListWithInsertedItems:iv.N,getListWithRemovedItems:iv.H}],["physicallyIndexed",{getListWithInsertedItems:ib.N,getListWithRemovedItems:ib.H}]]),iS=e=>{if(!1===iC.has(e))throw Error(`Alter strategy with ID '${e}' does not exist.`);return iC.get(e)};var iE=i(82505),iR=i(927);let{getListWithInsertedItems:iT,getListWithRemovedItems:ix}=iS("physicallyIndexed");class iM extends iE.n{constructor(){super(e=>e)}insert(e,t){let i=(0,iR.z)(this.indexedValues,t);this.indexedValues=iT(i,e,t,this.initValueOrFn),super.insert(e,t)}remove(e){let t=ix(this.indexedValues,e);this.indexedValues=(0,iR.v)(t,e),super.remove(e)}}let{getListWithInsertedItems:iO,getListWithRemovedItems:ik}=iS("physicallyIndexed");class iI extends iE.n{constructor(){super(e=>e)}insert(e,t){this.indexedValues=iO(this.indexedValues,e,t,(e,t)=>this.getNextValue(t)),super.insert(e,t)}remove(e){this.indexedValues=ik(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}let iA="bindRowsWithHeaders",iN=new Map([["loose",iM],["strict",iI]]);var iH=new WeakSet;class iP extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,iH),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[t]=null}(this,"headerIndexes",null)}static get PLUGIN_KEY(){return iA}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[iA]}enablePlugin(){var e;if(this.enabled)return;let t=null!==(e=iN.get(this.getSetting()))&&void 0!==e?e:iN.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new t),this.addHook("modifyRowHeader",e=>(function(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")})(iH,this,i_).call(this,e)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function i_(e){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(e))}var iL=i(57193);function iD(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function iF(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function iV(e,t,i){return e.set(iW(e,t),i),i}function iW(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let iB="collapsibleColumns",ij=["nestedHeaders"],iz="collapsibleIndicator",iU=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var i$=new WeakMap,iG=new WeakSet;class iY extends tC{constructor(){super(...arguments),function(e,t){iD(e,t),t.add(e)}(this,iG),iF(this,"nestedHeadersPlugin",null),iF(this,"headerStateManager",null),function(e,t,i){iD(e,t),t.set(e,null)}(this,i$,0)}static get PLUGIN_KEY(){return iB}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[iB,...ij]}isEnabled(){return!!this.hot.getSettings()[iB]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:t}=this.hot.getSettings();t||(0,iL.R8)("You need to configure the Nested Headers plugin in order to use collapsible headers."),iV(i$,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>iW(iG,this,iq).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return iW(iG,e,iJ).call(e,...i)}),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return iW(iG,e,iK).call(e,...i)}),this.addHook("beforeOnCellMouseDown",(e,t,i)=>iW(iG,this,iX).call(this,e,t,i)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:e}=this.hot.getSettings();"boolean"==typeof e?this.headerStateManager.mapState(e=>({collapsible:e.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),iV(i$,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;let{row:t,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:n,columnIndex:o}=null!==(e=this.headerStateManager.getHeaderTreeNodeData(t,i))&&void 0!==e?e:{};if(r)return n?this.expandSection({row:t,col:o}):this.collapseSection({row:t,col:o}),!1},runOnlyIf:()=>{var e,t;return(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader())},group:iB,relativeToGroup:W.b,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iB)}clearButtons(){if(!this.hot.view)return;let e=this.hot.view._wt.getSetting("columnHeaders").length,t=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,n=function(e){e&&e.parentNode.removeChild(e)};(0,b.rangeEach)(0,e-1,e=>{let o=t.childNodes[e],s=i.childNodes[e],l=r?r.childNodes[e]:null;(0,b.rangeEach)(0,o.childNodes.length-1,e=>{let t=o.childNodes[e].querySelector(`.${iz}`);n(t),s&&s.childNodes[e]&&n(t=s.childNodes[e].querySelector(`.${iz}`)),r&&l&&l.childNodes[e]&&n(t=l.childNodes[e].querySelector(`.${iz}`))})},!0)}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){let t=this.headerStateManager.mapNodes(t=>{let{collapsible:i,origColspan:r,headerLevel:n,columnIndex:o,isCollapsed:s}=t;if(!0===i&&r>1&&(s&&"expand"===e||!s&&"collapse"===e))return{row:this.headerStateManager.levelToRowCoords(n),col:o}});this.toggleCollapsibleSection(t,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,t){if(!iU.has(t))throw Error(`Unsupported action is passed (${t}).`);if(!Array.isArray(e))return;let i=(0,z.arrayFilter)(e,e=>{let{row:t}=e;return t<0}),r=i.length>0;(0,z.arrayEach)(i,e=>{var i;let{row:n,col:o}=e,{collapsible:s,isCollapsed:l}=null!==(i=this.headerStateManager.getHeaderSettings(n,o))&&void 0!==i?i:{};if(!s||l&&"collapse"===t||!l&&"expand"===t)return r=!1,!1});let n=[],o=[];r&&(0,z.arrayEach)(i,e=>{let{row:i,col:r}=e,{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(t,i,r);s>0&&(o.push(...l),n.push(a))});let s=this.getCollapsedColumns(),l=[];"collapse"===t?l=(0,z.arrayUnique)([...s,...o]):"expand"===t&&(l=(0,z.arrayFilter)(s,e=>!o.includes(e)));let a=iU.get(t);if(!1===this.hot.runHooks(a.beforeHook,s,l,r)){(0,z.arrayEach)(n,e=>{e()});return}this.hot.batchExecution(()=>{(0,z.arrayEach)(o,e=>{i$.get(iW(i$,this)).setValueAtIndex(this.hot.toPhysicalColumn(e),a.hideColumn)})},!0);let h=this.getCollapsedColumns().length!==s.length,u=this.hot.getSelectedRangeLast();if("collapse"===t&&h&&u){let{row:e,col:t}=u.highlight;if((this.hot.rowIndexMapper.isHidden(e)||this.hot.columnIndexMapper.isHidden(t))&&o.includes(t)){let i=e>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(e,1,!0):e,r=t>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(t,1,!0):t;null!==i&&null!==r&&this.hot.selectCell(i,r)}}this.hot.runHooks(a.afterHook,s,l,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return i$.get(iW(i$,this)).getHiddenIndexes()}destroy(){iV(i$,this,null),super.destroy()}}function iK(e,t,i){var r,n;let{collapsible:o,origColspan:s,isCollapsed:l}=null!==(r=this.headerStateManager.getHeaderSettings(i,e))&&void 0!==r?r:{},a=o&&s>1&&e>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags,u=t.querySelector(`.${iz}`);(0,y.removeAttribute)(t,[(0,M.dV)("")[0]]),a?(u||(u=this.hot.rootDocument.createElement("div"),(0,y.addClass)(u,iz),t.querySelector("div:first-child").appendChild(u)),(0,y.removeClass)(u,["collapsed","expanded"]),l?((0,y.addClass)(u,"collapsed"),(0,y.fastInnerText)(u,"+"),h&&(0,y.setAttribute)(t,...(0,M.dV)(!1))):((0,y.addClass)(u,"expanded"),(0,y.fastInnerText)(u,"-"),h&&(0,y.setAttribute)(t,...(0,M.dV)(!0))),h&&(0,y.setAttribute)(u,...(0,M.MG)())):null===(n=u)||void 0===n||n.remove()}function iX(e,t){(0,y.hasClass)(e.target,iz)&&((0,y.hasClass)(e.target,"expanded")?(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"collapse")):(0,y.hasClass)(e.target,"collapsed")&&(this.eventManager.fireEvent(e.target,"mouseup"),this.toggleCollapsibleSection([t],"expand")),(0,F.stopImmediatePropagation)(e))}function iq(){this.updatePlugin()}function iJ(e,t){t||this.updatePlugin()}var iZ=i(57496),iQ=i(88215);function i0(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let i1=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class i2{constructor(e,t){i0(this,"hot",void 0),i0(this,"sortingStates",new iQ.z),i0(this,"sortEmptyCells",!1),i0(this,"indicator",!0),i0(this,"headerAction",!0),i0(this,"compareFunctionFactory",void 0),i0(this,"mapName",void 0),this.hot=e,this.mapName=t,this.hot.columnIndexMapper.registerMap(t,this.sortingStates)}updateAllColumnsProperties(e){(0,V.isObject)(e)&&(0,V.objectEach)(e,(e,t)=>{i1.includes(t)&&(this[t]=e)})}getAllColumnsProperties(){let e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var t;return null===(t=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))||void 0===t?void 0:t.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(t=>{let[i]=t;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(e){return(0,V.isObject)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map(e=>{let[t,i]=e;return{column:this.hot.toVisualColumn(t),...i}})}getColumnSortState(e){let t=this.getSortOrderOfColumn(e);if((0,T.isDefined)(t))return{column:e,sortOrder:t}}setSortStates(e){this.sortingStates.clear();for(let t=0;t<e.length;t+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[t].column),{sortOrder:e[t].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function i3(e,t,i){let r=t.locale;return function(t,n){let{sortEmptyCells:o}=i;return("string"==typeof t&&(t=t.toLocaleLowerCase(r)),"string"==typeof n&&(n=n.toLocaleLowerCase(r)),t===n)?ri:(0,T.isEmpty)(t)?(0,T.isEmpty)(n)?ri:o&&"asc"===e?rr:rn:(0,T.isEmpty)(n)?o&&"asc"===e?rn:rr:isNaN(t)&&!isNaN(n)?"asc"===e?rn:rr:!isNaN(t)&&isNaN(n)?"asc"===e?rr:rn:(isNaN(t)||isNaN(n)||(t=parseFloat(t),n=parseFloat(n)),t<n)?"asc"===e?rr:rn:t>n?"asc"===e?rn:rr:ri}}i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(75036);let i5="default";var i9=i(21413);let{register:i8,getItem:i4,hasItem:i7}=(0,i9.A)("sorting.compareFunctionFactory"),{register:i6,getItem:re}=(0,i9.A)("sorting.mainSortComparator");function rt(e){return i7(e)?i4(e):i4(i5)}i8("checkbox",function(e,t,i){let r=t.checkedTemplate,n=t.uncheckedTemplate,{sortEmptyCells:o}=i;return function(s,l){let a=(0,T.isEmpty)(s),h=(0,T.isEmpty)(l),u=a?n:s,c=h?n:l,d=u===n||u===r,g=c===n||c===r;if(!1===o){if(a&&!1===h)return rn;if(!1===a&&h)return rr}return!1===d&&g?"asc"===e?rr:rn:d&&!1===g?"asc"===e?rn:rr:!1===d&&!1===g?i3(e,t,i)(s,l):u===n&&c===r?"asc"===e?rr:rn:u===r&&c===n?"asc"===e?rn:rr:ri}}),i8("date",function(e,t,i){return rd(e,t.dateFormat,i)}),i8(i5,i3),i8("numeric",function(e,t,i){return function(t,r){let n=parseFloat(t),o=parseFloat(r),{sortEmptyCells:s}=i;if(n===o||isNaN(n)&&isNaN(o))return ri;if(s){if((0,T.isEmpty)(t))return"asc"===e?rr:rn;if((0,T.isEmpty)(r))return"asc"===e?rn:rr}return isNaN(n)?rn:isNaN(o)?rr:n<o?"asc"===e?rr:rn:n>o?"asc"===e?rn:rr:ri}}),i8("time",function(e,t,i){return rd(e,t.timeFormat,i)});let ri=0,rr=-1,rn=1;var ro=i(83457);let rs="desc",rl="colHeader";function ra(e){return e===rs?void 0:"asc"===e?rs:"asc"}function rh(e){return e.querySelector(`.${rl}`)}function ru(e,t){if(e<0||!t.parentNode)return!1;let i=t.parentNode.parentNode.childNodes;return Array.from(i).indexOf(t.parentNode)-i.length==-1}function rc(e,t,i){return -1===e&&t>=0&&!1===(0,F.isRightClick)(i)}function rd(e,t,i){return function(r,n){let{sortEmptyCells:o}=i;if(r===n)return ri;if((0,T.isEmpty)(r))return(0,T.isEmpty)(n)?ri:o&&"asc"===e?rr:rn;if((0,T.isEmpty)(n))return o&&"asc"===e?rn:rr;let s=en(r,t),l=en(n,t);return s.isValid()?l.isValid()?l.isAfter(s)?"asc"===e?rr:rn:l.isBefore(s)?"asc"===e?rn:rr:ri:rr:rn}}let rg="indicatorDisabled",rf="columnSorting",rp="sortAction",rm=new Map([["asc","ascending"],[rs,"descending"]]);function rw(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function ry(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let rv="columnSorting",rb="append";i6(rv,function(e,t){return function(i,r){let[,...n]=i,[,...o]=r;return function(i){let r=e[0],s=t[0],l=n[i],a=o[i],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:rt(s.type))(r,s,h)(l,a)}(0)}}),d.R.getSingleton().register("beforeColumnSort"),d.R.getSingleton().register("afterColumnSort");let rC=new WeakMap;var rS=new WeakSet;class rE extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,rS),rw(this,"columnStatesManager",null),rw(this,"columnMetaCache",null),rw(this,"pluginKey",rv),rw(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return rv}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e,t,i=this;if(rC.has(this.hot)&&rC.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),e=rC.get(this.hot),t=this.pluginKey,(0,iL.R8)((0,ro.O)`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${e}\` will work. The \`${t}\` plugin will remain disabled.`);return}this.enabled||(rC.set(this.hot,this.pluginKey),this.columnStatesManager=new i2(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new tk._(e=>{let t=this.hot.toVisualColumn(e);return null===t&&(t=e),this.getMergedPluginSettings(t)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(e,t)=>ry(rS,this,rT).call(this,e,t)),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ry(rS,i,rM).call(i,...t)}),this.addHook("afterOnCellMouseDown",(e,t)=>this.onAfterOnCellMouseDown(e,t)),this.addHook("afterInit",()=>ry(rS,this,rR).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return ry(rS,i,rx).call(i,...t)}),this.hot.view&&ry(rS,this,rR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){let e=(e,t)=>{let i=rh(t);!1!==ru(e,t)&&null!==i&&this.updateHeaderClasses(i)};rC.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,t;let i=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return i&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&-1===i.row&&i.col>=0},relativeToGroup:W.b,position:"before",group:rv})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(rv)}sort(e){let t=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);!1!==this.hot.runHooks("beforeColumnSort",t,i,r)&&(0===t.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new iZ.K),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",t,r?i:t,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return(0,T.isDefined)(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){let t=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(t)&&this.columnStatesManager.setSortStates(t)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){let t=this.hot.countCols();return function(e){if(e.some(e=>!1===function(e){if(!1===(0,V.isObject)(e))return!1;let{column:t,sortOrder:i}=e;return Number.isInteger(t)&&["asc",rs].includes(i)}(e)))return!1;let t=e.map(e=>{let{column:t}=e;return t});return new Set(t).size===t.length}(e)&&e.every(e=>{let{column:i}=e;return i<=t&&i>=0})}saveAllSortSettings(e){let t=this.columnStatesManager.getAllColumnsProperties();t.initialConfig=(0,z.arrayMap)(e,e=>{let{column:t,...i}=e;return{column:this.hot.toPhysicalColumn(t),...i}}),this.hot.runHooks("persistentStateSave","columnSorting",t)}getAllSavedSortSettings(){let e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);let t=e.value;return(0,T.isDefined)(t)&&Array.isArray(t.initialConfig)&&(t.initialConfig=(0,z.arrayMap)(t.initialConfig,e=>{let{column:t,...i}=e;return{column:this.hot.toVisualColumn(t),...i}})),t}getColumnNextConfig(e){let t=this.columnStatesManager.getSortOrderOfColumn(e);if((0,T.isDefined)(t)){let i=ra(t);return(0,T.isDefined)(i)?{column:e,sortOrder:i}:void 0}let i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:ra()}}getNextSortConfig(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rb,i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=-1!==i,n=this.getSortConfig(),o=this.getColumnNextConfig(e);if(r){if((0,T.isUndefined)(o))return[...n.slice(0,i),...n.slice(i+1)];if(t===rb)return[...n.slice(0,i),...n.slice(i+1),o];if("replace"===t)return[...n.slice(0,i),o,...n.slice(i+1)]}return(0,T.isDefined)(o)?n.concat(o):n}getPluginColumnConfig(e){if((0,V.isObject)(e)){let t=e[this.pluginKey];if((0,V.isObject)(t))return t}return{}}getMergedPluginSettings(e){let t=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=Object.getPrototypeOf(this.hot.getCellMeta(0,e));return Array.isArray(r.columns)?Object.assign(i,t,this.getPluginColumnConfig(r.columns[e])):(0,G.isFunction)(r.columns)?Object.assign(i,t,this.getPluginColumnConfig(r.columns(e))):Object.assign(i,t)}getFirstCellSettings(e){let t=Object.create(this.hot.getCellMeta(0,e));return t[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),t}getNumberOfRowsToSort(e){let t=this.hot.getSettings();return t.maxRows<=e?t.maxRows:e-t.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===e.length)return;let t=[],i=this.hot.countRows(),r=t=>(0,z.arrayMap)(e,e=>this.hot.getDataAtCell(t,e.column));for(let e=0;e<this.getNumberOfRowsToSort(i);e+=1)t.push([this.hot.toPhysicalRow(e)].concat(r(e)));let n=(0,z.arrayMap)(t,e=>e[0]);!function(e,t){let i=re(t);for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];e.sort(i(...n))}(t,this.pluginKey,(0,z.arrayMap)(e,e=>e.sortOrder),(0,z.arrayMap)(e,e=>this.getFirstCellSettings(e.column)));for(let e=t.length;e<i;e+=1)t.push([e].concat(r(e)));let o=(0,z.arrayMap)(t,e=>e[0]),s=new Map((0,z.arrayMap)(n,(e,t)=>[e,o[t]])),l=(0,z.arrayMap)(this.hot.rowIndexMapper.getIndexesSequence(),e=>s.has(e)?s.get(e):e);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(e){if((0,V.isObject)(e)){this.columnStatesManager.updateAllColumnsProperties(e);let t=e.initialConfig;(Array.isArray(t)||(0,V.isObject)(t))&&this.sort(t)}else this.hot.render()}updateHeaderClasses(e){if((0,y.removeClass)(e,Array.from(rm.values()).concat(rp,rg,rf)),!1!==this.enabled){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];(0,y.addClass)(e,function(e,t,i,r){let n=[rf];if(r&&n.push(rp),!1===i)return n.push(rg),n;let o=e.getSortOrderOfColumn(t);return(0,T.isDefined)(o)&&n.push(rm.get(o)),n}(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,T.isDefined)(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,t){return this.getFirstCellSettings(t)[this.pluginKey].headerAction&&(0,y.hasClass)(e.target,rl)}onAfterOnCellMouseDown(e,t){if(!1!==rc(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(t.col));let e=this.hot.getActiveEditor(),i=this.getColumnNextConfig(t.col);null!=e&&e.isOpened()&&this.hot.getCellValidator(e.row,e.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var e;null===(e=this.columnStatesManager)||void 0===e||e.destroy(),super.destroy()}}function rR(){let e=this.getAllSavedSortSettings();if((0,V.isObject)(e))this.sortBySettings(e);else{let e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function rT(e,t){let i=rh(t);if(!1===ru(e,t)||null===i)return;let r=this.getFirstCellSettings(e)[this.pluginKey],n=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(i,this.columnStatesManager,e,n,o),this.hot.getSettings().ariaTags){let i=this.columnStatesManager.getSortOrderOfColumn(e);(0,y.setAttribute)(t,...(0,M._h)(i?`${i}ending`:"none"))}}function rx(e){!0===e&&this.hot.view&&ry(rS,this,rR).call(this)}function rM(e,t,i,r){!1!==rc(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function rO(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class rk{constructor(e,t){rO(this,"plugin",void 0),rO(this,"hot",void 0),rO(this,"endpoints",[]),rO(this,"settings",void 0),rO(this,"settingsType","array"),rO(this,"currentEndpoint",null),rO(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=t}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){let t=[],i=e;if(!i&&"function"==typeof this.settings){this.settingsType="function";return}return i||(i=this.settings),(0,z.arrayEach)(i,e=>{let i={};this.assignSetting(e,i,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(e,i,"reversedRowCoords",!1),this.assignSetting(e,i,"destinationRow",Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(e,i,"destinationColumn",Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(e,i,"sourceColumn",e.destinationColumn),this.assignSetting(e,i,"type","sum"),this.assignSetting(e,i,"forceNumeric",!1),this.assignSetting(e,i,"suppressDataTypeErrors",!0),this.assignSetting(e,i,"customFunction",null),this.assignSetting(e,i,"readOnly",!0),this.assignSetting(e,i,"roundFloat",!1),t.push(i)}),t}assignSetting(e,t,i,r){if("ranges"===i&&void 0===e[i]){t[i]=r;return}if("ranges"!==i||0!==e[i].length)if(void 0===e[i]){if(r instanceof Error)throw r;t[i]=r}else"destinationRow"===i&&t.reversedRowCoords?t[i]=this.hot.countRows()-e[i]-1:t[i]=e[i]}resetSetupBeforeStructureAlteration(e,t,i){if("function"!==this.settingsType)return;let r=e.indexOf("row")>-1?"row":"col",n=this.getAllEndpoints();(0,z.arrayEach)(n,n=>{"row"===r&&n.destinationRow>=t&&("insert_row"===e?n.alterRowOffset=i:"remove_row"===e&&(n.alterRowOffset=-1*i)),"col"===r&&n.destinationColumn>=t&&("insert_col"===e?n.alterColumnOffset=i:"remove_col"===e&&(n.alterColumnOffset=-1*i))}),this.resetAllEndpoints(n,!1)}resetSetupAfterStructureAlteration(e,t,i,r,n){let o=!(arguments.length>5)||void 0===arguments[5]||arguments[5];if("function"===this.settingsType){let e=()=>(this.hot.removeHook("beforeViewRender",e),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",e);return}let s=e.indexOf("row")>-1?"row":"col",l=e.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===e.indexOf("move_row");(0,z.arrayEach)(a,e=>{"row"===s&&e.destinationRow>=t&&(e.alterRowOffset=l*i),"col"===s&&e.destinationColumn>=t&&(e.alterColumnOffset=l*i)}),this.resetAllEndpoints(a,!h),h?(0,z.arrayEach)(a,e=>{this.extendEndpointRanges(e,t,r[0],r.length),this.recreatePhysicalRanges(e),this.clearOffsetInformation(e)}):(0,z.arrayEach)(a,e=>{this.shiftEndpointCoordinates(e,t)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,t,i,r){(0,z.arrayEach)(e.ranges,e=>{e[1]&&(t>=e[0]&&t<=e[1]?i>e[1]?e[1]+=r:i<e[0]&&(e[0]-=r):i>=e[0]&&i<=e[1]&&(e[1]-=r,t<=e[0]&&(e[0]+=1,e[1]+=1)))})}recreatePhysicalRanges(e){let t=e.ranges,i=[],r=[];(0,z.arrayEach)(t,e=>{let t=[];if(e[1])for(let i=e[0];i<=e[1];i++)t.push(this.hot.toPhysicalRow(i));else t.push(this.hot.toPhysicalRow(e[0]));r.push(t)}),(0,z.arrayEach)(r,e=>{let t=[];(0,z.arrayEach)(e,(r,n)=>{0===n?t.push(r):e[n]!==e[n-1]+1&&(t.push(e[n-1]),i.push(t),(t=[]).push(r)),n===e.length-1&&(t.push(r),i.push(t))})}),e.ranges=i}shiftEndpointCoordinates(e,t){e.alterRowOffset&&0!==e.alterRowOffset?(e.destinationRow+=e.alterRowOffset||0,(0,z.arrayEach)(e.ranges,i=>{(0,z.arrayEach)(i,(r,n)=>{r>=t&&(i[n]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&0!==e.alterColumnOffset&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];e.some(e=>{let t=e.alterRowOffset||0,i=e.alterColumnOffset||0;return!!(e.destinationRow+t>=this.hot.countRows()||e.destinationColumn+i>=this.hot.countCols())})||(this.cellsToSetCache=[],(0,z.arrayEach)(e,e=>{this.resetEndpointValue(e,t)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,z.arrayEach)(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){let t=[];this.cellsToSetCache=[],(0,z.arrayEach)(e,(e,i,r)=>{`${e[2]||""}`!=`${e[3]}`&&(0,z.arrayEach)(this.getAllEndpoints(),(e,n)=>{this.hot.propToCol(r[i][1])===e.sourceColumn&&-1===t.indexOf(n)&&t.push(n)})}),(0,z.arrayEach)(t,e=>{this.refreshEndpoint(this.getEndpoint(e))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{let t=this.hot.toVisualRow(e.destinationRow);if(null!==t){let i=this.hot.getCellMeta(t,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(t?i:0)),this.hot.toVisualColumn(e.destinationColumn+(t?r:0)),""])}setEndpointValue(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let n=this.hot.toVisualRow(e.destinationRow);if(null!==n){let i=this.hot.getCellMeta(n,e.destinationColumn);("init"===t||i.readOnly!==e.readOnly)&&(i.readOnly=e.readOnly,i.className="columnSummaryResult")}if((!0===e.roundFloat||Number.isInteger(e.roundFloat))&&!isNaN(e.result)){let t=e.roundFloat,i=0;Number.isInteger(t)&&(i=Math.min(Math.max(0,t),100)),e.result=e.result.toFixed(i)}i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){(0,iL.R8)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function rI(e){return null==e||isNaN(e)}function rA(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let rN="columnSummary";var rH=new WeakSet;class rP extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,rH),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[t]=null}(this,"endpoints",null)}static get PLUGIN_KEY(){return rN}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[rN]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[rN],this.endpoints=new rk(this,this.settings),this.addHook("afterInit",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return rA(rH,e,r_).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return rA(rH,e,rD).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return rA(rH,e,rL).call(e,...i)}),this.addHook("beforeCreateRow",(e,t,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",e,t,null,i)),this.addHook("beforeCreateCol",(e,t,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",e,t,null,i)),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(e,t,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",e,t,null,i)),this.addHook("afterCreateCol",(e,t,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",e,t,null,i)),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return rA(rH,e,rF).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e)}}calculateSum(e){let t=0;return(0,V.objectEach)(e.ranges,i=>{t+=this.getPartialSum(i,e.sourceColumn)}),t}getPartialSum(e,t){let i=0,r=e[1]||e[0],n=null,o=0;do{if(null!==(n=rI(n=this.getCellValue(r,t))?null:n)){let e=(`${n}`.split(".")[1]||[]).length||1;e>o&&(o=e)}i+=n||0,r-=1}while(r>=e[0]);return Math.round(i*10**o)/10**o}calculateMinMax(e,t){let i=null;return(0,V.objectEach)(e.ranges,r=>{let n=this.getPartialMinMax(r,e.sourceColumn,t);if(null===i&&null!==n&&(i=n),null!==n)switch(t){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n)}}),null===i?"Not enough data":i}getPartialMinMax(e,t,i){let r,n=null,o=e[1]||e[0];do{if(r=rI(r=this.getCellValue(o,t))?null:r,null===n)n=r;else if(null!==r)switch(i){case"min":n=Math.min(n,r);break;case"max":n=Math.max(n,r)}o-=1}while(o>=e[0]);return n}countEmpty(e,t){let i,r=0,n=e[1]||e[0];do null===(i=rI(i=this.getCellValue(n,t))?null:i)&&(r+=1),n-=1;while(n>=e[0]);return r}countEntries(e){let t=0,i=e.ranges;return(0,V.objectEach)(i,i=>{let r=void 0===i[1]?1:i[1]-i[0]+1,n=this.countEmpty(i,e.sourceColumn);t+=r,t-=n}),t}calculateAverage(e){return this.calculateSum(e)/this.countEntries(e)}getCellValue(e,t){let i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(t),n=this.hot.getSourceDataAtCell(e,t),o="";if(null!==i&&null!==r&&(o=this.hot.getCellMeta(i,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof n&&(n=n.replace(/,/,".")),n=parseFloat(n)),isNaN(n)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw Error((0,ro.O)`ColumnSummary plugin: cell at (${e}, ${t}) is not in a\x20
          numeric format. Cannot do the calculation.`);return n}}function r_(){this.endpoints.initEndpoints()}function rL(e){void 0!==e.columns&&this.endpoints.refreshCellMetas()}function rD(e,t){e&&"ColumnSummary.reset"!==t&&"ColumnSummary.set"!==t&&"loadData"!==t&&this.endpoints.refreshChangedEndpoints(e)}function rF(e,t){this.endpoints.resetSetupBeforeStructureAlteration("move_row",e[0],e.length,e,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",t,e.length,e,this.pluginName)}var rV=i(81174);function rW(e,t,i){rB(e,t),t.set(e,i)}function rB(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function rj(e,t){return e.get(rU(e,t))}function rz(e,t,i){return e.set(rU(e,t),i),i}function rU(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var r$=new WeakMap,rG=new WeakMap,rY=new WeakMap,rK=new WeakSet;class rX{constructor(){!function(e,t){rB(e,t),t.add(e)}(this,rK),rW(this,r$,!0),rW(this,rG,null),rW(this,rY,new ResizeObserver(e=>rU(rK,this,rq).call(this,e)))}setObservedElement(e){rz(rG,this,e)}unobserve(){rj(rY,this).unobserve(rj(rG,this))}observe(){rz(r$,this,!0),rj(rY,this).observe(rj(rG,this))}destroy(){rj(rY,this).disconnect()}}function rq(e){if(rj(r$,this)||!Array.isArray(e)||!e.length){rz(r$,this,!1);return}e.forEach(e=>{let{borderBoxSize:t}=e,{inlineSize:i,blockSize:r}=t[0];this.runLocalHooks("resize",i,r)})}function rJ(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function rZ(e,t){return e.get(r0(e,t))}function rQ(e,t,i){return e.set(r0(e,t),i),i}function r0(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}(0,V.mixin)(rX,rV.A);var r1=new WeakMap,r2=new WeakMap,r3=new WeakMap,r5=new WeakMap,r9=new WeakMap,r8=new WeakMap,r4=new WeakMap;class r7{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,t){var i=this;rJ(this,r1,void 0),rJ(this,r2,!1),rJ(this,r3,null),rJ(this,r5,void 0),rJ(this,r9,void 0),rJ(this,r8,!0),rJ(this,r4,new rX),rQ(r1,this,e),rQ(r2,this,t),rQ(r5,this,this.createEditor()),rQ(r9,this,rZ(r5,this).style),rZ(r4,this).setObservedElement(this.getInputElement()),rZ(r4,this).addLocalHook("resize",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("resize",...t)}),this.hide()}setPosition(e,t){rZ(r9,this).left=`${e}px`,rZ(r9,this).top=`${t}px`}setSize(e,t){if(e&&t){let i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${t}px`}}getSize(){return{width:(0,y.outerWidth)(this.getInputElement()),height:(0,y.outerHeight)(this.getInputElement())}}observeSize(){rZ(r4,this).observe()}resetSize(){let e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){this.getInputElement().readOnly=e}show(){rZ(r9,this).display="block",rQ(r8,this,!1)}hide(){rZ(r4,this).unobserve(),rZ(r8,this)||(rZ(r9,this).display="none"),rQ(r8,this,!0)}isVisible(){return"block"===rZ(r9,this).display}setValue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.getInputElement().value=e||""}getValue(){return this.getInputElement().value}isFocused(){return rZ(r1,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let e=rZ(r1,this).createElement("div"),t=rZ(r1,this).createElement("textarea");return e.style.display="none",rQ(r3,this,rZ(r1,this).createElement("div")),rZ(r3,this).setAttribute("dir",rZ(r2,this)?"rtl":"ltr"),(0,y.addClass)(rZ(r3,this),r7.CLASS_EDITOR_CONTAINER),rZ(r1,this).body.appendChild(rZ(r3,this)),(0,y.addClass)(e,r7.CLASS_EDITOR),(0,y.addClass)(t,r7.CLASS_INPUT),t.setAttribute("data-hot-input",!0),e.appendChild(t),rZ(r3,this).appendChild(e),e}getInputElement(){return rZ(r5,this).querySelector(`.${r7.CLASS_INPUT}`)}getEditorElement(){return rZ(r5,this)}destroy(){let e=rZ(r3,this)?rZ(r3,this).parentNode:null;rZ(r5,this).parentNode.removeChild(rZ(r5,this)),rQ(r5,this,null),rQ(r9,this,null),rZ(r4,this).destroy(),e&&e.removeChild(rZ(r3,this))}}function r6(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}(0,V.mixin)(r7,rV.A);class ne{constructor(e){r6(this,"wasLastActionShow",!0),r6(this,"showDebounced",null),r6(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,G.debounce)(e=>{this.wasLastActionShow&&this.runLocalHooks("show",e.from.row,e.from.col)},e)}destroy(){this.clearLocalHooks()}}(0,V.mixin)(ne,rV.A);let nt="---------";function ni(e,t){let i={};return(0,z.arrayEach)(e,e=>{e.forAll((e,r)=>{e>=0&&r>=0&&(i[e]||(i[e]=[]),i[e][r]=t(e,r))})}),i}function nr(e,t,i,r,n){(0,z.arrayEach)(e,e=>{e.forAll((e,o)=>{e>=0&&o>=0&&function(e,t,i,r,n,o){let s=n(e,t),l=r;s.className&&(l="vertical"===i?function(e,t){if(-1!==e.indexOf(t))return e;let i=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${i} ${t}`}(s.className,r):function(e,t){if(-1!==e.indexOf(t))return e;let i=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${i} ${t}`}(s.className,r)),o(e,t,"className",l)}(e,o,t,i,r,n)})})}function nn(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}function no(e,t){let i=!1;return Array.isArray(e)&&(0,z.arrayEach)(e,e=>(e.forAll((e,r)=>{if(e>=0&&r>=0&&t(e,r))return i=!0,!1}),i)),i}function ns(e,t){let i={top:0,left:0};if(t!==e.ownerDocument){let{frameElement:e}=t.defaultView,{top:r,left:n}=e.getBoundingClientRect();i.top=r,i.left=n}return i}function nl(e,t,i){na(e,t),t.set(e,i)}function na(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function nh(e,t,i){return e.set(nc(e,t),i),i}function nu(e,t){return e.get(nc(e,t))}function nc(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let nd="comments",ng="comment",nf="value",np="style",nm="readOnly",nw=`plugin:${nd}`;var ny=new WeakMap,nv=new WeakMap,nb=new WeakMap,nC=new WeakMap,nS=new WeakMap,nE=new WeakMap,nR=new WeakSet;class nT extends tC{constructor(){super(...arguments),function(e,t){na(e,t),t.add(e)}(this,nR),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"range",{}),nl(this,ny,null),nl(this,nv,null),nl(this,nb,!1),nl(this,nC,!1),nl(this,nS,null),nl(this,nE,"")}static get PLUGIN_KEY(){return nd}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[nd]}enablePlugin(){var e=this;this.enabled||(nu(ny,this)||(nh(ny,this,new r7(this.hot.rootDocument,this.hot.isRtl())),nu(ny,this).addLocalHook("resize",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return nc(nR,e,nH).call(e,...i)})),nu(nv,this)||nh(nv,this,new ne(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",e=>this.addToContextMenu(e)),this.addHook("afterRenderer",(e,t,i,r,n,o)=>nc(nR,this,nI).call(this,e,o)),this.addHook("afterScroll",()=>nc(nR,this,n_).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",e=>nc(nR,this,nP).call(this,e)),this.addHook("beforeCompositionStart",e=>nc(nR,this,nP).call(this,e)),this.addHook("afterSetTheme",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return nc(nR,e,nL).call(e,...i)}),nu(nv,this).addLocalHook("hide",()=>this.hide()),nu(nv,this).addLocalHook("show",(e,t)=>this.showAtCell(e,t)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){nu(nv,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let e=this.hot.getShortcutManager(),t=e.getContext("grid"),i=e.addContext(nw);t.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{let t=this.hot.getSelectedRangeLast();nh(nC,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(t),this.show(),this.focusEditor(),e.setActiveContextName(nw),this.hot._registerTimeout(()=>{nh(nC,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var e;return null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()},group:nd}),i.addShortcut({keys:[["Escape"]],callback:()=>{nu(ny,this).setValue(nu(nE,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>nu(ny,this).isVisible()&&nu(ny,this).isFocused(),group:nd}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>nu(ny,this).isVisible()&&nu(ny,this).isFocused(),group:nd}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{nu(ny,this).setValue(nu(ny,this).getValue()),this.hide(),e.setActiveContextName("grid")},group:nd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nd)}registerListeners(){let{rootDocument:e}=this.hot,t=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",e=>nc(nR,this,nO).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>nc(nR,this,nx).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>nc(nR,this,nk).call(this)),this.eventManager.addEventListener(t,"focus",()=>nc(nR,this,nN).call(this)),this.eventManager.addEventListener(t,"blur",()=>nc(nR,this,nA).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",e=>nc(nR,this,nM).call(this,e))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){let t=(0,y.closest)(e.target,"TD","TBODY");return!!(t&&(0,y.hasClass)(t,"htCommentCell")&&(0,y.closest)(t,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let t=nu(ny,this).getValue(),i="";null!=e?i=e:null!=t&&(i=t);let r=this.range.from.row,n=this.range.from.col;this.updateCommentMeta(r,n,{[nf]:i}),this.hot.render()}setCommentAtCell(e,t,i){this.setRange({from:this.hot._createCellCoords(e,t)}),this.setComment(i)}removeComment(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ng),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,t){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.setRange({from:this.hot._createCellCoords(e,t)}),this.removeComment(i)}getComment(){let e=this.range.from.row,t=this.range.from.col;return this.getCommentMeta(e,t,nf)}getCommentAtCell(e,t){return this.getCommentMeta(e,t,nf)}show(){var e;if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:t,col:i}}=this.range;if(t<0||t>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;let r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return nu(nv,this).cancelHiding(),nu(ny,this).setValue(null!==(e=r[ng]?r[ng][nf]:null)&&void 0!==e?e:""),nu(ny,this).show(),this.refreshEditor(!0),!0}showAtCell(e,t){return this.setRange({from:this.hot._createCellCoords(e,t)}),this.show()}hide(){nu(ny,this).hide()}refreshEditor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!e&&(!this.range.from||!nu(ny,this).isVisible()))return;let{rowIndexMapper:t,columnIndexMapper:i}=this.hot,{row:r,col:n}=this.range.from,o=t.getRenderableFromVisualIndex(r),s=i.getRenderableFromVisualIndex(n),l=null===o;nu(ny,this).setPosition(0,0),null===o&&(o=t.getRenderableFromVisualIndex(t.getNearestNotHiddenIndex(r,-1))),null===s&&(s=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n,-1)));let a=null===o,h=null===s;o=null!=o?o:0,s=null!=s?s:0;let{rootWindow:u,view:{_wt:c}}=this.hot,{wtTable:d}=c,g=c.getCell({row:o,col:s},!0),f=this.getCommentMeta(r,n,np);f?nu(ny,this).setSize(f.width,f.height):nu(ny,this).resetSize();let p=h?0:d.getColumnWidth(s),m=l&&!a?(0,y.outerHeight)(g):0,{left:w,top:b,width:C,height:S}=g.getBoundingClientRect(),{width:E,height:R}=nu(ny,this).getSize(),{innerWidth:T,innerHeight:x}=this.hot.rootWindow,M=this.hot.rootDocument.documentElement,O=(0,y.getScrollbarWidth)(this.hot.rootDocument),k=(0,y.hasVerticalScrollbar)(this.hot.rootWindow)?O:0,I=(0,y.hasHorizontalScrollbar)(this.hot.rootWindow)?O:0,A=w+u.scrollX+p,N=b+u.scrollY+m;this.hot.isRtl()&&(A-=E+p),this.hot.isLtr()&&w+C+E>T-k?A=w+u.scrollX-E-1:this.hot.isRtl()&&A<-(M.scrollWidth-M.clientWidth)&&(A=w+u.scrollX+p+1),b+R>x-I&&(N-=R-S+1),nu(ny,this).setPosition(A,N),nu(ny,this).setReadOnlyState(this.getCommentMeta(r,n,nm)),nu(ny,this).observeSize()}focusEditor(){nu(ny,this).focus()}updateCommentMeta(e,t,i){let r,n=this.hot.getCellMeta(e,t)[ng];n?(r=(0,V.deepClone)(n),(0,V.deepExtend)(r,i)):r=i,this.hot.setCellMeta(e,t,ng,r)}getCommentMeta(e,t,i){let r=this.hot.getCellMeta(e,t);if(r[ng])return r[ng][i]}addToContextMenu(e){var t,i,r;e.items.push({name:nt},(t=this,{key:"commentsAddEdit",name(){var e;let i=null===(e=this.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return null!=i&&i.isCell()&&t.getCommentAtCell(i.row,i.col)?this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){let e=this.getSelectedRangeLast();t.setRange(e),t.show(),t.focusEditor()},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(i=this,{key:"commentsRemove",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((e,t)=>{e>=0&&t>=0&&i.removeCommentAtCell(e,t,!1)}),this.render()},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(r=this,{key:"commentsReadOnly",name(){let e=this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return no(this.getSelectedRange(),(e,t)=>r.getCommentMeta(e,t,nm))?nn(e):e},callback(){this.getSelectedRangeLast().forAll((e,t)=>{if(e>=0&&t>=0){let i=!!r.getCommentMeta(e,t,nm);r.updateCommentMeta(e,t,{[nm]:!i})}})},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.highlight.isHeader()||!r.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}))}getEditorInputElement(){return nu(ny,this).getInputElement()}destroy(){var e,t;null===(e=nu(ny,this))||void 0===e||e.destroy(),null===(t=nu(nv,this))||void 0===t||t.destroy(),super.destroy()}}function nx(e){if(this.hot.view&&this.hot.view._wt&&!nu(nb,this)&&!this.targetIsCommentTextArea(e)){let t=(0,y.closest)(e.target,"TD","TBODY"),i=null;t&&(i=this.hot.getCoords(t)),(!t||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}function nM(e){e.stopPropagation()}function nO(e){let{rootDocument:t}=this.hot;if(!(nu(nb,this)||nu(ny,this).isFocused()||(0,y.hasClass)(e.target,"wtBorder"))&&nu(nS,this)!==e.target&&nu(ny,this))if(nh(nS,this,t.elementFromPoint(e.clientX,e.clientY)),this.targetIsCellWithComment(e)){let t=this.hot._createCellRange(this.hot.getCoords(e.target));nu(nv,this).show(t)}else(0,y.isChildOf)(e.target,t)&&!this.targetIsCommentTextArea(e)&&nu(nv,this).hide()}function nk(){nh(nb,this,!1)}function nI(e,t){t[ng]&&t[ng][nf]&&(0,y.addClass)(e,t.commentedCellClassName)}function nA(){nh(nE,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function nN(){nh(nE,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(nw)}function nH(e,t){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[np]:{width:e,height:t}})}function nP(e){nu(ny,this).isFocused()&&(0,F.stopImmediatePropagation)(e)}function n_(){nu(nC,this)||this.hide()}function nL(){let e=nu(ny,this).getEditorElement();(0,y.removeClass)(e,/ht-theme-.*/g),(0,y.addClass)(e,this.hot.getCurrentThemeName())}function nD(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(69607);class nF{constructor(e){nD(this,"hot",void 0),nD(this,"commands",{}),nD(this,"commonCallback",null),this.hot=e}registerCommand(e,t){this.commands[e]=t}setCommonCallback(e){this.commonCallback=e}execute(e){let t;for(var i,r,n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];let l=e.split(":"),a=l[0],h=2===l.length?l[1]:null,u=this.commands[a];if(!u)throw Error(`Menu command '${a}' not exists.`);if(h&&u.submenu&&(i=h,r=u.submenu.items,(0,z.arrayEach)(r,e=>{let r=e.key?e.key.split(":"):null;if(Array.isArray(r)&&r[1]===i)return t=e,!1}),u=t),!0===u.disabled||"function"==typeof u.disabled&&!0===u.disabled.call(this.hot)||(0,V.hasOwnProperty)(u,"submenu"))return;let c=[];"function"==typeof u.callback&&c.push(u.callback),"function"==typeof this.commonCallback&&c.push(this.commonCallback),o.unshift(l.join(":")),(0,z.arrayEach)(c,e=>e.apply(this.hot,o))}}let nV="alignment",nW="clear_column",nB="col_left",nj="col_right",nz="make_read_only",nU="redo";var n$=i(16932);let nG="remove_col",nY="remove_row",nK="row_above",nX="row_below",nq="no_items",nJ="undo",nZ=[nK,nX,nB,nj,nW,nY,nG,nJ,nU,nz,nV,nt,nq],nQ={[nt]:function(){return{name:nt}},[nq]:function(){return{key:nq,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}},[nK]:function(){return{key:nK,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){let e=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",e.row,1,"ContextMenu.rowAbove")},disabled(){let e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)||!!this.selection.isSelectedByCorner()&&0===this.countRows()},hidden(){return!this.getSettings().allowInsertRow}}},[nX]:function(){return{key:nX,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){let e=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",e.row,1,"ContextMenu.rowBelow")},disabled(){let e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByColumnHeader()||e.isSingleHeader()&&e.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[nB]:function(){return{key:nB,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){let e=this.getSelectedRangeLast().getTopLeftCorner(),t=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(t,e.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)||!!this.selection.isSelectedByCorner()&&0===this.countCols()},hidden(){return!this.getSettings().allowInsertColumn}}},[nj]:function(){return{key:nj,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){let e=this.getSelectedRangeLast().getTopRightCorner(),t=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(t,e.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let e=this.getSelectedRangeLast();return!!(!e||this.selection.isSelectedByRowHeader()||e.isSingleHeader()&&e.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[nW]:function(){return{key:nW,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(e,t){let i=t[0].start.col,r=t[0].end.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(t[0].start.row,t[0].end.row),r,"ContextMenu.clearColumn")},disabled(){let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let t=!1;return e.forAll((e,i)=>{if(e<0||i<0)return!0;let{readOnly:r}=this.getCellMeta(e,i);return!!r||(t=!0,!1)}),!t}}},[nY]:function(){return{key:nY,name(){let e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{let[i,,r]=e[0];i-r!=0&&(t=1)}return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_REMOVE_ROW,t)},callback(){this.alter("remove_row",(0,n$.f7)(this),1,"ContextMenu.removeRow")},disabled(){let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.row<0)return!0;let t=this.countRows();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByColumnHeader()||0===t},hidden(){return!this.getSettings().allowRemoveRow}}},[nG]:function(){return{key:nG,name(){let e=this.getSelected(),t=0;if(e)if(e.length>1)t=1;else{let[,i,,r]=e[0];i-r!=0&&(t=1)}return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_REMOVE_COLUMN,t)},callback(){this.alter("remove_col",(0,n$.NB)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader()&&e.highlight.col<0)return!0;let t=this.countCols();return this.selection.isSelectedByCorner()?0===t:this.selection.isSelectedByRowHeader()||0===t},hidden(){return!this.getSettings().allowRemoveColumn}}},[nJ]:function(){return{key:nJ,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_UNDO)},callback(){this.getPlugin("undoRedo").undo()},hidden(){let e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[nU]:function(){return{key:nU,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_REDO)},callback(){this.getPlugin("undoRedo").redo()},hidden(){let e=this.getPlugin("undoRedo");return!e||!e.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[nz]:function(){return{key:nz,checkable:!0,ariaChecked(){return no(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)},ariaLabel(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_READ_ONLY)},name(){let e=this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_READ_ONLY);return no(this.getSelectedRange(),(e,t)=>this.getCellMeta(e,t).readOnly)&&(e=nn(e)),e},callback(){let e=this.getSelectedRange(),t=no(e,(e,t)=>this.getCellMeta(e,t).readOnly);(0,z.arrayEach)(e,e=>{e.forAll((e,i)=>{e>=0&&i>=0&&this.setCellMeta(e,i,"readOnly",!t)})}),this.render()},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.isSingleHeader()||this.selection.isSelectedByCorner())||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}},[nV]:function(){return{key:nV,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let e=this.getSelectedRangeLast();return!!(!e||e.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${nV}:left`,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){let e=this.getSelectedRange(),t=ni(e,(e,t)=>this.getCellMeta(e,t).className),i="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",t,e,i,r),nr(e,i,r,(e,t)=>this.getCellMeta(e,t),(e,t,i,r)=>this.setCellMeta(e,t,i,r)),this.render()},disabled:!1},{key:`${nV}:center`,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){let e=this.getSelectedRange(),t=ni(e,(e,t)=>this.getCellMeta(e,t).className),i="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",t,e,i,r),nr(e,i,r,(e,t)=>this.getCellMeta(e,t),(e,t,i,r)=>this.setCellMeta(e,t,i,r)),this.render()},disabled:!1},{key:`${nV}:right`,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){let e=this.getSelectedRange(),t=ni(e,(e,t)=>this.getCellMeta(e,t).className),i="horizontal",r="htRight";this.runHooks("beforeCellAlignment",t,e,i,r),nr(e,i,r,(e,t)=>this.getCellMeta(e,t),(e,t,i,r)=>this.setCellMeta(e,t,i,r)),this.render()},disabled:!1},{key:`${nV}:justify`,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){let e=this.getSelectedRange(),t=ni(e,(e,t)=>this.getCellMeta(e,t).className),i="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",t,e,i,r),nr(e,i,r,(e,t)=>this.getCellMeta(e,t),(e,t,i,r)=>this.setCellMeta(e,t,i,r)),this.render()},disabled:!1},{name:nt},{key:`${nV}:top`,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){let e=this.getSelectedRange(),t=ni(e,(e,t)=>this.getCellMeta(e,t).className),i="vertical",r="htTop";this.runHooks("beforeCellAlignment",t,e,i,r),nr(e,i,r,(e,t)=>this.getCellMeta(e,t),(e,t,i,r)=>this.setCellMeta(e,t,i,r)),this.render()},disabled:!1},{key:`${nV}:middle`,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){let e=this.getSelectedRange(),t=ni(e,(e,t)=>this.getCellMeta(e,t).className),i="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",t,e,i,r),nr(e,i,r,(e,t)=>this.getCellMeta(e,t),(e,t,i,r)=>this.setCellMeta(e,t,i,r)),this.render()},disabled:!1},{key:`${nV}:bottom`,name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){let e=this.getSelectedRange(),t=ni(e,(e,t)=>this.getCellMeta(e,t).className),i="vertical",r="htBottom";this.runHooks("beforeCellAlignment",t,e,i,r),nr(e,i,r,(e,t)=>this.getCellMeta(e,t),(e,t,i,r)=>this.setCellMeta(e,t,i,r)),this.render()},disabled:!1}]}}}};function n0(){let e={};return(0,V.objectEach)(nQ,(t,i)=>{e[i]=t()}),e}function n1(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class n2{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n1(this,"hot",void 0),n1(this,"predefinedItems",n0()),n1(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=t}setPredefinedItems(e){let t={};this.defaultOrderPattern.length=0,(0,V.objectEach)(e,(e,i)=>{let r="";e.name===nt?(t[nt]=e,r=nt):(isNaN(parseInt(i,10))?(e.key=void 0===e.key?i:e.key,t[i]=e):t[e.key]=e,r=e.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=t}getItems(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],n=e;return n&&n.items?n=n.items:Array.isArray(n)||(n=t),(0,V.isObject)(n)?(0,V.objectEach)(n,(e,t)=>{let n=i["string"==typeof e?e:t];n||(n=e),(0,V.isObject)(e)?(0,V.extend)(n,e):"string"==typeof n&&(n={name:n}),void 0===n.key&&(n.key=t),r.push(n)}):(0,z.arrayEach)(n,(e,t)=>{let n=i[e];!n&&nZ.indexOf(e)>=0||(n||(n={name:e,key:`${t}`}),(0,V.isObject)(e)&&(0,V.extend)(n,e),void 0===n.key&&(n.key=t),r.push(n))}),r}(e,this.defaultOrderPattern,this.predefinedItems)}}function n3(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class n5{constructor(e,t){let i,r,n,o,s,l;n3(this,"top",void 0),n3(this,"topRelative",void 0),n3(this,"left",void 0),n3(this,"leftRelative",void 0),n3(this,"scrollTop",void 0),n3(this,"scrollLeft",void 0),n3(this,"cellHeight",void 0),n3(this,"cellWidth",void 0);let a=t.scrollY,h=t.scrollX;this.rootWindow=t,this.type=this.getSourceType(e),"literal"===this.type?(i=parseInt(e.top,10),n=parseInt(e.left,10),s=e.height||0,l=e.width||0,r=i,o=n,i+=a,n+=h):"event"===this.type&&(i=parseInt(e.pageY,10),n=parseInt(e.pageX,10),s=e.target.clientHeight,l=e.target.clientWidth,r=i-a,o=n-h),this.top=i,this.topRelative=r,this.left=n,this.leftRelative=o,this.scrollTop=a,this.scrollLeft=h,this.cellHeight=s,this.cellWidth=l}getSourceType(e){let t="literal";return e instanceof Event&&(t="event"),t}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=t}fitsOnRight(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function n9(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function n8(e,t){return e.get(n7(e,t))}function n4(e,t,i){return e.set(n7(e,t),i),i}function n7(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var n6=new WeakMap,oe=new WeakMap,ot=new WeakMap,oi=new WeakMap,or=new WeakMap;class on{constructor(e){n9(this,n6,void 0),n9(this,oe,void 0),n9(this,ot,void 0),n9(this,oi,!1),n9(this,or,{above:0,below:0,left:0,right:0}),n4(oi,this,e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n8(or,this)[e]=t,this}setElement(e){return n4(n6,this,e),this}setParentElement(e){return n4(oe,this,e),this}updatePosition(e){n4(ot,this,new n5(e,n8(n6,this).ownerDocument.defaultView)),n8(oi,this)?(n8(ot,this).fitsBelow(n8(n6,this))?this.setPositionBelowCursor():n8(ot,this).fitsAbove(n8(n6,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===n8(n6,this).dir?n8(ot,this).fitsOnLeft(n8(n6,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():n8(ot,this).fitsOnRight(n8(n6,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=n8(or,this).above+n8(ot,this).top-n8(n6,this).offsetHeight;if(n8(oe,this)){let t=n8(oe,this).ownerDocument.defaultView.getComputedStyle(n8(oe,this).querySelector(".ht_master")),i=Number.parseInt(t.paddingTop,10),r=Number.parseInt(t.borderTop,10);e=n8(ot,this).top+n8(ot,this).cellHeight-n8(n6,this).scrollHeight+i+r}n8(n6,this).style.top=`${e}px`}setPositionBelowCursor(){let e=n8(or,this).below+n8(ot,this).top+1;if(n8(oe,this)){let t=n8(oe,this).ownerDocument.defaultView.getComputedStyle(n8(oe,this).querySelector(".ht_master")),i=Number.parseInt(t.paddingTop,10),r=Number.parseInt(t.borderTop,10);e=n8(ot,this).top-i-r-1}n8(n6,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=n8(ot,this).left;if(n8(oe,this)){let t=Number.parseInt(n8(oe,this).ownerDocument.defaultView.getComputedStyle(n8(oe,this).querySelector(".htCore")).borderRightWidth,10);e+=n8(ot,this).cellWidth+t}else e+=n8(or,this).right;n8(n6,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=n8(or,this).left+n8(ot,this).left-n8(n6,this).offsetWidth;n8(oe,this)&&(e-=Number.parseInt(n8(oe,this).ownerDocument.defaultView.getComputedStyle(n8(oe,this).querySelector(".htCore")).borderLeftWidth,10)),n8(n6,this).style.left=`${e}px`}}function oo(e){let{initialPage:t=-1,size:i=()=>0,onItemSelect:r=()=>{},onClear:n=()=>{}}=e,o=new Set,s=(0,b.clamp)(t,-1,a()-1);function l(e,t){let i=a()-1;return(e<0&&(e=i),e>i&&(e=0),o.has(e))?-1:(o.add(e),!1===r(e,!1)&&(e=l(1===t?++e:--e,t)),e)}function a(){return Math.max(i(),0)}return{setCurrentPage:function(e){e>-1&&e<a()&&!1!==r(e,!0)&&(s=e)},getCurrentPage:function(){return s},toFirstItem:function(){a()>0&&(o.clear(),s=l(0,1))},toLastItem:function(){a()>0&&(o.clear(),s=l(a()-1,-1))},toNextItem:function(){a()>0&&(o.clear(),s=l(++s,1))},toPreviousItem:function(){a()>0&&(o.clear(),s=l(--s,-1))},getSize:a,clear:function(){o.clear(),s=t,n()}}}function ol(e){return(0,V.hasOwnProperty)(e,"submenu")}function oa(e){return RegExp(nt,"i").test(e.name)}function oh(e,t){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(t)}function ou(e){return(0,V.hasOwnProperty)(e,"disableSelection")}function oc(e,t){let i=e.slice(0);for(;0<i.length;)if(i[0].name===t)i.shift();else break;return i}let od="menu";function og(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function of(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function op(e,t,i){return e.set(ow(e,t),i),i}function om(e,t){return e.get(ow(e,t))}function ow(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var oy=new WeakMap,ov=new WeakMap,ob=new WeakMap;class oC{get tableBorderWidth(){return void 0===om(ob,this)&&this.hotMenu&&op(ob,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),om(ob,this)}constructor(e,t){var i=this;of(this,"hot",void 0),of(this,"options",void 0),of(this,"eventManager",new m.A(this)),of(this,"container",void 0),of(this,"positioner",void 0),of(this,"hotMenu",null),of(this,"hotSubMenus",{}),of(this,"parentMenu",void 0),of(this,"menuItems",null),of(this,"origOutsideClickDeselects",null),og(this,oy,void 0),og(this,ov,void 0),og(this,ob,void 0),this.hot=e,this.options=t||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new on(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.parentMenu.runLocalHooks("afterSelectionChange",...t)}),this.hot.addHook("afterSetTheme",(e,t)=>{if(!t){var i;null===(i=this.hotMenu)||void 0===i||i.useTheme(e)}})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"touchstart",e=>this.onDocumentMouseDown(e)),this.eventManager.addEventListener(e.document,"contextmenu",e=>this.onDocumentContextMenu(e)),e=(0,y.getParentWindow)(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return om(oy,this)}getKeyboardShortcutsCtrl(){return om(ov,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){var e,t;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let i=(0,G.debounce)(e=>this.openSubMenu(e),300),r=this.options.minWidth||215,n=!1,o=(0,z.arrayFilter)(this.menuItems,e=>{var t;return e.key===nq&&(n=!0),t=this.hot,!e.hidden||!("function"==typeof e.hidden&&e.hidden.call(t))});if(o.length<1&&!n)o.push(n0()[nq]);else if(0===o.length)return;o=function(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:nt,r=e.slice(0);return(t=(r=oc(r,i)).slice(0)).reverse(),(t=oc(t,i)).reverse(),r=function(e){let t=[];return(0,z.arrayEach)(e,(e,i)=>{i>0?t[t.length-1].name!==e.name&&t.push(e):t.push(e)}),t}(r=t)}(o,nt);let s=!1,l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:e=>(0,T.isDefined)(e)&&e<r?r:e,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(e=this.hot,(t,i,r,n,o,s)=>{let l=t.getSourceDataAtRow(r),a=e.rootDocument.createElement("div"),h="function"==typeof s?s.call(e):s,u="function"==typeof l.ariaLabel?l.ariaLabel.call(e):l.ariaLabel,c="function"==typeof l.ariaChecked?l.ariaChecked.call(e):l.ariaChecked;if((0,y.empty)(i),(0,y.addClass)(a,"htItemWrapper"),e.getSettings().ariaTags){let t=!oh(l,e)&&!ou(l)&&!oa(l);(0,y.setAttribute)(i,[...!0===l.checkable?[(0,M.pt)(),(0,M.SM)(u),(0,M.Xq)(c)]:[(0,M.ZA)(),(0,M.SM)(h)],...t?[(0,M.vC)(-1)]:[],...oh(l,e)?[(0,M._R)()]:[],...ol(l)?[(0,M.dV)(!1)]:[]])}i.className="",i.appendChild(a),oa(l)?(0,y.addClass)(i,"htSeparator"):"function"==typeof l.renderer?((0,y.addClass)(i,"htCustomMenuRenderer"),i.appendChild(l.renderer(t,a,r,n,o,h))):(0,y.fastInnerHTML)(a,h),oh(l,e)?(0,y.addClass)(i,"htDisabled"):ou(l)?(0,y.addClass)(i,"htSelectionDisabled"):ol(l)&&(0,y.addClass)(i,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(e,t)=>{om(oy,this).setCurrentPage(t.row)},afterOnCellMouseOver:(e,t)=>{this.isAllSubMenusClosed()?i(t.row):this.openSubMenu(t.row)},afterOnCellContextMenu:e=>{e.preventDefault(),(0,w.isWindowsOS)()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(e,t,i,r,n)=>{this.hotMenu.view.isMouseDown()&&(n.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:e=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(e))},afterOnCellMouseUp:e=>{(!(0,w.isWindowsOS)()||!(0,F.isRightClick)(e))&&s&&this.hasSelectedItem()&&((0,w.isMobileBrowser)()||(0,w.isIpadOS)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,l),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),op(oy,this,(t=this.hotMenu,oo({size:()=>t.countRows(),onItemSelect(e,i){let r=t.getCell(e,0);if(!r||(0,y.hasClass)(r,"htSeparator")||(0,y.hasClass)(r,"htDisabled")||(0,y.hasClass)(r,"htSelectionDisabled"))return!1;t.selectCell(e,0,...i?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}}))),op(ov,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];function r(e,t){s(t).addShortcuts(e,{group:od})}function n(e,t){let n=s(t);e.forEach(e=>{let{keys:t}=e;t.forEach(e=>n.removeShortcutsByKeys(e))}),i.push({shortcuts:e,contextName:t}),r(e,t)}function o(e){return e?`${od}:${e}`:od}function s(t){var i;let r=e.hotMenu.getShortcutManager(),n=o(t);return null!==(i=r.getContext(n))&&void 0!==i?i:r.addContext(n)}return r(function(e){let{hot:t,hotMenu:i}=e;return[{keys:[["Control/Meta","A"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:()=>e.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{let n=t.getSettings(),o="function"==typeof n.tabMoves?n.tabMoves(i):n.tabMoves;r.includes("shift")?t.selection.transformStart(-o.row,-o.col):t.selection.transformStart(o.row,o.col),e.close(!0)}},{keys:[["Escape"]],callback:()=>e.close()},{keys:[["ArrowDown"]],callback:()=>e.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>e.getNavigator().toPreviousItem()},{keys:[[t.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{let t=i.getSelectedLast();if(t){let i=e.openSubMenu(t[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[t.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{i.getSelectedLast()&&e.isSubMenu()&&(e.close(),e.isSubMenu()&&e.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>e.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>e.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:t=>{let r=i.getSelectedLast();r&&(i.getSourceDataAtRow(r[0]).submenu?e.openSubMenu(r[0]).getNavigator().toFirstItem():(e.executeCommand(t),e.close(!0)))}},{keys:[["PageUp"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(-i.countVisibleRows(),0):e.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(i.countVisibleRows(),0):e.getNavigator().toLastItem()}}]}(e)),t.forEach(e=>{let{shortcuts:t,contextName:i}=e;n(t,i)}),{addCustomShortcuts:n,getCustomShortcuts:function(){return[...i]},getContext:s,listen:function(t){e.hotMenu.getShortcutManager().setActiveContextName(o(t))}}}(this)),om(ov,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(om(oy,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let e=this.parentMenu.hotMenu.getSelectedLast();if(e){let t=this.parentMenu.hotMenu.getCell(e[0],0);(0,y.setAttribute)(t,[(0,M.dV)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;let t=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!t||!(0,y.hasClass)(t,"htSubmenu"))return!1;let i=this.hotMenu.getSourceDataAtRow(e),r=new oC(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(t.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&(0,y.setAttribute)(t,[(0,M.dV)(!0)]),r}closeSubMenu(e){let t=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[t.key];if(i){i.destroy(),delete this.hotSubMenus[t.key];let r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&(0,y.setAttribute)(r,[(0,M.dV)(!1)])}}closeAllSubMenus(){(0,z.arrayEach)(this.hotMenu.getData(),(e,t)=>this.closeSubMenu(t))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;let t=this.getSelectedItem();if(this.runLocalHooks("select",t,e),this.isCommandPassive(t))return;let i=this.hot.getSelectedRange(),r=i?(0,z.arrayMap)(i,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()})):[];this.runLocalHooks("executeCommand",t.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",t.key,r,e)}isCommandPassive(e){return!1===e.isCommand||oa(e)||oh(e,this.hot)||ol(e)}setOffset(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(e,t)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){let e=this.hotMenu.view.getStylesHandler(),{wtTable:t}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,r=t.hider.style,n=t.holder.style,o=parseInt(r.width,10),s=(0,z.arrayReduce)(i,(e,t,i)=>{let r=this.hotMenu.getCell(i,0)?(0,y.outerHeight)(this.hotMenu.getCell(i,0)):0;return e+(t.name===nt?1:r)},0);e.isClassicTheme()?(n.width=`${o+3}px`,n.height=`${s+3}px`):(n.width=`${o}px`,n.height=`${s}px`),r.height=n.height}createContainer(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.options.container.ownerDocument,r=t;return r&&((0,G.isFunction)(r)&&(r=null===(r=r.call(this.hot))||(0,T.isUndefined)(r)?"":r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,e=i.querySelector(`.${this.options.className}.${r}`)),e||(e=i.createElement("div"),(0,y.addClass)(e,`htMenu handsontable ${this.options.className}`),r&&(0,y.addClass)(e,r),this.options.container.appendChild(e)),e}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.hotMenu.rootElement,[(0,M.nF)(),(0,M.vC)(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,y.isChildOf)(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,y.isChildOf)(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&(0,y.hasClass)(e.target,"htCore")&&(0,y.isChildOf)(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}function oS(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function oE(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}(0,V.mixin)(oC,rV.A);let oR="contextMenu";d.R.getSingleton().register("afterContextMenuDefaultOptions"),d.R.getSingleton().register("beforeContextMenuShow"),d.R.getSingleton().register("afterContextMenuShow"),d.R.getSingleton().register("afterContextMenuHide"),d.R.getSingleton().register("afterContextMenuExecute");var oT=new WeakSet;class ox extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,oT),oS(this,"commandExecutor",new nF(this.hot)),oS(this,"itemsFactory",null),oS(this,"menu",null)}static get PLUGIN_KEY(){return oR}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nK,nX,nt,nB,nj,nt,nY,nG,nt,nJ,nU,nt,nz,nt,nV]}isEnabled(){return!!this.hot.getSettings()[oR]}enablePlugin(){var e=this;if(this.enabled)return;let t=this.hot.getSettings()[oR];"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.menu=new oC(this.hot,{className:"htContextMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>oE(oT,this,oO).call(this)),this.menu.addLocalHook("afterOpen",()=>oE(oT,this,ok).call(this)),this.menu.addLocalHook("afterClose",()=>oE(oT,this,oI).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.executeCommand.call(e,...i)}),this.addHook("afterOnCellContextMenu",e=>oE(oT,this,oM).call(this,e)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let t=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=ns(this.menu.container,this.hot.rootDocument);this.open({left:t.left+i.left,top:t.top+i.top-1+t.height},{left:t.width,above:-t.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;let t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&!this.menu.isOpened()},group:oR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oR)}open(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(t=this.menu)&&void 0!==t&&t.isOpened())return;this.prepareMenuItems(),this.menu.open();let r=this.menu.tableBorderWidth>0;(0,V.objectEach)(i,(e,t)=>{let i=["below","right"].includes(t)?e+1:e-1;this.menu.setOffset(t,r?e:i)}),this.menu.setPosition(e)}close(){var e;null===(e=this.menu)||void 0===e||e.close(),this.itemsFactory=null}executeCommand(e){null===this.itemsFactory&&this.prepareMenuItems();for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new n2(this.hot,ox.DEFAULT_ITEMS);let e=this.hot.getSettings()[oR],t={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",t),this.itemsFactory.setPredefinedItems(t.items);let i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),(0,z.arrayEach)(i,e=>this.commandExecutor.registerCommand(e.key,e))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function oM(e){let t=this.hot.getSettings(),i=t.rowHeaders,r=t.colHeaders,n=e.target;if(this.close(),(0,y.hasClass)(n,"handsontableInput"))return;if(e.preventDefault(),e.stopPropagation(),!(i||r)){if("TD"!==n.nodeName&&"TD"!==n.parentNode.nodeName&&!((0,y.hasClass)(n,"current")&&(0,y.hasClass)(n,"wtBorder")))return}let o=ns(this.menu.container,this.hot.rootDocument);this.open({top:e.clientY+o.top,left:e.clientX+o.left})}function oO(){this.hot.runHooks("beforeContextMenuShow",this)}function ok(){this.hot.runHooks("afterContextMenuShow",this)}function oI(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ox.SEPARATOR={name:nt};var oA=i(18045);class oN{constructor(){this.data={}}setData(e,t){this.data[e]=t}getData(e){return this.data[e]||void 0}}class oH{constructor(){this.clipboardData=new oN}preventDefault(){}composedPath(){return[]}}function oP(e,t,i){o_(e,t),t.set(e,i)}function o_(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function oL(e,t){return e.get(oF(e,t))}function oD(e,t,i){return e.set(oF(e,t),i),i}function oF(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var oV=new WeakMap,oW=new WeakMap,oB=new WeakMap,oj=new WeakMap,oz=new WeakMap,oU=new WeakMap,o$=new WeakSet;class oG{constructor(e){let{countRows:t,countColumns:i,rowsLimit:r,columnsLimit:n,countColumnHeaders:o}=e;!function(e,t){o_(e,t),t.add(e)}(this,o$),oP(this,oV,void 0),oP(this,oW,void 0),oP(this,oB,void 0),oP(this,oj,void 0),oP(this,oz,void 0),oP(this,oU,void 0),oD(oW,this,t),oD(oB,this,i),oD(oj,this,r),oD(oz,this,n),oD(oU,this,o)}setSelectedRange(e){oD(oV,this,e)}getCellsRange(){if(0===oL(oW,this).call(this)||0===oL(oB,this).call(this))return null;let{row:e,col:t}=oL(oV,this).getTopStartCorner(),{row:i,col:r}=oL(oV,this).getBottomEndCorner(),n=oF(o$,this,oK).call(this,e,i),o=oF(o$,this,oY).call(this,t,r);return{isRangeTrimmed:i!==n||r!==o,startRow:e,startCol:t,endRow:n,endCol:o}}getMostBottomColumnHeadersRange(){if(0===oL(oB,this).call(this)||0===oL(oU,this).call(this))return null;let{col:e}=oL(oV,this).getTopStartCorner(),{col:t}=oL(oV,this).getBottomEndCorner(),i=oF(o$,this,oY).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(0===oL(oB,this).call(this)||0===oL(oU,this).call(this))return null;let{col:e}=oL(oV,this).getTopStartCorner(),{col:t}=oL(oV,this).getBottomEndCorner(),i=oF(o$,this,oY).call(this,e,t);return{isRangeTrimmed:t!==i,startRow:-oL(oU,this).call(this),startCol:e,endRow:-1,endCol:i}}}function oY(e,t){return Math.min(t,Math.max(e+oL(oz,this).call(this)-1,e))}function oK(e,t){return Math.min(t,Math.max(e+oL(oj,this).call(this)-1,e))}function oX(e){let t=[],i=[];return(0,z.arrayEach)(e,e=>{let r=Math.min(e.startRow,e.endRow),n=Math.max(e.startRow,e.endRow);(0,b.rangeEach)(r,n,e=>{-1===t.indexOf(e)&&t.push(e)});let o=Math.min(e.startCol,e.endCol),s=Math.max(e.startCol,e.endCol);(0,b.rangeEach)(o,s,e=>{-1===i.indexOf(e)&&i.push(e)})}),{rows:t,columns:i}}var oq=i(11055);function oJ(e,t,i){oZ(e,t),t.set(e,i)}function oZ(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function oQ(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o0(e,t){return e.get(o2(e,t))}function o1(e,t,i){return e.set(o2(e,t),i),i}function o2(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("afterCopyLimit"),d.R.getSingleton().register("modifyCopyableRange"),d.R.getSingleton().register("beforeCut"),d.R.getSingleton().register("afterCut"),d.R.getSingleton().register("beforePaste"),d.R.getSingleton().register("afterPaste"),d.R.getSingleton().register("beforeCopy"),d.R.getSingleton().register("afterCopy");let o3="copyPaste",o5=["fragmentSelection"],o9='<meta name="generator" content="Handsontable"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>';var o8=new WeakMap,o4=new WeakMap,o7=new WeakMap,o6=new WeakMap,se=new WeakMap,st=new WeakMap,si=new WeakMap,sr=new WeakMap,sn=new WeakSet;class so extends tC{constructor(){super(...arguments),function(e,t){oZ(e,t),t.add(e)}(this,sn),oQ(this,"columnsLimit",1/0),oQ(this,"rowsLimit",1/0),oQ(this,"pasteMode","overwrite"),oQ(this,"uiContainer",this.hot.rootDocument.body),oJ(this,o8,!1),oJ(this,o4,!1),oJ(this,o7,!1),oJ(this,o6,"cells-only"),oJ(this,se,!1),oJ(this,st,!1),oJ(this,si,new oG({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oJ(this,sr,!1),oQ(this,"copyableRanges",[])}static get PLUGIN_KEY(){return o3}static get SETTING_KEYS(){return[o3,...o5]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[o3]}enablePlugin(){var e,t,i=this;this.enabled||(this.pasteMode=null!==(e=this.getSetting("pasteMode"))&&void 0!==e?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),o1(o8,this,this.getSetting("copyColumnHeaders")),o1(o4,this,this.getSetting("copyColumnGroupHeaders")),o1(o7,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(t=this.getSetting("uiContainer"))&&void 0!==t?t:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",e=>o2(sn,this,su).call(this,e)),this.addHook("afterSelection",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return o2(sn,i,sc).call(i,...t)}),this.addHook("afterSelectionEnd",()=>o2(sn,this,sd).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),(0,w.isSafari)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return o2(sn,i,sg).call(i,...t)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return o2(sn,i,sf).call(i,...t)}),this.addHook("afterSelection",()=>o2(sn,this,sp).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";o1(o6,this,e),o1(se,this,!0),o2(sn,this,ss).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){o1(st,this,!0),o2(sn,this,ss).call(this,"cut")}getRangedCopyableData(e){return(0,oA.A)(this.getRangedData(e))}getRangedData(e){let t=[],{rows:i,columns:r}=oX(e);return(0,z.arrayEach)(i,e=>{let i=[];(0,z.arrayEach)(r,t=>{e<0?i.push(this.hot.getColHeader(t,e)):i.push(this.hot.getCopyableData(e,t))}),t.push(i)}),t}paste(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;if(!e&&!t)return;let i=new oH;e&&i.clipboardData.setData("text/plain",e),t&&i.clipboardData.setData("text/html",t),this.onPaste(i)}setCopyableText(){let e=this.hot.getSelectedRangeLast();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}o0(si,this).setSelectedRange(e);let t=new Map([["headers",null],["cells",null]]);"column-headers-only"===o0(o6,this)?t.set("headers",o0(si,this).getMostBottomColumnHeadersRange()):("with-column-headers"===o0(o6,this)?t.set("headers",o0(si,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===o0(o6,this)&&t.set("headers",o0(si,this).getAllColumnHeadersRange()),t.set("cells",o0(si,this).getCellsRange())),this.copyableRanges=Array.from(t.values()).filter(e=>null!==e).map(e=>{let{startRow:t,startCol:i,endRow:r,endCol:n}=e;return{startRow:t,startCol:i,endRow:r,endCol:n}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let i=t.get("cells");if(null!==i&&i.isRangeTrimmed){let{startRow:e,startCol:t,endRow:r,endCol:n}=i;this.hot.runHooks("afterCopyLimit",r-e+1,n-t+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return null===(e=this.hot.getActiveEditor())||void 0===e?void 0:e.isOpened()}populateValues(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!e.length)return;let i=e.length,r=e[0].length,n=[],{row:o,col:s}=t.getTopStartCorner(),{row:l,col:a}=t.getBottomEndCorner(),h=o,u=s,c=o,d=s;for(;n.length<i||h<=l;){let{skipRowOnPaste:t,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===t)continue;c=l,u=s;let g=[],f=n.length%i;for(;g.length<r||u<=a;){let{skipColumnOnPaste:t,visualCol:i}=this.hot.getCellMeta(o,u);if(u=i+1,!0===t)continue;d=i;let n=g.length%r;g.push(e[f][n])}n.push(g)}return o1(sr,this,!0),this.hot.populateFromArray(o,s,n,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,c,d]}onCopy(e){let t=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=null==t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!o0(se,this)||this.isEditorOpened()||(0,y.isHTMLElement)(t)&&(r&&t!==i||!r&&t!==this.hot.rootDocument.body&&!(0,y.isInternalElement)(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),o1(se,this,!1);let n=this.getRangedData(this.copyableRanges),o=o2(sn,this,sl).call(this,this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges,o)){let t=(0,oA.A)(n);if(e&&e.clipboardData){let i=(0,oq._dataToHTML)(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[o9,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.runHooks("afterCopy",n,this.copyableRanges,o)}o1(o6,this,"cells-only")}onCut(e){let t=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=null==t?void 0:t.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!o0(st,this)||this.isEditorOpened()||(0,y.isHTMLElement)(t)&&(r&&t!==i||!r&&t!==this.hot.rootDocument.body&&!(0,y.isInternalElement)(t,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),o1(st,this,!1);let n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){let t=(0,oA.A)(n);if(e&&e.clipboardData){let i=(0,oq._dataToHTML)(n,this.hot.rootDocument);e.clipboardData.setData("text/plain",t),e.clipboardData.setData("text/html",[o9,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",t);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}}onPaste(e){let t,i=e.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),n=null==i?void 0:i.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||(0,y.isHTMLElement)(i)&&(n&&i!==r||!n&&i!==this.hot.rootDocument.body&&!(0,y.isInternalElement)(i,this.hot.rootElement)))return;if(e.preventDefault(),e&&void 0!==e.clipboardData){let i=(0,U.sanitize)(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});t=i&&/(<table)|(<TABLE)/g.test(i)?(0,oq.htmlToGridSettings)(i,this.hot.rootDocument).data:e.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(t=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof t&&(t=(0,oA.q)(t)),void 0===t||t&&0===t.length||!1===this.hot.runHooks("beforePaste",t,this.copyableRanges))return;let[o,s,l,a]=this.populateValues(t);this.hot.selectCell(o,s,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,a)),this.hot.runHooks("afterPaste",t,this.copyableRanges)}destroy(){super.destroy()}}function ss(e){if((0,w.isSafari)()){let t=this.hot.getSelectedRangeLast();if(t){let{row:i,col:r}=t.highlight,n=this.hot.getCell(i,r,!0);n&&(0,y.runWithSelectedContendEditableElement)(n,()=>{this.hot.rootDocument.execCommand(e)})}}else this.hot.rootDocument.execCommand(e)}function sl(e){let{rows:t}=oX(e),i=0;for(let e=0;e<t.length&&!(t[e]>=0);e++)i+=1;return{columnHeadersCount:i}}function sa(){if(this.hot.isListening()){let e=this.hot.getSelectedRangeLast();if(e){let{row:t,col:i}=e.highlight,r=this.hot.getCell(t,i,!0);r&&(0,y.makeElementContentEditableAndSelectItsContent)(r)}}}function sh(){if(this.hot.isListening()){let e=this.hot.getSelectedRangeLast();if(e){let{row:t,col:i}=e.highlight,r=this.hot.getCell(t,i,!0);null!=r&&r.hasAttribute("contenteditable")&&(0,y.removeContentEditableFromElementAndDeselect)(r)}}}function su(e){var t,i,r,n,o;e.items.push({name:"---------"},(t=this,{key:"copy",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_COPY)},callback(){t.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let t=this.getSelected();return!t||!!(t.length>1)},hidden:!1})),o0(o8,this)&&e.items.push((i=this,{key:"copy_with_column_headers",name(){let e=this.getSelectedRangeLast(),t=e?(0,b.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,t)},callback(){i.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let t=this.getSelected();return!t||!!(t.length>1)},hidden:!1})),o0(o4,this)&&e.items.push((r=this,{key:"copy_with_column_group_headers",name(){let e=this.getSelectedRangeLast(),t=e?(0,b.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,t)},callback(){r.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let t=this.getSelected();return!t||!!(t.length>1)},hidden:!1})),o0(o7,this)&&e.items.push((n=this,{key:"copy_column_headers_only",name(){let e=this.getSelectedRangeLast(),t=e?(0,b.clamp)(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,t)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let t=this.getSelected();return!t||!!(t.length>1)},hidden:!1})),e.items.push((o=this,{key:"cut",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_CUT)},callback(){o.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let e=this.getSelectedRangeLast();if(!e||e.isSingleHeader())return!0;let t=this.getSelected();return!t||!!(t.length>1)},hidden:!1}))}function sc(e,t,i,r,n){o0(sr,this)&&(n.value=!0),o1(sr,this,!1)}function sd(){!this.isEditorOpened()&&(this.hot.getSettings().fragmentSelection||this.setCopyableText())}function sg(){o2(sn,this,sh).call(this)}function sf(){o2(sn,this,sa).call(this)}function sp(){o2(sn,this,sh).call(this)}function sm(e,t){return`border_row${e}col${t}`}function sw(){return{width:1,color:"#000"}}function sy(){return{hide:!0}}function sv(e){var t,i;return((0,T.isDefined)(e.start)||(0,T.isDefined)(e.left))&&(e.start=null!==(t=e.start)&&void 0!==t?t:e.left),((0,T.isDefined)(e.end)||(0,T.isDefined)(e.right))&&(e.end=null!==(i=e.end)&&void 0!==i?i:e.right),delete e.left,delete e.right,e}function sb(e){return(0,T.isDefined)(e.start)&&(e.left=e.start),(0,T.isDefined)(e.end)&&(e.right=e.end),e}function sC(e,t){return{id:sm(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:sy(),bottom:sy(),start:sy(),end:sy()}}function sS(e,t){let i=!1;return(0,z.arrayEach)(e.getSelectedRange(),r=>{r.forAll((r,n)=>{if(r<0||n<0)return;let o=e.getCellMeta(r,n).borders;if(o){if(!t)return i=!0,!1;else if(!(0,V.hasOwnProperty)(o[t],"hide")||!1===o[t].hide)return i=!0,!1}})}),i}function sE(e){return`<span class="selected">${String.fromCharCode(10003)}</span>${e}`}let sR=new Map([["left","start"],["right","end"]]);function sT(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let sx="customBorders";var sM=new WeakSet;class sO extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,sM),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"savedBorders",[])}static get PLUGIN_KEY(){return sx}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[sx]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>sT(sM,this,sk).call(this,e)),this.addHook("init",()=>sT(sM,this,sI).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,t){let i=["top","bottom","start","end"],r=null;t&&(this.checkSettingsCohesion([t]),i=Object.keys(t),r=sv(t));let n=(0,n$.ML)(e),o=(0,n$._e)(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,z.arrayEach)(e,e=>{o(e).forAll((e,t)=>{(0,z.arrayEach)(i,i=>{var n;this.prepareBorderFromCustomAdded(e,t,r,null!==(n=sR.get(i))&&void 0!==n?n:i)})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;let t=(0,n$.ML)(e),i=(0,n$._e)(t,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return(0,z.arrayEach)(e,e=>{i(e).forAll((e,t)=>{(0,z.arrayEach)(this.savedBorders,i=>{i.row===e&&i.col===t&&r.push(sb(i))})})}),r}clearBorders(e){e?this.setBorders(e):((0,z.arrayEach)(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange(),this.hot.removeCellMeta(e.row,e.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,t){this.checkSavedBorders(e)||this.savedBorders.push(e);let i=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,i,t)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:i})}prepareBorderFromCustomAdded(e,t,i,r){let n=this.hot.countRows(),o=this.hot.countCols();if(e>=n||t>=o)return;let s=sC(e,t);if(i){var l;l=s,(0,V.hasOwnProperty)(i,"border")&&i.border&&(l.border=i.border),(0,V.hasOwnProperty)(i,"top")&&(0,T.isDefined)(i.top)&&(i.top?(0,V.isObject)(i.top)||(i.top=sw()):i.top=sy(),l.top=i.top),(0,V.hasOwnProperty)(i,"bottom")&&(0,T.isDefined)(i.bottom)&&(i.bottom?(0,V.isObject)(i.bottom)||(i.bottom=sw()):i.bottom=sy(),l.bottom=i.bottom),(0,V.hasOwnProperty)(i,"start")&&(0,T.isDefined)(i.start)&&(i.start?(0,V.isObject)(i.start)||(i.start=sw()):i.start=sy(),l.start=i.start),(0,V.hasOwnProperty)(i,"end")&&(0,T.isDefined)(i.end)&&(i.end?(0,V.isObject)(i.end)||(i.end=sw()):i.end=sy(),l.end=i.end),s=l,(0,z.arrayEach)(this.hot.selection.highlight.customSelections,e=>{if(s.id===e.settings.id)return Object.assign(e.settings,i),s.id=e.settings.id,s.top=e.settings.top,s.bottom=e.settings.bottom,s.start=e.settings.start,s.end=e.settings.end,!1})}this.hot.setCellMeta(e,t,"borders",sb(s)),this.insertBorderIntoSettings(s,r)}prepareBorderFromCustomAddedRange(e,t){let i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);(0,b.rangeEach)(e.from.row,i,i=>{(0,b.rangeEach)(e.from.col,r,r=>{let n=sC(i,r),o=0;i===e.from.row&&(0,V.hasOwnProperty)(t,"top")&&(o+=1,n.top=t.top),i===e.to.row&&(0,V.hasOwnProperty)(t,"bottom")&&(o+=1,n.bottom=t.bottom),r===e.from.col&&(0,V.hasOwnProperty)(t,"start")&&(o+=1,n.start=t.start),r===e.to.col&&(0,V.hasOwnProperty)(t,"end")&&(o+=1,n.end=t.end),o>0&&(this.hot.setCellMeta(i,r,"borders",sb(n)),this.insertBorderIntoSettings(n))})})}removeAllBorders(e,t){let i=sm(e,t);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,t,"borders")}setBorder(e,t,i,r){let n=this.hot.getCellMeta(e,t).borders;n=n&&void 0!==n.border?sv(n):sC(e,t),r?(n[i]=sy(),4===this.countHide(n)?this.removeAllBorders(e,t):(this.checkCustomSelectionsFromContextMenu(n,i,r)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(e,t,"borders",sb(n)))):(n[i]=sw(),this.checkCustomSelectionsFromContextMenu(n,i,r)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(e,t,"borders",sb(n)))}prepareBorder(e,t,i){(0,z.arrayEach)(e,e=>{let{start:r,end:n}=e;if(r.row===n.row&&r.col===n.col)"noBorders"===t?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,t,i);else switch(t){case"noBorders":(0,b.rangeEach)(r.col,n.col,e=>{(0,b.rangeEach)(r.row,n.row,t=>{this.removeAllBorders(t,e)})});break;case"top":(0,b.rangeEach)(r.col,n.col,e=>{this.setBorder(r.row,e,t,i)});break;case"bottom":(0,b.rangeEach)(r.col,n.col,e=>{this.setBorder(n.row,e,t,i)});break;case"start":(0,b.rangeEach)(r.row,n.row,e=>{this.setBorder(e,r.col,t,i)});break;case"end":(0,b.rangeEach)(r.row,n.row,e=>{this.setBorder(e,n.col,t,i)})}})}createCustomBorders(e){(0,z.arrayEach)(e,e=>{let t=sv(e);e.range?this.prepareBorderFromCustomAddedRange(e.range,t):this.prepareBorderFromCustomAdded(e.row,e.col,t)})}countHide(e){let{top:t,bottom:i,start:r,end:n}=e;return(0,z.arrayReduce)([t,i,r,n],(e,t)=>{let i=e;return t&&t.hide&&(i+=1),i},0)}clearBordersFromSelectionSettings(e){let t=(0,z.arrayMap)(this.hot.selection.highlight.customSelections,e=>e.settings.id).indexOf(e);t>-1&&this.hot.selection.highlight.customSelections[t].clear()}clearNullCellRange(){(0,z.arrayEach)(this.hot.selection.highlight.customSelections,(e,t)=>{if(null===e.cellRange)return this.hot.selection.highlight.customSelections[t].destroy(),this.hot.selection.highlight.customSelections.splice(t,1),!1})}hideBorders(){(0,z.arrayEach)(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){let t=(0,z.arrayMap)(this.savedBorders,e=>e.id).indexOf(e);t>-1&&this.savedBorders.splice(t,1)}checkSavedBorders(e){let t=!1;return 4===this.countHide(e)?(this.spliceBorder(e.id),t=!0):(0,z.arrayEach)(this.savedBorders,(i,r)=>{if(e.id===i.id)return this.savedBorders[r]=e,t=!0,!1}),t}checkCustomSelectionsFromContextMenu(e,t,i){let r=!1;return(0,z.arrayEach)(this.hot.selection.highlight.customSelections,n=>{if(e.id===n.settings.id){let e=this.hot.view._wt.selectionManager.getBorderInstances(n);return(0,z.arrayEach)(e,e=>{e.toggleHiddenClass(t,i)}),r=!0,!1}}),r}checkCustomSelections(e,t,i){let r=this.countHide(e),n=!1;return 4===r?(this.removeAllBorders(e.row,e.col),n=!0):(0,z.arrayEach)(this.hot.selection.highlight.customSelections,r=>{if(e.id===r.settings.id){if(r.visualCellRange=t,r.commit(),i){let t=this.hot.view._wt.selectionManager.getBorderInstances(r);(0,z.arrayEach)(t,t=>{t.changeBorderStyle(i,e)})}return n=!0,!1}}),n}changeBorderSettings(){let e=this.hot.getSettings()[sx];if(Array.isArray(e)){let t=(0,V.deepClone)(e);this.checkSettingsCohesion(t),t.length||(this.savedBorders=t),this.createCustomBorders(t)}else void 0!==e&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){let t=e.some(e=>(0,T.isDefined)(e.left)||(0,T.isDefined)(e.right)),i=e.some(e=>(0,T.isDefined)(e.start)||(0,T.isDefined)(e.end));if(t&&i)throw Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&t)throw Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function sk(e){if(this.hot.getSettings()[sx]){var t,i,r;e.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_BORDERS)},disabled(){let e=this.getSelectedRangeLast();return!!(!e||e.isSingleHeader())||this.selection.isSelectedByCorner()},submenu:{items:[(t=this,{key:"borders:top",name(){let e=this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_BORDERS_TOP);return sS(this,"top")&&(e=sE(e)),e},callback(e,i){let r=sS(this,"top");t.prepareBorder(i,"top",r)}}),function(e){let t=e.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let e=this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return sS(this,t)&&(e=sE(e)),e},callback(i,r){let n=sS(this,t);e.prepareBorder(r,t,n)}}}(this),(i=this,{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return sS(this,"bottom")&&(e=sE(e)),e},callback(e,t){let r=sS(this,"bottom");i.prepareBorder(t,"bottom",r)}}),function(e){let t=e.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let e=this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_BORDERS_LEFT);return sS(this,t)&&(e=sE(e)),e},callback(i,r){let n=sS(this,t);e.prepareBorder(r,t,n)}}}(this),(r=this,{key:"borders:no_borders",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(e,t){r.prepareBorder(t,"noBorders")},disabled(){return!sS(this)}})]}})}}function sI(){this.changeBorderSettings()}function sA(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function sN(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let sH="dragToScroll";var sP=new WeakSet;class s_ extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,sP),sA(this,"boundaries",null),sA(this,"callback",null),sA(this,"listening",!1)}static get PLUGIN_KEY(){return sH}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[sH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>sN(sP,this,sL).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>sN(sP,this,sL).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,t){let i=0,r=0;t<this.boundaries.top?r=t-this.boundaries.top:t>this.boundaries.bottom&&(r=t-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:e}=this.hot,t=e;for(;t;)this.eventManager.addEventListener(t.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(t.document,"mousemove",e=>this.onMouseMove(e)),t=(0,y.getParentWindow)(t)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function sL(e){if((0,F.isRightClick)(e))return;let t=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(t!==this.hot.rootWindow?t.getBoundingClientRect():void 0),this.setCallback((e,i)=>{var r,n;let o=null!==(r=t.scrollLeft)&&void 0!==r?r:t.scrollX,s=null!==(n=t.scrollTop)&&void 0!==n?n:t.scrollY;t.scroll(o+50*Math.sign(e),s+20*Math.sign(i))}),this.listen()}function sD(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function sF(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function sV(e,t,i){return e.set(sW(e,t),i),i}function sW(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("afterDropdownMenuDefaultOptions"),d.R.getSingleton().register("beforeDropdownMenuShow"),d.R.getSingleton().register("afterDropdownMenuShow"),d.R.getSingleton().register("afterDropdownMenuHide"),d.R.getSingleton().register("afterDropdownMenuExecute");let sB="dropdownMenu",sj="changeType";var sz=new WeakMap,sU=new WeakSet;class s$ extends tC{static get PLUGIN_KEY(){return sB}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nB,nj,nt,nG,nt,nW,nt,nz,nt,nV]}constructor(e){super(e),function(e,t){sD(e,t),t.add(e)}(this,sU),sF(this,"commandExecutor",new nF(this.hot)),sF(this,"itemsFactory",null),sF(this,"menu",null),function(e,t,i){sD(e,t),t.set(e,i)}(this,sz,!1),this.hot.addHook("afterGetColHeader",(e,t)=>sW(sU,this,sK).call(this,e,t))}isEnabled(){return this.hot.getSettings()[sB]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new n2(this.hot,s$.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return sW(sU,e,s0).call(e,...i)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return sW(sU,e,sQ).call(e,...i)});let t=this.hot.getSettings()[sB],i={items:this.itemsFactory.getItems(t)};this.registerEvents(),"function"==typeof t.callback&&this.commandExecutor.setCommonCallback(t.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);let r=this.itemsFactory.getItems(t);this.menu&&this.menu.destroy(),this.menu=new oC(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:t.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>sW(sU,this,sX).call(this)),this.menu.addLocalHook("afterOpen",()=>sW(sU,this,sq).call(this)),this.menu.addLocalHook("afterSubmenuOpen",e=>sW(sU,this,sJ).call(this,e)),this.menu.addLocalHook("afterClose",()=>sW(sU,this,sZ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return e.executeCommand.call(e,...i)}),(0,z.arrayEach)(r,e=>this.commandExecutor.registerCommand(e.key,e))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let e=this.hot.getShortcutManager().getContext("grid"),t=()=>{let{highlight:e}=this.hot.getSelectedRangeLast();if((e.isHeader()&&-1===e.row||e.isCell())&&e.col>=0){this.hot.selectColumns(e.col,e.col,-1);let{from:t}=this.hot.getSelectedRangeLast(),i=ns(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,t.col,!0).querySelector(`.${sj}`),n=r.getBoundingClientRect();this.open({left:n.left+i.left,top:n.top+r.offsetHeight+i.top},{left:n.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:t,runOnlyIf:()=>{var e;let t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:sB},{keys:[["Shift","Alt","ArrowDown"]],callback:t,runOnlyIf:()=>{var e;let t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t&&this.hot.selection.isCellVisible(t)&&t.isCell()&&!this.menu.isOpened()},group:sB}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sB)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>sW(sU,this,sY).call(this,e))}open(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(t=this.menu)&&void 0!==t&&t.isOpened()||(this.menu.open(),(0,V.objectEach)(i,(e,t)=>{this.menu.setOffset(t,e)}),this.menu.setPosition(e))}close(){var e;null===(e=this.menu)||void 0===e||e.close()}executeCommand(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function sG(e){e.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function sY(e){if((0,y.hasClass)(e.target,sj)){let t=ns(this.menu.container,this.hot.rootDocument),i=e.target.getBoundingClientRect();e.stopPropagation(),sV(sz,this,!1),this.open({left:i.left+t.left,top:i.top+e.target.offsetHeight+t.top},{left:i.width,right:0,above:0,below:3})}}function sK(e,t){let i=t.parentNode;if(!i)return;let r=i.parentNode.childNodes,n=Array.prototype.indexOf.call(r,i);if(e<0||n!==r.length-1)return;let o=t.querySelector(`.${sj}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}let s=this.hot.rootDocument.createElement("button");s.className=sj,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,y.setAttribute)(s,[(0,M.MG)(),(0,M.SM)(" ")]),(0,y.setAttribute)(t,[(0,M.wP)("menu")])),s.onclick=function(){return!1},t.firstChild.insertBefore(s,t.firstChild.firstChild)}function sX(){this.hot.runHooks("beforeDropdownMenuShow",this)}function sq(){this.hot.runHooks("afterDropdownMenuShow",this),sW(sU,this,sG).call(this,this.menu)}function sJ(e){sW(sU,this,sG).call(this,e)}function sZ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function sQ(e){return sz.get(sW(sz,this))?null:e}function s0(e){(0,y.hasClass)(e.target,sj)&&sV(sz,this,!0)}function s1(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}s$.SEPARATOR={name:nt};class s2{constructor(e){s1(this,"hot",void 0),s1(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){let{startRow:e,startCol:t,endRow:i,endCol:r}=this._getDataRange(),n=this.options,o=[];return(0,b.rangeEach)(e,i,e=>{let i=[];!n.exportHiddenRows&&this._isHiddenRow(e)||((0,b.rangeEach)(t,r,t=>{!n.exportHiddenColumns&&this._isHiddenColumn(t)||i.push(this.hot.getDataAtCell(e,t))}),o.push(i))}),o}getRowHeaders(){let e=[];if(this.options.rowHeaders){let{startRow:t,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();(0,b.rangeEach)(t,i,t=>{!this.options.exportHiddenRows&&this._isHiddenRow(t)||e.push(r[t])})}return e}getColumnHeaders(){let e=[];if(this.options.columnHeaders){let{startCol:t,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();(0,b.rangeEach)(t,i,t=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(t)||e.push(r[t])})}return e}_getDataRange(){let e=this.hot.countCols()-1,t=this.hot.countRows()-1,[i=0,r=0,n=t,o=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),{startRow:i,startCol:r,endRow:n=Math.min(n,t),endCol:o=Math.min(o,e)}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function s3(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class s5{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,t){s3(this,"dataProvider",void 0),s3(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(t),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let t=(0,V.clone)(this.constructor.DEFAULT_OPTIONS),i=new Date;return t=(0,V.extend)((0,V.clone)(s5.DEFAULT_OPTIONS),t),(t=(0,V.extend)(t,e)).filename=(0,U.substitute)(t.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),t}}let s9=s5;function s8(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var s4=new WeakSet;class s7 extends s9{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,s4)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n",sanitizeValues:!1}}export(){let e=this.options,t=this.dataProvider.getData(),i=this.dataProvider.getColumnHeaders(),r=i.length>0,n=this.dataProvider.getRowHeaders(),o=n.length>0,s=e.bom?String.fromCharCode(65279):"";return r&&(i=(0,z.arrayMap)(i,t=>this._escapeCell(t,{force:!0,sanitizeValue:e.sanitizeValues})),o&&(s+=e.columnDelimiter),s+=i.join(e.columnDelimiter),s+=e.rowDelimiter),(0,z.arrayEach)(t,(t,i)=>{i>0&&(s+=e.rowDelimiter),o&&(s+=this._escapeCell(n[i],{sanitizeValue:e.sanitizeValues}),s+=e.columnDelimiter);let r=t.map(t=>this._escapeCell(t,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);s+=r}),s}_escapeCell(e){let{force:t=!1,sanitizeValue:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,T.stringify)(e);return""===r||(i&&(t=!0),i instanceof RegExp?r=s8(s4,this,le).call(this,r,i):"function"==typeof i?r=i(r):i&&(r=s8(s4,this,s6).call(this,r)),(t||r.indexOf("\r")>=0||r.indexOf('"')>=0||r.indexOf("\n")>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function s6(e){return e.startsWith("=")||e.startsWith("+")||e.startsWith("-")||e.startsWith("@")||e.startsWith("	")||e.startsWith("\r")?`'${e}`:e}function le(e,t){return t.test(e)?`'${e}`:e}let lt={csv:s7};class li extends tC{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(e,t).export()}exportAsBlob(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,t))}downloadFile(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{rootDocument:i,rootWindow:r}=this.hot,n=this._createTypeFormatter(e,t),o=this._createBlob(n),s=r.URL||r.webkitURL,l=i.createElement("a"),a=`${n.options.filename}.${n.options.fileExtension}`;if(void 0!==l.download){let e=s.createObjectURL(o);l.style.display="none",l.setAttribute("href",e),l.setAttribute("download",a),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{s.revokeObjectURL(e)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,a)}_createTypeFormatter(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!lt[e])throw Error(`Export format type "${e}" is not supported.`);return t=new s2(this.hot),"function"==typeof lt[e]?new lt[e](t,i):null}_createBlob(e){let t=null;return"undefined"!=typeof Blob&&(t=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),t}}function lr(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(87426);class ln{constructor(e,t){let{id:i,stateless:r=!0}=t;lr(this,"hot",void 0),lr(this,"id",void 0),lr(this,"elements",[]),lr(this,"hidden",!1),lr(this,"stateId",""),lr(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new iQ.z)}getElements(){return this.elements}reset(){(0,z.arrayEach)(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,z.arrayEach)(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,V.mixin)(ln,rV.A);let lo={};function ls(e,t){if(!lo[e])throw Error(`Filter condition "${e}" does not exist.`);let{condition:i,descriptor:r}=lo[e],n=t;return r.inputValuesDecorator&&(n=r.inputValuesDecorator(n)),function(e){return i.apply(e.meta.instance,[].concat([e],[n]))}}function ll(e){if(!lo[e])throw Error(`Filter condition "${e}" does not exist.`);return lo[e].descriptor}function la(e,t,i){i.key=e,lo[e]={condition:t,descriptor:i}}let lh="none";la(lh,function(){return!0},{name:eK.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});let lu="empty";la(lu,function(e){return(0,T.isEmpty)(e.value)},{name:eK.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});let lc="not_empty";la(lc,function(e,t){return!ls(lu,t)(e)},{name:eK.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0}),la("eq",function(e,t){let[i]=t;return(0,T.stringify)(e.value).toLocaleLowerCase(e.meta.locale)===(0,T.stringify)(i)},{name:eK.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0}),la("neq",function(e,t){return!ls("eq",t)(e)},{name:eK.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0}),la("gt",function(e,t){let[i]=t,r=i;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>r},{name:eK.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0}),la("gte",function(e,t){let[i]=t,r=i;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value>=r},{name:eK.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0}),la("lt",function(e,t){let[i]=t,r=i;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<r},{name:eK.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0}),la("lte",function(e,t){let[i]=t,r=i;return"numeric"===e.meta.type&&(r=parseFloat(r,10)),e.value<=r},{name:eK.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});let ld="date_after";la(ld,function(e,t){let[i]=t,r=en(e.value,e.meta.dateFormat),n=en(i,e.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&r.diff(n)>=0},{name:eK.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});let lg="date_before";la(lg,function(e,t){let[i]=t,r=en(e.value,e.meta.dateFormat),n=en(i,e.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&0>=r.diff(n)},{name:eK.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});let lf="between";la(lf,function(e,t){let[i,r]=t,n=i,o=r;if("numeric"===e.meta.type){let e=parseFloat(n,10),t=parseFloat(o,10);n=Math.min(e,t),o=Math.max(e,t)}else if("date"===e.meta.type){let t=ls(lg,[o]),i=ls(ld,[n]);return t(e)&&i(e)}return e.value>=n&&e.value<=o},{name:eK.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});let lp="not_between";la(lp,function(e,t){return!ls(lf,t)(e)},{name:eK.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});let lm="begins_with";la(lm,function(e,t){let[i]=t;return(0,T.stringify)(e.value).toLocaleLowerCase(e.meta.locale).startsWith((0,T.stringify)(i))},{name:eK.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});let lw="ends_with";la(lw,function(e,t){let[i]=t;return(0,T.stringify)(e.value).toLocaleLowerCase(e.meta.locale).endsWith((0,T.stringify)(i))},{name:eK.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});let ly="contains";la(ly,function(e,t){let[i]=t;return(0,T.stringify)(e.value).toLocaleLowerCase(e.meta.locale).indexOf((0,T.stringify)(i))>=0},{name:eK.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});let lv="not_contains";la(lv,function(e,t){return!ls(ly,t)(e)},{name:eK.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});let lb="date_tomorrow";la(lb,function(e){let t=en(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(en().subtract(-1,"days").startOf("day"),"d")},{name:eK.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});let lC="date_today";la(lC,function(e){let t=en(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(en().startOf("day"),"d")},{name:eK.FILTERS_CONDITIONS_TODAY,inputsCount:0});let lS="date_yesterday";la(lS,function(e){let t=en(e.value,e.meta.dateFormat);return!!t.isValid()&&t.isSame(en().subtract(1,"days").startOf("day"),"d")},{name:eK.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});let lE="text",lR={numeric:[lh,nt,lu,lc,nt,"eq","neq",nt,"gt","gte","lt","lte",lf,lp],[lE]:[lh,nt,lu,lc,nt,"eq","neq",nt,lm,lw,nt,ly,lv],date:[lh,nt,lu,lc,nt,"eq","neq",nt,lg,ld,lf,nt,lb,lC,lS]};function lT(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let lx="built",lM="building",lO=["click","input","keydown","keypress","keyup","focus","blur","change"];class lk{static get DEFAULTS(){return(0,V.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,t){lT(this,"hot",void 0),lT(this,"eventManager",new m.A(this)),lT(this,"options",void 0),lT(this,"_element",void 0),lT(this,"buildState",void 0),this.hot=e,this.options=(0,V.extend)(lk.DEFAULTS,t),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===lM||(this.buildState===lx?this.update():(this.buildState=lM,this.build(),this.buildState=lx)),this._element}isBuilt(){return this.buildState===lx}translateIfPossible(e){return"string"==typeof e&&e.startsWith(eK.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(e):e}build(){let e=(e,t)=>{this.eventManager.addEventListener(e,t,e=>this.runLocalHooks(t,e,this))};if(this.buildState||(this.buildState=lM),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,y.addClass)(this._element,this.options.className),this.options.children.length)(0,z.arrayEach)(this.options.children,e=>this._element.appendChild(e.element));else if(this.options.wrapIt){let t=this.hot.rootDocument.createElement(this.options.tagName);t.setAttribute("data-hot-input",!0),(0,V.objectEach)(this.options,(e,i)=>{void 0!==t[i]&&"className"!==i&&"tagName"!==i&&"children"!==i&&(t[i]=this.translateIfPossible(e))}),this._element.appendChild(t),(0,z.arrayEach)(lO,i=>e(t,i))}else(0,z.arrayEach)(lO,t=>e(this._element,t))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function lI(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function lA(e,t){return e.get(lN(e,t))}function lN(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}(0,V.mixin)(lk,rV.A);var lH=new WeakMap,lP=new WeakSet;class l_ extends lk{static get DEFAULTS(){return(0,V.clone)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,t){super(e,(0,V.extend)(l_.DEFAULTS,t)),function(e,t){lI(e,t),t.add(e)}(this,lP),function(e,t,i){lI(e,t),t.set(e,i)}(this,lH,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>lN(lP,this,lL).call(this,e))}build(){var e;super.build();let t=this.hot.rootDocument.createElement("div");e=this._element.firstChild,lH.set(lN(lH,this),e),(0,y.addClass)(this._element,"htUIInput"),(0,y.addClass)(t,"htUIInputIcon"),this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(lA(lH,this).type=this.options.type,lA(lH,this).placeholder=this.translateIfPossible(this.options.placeholder),lA(lH,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&lA(lH,this).focus()}}function lL(e){this.options.value=e.target.value}function lD(e,t,i){lF(e,t),t.set(e,i)}function lF(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function lV(e,t,i){return e.set(lB(e,t),i),i}function lW(e,t){return e.get(lB(e,t))}function lB(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var lj=new WeakMap,lz=new WeakMap,lU=new WeakMap,l$=new WeakMap,lG=new WeakMap,lY=new WeakSet;class lK extends lk{static get DEFAULTS(){return(0,V.clone)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,t){super(e,(0,V.extend)(lK.DEFAULTS,t)),function(e,t){lF(e,t),t.add(e)}(this,lY),lD(this,lj,null),lD(this,lz,[]),lD(this,lU,void 0),lD(this,l$,void 0),lD(this,lG,void 0),this.registerHooks()}getMenu(){return lW(lj,this)}registerHooks(){this.addLocalHook("click",()=>lB(lY,this,lJ).call(this))}setItems(e){lV(lz,this,this.translateNames(e)),lW(lj,this)&&lW(lj,this).setMenuItems(lW(lz,this))}translateNames(e){return(0,z.arrayEach)(e,e=>{e.name=this.translateIfPossible(e.name)}),e}build(){super.build(),lV(lj,this,new oC(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),lW(lj,this).setMenuItems(lW(lz,this));let e=new lk(this.hot,{className:"htUISelectCaption"}),t=new lk(this.hot,{className:"htUISelectDropdown"});lV(lU,this,e),lV(l$,this,e.element),lV(lG,this,t),this.hot.getSettings().ariaTags&&((0,y.setAttribute)(t.element,[(0,M.MG)()]),(0,y.setAttribute)(this._element,[(0,M.$o)()])),(0,z.arrayEach)([e,t],e=>this._element.appendChild(e.element)),lW(lj,this).addLocalHook("select",e=>lB(lY,this,lX).call(this,e)),lW(lj,this).addLocalHook("afterClose",()=>lB(lY,this,lq).call(this)),this.update()}update(){let e;this.isBuilt()&&(e=this.options.value?this.options.value.name:lW(lj,this).hot.getTranslatedPhrase(eK.FILTERS_CONDITIONS_NONE),lW(l$,this).textContent=e,super.update())}openOptions(){let e=this.element.getBoundingClientRect();lW(lj,this)&&(lW(lj,this).open(),lW(lj,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),lW(lj,this).getNavigator().toFirstItem(),lW(lj,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{this.closeOptions(),this.runLocalHooks("tabKeydown",e)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){lW(lj,this)&&lW(lj,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){lW(lj,this)&&(lW(lj,this).destroy(),lV(lj,this,null)),lW(lU,this)&&lW(lU,this).destroy(),lW(lG,this)&&lW(lG,this).destroy(),super.destroy()}}function lX(e){e.name!==nt&&(this.options.value=e,this.update(),this.runLocalHooks("select",this.options.value))}function lq(){this.runLocalHooks("afterClose")}function lJ(){this.openOptions()}function lZ(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function lQ(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var l0=new WeakSet;class l1 extends ln{constructor(e,t){super(e,{id:t.id,stateless:!1}),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,l0),lZ(this,"name",""),lZ(this,"addSeparator",!1),this.name=t.name,this.addSeparator=t.addSeparator,this.elements.push(new lK(this.hot,{menuContainer:t.menuContainer})),this.elements.push(new l_(this.hot,{placeholder:eK.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new l_(this.hot,{placeholder:eK.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>lQ(l0,this,l2).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),(0,z.arrayEach)(this.getInputElements(),e=>{e.addLocalHook("keydown",e=>lQ(l0,this,l3).call(this,e))})}setState(e){if(this.reset(),!e)return;let t=(0,V.clone)(e.command);t.name.startsWith(eK.FILTERS_CONDITIONS_NAMESPACE)&&(t.name=this.hot.getTranslatedPhrase(t.name)),this.getSelectElement().setValue(t),(0,z.arrayEach)(e.args,(e,i)=>{if(i>t.inputsCount-1)return!1;let r=this.getInputElement(i);r.setValue(e),r[t.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){let e=this.getSelectElement().getValue()||ll(lh),t=[];return(0,z.arrayEach)(this.getInputElements(),(i,r)=>{e.inputsCount>r&&t.push(i.getValue())}),{command:e,args:t}}updateState(e,t){let i=e?ll(e.name):ll(lh);this.state.setValueAtIndex(t,{command:i,args:e?e.args:[]}),e||(0,z.arrayEach)(this.getInputElements(),e=>e.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof lK)[0]}getInputElement(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof l_)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,r,n,o)=>{(0,y.addClass)(t.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,y.addClass)(t.parentNode,"border");let s=this.hot.rootDocument.createElement("div");return(0,y.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||(0,z.arrayEach)(this.elements,e=>t.appendChild(e.element)),t}}}reset(){let e=this.hot.getPlugin("filters").getSelectedColumn(),t=[ll(lh)];if(null!==e){let{visualIndex:i}=e;t=function(e){let t=[],i=e;return lR[i]||(i=lE),(0,z.arrayEach)(lR[i],e=>{let i;i=e===nt?{name:nt}:(0,V.clone)(ll(e)),t.push(i)}),t}(this.hot.getDataType(0,i,this.hot.countRows(),i))}(0,z.arrayEach)(this.getInputElements(),e=>e.hide()),this.getSelectElement().setItems(t),super.reset(),this.getSelectElement().setValue(t[0])}}function l2(e){(0,z.arrayEach)(this.getInputElements(),(t,i)=>{t[e.inputsCount>i?"show":"hide"](),0===i&&this.hot._registerTimeout(()=>t.focus(),10)}),this.runLocalHooks("change",e)}function l3(e){(0,$.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,F.stopImmediatePropagation)(e))}let l5={};function l9(e,t,i){l5[e]={name:t,func:i}}let l8="conjunction";l9(l8,eK.FILTERS_LABELS_CONJUNCTION,function(e,t){return e.every(e=>e.func(t))});let l4="disjunction";l9(l4,eK.FILTERS_LABELS_DISJUNCTION,function(e,t){return e.some(e=>e.func(t))});let l7="disjunctionWithExtraCondition";function l6(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function ae(e,t){return e.get(ai(e,t))}function at(e,t,i){return e.set(ai(e,t),i),i}function ai(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}l9(l7,eK.FILTERS_LABELS_DISJUNCTION,function(e,t){if(e.length<3)throw Error("Operation doesn't work on less then three conditions.");return e.slice(0,e.length-1).some(e=>e.func(t))&&e[e.length-1].func(t)});var ar=new WeakMap,an=new WeakMap;class ao extends lk{static get DEFAULTS(){return(0,V.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,t){super(e,(0,V.extend)(ao.DEFAULTS,t)),l6(this,ar,void 0),l6(this,an,void 0)}build(){super.build();let e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),at(an,this,e),at(ar,this,this._element.firstChild),ae(ar,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(ae(an,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&ae(ar,this).checked}setChecked(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isBuilt()&&(ae(ar,this).checked=e)}focus(){this.isBuilt()&&ae(ar,this).focus()}}var as=new WeakSet;class al extends ln{constructor(e,t){super(e,{id:t.id,stateless:!1}),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,as),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:"",enumerable:!0,configurable:!0,writable:!0}):e[t]=""}(this,"name",""),this.name=t.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,y.addClass)(t.parentNode,"htFiltersMenuOperators"),(0,z.arrayEach)(this.elements,e=>t.appendChild(e.element)),t)}}buildOperatorsElement(){let e=[l8,l4];(0,z.arrayEach)(e,t=>{let i=new ao(this.hot,{name:"operator",label:{htmlFor:t,textContent:l5[t].name},value:t,checked:t===e[0],id:t});i.addLocalHook("change",e=>(function(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")})(as,this,aa).call(this,e)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error((0,ro.O)`Radio button with index ${e} doesn't exist.`);(0,z.arrayEach)(this.elements,(t,i)=>{t.setChecked(i===e)})}getActiveOperationId(){let e=this.elements.find(e=>e instanceof ao&&e.isChecked());return e?e.getValue():l8}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&(0,z.arrayEach)(this.elements,t=>{t.setChecked(t.getValue()===e)})}updateState(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l8,t=arguments.length>1?arguments[1]:void 0,i=e;i===l7&&(i=l4),this.state.setValueAtIndex(t,i)}reset(){this.setChecked(0)}}function aa(e){this.setState(e.target.value)}function ah(e){let t=new Set(e);return function(e){return t.has(e)}}function au(e){return null==e?"":e}function ac(e){return Array.from(new Set(e)).map(e=>au(e)).sort((e,t)=>"number"==typeof e&&"number"==typeof t?e-t:e===t?0:e>t?1:-1)}function ad(e,t,i,r){let n,o=[],s=e===t;return s||(n=ah(t)),e.forEach(e=>{let t,l=!1;(s||n(e))&&(l=!0);let a={checked:l,value:e,visualValue:(""===(t=e)&&(t=`(${i})`),t)};r&&r(a),o.push(a)}),o}(0,tE.getComparisonFunction)();var ag=i(15616);function af(e,t){return e.get(ap(e,t))}function ap(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var am=new WeakMap;class aw extends lk{static get DEFAULTS(){return(0,V.clone)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,t){super(e,(0,V.extend)(aw.DEFAULTS,t)),function(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}(this,am,void 0)}build(){var e;super.build(),e=this._element.firstChild,am.set(ap(am,this),e)}update(){this.isBuilt()&&(af(am,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&af(am,this).focus()}activate(){af(am,this).click()}}function ay(e,t,i){av(e,t),t.set(e,i)}function av(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function ab(e,t){return e.get(aS(e,t))}function aC(e,t,i){return e.set(aS(e,t),i),i}function aS(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let aE="multipleSelect.itemBox";var aR=new WeakMap,aT=new WeakMap,ax=new WeakMap,aM=new WeakMap,aO=new WeakMap,ak=new WeakMap,aI=new WeakSet;class aA extends lk{static get DEFAULTS(){return(0,V.clone)({className:"htUIMultipleSelect",value:[]})}constructor(e,t){super(e,(0,V.extend)(aA.DEFAULTS,t)),function(e,t){av(e,t),t.add(e)}(this,aI),ay(this,aR,[]),ay(this,aT,void 0),ay(this,ax,void 0),ay(this,aM,void 0),ay(this,aO,void 0),ay(this,ak,void 0),aC(aM,this,new l_(this.hot,{placeholder:eK.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),aC(aO,this,new aw(this.hot,{textContent:eK.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),aC(ak,this,new aw(this.hot,{textContent:eK.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ab(aT,this)}registerHooks(){ab(aM,this).addLocalHook("keydown",e=>aS(aI,this,aH).call(this,e)),ab(aM,this).addLocalHook("input",e=>aS(aI,this,aN).call(this,e)),ab(aO,this).addLocalHook("click",e=>aS(aI,this,aP).call(this,e)),ab(ak,this).addLocalHook("click",e=>aS(aI,this,a_).call(this,e))}setItems(e){var t;aC(aR,this,e),null===(t=ab(aT,this))||void 0===t||t.loadData(ab(aR,this))}setLocale(e){aC(ax,this,e)}getLocale(){return ab(ax,this)}getItems(){return[...ab(aR,this)]}getValue(){var e=ab(aR,this);let t=[];return e.forEach(e=>{e.checked&&t.push(e.value)}),t}getSearchInputElement(){return ab(aM,this)}getSelectAllElement(){return ab(aO,this)}getClearAllElement(){return ab(ak,this)}isSelectedAllValues(){return ab(aR,this).length===this.getValue().length}build(){super.build();let{rootDocument:e}=this.hot,t=e.createElement("div"),i=new lk(this.hot,{className:"htUISelectionControls",children:[ab(aO,this),ab(ak,this)]});this._element.appendChild(ab(aM,this).element),this._element.appendChild(i.element),this._element.appendChild(t);let r=t=>{var i;if(!this._element)return;null===(i=ab(aT,this))||void 0===i||i.destroy(),(0,y.addClass)(t,"htUIMultipleSelectHot"),aC(aT,this,new this.hot.constructor(t,{data:ab(aR,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(e,t,i,r,n,o)=>{e.title=o.instance.getDataAtRowProp(t,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ab(aT,this).listen()},modifyColWidth:t=>{let i=ab(aT,this).container.scrollWidth-(0,y.getScrollbarWidth)(e);return void 0!==t&&t<i?i:t},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ab(aT,this).init(),this.hot.addHook("afterSetTheme",(e,t)=>{t||ab(aT,this).useTheme(e)});let r=ab(aT,this).getShortcutManager().getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:e=>{this.runLocalHooks("keydown",e,this)},group:aE}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:e=>{ab(aT,this).deselectCell(),this.runLocalHooks("keydown",e,this),this.runLocalHooks("listTabKeydown",e,this)},group:aE})};r(t),this.hot._registerTimeout(()=>r(t),100)}focus(){this.isBuilt()&&ab(aT,this).listen()}reset(){ab(aM,this).reset(),ab(aO,this).reset(),ab(ak,this).reset()}update(){this.isBuilt()&&(ab(aT,this).loadData(function(e,t){let i=ah(t);return e.map(e=>(e.checked=i(e.value),e))}(ab(aR,this),this.options.value)),super.update())}destroy(){var e;null===(e=ab(aT,this))||void 0===e||e.destroy(),ab(aM,this).destroy(),ab(ak,this).destroy(),ab(aO,this).destroy(),aC(aM,this,null),aC(ak,this,null),aC(aO,this,null),aC(aT,this,null),aC(aR,this,null),super.destroy()}}function aN(e){let t,i=e.target.value.toLocaleLowerCase(this.getLocale());t=""===i?[...ab(aR,this)]:ab(aR,this).filter(e=>`${e.value}`.toLocaleLowerCase(this.getLocale()).indexOf(i)>=0),ab(aT,this).loadData(t)}function aH(e){this.runLocalHooks("keydown",e,this),(0,G.partial)($.isKey,e.keyCode)("ARROW_DOWN")&&(e.preventDefault(),(0,F.stopImmediatePropagation)(e),ab(aT,this).listen(),ab(aT,this).selectCell(0,0))}function aP(e){let t=[];e.preventDefault(),ab(aT,this).getSourceData().forEach((e,i)=>{e.checked=!0,t.push((0,ag.dataRowToChangesArray)(e,i)[0])}),ab(aT,this).setSourceDataAtCell(t)}function a_(e){let t=[];e.preventDefault(),ab(aT,this).getSourceData().forEach((e,i)=>{e.checked=!1,t.push((0,ag.dataRowToChangesArray)(e,i)[0])}),ab(aT,this).setSourceDataAtCell(t)}let aL="by_value";function aD(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}la(aL,function(e,t){let[i]=t;return i(e.value)},{name:"By value",inputsCount:0,inputValuesDecorator(e){let[t]=e;return[ah(t)]},showOperators:!1});var aF=new WeakSet;class aV extends ln{constructor(e,t){super(e,{id:t.id,stateless:!1}),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,aF),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:"",enumerable:!0,configurable:!0,writable:!0}):e[t]=""}(this,"name",""),this.name=t.name,this.elements.push(new aA(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>aD(aF,this,aW).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,t)=>aD(aF,this,aj).call(this,e,t))}getElements(){let e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===aL){let t=this.getMultipleSelectElement();t.setItems(e.itemsSnapshot),t.setValue(e.args[0]),t.setLocale(e.locale)}}getState(){let e=this.getMultipleSelectElement(),t=e.getItems();return{command:{key:e.isSelectedAllValues()||!t.length?lh:aL},args:[e.getValue()],itemsSnapshot:t}}updateState(e){let t=(t,i,r,n,o)=>{let[s]=(0,z.arrayFilter)(i,e=>e.name===aL),l={},a=this.hot.getTranslatedPhrase(eK.FILTERS_VALUES_BLANK_CELLS);if(s){let i=n(t,o),h=(0,z.arrayMap)(i,e=>e.value),u=new Map(i.map(e=>[e.value,this.hot.getCellMeta(e.meta.visualRow,e.meta.visualCol)])),c=ac(h);r&&(s.args[0]=r);let d=[],g=ad(c,s.args[0],a,e=>{e.checked&&d.push(e.value),aD(aF,this,aB).call(this,e,u)}),f=e.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,f).locale,l.args=[d],l.command=ll(aL),l.itemsSnapshot=g}else l.args=[],l.command=ll(lh);this.state.setValueAtIndex(t,l)};t(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&t(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof aA)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t,i,r,n,o)=>{(0,y.addClass)(t.parentNode,"htFiltersMenuValue");let s=this.hot.rootDocument.createElement("div");return(0,y.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,t.appendChild(s),t.parentElement.hasAttribute("ghost-table")||(0,z.arrayEach)(this.elements,e=>t.appendChild(e.element)),t}}}reset(){let e=this.hot.getTranslatedPhrase(eK.FILTERS_VALUES_BLANK_CELLS),t=this._getColumnVisibleValues(),i=t.map(e=>e.value),r=new Map(t.map(e=>[e.value,e.meta])),n=ac(i),o=ad(n,n,e,e=>{aD(aF,this,aB).call(this,e,r)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(n);let s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){let e=this.hot.getPlugin("filters").getSelectedColumn();return null===e?[]:(0,z.arrayMap)(this.hot.getDataAtCol(e.visualIndex),(t,i)=>({value:au(t),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function aW(e){(0,$.isKey)(e.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,F.stopImmediatePropagation)(e))}function aB(e,t){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(e.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",e.visualValue,t.get(e.value)))}function aj(e,t){return"numeric"===t.type?e5(e,t):e}var az=new WeakSet;class aU extends ln{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,t){super(e,{id:t.id,stateless:!0}),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,az),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:"",enumerable:!0,configurable:!0,writable:!0}):e[t]=""}(this,"name",""),this.name=t.name,this.elements.push(new l_(this.hot,{type:"button",value:eK.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:aU.BUTTON_OK})),this.elements.push(new l_(this.hot,{type:"button",value:eK.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:aU.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,z.arrayEach)(this.elements,e=>{e.addLocalHook("click",(e,t)=>(function(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")})(az,this,a$).call(this,e,t))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,t)=>((0,y.addClass)(t.parentNode,"htFiltersMenuActionBar"),(0,z.arrayEach)(this.elements,e=>t.appendChild(e.element)),t)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function a$(e,t){t.options.identifier===aU.BUTTON_OK?this.accept():this.cancel()}function aG(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let aY="ConditionCollection.filteringStates";class aK{constructor(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];aG(this,"hot",void 0),aG(this,"isMapRegistrable",void 0),aG(this,"filteringStates",new iQ.z),this.hot=e,this.isMapRegistrable=t,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(aY,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(e,t){var i;let r=this.filteringStates.getValueAtIndex(t),n=null!==(i=null==r?void 0:r.conditions)&&void 0!==i?i:[],o=null==r?void 0:r.operation;return this.isMatchInConditions(n,e,o)}isMatchInConditions(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l8;return!e.length||(function(e){if(!l5[e])throw Error(`Operation with id "${e}" does not exist.`);let t=l5[e].func;return function(e,i){return t(e,i)}})(i)(e,t)}addCondition(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l8,r=arguments.length>3?arguments[3]:void 0,n=this.hot.getCellMeta(0,e).locale,o=t.args.map(e=>"string"==typeof e?e.toLocaleLowerCase(n):e),s=t.name||t.command.key;this.runLocalHooks("beforeAdd",e);let l=this.getOperation(e);if(l){if(l!==i)throw Error((0,ro.O)`The column of index ${e} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,T.isUndefined)(l5[i]))throw Error((0,ro.O)`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let a=this.getConditions(e);0===a.length?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:s,args:o,func:ls(s,o)}]},r):a.push({name:s,args:o,func:ls(s,o)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var t,i;return null!==(t=null===(i=this.filteringStates.getValueAtIndex(e))||void 0===i?void 0:i.conditions)&&void 0!==t?t:[]}getOperation(e){var t;return null===(t=this.filteringStates.getValueAtIndex(e))||void 0===t?void 0:t.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[t]=e;return t})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,t)=>{let[i,{operation:r,conditions:n}]=t;return e.push({column:i,operation:r,conditions:n.map(e=>{let{name:t,args:i}=e;return{name:t,args:[...i]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(e=>{e.conditions.forEach(t=>this.addCondition(e.column,t))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,t){let i=this.getConditions(e);return t?i.some(e=>e.name===t):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(aY),this.filteringStates=null,this.clearLocalHooks()}}function aX(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}(0,V.mixin)(aK,rV.A);class aq{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];aX(this,"conditionCollection",void 0),aX(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=t}filter(){let e=[];return(0,z.arrayEach)(this.conditionCollection.getFilteredColumns(),(t,i)=>{let r=this.columnDataFactory(t);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(t,r)}),e}filterByColumn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return(0,z.arrayEach)(t,t=>{void 0!==t&&this.conditionCollection.isMatch(t,e)&&i.push(t)}),i}_getIntersectData(e,t){let i=[];return(0,z.arrayEach)(t,t=>{let r=t.meta.visualRow;void 0!==e[r]&&(i[r]=e[r])}),i}}function aJ(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function aZ(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var aQ=new WeakSet;class a0{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];!function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,aQ),aJ(this,"hot",void 0),aJ(this,"conditionCollection",void 0),aJ(this,"columnDataFactory",void 0),aJ(this,"changes",[]),aJ(this,"grouping",!1),aJ(this,"latestEditedColumnPosition",-1),aJ(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=t,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",e=>aZ(aQ,this,a1).call(this,e)),this.conditionCollection.addLocalHook("afterRemove",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("afterAdd",e=>this.updateStatesAtColumn(e)),this.conditionCollection.addLocalHook("beforeClean",()=>aZ(aQ,this,a2).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>aZ(aQ,this,a3).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,z.arrayEach)(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,t){var i=this;if(this.grouping){-1===this.changes.indexOf(e)&&this.changes.push(e);return}let r=this.conditionCollection.exportAllConditions(),n=this.conditionCollection.getColumnStackPosition(e);-1===n&&(n=this.latestEditedColumnPosition);let o=r.slice(0,n),s=r.slice(n);s.length&&s[0].column===e&&s.shift();let l=(0,G.curry)(function(e,t){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new aK(i.hot,!1),s=[].concat(e,n);o.importAllConditions(s);let l=i.columnDataFactory(t);r=o.isEmpty()?l:new aq(o,e=>i.columnDataFactory(e)).filter();let a=ah(r=(0,z.arrayMap)(r,e=>e.meta.visualRow));return o.destroy(),(0,z.arrayFilter)(l,e=>a(e.meta.visualRow))})(o),a=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:t})}destroy(){this.clearLocalHooks(),(0,V.objectEach)(this,(e,t)=>{this[t]=null})}}function a1(e){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(e)}function a2(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function a3(){(0,z.arrayEach)(this.latestOrderStack,e=>{this.updateStatesAtColumn(e)})}(0,V.mixin)(a0,rV.A);let a5="filters";var a9=i(10932);function a8(e,t,i){a4(e,t),t.set(e,i)}function a4(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function a7(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a6(e,t,i){return e.set(ht(e,t),i),i}function he(e,t){return e.get(ht(e,t))}function ht(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let hi="filters";var hr=new WeakMap,hn=new WeakMap,ho=new WeakMap,hs=new WeakSet;class hl extends tC{static get PLUGIN_KEY(){return hi}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var t;super(e),t=this,function(e,t){a4(e,t),t.add(e)}(this,hs),a7(this,"dropdownMenuPlugin",null),a7(this,"conditionCollection",null),a7(this,"conditionUpdateObserver",null),a7(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),a7(this,"filtersRowsMap",null),a8(this,hr,void 0),a8(this,hn,new WeakSet),a8(this,ho,[]),this.hot.addHook("afterGetColHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ht(hs,t,hm).call(t,...i)})}isEnabled(){return!!this.hot.getSettings()[hi]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new a9.q),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let t=this.hot.getSettings().dropdownMenu,i=t&&t.uiContainer||this.hot.rootDocument.body,r=e=>(e.addLocalHook("accept",()=>ht(hs,this,hg).call(this,"accept")),e.addLocalHook("cancel",()=>ht(hs,this,hg).call(this,"cancel")),e.addLocalHook("change",t=>ht(hs,this,hf).call(this,e,t)),e);if(!this.components.get("filter_by_condition")){let e=new l1(this.hot,{id:"filter_by_condition",name:()=>`${this.hot.getTranslatedPhrase(eK.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,addSeparator:!1,menuContainer:i});e.addLocalHook("afterClose",()=>ht(hs,this,hp).call(this)),this.components.set("filter_by_condition",r(e))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new al(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let e=new l1(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});e.addLocalHook("afterClose",()=>ht(hs,this,hp).call(this)),this.components.set("filter_by_condition2",r(e))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new aV(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(eK.FILTERS_DIVS_FILTER_BY_VALUE)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new aU(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new aK(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new a0(this.hot,this.conditionCollection,e=>this.getDataMapAtColumn(e)),this.conditionUpdateObserver.addLocalHook("update",e=>ht(hs,this,hw).call(this,e))),this.components.forEach(e=>e.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ht(hs,e,hd).call(e,...i)}),this.addHook("beforeDropdownMenuShow",()=>ht(hs,this,hc).call(this)),this.addHook("afterDropdownMenuShow",()=>ht(hs,this,hh).call(this)),this.addHook("afterDropdownMenuHide",()=>ht(hs,this,hu).call(this)),this.addHook("afterChange",e=>ht(hs,this,ha).call(this,e)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!he(hr,this)&&this.dropdownMenuPlugin.enabled){let e=[{focus:()=>{let e=he(hr,this).getMenu(),t=e.getNavigator(),i=he(hr,this).getLastMenuPage();e.focus(),i>0?t.setCurrentPage(i):t.toFirstItem()}},...Array.from(this.components).map(e=>{let[,t]=e;return t.getElements()}).flat()];a6(hr,this,function(e,t){let i,r=-1,n=oo({initialPage:0,size:()=>t.length,onItemSelect:(e,i)=>{let r=t[e];return r instanceof aA?i:(!r.element||!!(0,y.isVisible)(r.element))&&void r.focus()}}),o=e=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(a5),n.setCurrentPage(t.indexOf(e))};function s(e){let o=i.getKeyboardShortcutsCtrl(),s=e.getKeyboardShortcutsCtrl();n.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(a5),callback:()=>{e.isSubMenu()&&e.close(),o.listen(a5)}}]),e.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:e=>{let t=i.getNavigator();t.getCurrentPage()>-1&&(r=t.getCurrentPage()),t.clear(),e.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:e=>{let i=t[n.getCurrentPage()];i instanceof lK&&(i.openOptions(),e.preventDefault()),i instanceof aw&&(i.activate(),e.preventDefault()),i instanceof lk||e.preventDefault()}}],a5)}function l(e){e.addLocalHook("afterSelectionChange",e=>{e.key.startsWith("filter_")||n.clear()}),e.addLocalHook("afterSubmenuOpen",s),e.addLocalHook("afterOpen",s),i=e}return t.forEach(e=>{e instanceof lk&&(e.addLocalHook("click",o(e)),e.addLocalHook("focus",o(e)),e.addLocalHook("afterClose",o(e)))}),l(e),{...n,listen:function(){i.focus(),i.getKeyboardShortcutsCtrl().listen(a5)},setMenu:l,getMenu:function(){return i},getLastMenuPage:function(){return r}}}(this.dropdownMenuPlugin.menu,e));let t=e=>{he(hr,this).listen(),e.preventDefault(),(0,$.isKey)(e.keyCode,"TAB")&&(e.shiftKey?he(hr,this).toPreviousItem():he(hr,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",t),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",t)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((e,t)=>{e.destroy(),this.components.set(t,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:hi})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hi)}addCondition(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l8,n=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(n,{command:{key:t},args:i},r)}removeConditions(e){let t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}clearConditions(e){if(void 0===e)this.conditionCollection.clean();else{let t=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(t)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){let{navigableHeaders:e}=this.hot.getSettings(),t=this._createDataFilter(),i=!this.conditionCollection.isEmpty(),r=[],n=this.exportConditions(),o=this.hot.runHooks("beforeFilter",n,he(ho,this));if(!1!==o&&i){let i=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear();let e=ah(r=(0,z.arrayMap)(t.filter(),e=>e.meta.visualRow));(0,b.rangeEach)(this.hot.countSourceRows()-1,t=>{e(t)||i.push(t)}),(0,z.arrayEach)(i,e=>{this.filtersRowsMap.setValueAtIndex(e,!0)})},!0),e||r.length||this.hot.deselectCell(),a6(ho,this,this.exportConditions())}else!1===o||i?this.importConditions(he(ho,this)):(a6(ho,this,this.exportConditions()),this.filtersRowsMap.clear());this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeLast().highlight.col),!1!==o&&(this.hot.runHooks("afterFilter",n),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;let t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return t?{visualIndex:t.col,physicalIndex:this.hot.toPhysicalColumn(t.col)}:null}getDataMapAtColumn(e){let t=this.hot.toVisualColumn(e),i=[];return(0,z.arrayEach)(this.hot.getSourceDataAtCol(t),(e,r)=>{var n;let{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d}=this.hot.getCellMeta(r,t),g=null!==(n=this.hot.getDataAtCell(this.hot.toVisualRow(r),t))&&void 0!==n?n:e;i.push({meta:{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d},value:au(g)})}),i}updateValueComponentCondition(e){let t=ac(this.hot.getDataAtCol(e));this.conditionUpdateObserver.updateStatesAtColumn(e,t)}restoreComponents(e){var t;let i=null===(t=this.getSelectedColumn())||void 0===t?void 0:t.physicalIndex;e.forEach(e=>{e.isHidden()||e.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,t,i,r){let n=e;return n===l4&&t.command.key!==lh&&i.command.key!==lh&&r.command.key!==lh?n=l7:r.command.key!==lh&&(t.command.key===lh||i.command.key===lh)&&(n=l8),n}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let{command:e}=this.components.get("filter_by_condition").getState(),t=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];e.showOperators?this.showComponents(...t):this.hideComponents(...t)}_createDataFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new aq(e,e=>this.getDataMapAtColumn(e))}getIndexesOfComponents(){let e=[];if(!this.dropdownMenuPlugin)return e;let t=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return(0,z.arrayEach)(r,i=>{(0,z.arrayEach)(t.menuItems,(t,r)=>{t.key===i.getMenuItemDescriptor().key&&e.push(r)})}),e}changeComponentsVisibility(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.dropdownMenuPlugin)return;let t=this.dropdownMenuPlugin.menu.hotMenu,i=t.getPlugin("hiddenRows");for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];let s=this.getIndexesOfComponents(...n);e?i.showRows(s):i.hideRows(s),t.render()}hideComponents(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!1,...t)}showComponents(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.changeComponentsVisibility(!0,...t)}destroy(){this.enabled&&(this.components.forEach((e,t)=>{null!==e&&(e.destroy(),this.components.set(t,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ha(e){e&&(0,z.arrayEach)(e,e=>{let[,t]=e,i=this.hot.propToCol(t);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function hh(){let e=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),e.updateMenuDimensions()}function hu(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function hc(){let e=this.dropdownMenuPlugin.menu;he(hn,this).has(e)||he(hr,this).setMenu(e),he(hn,this).add(e)}function hd(e){e.items.push({name:nt}),this.components.forEach(t=>{e.items.push(t.getMenuItemDescriptor())})}function hg(e){var t,i;if("accept"===e){let e=this.getSelectedColumn();if(null===e){null===(i=this.dropdownMenuPlugin)||void 0===i||i.close();return}let{physicalIndex:t}=e,r=this.components.get("filter_by_condition").getState(),n=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,n,o);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(t);-1===l&&(l=void 0),this.conditionCollection.removeConditions(t),r.command.key!==lh&&(this.conditionCollection.addCondition(t,r,s,l),n.command.key!==lh&&this.conditionCollection.addCondition(t,n,s,l)),o.command.key!==lh&&this.conditionCollection.addCondition(t,o,s,l),this.conditionUpdateObserver.flush(),this.components.forEach(e=>e.saveState(t)),this.filter()}null===(t=this.dropdownMenuPlugin)||void 0===t||t.close()}function hf(e,t){let i=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),e.constructor!==l1||t.inputsCount||this.setListeningDropdownMenu(),i.updateMenuDimensions()}function hp(){this.setListeningDropdownMenu()}function hm(e,t,i){let r=this.hot.toPhysicalColumn(e);this.enabled&&this.conditionCollection.hasConditions(r)&&i===this.hot.view.getColumnHeadersCount()-1?(0,y.addClass)(t,"htFiltersActive"):(0,y.removeClass)(t,"htFiltersActive")}function hw(e){var t;if(!(null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled))return;let{editedConditionStack:{conditions:i,column:r},conditionArgsChange:n}=e;Array.isArray(n)&&a6(ho,this,he(ho,this).map(e=>(e.column===r&&i.length>0&&e.conditions.forEach(e=>{"by_value"===e.name&&(e.args=[[...n]])}),e)));let o=i.filter(e=>e.name===aL),s=i.filter(e=>e.name!==aL);if(o.length>=2||s.length>=3)(0,iL.R8)((0,ro.O)`The filter conditions have been applied properly, but couldnt be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let t=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(t,r),this.components.get("filter_by_value").updateState(e)}}i(89750);let hy="internal-use-in-handsontable",hv={licenseKey:hy,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function hb(e){var t;return{maxColumns:e.maxColumns,maxRows:e.maxRows,language:null===(t=e[h7])||void 0===t||null===(t=t.language)||void 0===t?void 0:t.langCode}}function hC(e){return Object.keys(e).reduce((t,i)=>("hyperformula"!==i&&(t[i]=e[i]),t),{})}function hS(){let e="engine_relationship",t=(0,i9.A)(h7);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function hE(){let e="shared_engine_usage",t=(0,i9.A)(h7);return t.hasItem(e)||t.register(e,new Map),t.getItem(e)}function hR(e){var t;let i=hS();return new Map((0===i.size?[]:Array.from(null!==(t=i.get(e))&&void 0!==t?t:[])).map(e=>[e.getPlugin("formulas").sheetId,e]))}function hT(e,t){if(e){let i=hS(),r=i.get(e),n=hE(),o=n.get(e);r&&r.includes(t)&&(r.splice(r.indexOf(t),1),0===r.length&&i.delete(e)),o&&o.includes(t.guid)&&(o.splice(o.indexOf(t.guid),1),0===o.length&&(n.delete(e),e.destroy()))}}let hx="DD/MM/YYYY";function hM(e,t){return"string"==typeof e&&"date"===t}function hO(e,t){return en(e,t,!0).isValid()}function hk(e,t){return en(e,t,!0).format(hx)}function hI(e,t){return en(new Date(Date.UTC(0,0,e+-1))).format(t)}function hA(e,t,i){var r;return(r=function(e,t){let i=[];return e.forEach(e=>{let r={from:e,to:t};i.forEach(e=>{let t=e.from>e.to,i=e.to<=r.from;e.from>r.from&&i&&t&&(r.from+=1)}),r.from>=t&&(t+=1),i.push(r)}),i}(e,function(e,t,i){let r=Array.from(Array(i).keys()).filter(t=>!1===e.includes(t));if(0===t){var n;return null!==(n=r[t])&&void 0!==n?n:0}return r[t-1]+1}(e,t,i))).forEach((e,t)=>{r.slice(t+1).forEach(t=>{let i=t.from<t.to;t.from>e.from&&i&&(t.from-=1)})}),r}function hN(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function hH(e,t){return e.get(h_(e,t))}function hP(e,t,i){return e.set(h_(e,t),i),i}function h_(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var hL=new WeakMap,hD=new WeakMap,hF=new WeakMap,hV=new WeakMap,hW=new WeakMap,hB=new WeakMap,hj=new WeakMap;class hz{constructor(e,t,i){hN(this,hL,void 0),hN(this,hD,void 0),hN(this,hF,void 0),hN(this,hV,[]),hN(this,hW,[]),hN(this,hB,void 0),hN(this,hj,[]),hP(hL,this,e),hP(hD,this,t),hP(hF,this,i)}setRemovedHfIndexes(e){return hP(hj,this,e.map(e=>{let t=hH(hD,this).getVisualFromPhysicalIndex(e);return this.getHfIndexFromVisualIndex(t)})),hH(hj,this)}getRemovedHfIndexes(){return hH(hj,this)}getHfIndexFromVisualIndex(e){let t=hH(hD,this).getIndexesSequence(),i=hH(hD,this).getNotTrimmedIndexes();return t.indexOf(i[e],e)}syncMoves(e){let t=`move${(0,U.toUpperCaseFirst)(hH(hL,this))}s`;hH(hF,this).getEngine().batch(()=>{e.forEach(e=>{let i=e.from!==e.to,r=e.from+1!==e.to;i&&r&&hH(hF,this).getEngine()[t](hH(hF,this).getSheetId(),e.from,1,e.to)})})}storeMovesInformation(e,t,i){!1!==i&&(hP(hW,this,e.map(e=>this.getHfIndexFromVisualIndex(e))),hP(hB,this,this.getHfIndexFromVisualIndex(t)))}calculateAndSyncMoves(e,t){if(hH(hF,this).isPerformingUndoRedo()||!1===e||!1===t)return;let i=hA(hH(hW,this),hH(hB,this),hH(hD,this).getNumberOfIndexes());null===hH(hF,this).getSheetId()?hH(hF,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){let e=`set${(0,U.toUpperCaseFirst)(hH(hL,this))}Order`;return t=>{if(hH(hF,this).isPerformingUndoRedo())return;let i=hH(hD,this).getIndexesSequence();if("update"===t&&i.length>0){let t,r=hH(hV,this).map(e=>i.indexOf(e)),n=hH(hF,this).getEngine().getSheetDimensions(hH(hF,this).getSheetId());t="row"===hH(hL,this)?n.height:n.width;let o=r.length;for(let e=o;e<t;e+=1)r.push(e);hH(hF,this).getEngine()[e](hH(hF,this).getSheetId(),r)}hP(hV,this,i)}}init(){hP(hV,this,hH(hD,this).getIndexesSequence())}}function hU(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function h$(e,t){return e.get(hY(e,t))}function hG(e,t,i){return e.set(hY(e,t),i),i}function hY(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var hK=new WeakMap,hX=new WeakMap,hq=new WeakMap,hJ=new WeakMap,hZ=new WeakMap,hQ=new WeakMap,h0=new WeakMap;class h1{constructor(e,t,i){hU(this,hK,void 0),hU(this,hX,void 0),hU(this,hq,void 0),hU(this,hJ,!1),hU(this,hZ,!1),hU(this,hQ,null),hU(this,h0,null),hG(hK,this,new hz("row",e,this)),hG(hX,this,new hz("column",t,this)),hG(hq,this,i)}getForAxis(e){return"row"===e?h$(hK,this):h$(hX,this)}setPerformUndo(e){hG(hJ,this,e)}setPerformRedo(e){hG(hZ,this,e)}isPerformingUndoRedo(){return h$(hJ,this)||h$(hZ,this)}getSheetId(){return h$(h0,this)}getEngine(){return h$(hQ,this)}getPostponeAction(){return h$(hq,this)}setupSyncEndpoint(e,t){hG(hQ,this,e),hG(h0,this,t),h$(hK,this).init(),h$(hX,this).init()}}function h2(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function h3(e,t,i){h5(e,t),t.set(e,i)}function h5(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function h9(e,t,i){return e.set(h4(e,t),i),i}function h8(e,t){return e.get(h4(e,t))}function h4(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let h7="formulas",h6=["maxRows","maxColumns","language"];d.R.getSingleton().register("afterNamedExpressionAdded"),d.R.getSingleton().register("afterNamedExpressionRemoved"),d.R.getSingleton().register("afterSheetAdded"),d.R.getSingleton().register("afterSheetRemoved"),d.R.getSingleton().register("afterSheetRenamed"),d.R.getSingleton().register("afterFormulasValuesUpdate");let ue=e=>"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e;var ut=new WeakMap,ui=new WeakMap,ur=new WeakMap,un=new WeakSet;class uo extends tC{constructor(){var e;super(...arguments),e=this,function(e,t){h5(e,t),t.add(e)}(this,un),h3(this,ut,!1),h3(this,ui,!1),h3(this,ur,[["valuesUpdated",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h4(un,e,uT).call(e,...i)}],["namedExpressionAdded",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h4(un,e,ux).call(e,...i)}],["namedExpressionRemoved",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h4(un,e,uM).call(e,...i)}],["sheetAdded",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h4(un,e,uO).call(e,...i)}],["sheetRenamed",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h4(un,e,uk).call(e,...i)}],["sheetRemoved",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h4(un,e,uI).call(e,...i)}]]),h2(this,"staticRegister",(0,i9.A)("formulas")),h2(this,"engine",null),h2(this,"sheetId",null),h2(this,"sheetName",null),h2(this,"indexSyncer",null),h2(this,"rowAxisSyncer",null),h2(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return h7}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[h7,...h6]}isEnabled(){return!!this.hot.getSettings()[h7]}enablePlugin(){var e,t=this;if(!this.enabled){if(this.engine=null!==(e=function(e){let t=e.getSettings(),i=t[h7],r=null==i?void 0:i.engine;if(!0===i||(0,T.isUndefined)(r))return null;if("function"==typeof r.hyperformula||"function"==typeof r){var n;return function(e,t,i){var r,n,o,s;let l=t[h7],a=function(e){var t;let i=e[h7],r=hC(null!=i&&null!==(t=i.engine)&&void 0!==t&&t.hyperformula?i.engine:{}),n=hb(e);return{...hv,...r,...n}}(t),h=hS(),u=hE();r=e,(n=l.functions)&&n.forEach(e=>{let{name:t,plugin:i,translations:n}=e;try{r.registerFunction(t,i,n)}catch(e){(0,iL.R8)(e.message)}}),function(e,t){if(t){let{langCode:i}=t;try{e.registerLanguage(i,t)}catch(e){(0,iL.R8)(e.message)}}}(e,l.language);let c=e.buildEmpty(a);return h.set(c,[i]),u.set(c,[i.guid]),o=c,(s=l.namedExpressions)&&(o.suspendEvaluation(),s.forEach(e=>{let{name:t,expression:i,scope:r,options:n}=e;try{o.addNamedExpression(t,i,r,n)}catch(e){(0,iL.R8)(e.message)}}),o.resumeEvaluation()),c.on("sheetAdded",()=>{c.rebuildAndRecalculate()}),c.on("sheetRemoved",()=>{c.rebuildAndRecalculate()}),c}(null!==(n=r.hyperformula)&&void 0!==n?n:r,t,e)}if("object"==typeof r&&(0,T.isUndefined)(r.hyperformula)){let t=hS(),i=hE().get(r);return t.has(r)||t.set(r,[]),t.get(r).push(e),i&&i.push(e.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:hy}),(r.getConfig().leapYear1900!==hv.leapYear1900||!1===(0,V.isObjectEqual)(r.getConfig().nullDate,hv.nullDate))&&(0,iL.R8)((0,ro.O)`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}(this.hot))&&void 0!==e?e:this.engine,!this.engine){(0,iL.R8)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){let e=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==e&&h4(un,this,us).call(this,e)}this.addHook("beforeLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uh).call(t,...i)}),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uc).call(t,...i)}),this.addHook("beforeUpdateData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uh).call(t,...i)}),this.addHook("afterUpdateData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uc).call(t,...i)}),this.addHook("modifyData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,ud).call(t,...i)}),this.addHook("modifySourceData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,ug).call(t,...i)}),this.addHook("beforeValidate",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,ul).call(t,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,up).call(t,...i)}),this.addHook("afterSetDataAtCell",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uf).call(t,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uf).call(t,...i)}),this.addHook("beforeCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,um).call(t,...i)}),this.addHook("beforeCreateCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uw).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,ub).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uC).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uy).call(t,...i)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uv).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uS).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uE).call(t,...i)}),this.indexSyncer=new h1(this.hot.rowIndexMapper,this.hot.columnIndexMapper,e=>{this.hot.addHookOnce("init",()=>{e()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(e,t,i,r)=>{this.rowAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("beforeColumnMove",(e,t,i,r)=>{this.columnAxisSyncer.storeMovesInformation(e,t,r)}),this.hot.addHook("afterRowMove",(e,t,i,r,n)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,n)}),this.hot.addHook("afterColumnMove",(e,t,i,r,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,n)}),this.hot.addHook("beforeColumnFreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart,t)}),this.hot.addHook("afterColumnFreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.hot.addHook("beforeColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.storeMovesInformation([e],this.hot.getSettings().fixedColumnsStart-1,t)}),this.hot.addHook("afterColumnUnfreeze",(e,t)=>{this.columnAxisSyncer.calculateAndSyncMoves(t,t)}),this.addHook("afterCellMetaReset",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uu).call(t,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,uR).call(t,...i)}),this.addHook("beforeAutofill",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h4(un,t,ua).call(t,...i)}),h8(ur,this).forEach(e=>{let[t,i]=e;return this.engine.on(t,i)}),super.enablePlugin()}}disablePlugin(){h8(ur,this).forEach(e=>{let[t,i]=e;return this.engine.off(t,i)}),hT(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){var t;let i=function(e){var t;let i=e[h7],r=hC(null!=i&&null!==(t=i.engine)&&void 0!==t&&t.hyperformula?i.engine:{}),n=hb(e);return{...r,...n}}(this.hot.getSettings());t=this.engine.getConfig(),Object.keys(i).some(e=>void 0!==i[e]&&i[e]!==t[e])&&this.engine.updateConfig(i);let r=this.hot.getSettings()[h7];if((0,T.isDefined)(r)&&(0,T.isDefined)(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!e.data&&null===this.sheetName){let e=this.hot.getSettings()[h7].sheetName;if(e&&this.engine.doesSheetExist(e))this.switchSheet(this.sheetName);else{let t=this.addSheet(null!=e?e:void 0,this.hot.getSourceDataArray());h4(un,this,us).call(this,t)}}super.updatePlugin(e)}destroy(){h8(ur,this).forEach(e=>{var t;let[i,r]=e;return null===(t=this.engine)||void 0===t?void 0:t.off(i,r)}),h9(ur,this,null),hT(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,t){if((0,T.isDefined)(t)&&!(0,ag.isArrayOfArrays)(t))return(0,iL.R8)("The provided data should be an array of arrays."),!1;if(null!=e&&this.engine.doesSheetExist(e))return(0,iL.R8)("Sheet with the provided name already exists."),!1;try{let i=this.engine.addSheet(null!=e?e:void 0);return t&&this.engine.setSheetContent(this.engine.getSheetId(i),t),i}catch(e){return(0,iL.R8)(e.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){(0,iL.z3)(`The sheet named \`${e}\` does not exist, switch aborted.`);return}h4(un,this,us).call(this,e);let t=this.engine.getSheetSerialized(this.sheetId);t.length>0&&this.hot.loadData(t,`${(0,U.toUpperCaseFirst)(h7)}.switchSheet`)}getCellType(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(e),n=this.hot.toPhysicalColumn(t);return null!==r&&null!==n?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)}):"EMPTY"}isFormulaCellType(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t)})}renderDependentSheets(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new Set;e.forEach(e=>{var t;let r=null==e||null===(t=e.address)||void 0===t?void 0:t.sheet;void 0===r||i.has(r)||i.add(r)}),hR(this.engine).forEach((e,r)=>{if((t||r!==this.sheetId)&&i.has(r)){var n;e.render(),null===(n=e.view)||void 0===n||n.adjustElementsSize()}})}validateDependentCells(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=e=>{var t;let{row:i,col:r,sheet:n}=null!==(t=null==e?void 0:e.address)&&void 0!==t?t:{};return(0,T.isDefined)(n)?`${n}:${i}x${r}`:""},r=new Set(t.map(e=>i(e)));e.forEach(e=>{var t,n;let{row:o,col:s}=null!==(t=e.address)&&void 0!==t?t:{};if(!1===(0,T.isDefined)(o)||!1===(0,T.isDefined)(s)||o>=this.hot.countRows()||s>=this.hot.countCols())return;let l=null==e||null===(n=e.address)||void 0===n?void 0:n.sheet,a=i(e);if(void 0!==l&&!r.has(a)){let e=hR(this.engine).get(l);if(!e)return;e.validateCell(e.getDataAtCell(o,s),e.getCellMeta(o,s),()=>{})}})}syncChangeWithEngine(e,t,i){let r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){(0,iL.R8)(`Not possible to set cell data at ${JSON.stringify(r)}`);return}let n=this.hot.getCellMeta(e,t);if(hM(i,n.type))if(hO(i,n.dateFormat))i=hk(i,n.dateFormat);else{var o;!1===("string"==typeof(o=i)&&o.startsWith("="))&&(i=`'${i}`)}return this.engine.setCellContents(r,i)}}function us(e){this.sheetName=e,this.sheetId=this.engine.getSheetId(this.sheetName)}function ul(e,t,i){let r=this.hot.propToCol(i);if(this.isFormulaCellType(t,r)){let e={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},i=this.hot.getCellMeta(t,r),n=this.engine.getCellValue(e);return"date"===i.type&&(0,b.isNumeric)(n)&&(n=hI(n,i.dateFormat)),"object"==typeof n&&null!==n?n.value:n}return e}function ua(e,t,i){let{row:r,col:n}=t.getTopStartCorner(),{row:o,col:s}=t.getBottomEndCorner(),{row:l,col:a}=i.getTopStartCorner(),{row:h,col:u}=i.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;let g=this.engine.getFillRangeData(c,d),{row:f,col:p}=c.start,{row:m,col:w}=c.end,y=m-f+1,b=w-p+1;for(let e=0;e<g.length;e+=1)for(let t=0;t<g[e].length;t+=1){let i=g[e][t],r=f+e%y,n=p+t%b,o=this.hot.getCellMeta(r,n);if(hM(i,o.type)){if(i.startsWith("'"))g[e][t]=i.slice(1);else if(!1===this.isFormulaCellType(r,n,this.sheetId)){var C;g[e][t]=(C=o.dateFormat,en(i,hx,!0).format(C))}}}return g}function uh(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";i.includes((0,U.toUpperCaseFirst)(h7))||h9(ui,this,(0,T.isUndefined)(this.hot.getSettings().data))}function uu(){if(h8(ui,this)){this.switchSheet(this.sheetName);return}let e=this.hot.getSourceDataArray();e.forEach((t,i)=>{t.forEach((t,r)=>{let n=this.hot.getCellMeta(i,r,{skipMetaExtension:!0}),o=n.dateFormat;hM(t,n.type)&&(hO(t,o)?e[i][r]=hk(t,o):t.startsWith("=")||(e[i][r]=`'${t}`))})}),h9(ut,this,!0);let t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),h9(ut,this,!1)}function uc(e,t){var i,r;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(n.includes((0,U.toUpperCaseFirst)(h7)))return;let o=(i=this.engine,r=this.hot.getSettings()[h7].sheetName,((0,T.isUndefined)(r)||!i.doesSheetExist(r))&&(r=i.addSheet(r)),r);if(h4(un,this,us).call(this,o),"updateSettings"!==n)if(h8(ui,this))this.switchSheet(this.sheetName);else{let e=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,e)){h9(ut,this,!0);let t=this.engine.setSheetContent(this.sheetId,e);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(t),h9(ut,this,!1)}}}function ud(e,t,i,r){if("get"!==r||h8(ut,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(e);if(null===n||null===t)return;let o=this.getCellType(n,t);if("VALUE"===o||"EMPTY"===o){var s,l;i.value="string"==typeof(l=s=i.value)&&"'"===l.charAt(0)&&"="===l.charAt(1)?s.substr(1):s;return}let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(t),sheet:this.sheetId},h=this.engine.getCellValue(a),u=this.hot.getCellMeta(n,t,{skipMetaExtension:!0});"date"===u.type&&(0,b.isNumeric)(h)&&(h=hI(h,u.dateFormat)),i.value="object"==typeof h&&null!==h?h.value:h}function ug(e,t,i,r){if("get"!==r||h8(ut,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(e),o=this.hot.propToCol(t);if(null===n||null===o)return;let s=this.getCellType(n,o);if("VALUE"===s||"EMPTY"===s)return;let l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===l.width&&0===l.height)return;let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};i.value=this.engine.getCellSerialized(a)}function uf(e,t){if(ue(t))return;let i=[],r=[],n=this.engine.batch(()=>{e.forEach(e=>{let[t,n,,o]=e,s=this.hot.propToCol(n),l=this.hot.toPhysicalRow(t),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(t,s,o):i.push([t,s,o]),r.push({address:h})})});i.length&&this.hot.addHookOnce("afterChange",()=>{let e=this.engine.batch(()=>{i.forEach(e=>{let[t,i,r]=e;this.syncChangeWithEngine(t,i,r)})});this.renderDependentSheets(e,!0)}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function up(e,t){if(ue(t))return;let i=[],r=[];e.forEach(e=>{let[t,n,,o]=e,s=this.hot.propToCol(n);if(!(0,b.isNumeric)(s))return;let l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){(0,iL.R8)(`Not possible to set source cell data at ${JSON.stringify(l)}`);return}r.push({address:l}),i.push(...this.engine.setCellContents(l,o))}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function um(e,t){let i=this.rowAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countRows()&&(i=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,t]))return!1}function uw(e,t){let i=this.columnAxisSyncer.getHfIndexFromVisualIndex(e);if(e>=this.hot.countCols()&&(i=e),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,t]))return!1}function uy(e,t,i){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(i).every(e=>this.engine.isItPossibleToRemoveRows(this.sheetId,[e,1]))&&void 0}function uv(e,t,i){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(i).every(e=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[e,1]))&&void 0}function ub(e,t,i){if(ue(i))return;let r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function uC(e,t,i){if(ue(i))return;let r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(e),t]);this.renderDependentSheets(r)}function uS(e,t,i,r){if(ue(r))return;let n=this.rowAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e),o=this.engine.batch(()=>{n.forEach(e=>{this.engine.removeRows(this.sheetId,[e,1])})});this.renderDependentSheets(o)}function uE(e,t,i,r){if(ue(r))return;let n=this.columnAxisSyncer.getRemovedHfIndexes().sort((e,t)=>t-e),o=this.engine.batch(()=>{n.forEach(e=>{this.engine.removeColumns(this.sheetId,[e,1])})});this.renderDependentSheets(o)}function uR(e,t,i){var r;h9(ut,this,!0);let n=this.hot.getSourceDataArray(i,0,i+((null===(r=t.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());h9(ut,this,!1),n.forEach((e,t)=>{e.forEach((e,r)=>{this.engine.setCellContents({col:r,row:i+t,sheet:this.sheetId},[[e]])})})}function uT(e){this.hot.runHooks("afterFormulasValuesUpdate",e)}function ux(e,t){this.hot.runHooks("afterNamedExpressionAdded",e,t)}function uM(e,t){this.hot.runHooks("afterNamedExpressionRemoved",e,t)}function uO(e){this.hot.runHooks("afterSheetAdded",e)}function uk(e,t){h4(un,this,us).call(this,t),this.hot.runHooks("afterSheetRenamed",e,t)}function uI(e,t){this.hot.runHooks("afterSheetRemoved",e,t)}var uA=i(44065);function uN(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function uH(e,t){return e.get(u_(e,t))}function uP(e,t,i){return e.set(u_(e,t),i),i}function u_(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeHideColumns"),d.R.getSingleton().register("afterHideColumns"),d.R.getSingleton().register("beforeUnhideColumns"),d.R.getSingleton().register("afterUnhideColumns");let uL="hiddenColumns";var uD=new WeakMap,uF=new WeakSet;class uV extends tC{constructor(){super(...arguments),function(e,t){uN(e,t),t.add(e)}(this,uF),function(e,t,i){uN(e,t),t.set(e,null)}(this,uD,0)}static get PLUGIN_KEY(){return uL}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[uL]}enablePlugin(){var e=this;this.enabled||(uP(uD,this,new uA.o),uH(uD,this).addLocalHook("init",()=>u_(uF,this,u$).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,uH(uD,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return u_(uF,e,uU).call(e,...i)}),this.addHook("afterGetCellMeta",(e,t,i)=>u_(uF,this,uB).call(this,e,t,i)),this.addHook("modifyColWidth",(e,t)=>u_(uF,this,uW).call(this,e,t),2),this.addHook("afterGetColHeader",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return u_(uF,e,uz).call(e,...i)}),this.addHook("modifyCopyableRange",e=>u_(uF,this,uj).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){let t=this.getHiddenColumns(),i=this.isValidConfig(e),r=t,n=uH(uD,this).getValues().slice(),o=e.length>0;if(i&&o){let t=e.map(e=>this.hot.toPhysicalColumn(e));(0,z.arrayEach)(t,e=>{n[e]=!1}),r=(0,z.arrayReduce)(n,(e,t,i)=>(t&&e.push(this.hot.toVisualColumn(i)),e),[])}!1!==this.hot.runHooks("beforeUnhideColumns",t,r,i&&o)&&(i&&o&&uH(uD,this).setValues(n),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",t,r,i&&o,i&&r.length<t.length))}showColumn(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showColumns(t)}hideColumns(e){let t=this.getHiddenColumns(),i=this.isValidConfig(e),r=t;i&&(r=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideColumns",t,r,i)&&(i&&this.hot.batchExecution(()=>{(0,z.arrayEach)(e,e=>{uH(uD,this).setValueAtIndex(this.hot.toPhysicalColumn(e),!0)})},!0),this.hot.runHooks("afterHideColumns",t,r,i,i&&r.length>t.length))}hideColumn(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideColumns(t)}getHiddenColumns(){return(0,z.arrayMap)(uH(uD,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return uH(uD,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){let t=this.hot.countCols();return!!Array.isArray(e)&&e.length>0&&e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}resetCellsMeta(){(0,z.arrayEach)(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){uP(uD,this,null),super.destroy()}}function uW(e,t){return this.isHidden(t)?0:this.getSetting("indicators")&&(this.isHidden(t+1)||this.isHidden(t-1))&&"number"==typeof e&&this.hot.hasColHeaders()?e+15:void 0}function uB(e,t,i){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(t)&&(i.skipColumnOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenColumn")&&(i.className+=" afterHiddenColumn");else if(i.className){let e=i.className.split(" ");if(e.length>0){let t=e.indexOf("afterHiddenColumn");t>-1&&e.splice(t,1),i.className=e.join(" ")}}}function uj(e){if(this.getSetting("copyPasteEnabled"))return e;let t=[],i=(e,i,r,n)=>{t.push({startRow:e,endRow:i,startCol:r,endCol:n})};return(0,z.arrayEach)(e,e=>{let t=!0,r=0;(0,b.rangeEach)(e.startCol,e.endCol,n=>{this.isHidden(n)?(t||i(e.startRow,e.endRow,r,n-1),t=!0):(t&&(r=n),n===e.endCol&&i(e.startRow,e.endRow,r,n),t=!1)})}),t}function uz(e,t){if(!this.getSetting("indicators")||e<0)return;let i=[];e>=1&&this.isHidden(e-1)&&i.push("afterHiddenColumn"),e<this.hot.countCols()-1&&this.isHidden(e+1)&&i.push("beforeHiddenColumn"),(0,y.addClass)(t,i)}function uU(e){var t;e.items.push({name:nt},(t=this,{key:"hidden_columns_hide",name(){let e=this.getSelectedLast(),t=0;if(Array.isArray(e)){let[,i,,r]=e;i-r!=0&&(t=1)}return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_HIDE_COLUMN,t)},callback(){let{from:e,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.col,i.col),0),n=Math.max(e.col,i.col),o=[];for(let e=r;e<=n;e+=1)o.push(e);t.hideColumns(o);let s=o[o.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(e){let t=[];return{key:"hidden_columns_show",name(){let e=+(t.length>1);return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_SHOW_COLUMN,e)},callback(){var i,r;if(0===t.length)return;let n=t[0],o=t[t.length-1];n=null!==(i=this.columnIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==i?i:0,o=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countCols()-1,e.showColumns(t),this.render(),this.view.adjustElementsSize(),o-n+1!==this.countCols()&&this.selectColumns(n,o)},disabled:!1,hidden(){let i=(0,z.arrayMap)(e.getHiddenColumns(),e=>this.toPhysicalColumn(e));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(n),a=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(n!==o){if(o-n+1>a-l+1){let e=h.slice(n,o+1);u.push(...e.filter(e=>i.includes(e)))}}else if(0===l&&l<n)u.push(...h.slice(0,n));else if(null===l)u.push(...h.slice(0,this.countCols()));else{let e=this.countCols()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...h.slice(o+1))}return(0,z.arrayEach)(u,e=>{t.push(this.toVisualColumn(e))}),0===t.length}}}(this))}function u$(){let e=this.getSetting("columns");Array.isArray(e)&&this.hideColumns(e)}function uG(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function uY(e,t){return e.get(uX(e,t))}function uK(e,t,i){return e.set(uX(e,t),i),i}function uX(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeHideRows"),d.R.getSingleton().register("afterHideRows"),d.R.getSingleton().register("beforeUnhideRows"),d.R.getSingleton().register("afterUnhideRows");let uq="hiddenRows";var uJ=new WeakMap,uZ=new WeakSet;class uQ extends tC{constructor(){super(...arguments),function(e,t){uG(e,t),t.add(e)}(this,uZ),function(e,t,i){uG(e,t),t.set(e,null)}(this,uJ,0)}static get PLUGIN_KEY(){return uq}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[uq]}enablePlugin(){var e=this;this.enabled||(uK(uJ,this,new uA.o),uY(uJ,this).addLocalHook("init",()=>uX(uZ,this,u9).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,uY(uJ,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uX(uZ,e,u5).call(e,...i)}),this.addHook("afterGetCellMeta",(e,t,i)=>uX(uZ,this,u1).call(this,e,t,i)),this.addHook("modifyRowHeight",(e,t)=>uX(uZ,this,u0).call(this,e,t)),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return uX(uZ,e,u3).call(e,...i)}),this.addHook("modifyCopyableRange",e=>uX(uZ,this,u2).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){let t=this.getHiddenRows(),i=this.isValidConfig(e),r=t,n=uY(uJ,this).getValues().slice(),o=e.length>0;if(i&&o){let t=e.map(e=>this.hot.toPhysicalRow(e));(0,z.arrayEach)(t,e=>{n[e]=!1}),r=(0,z.arrayReduce)(n,(e,t,i)=>(t&&e.push(this.hot.toVisualRow(i)),e),[])}!1!==this.hot.runHooks("beforeUnhideRows",t,r,i&&o)&&(i&&o&&uY(uJ,this).setValues(n),this.hot.runHooks("afterUnhideRows",t,r,i&&o,i&&r.length<t.length))}showRow(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.showRows(t)}hideRows(e){let t=this.getHiddenRows(),i=this.isValidConfig(e),r=t;i&&(r=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeHideRows",t,r,i)&&(i&&this.hot.batchExecution(()=>{(0,z.arrayEach)(e,e=>{uY(uJ,this).setValueAtIndex(this.hot.toPhysicalRow(e),!0)})},!0),this.hot.runHooks("afterHideRows",t,r,i,i&&r.length>t.length))}hideRow(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.hideRows(t)}getHiddenRows(){return(0,z.arrayMap)(uY(uJ,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return uY(uJ,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){let t=this.hot.countRows();return!!Array.isArray(e)&&e.length>0&&e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}resetCellsMeta(){(0,z.arrayEach)(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){uK(uJ,this,null),super.destroy()}}function u0(e,t){return this.isHidden(t)?0:e}function u1(e,t,i){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(e)&&(i.skipRowOnPaste=!0),this.isHidden(e-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenRow")&&(i.className+=" afterHiddenRow");else if(i.className){let e=i.className.split(" ");if(e.length>0){let t=e.indexOf("afterHiddenRow");t>-1&&e.splice(t,1),i.className=e.join(" ")}}}function u2(e){if(this.getSetting("copyPasteEnabled"))return e;let t=[],i=(e,i,r,n)=>{t.push({startRow:e,endRow:i,startCol:r,endCol:n})};return(0,z.arrayEach)(e,e=>{let t=!0,r=0;(0,b.rangeEach)(e.startRow,e.endRow,n=>{this.isHidden(n)?(t||i(r,n-1,e.startCol,e.endCol),t=!0):(t&&(r=n),n===e.endRow&&i(r,n,e.startCol,e.endCol),t=!1)})}),t}function u3(e,t){if(!this.getSetting("indicators")||e<0)return;let i=[];e>=1&&this.isHidden(e-1)&&i.push("afterHiddenRow"),e<this.hot.countRows()-1&&this.isHidden(e+1)&&i.push("beforeHiddenRow"),(0,y.addClass)(t,i)}function u5(e){var t;e.items.push({name:nt},(t=this,{key:"hidden_rows_hide",name(){let e=this.getSelectedLast(),t=0;if(Array.isArray(e)){let[i,,r]=e;i-r!=0&&(t=1)}return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_HIDE_ROW,t)},callback(){let{from:e,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(e.row,i.row),0),n=Math.max(e.row,i.row),o=[];for(let e=r;e<=n;e+=1)o.push(e);t.hideRows(o);let s=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(e){let t=[];return{key:"hidden_rows_show",name(){let e=+(t.length>1);return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_SHOW_ROW,e)},callback(){var i,r;if(0===t.length)return;let n=t[0],o=t[t.length-1];n=null!==(i=this.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==i?i:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,e.showRows(t),this.render(),this.view.adjustElementsSize(),o-n+1!==this.countRows()&&this.selectRows(n,o)},disabled:!1,hidden(){let i=(0,z.arrayMap)(e.getHiddenRows(),e=>this.toPhysicalRow(e));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;t.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(n),a=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(n!==o){if(o-n+1>a-l+1){let e=h.slice(n,o+1);u.push(...e.filter(e=>i.includes(e)))}}else if(0===l&&l<n)u.push(...h.slice(0,n));else if(null===l)u.push(...h.slice(0,this.countRows()));else{let e=this.countRows()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(e,-1))&&e>o&&u.push(...h.slice(o+1))}return(0,z.arrayEach)(u,e=>{t.push(this.toVisualRow(e))}),0===t.length}}}(this))}function u9(){let e=this.getSetting("rows");Array.isArray(e)&&this.hideRows(e)}function u8(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function u4(e,t){return e.get(u6(e,t))}function u7(e,t,i){return e.set(u6(e,t),i),i}function u6(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeColumnFreeze"),d.R.getSingleton().register("afterColumnFreeze"),d.R.getSingleton().register("beforeColumnUnfreeze"),d.R.getSingleton().register("afterColumnUnfreeze");let ce="manualColumnFreeze";var ct=new WeakMap,ci=new WeakSet;class cr extends tC{constructor(){super(...arguments),function(e,t){u8(e,t),t.add(e)}(this,ci),function(e,t,i){u8(e,t),t.set(e,i)}(this,ct,!1)}static get PLUGIN_KEY(){return ce}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[ce]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>u6(ci,this,cn).call(this,e)),this.addHook("beforeColumnMove",(e,t)=>u6(ci,this,co).call(this,e,t)),super.enablePlugin())}disablePlugin(){u7(ct,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){let t=this.hot.getSettings(),i=t.fixedColumnsStart<this.hot.countCols()&&e>t.fixedColumnsStart-1;u4(ct,this)||u7(ct,this,!0),!1!==this.hot.runHooks("beforeColumnFreeze",e,i)&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart),t._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){let t=this.hot.getSettings(),i=t.fixedColumnsStart>0&&e<=t.fixedColumnsStart-1;u4(ct,this)||u7(ct,this,!0),!1!==this.hot.runHooks("beforeColumnUnfreeze",e,i)&&(i&&(t._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,t.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function cn(e){var t,i;e.items.push({name:"---------"},(t=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(e,i){let[{start:{col:r}}]=i;t.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){let e=this.getSelectedRange(),t=!1;return void 0===e?t=!0:e.length>1?t=!0:(e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(t=!0),t}}),(i=this,{key:"unfreeze_column",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(e,t){let[{start:{col:r}}]=t;i.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){let e=this.getSelectedRange(),t=!1;return void 0===e?t=!0:e.length>1?t=!0:(e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(t=!0),t}}))}function co(e,t){if(u4(ct,this)){let i=this.hot.getSettings().fixedColumnsStart;if(t<i||e.some(e=>e<i))return!1}}function cs(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class cl{constructor(e){cs(this,"hot",void 0),cs(this,"_element",null),cs(this,"state",0),cs(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){(0,b.isNumeric)(e)&&(this._element.style.top=e+"px"),(0,b.isNumeric)(t)&&(this._element.style[this.inlineProperty]=t+"px")}getPosition(){let e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,t){(0,b.isNumeric)(e)&&(this._element.style.width=e+"px"),(0,b.isNumeric)(t)&&(this._element.style.height=t+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){(0,b.isNumeric)(e)&&(this._element.style.marginTop=e+"px"),(0,b.isNumeric)(t)&&(this._element.style[`margin${(0,U.toUpperCaseFirst)(this.inlineProperty)}`]=t+"px")}getOffset(){let e=this._element.style,t=`margin${(0,U.toUpperCaseFirst)(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[t]?parseInt(e[t],10):0}}}let ca=cl;class ch extends ca{build(){super.build(),(0,y.addClass)(this._element,"ht__manualColumnMove--backlight")}}class cu extends ca{build(){super.build(),(0,y.addClass)(this._element,"ht__manualColumnMove--guideline")}}function cc(e,t,i){cd(e,t),t.set(e,i)}function cd(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function cg(e,t,i){return e.set(cp(e,t),i),i}function cf(e,t){return e.get(cp(e,t))}function cp(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeColumnMove"),d.R.getSingleton().register("afterColumnMove");let cm="manualColumnMove",cw="ht__manualColumnMove",cy="show-ui",cv="on-moving--columns",cb="after-selection--columns";var cC=new WeakMap,cS=new WeakMap,cE=new WeakMap,cR=new WeakMap,cT=new WeakMap,cx=new WeakMap,cM=new WeakMap,cO=new WeakMap,ck=new WeakMap,cI=new WeakMap,cA=new WeakMap,cN=new WeakSet;class cH extends tC{constructor(){super(...arguments),function(e,t){cd(e,t),t.add(e)}(this,cN),cc(this,cC,new ch(this.hot)),cc(this,cS,new cu(this.hot)),cc(this,cE,[]),cc(this,cR,0),cc(this,cT,!1),cc(this,cx,{}),cc(this,cM,void 0),cc(this,cO,void 0),cc(this,ck,void 0),cc(this,cI,void 0),cc(this,cA,void 0)}static get PLUGIN_KEY(){return cm}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[cm]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return cp(cN,e,cP).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return cp(cN,e,cL).call(e,...i)}),this.addHook("afterScrollVertically",()=>cp(cN,this,cF).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return cp(cN,e,cV).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),(0,y.addClass)(this.hot.rootElement,cw),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,y.removeClass)(this.hot.rootElement,cw),this.unregisterEvents(),cf(cC,this).destroy(),cf(cS,this).destroy(),super.disablePlugin()}moveColumn(e,t){return this.moveColumns([e],t)}moveColumns(e,t){let i=cf(cM,this),r=this.isMovePossible(e,t),n=this.hot.runHooks("beforeColumnMove",e,t,i,r);if(cg(cM,this,void 0),!1===n)return;r&&this.hot.columnIndexMapper.moveIndexes(e,t);let o=r&&this.isColumnOrderChanged(e,t);return this.hot.runHooks("afterColumnMove",e,t,i,r,o),o}dragColumn(e,t){return this.dragColumns([e],t)}dragColumns(e,t){let i=this.countFinalIndex(e,t);return cg(cM,this,t),this.moveColumns(e,i)}isMovePossible(e,t){let i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>i,n=e.some(e=>e<0),o=e.some(e=>e>=i);return!r&&!(t<0)&&!n&&!o}isColumnOrderChanged(e,t){return e.some((e,i)=>e-i!==t)}countFinalIndex(e,t){let i=(0,z.arrayReduce)(e,(e,i)=>(i<t&&(e+=1),e),0);return t-i}getColumnsWidth(e,t){let i=this.hot.columnIndexMapper,r=0;for(let n=e;n<=t;n+=1){let e=i.getRenderableFromVisualIndex(n);n<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==e&&(r+=this.hot.view._wt.wtTable.getColumnWidth(e)||0)}return r}moveBySettingsOrLoad(){let e=this.hot.getSettings()[cm];if(Array.isArray(e))this.moveColumns(e,0);else if(void 0!==e){let e=this.persistentStateLoad();e.length&&this.moveColumns(e,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,t){let i=[];return(0,b.rangeEach)(e,t,e=>{i.push(e)}),i}refreshPositions(){let e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(cf(cO,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});let t=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r="number"==typeof i.scrollX?i.scrollX:i.scrollLeft,n=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,cf(cO,this)-1),o=t.hider.offsetWidth,s=t.TBODY.offsetLeft,l=cf(cC,this).getOffset().start,a=cf(cC,this).getSize().width,h=0,u=0;if(this.hot.isRtl()){let e=this.hot.rootWindow,t=(0,y.outerWidth)(this.hot.rootElement),n=e.innerWidth-cf(ck,this)-t;u=e.innerWidth-cf(cx,this).eventPageX-n-(void 0===i.scrollX?r:0)}else u=cf(cx,this).eventPageX-(cf(ck,this)-(void 0===i.scrollX?r:0));if(cf(cI,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(cf(cO,this))&&(n+=r),n+=h,0>cf(cO,this))cf(cA,this)>0?cf(cx,this).col=0:cf(cx,this).col=e>0?e-1:e;else if(cf(cx,this).TD.offsetWidth/2+n<=u){let e=cf(cO,this)>=cf(cR,this)?cf(cR,this)-1:cf(cO,this);cf(cx,this).col=e+1,n+=cf(cx,this).TD.offsetWidth}else cf(cx,this).col=cf(cO,this);let c=u,d=n;u+a+l>=o?c=o-a-l:u+l<s+h&&(c=s+h+Math.abs(l)),n>=o-1?d=o-1:0===d?d=1:void 0!==i.scrollX&&cf(cO,this)<cf(cA,this)&&(d-=cf(ck,this)<=i.scrollX?cf(ck,this):0),cf(cC,this).setPosition(null,c),cf(cS,this).setPosition(null,d)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",e=>cp(cN,this,c_).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>cp(cN,this,cD).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){cf(cC,this).build(),cf(cS,this).build()}destroy(){cf(cC,this).destroy(),cf(cS,this).destroy(),super.destroy()}}function cP(e,t,i,r){let n=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),l=(0,y.hasClass)(e.target,"sortAction");if(!s||!o||cf(cT,this)||0!==e.button||l){cg(cT,this,!1),cf(cE,this).length=0,(0,y.removeClass)(this.hot.rootElement,[cv,cy]);return}let a=cf(cS,this).isBuilt()&&!cf(cS,this).isAppended(),h=cf(cC,this).isBuilt()&&!cf(cC,this).isAppended();a&&h&&(cf(cS,this).appendTo(n.hider),cf(cC,this).appendTo(n.hider));let{from:u,to:c}=s,d=Math.min(u.col,c.col),g=Math.max(u.col,c.col);if(t.row<0&&t.col>=d&&t.col<=g){r.column=!0,cg(cT,this,!0);let o=i.firstChild?(0,F.offsetRelativeTo)(e,i.firstChild).x:e.offsetX;cf(cx,this).eventPageX=e.pageX,cg(cO,this,t.col),cf(cx,this).TD=i,cf(cx,this).col=t.col,cg(cE,this,this.prepareColumnsToMoving(d,g)),cg(cI,this,!!this.hot.getSettings().rowHeaders),cg(cR,this,this.hot.countCols()),cg(cA,this,this.hot.getSettings().fixedColumnsStart),cg(ck,this,(0,y.offset)(this.hot.rootElement).left);let s=cf(cI,this)?-1:0,l=n.holder.scrollTop+n.getColumnHeaderHeight(0)+1,a=t.col<cf(cA,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),u=Math.abs(o-(this.hot.isRtl()?i.offsetWidth:0)),c=this.getColumnsWidth(d,t.col-1)+u,f=this.getColumnsWidth(s,d-1)+(a?h:0)+c;cf(cC,this).setPosition(l,f),cf(cC,this).setSize(this.getColumnsWidth(d,g),n.hider.offsetHeight-l),cf(cC,this).setOffset(null,-c),(0,y.addClass)(this.hot.rootElement,cv)}else(0,y.removeClass)(this.hot.rootElement,cb),cg(cT,this,!1),cf(cE,this).length=0}function c_(e){cf(cT,this)&&(cf(cx,this).eventPageX=e.pageX,this.refreshPositions())}function cL(e,t,i,r){this.hot.getSelectedRangeLast()&&cf(cT,this)&&(cf(cE,this).indexOf(t.col)>-1?(0,y.removeClass)(this.hot.rootElement,cy):(0,y.addClass)(this.hot.rootElement,cy),r.row=!0,r.column=!0,r.cell=!0,cg(cO,this,t.col),cf(cx,this).TD=i)}function cD(){let e=cf(cx,this).col,t=cf(cE,this).length;if(cg(cO,this,void 0),cg(cT,this,!1),(0,y.removeClass)(this.hot.rootElement,[cv,cy,cb]),this.hot.selection.isSelectedByColumnHeader()&&(0,y.addClass)(this.hot.rootElement,cb),t<1||void 0===e)return;let i=cf(cE,this)[0],r=this.hot.toPhysicalColumn(i),n=this.dragColumns(cf(cE,this),e);if(cf(cE,this).length=0,!0===n){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let e=this.hot.toVisualColumn(r);this.hot.selectColumns(e,e+t-1)}}function cF(){let e=this.hot.view._wt.wtTable,t=e.getColumnHeaderHeight(0)+1+e.holder.scrollTop;cf(cC,this).setPosition(t),cf(cC,this).setSize(null,e.hider.offsetHeight-t)}function cV(){this.moveBySettingsOrLoad()}function cW(e,t,i){cB(e,t),t.set(e,i)}function cB(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function cj(e,t,i){return e.set(cU(e,t),i),i}function cz(e,t){return e.get(cU(e,t))}function cU(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let c$="manualColumnResize",cG="manualColumnWidths";var cY=new WeakMap,cK=new WeakMap,cX=new WeakMap,cq=new WeakMap,cJ=new WeakMap,cZ=new WeakMap,cQ=new WeakMap,c0=new WeakMap,c1=new WeakMap,c2=new WeakMap,c3=new WeakMap,c5=new WeakMap,c9=new WeakMap,c8=new WeakMap,c4=new WeakMap,c7=new WeakMap,c6=new WeakSet;class de extends tC{static get PLUGIN_KEY(){return c$}static get PLUGIN_PRIORITY(){return 130}constructor(e){super(e),function(e,t){cB(e,t),t.add(e)}(this,c6),cW(this,cY,null),cW(this,cK,null),cW(this,cX,[]),cW(this,cq,null),cW(this,cJ,null),cW(this,cZ,null),cW(this,cQ,null),cW(this,c0,null),cW(this,c1,this.hot.rootDocument.createElement("DIV")),cW(this,c2,this.hot.rootDocument.createElement("DIV")),cW(this,c3,null),cW(this,c5,!1),cW(this,c9,0),cW(this,c8,null),cW(this,c4,void 0),cW(this,c7,void 0),(0,y.addClass)(cz(c1,this),"manualColumnResizer"),(0,y.addClass)(cz(c2,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[c$]}enablePlugin(){var e=this;this.enabled||(cj(c4,this,new tk._),cz(c4,this).addLocalHook("init",()=>cU(c6,this,dt).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,cz(c4,this)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return cU(c6,e,da).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return cU(c6,e,dh).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return cU(c6,e,du).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){cj(c7,this,cz(c4,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",cG,cz(c4,this).getValues())}loadManualColumnWidths(){let e={};return this.hot.runHooks("persistentStateLoad",cG,e),e.value}setManualSize(e,t){let i=Math.max(t,20),r=this.hot.toPhysicalColumn(e);return cz(c4,this).setValueAtIndex(r,i),i}clearManualSize(e){let t=this.hot.toPhysicalColumn(e);cz(c4,this).setValueAtIndex(t,null)}setupHandlePosition(e){let t;if(!e.parentNode)return;cj(cY,this,e);let{_wt:i}=this.hot.view,r=i.wtTable.getCoords(cz(cY,this)),n=r.col;if(n<0)return;let o=(0,y.outerHeight)(cz(cY,this)),s=cz(cY,this).getBoundingClientRect();n<i.getSetting("fixedColumnsStart")&&(t=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(cz(cY,this),r.row,r.col)),t||(t=i.wtOverlays.topOverlay.getRelativeCellPosition(cz(cY,this),r.row,r.col)),cj(cK,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),cj(cX,this,[]);let l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&l){let e=this.hot.getSelectedRange();(0,z.arrayEach)(e,e=>{let t=e.getTopStartCorner().col,i=e.getBottomEndCorner().col;(0,b.rangeEach)(t,i,e=>{cz(cX,this).includes(e)||cz(cX,this).push(e)})})}cz(cX,this).includes(cz(cK,this))||cj(cX,this,[cz(cK,this)]),cj(c0,this,t.start-6),cj(cQ,this,parseInt(s.width,10)),cz(c1,this).style.top=`${t.top}px`,cz(c1,this).style[this.inlineDir]=`${cz(c0,this)+cz(cQ,this)}px`,cz(c1,this).style.height=`${o}px`,this.hot.rootElement.appendChild(cz(c1,this))}refreshHandlePosition(){cz(c1,this).style[this.inlineDir]=`${cz(c0,this)+cz(cq,this)}px`}setupGuidePosition(){let e=parseInt((0,y.outerHeight)(cz(c1,this)),10),t=parseInt(cz(c1,this).style.top,10)+e,i=this.hot.view.getTableHeight();(0,y.addClass)(cz(c1,this),"active"),(0,y.addClass)(cz(c2,this),"active"),cz(c2,this).style.top=`${t}px`,this.refreshGuidePosition(),cz(c2,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(cz(c2,this))}refreshGuidePosition(){cz(c2,this).style[this.inlineDir]=cz(c1,this).style[this.inlineDir]}hideHandleAndGuide(){(0,y.removeClass)(cz(c1,this),"active"),(0,y.removeClass)(cz(c2,this),"active")}checkIfColumnHeader(e){let t=(0,y.closest)(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){let e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,i)=>{let r=this.hot.runHooks("beforeColumnResize",cz(cJ,this),t,!0);void 0!==r&&cj(cJ,this,r),this.setManualSize(t,cz(cJ,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",cz(cJ,this),t,!0),i&&e()};cz(c9,this)>=2&&(cz(cX,this).length>1?((0,z.arrayEach)(cz(cX,this),e=>{t(e)}),e()):(0,z.arrayEach)(cz(cX,this),e=>{t(e,!0)})),cj(c9,this,0),cj(c8,this,null)}bindEvents(){let{rootWindow:e,rootElement:t}=this.hot;this.eventManager.addEventListener(t,"mouseover",e=>cU(c6,this,di).call(this,e)),this.eventManager.addEventListener(t,"mousedown",e=>cU(c6,this,dr).call(this,e)),this.eventManager.addEventListener(e,"mousemove",e=>cU(c6,this,dn).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>cU(c6,this,ds).call(this)),this.eventManager.addEventListener(cz(c1,this),"contextmenu",()=>cU(c6,this,dl).call(this))}destroy(){super.destroy()}}function dt(){let e=this.hot.getSettings()[c$],t=this.loadManualColumnWidths();void 0!==t?this.hot.batchExecution(()=>{t.forEach((e,t)=>{cz(c4,this).setValueAtIndex(t,e)})},!0):Array.isArray(e)?(this.hot.batchExecution(()=>{e.forEach((e,t)=>{cz(c4,this).setValueAtIndex(t,e)})},!0),cj(c7,this,e)):!0===e&&Array.isArray(cz(c7,this))&&this.hot.batchExecution(()=>{cz(c7,this).forEach((e,t)=>{cz(c4,this).setValueAtIndex(t,e)})},!0)}function di(e){if(!(0,y.isDetached)(e.target)&&!0!==cz(c5,this)&&this.checkIfColumnHeader(e.target)){let t=this.getClosestTHParent(e.target);if(!t)return;let i=t.getAttribute("colspan");t&&(null===i||"1"===i)&&!cz(c3,this)&&this.setupHandlePosition(t)}}function dr(e){e.target.parentNode===this.hot.rootElement&&(0,y.hasClass)(e.target,"manualColumnResizer")&&(this.setupHandlePosition(cz(cY,this)),this.setupGuidePosition(),cj(c3,this,!0),null===cz(c8,this)&&(cj(c8,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(cz(c8,this))),cj(c9,this,cz(c9,this)+1),this.startX=e.pageX,cj(cJ,this,cz(cQ,this)))}function dn(e){if(cz(c3,this)){let t=(e.pageX-this.startX)*this.hot.getDirectionFactor();cj(cq,this,cz(cQ,this)+t),(0,z.arrayEach)(cz(cX,this),e=>{cj(cJ,this,this.setManualSize(e,cz(cq,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function ds(){let e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,i)=>{this.hot.runHooks("beforeColumnResize",cz(cJ,this),t,!1),i&&e(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",cz(cJ,this),t,!1)};cz(c3,this)&&(this.hideHandleAndGuide(),cj(c3,this,!1),cz(cJ,this)!==cz(cQ,this)&&(cz(cX,this).length>1?((0,z.arrayEach)(cz(cX,this),e=>{t(e)}),e()):(0,z.arrayEach)(cz(cX,this),e=>{t(e,!0)})),this.setupHandlePosition(cz(cY,this)))}function dl(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(cz(c1,this)),this.hot.rootElement.removeChild(cz(c2,this)),cj(c3,this,!1),cj(c5,this,!0),this.hot._registerImmediate(()=>{cj(c5,this,!1)})}function da(e,t){let i=e;if(this.enabled){let e=this.hot.toPhysicalColumn(t),r=cz(c4,this).getValueAtIndex(e);this.hot.getSettings()[c$]&&r&&(i=r)}return i}function dh(e,t){let i=cz(c4,this).getValueAtIndex(this.hot.toPhysicalColumn(t));return"number"==typeof i?i:e}function du(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function dc(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class dd{constructor(e){dc(this,"hot",void 0),dc(this,"_element",null),dc(this,"state",0),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(e,t){void 0!==e&&(this._element.style.top=e+"px"),void 0!==t&&(this._element.style.left=t+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,t){e&&(this._element.style.width=e+"px"),t&&(this._element.style.height=t+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,t){e&&(this._element.style.marginTop=e+"px"),t&&(this._element.style.marginLeft=t+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}let dg=dd;class df extends dg{build(){super.build(),(0,y.addClass)(this._element,"ht__manualRowMove--backlight")}}class dp extends dg{build(){super.build(),(0,y.addClass)(this._element,"ht__manualRowMove--guideline")}}function dm(e,t,i){dw(e,t),t.set(e,i)}function dw(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function dy(e,t,i){return e.set(db(e,t),i),i}function dv(e,t){return e.get(db(e,t))}function db(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeRowMove"),d.R.getSingleton().register("afterRowMove");let dC="manualRowMove",dS="ht__manualRowMove",dE="show-ui",dR="on-moving--rows",dT="after-selection--rows";var dx=new WeakMap,dM=new WeakMap,dO=new WeakMap,dk=new WeakMap,dI=new WeakMap,dA=new WeakMap,dN=new WeakSet;class dH extends tC{constructor(){super(...arguments),function(e,t){dw(e,t),t.add(e)}(this,dN),dm(this,dx,new df(this.hot)),dm(this,dM,new dp(this.hot)),dm(this,dO,[]),dm(this,dk,void 0),dm(this,dI,{}),dm(this,dA,void 0)}static get PLUGIN_KEY(){return dC}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[dC]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return db(dN,e,dP).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return db(dN,e,dL).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>db(dN,this,dF).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return db(dN,e,dV).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),(0,y.addClass)(this.hot.rootElement,dS),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,y.removeClass)(this.hot.rootElement,dS),this.unregisterEvents(),dv(dx,this).destroy(),dv(dM,this).destroy(),super.disablePlugin()}moveRow(e,t){return this.moveRows([e],t)}moveRows(e,t){let i=dv(dA,this),r=this.isMovePossible(e,t),n=this.hot.runHooks("beforeRowMove",e,t,i,r);if(dy(dA,this,void 0),!1===n)return;r&&this.hot.rowIndexMapper.moveIndexes(e,t);let o=r&&this.isRowOrderChanged(e,t);return this.hot.runHooks("afterRowMove",e,t,i,r,o),o}dragRow(e,t){return this.dragRows([e],t)}dragRows(e,t){let i=this.countFinalIndex(e,t);return dy(dA,this,t),this.moveRows(e,i)}isMovePossible(e,t){let i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+t>i,n=e.some(e=>e<0),o=e.some(e=>e>=i);return!r&&!(t<0)&&!n&&!o}isRowOrderChanged(e,t){return e.some((e,i)=>e-i!==t)}countFinalIndex(e,t){let i=(0,z.arrayReduce)(e,(e,i)=>(i<t&&(e+=1),e),0);return t-i}getRowsHeight(e,t){let i=this.hot.rowIndexMapper,r=0;for(let n=e;n<=t;n++){let e=i.getRenderableFromVisualIndex(n);null!==e&&(r+=this.hot.view._wt.wtTable.getRowHeight(e)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){let e=this.hot.getSettings()[dC];if(Array.isArray(e))this.moveRows(e,0);else if(void 0!==e){let e=this.persistentStateLoad();e.length&&this.moveRows(e,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){let e=this.hot.getSelectedRangeLast(),t=[];if(!e)return t;let{from:i,to:r}=e,n=Math.min(i.row,r.row),o=Math.max(i.row,r.row);return(0,b.rangeEach)(n,o,e=>{t.push(e)}),t}refreshPositions(){let e=dv(dI,this).coords,t=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&t>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(t-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);let n=this.hot.view._wt.wtTable,o=dv(dI,this).TD,s=this.hot.rootElement,l=(0,y.offset)(s),a=(0,y.getTrimmingContainer)(s),h=n.holder.scrollTop,u=this.hot.rootWindow!==a?a.scrollTop:0,c=l.top-u,d=dv(dI,this).eventPageY-c+h,g=n.hider.offsetHeight,f=n.TBODY.offsetTop,p=dv(dx,this).getOffset().top,m=dv(dx,this).getSize().height,w=o.offsetHeight/2,b=o.offsetHeight,C=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1),S=d>=C+w;this.isFixedRowTop(e.row)&&(C+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?dv(dI,this).row=t>0?t-1:t:S?(dv(dI,this).row=e.row+1,C+=0===e.row?b-1:b):dv(dI,this).row=e.row;let E=d,R=C;d+m+p>=g?E=g-m-p:d+p<f&&(E=f+Math.abs(p)),C>=g-1&&(R=g-1),dv(dx,this).setPosition(E),dv(dM,this).setPosition(R)}registerEvents(){let{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",e=>db(dN,this,d_).call(this,e)),this.eventManager.addEventListener(e,"mouseup",()=>db(dN,this,dD).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){dv(dx,this).build(),dv(dM,this).build()}destroy(){dv(dx,this).destroy(),dv(dM,this).destroy(),super.destroy()}}function dP(e,t,i,r){let{wtTable:n,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!s||dv(dk,this)||0!==e.button){dy(dk,this,!1),dv(dO,this).length=0,(0,y.removeClass)(this.hot.rootElement,[dR,dE]);return}let a=dv(dM,this).isBuilt()&&!dv(dM,this).isAppended(),h=dv(dx,this).isBuilt()&&!dv(dx,this).isAppended();a&&h&&(dv(dM,this).appendTo(n.hider),dv(dx,this).appendTo(n.hider));let{from:u,to:c}=l,d=Math.min(u.row,c.row),g=Math.max(u.row,c.row);if(t.col<0&&t.row>=d&&t.row<=g){r.row=!0,dy(dk,this,!0),dv(dI,this).eventPageY=e.pageY,dv(dI,this).coords=t,dv(dI,this).TD=i,dy(dO,this,this.prepareRowsToMoving());let s=n.holder.scrollLeft+o.getRowHeaderWidth(),l=this.getRowsHeight(d,t.row-1)+(e.clientY-i.getBoundingClientRect().top);dv(dx,this).setPosition(null,s),dv(dx,this).setSize(n.hider.offsetWidth-s,this.getRowsHeight(d,g)),dv(dx,this).setOffset(-l,null),(0,y.addClass)(this.hot.rootElement,dR),this.refreshPositions()}else(0,y.removeClass)(this.hot.rootElement,dT),dy(dk,this,!1),dv(dO,this).length=0}function d_(e){dv(dk,this)&&(dv(dI,this).eventPageY=e.pageY,this.refreshPositions())}function dL(e,t,i,r){this.hot.getSelectedRangeLast()&&dv(dk,this)&&(dv(dO,this).indexOf(t.row)>-1?(0,y.removeClass)(this.hot.rootElement,dE):(0,y.addClass)(this.hot.rootElement,dE),r.row=!0,r.column=!0,r.cell=!0,dv(dI,this).coords=t,dv(dI,this).TD=i)}function dD(){let e=dv(dI,this).row,t=dv(dO,this).length;if(dy(dk,this,!1),(0,y.removeClass)(this.hot.rootElement,[dR,dE,dT]),this.hot.selection.isSelectedByRowHeader()&&(0,y.addClass)(this.hot.rootElement,dT),t<1||void 0===e)return;let i=dv(dO,this)[0],r=this.hot.toPhysicalRow(i),n=this.dragRows(dv(dO,this),e);if(dv(dO,this).length=0,!0===n){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let e=this.hot.toVisualRow(r);this.hot.selectRows(e,e+t-1)}}function dF(){let e=this.hot.view._wt.wtTable,t=this.hot.view._wt.wtViewport.getRowHeaderWidth()+e.holder.scrollLeft;dv(dx,this).setPosition(null,t),dv(dx,this).setSize(e.hider.offsetWidth-t)}function dV(){this.moveBySettingsOrLoad()}function dW(e,t,i){dB(e,t),t.set(e,i)}function dB(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function dj(e,t,i){return e.set(dU(e,t),i),i}function dz(e,t){return e.get(dU(e,t))}function dU(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let d$="manualRowResize",dG="manualRowHeights";var dY=new WeakMap,dK=new WeakMap,dX=new WeakMap,dq=new WeakMap,dJ=new WeakMap,dZ=new WeakMap,dQ=new WeakMap,d0=new WeakMap,d1=new WeakMap,d2=new WeakMap,d3=new WeakMap,d5=new WeakMap,d9=new WeakMap,d8=new WeakMap,d4=new WeakMap,d7=new WeakMap,d6=new WeakSet;class ge extends tC{static get PLUGIN_KEY(){return d$}static get PLUGIN_PRIORITY(){return 30}constructor(e){super(e),function(e,t){dB(e,t),t.add(e)}(this,d6),dW(this,dY,null),dW(this,dK,null),dW(this,dX,[]),dW(this,dq,null),dW(this,dJ,null),dW(this,dZ,null),dW(this,dQ,null),dW(this,d0,null),dW(this,d1,this.hot.rootDocument.createElement("DIV")),dW(this,d2,this.hot.rootDocument.createElement("DIV")),dW(this,d3,!1),dW(this,d5,!1),dW(this,d9,0),dW(this,d8,null),dW(this,d4,void 0),dW(this,d7,void 0),(0,y.addClass)(dz(d1,this),"manualRowResizer"),(0,y.addClass)(dz(d2,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[d$]}enablePlugin(){this.enabled||(dj(d4,this,new tk._),dz(d4,this).addLocalHook("init",()=>dU(d6,this,gl).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,dz(d4,this)),this.addHook("modifyRowHeight",(e,t)=>dU(d6,this,gs).call(this,e,t)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){dj(d7,this,dz(d4,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",dG,dz(d4,this).getValues())}loadManualRowHeights(){let e={};return this.hot.runHooks("persistentStateLoad",dG,e),e.value}setManualSize(e,t){let i=this.hot.toPhysicalRow(e),r=Math.max(t,this.hot.view.getDefaultRowHeight());return dz(d4,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return dz(dq,this)}setupHandlePosition(e){let t;dj(dY,this,e);let{view:i}=this.hot,{_wt:r}=i,n=r.wtTable.getCoords(dz(dY,this)),o=n.row;if(o<0)return;let s=(0,y.outerWidth)(dz(dY,this)),l=dz(dY,this).getBoundingClientRect(),a=o<r.getSetting("fixedRowsTop"),h=o>=i.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");a?t=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(dz(dY,this),n.row,n.col):h&&(t=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(dz(dY,this),n.row,n.col)),t||(t=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(dz(dY,this),n.row,n.col)),dj(dK,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),dj(dX,this,[]);let u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){let e=this.hot.getSelectedRange();(0,z.arrayEach)(e,e=>{let t=e.getTopStartCorner().row,i=e.getBottomStartCorner().row;(0,b.rangeEach)(t,i,e=>{dz(dX,this).includes(e)||dz(dX,this).push(e)})})}dz(dX,this).includes(dz(dK,this))||dj(dX,this,[dz(dK,this)]),dj(d0,this,t.top-6),dj(dQ,this,parseInt(l.height,10)),dz(d1,this).style.top=`${dz(d0,this)+dz(dQ,this)}px`,dz(d1,this).style[this.inlineDir]=`${t.start}px`,dz(d1,this).style.width=`${s}px`,this.hot.rootElement.appendChild(dz(d1,this))}refreshHandlePosition(){dz(d1,this).style.top=`${dz(d0,this)+dz(dq,this)}px`}setupGuidePosition(){let e=parseInt((0,y.outerWidth)(dz(d1,this)),10),t=parseInt(dz(d1,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();(0,y.addClass)(dz(d1,this),"active"),(0,y.addClass)(dz(d2,this),"active"),dz(d2,this).style.top=dz(d1,this).style.top,dz(d2,this).style[this.inlineDir]=`${t}px`,dz(d2,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(dz(d2,this))}refreshGuidePosition(){dz(d2,this).style.top=dz(d1,this).style.top}hideHandleAndGuide(){(0,y.removeClass)(dz(d1,this),"active"),(0,y.removeClass)(dz(d2,this),"active")}checkIfRowHeader(e){let t=(0,y.closest)(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,n.clone.wtTable.TBODY].includes(t)}getClosestTHParent(e){return"TABLE"!==e.tagName?"TH"===e.tagName?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){let t=this.hot.view._wt.wtTable.getRowHeight(e);return void 0!==t&&dz(dJ,this)<t?t:dz(dJ,this)}afterMouseDownTimeout(){let e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,i)=>{let r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!0);void 0!==r&&dj(dJ,this,r),this.setManualSize(t,dz(dJ,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!0),i&&e()};dz(d9,this)>=2&&(dz(dX,this).length>1?((0,z.arrayEach)(dz(dX,this),e=>{t(e)}),e()):(0,z.arrayEach)(dz(dX,this),e=>{t(e,!0)})),dj(d9,this,0),dj(d8,this,null)}bindEvents(){let{rootElement:e,rootWindow:t}=this.hot;this.eventManager.addEventListener(e,"mouseover",e=>dU(d6,this,gt).call(this,e)),this.eventManager.addEventListener(e,"mousedown",e=>dU(d6,this,gi).call(this,e)),this.eventManager.addEventListener(t,"mousemove",e=>dU(d6,this,gr).call(this,e)),this.eventManager.addEventListener(t,"mouseup",()=>dU(d6,this,gn).call(this)),this.eventManager.addEventListener(dz(d1,this),"contextmenu",()=>dU(d6,this,go).call(this))}destroy(){super.destroy()}}function gt(e){if(!(0,y.isDetached)(e.target)&&!0!==dz(d5,this)&&this.checkIfRowHeader(e.target)){let t=this.getClosestTHParent(e.target);t&&!dz(d3,this)&&this.setupHandlePosition(t)}}function gi(e){(0,y.hasClass)(e.target,"manualRowResizer")&&(this.setupHandlePosition(dz(dY,this)),this.setupGuidePosition(),dj(d3,this,!0),null===dz(d8,this)&&(dj(d8,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(dz(d8,this))),dj(d9,this,dz(d9,this)+1),dj(dZ,this,e.pageY),dj(dJ,this,dz(dQ,this)))}function gr(e){dz(d3,this)&&(dj(dq,this,dz(dQ,this)+(e.pageY-dz(dZ,this))),(0,z.arrayEach)(dz(dX,this),e=>{dj(dJ,this,this.setManualSize(e,dz(dq,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function gn(){let e=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},t=(t,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(t),t,!1),i&&e(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(t),t,!1)};dz(d3,this)&&(this.hideHandleAndGuide(),dj(d3,this,!1),dz(dJ,this)!==dz(dQ,this)&&(dz(dX,this).length>1?((0,z.arrayEach)(dz(dX,this),e=>{t(e)}),e()):(0,z.arrayEach)(dz(dX,this),e=>{t(e,!0)})),this.setupHandlePosition(dz(dY,this)))}function go(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(dz(d1,this)),this.hot.rootElement.removeChild(dz(d2,this)),dj(d3,this,!1),dj(d5,this,!0),this.hot._registerImmediate(()=>{dj(d5,this,!1)})}function gs(e,t){let i=e;if(this.enabled){let e=this.hot.toPhysicalRow(t),r=dz(d4,this).getValueAtIndex(e);this.hot.getSettings()[d$]&&r&&(i=r)}return i}function gl(){let e=this.hot.getSettings()[d$],t=this.loadManualRowHeights();this.hot.batchExecution(()=>{void 0!==t?t.forEach((e,t)=>{dz(d4,this).setValueAtIndex(t,e)}):Array.isArray(e)?(e.forEach((e,t)=>{dz(d4,this).setValueAtIndex(t,e)}),dj(d7,this,e)):!0===e&&Array.isArray(dz(d7,this))&&dz(d7,this).forEach((e,t)=>{dz(d4,this).setValueAtIndex(t,e)})},!0)}function ga(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(55289),i(34760);function gh(e,t,i){return e.set(gu(e,t),i),i}function gu(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var gc=new WeakMap;class gd{constructor(e,t,i,r,n,o){ga(this,"row",void 0),ga(this,"col",void 0),ga(this,"rowspan",void 0),ga(this,"colspan",void 0),ga(this,"removed",!1),ga(this,"cellCoordsFactory",void 0),ga(this,"cellRangeFactory",void 0),function(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,null)}(this,gc,0),this.row=e,this.col=t,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=n,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(e){let{row:t,col:i,rowspan:r,colspan:n}=e;return(0,ro.O)`The merged cell declared with {row: ${t}, col: ${i},\x20
      rowspan: ${r}, colspan: ${n}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:t,col:i}=e;return(0,ro.O)`The merged cell declared at [${t}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:t,col:i}=e;return(0,ro.O)`The merged cell declared at [${t}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:t,col:i}=e;return(0,ro.O)`The merged cell declared at [${t}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:t,col:i,rowspan:r,colspan:n}=e;return t<0||i<0||r<0||n<0}static isSingleCell(e){let{rowspan:t,colspan:i}=e;return 1===i&&1===t}static containsZeroSpan(e){let{rowspan:t,colspan:i}=e;return 0===i||0===t}static isOutOfBounds(e,t,i){return e.row<0||e.col<0||e.row>=t||e.row+e.rowspan-1>=t||e.col>=i||e.col+e.colspan-1>=i}normalize(e){let t=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>t-1&&(this.row=t-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>t-1&&(this.rowspan=t-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),gh(gc,this,null)}includes(e,t){return this.row<=e&&this.col<=t&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=t}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,t){let i=e[0]||e[1],r=t+Math.abs(e[0]||e[1])-1,n=e[0]?"colspan":"rowspan",o=e[0]?"col":"row",s=Math.min(t,r),l=Math.max(t,r),a=this[o],h=this[o]+this[n]-1;if(a>=t&&(this[o]+=i),i>0)t<=h&&t>a&&(this[n]+=i);else if(i<0)if(s<=a&&l>=h)return this.removed=!0,gh(gc,this,null),!1;else if(a>=s&&a<=l){let e=l-a+1,t=Math.abs(i)-e;this[o]-=t+i,this[n]-=e}else a<=s&&h>=l?this[n]+=i:a<=s&&h>=s&&h<l&&(this[n]-=h-s+1);return gh(gc,this,null),!0}isFarther(e,t){return!e||("down"===t?e.row+e.rowspan-1<this.row+this.rowspan-1:"up"===t?e.row>this.row:"right"===t?e.col+e.colspan-1<this.col+this.colspan-1:"left"===t?e.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return!gc.get(gu(gc,this))&&gh(gc,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),gc.get(gu(gc,this))}}function gg(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function gf(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var gp=new WeakSet;class gm{constructor(e){!function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,gp),gg(this,"plugin",void 0),gg(this,"mergedCells",[]),gg(this,"mergedCellsMatrix",new Map),gg(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:t,col:i}=e;return(0,ro.O)`The merged cell declared at [${t}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,t){var i;return!!this.mergedCellsMatrix.has(e)&&null!==(i=this.mergedCellsMatrix.get(e).get(t))&&void 0!==i&&i}getByRange(e){let{row:t,col:i}=e.getTopStartCorner(),{row:r,col:n}=e.getBottomEndCorner(),o=this.mergedCells.length,s=!1;for(let e=0;e<o;e++){let o=this.mergedCells[e],{row:l,col:a,rowspan:h,colspan:u}=o;if(l>=t&&l+h-1<=r&&a>=i&&a+u-1<=n){s=o;break}}return s}filterOverlappingMergeCells(e){let t=new Set;return this.mergedCells.forEach(e=>{let{row:i,col:r,colspan:n,rowspan:o}=e;for(let e=i;e<i+o;e++)for(let i=r;i<r+n;i++)t.add(`r${e},c${i}`)}),e.filter(e=>{let{row:i,col:r,colspan:n,rowspan:o}=e,s=new Set,l=!1;for(let a=i;a<i+o;a++){for(let i=r;i<r+n;i++){let r=`r${a},c${i}`;if(t.has(r)){(0,iL.R8)(gm.IS_OVERLAPPING_WARNING(e)),l=!0;break}s.add(r)}if(l)break}return l||t.add(...s),!l})}getWithinRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{row:i,col:r}=e.getTopStartCorner(),{row:n,col:o}=e.getBottomEndCorner(),s=[];for(let e=i;e<=n;e++)for(let i=r;i<=o;i++){let r=this.get(e,i);r&&(t||!t&&r.row===e&&r.col===i)&&s.push(r)}return s}add(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=e.row,r=e.col,n=new gd(i,r,e.rowspan,e.colspan,this.hot._createCellCoords,this.hot._createCellRange),o=this.get(i,r),s=!t&&this.isOverlapping(n);return o||s?(s&&(0,iL.R8)(gm.IS_OVERLAPPING_WARNING(n)),!1):(this.hot&&n.normalize(this.hot),this.mergedCells.push(n),gf(gp,this,gy).call(this,n),n)}remove(e,t){let i=this.get(e,t),r=i?this.mergedCells.indexOf(i):-1;return!!i&&-1!==r&&(this.mergedCells.splice(r,1),gf(gp,this,gv).call(this,i),i)}clear(){(0,z.arrayEach)(this.mergedCells,e=>{let{row:t,col:i,rowspan:r,colspan:n}=e;(0,b.rangeEach)(t,t+r,e=>{(0,b.rangeEach)(i,i+n,t=>{let i=this.hot.getCell(e,t);i&&(i.removeAttribute("rowspan"),i.removeAttribute("colspan"),i.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){let t=e.getRange();for(let e=0;e<this.mergedCells.length;e++)if(this.mergedCells[e].getRange().overlaps(t))return!0;return!1}isFirstRenderableMergedCell(e,t){let i=this.get(e,t);if(!i)return!1;let{row:r,col:n,rowspan:o,colspan:s}=i,l=this.hot.view.getActiveOverlayName(),a=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),h=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),u=(0,b.clamp)(a,r,r+o-1),c=(0,b.clamp)(h,n,n+s-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(u,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,1)===t}getFirstRenderableCoords(e,t){let i=this.get(e,t);if(!i||this.isFirstRenderableMergedCell(e,t))return this.hot._createCellCoords(e,t);let r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,n)}getStartMostColumnIndex(e,t){let i=gf(gp,this,gw).call(this,e,"col",-1),r=t;for(let e=0;e<i.length;e++)if(i[e]<=t){r=i[e];break}return r}getEndMostColumnIndex(e,t){let i=gf(gp,this,gw).call(this,e,"col",1),r=t;for(let e=0;e<i.length;e++)if(i[e]>=t){r=i[e];break}return r}getTopMostRowIndex(e,t){let i=gf(gp,this,gw).call(this,e,"row",-1),r=t;for(let e=0;e<i.length;e++)if(i[e]<=t){r=i[e];break}return r}getBottomMostRowIndex(e,t){let i=gf(gp,this,gw).call(this,e,"row",1),r=t;for(let e=0;e<i.length;e++)if(i[e]>=t){r=i[e];break}return r}shiftCollections(e,t,i){let r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i}let n=[];this.mergedCells.forEach(e=>{e.shift(r,t),e.removed&&n.push(e)}),n.forEach(e=>{this.mergedCells.splice(this.mergedCells.indexOf(e),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(e=>{gf(gp,this,gy).call(this,e)})}}function gw(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new Map,n=1===i?e.getTopStartCorner():e.getBottomEndCorner(),o=1===i?e.getBottomEndCorner():e.getTopStartCorner();for(let e=n.row;1===i?e<=o.row:e>=o.row;e+=i)for(let s=n.col;1===i?s<=o.col:s>=o.col;s+=i){let n="row"===t?e:s,o=this.get(e,s),l=n;o&&(l=1===i?o[t]+o[`${t}span`]-1:o[t]),r.has(n)||r.set(n,new Set),r.get(n).add(l)}return Array.from(new Set(Array.from(r.entries()).filter(e=>{let[,t]=e;return 1===t.size}).flatMap(e=>{let[,t]=e;return Array.from(t)})))}function gy(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let i=e.col;i<e.col+e.colspan;i++)this.mergedCellsMatrix.has(t)||this.mergedCellsMatrix.set(t,new Map),this.mergedCellsMatrix.get(t).set(i,e)}function gv(e){for(let t=e.row;t<e.row+e.rowspan;t++)for(let i=e.col;i<e.col+e.colspan;i++)this.mergedCellsMatrix.get(t).delete(i)}function gb(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class gC{constructor(e){gb(this,"plugin",void 0),gb(this,"mergedCellsCollection",void 0),gb(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,t){let i=null;return t[0]===e[0]&&t[1]===e[1]&&t[3]===e[3]?"down":t[2]===e[2]&&t[1]===e[1]&&t[3]===e[3]?"up":t[1]===e[1]&&t[2]===e[2]?"right":"left"}snapDragArea(e,t,i,r){let n=t.slice(0),o=this.getAutofillSize(e,t,i),[s,l,a,h]=e,u=["up","down"].indexOf(i)>-1?a-s+1:h-l+1,c=Math.floor(o/u)*u,d=o-c,g=this.getFarthestCollection(e,t,i,r);if(g){if("down"===i){let e=g.row+g.rowspan-s-d;n[2]+e>=this.plugin.hot.countRows()?n[2]-=d:n[2]+=d?e:0}else if("right"===i){let e=g.col+g.colspan-l-d;n[3]+e>=this.plugin.hot.countCols()?n[3]-=d:n[3]+=d?e:0}else if("up"===i){let e=a-d-g.row+1;n[0]+e<0?n[0]+=d:n[0]-=d?e:0}else if("left"===i){let e=h-d-g.col+1;n[1]+e<0?n[1]+=d:n[1]-=d?e:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:o,dragArea:n,cycleLength:u}),n}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),(0,V.extend)(this.currentFillData,e)}getAutofillSize(e,t,i){let[r,n,o,s]=e,[l,a,h,u]=t;switch(i){case"up":return r-l;case"down":return h-o;case"left":return n-a;case"right":return u-s;default:return null}}getDragArea(e,t,i){let[r,n,o,s]=e,[l,a,h,u]=t;switch(i){case"up":return[l,a,r-1,s];case"down":{let e=this.mergedCellsCollection.get(h,s);return[o+1,n,h+(e?e.rowspan-1:0),s]}case"left":return[l,a,o,n-1];case"right":{let e=this.mergedCellsCollection.get(h,s);return[r,s+(e?e.colspan-1:0),h,u]}default:return null}}getFarthestCollection(e,t,i,r){let[n,o,s,l]=e,a=["up","down"].indexOf(i)>-1,h=a?s:l,u=a?n:o,c=this.getAutofillSize(e,t,i),d=a?s-n+1:l-o+1,g=Math.floor(c/d)*d,f=c-g,p=null,m=null,w=null;switch(i){case"up":p="includesVertically",w=h-f+1;break;case"left":p="includesHorizontally",w=h-f+1;break;case"down":p="includesVertically",w=u+f-1;break;case"right":p="includesHorizontally",w=u+f-1}return(0,z.arrayEach)(r,e=>{e[p](w)&&e.isFarther(m,i)&&(m=e)}),m}recreateAfterDataPopulation(e){if(!this.currentFillData)return;let t=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,n=(e,i)=>{switch(r){case"up":return e.row-i>=t.from.row;case"down":return e.row+e.rowspan-1+i<=t.to.row;case"left":return e.col-i>=t.from.column;case"right":return e.col+e.colspan-1+i<=t.to.column;default:return null}},o=0,s=null,l=1;do for(let e=0;e<i.length;e+=1){if(n(s=i[e],o=l*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:s.row-o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-o,colspan:s.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+o,colspan:s.colspan},!0)}e===i.length-1&&(l+=1)}while(n(s,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){let t={min:null,max:null},i={min:null,max:null};return(0,z.arrayEach)(e,e=>{let r=e[0],n=this.plugin.hot.propToCol(e[1]);(null===t.min||r<t.min)&&(t.min=r),(null===t.max||r>t.max)&&(t.max=r),(null===i.min||n<i.min)&&(i.min=n),(null===i.max||n>i.max)&&(i.max=n)}),{from:{row:t.min,column:i.min},to:{row:t.max,column:i.max}}}dragAreaOverlapsCollections(e,t,i){let[r,n,o,s]=this.getDragArea(e,t,i),l=this.plugin.hot._createCellCoords(r,n),a=this.plugin.hot._createCellCoords(o,s),h=this.plugin.hot._createCellRange(l,l,a);if(0===this.mergedCellsCollection.getWithinRange(h,!0).length)return!1;let u=this.mergedCellsCollection.getWithinRange(h,!1);return 0===u.length||("up"===i||"down"===i?!u.every(e=>{let{colspan:t}=e;return t===h.getWidth()}):!u.every(e=>{let{rowspan:t}=e;return t===h.getHeight()}))}}function gS(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class gE{constructor(e){gS(this,"plugin",void 0),gS(this,"hot",void 0),gS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,t,i,r){let n=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),s=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(void 0===r||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,t))return;let a=this.plugin.mergedCellsCollection.get(e,t);if(!a)return;let h=a.getLastRow(),u=a.getLastColumn();return n<=a.row&&o<=a.col&&s>=h&&l>=u?`${this.fullySelectedMergedCellClassName}-${r}`:this.isMergeCellFullySelected(a,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(e,t){let i=[];if(!t||!e)return!1;for(let t=0;t<e.rowspan;t+=1)for(let r=0;r<e.colspan;r+=1)i.push(this.hot._createCellCoords(e.row+t,e.col+r));for(let e=0;e<i.length;e+=1){let r=[];for(let n=0;n<t.length;n+=1)r[n]=t[n].includes(i[e]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let e=[];for(let t=0;t<=7;t+=1)e.push(`${this.fullySelectedMergedCellClassName}-${t}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function gR(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class gT{constructor(e){gR(this,"data",void 0),gR(this,"next",null),gR(this,"prev",null),this.data=e}}class gx{constructor(){gR(this,"first",null),gR(this,"last",null)}push(e){let t=new gT(e);if(null===this.first)this.first=t,this.last=t;else{let e=this.last;this.last=t,t.prev=e,e.next=t}return t}unshift(e){let t=new gT(e);if(null===this.first)this.first=t,this.last=t;else{let e=this.first;this.first=t,t.next=e,e.prev=t}}inorder(e){let t=this.first;for(;t;){let i=e(t);if(t===this.last||!0===i)break;t=t.next}}remove(e){let t,i;if(null===this.first)return!1;let r=this.first;for(;r;){if(r.data===e)return t=r.next,i=r.prev,t&&(t.prev=i),i&&(i.next=t),r===this.first&&(this.first=t),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let e=this.first,t=this.first;for(;;){if(null===e||null===(e=e.next))return!1;if((e=e.next)===(t=t.next))return!0}}pop(){if(null===this.last)return null;let e=this.last;return this.last=this.last.prev,e}shift(){if(null===this.first)return null;let e=this.first;return this.first=this.first.next,e}recursiveReverse(){if(!this.first)return;!function e(t,i){i&&(e(i,i.next),i.next=t)}(this.first,this.first.next),this.first.next=null;let e=this.first;this.first=this.last,this.last=e}reverse(){let e;if(!this.first||!this.first.next)return;let t=this.first.next,i=this.first;for(;t;)e=t.next,t.next=i,i.prev=t,i=t,t=e;this.first.next=null,this.last.prev=null,e=this.first,this.first=i,this.last=e}}function gM(e,t,i){gO(e,t),t.set(e,i)}function gO(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function gk(e,t){return e.get(gA(e,t))}function gI(e,t,i){return e.set(gA(e,t),i),i}function gA(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var gN=new WeakMap,gH=new WeakMap,gP=new WeakMap,g_=new WeakMap,gL=new WeakMap,gD=new WeakMap,gF=new WeakMap,gV=new WeakSet;class gW{constructor(e){let{mergedCellsGetter:t,rowIndexMapper:i,columnIndexMapper:r}=e;!function(e,t){gO(e,t),t.add(e)}(this,gV),gM(this,gN,new gx),gM(this,gH,new gx),gM(this,gP,null),gM(this,g_,null),gM(this,gL,null),gM(this,gD,null),gM(this,gF,null),gI(gL,this,t),gI(gD,this,i),gI(gF,this,r)}getCurrentVerticalNode(){return gk(g_,this).data}getFirstVerticalNode(){return gk(gH,this).first.data}getNextVerticalNode(){return gk(g_,this).next.data}getPrevVerticalNode(){return gk(g_,this).prev.data}getCurrentHorizontalNode(){return gk(gP,this).data}getFirstHorizontalNode(){return gk(gN,this).first.data}getNextHorizontalNode(){return gk(gP,this).next.data}getPrevHorizontalNode(){return gk(gP,this).prev.data}setPrevNodeAsActive(){gI(g_,this,gk(g_,this).prev),gI(gP,this,gk(gP,this).prev)}setNextNodeAsActive(){gI(g_,this,gk(g_,this).next),gI(gP,this,gk(gP,this).next)}buildFocusOrder(e){let t=e.getTopStartCorner(),i=e.getBottomEndCorner(),r=new WeakSet;gI(gN,this,new gx);for(let n=t.row;n<=i.row;n++)if(!gk(gD,this).isHidden(n))for(let o=t.col;o<=i.col;o++){if(gk(gF,this).isHidden(o))continue;let t=gA(gV,this,gB).call(this,e,gk(gN,this),r,n,o);t&&gI(gP,this,t)}gk(gN,this).first&&(gk(gN,this).first.prev=gk(gN,this).last,gk(gN,this).last.next=gk(gN,this).first);let n=new WeakSet;gI(gH,this,new gx);for(let r=t.col;r<=i.col;r++)if(!gk(gF,this).isHidden(r))for(let o=t.row;o<=i.row;o++){if(gk(gD,this).isHidden(o))continue;let t=gA(gV,this,gB).call(this,e,gk(gH,this),n,o,r);t&&gI(g_,this,t)}gk(gH,this).first&&(gk(gH,this).first.prev=gk(gH,this).last,gk(gH,this).last.next=gk(gH,this).first)}setActiveNode(e,t){return gk(gN,this).inorder(i=>{let{rowStart:r,rowEnd:n,colStart:o,colEnd:s}=i.data;if(e>=r&&e<=n&&t>=o&&t<=s)return gI(gP,this,i),!1}),gk(gH,this).inorder(i=>{let{rowStart:r,rowEnd:n,colStart:o,colEnd:s}=i.data;if(e>=r&&e<=n&&t>=o&&t<=s)return gI(g_,this,i),!1}),this}}function gB(e,t,i,r,n){let o=e.getTopStartCorner(),s=e.getBottomEndCorner(),l=e.highlight.clone().normalize(),a=gk(gL,this).call(this,r,n);if(a&&i.has(a))return null;let h={colStart:n,colEnd:n,rowStart:r,rowEnd:r};if(a){if(i.add(a),a.row<o.row||a.row+a.rowspan-1>s.row||a.col<o.col||a.col+a.colspan-1>s.col)return null;h.colStart=a.col,h.colEnd=a.col+a.colspan-1,h.rowStart=a.row,h.rowEnd=a.row+a.rowspan-1}let u=t.push(h);return r===l.row&&n===l.col||a&&l.row>=a.row&&l.row<=a.row+a.rowspan-1&&l.col>=a.col&&l.col<=a.col+a.colspan-1?u:null}function gj(e,t,i){let{view:r,rowIndexMapper:n}=e,o=r.getStylesHandler(),s=r.getDefaultRowHeight(),l=0;for(let r=t;r<t+i;r++)if(!n.isHidden(r)){var a;l+=null!==(a=e.getRowHeight(r))&&void 0!==a?a:s,0!==r||o.isClassicTheme()||(l+=1)}return l}function gz(e,t,i){gU(e,t),t.set(e,i)}function gU(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function g$(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function gG(e,t,i){return e.set(gK(e,t),i),i}function gY(e,t){return e.get(gK(e,t))}function gK(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeMergeCells"),d.R.getSingleton().register("afterMergeCells"),d.R.getSingleton().register("beforeUnmergeCells"),d.R.getSingleton().register("afterUnmergeCells");let gX="mergeCells";var gq=new WeakMap,gJ=new WeakMap,gZ=new WeakMap,gQ=new WeakMap,g0=new WeakSet;class g1 extends tC{constructor(){super(...arguments),function(e,t){gU(e,t),t.add(e)}(this,g0),g$(this,"mergedCellsCollection",null),g$(this,"autofillCalculations",null),g$(this,"selectionCalculations",null),gz(this,gq,null),gz(this,gJ,{row:0,col:0}),gz(this,gZ,new gW({mergedCellsGetter:(e,t)=>this.mergedCellsCollection.get(e,t),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),gz(this,gQ,function(e){let{hot:t}=e,{rowIndexMapper:i,columnIndexMapper:r}=t,n=new Map;return{before:function(){},after:function(o,s,l){let a=e.mergedCellsCollection.get(s,l);if(!(0,V.isObject)(a)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),(0,w.isSafari)()&&n.has(s)&&!t.getSettings().rowHeaders&&(o.style.height=`${n.get(s)}px`,n.delete(s)),o.style.display="";return}let{row:h,col:u,colspan:c,rowspan:d}=a,[g,f]=e.translateMergedCellToRenderable(h,d,u,c),p=e.getSetting("virtualized");if((0,w.isSafari)()&&0===u&&!t.getSettings().rowHeaders){let e=gj(t,h,d);n.set(s,e/d)}let m=i.getRenderableFromVisualIndex(s),y=r.getRenderableFromVisualIndex(l),b=i.getNearestNotHiddenIndex(h,1),C=r.getNearestNotHiddenIndex(u,1);if(p){let e=t.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(e)||(b=Math.max(b,t.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)||(C=Math.max(C,t.getFirstRenderedVisibleColumn()))}let S=Math.min(d,g-m+1),E=Math.min(c,f-y+1);b===s&&C===l?(o.setAttribute("rowspan",S),o.setAttribute("colspan",E)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}}}(this))}static get PLUGIN_KEY(){return gX}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[tm]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[gX]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new gm(this),this.autofillCalculations=new gC(this),this.selectionCalculations=new gE(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g2).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g5).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g9).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g8).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g4).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fe).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fe).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,ft).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fi).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fr).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g7).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g7).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g3).call(e,...i)}),this.addHook("afterRenderer",function(){return gY(gQ,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,g6).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fn).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fo).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fs).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fl).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fa).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fh).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fu).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fc).call(e,...i)}),this.addHook("afterChange",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fd).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fg).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,ff).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fp).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fm).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return gK(g0,e,fw).call(e,...i)}),this.addHook("beforeUndoStackChange",(e,t)=>{if("MergeCells"===t)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!(0,w.isChrome)())return;let e=[],t=[];this.mergedCellsCollection.mergedCells.forEach(e=>{let{row:i,rowspan:r}=e;for(let e=i+1;e<i+r;e++)t.push(e)}),(t=[...new Set(t)]).forEach(t=>{let i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(t);this.hot.view._wt.wtOverlays.getOverlays(!0).map(e=>(null==e?void 0:e.name)==="master"?e:e.clone.wtTable).forEach(t=>{let r=t.getRow(i);r&&(r.style.background=(0,y.getStyle)(r,"backgroundColor").replace(")",", 0.99)"),e.push(r))})}),this.hot._registerTimeout(()=>{e.forEach(e=>{var t;e.style.background=null===(t=(0,y.getStyle)(e,"backgroundColor"))||void 0===t?void 0:t.replace(", 0.99)",")")})},1)}validateSetting(e){return!!e&&(gd.containsNegativeValues(e)?((0,iL.R8)(gd.NEGATIVE_VALUES_WARNING(e)),!1):gd.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?((0,iL.R8)(gd.IS_OUT_OF_BOUNDS_WARNING(e)),!1):gd.isSingleCell(e)?((0,iL.R8)(gd.IS_SINGLE_CELL(e)),!1):!gd.containsZeroSpan(e)||((0,iL.R8)(gd.ZERO_SPAN_WARNING(e)),!1))}generateFromSettings(){let e=this.getSetting("cells").filter(e=>this.validateSetting(e)),t=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];t.forEach(e=>{let{row:t,col:r,rowspan:n,colspan:o}=e,s=this.hot._createCellCoords(t,r),l=this.hot._createCellCoords(t+n-1,r+o-1),a=this.hot._createCellRange(s,s,l);this.mergeRange(a,!0,!0);for(let e=t;e<t+n;e++)for(let n=r;n<r+o;n++)(e!==t||n!==r)&&i.push([e,n,null])}),0!==i.length&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!t||this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:t,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!e)return;let{from:t,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(t.row,t.col,i.row,i.col,!1)}mergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.getTopStartCorner(),n=e.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:n.row-r.row+1,colspan:n.col-r.col+1},s=[],l=null;return!!this.canMergeRange(o,t)&&(this.hot.runHooks("beforeMergeCells",e,t),(0,b.rangeEach)(0,o.rowspan-1,e=>{(0,b.rangeEach)(0,o.colspan-1,t=>{let i=null;s[e]||(s[e]=[]),0===e&&0===t?i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+e,o.col+t,"hidden",!0),s[e][t]=i})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),!this.mergedCellsCollection.add(o,t)||(i?l=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),t||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,o,t),l))}unmergeRange(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mergedCellsCollection.getWithinRange(e);0!==i.length&&(this.hot.runHooks("beforeUnmergeCells",e,t),(0,z.arrayEach)(i,e=>{this.mergedCellsCollection.remove(e.row,e.col),(0,b.rangeEach)(0,e.rowspan-1,t=>{(0,b.rangeEach)(0,e.colspan-1,i=>{this.hot.removeCellMeta(e.row+t,e.col+i,"hidden"),this.hot.removeCellMeta(e.row+t,e.col+i,"copyable")})}),this.hot.removeCellMeta(e.row,e.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,t),this.hot.render())}toggleMerge(e){let{from:t,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(t.row,t.col);r.row===t.row&&r.col===t.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,t,i,r){let n=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(n,n,o))}unmerge(e,t,i,r){let n=this.hot._createCellCoords(e,t),o=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(n,n,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{let e=this.hot.getSelectedRangeLast();e&&!e.isSingleHeader()&&(this.toggleMerge(e),this.hot.render())},runOnlyIf:e=>!e.altKey,group:gX})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gX)}modifyViewportRowStart(e,t){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let n=0;n<t;n+=1){let o=this.mergedCellsCollection.get(r,n);if((0,V.isObject)(o)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(r<e.startRow){e.startRow=r,this.modifyViewportRowStart(e,t);return}}}}modifyViewportRowEnd(e,t){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let n=0;n<t;n+=1){let o=this.mergedCellsCollection.get(r,n);if((0,V.isObject)(o)){let r=o.row+o.rowspan-1,n=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(n>e.endRow){e.endRow=n,this.modifyViewportRowEnd(e,t);return}}}}modifyViewportColumnStart(e,t){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let n=0;n<t;n+=1){let o=this.mergedCellsCollection.get(n,r);if((0,V.isObject)(o)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(r<e.startColumn){e.startColumn=r,this.modifyViewportColumnStart(e,t);return}}}}modifyViewportColumnEnd(e,t){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let n=0;n<t;n+=1){let o=this.mergedCellsCollection.get(n,r);if((0,V.isObject)(o)){let r=o.col+o.colspan-1,n=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(n>e.endColumn){e.endColumn=n,this.modifyViewportColumnEnd(e,t);return}}}}translateMergedCellToRenderable(e,t,i,r){let n,o,{rowIndexMapper:s,columnIndexMapper:l}=this.hot;return n=0===t?s.getNearestNotHiddenIndex(e,1):s.getNearestNotHiddenIndex(e+t-1,-1),o=0===r?l.getNearestNotHiddenIndex(i,1):l.getNearestNotHiddenIndex(i+r-1,-1),[e>=0?s.getRenderableFromVisualIndex(n):e,i>=0?l.getRenderableFromVisualIndex(o):i]}}function g2(){this.generateFromSettings(),this.hot.render()}function g3(e){if(e){let e=this.mergedCellsCollection.mergedCells,t=this.hot.getSelectedRangeLast(),i=t.getTopStartCorner(),r=t.getBottomEndCorner();for(let t=0;t<e.length;t+=1)if(i.row===e[t].row&&i.col===e[t].col&&r.row===e[t].row+e[t].rowspan-1&&r.col===e[t].col+e[t].colspan-1)return!1}return e}function g5(e){gY(gJ,this).row=e.row,gY(gJ,this).col=e.col}function g9(e){let{highlight:t}=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;gY(gq,this)&&(null!==r.getRenderableFromVisualIndex(gY(gq,this).row)&&(t.row=gY(gq,this).row),null!==i.getRenderableFromVisualIndex(gY(gq,this).col)&&(t.col=gY(gq,this).col),gG(gq,this,null));let n=this.mergedCellsCollection.get(t.row,t.col);if(!n)return;let o=n.col,s=n.col+n.colspan-1;if(e.col<0){let r=t.col>=o&&t.col<=s?o-1:s,n=i.getNearestNotHiddenIndex(r,-1);null===n?e.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(n,t.col)-1,1)}else if(e.col>0){let r=t.col>=o&&t.col<=s?s+1:o,n=i.getNearestNotHiddenIndex(r,1);null===n?e.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,n)-1,1)}let l=n.row,a=n.row+n.rowspan-1;if(e.row<0){let i=t.row>=l&&t.row<=a?l-1:a,n=r.getNearestNotHiddenIndex(i,-1);null===n?e.row=-this.hot.view.countRenderableRowsInRange(0,t.row):e.row=-Math.max(this.hot.view.countRenderableRowsInRange(n,t.row)-1,1)}else if(e.row>0){let i=t.row>=l&&t.row<=a?a+1:l,n=r.getNearestNotHiddenIndex(i,1);null===n?e.row=this.hot.view.countRenderableRowsInRange(t.row,this.hot.countRows()):e.row=Math.max(this.hot.view.countRenderableRowsInRange(t.row,n)-1,1)}}function g8(e){let t=this.hot.getSelectedRangeLast(),i=t.clone(),{to:r}=t,{columnIndexMapper:n,rowIndexMapper:o}=this.hot,s=(e,t)=>{i.expand(this.hot._createCellCoords(e,t));for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)i.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange())};if(e.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(t,r.col)+e.col;s(r.row,o),"E-W"===t.getHorizontalDirection()&&"E-W"===i.getHorizontalDirection()&&(o=i.getTopStartCorner().col);let l=n.getNearestNotHiddenIndex(o,1);null!==l&&(e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(e.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(t,r.col)+e.col;s(r.row,o),"W-E"===t.getHorizontalDirection()&&"W-E"===i.getHorizontalDirection()&&(o=i.getBottomEndCorner().col);let l=n.getNearestNotHiddenIndex(o,-1);null!==l&&(e.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(e.row<0){let n=this.mergedCellsCollection.getTopMostRowIndex(t,r.row)+e.row;s(n,r.col),"S-N"===t.getVerticalDirection()&&"S-N"===i.getVerticalDirection()&&(n=i.getTopStartCorner().row);let l=o.getNearestNotHiddenIndex(n,1);null!==l&&(e.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(e.row>0){let n=this.mergedCellsCollection.getBottomMostRowIndex(t,r.row)+e.row;s(n,r.col),"N-S"===t.getVerticalDirection()&&"N-S"===i.getVerticalDirection()&&(n=i.getBottomStartCorner().row);let l=o.getNearestNotHiddenIndex(n,-1);null!==l&&(e.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function g4(){let e=this.hot.getSelectedRangeLast(),{highlight:t}=e;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){gG(gq,this,t.clone());return}for(let t=0;t<this.mergedCellsCollection.mergedCells.length;t+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[t].getRange(),!1);for(let t=0;t<this.mergedCellsCollection.mergedCells.length;t+=1)e.expandByRange(this.mergedCellsCollection.mergedCells[t].getRange(),!1);let i=this.mergedCellsCollection.get(t.row,t.col);gG(gq,this,t.clone()),i&&t.assign(i)}function g7(e,t,i,r){if(e<0||t<0)return;let n=this.mergedCellsCollection.get(e,t);if(!n)return;let{row:o,col:s,colspan:l,rowspan:a}=n,h=o+a-1,u=s+l-1;if("render"===r&&this.getSetting("virtualized")){let e=this.hot.view.getActiveOverlayName(),t=["top","top_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleRow(),i=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(e)?0:this.hot.getFirstRenderedVisibleColumn();return[(0,b.clamp)(t,o,h),(0,b.clamp)(i,s,u),(0,b.clamp)(this.hot.getLastRenderedVisibleRow(),o,h),(0,b.clamp)(this.hot.getLastRenderedVisibleColumn(),s,u)]}return[o,s,h,u]}function g6(e){var t;e.items.push({name:"---------"},(t=this,{key:"mergeCells",name(){let e=this.getSelectedLast();if(e){let i=t.mergedCellsCollection.get(e[0],e[1]);if(i.row===e[0]&&i.col===e[1]&&i.row+i.rowspan-1===e[2]&&i.col+i.colspan-1===e[3])return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){let e=this.getSelectedRangeLast();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");let{from:i,to:r}=e;t.toggleMerge(e),this.selectCell(i.row,i.col,r.row,r.col,!1)},disabled(){let e=this.getSelectedLast();return!e||gd.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function fe(){gG(gq,this,null)}function ft(){if(gY(gq,this).isCell())return;let e=this.hot.getSelectedRangeLast(),t=e.getVerticalDirection(),i=e.getHorizontalDirection(),r=gY(gq,this).clone().normalize();gY(gZ,this).setActiveNode(r.row,r.col),gY(gJ,this).row>0||gY(gJ,this).col>0?gY(gZ,this).setPrevNodeAsActive():("E-W"===i&&gY(gJ,this).col<0||"S-N"===t&&gY(gJ,this).row<0)&&gY(gZ,this).setNextNodeAsActive()}function fi(e,t){let i=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:n}=this.hot,o=null,s=null;if(gY(gJ,this).col<0){let{rowEnd:e,colEnd:t}=gY(gZ,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(t,-1),o=n.getNearestNotHiddenIndex(e,-1)}else if(gY(gJ,this).col>0){let{rowStart:e,colStart:t}=gY(gZ,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(t,1),o=n.getNearestNotHiddenIndex(e,1)}else if(gY(gJ,this).row<0){let{rowEnd:e,colEnd:t}=gY(gZ,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(t,-1),o=n.getNearestNotHiddenIndex(e,-1)}else if(gY(gJ,this).row>0){let{rowStart:e,colStart:t}=gY(gZ,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(t,1),o=n.getNearestNotHiddenIndex(e,1)}if(null!==o||null!==s){let r=this.hot._createCellCoords(o,s),n=this.mergedCellsCollection.get(r.row,r.col),l=this.hot.selection.highlight.getFocus();e=r.row,t=r.col,n?i.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)}):i.highlight.assign(r),l.clear(),l.add(r).commit()}gY(gZ,this).setActiveNode(e,t),gG(gJ,this,{row:0,col:0})}function fr(){this.hot.getSelectedRangeLast().isHeader()||gY(gZ,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function fn(e,t,i){let r=this.mergedCellsCollection.get(e,t);r&&(r.row!==e||r.col!==t?i.copyable=!1:(i.rowspan=r.rowspan,i.colspan=r.colspan))}function fo(e){if(this.getSetting("virtualized"))return;let t=this.hot.countCols();this.modifyViewportRowStart(e,t),this.modifyViewportRowEnd(e,t)}function fs(e){if(this.getSetting("virtualized"))return;let t=this.hot.countRows();this.modifyViewportColumnStart(e,t),this.modifyViewportColumnEnd(e,t)}function fl(e,t){let i=this.autofillCalculations.getDirection(t,e);if(this.autofillCalculations.dragAreaOverlapsCollections(t,e,i))return t;let r=this.hot._createCellCoords(t[0],t[1]),n=this.hot._createCellCoords(t[2],t[3]),o=this.hot._createCellRange(r,r,n),s=this.mergedCellsCollection.getWithinRange(o);return 0===s.length?e:this.autofillCalculations.snapDragArea(t,e,i,s)}function fa(e,t){this.mergedCellsCollection.shiftCollections("right",e,t)}function fh(e,t){this.mergedCellsCollection.shiftCollections("left",e,t)}function fu(e,t,i){"auto"!==i&&this.mergedCellsCollection.shiftCollections("down",e,t)}function fc(e,t){this.mergedCellsCollection.shiftCollections("up",e,t)}function fd(e,t){"Autofill.fill"===t&&this.autofillCalculations.recreateAfterDataPopulation(e)}function fg(e,t){if(t&&"area"===t){let t=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(t);(0,z.arrayEach)(i,i=>{t.getBottomEndCorner().row===i.getLastRow()&&t.getBottomEndCorner().col===i.getLastColumn()&&(e[2]=i.row,e[3]=i.col)})}}function ff(e,t,i,r){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(e,t,i,r)}function fp(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function fm(e,t,i,r){if(!(r instanceof MouseEvent))return;let n=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(n);if(!o)return;let s=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return 0===this.hot.selection.getLayerLevel()&&n.isEqual(this.hot._createCellRange(s,s,l))}function fw(e,t,i){let r,n;if(this.hot.getSettings().rowHeaders||"bottom"===i||"bottom_inline_start_corner"===i)return e;if("master"===i)r=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.getLastRenderedVisibleColumn();else{let e=this.hot.view.getOverlayByName(i);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getFirstRenderedColumn()),n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(t,r))return e;let o=this.hot._createCellCoords(t,r),s=this.hot._createCellCoords(t,n),l=this.hot._createCellRange(o,o,s),a=this.mergedCellsCollection.getWithinRange(l,!0),h=a.reduce((e,t)=>{let{rowspan:i}=t;return Math.max(e,i)},1),u=0;return a.length>1&&a[0].rowspan<h&&(u=h-a[0].rowspan),a.forEach(r=>{let{rowspan:n}=r,o=0;o="top"===i||"top_inline_start_corner"===i?Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-t):n-u,e=Math.max(null!=e?e:0,gj(this.hot,t,o))}),e}let fy="sort",fv="multiColumnSorting";i6(fv,function(e,t){return function(i,r){let[,...n]=i,[,...o]=r;return function i(r){let s=e[r],l=t[r],a=n[r],h=o[r],u=l.multiColumnSorting,c=(u.compareFunctionFactory?u.compareFunctionFactory:rt(l.type))(s,l,u)(a,h);if(c===ri){let e=r+1;if(void 0!==t[e])return i(e)}return c}(0)}});class fb extends rE{constructor(){super(...arguments),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"pluginKey",fv)}static get PLUGIN_KEY(){return fv}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast();return -1===e.row&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,rb)),!1},runOnlyIf:()=>{var e,t;let i=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return i&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:W.b,position:"before",group:fv})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fv)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),(0,y.removeClass)(e,function(e){let t=e.className.split(" "),i=RegExp(`^${fy}-[0-9]{1,2}$`);return t.filter(e=>i.test(e))}(e)),!1!==this.enabled&&(0,y.addClass)(e,function(e,t,i){let r=[];return!1===i||e.isColumnSorted(t)&&e.getNumberOfSortedColumns()>1&&r.push(`${fy}-${e.getIndexOfColumnInSortQueue(t)+1}`),r}(...i))}onAfterOnCellMouseDown(e,t){!1!==rc(t.row,t.col,e)&&this.wasClickableHeaderClicked(e,t.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(t.col),this.sort(this.getNextSortConfig(t.col,rb))):this.sort(this.getColumnNextConfig(t.col)))}}function fC(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class fS extends tC{constructor(){super(...arguments),fC(this,"dragged",[]),fC(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return(0,w.isMobileBrowser)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){let e=this,{rootElement:t}=this.hot;function i(t){if(1===e.dragged.length)return e.dragged.splice(0,e.dragged.length),!0;let i=e.dragged.indexOf(t);if(-1===i)return!1;0===i?e.dragged=e.dragged.slice(0,1):1===i&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(t,"touchstart",t=>{let i;return(0,y.hasClass)(t.target,"topSelectionHandle-HitArea")?(i=e.hot.getSelectedRangeLast(),e.dragged.push("top"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):(0,y.hasClass)(t.target,"bottomSelectionHandle-HitArea")?(i=e.hot.getSelectedRangeLast(),e.dragged.push("bottom"),e.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},t.preventDefault(),!1):void 0}),this.eventManager.addEventListener(t,"touchend",t=>(0,y.hasClass)(t.target,"topSelectionHandle-HitArea")?(i.call(e,"top"),e.touchStartRange=void 0,t.preventDefault(),!1):(0,y.hasClass)(t.target,"bottomSelectionHandle-HitArea")?(i.call(e,"bottom"),e.touchStartRange=void 0,t.preventDefault(),!1):void 0),this.eventManager.addEventListener(t,"touchmove",t=>{let i,r,n,o,s,l,{rootDocument:a}=this.hot;if(0===e.dragged.length)return;let h=a.elementFromPoint(t.touches[0].clientX,t.touches[0].clientY);h&&h!==e.lastSetCell&&(("TD"===h.nodeName||"TH"===h.nodeName)&&(-1===(i=e.hot.getCoords(h)).col&&(i.col=0),n=(r=e.hot.getSelectedRangeLast()).getWidth(),o=r.getHeight(),s=r.getDirection(),1===n&&1===o&&e.hot.selection.setRangeEnd(i),null!==(l=e.getCurrentRangeCoords(r,i,e.touchStartRange.direction,s,e.dragged[0])).start&&e.hot.selection.setRangeStart(l.start),e.hot.selection.setRangeEnd(l.end),e.lastSetCell=h),t.preventDefault())})}getCurrentRangeCoords(e,t,i,r,n){let o=e.getTopStartCorner(),s=e.getBottomEndCorner(),l=e.getBottomStartCorner(),a=e.getTopEndCorner(),h={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":h="top"===n?{start:this.hot._createCellCoords(t.row,e.highlight.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,o.col)};break;case"SE-NW":"bottom"===n&&(h={start:this.hot._createCellCoords(s.row,t.col),end:this.hot._createCellCoords(t.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===n?h={start:t,end:l}:h.end=t;break;case"NW-SE":"top"===n?h={start:t,end:s}:h.end=t;break;case"SE-NW":"top"===n?h={start:t,end:o}:h.end=t;break;case"SW-NE":"top"===n?h={start:t,end:a}:h.end=t}break;case"SW-NE":switch(r){case"NW-SE":h="bottom"===n?{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(l.row,t.col)}:{start:this.hot._createCellCoords(o.row,t.col),end:this.hot._createCellCoords(t.row,s.col)};break;case"SW-NE":h="top"===n?{start:this.hot._createCellCoords(e.highlight.row,t.col),end:this.hot._createCellCoords(t.row,s.col)}:{start:this.hot._createCellCoords(t.row,o.col),end:this.hot._createCellCoords(o.row,t.col)};break;case"SE-NW":"bottom"===n?h={start:this.hot._createCellCoords(t.row,a.col),end:this.hot._createCellCoords(o.row,t.col)}:"top"===n&&(h={start:l,end:t})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===n&&(h.end=t);break;case"SE-NW":"top"===n?h.end=t:h={start:t,end:o}}}return h}isDragged(){return this.dragged.length>0}}var fE=i(91826);function fR(){let{label:e="",colspan:t=1,origColspan:i=1,collapsible:r=!1,crossHiddenColumns:n=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1,headerClassNames:h=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:e,colspan:t,origColspan:i,collapsible:r,isCollapsed:o,crossHiddenColumns:n,isHidden:s,isRoot:l,isPlaceholder:a,headerClassNames:h}}function fT(){return{label:"",isPlaceholder:!0}}function fx(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function fM(e,t){return e.get(fk(e,t))}function fO(e,t,i){return e.set(fk(e,t),i),i}function fk(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let fI=["label","collapsible"];var fA=new WeakMap,fN=new WeakMap,fH=new WeakMap;class fP{constructor(){fx(this,fA,[]),fx(this,fN,0),fx(this,fH,1/0)}setColumnsLimit(e){fO(fH,this,e)}setData(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];fO(fA,this,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=[];if(0===t)return i;(0,z.arrayEach)(e,e=>{let r=[],n=0;i.push(r),(0,z.arrayEach)(e,e=>{let i=fR();if((0,V.isObject)(e)){let{label:t,colspan:r,headerClassName:n}=e;i.label=(0,T.stringify)(t),"number"==typeof r&&r>1&&(i.colspan=r,i.origColspan=r),"string"==typeof n&&(i.headerClassNames=[...n.split(" ")])}else i.label=(0,T.stringify)(e);n+=i.origColspan;let o=!1;if(n>=t&&(i.colspan=i.origColspan-(n-t),i.origColspan=i.colspan,o=!0),r.push(i),i.colspan>1)for(let e=0;e<i.colspan-1;e++)r.push(fT());return!o})});let r=Math.max(...(0,z.arrayMap)(i,e=>e.length));return(0,z.arrayEach)(i,e=>{if(e.length<r){let t=(0,z.arrayMap)(Array(r-e.length),()=>fR());e.splice(e.length,0,...t)}}),i}(e,fM(fH,this))),fO(fN,this,fM(fA,this).length)}getData(){return fM(fA,this)}mergeWith(e){(0,z.arrayEach)(e,e=>{let{row:t,col:i,...r}=e,n=this.getHeaderSettings(t,i);null!==n&&(0,V.extend)(n,r,fI)})}map(e){(0,z.arrayEach)(fM(fA,this),t=>{(0,z.arrayEach)(t,t=>{let i=e({...t});(0,V.isObject)(i)&&(0,V.extend)(t,i,fI)})})}getHeaderSettings(e,t){var i;if(e>=fM(fN,this)||e<0)return null;let r=fM(fA,this)[e];return!1===Array.isArray(r)||t>=r.length?null:null!==(i=r[t])&&void 0!==i?i:null}getHeadersSettings(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(e>=fM(fN,this)||e<0)return r;let n=fM(fA,this)[e],o=0;for(let e=t;e<n.length;e++){let t=n[e];if(t.isPlaceholder)throw Error("The first column settings cannot overlap the other header layers");if(o+=t.colspan,r.push(t),t.colspan>1&&(e+=t.colspan-1),o===i)break;if(o>i)throw Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return fM(fN,this)}getColumnsCount(){return fM(fN,this)>0?fM(fA,this)[0].length:0}clear(){fO(fA,this,[]),fO(fN,this,0)}}function f_(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let fL="DF-pre-order";function fD(e,t){let i=e.call(t,this);for(let r=0;r<this.childs.length;r++){if(!1===i)return!1;i=fD.call(this.childs[r],e,t)}return i}function fF(e,t){for(let i=0;i<this.childs.length;i++)if(!1===fF.call(this.childs[i],e,t))return!1;return e.call(t,this)}let fV=new Map([[fL,fD],["DF-post-order",fF],["BF",function(e,t){let i=[this];!function r(){if(0===i.length)return;let n=i.shift();i.push(...n.childs),!1!==e.call(t,n)&&r()}()}]]);class fW{constructor(e){f_(this,"data",{}),f_(this,"parent",null),f_(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=new fW({...e.data});for(let i=0;i<e.childs.length;i++)t.addChild(this.cloneTree(e.childs[i]));return t}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let t=0;t<e.childs.length;t++)this.addChild(e.childs[t])}walkDown(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!fV.has(t))throw Error(`Traversal strategy "${t}" does not exist`);fV.get(t).call(this,e,this)}walkUp(e){let t=this,i=r=>{!1!==e.call(t,r)&&null!==r.parent&&i(r.parent)};i(this)}}function fB(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function fj(e,t){return e.get(fz(e,t))}function fz(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var fU=new WeakMap,f$=new WeakMap,fG=new WeakMap;class fY{constructor(e){fB(this,fU,new Map),fB(this,f$,new Map),fB(this,fG,null),function(e,t,i){e.set(fz(e,t),i)}(fG,this,e)}getRoots(){return Array.from(fj(fU,this).values())}getRootByColumn(e){let t;return fj(f$,this).has(e)&&(t=fj(fU,this).get(fj(f$,this).get(e))),t}getNode(e,t){let i,r=this.getRootByColumn(t);if(!r)return;let n=t-fj(f$,this).get(t),o=0;return r.walkDown(r=>{let{data:{origColspan:s,headerLevel:l}}=r;if(e===l){if(n>=o&&n<=o+s-1)return(i=r).data.isRoot=t===i.data.columnIndex,!1;o+=s}}),i}rebuildTreeIndex(){let e=0;fj(f$,this).clear(),(0,z.arrayEach)(fj(fU,this),t=>{let[,{data:{colspan:i}}]=t;for(let t=e;t<e+i;t++)fj(f$,this).set(t,e);e+=i})}buildTree(){this.clear();let e=fj(fG,this).getColumnsCount(),t=0;for(;t<e;){let e=fj(fG,this).getHeaderSettings(0,t),i=new fW;fj(fU,this).set(t,i),this.buildLeaves(i,t,0,e.origColspan),t+=e.origColspan}this.rebuildTreeIndex()}buildLeaves(e,t,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=fj(fG,this).getHeadersSettings(i,t,r);i+=1,(0,z.arrayEach)(n,r=>{let n,o={...r,headerLevel:i-1,columnIndex:t};1===i?(e.data=o,n=e):(n=new fW(o),e.addChild(n)),i<fj(fG,this).getLayersCount()&&this.buildLeaves(n,t,i,r.origColspan),t+=r.origColspan})}clear(){fj(fU,this).clear(),fj(f$,this).clear()}}function fK(e,t){e.walkDown(e=>{let{data:i,childs:r}=e;if(!i.isHidden&&(t(i.columnIndex),0===r.length))for(let e=1;e<i.colspan;e++)t(i.columnIndex+e)})}function fX(e,t){let{childs:i}=e;if(0!==i.length)return i[0].data[t]}function fq(e){return fX(e,"origColspan")===e.data.origColspan}function fJ(e){let{data:t,childs:i}=e;if(!t.isCollapsed||t.isHidden||t.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fq(e))return fJ(i[0]);t.isCollapsed=!1;let r=i.slice(1),n=new Set,o=0;if(r.length>0)(0,z.arrayEach)(r,e=>{e.replaceTreeWith(e.data.clonedTree),e.data.clonedTree=null;let t=e.data;o+=t.colspan,fK(e,e=>{n.add(e)})});else{let{colspan:e,origColspan:i,columnIndex:r}=t;o=i-e;for(let e=1;e<i;e++)n.add(r+e)}return e.walkUp(e=>{let{data:t}=e;t.colspan+=o,t.colspan>=t.origColspan?(t.colspan=t.origColspan,t.isCollapsed=!1):fq(e)&&(t.isCollapsed=fX(e,"isCollapsed"))}),{rollbackModification:()=>fZ(e),affectedColumns:Array.from(n),colspanCompensation:o}}function fZ(e){var t;let{data:i,childs:r}=e;if(i.isCollapsed||i.isHidden||i.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fq(e))return fZ(r[0]);i.isCollapsed=!0;let n=r.slice(1),o=new Set;if(n.length>0)(0,z.arrayEach)(n,e=>{fK(e,e=>{o.add(e)}),e.data.clonedTree=e.cloneTree(),e.walkDown(e=>{let{data:t}=e;t.isHidden=!0})});else{let{origColspan:e,columnIndex:t}=i;for(let i=1;i<e;i++){let e=t+i;o.add(e)}}let s=i.colspan-(null!==(t=fX(e,"colspan"))&&void 0!==t?t:1);return e.walkUp(e=>{let{data:t}=e;t.colspan-=s,t.colspan<=1?(t.colspan=1,t.isCollapsed=!0):fq(e)&&(t.isCollapsed=fX(e,"isCollapsed"))}),{rollbackModification:()=>fJ(e),affectedColumns:Array.from(o),colspanCompensation:s}}let fQ=new Map([["collapse",fZ],["expand",fJ],["hide-column",function(e,t){if(!Number.isInteger(t))throw Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw Error((0,ro.O)`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:i}=e.data;if(i.includes(t))return;let r=!1;e.walkUp(e=>{let{data:{collapsible:t}}=e;if(t)return r=!0,!1}),r||e.walkUp(e=>{let{data:i}=e;i.crossHiddenColumns.push(t),i.colspan>1?i.colspan-=1:i.isHidden=!0})}],["show-column",function(e,t){if(!Number.isInteger(t))throw Error("The passed gridColumnIndex argument has invalid type.");if(e.childs.length>0)throw Error((0,ro.O)`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:i}=e.data;if(!i.includes(t))return;let r=!1;e.walkUp(e=>{let{data:{collapsible:t}}=e;if(t)return r=!0,!1}),r||e.walkUp(e=>{let{data:i}=e;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(t),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}]]);function f0(e){let t=[];return(0,z.arrayEach)(e,e=>{e.walkDown(e=>{var i,r;let n,o=e.data,{origColspan:s,columnIndex:l,headerLevel:a,crossHiddenColumns:h}=o,u=(Array.isArray((i=t)[r=a])?n=i[r]:(n=[],i[r]=n),n),c=!1;for(let e=l;e<l+s;e++)if(h.includes(e)||c)u.push(fT(o));else{let e=function(e){let{crossHiddenColumns:t,...i}=fR(e);return i}(o);e.isRoot=!0,u.push(e),c=!0}})}),t}function f1(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function f2(e,t,i){return e.set(f5(e,t),i),i}function f3(e,t){return e.get(f5(e,t))}function f5(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var f9=new WeakMap,f8=new WeakMap,f4=new WeakMap;class f7{constructor(){f1(this,f9,new fP),f1(this,f8,new fY(f3(f9,this))),f1(this,f4,[[]])}setState(e){f3(f9,this).setData(e);let t=!1;try{f3(f8,this).buildTree()}catch(e){f3(f8,this).clear(),f3(f9,this).clear(),t=!0}return f2(f4,this,f0(f3(f8,this).getRoots())),t}setColumnsLimit(e){f3(f9,this).setColumnsLimit(e)}mergeStateWith(e){let t=(0,z.arrayMap)(e,e=>{let{row:t,...i}=e;return{row:t<0?this.rowCoordsToLevel(t):t,...i}});f3(f9,this).mergeWith(t),f3(f8,this).buildTree(),f2(f4,this,f0(f3(f8,this).getRoots()))}mapState(e){f3(f9,this).map(e),f3(f8,this).buildTree(),f2(f4,this,f0(f3(f8,this).getRoots()))}mapNodes(e){return(0,z.arrayReduce)(f3(f8,this).getRoots(),(t,i)=>(i.walkDown(i=>{let r=e(i.data);void 0!==r&&t.push(r)}),t),[])}triggerNodeModification(e,t,i){let r;t<0&&(t=this.rowCoordsToLevel(t));let n=f3(f8,this).getNode(t,i);return n&&(r=function(e,t,i){if(!fQ.has(e))throw Error(`The node modifier action ("${e}") does not exist.`);return fQ.get(e)(t,i)}(e,n,i),f2(f4,this,f0(f3(f8,this).getRoots()))),r}triggerColumnModification(e,t){return this.triggerNodeModification(e,-1,t)}rowCoordsToLevel(e){if(e>=0)return null;let t=e+Math.max(this.getLayersCount(),1);return t<0?null:t}levelToRowCoords(e){if(e<0)return null;let t=e-Math.max(this.getLayersCount(),1);return t>=0?null:t}getHeaderSettings(e,t){var i,r;return(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())?null:null!==(i=null===(r=f3(f4,this)[e])||void 0===r?void 0:r[t])&&void 0!==i?i:null}getHeaderTreeNodeData(e,t){let i=this.getHeaderTreeNode(e,t);return i?{...i.data}:null}getHeaderTreeNode(e,t){if(e<0&&(e=this.rowCoordsToLevel(e)),null===e||e>=this.getLayersCount())return null;let i=f3(f8,this).getNode(e,t);return i||null}findTopMostEntireHeaderLevel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=t-e+1,r=!1,n=null;for(let o=e;o<=t;o++){let s=f3(f8,this).getRootByColumn(o);if(!s)break;r=!0,s.walkDown(r=>{let{columnIndex:o,headerLevel:s,origColspan:l,isHidden:a}=r.data;!a&&l<=i&&o>=e&&o+l-1<=t&&(null===n||s<n)&&(n=s)},fL)}return r&&null===n?-1:this.levelToRowCoords(null!=n?n:0)}findLeftMostColumnIndex(e,t){var i,r;let{isRoot:n}=null!==(i=this.getHeaderSettings(e,t))&&void 0!==i?i:{isRoot:!0};if(n)return t;let o=t-1;for(;o>=0;){let{isRoot:t}=null!==(r=this.getHeaderSettings(e,o))&&void 0!==r?r:{isRoot:!0};if(t)break;o-=1}return o}findRightMostColumnIndex(e,t){var i,r;let{isRoot:n,origColspan:o}=null!==(i=this.getHeaderSettings(e,t))&&void 0!==i?i:{isRoot:!0,origColspan:1};if(n)return t+o-1;let s=t+1;for(;s<this.getColumnsCount();){let{isRoot:t}=null!==(r=this.getHeaderSettings(e,s))&&void 0!==r?r:{isRoot:!0};if(t)break;s+=1}return s-1}getLayersCount(){return f3(f9,this).getLayersCount()}getColumnsCount(){return f3(f9,this).getColumnsCount()}clear(){f2(f4,this,[]),f3(f9,this).clear(),f3(f8,this).clear()}}function f6(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class pe{constructor(e,t){f6(this,"hot",void 0),f6(this,"nestedHeaderSettingsGetter",void 0),f6(this,"layersCount",0),f6(this,"container",void 0),f6(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=t,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){let e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let t=this.container.querySelectorAll("tr:last-of-type th"),i=t.length;this.widthsMap.clear();for(let e=0;e<i;e++){let i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(e),r=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(r,t[e].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){let{rootDocument:t,columnIndexMapper:i}=this.hot,r=t.createDocumentFragment(),n=t.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,s=i.getRenderableIndexesLength();for(let e=0;e<this.layersCount;e++){let r=t.createElement("tr");for(let n=0;n<s;n++){let s=i.getVisualFromRenderableIndex(n);null===s&&(s=n);let l=t.createElement("th"),a=this.nestedHeaderSettingsGetter(e,s);if(a&&(!a.isPlaceholder||a.isHidden)){let e=a.label;o&&(e+='<button class="changeType"></button>'),(0,y.fastInnerHTML)(l,e),l.colSpan=a.colspan,r.appendChild(l)}}n.appendChild(r)}r.appendChild(n),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function pt(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function pi(e,t,i){pr(e,t),t.set(e,i)}function pr(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function pn(e,t,i){return e.set(ps(e,t),i),i}function po(e,t){return e.get(ps(e,t))}function ps(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let pl="nestedHeaders";var pa=new WeakMap,ph=new WeakMap,pu=new WeakMap,pc=new WeakMap,pd=new WeakMap,pg=new WeakSet;class pf extends tC{constructor(){super(...arguments),function(e,t){pr(e,t),t.add(e)}(this,pg),pi(this,pa,new f7),pi(this,ph,null),pi(this,pu,null),pi(this,pc,!1),pi(this,pd,null),pt(this,"ghostTable",new pe(this.hot,(e,t)=>this.getHeaderSettings(e,t))),pt(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return pl}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[pl]}enablePlugin(){var e=this;if(this.enabled)return;let{nestedHeaders:t}=this.hot.getSettings();Array.isArray(t)&&Array.isArray(t[0])||(0,iL.R8)((0,ro.O)`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>ps(pg,this,pA).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pN).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pv).call(e,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pb).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pC).call(e,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pS).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pE).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pR).call(e,...i)}),this.addHook("afterSelection",()=>ps(pg,this,pp).call(this)),this.addHook("afterSelectionFocusSet",()=>ps(pg,this,pp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pm).call(e,...i)}),this.addHook("afterGetColumnHeaderRenderers",e=>ps(pg,this,px).call(this,e)),this.addHook("modifyColWidth",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pO).call(e,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pk).call(e,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pw).call(e,...i)}),this.addHook("beforeCopy",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,py).call(e,...i)}),this.addHook("beforeSelectColumns",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pT).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pM).call(e,...i)}),this.addHook("modifyFocusedElement",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return ps(pg,e,pI).call(e,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>ps(pg,this,pp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>ps(pg,this,pp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:e}=this.hot.getSettings();po(pa,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=po(pa,this).setState(e)),this.detectedOverlappedHeaders&&(0,iL.R8)((0,ro.O)`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((e,t)=>{po(pa,this).triggerColumnModification(!0===e?"hide-column":"show-column",t)}),!po(ph,this)&&this.enabled&&pn(ph,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(e=>{e.forEach(e=>{let{op:t,index:i,newValue:r}=e;"replace"===t&&po(pa,this).triggerColumnModification(!0===r?"hide-column":"show-column",i)}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),po(pa,this).clear(),po(ph,this).unsubscribe(),pn(ph,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return po(pa,this)}getLayersCount(){return po(pa,this).getLayersCount()}getHeaderSettings(e,t){return po(pa,this).getHeaderSettings(e,t)}clearColspans(){if(!this.hot.view)return;let{_wt:e}=this.hot.view,t=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,n=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let e=0;e<t;e++){let t=i.childNodes[e];if(!t)break;let o=r.childNodes[e],s=n?n.childNodes[e]:null;for(let e=0,i=t.childNodes.length;e<i;e++)t.childNodes[e].removeAttribute("colspan"),(0,y.removeClass)(t.childNodes[e],"hiddenHeader"),o&&o.childNodes[e]&&(o.childNodes[e].removeAttribute("colspan"),(0,y.removeClass)(o.childNodes[e],"hiddenHeader")),n&&s&&s.childNodes[e]&&(s.childNodes[e].removeAttribute("colspan"),(0,y.removeClass)(s.childNodes[e],"hiddenHeader"))}}headerRendererFactory(e){var t=this;let i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,n)=>{var o,s,l,a;let{columnIndexMapper:h,view:u}=this.hot,c=h.getVisualFromRenderableIndex(r);null===c&&(c=r),n.removeAttribute("colspan"),(0,y.removeClass)(n,"hiddenHeader"),(0,y.removeClass)(n,"hiddenHeaderText");let{colspan:d,isHidden:g,isPlaceholder:f,headerClassNames:p}=null!==(o=po(pa,this).getHeaderSettings(e,c))&&void 0!==o?o:{label:""};if(f||g)(0,y.addClass)(n,"hiddenHeader");else if(d>1){let{wtOverlays:e}=u._wt,t=null===(s=e.topInlineStartCornerOverlay)||void 0===s?void 0:s.clone.wtTable.THEAD.contains(n),o=null===(l=e.inlineStartOverlay)||void 0===l?void 0:l.clone.wtTable.THEAD.contains(n);(null===(a=e.topOverlay)||void 0===a?void 0:a.clone.wtTable.THEAD.contains(n))&&c<i&&(0,y.addClass)(n,"hiddenHeaderText");let h=t||o?Math.min(d,i-r):d;h>1&&n.setAttribute("colspan",h)}if(this.hot.view.appendColHeader(c,n,function(){return t.getColumnHeaderValue(...arguments)},e),!f&&!g){let e=n.querySelector("div.relative");e&&p&&p.length>0&&((0,y.removeClass)(e,this.hot.getColumnMeta(c).headerClassName),(0,y.addClass)(e,p))}}}getColumnHeaderValue(e,t){var i;let{isHidden:r,isPlaceholder:n}=null!==(i=po(pa,this).getHeaderSettings(t,e))&&void 0!==i?i:{};return n||r?"":this.hot.getColHeader(e,t)}destroy(){pn(pa,this,null),null!==po(ph,this)&&(po(ph,this).unsubscribe(),pn(ph,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0)&&!(e.col<0))return po(pa,this).getHeaderTreeNodeData(e.row,e.col)}}function pp(){var e;let t=null===(e=this.hot)||void 0===e?void 0:e.getSelectedRangeLast();if(!t)return;let{highlight:i}=t;if(i.isHeader()&&i.col>=0){let e=po(pa,this).findLeftMostColumnIndex(i.row,i.col),t=this.hot.selection.highlight.getFocus();t.visualCellRange.highlight.col=e,t.visualCellRange.from.col=e,t.visualCellRange.to.col=e,t.commit()}}function pm(e,t){var i;let r=this.hot.getSelectedRangeLast();if(!r)return e;let{highlight:n}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),l=o?n.row:null===(i=po(pd,this))||void 0===i?void 0:i.row,a=s?e:n.col,h=l<0&&a>=0;if(pn(pd,this,null),!h)return e;let u=this.hot.getFirstFullyVisibleColumn(),c=this.hot.getLastFullyVisibleColumn(),d=c-u+1,g=po(pa,this).findLeftMostColumnIndex(l,a),f=po(pa,this).findRightMostColumnIndex(l,a),p=f-g+1;if(g<u&&f>c)return g;if(s){let e=null;return g>=u&&f>c?p>d?(t.value="start",e=g):(t.value="end",e=f):g<u&&f<=c&&(p>d?(t.value="end",e=f):(t.value="start",e=g)),e}return g<=u?g:f}function pw(e,t,i){let r=po(pa,this).getHeaderTreeNodeData(t,e);if(!r)return e;let{columnCursor:n,selectionType:o,selectionWidth:s}=i,{isRoot:l,colspan:a}=po(pa,this).getHeaderSettings(t,e);if(o===fE.PP){if(!l)return r.columnIndex}else if(o===fE.E6&&(a>s-n||!l))return null;return e}function py(e,t,i){let{columnHeadersCount:r}=i;if(0!==r)for(let i=0;i<t.length;i++){let{startRow:r,startCol:o,endRow:s,endCol:l}=t[i],a=s-r+1,h=o-l+1;if(r>=0||1===h)break;for(let t=o;t<=l;t++)for(let i=r;i<=s;i++){var n;let r=a+i,s=t-o;0!==s&&!1===(null===(n=po(pa,this).getHeaderTreeNodeData(i,t))||void 0===n?void 0:n.isRoot)&&(e[r][s]="")}}}function pv(e,t,i,r){this._getHeaderTreeNodeDataByCoords(t)&&(r.column=!0)}function pb(e,t){let i=this._getHeaderTreeNodeDataByCoords(t);if(!i)return;pn(pu,this,t.clone()),pn(pc,this,!0);let{selection:r}=this.hot,n=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:l}=i,a=!r.inInSelection(t);e.shiftKey&&n?t.col<n.from.col?o.push(n.getTopEndCorner().col,s,t.row):t.col>n.from.col?o.push(n.getTopStartCorner().col,s+l-1,t.row):o.push(s,s+l-1,t.row):((0,F.isLeftClick)(e)||(0,F.isRightClick)(e)&&a||(0,F.isTouchEvent)(e))&&o.push(s,s+l-1,t.row),r.selectColumns(...o)}function pC(e,t,i,r){if(!this.hot.view.isMouseDown()||r.column)return;let n=this._getHeaderTreeNodeDataByCoords(t);if(!n)return;let{columnIndex:o,origColspan:s}=n,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:u}=l;r.column=!0,r.cell=!0;let c=[],d=(0,b.clamp)(t.row,-1/0,-1);t.col<u.col?c.push(h.col,o,d):t.col>u.col?c.push(a.col,o+s-1,d):c.push(o,o+s-1,d),this.hot.selection.selectColumns(...c)}function pS(){pn(pc,this,!1)}function pE(){let{navigableHeaders:e}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!po(pc,this)||!e)return;let t=this.hot.getSelectedRangeLast(),i=t.getTopStartCorner().col,r=t.getBottomEndCorner().col,{columnIndex:n,origColspan:o}=po(pa,this).getHeaderTreeNodeData(po(pu,this).row,po(pu,this).col);if(t.setHighlight(po(pu,this)),o>t.getWidth()||n<i||n+o-1>r){let e=po(pa,this).findTopMostEntireHeaderLevel((0,b.clamp)(i,n,n+o-1),(0,b.clamp)(r,n,n+o-1));t.highlight.row=e,t.highlight.col=t.from.col}}function pR(e){let{highlight:t}=this.hot.getSelectedRangeLast(),i=this.hot._createCellCoords(t.row+e.row,t.col+e.col);if(!(i.isHeader()&&i.col>=0))return;let r=po(pa,this).findLeftMostColumnIndex(i.row,i.col),n=po(pa,this).findRightMostColumnIndex(i.row,i.col);if(e.col<0){let i=t.col>=r&&t.col<=n?r-1:n,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,-1);null===o?e.col=-this.hot.view.countRenderableColumnsInRange(0,t.col):e.col=-Math.max(this.hot.view.countRenderableColumnsInRange(o,t.col)-1,1)}else if(e.col>0){let i=t.col>=r&&t.col<=n?n+1:r,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,1);null===o?e.col=this.hot.view.countRenderableColumnsInRange(t.col,this.hot.countCols()):e.col=Math.max(this.hot.view.countRenderableColumnsInRange(t.col,o)-1,1)}}function pT(e,t,i){let r=e.row,n=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col});pn(pd,this,i.clone()),t.col<e.col?(n&&(e.col=n.columnIndex+n.origColspan-1),o&&(t.col=o.columnIndex)):t.col>=e.col&&(n&&(e.col=n.columnIndex),o&&(t.col=o.columnIndex+o.origColspan-1))}function px(e){if(po(pa,this).getLayersCount()>0){e.length=0;for(let t=0;t<po(pa,this).getLayersCount();t++)e.push(this.headerRendererFactory(t))}}function pM(e){let t=po(pa,this).getLayersCount(),i=e.startColumn,r=!!t;for(let n=0;n<t;n++){let t=po(pa,this).findLeftMostColumnIndex(n,e.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(t);if(t>=0&&(r=!1),(0,b.isNumeric)(o)&&o<e.startColumn){i=o;break}}e.startColumn=r?po(pa,this).getHeaderTreeNodeData(0,i).columnIndex:i}function pO(e,t){let i=this.ghostTable.getWidth(t);return e>i?e:i}function pk(e,t,i){var r;let{label:n}=null!==(r=po(pa,this).getHeaderTreeNodeData(i,t))&&void 0!==r?r:{label:""};return n}function pI(e,t){if(e<0)return this.hot.getCell(e,po(pa,this).findLeftMostColumnIndex(e,t),!0)}function pA(){this.updatePlugin()}function pN(e,t){t||this.updatePlugin()}function pH(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class pP{constructor(e,t){pH(this,"hot",void 0),pH(this,"data",null),pH(this,"plugin",void 0),pH(this,"parentReference",new WeakMap),pH(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=t,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,b.rangeEach)(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,t,i){this.cache.levels[t]||(this.cache.levels[t]=[],this.cache.levelCount+=1),this.cache.levels[t].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:t}),this.hasChildren(e)&&(0,z.arrayEach)(e.__children,i=>{this.cacheNode(i,t+1,e)})}getDataObject(e){return null==e?null:this.cache.rows[e]}readTreeNodes(e,t,i,r){let n=!1,o=t;if(isNaN(o)&&o.end)return o;let s=e;return(s||(s={__children:this.data},n=!0,o-=1),null!=i&&o===i)?{result:s,end:!0}:null!=r&&s===r?{result:o,end:!0}:(o+=1,s.__children&&(0,z.arrayEach)(s.__children,e=>{if(this.parentReference.set(e,n?null:s),isNaN(o=this.readTreeNodes(e,o,i,r))&&o.end)return!1}),o)}mockParent(){let e=this.mockNode();return e.__children=this.data,e}mockNode(){let e={};return(0,V.objectEach)(this.data[0],(t,i)=>{e[i]=null}),e}getRowIndex(e){return null==e?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let t=null;t=isNaN(e)?e:this.getDataObject(e);let i=this.getRowParent(e);return null==i?this.data.indexOf(t):i.__children.indexOf(t)}countAllRows(){let e={__children:this.data};return this.countChildren(e)}countChildren(e){let t=0,i=e;return(isNaN(i)||(i=this.getDataObject(i)),i&&i.__children)?((0,z.arrayEach)(i.__children,e=>{t+=1,e.__children&&(t+=this.countChildren(e))}),t):0}getRowParent(e){let t;return t=isNaN(e)?e:this.getDataObject(e),this.getRowObjectParent(t)}getRowObjectParent(e){return e&&"object"==typeof e?this.cache.nodeInfo.get(e).parent:null}getRowLevel(e){let t=null;return(t=isNaN(e)?e:this.getDataObject(e))?this.getRowObjectLevel(t):null}getRowObjectLevel(e){return null==e?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let t=e;return isNaN(t)||(t=this.getDataObject(t)),!!(t.__children&&t.__children.length)}isChild(e){return null!==this.getRowParent(e)}getChild(e,t){var i;return(null===(i=e.__children)||void 0===i?void 0:i[t])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var t;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&(null===(t=i.__children)||void 0===t?void 0:t.length)!==0}addChild(e,t){let i=t;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let n=e;e||(n=this.mockParent()),n.__children||(n.__children=[]),i||(i=this.mockNode()),n.__children.push(i),this.rewriteCache();let o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,t,i){let r,n=i;if(n||(n=this.mockNode()),this.hot.runHooks("beforeAddChild",e,n,t),e){let i=this.getRowIndex(e)+t+1;this.hot.runHooks("beforeCreateRow",i,1),e.__children.splice(t,null,n),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(i,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",i,1),r=i}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",t,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[t]);n=this.getDataObject(r),this.hot.runHooks("afterAddChild",e,n,t)}addSibling(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",i=this.translateTrimmedRow(e),r=this.getRowParent(i),n=this.getRowIndexWithinParent(i);switch(t){case"below":this.addChildAtIndex(r,n+1,null);break;case"above":this.addChildAtIndex(r,n,null)}}detachFromParent(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=null,r=[];Array.isArray(e)?((0,b.rangeEach)(e[0],e[2],e=>{let t=this.translateTrimmedRow(e);r.push(this.getDataObject(t))}),(0,b.rangeEach)(0,r.length-2,e=>{this.detachFromParent(r[e],!1)}),i=r[r.length-1]):i=e;let n=this.getRowIndex(i),o=this.countChildren(i),s=this.getRowIndexWithinParent(i),l=this.getRowParent(i),a=this.getRowParent(l),h=this.getRowIndex(a),u=null;if(this.hot.runHooks("beforeDetachChild",l,i),null!=s){let e=Array.from(Array(n+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",n,o+1,e,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",n,o+1,e,this.plugin.pluginName),a){u=h+this.countChildren(a);let e=this.getChild(a,this.countChildren(a)-1),t=this.getRowIndex(e);this.hot.runHooks("beforeCreateRow",t+1,o+1,this.plugin.pluginName),a.__children.push(i)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),t&&this.hot.render()}filterData(e,t,i){let r=[];(0,z.arrayEach)(i,e=>{r.push(this.getDataObject(e))}),(0,z.arrayEach)(r,e=>{let t=this.getRowIndexWithinParent(e),i=this.getRowParent(e);null===i?this.data.splice(t,1):i.__children.splice(t,1)}),this.rewriteCache()}spliceData(e,t,i){let r=this.getDataObject(e-1),n=null,o=e;r&&r.__children&&0===r.__children.length?(n=r,o=0):e<this.countAllRows()&&(n=this.getRowParent(e),o=this.getRowIndexWithinParent(e)),n?i?n.__children.splice(o,t,...i):n.__children.splice(o,t):i?this.data.splice(o,t,...i):this.data.splice(o,t),this.rewriteCache()}syncRowWithRawSource(e){let t=e,i=t;do null!==(i=this.getRowParent(i))&&(t=i);while(null!==i);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,t,i,r){let n=t===this.hot.countRows(),o=this.getRowParent(e),s=this.getRowIndexWithinParent(e),l=o.__children.slice(s,s+1),a=e>t,h=n?this.getRowParent(t-1):this.getRowParent(t);null==h&&(h=this.getRowParent(t-1)),null==h&&(h=this.getDataObject(t-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(t)).__children=[];let u=n||i||r?h.__children.length:this.getRowIndexWithinParent(t),c=o===h;h.__children.splice(u,0,l[0]),o.__children.splice(s+(a&&c?1:0),1),this.syncRowWithRawSource(o),c||this.syncRowWithRawSource(h)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function p_(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class pL{constructor(e,t){p_(this,"hot",void 0),p_(this,"plugin",void 0),this.hot=t,this.plugin=e}}let pD=pL;class pF extends pD{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,t){super(e,t),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,t){let i=this.hot.toPhysicalRow(e),r=this.dataManager.getRowLevel(i),n=this.dataManager.getDataObject(i),o=t.getElementsByTagName("DIV")[0],s=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if((0,z.arrayEach)(l,e=>{e&&o.removeChild(e)}),(0,y.addClass)(t,pF.CSS_CLASSES.indicatorContainer),r){let{rootDocument:e}=this.hot,t=s.cloneNode(!0);o.innerHTML="",(0,b.rangeEach)(0,r-1,()=>{let t=e.createElement("SPAN");(0,y.addClass)(t,pF.CSS_CLASSES.emptyIndicator),o.appendChild(t)}),o.appendChild(t)}if(this.dataManager.hasChildren(n)){let e=this.hot.rootDocument.createElement("DIV");a&&(0,y.setAttribute)(e,[(0,M.MG)()]),(0,y.addClass)(t,pF.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?((0,y.addClass)(e,`${pF.CSS_CLASSES.button} ${pF.CSS_CLASSES.expandButton}`),a&&(0,y.setAttribute)(t,[(0,M.dV)(!1)])):((0,y.addClass)(e,`${pF.CSS_CLASSES.button} ${pF.CSS_CLASSES.collapseButton}`),a&&(0,y.setAttribute)(t,[(0,M.dV)(!0)])),o.appendChild(e)}}updateRowHeaderWidth(e){let t=e;t||(t=this.dataManager.cache.levelCount);let i=this.hot.view.getStylesHandler(),r=11;i.isClassicTheme()||(r=2*i.getCSSVariableValue("cell-horizontal-padding")),this.rowHeaderWidthCache=Math.max(50,r+10*t+25),this.hot.render()}}class pV extends pD{constructor(e,t){var i;super(e,t),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,e)},shiftStash:function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==t&&(t=1/0),(0,z.arrayEach)(i.lastCollapsedRows,(n,o)=>{n>=e&&n<t&&(i.lastCollapsedRows[o]=n+r)})},applyStash:function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0];i.collapseMultipleChildren(i.lastCollapsedRows,e),i.lastCollapsedRows=void 0},trimStash:(e,t)=>{(0,b.rangeEach)(e,e+t-1,e=>{let t=this.lastCollapsedRows.indexOf(e);t>-1&&this.lastCollapsedRows.splice(t,1)})}}}collapseChildren(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],n=null,o=null,s=null;return isNaN(e)?(n=e,o=this.dataManager.getRowIndex(n)):(n=this.dataManager.getDataObject(e),o=e),this.dataManager.hasChildren(n)&&(0,z.arrayEach)(n.__children,e=>{r.push(this.dataManager.getRowIndex(e))}),s=this.collapseRows(r,!0,!1),i&&this.trimRows(s),t&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),s}collapseMultipleChildren(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,z.arrayEach)(e,e=>{r.push(...this.collapseChildren(e,!1,!1))}),i&&this.trimRows(r),t&&this.renderAndAdjust()}collapseRow(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.collapseRows([e],t)}collapseRows(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,z.arrayEach)(e,e=>{r.push(e),t&&this.collapseChildRows(e,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){let i=this.dataManager.getDataObject(e);(0,z.arrayEach)(i.__children,e=>{let i=this.dataManager.getRowIndex(e);t.push(i),this.collapseChildRows(i,t)})}i&&this.trimRows(t)}expandRow(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.expandRows([e],t)}expandRows(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,z.arrayEach)(e,e=>{r.push(e),t&&this.expandChildRows(e,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(e)){let i=this.dataManager.getDataObject(e);(0,z.arrayEach)(i.__children,e=>{if(!this.isAnyParentCollapsed(e)){let i=this.dataManager.getRowIndex(e);t.push(i),this.expandChildRows(i,t)}})}i&&this.untrimRows(t)}expandChildren(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],n=null,o=null,s=null;return isNaN(e)?(n=e,o=this.dataManager.getRowIndex(e)):(n=this.dataManager.getDataObject(e),o=e),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(n)&&(0,z.arrayEach)(n.__children,e=>{let t=this.dataManager.getRowIndex(e);r.push(t)}),s=this.expandRows(r,!0,!1),i&&this.untrimRows(s),t&&this.renderAndAdjust(),s}expandMultipleChildren(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,z.arrayEach)(e,e=>{r.push(...this.expandChildren(e,!1,!1))}),i&&this.untrimRows(r),t&&this.renderAndAdjust()}collapseAll(){let e=this.dataManager.getData(),t=[];(0,z.arrayEach)(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.collapseMultipleChildren(t),this.renderAndAdjust()}expandAll(){let e=this.dataManager.getData(),t=[];(0,z.arrayEach)(e,e=>{this.dataManager.hasChildren(e)&&t.push(e)}),this.expandMultipleChildren(t),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{(0,z.arrayEach)(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{(0,z.arrayEach)(e,e=>{this.plugin.collapsedRowsMap.setValueAtIndex(e,!1)})},!0)}areChildrenCollapsed(e){let t=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return null===t&&(t={__children:this.dataManager.data}),this.dataManager.hasChildren(t)&&(0,z.arrayEach)(t.__children,e=>{let t=this.dataManager.getRowIndex(e);if(!this.plugin.collapsedRowsMap.getValueAtIndex(t))return i=!1,!1}),i}isAnyParentCollapsed(e){let t=e;for(;null!==t;){t=this.dataManager.getRowParent(t);let e=this.dataManager.getRowIndex(t);if(this.collapsedRows.indexOf(e)>-1)return!0}return!1}toggleState(e,t){if(t.col>=0)return;let i=this.translateTrimmedRow(t.row);(0,y.hasClass)(e.target,pF.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),(0,F.stopImmediatePropagation)(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var pW=new WeakMap;class pB extends pD{constructor(){super(...arguments),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"dataManager",this.plugin.dataManager),function(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}(this,pW,{row_above:(e,t)=>{let i=t[t.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,t)=>{let i=t[t.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){let t=[{key:"add_child",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{let e=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),t=this.dataManager.getDataObject(e);this.dataManager.addChild(t)},disabled:()=>{let e=this.hot.getSelectedLast();return!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(eK.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let e=this.hot.getSelectedLast(),t=this.dataManager.translateTrimmedRow(e[0]);return!this.dataManager.getRowParent(t)||!e||e[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,b.rangeEach)(0,e.items.length-1,i=>{if(0===i)return(0,z.arrayEach)(t,(t,r)=>{e.items.splice(i+r,0,t)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return(0,b.rangeEach)(0,e.items.length-1,t=>{let i=pW.get(function(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}(pW,this))[e.items[t].key];null!=i&&(e.items[t].callback=i)}),e}}function pj(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class pz{constructor(e){pj(this,"plugin",void 0),pj(this,"hot",void 0),pj(this,"dataManager",void 0),pj(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,t,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:t,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;let n=i===this.hot.countRows(),o=n?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),s=!0,l=e.map(e=>{if(!s)return!1;let t=this.dataManager.translateTrimmedRow(e);return s=this.shouldAllowMoving(t,o),t}),a=-1===l.indexOf(o);if(!s||!a)return!1;let h=this.getBaseParent(l),u=this.getTargetParent(n,o),c=h===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,o,c),this.moveRows(l,o,u),this.dataManager.rewriteCache(),this.moveCellsMeta(l,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,t,i,r,r&&this.isRowOrderChanged(e,t)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){let{rows:t,finalIndex:i,dropIndex:r,movePossible:n}=e,o=!1;return(0,T.isUndefined)(r)&&((0,iL.R8)((0,ro.O)`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",t,i,r,n,!1),o=!0),o}shouldAllowMoving(e,t){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===t||0===t)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,t){let i=this.dataManager.getRowParent(e?t-1:t);return null==i&&(i=this.dataManager.getRowParent(t-1)),i}shiftCollapsibleParentsLocations(e,t,i){i||(Math.max(...e)<=t?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],t,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(t,e[0],e.length))}moveRows(e,t,i){let r=t===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(e=>{this.dataManager.moveRow(e,t,this.movedToCollapsed,r)})})}moveCellsMeta(e,t){let i=[],r=Math.max(...e)<t;e.forEach(e=>{i.push(this.hot.getCellMetaAtRow(e))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(t-(r?i.length:0),0,...i)}selectCells(e,t){let i=e.length,r=0,n=0;if(this.movedToCollapsed){let o=null;o=e[i-1]<t?this.dataManager.translateTrimmedRow(t-i):this.dataManager.translateTrimmedRow(t);let s=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(s);n=r=this.dataManager.untranslateTrimmedRow(l)}else e[i-1]<t?r=(n=t-1)-i+1:n=(r=t)+i-1;this.hot.selectCells([[r,0,n,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,t){return e.some((e,i)=>e-i!==t)}}function pU(e,t,i){p$(e,t),t.set(e,i)}function p$(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function pG(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function pY(e,t){return e.get(pX(e,t))}function pK(e,t,i){return e.set(pX(e,t),i),i}function pX(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let pq="nestedRows";var pJ=new WeakMap,pZ=new WeakMap,pQ=new WeakSet;class p0 extends tC{constructor(){super(...arguments),function(e,t){p$(e,t),t.add(e)}(this,pQ),pG(this,"dataManager",null),pG(this,"headersUI",null),pG(this,"collapsedRowsMap",null),pU(this,pJ,!1),pU(this,pZ,!1)}static get PLUGIN_KEY(){return pq}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[pq]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new a9.q),this.dataManager=new pP(this,this.hot),this.collapsingUI=new pV(this,this.hot),this.headersUI=new pF(this,this.hot),this.contextMenuUI=new pB(this,this.hot),this.rowMoveController=new pz(this),this.addHook("afterInit",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,mn).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,mo).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p3).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p5).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p9).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p2).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p7).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p4).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p6).call(e,...i)}),this.addHook("afterAddChild",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,me).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,mt).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,mi).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p8).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,mr).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return pX(pQ,e,p1).call(e,...i)}),this.addHook("beforeLoadData",e=>pX(pQ,this,ms).call(this,e)),this.addHook("beforeUpdateData",e=>pX(pQ,this,ms).call(this,e)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();let e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:e}=this.hot.getSelectedRangeLast(),t=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(t)?this.collapsingUI.expandChildren(t):this.collapsingUI.collapseChildren(t),!1},runOnlyIf:()=>{var e,t;let i=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;return i&&(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&this.hot.selection.isCellVisible(i)&&-1===i.col&&i.row>=0},group:pq,relativeToGroup:W.b,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pq)}disableCoreAPIModifiers(){pK(pZ,this,!0)}enableCoreAPIModifiers(){pK(pZ,this,!1)}onModifyRowData(e){if(!pY(pZ,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!pY(pZ,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,t,i){return!!(pY(pZ,this)||this.dataManager.isRowHighestLevel(e))||(this.dataManager.spliceData(e,t,i),!1)}destroy(){super.destroy()}}function p1(e,t,i,r){return this.rowMoveController.onBeforeRowMove(e,t,i,r)}function p2(e,t,i){this.collapsingUI.toggleState(e,t,i)}function p3(e,t,i){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],t),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*t),this.dataManager.filterData(e,t,i),pK(pJ,this,!0),this.dataManager.getData().slice()}function p5(e){return this.contextMenuUI.appendOptions(e)}function p9(e,t){this.headersUI.appendLevelIndicators(e,t)}function p8(e){return Math.max(this.headersUI.rowHeaderWidthCache,e)}function p4(e,t,i,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{pK(pJ,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function p7(e,t,i){let r=Array.from(i.reduce((e,t)=>{if(this.dataManager.isParent(t)){let i=this.dataManager.getDataObject(t).__children;return e.add(t),Array.isArray(i)&&i.forEach(t=>e.add(this.dataManager.getRowIndex(t))),e}return e.add(t)},new Set));i.length=0,i.push(...r)}function p6(){this.collapsingUI.collapsedRowsStash.stash()}function me(e,t){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(t)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function mt(){this.collapsingUI.collapsedRowsStash.stash()}function mi(e,t,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function mr(){this.dataManager.rewriteCache()}function mn(){this.headersUI.updateRowHeaderWidth()}function mo(e,t){pY(pJ,this)&&(t.skipRender=!0)}function ms(e){if(!(0,ag.isArrayOfObjects)(e)){(0,iL.z3)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[pq]=!1,this.disablePlugin();return}this.dataManager.setData(e),this.dataManager.rewriteCache()}function ml(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ma{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;ml(this,"rootWindow",void 0),ml(this,"prefix",void 0),ml(this,"savedKeys",[]),this.rootWindow=t,this.prefix=e,this.loadSavedKeys()}saveValue(e,t){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(t)),-1===this.savedKeys.indexOf(e)&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,t){let i=this.rootWindow.localStorage.getItem(`${this.prefix}_${void 0===e?t:e}`);return null===i?void 0:JSON.parse(i)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){(0,z.arrayEach)(this.savedKeys,(e,t)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[t]}`)}),this.clearSavedKeys()}loadSavedKeys(){let e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),t="string"==typeof e?JSON.parse(e):void 0;this.savedKeys=t||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}d.R.getSingleton().register("persistentStateSave"),d.R.getSingleton().register("persistentStateLoad"),d.R.getSingleton().register("persistentStateReset");let mh="persistentState";class mu extends tC{constructor(){super(...arguments),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"storage",void 0)}static get PLUGIN_KEY(){return mh}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[mh]}enablePlugin(){this.enabled||(this.storage||(this.storage=new ma(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,t)=>this.saveValue(e,t)),this.addHook("persistentStateLoad",(e,t)=>this.loadValue(e,t)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,t){t.value=this.storage.loadValue(e)}saveValue(e,t){this.storage.saveValue(e,t)}resetValue(e){void 0===e?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function mc(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function md(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let mg="search",mf=function(e,t,i,r,n){e.getCellMeta(t,i).isSearchResult=n},mp=function(e,t,i){return!((0,T.isUndefined)(e)||null===e||!e.toLocaleLowerCase||0===e.length||(0,T.isUndefined)(t)||null===t)&&-1!==t.toString().toLocaleLowerCase(i.locale).indexOf(e.toLocaleLowerCase(i.locale))};var mm=new WeakSet;class mw extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,mm),mc(this,"callback",mf),mc(this,"queryMethod",mp),mc(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return mg}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[mg]}enablePlugin(){var e=this;if(this.enabled)return;let t=this.hot.getSettings()[mg];this.updatePluginSettings(t),this.addHook("beforeRenderer",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return md(mm,e,my).call(e,...i)}),super.enablePlugin()}disablePlugin(){var e=this;let t=function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return md(mm,e,my).call(e,...i)};this.hot.addHook("beforeRenderer",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",t)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),r=this.hot.countRows(),n=this.hot.countCols(),o=[],s=this.hot;return(0,b.rangeEach)(0,r-1,r=>{(0,b.rangeEach)(0,n-1,n=>{let l=this.hot.getDataAtCell(r,n),a=this.hot.getCellMeta(r,n),h=a.search.callback||t,u=(a.search.queryMethod||i)(e,l,a);u&&o.push({row:r,col:n,data:l}),h&&h(s,r,n,l,u)})}),o}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){(0,V.isObject)(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function my(e,t,i,r,n,o){let s=o.className||[],l=[];"string"==typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}function mv(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class mb{constructor(e){mv(this,"viewportWidth",void 0),mv(this,"overwriteColumnWidthFn",void 0),mv(this,"baseWidths",new Map),mv(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:t}=e;this.viewportWidth=t,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,t){this.baseWidths.set(e,t)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class mC extends mb{calculate(){let e=Array.from(this.baseWidths).reduce((e,t)=>{let[,i]=t;return e+i},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}let t=this.viewportWidth/e,i=[],r=[],n=this.viewportWidth,o=0;if(this.baseWidths.forEach((e,s)=>{let l=Math.round(e*t),a=this.overwriteColumnWidthFn(l,s);l===a&&l>=tO.j?(i.push([s,a]),o+=a):l!==a&&(i.push([s,a]),r.push(s),n-=a)}),n<=tO.j){this.stretchedWidths.clear();return}let s=n/o,l=-1,a=0;i.forEach((e,t)=>{let[n,o]=e,h=o;r.includes(n)||(h=Math.round(o*s)),this.stretchedWidths.set(n,h),l=n,t<i.length-1&&(a+=h)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(l,Math.round(this.viewportWidth-a))}}function mS(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function mE(e,t){return e.get(mT(e,t))}function mR(e,t,i){return e.set(mT(e,t),i),i}function mT(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var mx=new WeakMap,mM=new WeakMap;class mO extends mb{constructor(){super(...arguments),mS(this,mx,0),mS(this,mM,-1)}prepare(e){super.prepare(e),mR(mx,this,0),mR(mM,this,-1)}setColumnBaseWidth(e,t){super.setColumnBaseWidth(e,t),mR(mM,this,e),mR(mx,this,t)}calculate(){if(-1===mE(mM,this))return;let e=Array.from(this.baseWidths).reduce((e,t)=>{let[,i]=t;return e+i},0),t=Math.max(this.viewportWidth-e+mE(mx,this),0);this.stretchedWidths.set(mE(mM,this),t)}}function mk(e,t,i){mI(e,t),t.set(e,i)}function mI(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function mA(e,t){return e.get(mH(e,t))}function mN(e,t,i){return e.set(mH(e,t),i),i}function mH(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var mP=new WeakMap,m_=new WeakMap,mL=new WeakMap,mD=new WeakMap,mF=new WeakSet;class mV{constructor(e){!function(e,t){mI(e,t),t.add(e)}(this,mF),mk(this,mP,void 0),mk(this,m_,void 0),mk(this,mL,new Map([["all",new mC(mH(mF,this,mj).bind(this))],["last",new mO(mH(mF,this,mj).bind(this))]])),mk(this,mD,"none"),mN(mP,this,e),mN(m_,this,mA(mP,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(e){mN(mD,this,mA(mL,this).has(e)?e:"none")}refreshStretching(){if("none"===mA(mD,this)){mA(m_,this).clear();return}mA(mP,this).batchExecution(()=>{mA(m_,this).clear();let e=mA(mL,this).get(mA(mD,this)),t=mA(mP,this).view.getViewportWidth();mH(mF,this,mW).call(this)&&(t-=(0,y.getScrollbarWidth)(mA(mP,this).rootDocument)),e.prepare({viewportWidth:t});for(let t=0;t<mA(mP,this).countCols();t++)mA(mP,this).columnIndexMapper.isHidden(mA(mP,this).toPhysicalColumn(t))||e.setColumnBaseWidth(t,mH(mF,this,mB).call(this,t));e.calculate(),e.getWidths().forEach(e=>{let[t,i]=e;mA(m_,this).setValueAtIndex(mA(mP,this).toPhysicalColumn(t),i)})},!0)}getStretchedWidth(e){return mA(m_,this).getValueAtIndex(mA(mP,this).toPhysicalColumn(e))}}function mW(){let{view:e}=mA(mP,this);if(e.isVerticallyScrollableByWindow())return!1;let t=e.getViewportHeight(),i=mA(mP,this).countRows(),r=e.getStylesHandler().getDefaultRowHeight(),n=0,o=!1;for(let e=0;e<i;e++){var s;if((n+=(null!==(s=mA(mP,this).getRowHeight(e))&&void 0!==s?s:r)+ +(0===e))>t){o=!0;break}}return o}function mB(e){var t;return null!==(t=mA(mP,this).getColWidth(e,"StretchColumns"))&&void 0!==t?t:tO.j}function mj(e,t){return mA(mP,this).runHooks("beforeStretchingColumnWidth",e,t)}function mz(e,t,i){mU(e,t),t.set(e,i)}function mU(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function m$(e,t,i){return e.set(mY(e,t),i),i}function mG(e,t){return e.get(mY(e,t))}function mY(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var mK=new WeakMap,mX=new WeakMap,mq=new WeakMap,mJ=new WeakSet;class mZ extends tC{constructor(){super(...arguments),function(e,t){mU(e,t),t.add(e)}(this,mJ),mz(this,mK,new mV(this.hot)),mz(this,mX,null),mz(this,mq,new ResizeObserver(e=>{requestAnimationFrame(()=>{var t;null!==(t=this.hot)&&void 0!==t&&t.view.isHorizontallyScrollableByWindow()&&e.forEach(e=>{let{contentRect:t}=e;null!==mG(mX,this)&&mG(mX,this)!==t.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),m$(mX,this,t.width)})})}))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(mG(mK,this).useStrategy(this.hot.getSettings().stretchH),mG(mq,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return mY(mJ,e,m0).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return mY(mJ,e,mQ).call(e,...i)},10),super.enablePlugin())}updatePlugin(){mG(mK,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),mG(mq,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return mG(mK,this).getStretchedWidth(e)}destroy(){mG(mq,this).disconnect(),m$(mq,this,null),m$(mK,this,null),super.destroy()}}function mQ(e,t,i){if(i===this.pluginName)return;let r=this.getColumnWidth(t);return"number"==typeof r?r:e}function m0(e){e&&mG(mK,this).refreshStretching()}function m1(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function m2(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var m3=new WeakSet;class m5 extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,m3),m1(this,"scrollbars",[]),m1(this,"clones",[]),m1(this,"lockedCollection",!1),m1(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return(0,tE.isTouchSupported)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>m2(m3,this,m9).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>m2(m3,this,m8).call(this)),this.addHook("afterMomentumScroll",()=>m2(m3,this,m4).call(this))}}function m9(){if(this.lockedCollection)return;let{topOverlay:e,bottomOverlay:t,inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(e),t.clone&&this.scrollbars.push(t),this.scrollbars.push(i),r&&this.scrollbars.push(r),n&&n.clone&&this.scrollbars.push(n),this.clones=[],e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&n.clone&&this.clones.push(n.clone.wtTable.holder.parentNode)}function m8(){this.freezeOverlays=!0,(0,z.arrayEach)(this.clones,e=>{(0,y.addClass)(e,"hide-tween")})}function m4(){this.freezeOverlays=!1,(0,z.arrayEach)(this.clones,e=>{(0,y.removeClass)(e,"hide-tween"),(0,y.addClass)(e,"show-tween")}),this.hot._registerTimeout(()=>{(0,z.arrayEach)(this.clones,e=>{(0,y.removeClass)(e,"show-tween")})},400),(0,z.arrayEach)(this.scrollbars,e=>{e.refresh(),e.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}let m7="trimRows";var m6=new WeakSet;class we extends tC{constructor(){super(...arguments),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,m6),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[t]=null}(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return m7}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[m7]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new a9.q),this.trimmedRowsMap.addLocalHook("init",()=>(function(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")})(m6,this,wt).call(this)),super.enablePlugin())}updatePlugin(){let e=this.hot.getSettings()[m7];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,z.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){let t=this.getTrimmedRows(),i=this.isValidConfig(e),r=t;i&&(r=Array.from(new Set(t.concat(e)))),!1!==this.hot.runHooks("beforeTrimRow",t,r,i)&&(i&&this.hot.batchExecution(()=>{(0,z.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0),this.hot.runHooks("afterTrimRow",t,r,i,i&&r.length>t.length))}trimRow(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.trimRows(t)}untrimRows(e){let t=this.getTrimmedRows(),i=this.isValidConfig(e),r=t,n=this.trimmedRowsMap.getValues().slice(),o=e.length>0;i&&o&&((0,z.arrayEach)(e,e=>{n[e]=!1}),r=(0,z.arrayReduce)(n,(e,t,i)=>(t&&e.push(i),e),[])),!1!==this.hot.runHooks("beforeUntrimRow",t,r,i&&o)&&(i&&o&&this.trimmedRowsMap.setValues(n),this.hot.runHooks("afterUntrimRow",t,r,i&&o,i&&r.length<t.length))}untrimRow(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];this.untrimRows(t)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){let t=this.hot.countSourceRows();return e.every(e=>Number.isInteger(e)&&e>=0&&e<t)}destroy(){super.destroy()}}function wt(){let e=this.hot.getSettings()[m7];Array.isArray(e)&&this.hot.batchExecution(()=>{(0,z.arrayEach)(e,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}class wi{constructor(e){!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:"",enumerable:!0,configurable:!0,writable:!0}):e[t]=""}(this,"actionType",""),this.actionType=e}undo(){throw Error("Not implemented")}redo(){throw Error("Not implemented")}}function wr(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wn extends wi{constructor(e){let{stateBefore:t,range:i,type:r,alignment:n}=e;super("cell_alignment"),wr(this,"stateBefore",void 0),wr(this,"range",void 0),wr(this,"type",void 0),wr(this,"alignment",void 0),this.stateBefore=t,this.range=i,this.type=r,this.alignment=n}static startRegisteringEvents(e,t){e.addHook("beforeCellAlignment",(e,i,r,n)=>{t.done(()=>new wn({stateBefore:e,range:i,type:r,alignment:n}))})}undo(e,t){(0,z.arrayEach)(this.range,t=>{t.forAll((t,i)=>{t>=0&&i>=0&&e.setCellMeta(t,i,"className",this.stateBefore[t][i]||" htLeft")})}),e.addHookOnce("afterViewRender",t),e.render()}redo(e,t){nr(this.range,this.type,this.alignment,(t,i)=>e.getCellMeta(t,i),(t,i,r,n)=>e.setCellMeta(t,i,r,n)),e.addHookOnce("afterViewRender",t),e.render()}}function wo(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class ws extends wi{constructor(e){let{columns:t,finalIndex:i}=e;super("col_move"),wo(this,"columns",void 0),wo(this,"finalColumnIndex",void 0),this.columns=t.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,t){e.addHook("beforeColumnMove",(e,i)=>{!1!==e&&t.done(()=>new ws({columns:e,finalIndex:i}))})}undo(e,t){let i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),hA(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&(r-=1),i.moveColumn(r,t)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,t){let i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",t),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function wl(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wa extends wi{constructor(e){let{currentSortState:t,newSortState:i}=e;super("col_sort"),wl(this,"previousSortState",void 0),wl(this,"nextSortState",void 0),this.previousSortState=t,this.nextSortState=i}static startRegisteringEvents(e,t){e.addHook("beforeColumnSort",(e,i,r)=>{r&&t.done(()=>new wa({currentSortState:e,newSortState:i}))})}undo(e,t){let i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),n=r.isEnabled()?r:i;this.previousSortState.length?n.sort(this.previousSortState):n.clearSort(),t()}redo(e,t){let i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),t()}}function wh(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wu extends wi{constructor(e){let{index:t,amount:i}=e;super("insert_col"),wh(this,"index",void 0),wh(this,"amount",void 0),this.index=t,this.amount=i}static startRegisteringEvents(e,t){e.addHook("afterCreateCol",(e,i,r)=>{t.done(()=>new wu({index:e,amount:i}),r)})}undo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function wc(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wd extends wi{constructor(e){let{index:t,amount:i}=e;super("insert_row"),wc(this,"index",void 0),wc(this,"amount",void 0),this.index=t,this.amount=i}static startRegisteringEvents(e,t){e.addHook("afterCreateRow",(e,i,r)=>{t.done(()=>new wd({index:e,amount:i}),r)})}undo(e,t){let i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function wg(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wf extends wi{constructor(e){let{changes:t,selected:i,countCols:r,countRows:n}=e;super("change"),wg(this,"changes",void 0),wg(this,"selected",void 0),wg(this,"countCols",void 0),wg(this,"countRows",void 0),this.changes=t,this.selected=i,this.countCols=r,this.countRows=n}static startRegisteringEvents(e,t){e.addHook("beforeChange",function(i,r){let n=i&&i.length;n&&i.find(e=>{let[,,t,i]=e;return t!==i})&&t.done(()=>{let t=i.reduce((e,t)=>(e.push([...t]),e),[]);t.forEach(t=>{t[1]=e.propToCol(t[1])});let r=n>1?this.getSelected():[[t[0][0],t[0][1]]];return new wf({changes:t,selected:r,countCols:e.countCols(),countRows:e.countRows()})},r)})}undo(e,t){let i=(0,V.deepClone)(this.changes);for(let e=0,t=i.length;e<t;e++)i[e].splice(3,1);e.addHookOnce("afterChange",t),e.setDataAtCell(i,null,null,"UndoRedo.undo");let r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");let n=e.countCols()-this.countCols;n>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,n,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1)}redo(e,t){let i=(0,V.deepClone)(this.changes);for(let e=0,t=i.length;e<t;e++)i[e].splice(2,1);e.addHookOnce("afterChange",t),e.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&e.selectCells(this.selected,!1,!1)}}function wp(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wm extends wi{constructor(e){let{conditionsStack:t,previousConditionsStack:i}=e;super("filter"),wp(this,"conditionsStack",void 0),wp(this,"previousConditionsStack",void 0),this.conditionsStack=t,this.previousConditionsStack=i}static startRegisteringEvents(e,t){e.addHook("beforeFilter",(e,i)=>{t.done(()=>new wm({conditionsStack:e,previousConditionsStack:i}))})}undo(e,t){let i=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,t){let i=e.getPlugin("filters");e.addHookOnce("afterViewRender",t),i.importConditions(this.conditionsStack),i.filter()}}class ww extends wi{constructor(e){let{data:t,cellRange:i}=e;super("merge_cells"),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"cellRange",void 0),this.cellRange=i,this.data=t}static startRegisteringEvents(e,t){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;let n=i.getTopStartCorner(),o=i.getBottomEndCorner(),s=e.getData(n.row,n.col,o.row,o.col);t.done(()=>new ww({data:s,cellRange:i}))})}undo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0);let r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange)}}function wy(e,t,i,r,n){let o=["visualRow","visualCol","row","col","prop"],s=o.length,l=[];return(0,b.rangeEach)(r,n,r=>{(0,b.rangeEach)(t,i,t=>{let i=e.getCellMeta(t,r);if(Object.keys(i).length!==s){let e=Object.fromEntries(Object.entries(i).filter(e=>{let[t]=e;return!1===o.includes(t)}));l.push([i.visualRow,i.visualCol,e])}})}),l}function wv(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}i(91215);class wb extends wi{constructor(e){let{index:t,indexes:i,data:r,amount:n,headers:o,columnPositions:s,rowPositions:l,fixedColumnsStart:a,removedCellMetas:h}=e;super("remove_col"),wv(this,"index",void 0),wv(this,"indexes",void 0),wv(this,"data",void 0),wv(this,"amount",void 0),wv(this,"headers",void 0),wv(this,"columnPositions",void 0),wv(this,"rowPositions",void 0),wv(this,"fixedColumnsStart",void 0),wv(this,"removedCellMetas",void 0),this.index=t,this.indexes=i,this.data=r,this.amount=n,this.headers=o,this.columnPositions=s.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=a,this.removedCellMetas=h}static startRegisteringEvents(e,t){e.addHook("beforeRemoveCol",(i,r,n,o)=>{t.done(()=>{let t=e.getSourceDataArray(),n=(e.countCols()+i)%e.countCols(),o=n+r-1,s=[],l=[],a=[];return(0,b.rangeEach)(t.length-1,i=>{let r=[],l=t[i];(0,b.rangeEach)(n,o,t=>{r.push(l[e.toPhysicalColumn(t)])}),s.push(r)}),(0,b.rangeEach)(r-1,t=>{a.push(e.toPhysicalColumn(n+t))}),Array.isArray(e.getSettings().colHeaders)&&(0,b.rangeEach)(r-1,t=>{l.push(e.getSettings().colHeaders[e.toPhysicalColumn(n+t)]||null)}),new wb({index:n,indexes:a,data:s,amount:r,headers:l,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:wy(e,0,e.countRows(),n,o)})},o)})}undo(e,t){e.getSettings().fixedColumnsStart=this.fixedColumnsStart;let i=this.indexes.slice(0).sort(),r=(e,t,r)=>r[this.indexes.indexOf(i[t])],n=this.data.length,o=[];for(let e=0;e<n;e++)o.push((0,z.arrayMap)(this.data[e],r));let s=(0,z.arrayMap)(this.headers,r),l=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),(0,z.arrayEach)(e.getSourceDataArray(),(e,t)=>{(0,z.arrayEach)(i,(i,r)=>{e[i]=o[t][r],l.push([t,i,e[i]])})}),void 0!==this.headers&&(0,z.arrayEach)(s,(t,r)=>{e.getSettings().colHeaders[i[r]]=t}),this.removedCellMetas.forEach(t=>{let[i,r,n]=t;e.setCellMetaObject(i,r,n)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(l,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function wC(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wS extends wi{constructor(e){let{index:t,data:i,fixedRowsBottom:r,fixedRowsTop:n,rowIndexesSequence:o,removedCellMetas:s}=e;super("remove_row"),wC(this,"index",void 0),wC(this,"data",void 0),wC(this,"fixedRowsBottom",void 0),wC(this,"fixedRowsTop",void 0),wC(this,"rowIndexesSequence",void 0),wC(this,"removedCellMetas",void 0),this.index=t,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o,this.removedCellMetas=s}static startRegisteringEvents(e,t){e.addHook("beforeRemoveRow",(i,r,n,o)=>{t.done(()=>{let t=e.toPhysicalRow(i),n=t+r-1,o=(0,V.deepClone)(e.getSourceData(t,0,t+r-1,e.countSourceCols()-1));return new wS({index:t,data:o,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:wy(e,t,n,0,e.countCols()-1)})},o)})}undo(e,t){let i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((e,t)=>{Object.keys(e).forEach(i=>{let n=parseInt(i,10);r.push([this.index+t,isNaN(n)?i:n,e[i]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(t=>{let[i,r,n]=t;e.setCellMetaObject(i,r,n)}),e.addHookOnce("afterViewRender",t),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function wE(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class wR extends wi{constructor(e){let{rows:t,finalIndex:i}=e;super("row_move"),wE(this,"rows",void 0),wE(this,"finalRowIndex",void 0),this.rows=t.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,t){e.addHook("beforeRowMove",(e,i)=>{!1!==e&&t.done(()=>new wR({rows:e,finalIndex:i}))})}undo(e,t){let i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),hA(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(e=>{let{from:t,to:r}=e;t<r&&(r-=1),i.moveRow(r,t)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,t){let i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",t),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}class wT extends wi{constructor(e){let{cellRange:t}=e;super("unmerge_cells"),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"cellRange",void 0),this.cellRange=t}static startRegisteringEvents(e,t){e.addHook("afterUnmergeCells",(e,i)=>{i||t.done(()=>new wT({cellRange:e}))})}undo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.mergeRange(this.cellRange,!0)}redo(e,t){let i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",t),i.unmergeRange(this.cellRange,!0),e.render()}}function wx(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function wM(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}let wO="undoRedo";d.R.getSingleton().register("beforeUndo"),d.R.getSingleton().register("afterUndo"),d.R.getSingleton().register("beforeRedo"),d.R.getSingleton().register("afterRedo");let wk=new Set;var wI=new WeakSet;class wA extends tC{static get PLUGIN_KEY(){return"undoRedo"}static get PLUGIN_PRIORITY(){return 1e3}static get SETTING_KEYS(){return!0}constructor(e){var t;super(e),function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,wI),wx(this,"doneActions",[]),wx(this,"undoneActions",[]),wx(this,"ignoreNewActions",!1),t=this,[wn,ws,wa,wu,wd,wf,wm,ww,wb,wS,wR,wT].forEach(i=>i.startRegisteringEvents(e,t))}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return wM(wI,e,wN).call(e,...i)}),this.registerShortcuts(),wM(wI,this,wH).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),wM(wI,this,wP).call(this)}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:e=>!e.altKey,group:wO})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wO)}done(e,t){if(this.ignoreNewActions||"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t)return;let i=this.doneActions.slice();if(!1===this.hot.runHooks("beforeUndoStackChange",i,t))return;let r=e(),n=this.undoneActions.slice();this.doneActions.push(r),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",n),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",n,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;let e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);let t=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());let i=(0,V.deepClone)(t);if(!1===this.hot.runHooks("beforeUndo",i))return;this.ignoreNewActions=!0;let r=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",r),t.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(t)}),this.hot.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;let e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);let t=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());let i=(0,V.deepClone)(t);if(!1===this.hot.runHooks("beforeRedo",i))return;this.ignoreNewActions=!0;let r=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",r),t.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(t)}),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function wN(e,t){"loadData"===t&&this.clear()}function wH(){let e=e=>{wk.has(e)||((0,iL.R8)((0,ro.O)`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),wk.add(e))};this.hot.undo=()=>{e("undo"),this.undo()},this.hot.redo=()=>{e("redo"),this.redo()},this.hot.isUndoAvailable=()=>(e("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(e("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{e("clear"),this.clear()},this.hot.undoRedo=this}function wP(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}var w_=i(41973);(0,eU.VA)(p.b7),(0,eU.VA)(et),(0,eU.VA)(er),(0,eU.VA)(e_),(0,eU.VA)(eD),(0,eU.VA)(j),(0,eU.VA)(eF),(0,eU.VA)(eV),(0,eU.VA)(ej),(0,eU.VA)(A),(0,eU.VA)(ez),(0,e6.TS)(eG),(0,e6.TS)(N),(0,e6.TS)(e0),(0,e6.TS)(eY),(0,e6.TS)(e2),(0,e6.TS)(e$),(0,e6.TS)(e9),(0,e6.TS)(e8),(0,e6.TS)(e4),(0,e6.TS)(H),(0,e6.TS)(e7),(0,ta.qV)(te),(0,ta.qV)(tn),(0,ta.qV)(tr),(0,ta.qV)(to),(0,ta.qV)(tl),(0,f.Gk)({CELL_TYPE:"autocomplete",editor:et,renderer:eG,validator:te}),(0,f.Gk)({CELL_TYPE:"checkbox",editor:er,renderer:e0}),(0,f.Gk)({CELL_TYPE:"date",editor:e_,renderer:th,validator:tr}),(0,f.Gk)({CELL_TYPE:"dropdown",editor:eD,renderer:eY,validator:tn,filter:!1,strict:!0}),(0,f.Gk)({CELL_TYPE:"handsontable",editor:j,renderer:e2}),(0,f.Gk)({CELL_TYPE:"numeric",editor:eF,renderer:e9,validator:to,dataType:"number"}),(0,f.Gk)({CELL_TYPE:"password",editor:eV,renderer:e8,copyable:!1}),(0,f.Gk)({CELL_TYPE:"select",editor:ej,renderer:e4}),(0,f.Gk)(P),(0,f.Gk)({CELL_TYPE:"time",editor:ez,renderer:e7,validator:tl}),(0,tu.F3)(tB),(0,tu.F3)(t3),(0,tu.F3)(iu),(0,tu.F3)(iP),(0,tu.F3)(iY),(0,tu.F3)(rE),(0,tu.F3)(rP),(0,tu.F3)(nT),(0,tu.F3)(ox),(0,tu.F3)(so),(0,tu.F3)(sO),(0,tu.F3)(s_),(0,tu.F3)(s$),(0,tu.F3)(li),(0,tu.F3)(hl),(0,tu.F3)(uo),(0,tu.F3)(uV),(0,tu.F3)(uQ),(0,tu.F3)(cr),(0,tu.F3)(cH),(0,tu.F3)(de),(0,tu.F3)(dH),(0,tu.F3)(ge),(0,tu.F3)(g1),(0,tu.F3)(fb),(0,tu.F3)(fS),(0,tu.F3)(pf),(0,tu.F3)(p0),(0,tu.F3)(mu),(0,tu.F3)(mw),(0,tu.F3)(mZ),(0,tu.F3)(m5),(0,tu.F3)(we),(0,tu.F3)(wA),function(e){let t="undefined"!=typeof window&&window.jQuery;t&&(t.fn.handsontable=function(t){let i,r=this.first(),n=r.data("handsontable");if("string"!=typeof t){let i=t||{};return n?n.updateSettings(i):(n=new e.Core(r[0],i),r.data("handsontable",n),n.init()),r}if(n)if(void 0!==n[t]){for(var o=arguments.length,s=Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];i=n[t].call(n,...s),"destroy"===t&&r.removeData()}else throw Error(`Handsontable do not provide action: ${t}`);return i})}(D),D.__GhostTable=tT,D._getListenersCounter=m.O,D._getRegisteredMapsCounter=w_.o,D.EventManager=m.A;let wL=[z,w,ag,a,tE,G,T,b,V,U,$,oq],wD=[y,F];D.helper={},D.dom={},z.arrayEach(wL,e=>{z.arrayEach(Object.getOwnPropertyNames(e),t=>{"_"!==t.charAt(0)&&(D.helper[t]=e[t])})}),z.arrayEach(wD,e=>{z.arrayEach(Object.getOwnPropertyNames(e),t=>{"_"!==t.charAt(0)&&(D.dom[t]=e[t])})}),D.cellTypes=null!==(r=D.cellTypes)&&void 0!==r?r:{},z.arrayEach((0,f.lY)(),e=>{D.cellTypes[e]=(0,f.r0)(e)}),D.cellTypes.registerCellType=f.Gk,D.cellTypes.getCellType=f.r0,D.editors=null!==(n=D.editors)&&void 0!==n?n:{},z.arrayEach((0,eU.sY)(),e=>{D.editors[`${U.toUpperCaseFirst(e)}Editor`]=(0,eU.M8)(e)}),D.editors.registerEditor=eU.VA,D.editors.getEditor=eU.M8,D.renderers=null!==(o=D.renderers)&&void 0!==o?o:{},z.arrayEach((0,e6.Yx)(),e=>{let t=(0,e6.gB)(e);"base"===e&&(D.renderers.cellDecorator=t),D.renderers[`${U.toUpperCaseFirst(e)}Renderer`]=t}),D.renderers.registerRenderer=e6.TS,D.renderers.getRenderer=e6.gB,D.validators=null!==(s=D.validators)&&void 0!==s?s:{},z.arrayEach((0,ta.P1)(),e=>{D.validators[`${U.toUpperCaseFirst(e)}Validator`]=(0,ta.by)(e)}),D.validators.registerValidator=ta.qV,D.validators.getValidator=ta.by,D.plugins=null!==(l=D.plugins)&&void 0!==l?l:{},z.arrayEach((0,tu.f4)(),e=>{D.plugins[e]=(0,tu.sd)(e)}),D.plugins[`${U.toUpperCaseFirst(tC.PLUGIN_KEY)}Plugin`]=tC,D.plugins.registerPlugin=tu.F3,D.plugins.getPlugin=tu.sd;let wF=D},42620:function(e,t,i){"use strict";var r=function(e){return e&&e.Math===Math&&e};e.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof i.g&&i.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},42665:(e,t,i)=>{"use strict";var r=i(5383);e.exports=function(e){var t=+e;return t!=t||0===t?0:r(t)}},42947:e=>{"use strict";var t=TypeError;e.exports=function(e){if(e>0x1fffffffffffff)throw t("Maximum allowed index exceeded");return e}},43942:(e,t,i)=>{"use strict";i(64571)},43987:(e,t,i)=>{"use strict";var r,n,o,s,l=i(42620),a=i(62495),h=i(89364),u=i(99365),c=i(95467),d=i(56963),g=i(56899),f=i(13928),p=i(15567),m=i(46724),w=i(34498),y=i(83869),b=l.setImmediate,C=l.clearImmediate,S=l.process,E=l.Dispatch,R=l.Function,T=l.MessageChannel,x=l.String,M=0,O={},k="onreadystatechange";d(function(){r=l.location});var I=function(e){if(c(O,e)){var t=O[e];delete O[e],t()}},A=function(e){return function(){I(e)}},N=function(e){I(e.data)},H=function(e){l.postMessage(x(e),r.protocol+"//"+r.host)};b&&C||(b=function(e){m(arguments.length,1);var t=u(e)?e:R(e),i=f(arguments,1);return O[++M]=function(){a(t,void 0,i)},n(M),M},C=function(e){delete O[e]},y?n=function(e){S.nextTick(A(e))}:E&&E.now?n=function(e){E.now(A(e))}:T&&!w?(s=(o=new T).port2,o.port1.onmessage=N,n=h(s.postMessage,s)):l.addEventListener&&u(l.postMessage)&&!l.importScripts&&r&&"file:"!==r.protocol&&!d(H)?(n=H,l.addEventListener("message",N,!1)):n=k in p("script")?function(e){g.appendChild(p("script"))[k]=function(){g.removeChild(this),I(e)}}:function(e){setTimeout(A(e),0)}),e.exports={set:b,clear:C}},44065:(e,t,i)=>{"use strict";i.d(t,{o:()=>o}),i(19398);var r=i(12522),n=i(95061);class o extends r._{constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(e)}getHiddenIndexes(){return(0,n.arrayReduce)(this.getValues(),(e,t,i)=>(t&&e.push(i),e),[])}}},46420:(e,t,i)=>{"use strict";i.d(t,{TS:()=>h,Yx:()=>s,gB:()=>a,sl:()=>o}),i(41658);let{register:r,getItem:n,hasItem:o,getNames:s,getValues:l}=(0,i(21413).A)("renderers");function a(e){if("function"==typeof e)return e;if(!o(e))throw Error(`No registered renderer found under "${e}" name`);return n(e)}function h(e,t){"string"!=typeof e&&(e=(t=e).RENDERER_TYPE),r(e,t)}},46724:e=>{"use strict";var t=TypeError;e.exports=function(e,i){if(e<i)throw new t("Not enough arguments");return e}},47580:(e,t,i)=>{"use strict";var r=i(34323),n=i(24851);e.exports=function(e,t,i){return i.get&&r(i.get,t,{getter:!0}),i.set&&r(i.set,t,{setter:!0}),n.f(e,t,i)}},48195:(e,t,i)=>{"use strict";var r=i(67297),n=i(76494),o=i(241),s=i(38896),l=i(4230),a=i(7107),h=TypeError,u=a("toPrimitive");e.exports=function(e,t){if(!n(e)||o(e))return e;var i,a=s(e,u);if(a){if(void 0===t&&(t="default"),!n(i=r(a,e,t))||o(i))return i;throw new h("Can't convert object to primitive value")}return void 0===t&&(t="number"),l(e,t)}},50320:(e,t,i)=>{"use strict";var r=i(99365),n=i(92743),o=TypeError;e.exports=function(e){if(r(e))return e;throw new o(n(e)+" is not a function")}},50344:(e,t,i)=>{"use strict";var r=i(42620),n=i(99365),o=r.WeakMap;e.exports=n(o)&&/native code/.test(String(o))},52571:(e,t,i)=>{"use strict";i.d(t,{$t:()=>R,LN:()=>s,U3:()=>u,hs:()=>O,i5:()=>f,k_:()=>T,nh:()=>d,yn:()=>l});var r=i(10156),n=i(808);let o=Object.create(null);class s{constructor(e,t,i){this.$anchor=e,this.$head=t,this.ranges=i||[new l(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=r.Ji.empty){let i=t.content.lastChild,n=null;for(let e=0;e<t.openEnd;e++)n=i,i=i.lastChild;let o=e.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:h}=s[l],u=e.mapping.slice(o);e.replaceRange(u.map(a.pos),u.map(h.pos),l?r.Ji.empty:t),0==l&&w(e,o,(i?i.isInline:n&&n.isTextblock)?-1:1)}}replaceWith(e,t){let i=e.steps.length,r=this.ranges;for(let n=0;n<r.length;n++){let{$from:o,$to:s}=r[n],l=e.mapping.slice(i),a=l.map(o.pos),h=l.map(s.pos);n?e.deleteRange(a,h):(e.replaceRangeWith(a,h,t),w(e,i,t.isInline?-1:1))}}static findFrom(e,t,i=!1){let r=e.parent.inlineContent?new u(e):m(e.node(0),e.parent,e.pos,e.index(),t,i);if(r)return r;for(let r=e.depth-1;r>=0;r--){let n=t<0?m(e.node(0),e.node(r),e.before(r+1),e.index(r),t,i):m(e.node(0),e.node(r),e.after(r+1),e.index(r)+1,t,i);if(n)return n}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new f(e.node(0))}static atStart(e){return m(e,e,0,0,1)||new f(e)}static atEnd(e){return m(e,e,e.content.size,e.childCount,-1)||new f(e)}static fromJSON(e,t){if(!t||!t.type)throw RangeError("Invalid input for Selection.fromJSON");let i=o[t.type];if(!i)throw RangeError(`No selection type ${t.type} defined`);return i.fromJSON(e,t)}static jsonID(e,t){if(e in o)throw RangeError("Duplicate use of selection JSON ID "+e);return o[e]=t,t.prototype.jsonID=e,t}getBookmark(){return u.between(this.$anchor,this.$head).getBookmark()}}s.prototype.visible=!0;class l{constructor(e,t){this.$from=e,this.$to=t}}let a=!1;function h(e){a||e.parent.inlineContent||(a=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class u extends s{constructor(e,t=e){h(e),h(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let i=e.resolve(t.map(this.head));if(!i.parent.inlineContent)return s.near(i);let r=e.resolve(t.map(this.anchor));return new u(r.parent.inlineContent?r:i,i)}replace(e,t=r.Ji.empty){if(super.replace(e,t),t==r.Ji.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof u&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new c(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new u(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,i=t){let r=e.resolve(t);return new this(r,i==t?r:e.resolve(i))}static between(e,t,i){let r=e.pos-t.pos;if((!i||r)&&(i=r>=0?1:-1),!t.parent.inlineContent){let e=s.findFrom(t,i,!0)||s.findFrom(t,-i,!0);if(!e)return s.near(t,i);t=e.$head}return e.parent.inlineContent||(0==r?e=t:(e=(s.findFrom(e,-i,!0)||s.findFrom(e,i,!0)).$anchor).pos<t.pos==r<0||(e=t)),new u(e,t)}}s.jsonID("text",u);class c{constructor(e,t){this.anchor=e,this.head=t}map(e){return new c(e.map(this.anchor),e.map(this.head))}resolve(e){return u.between(e.resolve(this.anchor),e.resolve(this.head))}}class d extends s{constructor(e){let t=e.nodeAfter;super(e,e.node(0).resolve(e.pos+t.nodeSize)),this.node=t}map(e,t){let{deleted:i,pos:r}=t.mapResult(this.anchor),n=e.resolve(r);return i?s.near(n):new d(n)}content(){return new r.Ji(r.FK.from(this.node),0,0)}eq(e){return e instanceof d&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new g(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new d(e.resolve(t.anchor))}static create(e,t){return new d(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}d.prototype.visible=!1,s.jsonID("node",d);class g{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:i}=e.mapResult(this.anchor);return t?new c(i,i):new g(i)}resolve(e){let t=e.resolve(this.anchor),i=t.nodeAfter;return i&&d.isSelectable(i)?new d(t):s.near(t)}}class f extends s{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=r.Ji.empty){if(t==r.Ji.empty){e.delete(0,e.doc.content.size);let t=s.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new f(e)}map(e){return new f(e)}eq(e){return e instanceof f}getBookmark(){return p}}s.jsonID("all",f);let p={map(){return this},resolve:e=>new f(e)};function m(e,t,i,r,n,o=!1){if(t.inlineContent)return u.create(e,i);for(let s=r-(n>0?0:1);n>0?s<t.childCount:s>=0;s+=n){let r=t.child(s);if(r.isAtom){if(!o&&d.isSelectable(r))return d.create(e,i-(n<0?r.nodeSize:0))}else{let t=m(e,r,i+n,n<0?r.childCount:0,n,o);if(t)return t}i+=r.nodeSize*n}return null}function w(e,t,i){let r,o=e.steps.length-1;if(o<t)return;let l=e.steps[o];(l instanceof n.Ln||l instanceof n.Wg)&&(e.mapping.maps[o].forEach((e,t,i,n)=>{null==r&&(r=n)}),e.setSelection(s.near(e.doc.resolve(r),i)))}class y extends n.dL{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return r.CU.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let i=this.selection;return t&&(e=e.mark(this.storedMarks||(i.empty?i.$from.marks():i.$from.marksAcross(i.$to)||r.CU.none))),i.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,i){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==i&&(i=t),i=null==i?t:i,!e)return this.deleteRange(t,i);let n=this.storedMarks;if(!n){let e=this.doc.resolve(t);n=i==t?e.marks():e.marksAcross(this.doc.resolve(i))}return this.replaceRangeWith(t,i,r.text(e,n)),this.selection.empty||this.setSelection(s.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function b(e,t){return t&&e?e.bind(t):e}class C{constructor(e,t,i){this.name=e,this.init=b(t.init,i),this.apply=b(t.apply,i)}}let S=[new C("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new C("selection",{init:(e,t)=>e.selection||s.atStart(t.doc),apply:e=>e.selection}),new C("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,i,r)=>r.selection.$cursor?e.storedMarks:null}),new C("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class E{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=S.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new C(e.key,e.spec.state,e))})}}class R{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=t){let t=this.config.plugins[i];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],i=this.applyInner(e),r=null;for(;;){let n=!1;for(let o=0;o<this.config.plugins.length;o++){let s=this.config.plugins[o];if(s.spec.appendTransaction){let l=r?r[o].n:0,a=r?r[o].state:this,h=l<t.length&&s.spec.appendTransaction.call(s,l?t.slice(l):t,a,i);if(h&&i.filterTransaction(h,o)){if(h.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<o?{state:i,n:t.length}:{state:this,n:0})}t.push(h),i=i.applyInner(h),n=!0}r&&(r[o]={state:i,n:t.length})}}if(!n)return{state:i,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let t=new R(this.config),i=this.config.fields;for(let r=0;r<i.length;r++){let n=i[r];t[n.name]=n.apply(e,this[n.name],this,t)}return t}get tr(){return new y(this)}static create(e){let t=new E(e.doc?e.doc.type.schema:e.schema,e.plugins),i=new R(t);for(let r=0;r<t.fields.length;r++)i[t.fields[r].name]=t.fields[r].init(e,i);return i}reconfigure(e){let t=new E(this.schema,e.plugins),i=t.fields,r=new R(t);for(let t=0;t<i.length;t++){let n=i[t].name;r[n]=this.hasOwnProperty(n)?this[n]:i[t].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let i in e){if("doc"==i||"selection"==i)throw RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[i],n=r.spec.state;n&&n.toJSON&&(t[i]=n.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,i){if(!t)throw RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw RangeError("Required config field 'schema' missing");let n=new E(e.schema,e.plugins),o=new R(n);return n.fields.forEach(n=>{if("doc"==n.name)o.doc=r.bP.fromJSON(e.schema,t.doc);else if("selection"==n.name)o.selection=s.fromJSON(o.doc,t.selection);else if("storedMarks"==n.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(i)for(let r in i){let s=i[r],l=s.spec.state;if(s.key==n.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(t,r)){o[n.name]=l.fromJSON.call(s,e,t[r],o);return}}o[n.name]=n.init(e,o)}}),o}}class T{constructor(e){this.spec=e,this.props={},e.props&&function e(t,i,r){for(let n in t){let o=t[n];o instanceof Function?o=o.bind(i):"handleDOMEvents"==n&&(o=e(o,i,{})),r[n]=o}return r}(e.props,this,this.props),this.key=e.key?e.key.key:M("plugin")}getState(e){return e[this.key]}}let x=Object.create(null);function M(e){return e in x?e+"$"+ ++x[e]:(x[e]=0,e+"$")}class O{constructor(e="key"){this.key=M(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}},53469:(e,t,i)=>{"use strict";var r=i(42620).navigator,n=r&&r.userAgent;e.exports=n?String(n):""},53480:(e,t,i)=>{"use strict";var r=i(14412),n=i(24851),o=i(32138);e.exports=function(e,t,i){r?n.f(e,t,o(0,i)):e[t]=i}},53545:(e,t,i)=>{"use strict";var r=i(54076),n=i(80729);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("isSupersetOf",function(e){return!e})},{isSupersetOf:n})},54076:(e,t,i)=>{"use strict";var r=i(42620),n=i(64897).f,o=i(24201),s=i(34988),l=i(7687),a=i(37e3),h=i(83072);e.exports=function(e,t){var i,u,c,d,g,f=e.target,p=e.global,m=e.stat;if(i=p?r:m?r[f]||l(f,{}):r[f]&&r[f].prototype)for(u in t){if(d=t[u],c=e.dontCallGetSet?(g=n(i,u))&&g.value:i[u],!h(p?u:f+(m?".":"#")+u,e.forced)&&void 0!==c){if(typeof d==typeof c)continue;a(d,c)}(e.sham||c&&c.sham)&&o(d,"sham",!0),s(i,u,d,e)}}},54674:(e,t,i)=>{"use strict";var r=i(93840),n=i(95467),o=i(13517),s=i(96843).indexOf,l=i(4389),a=r([].push);e.exports=function(e,t){var i,r=o(e),h=0,u=[];for(i in r)!n(l,i)&&n(r,i)&&a(u,i);for(;t.length>h;)n(r,i=t[h++])&&(~s(u,i)||a(u,i));return u}},54733:e=>{"use strict";e.exports={}},55289:(e,t,i)=>{"use strict";i(81315)("flatMap")},55415:(e,t,i)=>{"use strict";var r=i(99365),n=i(76494),o=i(65847);e.exports=function(e,t,i){var s,l;return o&&r(s=t.constructor)&&s!==i&&n(l=s.prototype)&&l!==i.prototype&&o(e,l),e}},55544:(e,t,i)=>{"use strict";var r=i(54674),n=i(66627);e.exports=Object.keys||function(e){return r(e,n)}},56135:e=>{"use strict";e.exports=function(e){return null==e}},56395:(e,t,i)=>{"use strict";var r=i(42620);e.exports=function(e,t){var i=r.Iterator,n=i&&i.prototype,o=n&&n[e],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(e){e instanceof t||(s=!1)}if(!s)return o}},56397:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(50320),s=i(8883),l=i(7475),a=i(31338),h=i(71197),u=i(76093),c=i(99842),d=i(56395),g=i(72255),f=!g&&!c("map",function(){}),p=!g&&!f&&d("map",TypeError),m=g||f||p,w=a(function(){var e=this.iterator,t=s(n(this.next,e));if(!(this.done=!!t.done))return h(e,this.mapper,[t.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(e){s(this);try{o(e)}catch(e){u(this,"throw",e)}return p?n(p,this,e):new w(l(this),{mapper:e})}})},56899:(e,t,i)=>{"use strict";e.exports=i(82309)("document","documentElement")},56963:e=>{"use strict";e.exports=function(e){try{return!!e()}catch(e){return!0}}},57193:(e,t,i)=>{"use strict";i.d(t,{R8:()=>n,z3:()=>o});var r=i(78887);function n(){(0,r.isDefined)(console)&&console.warn(...arguments)}function o(){(0,r.isDefined)(console)&&console.error(...arguments)}},57272:(e,t,i)=>{"use strict";var r=i(89364),n=i(67297),o=i(8883),s=i(92743),l=i(10027),a=i(94948),h=i(7411),u=i(60695),c=i(95283),d=i(76093),g=TypeError,f=function(e,t){this.stopped=e,this.result=t},p=f.prototype;e.exports=function(e,t,i){var m,w,y,b,C,S,E,R=i&&i.that,T=!!(i&&i.AS_ENTRIES),x=!!(i&&i.IS_RECORD),M=!!(i&&i.IS_ITERATOR),O=!!(i&&i.INTERRUPTED),k=r(t,R),I=function(e){return m&&d(m,"normal"),new f(!0,e)},A=function(e){return T?(o(e),O?k(e[0],e[1],I):k(e[0],e[1])):O?k(e,I):k(e)};if(x)m=e.iterator;else if(M)m=e;else{if(!(w=c(e)))throw new g(s(e)+" is not iterable");if(l(w)){for(y=0,b=a(e);b>y;y++)if((C=A(e[y]))&&h(p,C))return C;return new f(!1)}m=u(e,w)}for(S=x?e.next:m.next;!(E=n(S,m)).done;){try{C=A(E.value)}catch(e){d(m,"throw",e)}if("object"==typeof C&&C&&h(p,C))return C}return new f(!1)}},57496:(e,t,i)=>{"use strict";i.d(t,{K:()=>s});var r=i(82505),n=i(33774),o=i(927);class s extends r.n{constructor(){super(e=>e)}insert(e,t){let i=(0,o.z)(this.indexedValues,t);this.indexedValues=(0,n.N)(i,e,t),super.insert(e,t)}remove(e){let t=(0,n.H)(this.indexedValues,e);this.indexedValues=(0,o.v)(t,e),super.remove(e)}}},57555:(e,t,i)=>{"use strict";i.d(t,{A:()=>s,O:()=>l}),i(41658),i(19398);var r=i(13115);let n=0;class o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,t,i){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(e){i.call(this,function(e){let t=e.stopImmediatePropagation;return e.stopImmediatePropagation=function(){t.apply(this),(0,r.stopImmediatePropagation)(this)},e}(e))}return this.context.eventListeners.push({element:e,event:t,callback:i,callbackProxy:s,options:o,eventManager:this}),e.addEventListener(t,s,o),n+=1,()=>{this.removeEventListener(e,t,i)}}removeEventListener(e,t,i){let r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.context.eventListeners.length;for(;s;)if(s-=1,(r=this.context.eventListeners[s]).event===t&&r.element===e){if(i&&i!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(s,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),n-=1}}clearEvents(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let t=this.context.eventListeners.length;for(;t;){t-=1;let i=this.context.eventListeners[t];(!e||i.eventManager===this)&&(this.context.eventListeners.splice(t,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),n-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,t){let i,r=e.document,n=e;r||(n=(r=e.ownerDocument?e.ownerDocument:e).defaultView);let o={bubbles:!0,cancelable:"mousemove"!==t,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};r.createEvent?(i=r.createEvent("MouseEvents")).initMouseEvent(t,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||r.body.parentNode):i=r.createEventObject(),e.dispatchEvent?e.dispatchEvent(i):e.fireEvent(`on${t}`,i)}}let s=o;function l(){return n}},57580:(e,t,i)=>{"use strict";e.exports=i(8496)(i(16954).proto,"size","get")||function(e){return e.size}},58045:(e,t,i)=>{"use strict";i.d(t,{rl:()=>c});var r=i(7346),n=i(33773),o=i(13115);let s=[{name:"editorCloseAndSave",callback(e){e._getEditorManager().closeEditorAndSaveChanges()}},{name:"editorCloseAndSaveByArrowKeys",callback(e,t,i){let r=e._getEditorManager(),o=r.getActiveEditor();o.isInFullEditMode()&&o.state===n._T.EDITING||(r.closeEditorAndSaveChanges(),e.getSelected()&&(i.includes("arrowdown")?e.selection.transformStart(1,0):i.includes("arrowup")?e.selection.transformStart(-1,0):i.includes("arrowleft")?e.selection.transformStart(0,-1*e.getDirectionFactor()):i.includes("arrowright")&&e.selection.transformStart(0,e.getDirectionFactor())),t.preventDefault())}},{name:"editorCloseAndSaveByEnter",callback(e,t){let i=e._getEditorManager();i.closeEditorAndSaveChanges(t.ctrlKey||t.metaKey),i.moveSelectionAfterEnter(t)}},{name:"editorCloseWithoutSaving",callback(e){let t=e._getEditorManager();t.closeEditorAndRestoreOriginalValue(e.getShortcutManager().isCtrlPressed()),t.activeEditor.focus()}},{name:"editorFastOpen",callback(e,t){let{highlight:i}=e.getSelectedRangeLast();i.isHeader()||e._getEditorManager().openEditor(null,t,!0)}},{name:"editorOpen",callback(e,t,i){let r=e._getEditorManager(),n=e.getSelectedRangeLast(),{highlight:s}=n;if(e.selection.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0){let r=e.getSettings(),n="function"==typeof r.enterMoves?r.enterMoves(t):r.enterMoves;i.includes("shift")?e.selection.transformFocus(-n.row,-n.col):e.selection.transformFocus(n.row,n.col);return}s.isHeader()||(e.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(t):r.openEditor(null,t,!0):r.moveSelectionAfterEnter(t),(0,o.stopImmediatePropagation)(t))}},{name:"extendCellsSelectionDown",callback(e){let{selection:t}=e,{highlight:i}=e.getSelectedRangeLast();!t.isSelectedByColumnHeader()&&!t.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&t.isSelectedByRowHeader())&&(t.markSource("keyboard"),t.transformEnd(1,0),t.markEndSource())}},{name:"extendCellsSelectionDownByViewportHeight",callback(e){let{selection:t,rowIndexMapper:i}=e,{to:r}=e.getSelectedRangeLast(),n=Math.min(r.row+e.countVisibleRows(),e.countRows()-1),o=i.getNearestNotHiddenIndex(n,-1);if(null!==o){let i=e._createCellCoords(o,r.col),n=r.row-e.getFirstFullyVisibleRow(),s=Math.min(i.row-n,e.countRows()-1);t.markSource("keyboard"),t.setRangeEnd(i),t.markEndSource(),e.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(e){let{selection:t}=e,{highlight:i}=e.getSelectedRangeLast();!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&t.isSelectedByColumnHeader())&&(t.markSource("keyboard"),t.transformEnd(0,-1*e.getDirectionFactor()),t.markEndSource())}},{name:"extendCellsSelectionRight",callback(e){let{selection:t}=e,{highlight:i}=e.getSelectedRangeLast();!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&t.isSelectedByColumnHeader())&&(t.markSource("keyboard"),t.transformEnd(0,e.getDirectionFactor()),t.markEndSource())}},{name:"extendCellsSelectionToColumns",callback(e){let{selection:t}=e,{highlight:i,from:r,to:n}=e.getSelectedRangeLast();t.markSource("keyboard"),t.isSelectedByRowHeader()?t.selectAll(!0,!0):e.selectColumns(r.col,n.col,i),t.markEndSource()}},{name:"extendCellsSelectionToMostBottom",callback(e){let{selection:t,rowIndexMapper:i}=e,{highlight:r,from:n,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByRowHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(e.countRows()-1,-1),a=n.clone();a.row=r.row,t.markSource("keyboard"),t.setRangeStart(a,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(l,o.col)),t.markEndSource()}}},{name:"extendCellsSelectionToMostInlineEnd",callback(e){let{selection:t,columnIndexMapper:i}=e,{highlight:r,from:n,to:o}=e.getSelectedRangeLast();if(!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&r.isCell()){let s=i.getNearestNotHiddenIndex(e.countCols()-1,-1),l=n.clone();l.col=r.col,t.markSource("keyboard"),t.setRangeStart(l,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,s)),t.markEndSource()}}},{name:"extendCellsSelectionToMostInlineStart",callback(e){let{selection:t,columnIndexMapper:i}=e,{highlight:r,from:n,to:o}=e.getSelectedRangeLast();if(!t.isSelectedByRowHeader()&&!t.isSelectedByCorner()&&r.isCell()){let s=parseInt(e.getSettings().fixedColumnsStart,10),l=i.getNearestNotHiddenIndex(s,1),a=n.clone();a.col=r.col,t.markSource("keyboard"),t.setRangeStart(a,void 0,!1,r.clone()),t.setRangeEnd(e._createCellCoords(o.row,l)),t.markEndSource()}}},{name:"extendCellsSelectionToMostLeft",callback(e){let{selection:t,columnIndexMapper:i}=e,{highlight:r,from:n,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByColumnHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]),a=n.clone();a.col=r.col,t.markSource("keyboard"),t.setRangeStart(a,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,l)),t.markEndSource()}}},{name:"extendCellsSelectionToMostRight",callback(e){let{selection:t,columnIndexMapper:i}=e,{highlight:r,from:n,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByColumnHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]),a=n.clone();a.col=r.col,t.markSource("keyboard"),t.setRangeStart(a,void 0,!1,r.clone()),s&&t.selectedByColumnHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(o.row,l)),t.markEndSource()}}},{name:"extendCellsSelectionToMostTop",callback(e){let{selection:t,rowIndexMapper:i}=e,{highlight:r,from:n,to:o}=e.getSelectedRangeLast(),s=r.isHeader()&&t.isSelectedByRowHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(0,1),a=n.clone();a.row=r.row,t.markSource("keyboard"),t.setRangeStart(a,void 0,!1,r.clone()),s&&t.selectedByRowHeader.add(t.getLayerLevel()),t.setRangeEnd(e._createCellCoords(l,o.col)),t.markEndSource()}}},{name:"extendCellsSelectionToRows",callback(e){let{selection:t}=e,{highlight:i,from:r,to:n}=e.getSelectedRangeLast();t.markSource("keyboard"),t.isSelectedByColumnHeader()?t.selectAll(!0,!0):e.selectRows(r.row,n.row,i),t.markEndSource()}},{name:"extendCellsSelectionUp",callback(e){let{selection:t}=e,{highlight:i}=e.getSelectedRangeLast();!t.isSelectedByColumnHeader()&&!t.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&t.isSelectedByRowHeader())&&(t.markSource("keyboard"),t.transformEnd(-1,0),t.markEndSource())}},{name:"extendCellsSelectionUpByViewportHeight",callback(e){let{selection:t,rowIndexMapper:i}=e,{to:r}=e.getSelectedRangeLast(),n=Math.max(r.row-e.countVisibleRows(),0),o=i.getNearestNotHiddenIndex(n,1);if(null!==o){let i=e._createCellCoords(o,r.col),n=r.row-e.getFirstFullyVisibleRow(),s=Math.max(i.row-n,0);t.markSource("keyboard"),t.setRangeEnd(i),t.markEndSource(),e.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(1,0),t.markEndSource()}},{name:"moveCellSelectionDownByViewportHeight",callback(e){let{selection:t}=e,{navigableHeaders:i}=e.getSettings(),r=i?e.countColHeaders():0,{row:n}=e.getSelectedRangeLast().highlight,o=e.countVisibleRows()+r;o=0===o?1:o,n===e.countRows()-1?o=1:n+o>e.countRows()&&(o=e.countRows()-n-1),t.markSource("keyboard"),t.transformStart(o,0),t.markEndSource(),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(e,t){let{selection:i}=e,r=e.getSettings(),n=e.getSelectedRangeLast(),o="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;i.markSource("keyboard"),i.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?i.transformFocus(-o.row,-o.col):i.transformStart(-o.row,-o.col),i.markEndSource()}},{name:"moveCellSelectionInlineStart",callback(e,t){let{selection:i}=e,r=e.getSettings(),n=e.getSelectedRangeLast(),o="function"==typeof r.tabMoves?r.tabMoves(t):r.tabMoves;i.markSource("keyboard"),i.isMultiple()&&!n.isHeader()&&e.countRenderedCols()>0&&e.countRenderedRows()>0?i.transformFocus(o.row,o.col):i.transformStart(o.row,o.col),i.markEndSource()}},{name:"moveCellSelectionLeft",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(0,-1*e.getDirectionFactor()),t.markEndSource()}},{name:"moveCellSelectionRight",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(0,e.getDirectionFactor()),t.markEndSource()}},{name:"moveCellSelectionToMostBottom",callback(e){let{selection:t}=e,{col:i}=e.getSelectedRangeLast().highlight,r=e.rowIndexMapper.getNearestNotHiddenIndex(e.countRows()-1,-1);null===r&&(r=-1),t.setRangeStart(e._createCellCoords(r,i))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(e){let{selection:t,rowIndexMapper:i,columnIndexMapper:r}=e,n=parseInt(e.getSettings().fixedRowsBottom,10),o=i.getNearestNotHiddenIndex(e.countRows()-n-1,-1),s=r.getNearestNotHiddenIndex(e.countCols()-1,-1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(o,s)),t.markEndSource()}},{name:"moveCellSelectionToMostInlineEnd",callback(e){let{selection:t,columnIndexMapper:i}=e;t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(e.getSelectedRangeLast().highlight.row,i.getNearestNotHiddenIndex(e.countCols()-1,-1))),t.markEndSource()}},{name:"moveCellSelectionToMostInlineStart",callback(e){let{selection:t,columnIndexMapper:i}=e,r=parseInt(e.getSettings().fixedColumnsStart,10),n=e.getSelectedRangeLast().highlight.row,o=i.getNearestNotHiddenIndex(r,1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(n,o)),t.markEndSource()}},{name:"moveCellSelectionToMostLeft",callback(e){let{selection:t,columnIndexMapper:i}=e,r=e.getSelectedRangeLast().highlight.row,n=i.getNearestNotHiddenIndex(...e.isRtl()?[e.countCols()-1,-1]:[0,1]);null===n&&(n=e.isRtl()?-1:-e.countRowHeaders()),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,n)),t.markEndSource()}},{name:"moveCellSelectionToMostRight",callback(e){let{selection:t,columnIndexMapper:i}=e,{row:r}=e.getSelectedRangeLast().highlight,n=i.getNearestNotHiddenIndex(...e.isRtl()?[0,1]:[e.countCols()-1,-1]);null===n&&(n=e.isRtl()?-e.countRowHeaders():-1),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,n)),t.markEndSource()}},{name:"moveCellSelectionToMostTop",callback(e){let{selection:t}=e,{col:i}=e.getSelectedRangeLast().highlight,r=e.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-e.countColHeaders()),t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(r,i)),t.markEndSource()}},{name:"moveCellSelectionToMostTopInlineStart",callback(e){let{selection:t,rowIndexMapper:i,columnIndexMapper:r}=e,n=parseInt(e.getSettings().fixedRowsTop,10),o=parseInt(e.getSettings().fixedColumnsStart,10),s=i.getNearestNotHiddenIndex(n,1),l=r.getNearestNotHiddenIndex(o,1);t.markSource("keyboard"),t.setRangeStart(e._createCellCoords(s,l)),t.markEndSource()}},{name:"moveCellSelectionUp",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.transformStart(-1,0),t.markEndSource()}},{name:"moveCellSelectionUpByViewportHight",callback(e){let{selection:t}=e,{navigableHeaders:i}=e.getSettings(),r=i?e.countColHeaders():0,{row:n}=e.getSelectedRangeLast().highlight,o=e.countVisibleRows()+r;o=0===o?-1:-o,n===-r?o=-1:n+o<r&&(o=-(n+r)),t.markSource("keyboard"),t.transformStart(o,0),t.markEndSource(),e.getSelectedRangeLast().highlight.row<0&&e.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(e){e.emptySelectedCells(),e._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(e){let{highlight:t}=e.getSelectedRangeLast(),i=e.getFirstFullyVisibleRow()-1,r=e.getFirstFullyVisibleColumn()-1,n=e.getLastFullyVisibleRow()+1,o=e.getLastFullyVisibleColumn()+1,s=e._createCellCoords(i,r),l=e._createCellCoords(n,o);if(!e._createCellRange(s,s,l).includes(t)&&(t.row>=0||t.col>=0)){let i={};if(t.col>=0){let r=Math.floor(e.countVisibleCols()/2);i.col=Math.max(t.col-r,0)}if(t.row>=0){let r=Math.floor(e.countVisibleRows()/2);i.row=Math.max(t.row-r,0)}e.scrollViewportTo({...i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.selectAll(!0,!0,{disableHeadersHighlight:!0}),t.markEndSource()}},{name:"selectAllCellsAndHeaders",callback(e){let{selection:t}=e;t.markSource("keyboard"),t.selectAll(!0,!0,{disableHeadersHighlight:!1}),t.markEndSource()}},{name:"populateSelectedCellsData",callback(e){let t=e.getSelectedRange(),{row:i,col:r}=t[t.length-1].highlight.normalize(),n=e.getDataAtCell(i,r),o=new Map;for(let s=0;s<t.length;s++)t[s].forAll((t,s)=>{if(t>=0&&s>=0&&(t!==i||s!==r)){let{readOnly:i}=e.getCellMeta(t,s);i||o.set(`${t}x${s}`,[t,s,n])}});e.setDataAtCell(Array.from(o.values()))}}];function l(e){let t={};return s.forEach(i=>{let{name:r,callback:n}=i;t[r]=function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return n(e,...i)}}),t}function a(e){let t=e.getShortcutManager().addContext("editor"),i=l(e),n={group:r.b};t.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>i.editorCloseAndSaveByEnter(e,t)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(e,t)=>i.editorCloseAndSaveByEnter(e,t)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:(e,t)=>i.editorCloseAndSave(e,t)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(e,t)=>i.editorCloseAndSaveByArrowKeys(e,t)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>i.editorCloseWithoutSaving()}],n)}var h=i(78887);function u(e){let t=e.getShortcutManager().addContext("grid"),i=l(e),n={runOnlyIf:()=>{let{navigableHeaders:t}=e.getSettings();return(0,h.isDefined)(e.getSelected())&&(t||!t&&e.countRenderedRows()>0&&e.countRenderedCols()>0)},group:r.B};t.addShortcuts([{keys:[["F2"]],callback:e=>i.editorFastOpen(e)},{keys:[["Enter"],["Enter","Shift"]],callback:(e,t)=>i.editorOpen(e,t)},{keys:[["Backspace"],["Delete"]],callback:()=>i.emptySelectedCells()}],{group:r.b,runOnlyIf:()=>(0,h.isDefined)(e.getSelected())}),t.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>i.selectAllCells(),runOnlyIf:()=>{var t;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var t;return null===(t=e.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>i.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>i.populateSelectedCellsData(),runOnlyIf:()=>{var t,i;return!(null!==(t=e.getSelectedRangeLast())&&void 0!==t&&t.highlight.isHeader())&&(null===(i=e.getSelectedRangeLast())||void 0===i?void 0:i.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>i.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>i.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>i.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>i.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>i.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>i.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>i.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>i.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>i.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(e.selection.isSelectedByCorner()||e.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>e.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>i.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>i.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>i.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>i.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:e=>i.moveCellSelectionInlineStart(e)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:e=>i.moveCellSelectionInlineEnd(e)},{keys:[["Control/Meta","Backspace"]],callback:()=>i.scrollToFocusedCell()}],n)}function c(e){[u,a].forEach(t=>t(e))}},58331:(e,t,i)=>{"use strict";var r=i(54076),n=i(24771);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("isDisjointFrom",function(e){return!e})},{isDisjointFrom:n})},58958:(e,t,i)=>{"use strict";var r=i(14412),n=i(95467),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,l=n(o,"name"),a=l&&(!r||r&&s(o,"name").configurable);e.exports={EXISTS:l,PROPER:l&&"something"===(function(){}).name,CONFIGURABLE:a}},59149:(e,t,i)=>{"use strict";i.d(t,{Gk:()=>g,L4:()=>h,lY:()=>u,r0:()=>d}),i(41658);var r=i(21413),n=i(99206),o=i(46420),s=i(85917);let{register:l,getItem:a,hasItem:h,getNames:u,getValues:c}=(0,r.A)("cellTypes");function d(e){if(!h(e))throw Error(`You declared cell type "${e}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return a(e)}function g(e,t){"string"!=typeof e&&(e=(t=e).CELL_TYPE);let{editor:i,renderer:r,validator:a}=t;i&&(0,n.VA)(e,i),r&&(0,o.TS)(e,r),a&&(0,s.qV)(e,a),l(e,t)}},59594:(e,t,i)=>{"use strict";i.r(t),i.d(t,{isChrome:()=>u,isChromeWebKit:()=>c,isEdge:()=>p,isEdgeWebKit:()=>m,isFirefox:()=>d,isFirefoxWebKit:()=>g,isIOS:()=>y,isIpadOS:()=>b,isLinuxOS:()=>E,isMacOS:()=>S,isMobileBrowser:()=>w,isSafari:()=>f,isWindowsOS:()=>C,setBrowserMeta:()=>a,setPlatformMeta:()=>h});var r=i(19857),n=i(23544);let o=e=>{let t={value:!1};return t.test=(i,r)=>{t.value=e(i,r)},t},s={chrome:o((e,t)=>/Chrome/.test(e)&&/Google/.test(t)),chromeWebKit:o(e=>/CriOS/.test(e)),edge:o(e=>/Edge/.test(e)),edgeWebKit:o(e=>/EdgiOS/.test(e)),firefox:o(e=>/Firefox/.test(e)),firefoxWebKit:o(e=>/FxiOS/.test(e)),mobile:o(e=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)),safari:o((e,t)=>/Safari/.test(e)&&/Apple Computer/.test(t))},l={mac:o(e=>/^Mac/.test(e)),win:o(e=>/^Win/.test(e)),linux:o(e=>/^Linux/.test(e)),ios:o(e=>/iPhone|iPad|iPod/i.test(e))};function a(){let{userAgent:e=navigator.userAgent,vendor:t=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.objectEach)(s,i=>{let{test:r}=i;r(e,t)})}function h(){let{platform:e=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.objectEach)(l,t=>{let{test:i}=t;i(e)})}function u(){return s.chrome.value}function c(){return s.chromeWebKit.value}function d(){return s.firefox.value}function g(){return s.firefoxWebKit.value}function f(){return s.safari.value}function p(){return s.edge.value}function m(){return s.edgeWebKit.value}function w(){return s.mobile.value}function y(){return l.ios.value}function b(){let{maxTouchPoints:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return e>2&&l.mac.value}function C(){return l.win.value}function S(){return l.mac.value}function E(){return l.linux.value}(0,n.isCSR)()&&(a(),h())},59932:(e,t,i)=>{"use strict";i.d(t,{H:()=>s,N:()=>o}),i(12252),i(85522);var r=i(75708),n=i(95061);function o(e,t,i,n){let o=i.length?i[0]:void 0;return[...e.slice(0,o),...i.map((e,t)=>(0,r.isFunction)(n)?n(e,t):n),...void 0===o?[]:e.slice(o)]}function s(e,t){return(0,n.arrayFilter)(e,(e,i)=>!1===t.includes(i))}},60009:(e,t,i)=>{"use strict";e.exports=!i(56963)(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})},60680:(e,t,i)=>{"use strict";var r=i(76494),n=i(85592),o=i(7107)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"===n(e))}},60695:(e,t,i)=>{"use strict";var r=i(67297),n=i(50320),o=i(8883),s=i(92743),l=i(95283),a=TypeError;e.exports=function(e,t){var i=arguments.length<2?l(e):t;if(n(i))return o(r(i,e));throw new a(s(e)+" is not iterable")}},61101:e=>{"use strict";e.exports=function(e){try{var t=new Set,i=t[e]({size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return t.clear(),t.add(4),function(){return{done:!0}}}})}});return 1!==i.size||4!==i.values().next().value}catch(e){return!1}}},62495:(e,t,i)=>{"use strict";var r=i(98774),n=Function.prototype,o=n.apply,s=n.call;e.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},63241:(e,t,i)=>{var r=function(e){var t=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,r={},n={manual:e.Prism&&e.Prism.manual,disableWorkerMessageHandler:e.Prism&&e.Prism.disableWorkerMessageHandler,util:{encode:function e(t){return t instanceof o?new o(t.type,e(t.content),t.alias):Array.isArray(t)?t.map(e):t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).slice(8,-1)},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++i}),e.__id},clone:function e(t,i){var r,o;switch(i=i||{},n.util.type(t)){case"Object":if(i[o=n.util.objId(t)])return i[o];for(var s in r={},i[o]=r,t)t.hasOwnProperty(s)&&(r[s]=e(t[s],i));return r;case"Array":if(i[o=n.util.objId(t)])return i[o];return r=[],i[o]=r,t.forEach(function(t,n){r[n]=e(t,i)}),r;default:return t}},getLanguage:function(e){for(;e;){var i=t.exec(e.className);if(i)return i[1].toLowerCase();e=e.parentElement}return"none"},setLanguage:function(e,i){e.className=e.className.replace(RegExp(t,"gi"),""),e.classList.add("language-"+i)},currentScript:function(){if("undefined"==typeof document)return null;if(document.currentScript&&"SCRIPT"===document.currentScript.tagName)return document.currentScript;try{throw Error()}catch(r){var e=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(r.stack)||[])[1];if(e){var t=document.getElementsByTagName("script");for(var i in t)if(t[i].src==e)return t[i]}return null}},isActive:function(e,t,i){for(var r="no-"+t;e;){var n=e.classList;if(n.contains(t))return!0;if(n.contains(r))return!1;e=e.parentElement}return!!i}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(e,t){var i=n.util.clone(n.languages[e]);for(var r in t)i[r]=t[r];return i},insertBefore:function(e,t,i,r){var o=(r=r||n.languages)[e],s={};for(var l in o)if(o.hasOwnProperty(l)){if(l==t)for(var a in i)i.hasOwnProperty(a)&&(s[a]=i[a]);i.hasOwnProperty(l)||(s[l]=o[l])}var h=r[e];return r[e]=s,n.languages.DFS(n.languages,function(t,i){i===h&&t!=e&&(this[t]=s)}),s},DFS:function e(t,i,r,o){o=o||{};var s=n.util.objId;for(var l in t)if(t.hasOwnProperty(l)){i.call(t,l,t[l],r||l);var a=t[l],h=n.util.type(a);"Object"!==h||o[s(a)]?"Array"!==h||o[s(a)]||(o[s(a)]=!0,e(a,i,l,o)):(o[s(a)]=!0,e(a,i,null,o))}}},plugins:{},highlightAll:function(e,t){n.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,i){var r={callback:i,container:e,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",r),r.elements=Array.prototype.slice.apply(r.container.querySelectorAll(r.selector)),n.hooks.run("before-all-elements-highlight",r);for(var o,s=0;o=r.elements[s++];)n.highlightElement(o,!0===t,r.callback)},highlightElement:function(t,i,r){var o=n.util.getLanguage(t),s=n.languages[o];n.util.setLanguage(t,o);var l=t.parentElement;l&&"pre"===l.nodeName.toLowerCase()&&n.util.setLanguage(l,o);var a=t.textContent,h={element:t,language:o,grammar:s,code:a};function u(e){h.highlightedCode=e,n.hooks.run("before-insert",h),h.element.innerHTML=h.highlightedCode,n.hooks.run("after-highlight",h),n.hooks.run("complete",h),r&&r.call(h.element)}if(n.hooks.run("before-sanity-check",h),(l=h.element.parentElement)&&"pre"===l.nodeName.toLowerCase()&&!l.hasAttribute("tabindex")&&l.setAttribute("tabindex","0"),!h.code){n.hooks.run("complete",h),r&&r.call(h.element);return}if(n.hooks.run("before-highlight",h),!h.grammar){u(n.util.encode(h.code));return}if(i&&e.Worker){var c=new Worker(n.filename);c.onmessage=function(e){u(e.data)},c.postMessage(JSON.stringify({language:h.language,code:h.code,immediateClose:!0}))}else u(n.highlight(h.code,h.grammar,h.language))},highlight:function(e,t,i){var r={code:e,grammar:t,language:i};if(n.hooks.run("before-tokenize",r),!r.grammar)throw Error('The language "'+r.language+'" has no grammar.');return r.tokens=n.tokenize(r.code,r.grammar),n.hooks.run("after-tokenize",r),o.stringify(n.util.encode(r.tokens),r.language)},tokenize:function(e,t){var i=t.rest;if(i){for(var r in i)t[r]=i[r];delete t.rest}var h=new l;return a(h,h.head,e),function e(t,i,r,l,h,u){for(var c in r)if(r.hasOwnProperty(c)&&r[c]){var d=r[c];d=Array.isArray(d)?d:[d];for(var g=0;g<d.length;++g){if(u&&u.cause==c+","+g)return;var f=d[g],p=f.inside,m=!!f.lookbehind,w=!!f.greedy,y=f.alias;if(w&&!f.pattern.global){var b=f.pattern.toString().match(/[imsuy]*$/)[0];f.pattern=RegExp(f.pattern.source,b+"g")}for(var C=f.pattern||f,S=l.next,E=h;S!==i.tail&&(!u||!(E>=u.reach));E+=S.value.length,S=S.next){var R,T=S.value;if(i.length>t.length)return;if(!(T instanceof o)){var x=1;if(w){if(!(R=s(C,E,t,m))||R.index>=t.length)break;var M=R.index,O=R.index+R[0].length,k=E;for(k+=S.value.length;M>=k;)k+=(S=S.next).value.length;if(k-=S.value.length,E=k,S.value instanceof o)continue;for(var I=S;I!==i.tail&&(k<O||"string"==typeof I.value);I=I.next)x++,k+=I.value.length;x--,T=t.slice(E,k),R.index-=E}else if(!(R=s(C,0,T,m)))continue;var M=R.index,A=R[0],N=T.slice(0,M),H=T.slice(M+A.length),P=E+T.length;u&&P>u.reach&&(u.reach=P);var _=S.prev;if(N&&(_=a(i,_,N),E+=N.length),function(e,t,i){for(var r=t.next,n=0;n<i&&r!==e.tail;n++)r=r.next;t.next=r,r.prev=t,e.length-=n}(i,_,x),S=a(i,_,new o(c,p?n.tokenize(A,p):A,y,A)),H&&a(i,S,H),x>1){var L={cause:c+","+g,reach:P};e(t,i,r,S.prev,E,L),u&&L.reach>u.reach&&(u.reach=L.reach)}}}}}}(e,h,t,h.head,0),function(e){for(var t=[],i=e.head.next;i!==e.tail;)t.push(i.value),i=i.next;return t}(h)},hooks:{all:{},add:function(e,t){var i=n.hooks.all;i[e]=i[e]||[],i[e].push(t)},run:function(e,t){var i=n.hooks.all[e];if(i&&i.length)for(var r,o=0;r=i[o++];)r(t)}},Token:o};function o(e,t,i,r){this.type=e,this.content=t,this.alias=i,this.length=0|(r||"").length}function s(e,t,i,r){e.lastIndex=t;var n=e.exec(i);if(n&&r&&n[1]){var o=n[1].length;n.index+=o,n[0]=n[0].slice(o)}return n}function l(){var e={value:null,prev:null,next:null},t={value:null,prev:e,next:null};e.next=t,this.head=e,this.tail=t,this.length=0}function a(e,t,i){var r=t.next,n={value:i,prev:t,next:r};return t.next=n,r.prev=n,e.length++,n}if(e.Prism=n,o.stringify=function e(t,i){if("string"==typeof t)return t;if(Array.isArray(t)){var r="";return t.forEach(function(t){r+=e(t,i)}),r}var o={type:t.type,content:e(t.content,i),tag:"span",classes:["token",t.type],attributes:{},language:i},s=t.alias;s&&(Array.isArray(s)?Array.prototype.push.apply(o.classes,s):o.classes.push(s)),n.hooks.run("wrap",o);var l="";for(var a in o.attributes)l+=" "+a+'="'+(o.attributes[a]||"").replace(/"/g,"&quot;")+'"';return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+l+">"+o.content+"</"+o.tag+">"},!e.document)return e.addEventListener&&(n.disableWorkerMessageHandler||e.addEventListener("message",function(t){var i=JSON.parse(t.data),r=i.language,o=i.code,s=i.immediateClose;e.postMessage(n.highlight(o,n.languages[r],r)),s&&e.close()},!1)),n;var h=n.util.currentScript();function u(){n.manual||n.highlightAll()}if(h&&(n.filename=h.src,h.hasAttribute("data-manual")&&(n.manual=!0)),!n.manual){var c=document.readyState;"loading"===c||"interactive"===c&&h&&h.defer?document.addEventListener("DOMContentLoaded",u):window.requestAnimationFrame?window.requestAnimationFrame(u):window.setTimeout(u,16)}return n}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});e.exports&&(e.exports=r),void 0!==i.g&&(i.g.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(e,t){var i={};i["language-"+t]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[t]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var n={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};n["language-"+t]={pattern:/[\s\S]+/,inside:r.languages[t]};var o={};o[e]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return e}),"i"),lookbehind:!0,greedy:!0,inside:n},r.languages.insertBefore("markup","cdata",o)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(e,t){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+e+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[t,"language-"+t],inside:r.languages[t]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,function(e){var t=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;e.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+t.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+t.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+t.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+t.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:t,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},e.languages.css.atrule.inside.rest=e.languages.css;var i=e.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source)+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,function(){if(void 0!==r&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var e={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},t="data-src-status",i="loading",n="loaded",o="pre[data-src]:not(["+t+'="'+n+'"]):not(['+t+'="'+i+'"])';r.hooks.add("before-highlightall",function(e){e.selector+=", "+o}),r.hooks.add("before-sanity-check",function(s){var l=s.element;if(l.matches(o)){s.code="",l.setAttribute(t,i);var a,h,u,c,d=l.appendChild(document.createElement("CODE"));d.textContent="Loading";var g=l.getAttribute("data-src"),f=s.language;if("none"===f){var p=(/\.(\w+)$/.exec(g)||[,"none"])[1];f=e[p]||p}r.util.setLanguage(d,f),r.util.setLanguage(l,f);var m=r.plugins.autoloader;m&&m.loadLanguages(f),a=g,h=function(e){l.setAttribute(t,n);var i=function(e){var t=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(e||"");if(t){var i=Number(t[1]),r=t[2],n=t[3];return r?n?[i,Number(n)]:[i,void 0]:[i,i]}}(l.getAttribute("data-range"));if(i){var o=e.split(/\r\n?|\n/g),s=i[0],a=null==i[1]?o.length:i[1];s<0&&(s+=o.length),s=Math.max(0,Math.min(s-1,o.length)),a<0&&(a+=o.length),a=Math.max(0,Math.min(a,o.length)),e=o.slice(s,a).join("\n"),l.hasAttribute("data-start")||l.setAttribute("data-start",String(s+1))}d.textContent=e,r.highlightElement(d)},u=function(e){l.setAttribute(t,"failed"),d.textContent=e},(c=new XMLHttpRequest).open("GET",a,!0),c.onreadystatechange=function(){var e;4==c.readyState&&(c.status<400&&c.responseText?h(c.responseText):c.status>=400?u((e=c.status," Error "+e+" while fetching file: "+c.statusText)):u(" Error: File does not exist or is empty"))},c.send(null)}}),r.plugins.fileHighlight={highlight:function(e){for(var t,i=(e||document).querySelectorAll(o),n=0;t=i[n++];)r.highlightElement(t)}};var s=!1;r.fileHighlight=function(){s||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),s=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}}}()},63462:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("forEach",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(e){l(this);try{s(e)}catch(e){h(this,"throw",e)}if(u)return n(u,this,e);var t=a(this),i=0;o(t,function(t){e(t,i++)},{IS_RECORD:!0})}})},63723:(e,t,i)=>{"use strict";i(37412)},64409:(e,t,i)=>{"use strict";var r=i(48195),n=i(241);e.exports=function(e){var t=r(e,"string");return n(t)?t:t+""}},64571:(e,t,i)=>{"use strict";var r=i(54076),n=i(57272),o=i(50320),s=i(8883),l=i(7475),a=i(76093),h=i(56395),u=i(62495),c=i(56963),d=TypeError,g=c(function(){[].keys().reduce(function(){},void 0)}),f=!g&&h("reduce",d);r({target:"Iterator",proto:!0,real:!0,forced:g||f},{reduce:function(e){s(this);try{o(e)}catch(e){a(this,"throw",e)}var t=arguments.length<2,i=t?void 0:arguments[1];if(f)return u(f,this,t?[e]:[e,i]);var r=l(this),h=0;if(n(r,function(r){t?(t=!1,i=r):i=e(i,r,h),h++},{IS_RECORD:!0}),t)throw new d("Reduce of empty iterator with no initial value");return i}})},64897:(e,t,i)=>{"use strict";var r=i(14412),n=i(67297),o=i(7537),s=i(32138),l=i(13517),a=i(64409),h=i(95467),u=i(24711),c=Object.getOwnPropertyDescriptor;t.f=r?c:function(e,t){if(e=l(e),t=a(t),u)try{return c(e,t)}catch(e){}if(h(e,t))return s(!n(o.f,e,t),e[t])}},65418:(e,t,i)=>{"use strict";var r=i(54076),n=i(93484),o=i(61101);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("union")||!o("union")},{union:n})},65847:(e,t,i)=>{"use strict";var r=i(8496),n=i(76494),o=i(16604),s=i(36096);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,i={};try{(e=r(Object.prototype,"__proto__","set"))(i,[]),t=i instanceof Array}catch(e){}return function(i,r){return o(i),s(r),n(i)&&(t?e(i,r):i.__proto__=r),i}}():void 0)},65911:(e,t,i)=>{"use strict";var r=i(76093);e.exports=function(e,t,i){for(var n=e.length-1;n>=0;n--)if(void 0!==e[n])try{i=r(e[n].iterator,t,i)}catch(e){t="throw",i=e}if("throw"===t)throw i;return i}},66163:(e,t,i)=>{"use strict";var r,n,o,s=i(56963),l=i(99365),a=i(76494),h=i(29440),u=i(16683),c=i(34988),d=i(7107),g=i(72255),f=d("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(n=u(u(o)))!==Object.prototype&&(r=n):p=!0),!a(r)||s(function(){var e={};return r[f].call(e)!==e})?r={}:g&&(r=h(r)),l(r[f])||c(r,f,function(){return this}),e.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},66212:(e,t,i)=>{"use strict";var r=i(42620);e.exports=function(e,t){var i=r[e],n=i&&i.prototype;return n&&n[t]}},66256:(e,t,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(43987).clear;r({global:!0,bind:!0,enumerable:!0,forced:n.clearImmediate!==o},{clearImmediate:o})},66456:(e,t,i)=>{"use strict";var r=i(93840),n=i(33325),o=Math.floor,s=r("".charAt),l=r("".replace),a=r("".slice),h=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;e.exports=function(e,t,i,r,c,d){var g=i+e.length,f=r.length,p=u;return void 0!==c&&(c=n(c),p=h),l(d,p,function(n,l){var h;switch(s(l,0)){case"$":return"$";case"&":return e;case"`":return a(t,0,i);case"'":return a(t,g);case"<":h=c[a(l,1,-1)];break;default:var u=+l;if(0===u)return n;if(u>f){var d=o(u/10);if(0===d)return n;if(d<=f)return void 0===r[d-1]?s(l,1):r[d-1]+s(l,1);return n}h=r[u-1]}return void 0===h?"":h})}},66627:e=>{"use strict";e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},67043:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(50320),s=i(8883),l=i(7475),a=i(31338),h=i(71197),u=i(72255),c=i(76093),d=i(99842),g=i(56395),f=!u&&!d("filter",function(){}),p=!u&&!f&&g("filter",TypeError),m=u||f||p,w=a(function(){for(var e,t,i=this.iterator,r=this.predicate,o=this.next;;){if(e=s(n(o,i)),this.done=!!e.done)return;if(h(i,r,[t=e.value,this.counter++],!0))return t}});r({target:"Iterator",proto:!0,real:!0,forced:m},{filter:function(e){s(this);try{o(e)}catch(e){c(this,"throw",e)}return p?n(p,this,e):new w(l(this),{predicate:e})}})},67297:(e,t,i)=>{"use strict";var r=i(98774),n=Function.prototype.call;e.exports=r?n.bind(n):function(){return n.apply(n,arguments)}},67758:(e,t,i)=>{"use strict";i.d(t,{U:()=>s,j:()=>o}),i(41658),i(19398);var r=i(27704);function n(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let o=50;class s extends r.C{constructor(e){let{calculationTypes:t,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:s,overrideFn:l,inlineStartOffset:a}=e;super(t),n(this,"viewportWidth",0),n(this,"scrollOffset",0),n(this,"zeroBasedScrollOffset",0),n(this,"totalColumns",0),n(this,"columnWidthFn",null),n(this,"columnWidth",0),n(this,"overrideFn",null),n(this,"inlineStartOffset",0),n(this,"totalCalculatedWidth",0),n(this,"startPositions",[]),n(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=l,this.inlineStartOffset=a,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){let t=this.columnWidthFn(e);return isNaN(t)?o:t}}},68804:(e,t,i)=>{"use strict";i.d(t,{A:()=>f}),i(41658);var r=i(79791),n=i(13115),o=i(99206),s=i(57555);function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var h=new WeakSet;class u{constructor(e,t,i){!function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,h),l(this,"hot",void 0),l(this,"tableMeta",void 0),l(this,"selection",void 0),l(this,"eventManager",void 0),l(this,"destroyed",!1),l(this,"activeEditor",void 0),l(this,"cellProperties",void 0),this.hot=e,this.tableMeta=t,this.selection=i,this.eventManager=new s.A(e),this.hot.addHook("afterDocumentKeyDown",e=>a(h,this,c).call(this,e)),this.hot.addHook("beforeCompositionStart",e=>a(h,this,c).call(this,e)),this.hot.view._wt.update("onCellDblClick",(e,t,i)=>a(h,this,d).call(this,e,t,i))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,e=>{e&&this.prepareEditor()});return}let t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!t||t.isHeader())return;let{row:i,col:r}=t,n=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta"),s=i,l=r;if(Array.isArray(n)&&([s,l]=n),this.cellProperties=this.hot.getCellMeta(s,l),!this.isCellEditable()){this.clearActiveEditor();return}let a=this.hot.getCell(i,r,!0);if(a){let e=this.hot.getCellEditor(this.cellProperties),t=this.hot.colToProp(l),n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),l);this.activeEditor=(0,o.L3)(e,this.hot),this.activeEditor.prepare(i,r,t,a,n,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}let r=this.hot.getSelectedRangeLast(),n=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,t,i);if(t instanceof MouseEvent&&"boolean"!=typeof n&&(n=0===this.hot.selection.getLayerLevel()&&r.isSingle()),!1===n){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,t))}closeEditor(e,t,i){this.activeEditor?this.activeEditor.finishEditing(e,t,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let e=this.hot.getSelectedRangeLast();if(!e)return!1;let t=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:n,columnIndexMapper:o}=this.hot,s=n.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(r));return!this.cellProperties.readOnly&&!!t&&!s}moveSelectionAfterEnter(e){let t={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(t.row=-t.row,t.col=-t.col),this.hot.selection.isMultiple()?this.selection.transformFocus(t.row,t.col):this.selection.transformStart(t.row,t.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function c(e){let t=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!t||t.highlight.isHeader()||(0,n.isImmediatePropagationStopped)(e))return;let{keyCode:i}=e,o=(e.ctrlKey||e.metaKey)&&!e.altKey;this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||(0,r.isFunctionKey)(i)||(0,r.isCtrlMetaKey)(i)||o||this.isEditorOpened()||this.openEditor("",e)}function d(e,t){t.isCell()&&this.openEditor(null,e,!0)}let g=new WeakMap;u.getInstance=function(e,t,i){let r=g.get(e);return r||(r=new u(e,t,i),g.set(e,r)),r};let f=u},69607:(e,t,i)=>{"use strict";var r=i(54076),n=i(33325),o=i(94948),s=i(2769),l=i(76144),a=i(42947);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(e){return e instanceof TypeError}}()},{unshift:function(e){var t=n(this),i=o(t),r=arguments.length;if(r){a(i+r);for(var h=i;h--;){var u=h+r;h in t?t[u]=t[h]:l(t,u)}for(var c=0;c<r;c++)t[c]=arguments[c]}return s(t,i+r)}})},69905:(e,t,i)=>{"use strict";var r=i(93840),n=i(6497),o=i(16954),s=o.Set,l=o.proto,a=r(l.forEach),h=r(l.keys),u=h(new s).next;e.exports=function(e,t,i){return i?n({iterator:h(e),next:u},t):a(e,t)}},70527:(e,t,i)=>{"use strict";var r=i(54076),n=i(93840),o=i(16604),s=i(42665),l=i(80763),a=i(56963),h=n("".charAt);r({target:"String",proto:!0,forced:a(function(){return"\uD842"!=="\uD842\uDFB7".at(-2)})},{at:function(e){var t=l(o(this)),i=t.length,r=s(e),n=r>=0?r:i+r;return n<0||n>=i?void 0:h(t,n)}})},71190:(e,t,i)=>{"use strict";i.d(t,{A:()=>h}),i(41658),i(19398);var r=i(73183);function n(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){return e.get(s(e,t))}function s(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var l=new WeakMap;class a{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n(this,"highlight",null),n(this,"from",null),n(this,"to",null),function(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}(this,l,!1),this.highlight=e.clone(),this.from=t.clone(),this.to=i.clone(),function(e,t,i){e.set(s(e,t),i)}(l,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!!(this.from.isHeader()&&this.to.isHeader())||this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let e=Math.max(this.from.row,0),t=Math.max(this.to.row,0);return Math.max(e,t)-Math.min(e,t)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let e=Math.max(this.from.col,0),t=Math.max(this.to.col,0);return Math.max(e,t)-Math.min(e,t)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){let{row:t,col:i}=e,r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return r.row<=t&&n.row>=t&&r.col<=i&&n.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){let t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return(e.row<t.row||e.col<t.col||e.row>i.row||e.col>i.col)&&(this.from=this._createCellCoords(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0)}expandByRange(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this.includesRange(e)||!this.overlaps(e))return!1;let i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=this.getDirection(),o=e.getOuterTopStartCorner(),s=e.getOuterBottomEndCorner(),l=Math.min(i.row,o.row),a=Math.min(i.col,o.col),h=Math.max(r.row,s.row),u=Math.max(r.col,s.col),c=this._createCellCoords(l,a),d=this._createCellCoords(h,u);return this.from=c,this.to=d,this.setDirection(n),t&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return o(l,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return o(l,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return o(l,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return o(l,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return o(l,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return o(l,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return o(l,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return o(l,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){return e instanceof r.A&&(e.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():e.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():e.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():e.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(e){if(!this.includesRange(e))return[];let t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return t.top===i.top&&r.push("top"),t.right===i.right&&r.push(o(l,this)?"left":"right"),t.bottom===i.bottom&&r.push("bottom"),t.left===i.left&&r.push(o(l,this)?"right":"left"),r}getInner(){let e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=t.row;r++)for(let n=e.col;n<=t.col;n++)(this.from.row!==r||this.from.col!==n)&&(this.to.row!==r||this.to.col!==n)&&i.push(this._createCellCoords(r,n));return i}getAll(){let e=this.getOuterTopStartCorner(),t=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=t.row;r++)for(let n=e.col;n<=t.col;n++)e.row===r&&e.col===n?i.push(e):t.row===r&&t.col===n?i.push(t):i.push(this._createCellCoords(r,n));return i}forAll(e){let t=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=t.row;r<=i.row;r++)for(let n=t.col;n<=i.col;n++)if(!1===e(r,n))return}clone(){return new a(this.highlight,this.from,this.to,o(l,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,t){return new r.A(e,t,o(l,this))}}let h=a},71197:(e,t,i)=>{"use strict";var r=i(8883),n=i(76093);e.exports=function(e,t,i,o){try{return o?t(r(i)[0],i[1]):t(i)}catch(t){n(e,"throw",t)}}},71310:(e,t,i)=>{"use strict";var r=i(16954),n=i(69905),o=r.Set,s=r.add;e.exports=function(e){var t=new o;return n(e,function(e){s(t,e)}),t}},72132:(e,t,i)=>{"use strict";var r=i(93840),n=i(99365),o=i(94767),s=r(Function.toString);n(o.inspectSource)||(o.inspectSource=function(e){return s(e)}),e.exports=o.inspectSource},72255:e=>{"use strict";e.exports=!1},72887:(e,t,i)=>{"use strict";var r=i(14412),n=i(9234),o=i(24851),s=i(8883),l=i(13517),a=i(55544);t.f=r&&!n?Object.defineProperties:function(e,t){s(e);for(var i,r=l(t),n=a(t),h=n.length,u=0;h>u;)o.f(e,i=n[u++],r[i]);return e}},72979:(e,t,i)=>{"use strict";var r=i(54076),n=i(33325),o=i(94948),s=i(42665),l=i(81315);r({target:"Array",proto:!0},{at:function(e){var t=n(this),i=o(t),r=s(e),l=r>=0?r:i+r;return l<0||l>=i?void 0:t[l]}}),l("at")},73183:(e,t,i)=>{"use strict";function r(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n(e,t){return e.get(s(e,t))}function o(e,t,i){return e.set(s(e,t),i),i}function s(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}i.d(t,{A:()=>h}),i(41658);var l=new WeakMap;class a{constructor(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,"row",null),r(this,"col",null),function(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}(this,l,!1),o(l,this,i),void 0!==e&&void 0!==t&&(this.row=e,this.col=t)}isValid(e){let{countRows:t,countCols:i,countRowHeaders:r,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!!Number.isInteger(this.row)&&!!Number.isInteger(this.col)&&!(this.row<-n)&&!(this.col<-r)&&!(this.row>=t)&&!(this.col>=i)}isEqual(e){return e===this||this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return n(l,this)}isSouthEastOf(e){return this.row>=e.row&&(n(l,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(n(l,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(n(l,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(n(l,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(null==e?void 0:e.row)&&(this.row=e.row),Number.isInteger(null==e?void 0:e.col)&&(this.col=e.col),e instanceof a&&o(l,this,e.isRtl()),this}clone(){return new a(this.row,this.col,n(l,this))}toObject(){return{row:this.row,col:this.col}}}let h=a},74354:(e,t,i)=>{"use strict";var r=i(85592),n=i(93840);e.exports=function(e){if("Function"===r(e))return n(e)}},75036:(e,t,i)=>{"use strict";i(25737)},75708:(e,t,i)=>{"use strict";i.r(t),i.d(t,{curry:()=>c,curryRight:()=>d,debounce:()=>a,fastCall:()=>g,isFunction:()=>o,partial:()=>u,pipe:()=>h,throttle:()=>s,throttleAfterHits:()=>l});var r=i(95061),n=i(78887);function o(e){return"function"==typeof e}function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=0,r={lastCallThrottled:!0},n=null;return function(){for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];let a=Date.now(),h=!1;r.lastCallThrottled=!0,i||(i=a,h=!0);let u=t-(a-i);return h?(r.lastCallThrottled=!1,e.apply(this,s)):(n&&clearTimeout(n),n=setTimeout(()=>{r.lastCallThrottled=!1,e.apply(this,s),i=0,n=void 0},u)),r}}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=s(e,t),n=i;function o(){for(var t=arguments.length,i=Array(t),o=0;o<t;o++)i[o]=arguments[o];return n?(n-=1,e.apply(this,i)):r.apply(this,i)}return o.clearHits=function(){n=i},o}function a(e){let t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(()=>{t=e.apply(this,o)},i),t}}function h(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[n,...o]=t;return function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return(0,r.arrayReduce)(o,(e,t)=>t(e),n.apply(this,t))}}function u(e){for(var t=arguments.length,i=Array(t>1?t-1:0),r=1;r<t;r++)i[r-1]=arguments[r];return function(){for(var t=arguments.length,r=Array(t),n=0;n<t;n++)r[n]=arguments[n];return e.apply(this,i.concat(r))}}function c(e){let t=e.length;return function i(r){return function(){let n;for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];let a=r.concat(s);return a.length>=t?e.apply(this,a):i(a)}}([])}function d(e){let t=e.length;return function i(r){return function(){let n;for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];let a=r.concat(s.reverse());return a.length>=t?e.apply(this,a):i(a)}}([])}function g(e,t,i,r,o,s,l,a){if((0,n.isDefined)(a))return e.call(t,i,r,o,s,l,a);if((0,n.isDefined)(l))return e.call(t,i,r,o,s,l);if((0,n.isDefined)(s))return e.call(t,i,r,o,s);if((0,n.isDefined)(o))return e.call(t,i,r,o);if((0,n.isDefined)(r))return e.call(t,i,r);else if((0,n.isDefined)(i))return e.call(t,i);return e.call(t)}},76093:(e,t,i)=>{"use strict";var r=i(67297),n=i(8883),o=i(38896);e.exports=function(e,t,i){var s,l;n(e);try{if(!(s=o(e,"return"))){if("throw"===t)throw i;return i}s=r(s,e)}catch(e){l=!0,s=e}if("throw"===t)throw i;if(l)throw s;return n(s),i}},76144:(e,t,i)=>{"use strict";var r=i(92743),n=TypeError;e.exports=function(e,t){if(!delete e[t])throw new n("Cannot delete property "+r(t)+" of "+r(e))}},76494:(e,t,i)=>{"use strict";var r=i(99365);e.exports=function(e){return"object"==typeof e?null!==e:r(e)}},78887:(e,t,i)=>{"use strict";i.r(t),i.d(t,{_injectProductInfo:()=>S,isDefined:()=>s,isEmpty:()=>a,isRegExp:()=>h,isUndefined:()=>l,stringify:()=>o});var r=i(82940),n=i(83457);function o(e){let t;switch(typeof e){case"string":case"number":t=`${e}`;break;case"object":t=null===e?"":e.toString();break;case"undefined":t="";break;default:t=e.toString()}return t}function s(e){return void 0!==e}function l(e){return void 0===e}function a(e){return null===e||""===e||l(e)}function h(e){return"[object RegExp]"===Object.prototype.toString.call(e)}let u="length",c=e=>parseInt(e,16),d=e=>parseInt(e,10),g=(e,t,i)=>e.substr(t,i),f=e=>e.codePointAt(0)-65,p=e=>`${e}`.replace(/\-/g,""),m=e=>c(g(p(e),c("12"),f("F")))/(c(g(p(e),f("B"),~~![][u]))||9),w=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),y=!1,b={invalid:()=>(0,n.O)`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:e=>{let{keyValidityDate:t,hotVersion:i}=e;return(0,n.O)`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${i}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${t}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>(0,n.O)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},C={invalid:()=>(0,n.O)`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:e=>{let{keyValidityDate:t,hotVersion:i}=e;return(0,n.O)`
    The license key for Handsontable expired on ${t}, and is not valid for the installed\x20
    version ${i}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${t}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>(0,n.O)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function S(e,t){let i,n=!a(e),o="string"==typeof e&&"non-commercial-and-evaluation"===e.toLowerCase(),s="15.3.0",l="invalid",h="invalid",S=function(e){let t=[][u],i=t;if(e[u]!==f("Z"))return!1;for(let t="",r="B<H4P+".split(""),n=f(r.shift());n;n=f(r.shift()||"A"))--n<""[u]?i|=(d(`${d(c(t)+(c(g(e,Math.abs(n),2))+[]).padStart(2,"0"))}`)%97||2)>>1:t=g(e,n,n?1===r[u]?9:8:6);return i===t}(e=p(e||""));if(n||o||S)if(S){let t=Math.floor(r("29/04/2025","DD/MM/YYYY").toDate().getTime()/864e5),n=m(e);i=r((n+1)*864e5,"x").format("MMMM DD, YYYY"),t>n?(l="expired",h="expired"):(l="valid",h="valid")}else o?(l="non_commercial",h="valid"):(l="invalid",h="invalid");else l="missing",h="missing";if(w()&&(l="valid",h="valid"),y||"valid"===l||(b[l]({keyValidityDate:i,hotVersion:s})&&console["non_commercial"===l?"info":"warn"](b[l]({keyValidityDate:i,hotVersion:s})),y=!0),"valid"!==h&&t.parentNode&&C[h]({keyValidityDate:i,hotVersion:s})){let e=document.createElement("div");e.className="handsontable hot-display-license-info",e.innerHTML=C[h]({keyValidityDate:i,hotVersion:s}),t.parentNode.insertBefore(e,t.nextSibling)}}},79031:(e,t,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(39615),s=i(8883),l=i(99365),a=i(16683),h=i(47580),u=i(53480),c=i(56963),d=i(95467),g=i(7107),f=i(66163).IteratorPrototype,p=i(14412),m=i(72255),w="constructor",y="Iterator",b=g("toStringTag"),C=TypeError,S=n[y],E=m||!l(S)||S.prototype!==f||!c(function(){S({})}),R=function(){if(o(this,f),a(this)===f)throw new C("Abstract class Iterator not directly constructable")},T=function(e,t){p?h(f,e,{configurable:!0,get:function(){return t},set:function(t){if(s(this),this===f)throw new C("You can't redefine this property");d(this,e)?this[e]=t:u(this,e,t)}}):f[e]=t};d(f,b)||T(b,y),(E||!d(f,w)||f[w]===Object)&&T(w,R),R.prototype=f,r({global:!0,constructor:!0,forced:E},{Iterator:R})},79791:(e,t,i)=>{"use strict";i.r(t),i.d(t,{KEY_CODES:()=>o,isCtrlKey:()=>h,isCtrlMetaKey:()=>u,isFunctionKey:()=>a,isKey:()=>c,isPrintableChar:()=>l}),i(19398);var r=i(95061),n=i(59594);let o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,n.isFirefox)()?182:174,AUDIO_MUTE:(0,n.isFirefox)()?181:173,AUDIO_UP:(0,n.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB];function l(e){return 32===e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90}function a(e){return s.includes(e)}function h(e){let t=[];return(0,n.isMacOS)()?t.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):t.push(o.CONTROL),t.includes(e)}function u(e){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(e)}function c(e,t){let i=t.split("|"),n=!1;return(0,r.arrayEach)(i,t=>{if(e===o[t])return n=!0,!1}),n}},79960:(e,t,i)=>{"use strict";i.d(t,{A:()=>u}),i(41658),i(19398),i(12252),i(20775);var r=i(19857),n=i(15616),o=i(95061),s=i(13455),l=i(75708);function a(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class h{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a(this,"hot",void 0),a(this,"data",void 0),a(this,"dataType","array"),a(this,"colToProp",()=>{}),a(this,"propToCol",()=>{}),this.hot=e,this.data=t}modifyRowData(e){let t;return this.hot.hasHook("modifyRowData")&&(t=this.hot.runHooks("modifyRowData",e)),void 0===t||Number.isInteger(t)?this.data[e]:t}getData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,e):this.data}setData(e){this.data=e}getAtColumn(e){let t=[];return(0,o.arrayEach)(this.data,(i,r)=>{let n=this.getAtCell(r,e);t.push(n)}),t}getAtRow(e,t,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=void 0===t&&void 0===i,{dataDotNotation:a}=this.hot.getSettings(),h=null,u=null;if(Array.isArray(h=this.modifyRowData(e)))u=[],o?h.forEach((t,i)=>{u[i]=this.getAtPhysicalCell(e,i,h)}):(0,s.rangeEach)(t,i,i=>{u[i-t]=this.getAtPhysicalCell(e,i,h)});else if((0,r.isObject)(h)||(0,l.isFunction)(h))if(u=n?[]:{},!o||n){let o=this.countFirstRowKeys()-1;(0,s.rangeEach)(0,o,s=>{let l=this.colToProp(s);if(s>=(t||0)&&s<=(i||o)&&!Number.isInteger(l)){let t=this.getAtPhysicalCell(e,l,h);n?u.push(t):a?(0,r.setProperty)(u,l,t):u[l]=t}})}else(0,r.objectEach)(h,(t,i)=>{let n=this.getAtPhysicalCell(e,i,h);a?(0,r.setProperty)(u,i,n):u[i]=n});return u}setAtCell(e,t,i){if(!(e>=this.countRows()||t>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let n=(0,r.createObjectPropListener)(i);this.hot.runHooks("modifySourceData",e,t,n,"set"),n.isTouched()&&(i=n.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(t)?this.data[e][t]=i:(0,r.setProperty)(this.data[e],t,i))}}getAtPhysicalCell(e,t,i){let n=null;if(i)if("string"==typeof t){let{dataDotNotation:e}=this.hot.getSettings();n=e?(0,r.getProperty)(i,t):i[t]}else n="function"==typeof t?t(i):i[t];if(this.hot.hasHook("modifySourceData")){let i=(0,r.createObjectPropListener)(n);this.hot.runHooks("modifySourceData",e,t,i,"get"),i.isTouched()&&(n=i.value)}return n}getAtCell(e,t){let i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(t),i)}getByRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,n=null,o=null,l=null,a=null;null===e||null===t?(r=!0,n=0,l=this.countRows()-1):(n=Math.min(e.row,t.row),o=Math.min(e.col,t.col),l=Math.max(e.row,t.row),a=Math.max(e.col,t.col));let h=[];return(0,s.rangeEach)(n,l,e=>{h.push(r?this.getAtRow(e,void 0,void 0,i):this.getAtRow(e,o,a,i))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){let e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return(0,n.countFirstRowKeys)(this.data)}destroy(){this.data=null,this.hot=null}}let u=h},80729:(e,t,i)=>{"use strict";var r=i(94272),n=i(16954).has,o=i(57580),s=i(15743),l=i(6497),a=i(76093);e.exports=function(e){var t=r(this),i=s(e);if(o(t)<i.size)return!1;var h=i.getIterator();return!1!==l(h,function(e){if(!n(t,e))return a(h,"normal",!1)})}},80763:(e,t,i)=>{"use strict";var r=i(27764),n=String;e.exports=function(e){if("Symbol"===r(e))throw TypeError("Cannot convert a Symbol value to a string");return n(e)}},81174:(e,t,i)=>{"use strict";i.d(t,{A:()=>s}),i(19398);var r=i(19857),n=i(75708);let o={_localHooks:Object.create(null),addLocalHook(e,t){return this._localHooks[e]||(this._localHooks[e]=[]),this._localHooks[e].push(t),this},runLocalHooks(e,t,i,r,o,s,l){if(this._localHooks[e]){let a=this._localHooks[e].length;for(let h=0;h<a;h++)(0,n.fastCall)(this._localHooks[e][h],this,t,i,r,o,s,l)}},clearLocalHooks(){return this._localHooks={},this}};(0,r.defineGetter)(o,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});let s=o},81315:(e,t,i)=>{"use strict";var r=i(7107),n=i(29440),o=i(24851).f,s=r("unscopables"),l=Array.prototype;void 0===l[s]&&o(l,s,{configurable:!0,value:n(null)}),e.exports=function(e){l[s][e]=!0}},81698:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(93840),s=i(16604),l=i(99365),a=i(76494),h=i(60680),u=i(80763),c=i(38896),d=i(85896),g=i(66456),f=i(7107),p=i(72255),m=f("replace"),w=TypeError,y=o("".indexOf),b=o("".replace),C=o("".slice),S=Math.max;r({target:"String",proto:!0},{replaceAll:function(e,t){var i,r,o,f,E,R,T,x,M,O=s(this),k=0,I="";if(a(e)){if((i=h(e))&&!~y(u(s(d(e))),"g"))throw new w("`.replaceAll` does not allow non-global regexes");if(r=c(e,m))return n(r,e,O,t);if(p&&i)return b(u(O),e,t)}for(o=u(O),f=u(e),(E=l(t))||(t=u(t)),T=S(1,R=f.length),x=y(o,f);-1!==x;)M=E?u(t(f,x,o)):g(f,o,x,[],void 0,t),I+=C(o,k,x)+M,k=x+R,x=x+T>o.length?-1:y(o,f,x+T);return k<o.length&&(I+=C(o,k)),I}})},81938:(e,t,i)=>{"use strict";var r=i(42665),n=Math.max,o=Math.min;e.exports=function(e,t){var i=r(e);return i<0?n(i+t,0):o(i,t)}},82309:(e,t,i)=>{"use strict";var r=i(42620),n=i(99365);e.exports=function(e,t){var i;return arguments.length<2?n(i=r[e])?i:void 0:r[e]&&r[e][t]}},82505:(e,t,i)=>{"use strict";i.d(t,{n:()=>a}),i(41658),i(19398);var r=i(13455),n=i(19857),o=i(75708),s=i(81174);function l(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class a{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(this,"indexedValues",[]),l(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){let t=this.indexedValues;if(e<t.length)return t[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,t){return e<this.indexedValues.length&&(this.indexedValues[e]=t,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,o.isFunction)(this.initValueOrFn)?(0,r.rangeEach)(e-1,e=>this.indexedValues.push(this.initValueOrFn(e))):(0,r.rangeEach)(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,n.mixin)(a,s.A)},82831:(e,t,i)=>{"use strict";var r,n,o,s=i(50344),l=i(42620),a=i(76494),h=i(24201),u=i(95467),c=i(94767),d=i(37889),g=i(4389),f="Object already initialized",p=l.TypeError,m=l.WeakMap;if(s||c.state){var w=c.state||(c.state=new m);w.get=w.get,w.has=w.has,w.set=w.set,r=function(e,t){if(w.has(e))throw new p(f);return t.facade=e,w.set(e,t),t},n=function(e){return w.get(e)||{}},o=function(e){return w.has(e)}}else{var y=d("state");g[y]=!0,r=function(e,t){if(u(e,y))throw new p(f);return t.facade=e,h(e,y,t),t},n=function(e){return u(e,y)?e[y]:{}},o=function(e){return u(e,y)}}e.exports={set:r,get:n,has:o,enforce:function(e){return o(e)?n(e):r(e,{})},getterFor:function(e){return function(t){var i;if(!a(t)||(i=n(t)).type!==e)throw new p("Incompatible receiver, "+e+" required");return i}}}},83072:(e,t,i)=>{"use strict";var r=i(56963),n=i(99365),o=/#|\.prototype\./,s=function(e,t){var i=a[l(e)];return i===u||i!==h&&(n(t)?r(t):!!t)},l=s.normalize=function(e){return String(e).replace(o,".").toLowerCase()},a=s.data={},h=s.NATIVE="N",u=s.POLYFILL="P";e.exports=s},83279:(e,t,i)=>{"use strict";var r=i(93840),n=i(2254),o=i(99365),s=i(85592),l=i(80763),a=r([].push);e.exports=function(e){if(o(e))return e;if(n(e)){for(var t=e.length,i=[],r=0;r<t;r++){var h=e[r];"string"==typeof h?a(i,h):("number"==typeof h||"Number"===s(h)||"String"===s(h))&&a(i,l(h))}var u=i.length,c=!0;return function(e,t){if(c)return c=!1,t;if(n(this))return t;for(var r=0;r<u;r++)if(i[r]===e)return t}}}},83457:(e,t,i)=>{"use strict";i.d(t,{O:()=>n});var r=i(95061);function n(e){for(var t=arguments.length,i=Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];return(0,r.arrayReduce)(e,(e,t,r)=>e+t.replace(/\r?\n\s*/g,"")+(i[r]?i[r]:""),"").trim()}},83869:(e,t,i)=>{"use strict";e.exports="NODE"===i(28060)},83929:(e,t,i)=>{"use strict";i.d(t,{dv:()=>l,fV:()=>n,sM:()=>o});var r=i(52571);class n{constructor(e,t,i={}){var r;this.match=e,this.match=e,this.handler="string"==typeof t?(r=t,function(e,t,i,n){let o=r;if(t[1]){let e=t[0].lastIndexOf(t[1]);o+=t[0].slice(e+t[1].length);let r=(i+=e)-n;r>0&&(o=t[0].slice(e-r,e)+o,i=n)}return e.tr.insertText(o,i,n)}):t,this.undoable=!1!==i.undoable,this.inCode=i.inCode||!1,this.inCodeMark=!1!==i.inCodeMark}}function o({rules:e}){let t=new r.k_({state:{init:()=>null,apply(e,t){let i=e.getMeta(this);return i||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:(i,r,n,o)=>s(i,r,n,o,e,t),handleDOMEvents:{compositionend:i=>{setTimeout(()=>{let{$cursor:r}=i.state.selection;r&&s(i,r.pos,r.pos,"",e,t)})}}},isInputRules:!0});return t}function s(e,t,i,r,n,o){if(e.composing)return!1;let s=e.state,l=s.doc.resolve(t),a=l.parent.textBetween(Math.max(0,l.parentOffset-500),l.parentOffset,null,"")+r;for(let h=0;h<n.length;h++){let u=n[h];if(!u.inCodeMark&&l.marks().some(e=>e.type.spec.code))continue;if(l.parent.type.spec.code){if(!u.inCode)continue}else if("only"===u.inCode)continue;let c=u.match.exec(a),d=c&&c[0].length>=r.length&&u.handler(s,c,t-(c[0].length-r.length),i);if(d)return u.undoable&&d.setMeta(o,{transform:d,from:t,to:i,text:r}),e.dispatch(d),!0}return!1}let l=(e,t)=>{let i=e.plugins;for(let r=0;r<i.length;r++){let n=i[r],o;if(n.spec.isInputRules&&(o=n.getState(e))){if(t){let i=e.tr,r=o.transform;for(let e=r.steps.length-1;e>=0;e--)i.step(r.steps[e].invert(r.docs[e]));if(o.text){let t=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,e.schema.text(o.text,t))}else i.delete(o.from,o.to);t(i)}return!0}}return!1};new n(/--$/,"",{inCodeMark:!1}),new n(/\.\.\.$/,"",{inCodeMark:!1}),new n(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"",{inCodeMark:!1}),new n(/"$/,"",{inCodeMark:!1}),new n(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"",{inCodeMark:!1}),new n(/'$/,"",{inCodeMark:!1})},84122:(e,t,i)=>{"use strict";i.d(t,{J:()=>l}),i(41658),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var r=i(16880),n=i(19857),o=i(75708);function s(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class l{constructor(e){var t=this;s(this,"metaManager",void 0),s(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return t.extendCellMeta(...arguments)}),r.R.getSingleton().add("beforeRender",e=>{e&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var t,i;let{row:r,col:s}=e;if(null!==(t=this.metaSyncMemo.get(r))&&void 0!==t&&t.has(s))return;let{visualRow:l,visualCol:a}=e,h=this.metaManager.hot,u=h.colToProp(a);e.prop=u,h.runHooks("beforeGetCellMeta",l,a,e);let c=(0,n.hasOwnProperty)(e,"type")?e.type:null,d=(0,o.isFunction)(e.cells)?e.cells(r,s,u):null;c&&(d?d.type=null!==(i=d.type)&&void 0!==i?i:c:d={type:c}),d&&this.metaManager.updateCellMeta(r,s,d),h.runHooks("afterGetCellMeta",l,a,e),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(s)}}},84536:(e,t,i)=>{"use strict";i.d(t,{A$:()=>h,DW:()=>l,Jn:()=>a});var r=i(78887),n=i(19857),o=i(57193),s=i(83457);function l(e,t){return(0,n.objectEach)(t,(t,i)=>{(0,r.isUndefined)(e[i])&&(e[i]=t)}),e}function a(e){let t=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(e);return t?`${t[1].toLowerCase()}-${t[2].toUpperCase()}`:e}function h(e){(0,r.isDefined)(e)&&(0,o.z3)((0,s.O)`Language with code "${e}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}},85522:(e,t,i)=>{"use strict";i(56397)},85592:(e,t,i)=>{"use strict";var r=i(93840),n=r({}.toString),o=r("".slice);e.exports=function(e){return o(n(e),8,-1)}},85896:(e,t,i)=>{"use strict";var r=i(67297),n=i(95467),o=i(7411),s=i(4083),l=i(6213),a=RegExp.prototype;e.exports=s.correct?function(e){return e.flags}:function(e){return!s.correct&&o(a,e)&&!n(e,"flags")?r(l,e):e.flags}},85917:(e,t,i)=>{"use strict";i.d(t,{P1:()=>s,by:()=>a,qV:()=>h,tR:()=>o}),i(41658);let{register:r,getItem:n,hasItem:o,getNames:s,getValues:l}=(0,i(21413).A)("validators");function a(e){if("function"==typeof e)return e;if(!o(e))throw Error(`No registered validator found under "${e}" name`);return n(e)}function h(e,t){"string"!=typeof e&&(e=(t=e).VALIDATOR_TYPE),r(e,t)}},86166:(e,t,i)=>{"use strict";var r=i(82309),n=function(e){return{size:e,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},o=function(e){return{size:e,has:function(){return!0},keys:function(){throw Error("e")}}};e.exports=function(e,t){var i=r("Set");try{new i()[e](n(0));try{return new i()[e](n(-1)),!1}catch(r){if(!t)return!0;try{return new i()[e](o(-1/0)),!1}catch(r){var s=new i;return s.add(1),s.add(2),t(s[e](o(1/0)))}}}catch(e){return!1}}},87426:(e,t,i)=>{"use strict";i(81315)("flat")},87699:(e,t,i)=>{"use strict";var r=i(94767);e.exports=function(e,t){return r[e]||(r[e]=t||{})}},88109:(e,t,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(43987).set,s=i(1730),l=n.setImmediate?s(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:n.setImmediate!==l},{setImmediate:l})},88215:(e,t,i)=>{"use strict";i.d(t,{z:()=>a}),i(41658),i(12252),i(85522);var r=i(82505),n=i(59932),o=i(33774),s=i(927),l=i(75708);class a extends r.n{constructor(){super(...arguments),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length&&(this.indexedValues[e]=t,!1===this.orderOfIndexes.includes(e)&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0)}clearValue(e){this.orderOfIndexes=(0,o.H)(this.orderOfIndexes,[e]),(0,l.isFunction)(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,t){this.indexedValues=(0,n.N)(this.indexedValues,e,t,this.initValueOrFn),this.orderOfIndexes=(0,s.z)(this.orderOfIndexes,t),super.insert(e,t)}remove(e){this.indexedValues=(0,n.H)(this.indexedValues,e),this.orderOfIndexes=(0,o.H)(this.orderOfIndexes,e),this.orderOfIndexes=(0,s.v)(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}},88838:(e,t,i)=>{"use strict";var r=i(54076),n=i(41312);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("isSubsetOf",function(e){return e})},{isSubsetOf:n})},89328:(e,t,i)=>{"use strict";i.d(t,{E:()=>l});var r=i(7346),n=i(33787),o=i(91748);function s(e){let t=e.rootDocument.createElement("input");return t.type="text",t.name="__htFocusCatcher",t.classList.add("htFocusCatcher"),e.getSettings().ariaTags&&(0,n.setAttribute)(t,[(0,o.SM)("Focus catcher")]),t}function l(e){var t;let i,n=(t=e,e=>{if(!e)return null;let i=a(t),r=h(t);return e.col<i.col&&(e.col=i.col),e.col>r.col&&(e.col=r.col),e.row<i.row&&(e.row=i.row),e.row>r.row&&(e.row=r.row),e}),{activate:o,deactivate:l}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.rootElement,r=s(e),n=s(e);return r.addEventListener("focus",()=>null==t?void 0:t.onFocusFromTop()),n.addEventListener("focus",()=>null==t?void 0:t.onFocusFromBottom()),i.firstChild.before(r),i.lastChild.after(n),{activate(){e._registerTimeout(()=>{r.tabIndex=0,n.tabIndex=0},10)},deactivate(){e._registerTimeout(()=>{r.tabIndex=-1,n.tabIndex=-1},10)}}}(e,{onFocusFromTop(){var t;let r=null!==(t=n(i))&&void 0!==t?t:a(e);r&&(e.runHooks("modifyFocusOnTabNavigation","from_above",r),e.selectCell(r.row,r.col)),e.listen()},onFocusFromBottom(){var t;let r=null!==(t=n(i))&&void 0!==t?t:h(e);r&&(e.runHooks("modifyFocusOnTabNavigation","from_below",r),e.selectCell(r.row,r.col)),e.listen()}}),u={wrapped:!1,flipped:!1},c=!0,d=!1,g=!1;e.addHook("afterListen",()=>l()),e.addHook("afterUnlisten",()=>o()),e.addHook("afterSelection",(t,r,n,o,s)=>{if(d&&(u.wrapped&&u.flipped||g)&&(g=!1,s.value=!0),c){var l;i=null===(l=e.getSelectedRangeLast())||void 0===l?void 0:l.highlight}}),e.addHook("beforeRowWrap",(e,t,i)=>{u.wrapped=!0,u.flipped=i});let f={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:r.B,group:"focusCatcher"};e.getShortcutManager().getContext("grid").addShortcuts([{...f,callback:()=>{let{tabNavigation:t}=e.getSettings();d=!0,e.getSelectedRangeLast()&&!t&&(c=!1),t||(g=!0)},position:"before"},{...f,callback:t=>{let{tabNavigation:r,autoWrapRow:n}=e.getSettings();if(d=!1,c=!0,!r||!e.selection.isSelected()||n&&u.wrapped&&u.flipped||!n&&u.wrapped)return n&&u.wrapped&&u.flipped&&(i=t.shiftKey?a(e):h(e)),u.wrapped=!1,u.flipped=!1,e.deselectCell(),e.unlisten(),!1;t.preventDefault()},position:"after"}])}function a(e){let{rowIndexMapper:t,columnIndexMapper:i}=e,{navigableHeaders:r}=e.getSettings(),n=r&&e.countColHeaders()>0?-e.countColHeaders():0,o=r&&e.countRowHeaders()>0?-e.countRowHeaders():0;return(0===n&&(n=t.getVisualFromRenderableIndex(n)),0===o&&(o=i.getVisualFromRenderableIndex(o)),null===n||null===o)?null:e._createCellCoords(n,o)}function h(e){var t,i;let{rowIndexMapper:r,columnIndexMapper:n}=e,{navigableHeaders:o}=e.getSettings(),s=r.getRenderableIndexesLength()-1,l=n.getRenderableIndexesLength()-1;if(s<0){if(!o||0===e.countColHeaders())return null;s=-1}if(l<0){if(!o||0===e.countColHeaders())return null;l=-1}return e._createCellCoords(null!==(t=r.getVisualFromRenderableIndex(s))&&void 0!==t?t:s,null!==(i=n.getVisualFromRenderableIndex(l))&&void 0!==i?i:l)}},89364:(e,t,i)=>{"use strict";var r=i(74354),n=i(50320),o=i(98774),s=r(r.bind);e.exports=function(e,t){return n(e),void 0===t?e:o?s(e,t):function(){return e.apply(t,arguments)}}},89658:(e,t,i)=>{"use strict";i.d(t,{u:()=>o}),i(41658),i(12252),i(21591);var r=i(75708);let n=e=>`The id '${e}' is already declared in a map.`;function o(){let{errorIdExists:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=new Map;function i(){return[...t]}function o(e){return t.has(e)}return e=(0,r.isFunction)(e)?e:n,{addItem:function(i,r){if(o(i))throw Error(e(i));t.set(i,r)},clear:function(){t.clear()},getId:function(e){let[t]=i().find(t=>{let[i,r]=t;return e===r&&i})||[null];return t},getItem:function(e){return t.get(e)},getItems:i,hasItem:o,removeItem:function(e){return t.delete(e)}}}},89741:(e,t,i)=>{"use strict";i.d(t,{z:()=>s});var r=i(33787);function n(e){(0,r.isHTMLElement)(e)&&e.scrollIntoView({block:"nearest",inline:"nearest"})}function o(e){let{selection:t,view:i}=e,r=e.getSelectedRangeLast(),n=t.getSelectionSource(),o=i.getFirstFullyVisibleColumn(),s=i.getLastFullyVisibleColumn(),l=r.getTopStartCorner().col,a=r.getBottomEndCorner().col,h=l<=o,u=a>=s,c=i.getFirstFullyVisibleRow(),d=i.getLastFullyVisibleRow(),g=r.getTopStartCorner().row,f=r.getBottomEndCorner().row,p=g<=c,m=f>=d;return{getComputedColumnTarget:e=>"mouse"===n||"keyboard"===n?e.col:h&&u?r.highlight.col:h?l:u?a:e.col,getComputedRowTarget:e=>"mouse"===n||"keyboard"===n?e.row:p&&m?r.highlight.row:p?g:m?f:e.row}}function s(e){let{selection:t}=e,i=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){i=!0},scrollTo(s){var l;let a;if(i||r){i=!1;return}t.isFocusSelectionChanged()?a=t=>{e.scrollViewportTo(t.toObject(),()=>{let{row:t,col:i}=e.getSelectedRangeLast().highlight;n(e.getCell(t,i,!0))})}:t.isSelectedByCorner()?a=()=>{}:t.isSelectedByRowHeader()?a=t=>{let i=o(e).getComputedRowTarget(t);e.scrollViewportTo({row:i},()=>{let t=!!e.getSettings().rowHeaders;n(e.getCell(i,t?-1:0,!0))})}:t.isSelectedByColumnHeader()?a=t=>{let i=o(e).getComputedColumnTarget(t);e.scrollViewportTo({col:i},()=>{let t=!!e.getSettings().colHeaders;n(e.getCell(t?-1:0,i,!0))})}:1===t.getSelectedRange().size()&&t.isMultiple()?a=t=>{let i=o(e),r={row:i.getComputedRowTarget(t),col:i.getComputedColumnTarget(t)};e.scrollViewportTo(r,()=>{let{row:t,col:i}=r;n(e.getCell(t,i,!0))})}:1!==t.getSelectedRange().size()||t.isMultiple()?t.getSelectedRange().size()>1&&(a=t=>{let i=o(e),r={row:i.getComputedRowTarget(t),col:i.getComputedColumnTarget(t)};e.scrollViewportTo(r,()=>{let{row:t,col:i}=r;n(e.getCell(t,i,!0))})}):a=t=>{let i=e.selection.getSelectionSource(),{row:r,col:o}=t,s=()=>{n(e.getCell(r,o,!0))};if(r<0&&o>=0)e.scrollViewportTo({col:o},s);else if(o<0&&r>=0)e.scrollViewportTo({row:r},s);else{if("mouse"===i&&(o===e.view.getLastPartiallyVisibleColumn()||r===e.view.getLastPartiallyVisibleRow()))return;e.scrollViewportTo({row:r,col:o},s)}},null===(l=a)||void 0===l||l(s)}}}},89750:(e,t,i)=>{"use strict";var r=i(54076),n=i(82309),o=i(62495),s=i(67297),l=i(93840),a=i(56963),h=i(99365),u=i(241),c=i(13928),d=i(83279),g=i(11609),f=String,p=n("JSON","stringify"),m=l(/./.exec),w=l("".charAt),y=l("".charCodeAt),b=l("".replace),C=l(1.1.toString),S=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,T=!g||a(function(){var e=n("Symbol")("stringify detection");return"[null]"!==p([e])||"{}"!==p({a:e})||"{}"!==p(Object(e))}),x=a(function(){return'"\udf06\ud834"'!==p("\uDF06\uD834")||'"\udead"'!==p("\uDEAD")}),M=function(e,t){var i=c(arguments),r=d(t);if(!(!h(r)&&(void 0===e||u(e))))return i[1]=function(e,t){if(h(r)&&(t=s(r,this,f(e),t)),!u(t))return t},o(p,null,i)},O=function(e,t,i){var r=w(i,t-1),n=w(i,t+1);return m(E,e)&&!m(R,n)||m(R,e)&&!m(E,r)?"\\u"+C(y(e,0),16):e};p&&r({target:"JSON",stat:!0,arity:3,forced:T||x},{stringify:function(e,t,i){var r=c(arguments),n=o(T?M:p,null,r);return x&&"string"==typeof n?b(n,S,O):n}})},90290:(e,t,i)=>{"use strict";i.d(t,{I$:()=>f,Im:()=>C,RV:()=>k,Ub:()=>p,eT:()=>u,ic:()=>l,pC:()=>d,st:()=>R,wh:()=>E,y_:()=>S});var r,n=i(808),o=i(10156),s=i(52571);let l=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function a(e,t,i=!1){for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(i&&1!=r.childCount)break}return!1}function h(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}let u=(e,t,i)=>{let r=function(e,t){let{$cursor:i}=e.selection;return i&&(t?t.endOfTextblock("forward",e):!(i.parentOffset<i.parent.content.size))?i:null}(e,i);if(!r)return!1;let l=c(r);if(!l)return!1;let h=l.nodeAfter;if(m(e,l,t,1))return!0;if(0==r.parent.content.size&&(a(h,"start")||s.nh.isSelectable(h))){let i=(0,n.$L)(e.doc,r.before(),r.after(),o.Ji.empty);if(i&&i.slice.size<i.to-i.from){if(t){let r=e.tr.step(i);r.setSelection(a(h,"start")?s.LN.findFrom(r.doc.resolve(r.mapping.map(l.pos)),1):s.nh.create(r.doc,r.mapping.map(l.pos))),t(r.scrollIntoView())}return!0}}return!!h.isAtom&&l.depth==r.depth-1&&(t&&t(e.tr.delete(l.pos,l.pos+h.nodeSize).scrollIntoView()),!0)};function c(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let i=e.node(t);if(e.index(t)+1<i.childCount)return e.doc.resolve(e.after(t+1));if(i.type.spec.isolating)break}return null}let d=(e,t)=>{let{$head:i,$anchor:r}=e.selection;return!!(i.parent.type.spec.code&&i.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function g(e){for(let t=0;t<e.edgeCount;t++){let{type:i}=e.edge(t);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}let f=(e,t)=>{let{$head:i,$anchor:r}=e.selection;if(!i.parent.type.spec.code||!i.sameParent(r))return!1;let n=i.node(-1),o=i.indexAfter(-1),l=g(n.contentMatchAt(o));if(!l||!n.canReplaceWith(o,o,l))return!1;if(t){let r=i.after(),n=e.tr.replaceWith(r,r,l.createAndFill());n.setSelection(s.LN.near(n.doc.resolve(r),1)),t(n.scrollIntoView())}return!0},p=(e,t)=>(t&&t(e.tr.setSelection(new s.i5(e.doc))),!0);function m(e,t,i,r){let l,h,u,c=t.nodeBefore,d=t.nodeAfter,g,f,p=c.type.spec.isolating||d.type.spec.isolating;if(!p&&(l=t.nodeBefore,h=t.nodeAfter,u=t.index(),l&&h&&l.type.compatibleContent(h.type)&&(!l.content.size&&t.parent.canReplace(u-1,u)?(i&&i(e.tr.delete(t.pos-l.nodeSize,t.pos).scrollIntoView()),!0):!!(t.parent.canReplace(u,u+1)&&(h.isTextblock||(0,n.n9)(e.doc,t.pos)))&&(i&&i(e.tr.join(t.pos).scrollIntoView()),!0))))return!0;let m=!p&&t.parent.canReplace(t.index(),t.index()+1);if(m&&(g=(f=c.contentMatchAt(c.childCount)).findWrapping(d.type))&&f.matchType(g[0]||d.type).validEnd){if(i){let r=t.pos+d.nodeSize,s=o.FK.empty;for(let e=g.length-1;e>=0;e--)s=o.FK.from(g[e].create(null,s));s=o.FK.from(c.copy(s));let l=e.tr.step(new n.Wg(t.pos-1,r,t.pos,r,new o.Ji(s,1,0),g.length,!0)),a=l.doc.resolve(r+2*g.length);a.nodeAfter&&a.nodeAfter.type==c.type&&(0,n.n9)(l.doc,a.pos)&&l.join(a.pos),i(l.scrollIntoView())}return!0}let w=d.type.spec.isolating||r>0&&p?null:s.LN.findFrom(t,1),y=w&&w.$from.blockRange(w.$to),b=y&&(0,n.jP)(y);if(null!=b&&b>=t.depth)return i&&i(e.tr.lift(y,b).scrollIntoView()),!0;if(m&&a(d,"start",!0)&&a(c,"end")){let r=c,s=[];for(;s.push(r),!r.isTextblock;)r=r.lastChild;let l=d,a=1;for(;!l.isTextblock;l=l.firstChild)a++;if(r.canReplace(r.childCount,r.childCount,l.content)){if(i){let r=o.FK.empty;for(let e=s.length-1;e>=0;e--)r=o.FK.from(s[e].copy(r));i(e.tr.step(new n.Wg(t.pos-s.length,t.pos+d.nodeSize,t.pos+a,t.pos+d.nodeSize-a,new o.Ji(r,s.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function w(e){return function(t,i){let r=t.selection,n=e<0?r.$from:r.$to,o=n.depth;for(;n.node(o).isInline;){if(!o)return!1;o--}return!!n.node(o).isTextblock&&(i&&i(t.tr.setSelection(s.U3.create(t.doc,e<0?n.start(o):n.end(o)))),!0)}}let y=w(-1),b=w(1);function C(e,t=null){return function(i,r){let{$from:o,$to:s}=i.selection,l=o.blockRange(s),a=l&&(0,n.oM)(l,e,t);return!!a&&(r&&r(i.tr.wrap(l,a).scrollIntoView()),!0)}}function S(e,t=null){return function(i,r){let n=!1;for(let r=0;r<i.selection.ranges.length&&!n;r++){let{$from:{pos:o},$to:{pos:s}}=i.selection.ranges[r];i.doc.nodesBetween(o,s,(r,o)=>{if(n)return!1;if(!(!r.isTextblock||r.hasMarkup(e,t)))if(r.type==e)n=!0;else{let t=i.doc.resolve(o),r=t.index();n=t.parent.canReplaceWith(r,r+1,e)}})}if(!n)return!1;if(r){let n=i.tr;for(let r=0;r<i.selection.ranges.length;r++){let{$from:{pos:o},$to:{pos:s}}=i.selection.ranges[r];n.setBlockType(o,s,e,t)}r(n.scrollIntoView())}return!0}}function E(e,t=null,i){let r=!1!==(i&&i.removeWhenPresent),n=!1!==(i&&i.enterInlineAtoms),o=!(i&&i.includeWhitespace);return function(i,l){let{empty:a,$cursor:h,ranges:u}=i.selection;if(a&&!h||!function(e,t,i,r){for(let n=0;n<t.length;n++){let{$from:o,$to:s}=t[n],l=0==o.depth&&e.inlineContent&&e.type.allowsMarkType(i);if(e.nodesBetween(o.pos,s.pos,(e,t)=>{if(l||!r&&e.isAtom&&e.isInline&&t>=o.pos&&t+e.nodeSize<=s.pos)return!1;l=e.inlineContent&&e.type.allowsMarkType(i)}),l)return!0}return!1}(i.doc,u,e,n))return!1;if(l)if(h)l(e.isInSet(i.storedMarks||h.marks())?i.tr.removeStoredMark(e):i.tr.addStoredMark(e.create(t)));else{let a,h=i.tr;n||(u=function(e){let t=[];for(let i=0;i<e.length;i++){let{$from:r,$to:n}=e[i];r.doc.nodesBetween(r.pos,n.pos,(e,i)=>{if(e.isAtom&&e.content.size&&e.isInline&&i>=r.pos&&i+e.nodeSize<=n.pos)return i+1>r.pos&&t.push(new s.yn(r,r.doc.resolve(i+1))),r=r.doc.resolve(i+1+e.content.size),!1}),r.pos<n.pos&&t.push(new s.yn(r,n))}return t}(u)),a=r?!u.some(t=>i.doc.rangeHasMark(t.$from.pos,t.$to.pos,e)):!u.every(t=>{let i=!1;return h.doc.nodesBetween(t.$from.pos,t.$to.pos,(r,n,o)=>{if(i)return!1;i=!e.isInSet(r.marks)&&!!o&&o.type.allowsMarkType(e)&&!(r.isText&&/^\s*$/.test(r.textBetween(Math.max(0,t.$from.pos-n),Math.min(r.nodeSize,t.$to.pos-n))))}),!i});for(let i=0;i<u.length;i++){let{$from:r,$to:n}=u[i];if(a){let i=r.pos,s=n.pos,l=r.nodeAfter,a=n.nodeBefore,u=o&&l&&l.isText?/^\s*/.exec(l.text)[0].length:0,c=o&&a&&a.isText?/\s*$/.exec(a.text)[0].length:0;i+u<s&&(i+=u,s-=c),h.addMark(i,s,e.create(t))}else h.removeMark(r.pos,n.pos,e)}l(h.scrollIntoView())}return!0}}function R(...e){return function(t,i,r){for(let n=0;n<e.length;n++)if(e[n](t,i,r))return!0;return!1}}let T=R(l,(e,t,i)=>{let r=function(e,t){let{$cursor:i}=e.selection;return i&&(t?t.endOfTextblock("backward",e):!(i.parentOffset>0))?i:null}(e,i);if(!r)return!1;let l=h(r);if(!l){let i=r.blockRange(),o=i&&(0,n.jP)(i);return null!=o&&(t&&t(e.tr.lift(i,o).scrollIntoView()),!0)}let u=l.nodeBefore;if(m(e,l,t,-1))return!0;if(0==r.parent.content.size&&(a(u,"end")||s.nh.isSelectable(u)))for(let i=r.depth;;i--){let h=(0,n.$L)(e.doc,r.before(i),r.after(i),o.Ji.empty);if(h&&h.slice.size<h.to-h.from){if(t){let i=e.tr.step(h);i.setSelection(a(u,"end")?s.LN.findFrom(i.doc.resolve(i.mapping.map(l.pos,-1)),-1):s.nh.create(i.doc,l.pos-u.nodeSize)),t(i.scrollIntoView())}return!0}if(1==i||r.node(i-1).childCount>1)break}return!!u.isAtom&&l.depth==r.depth-1&&(t&&t(e.tr.delete(l.pos-u.nodeSize,l.pos).scrollIntoView()),!0)},(e,t,i)=>{let{$head:r,empty:n}=e.selection,o=r;if(!n)return!1;if(r.parent.isTextblock){if(i?!i.endOfTextblock("backward",e):r.parentOffset>0)return!1;o=h(r)}let l=o&&o.nodeBefore;return!!(l&&s.nh.isSelectable(l))&&(t&&t(e.tr.setSelection(s.nh.create(e.doc,o.pos-l.nodeSize)).scrollIntoView()),!0)}),x=R(l,u,(e,t,i)=>{let{$head:r,empty:n}=e.selection,o=r;if(!n)return!1;if(r.parent.isTextblock){if(i?!i.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;o=c(r)}let l=o&&o.nodeAfter;return!!(l&&s.nh.isSelectable(l))&&(t&&t(e.tr.setSelection(s.nh.create(e.doc,o.pos)).scrollIntoView()),!0)}),M={Enter:R(d,(e,t)=>{let i=e.selection,{$from:r,$to:n}=i;if(i instanceof s.i5||r.parent.inlineContent||n.parent.inlineContent)return!1;let o=g(n.parent.contentMatchAt(n.indexAfter()));if(!o||!o.isTextblock)return!1;if(t){let i=(!r.parentOffset&&n.index()<n.parent.childCount?r:n).pos,l=e.tr.insert(i,o.createAndFill());l.setSelection(s.U3.create(l.doc,i+1)),t(l.scrollIntoView())}return!0},(e,t)=>{let{$cursor:i}=e.selection;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){let r=i.before();if((0,n.zy)(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=i.blockRange(),o=r&&(0,n.jP)(r);return null!=o&&(t&&t(e.tr.lift(r,o).scrollIntoView()),!0)},(e,t)=>{let{$from:i,$to:r}=e.selection;if(e.selection instanceof s.nh&&e.selection.node.isBlock)return!!(i.parentOffset&&(0,n.zy)(e.doc,i.pos))&&(t&&t(e.tr.split(i.pos).scrollIntoView()),!0);if(!i.depth)return!1;let o=[],l,a,h=!1,u=!1;for(let e=i.depth;;e--){if(i.node(e).isBlock){let t;h=i.end(e)==i.pos+(i.depth-e),u=i.start(e)==i.pos-(i.depth-e),a=g(i.node(e-1).contentMatchAt(i.indexAfter(e-1)));o.unshift(t||(h&&a?{type:a}:null)),l=e;break}if(1==e)return!1;o.unshift(null)}let c=e.tr;(e.selection instanceof s.U3||e.selection instanceof s.i5)&&c.deleteSelection();let d=c.mapping.map(i.pos),f=(0,n.zy)(c.doc,d,o.length,o);if(f||(o[0]=a?{type:a}:null,f=(0,n.zy)(c.doc,d,o.length,o)),!f)return!1;if(c.split(d,o.length,o),!h&&u&&i.node(l).type!=a){let e=c.mapping.map(i.before(l)),t=c.doc.resolve(e);a&&i.node(l-1).canReplaceWith(t.index(),t.index()+1,a)&&c.setNodeMarkup(c.mapping.map(i.before(l)),a)}return t&&t(c.scrollIntoView()),!0}),"Mod-Enter":f,Backspace:T,"Mod-Backspace":T,"Shift-Backspace":T,Delete:x,"Mod-Delete":x,"Mod-a":p},O={"Ctrl-h":M.Backspace,"Alt-Backspace":M["Mod-Backspace"],"Ctrl-d":M.Delete,"Ctrl-Alt-Backspace":M["Mod-Delete"],"Alt-Delete":M["Mod-Delete"],"Alt-d":M["Mod-Delete"],"Ctrl-a":y,"Ctrl-e":b};for(let e in M)O[e]=M[e];let k=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&!!os.platform&&"darwin"==os.platform())?O:M},91215:(e,t,i)=>{"use strict";var r=i(54076),n=i(57272),o=i(53480);r({target:"Object",stat:!0},{fromEntries:function(e){var t={};return n(e,function(e,i){o(t,e,i)},{AS_ENTRIES:!0}),t}})},91337:e=>{"use strict";e.exports=function(e,t){return{value:e,done:t}}},91615:(e,t,i)=>{"use strict";var r=i(24201),n=i(40949),o=i(34175),s=Error.captureStackTrace;e.exports=function(e,t,i,l){o&&(s?s(e,t):r(e,"stack",n(i,l)))}},91748:(e,t,i)=>{"use strict";i.d(t,{$o:()=>p,B6:()=>f,D9:()=>b,DY:()=>j,DZ:()=>M,H0:()=>L,Jg:()=>h,Ku:()=>F,L2:()=>y,L4:()=>T,MG:()=>E,Nb:()=>O,Nf:()=>l,PF:()=>P,Pk:()=>w,Qg:()=>k,S2:()=>W,SM:()=>S,Sb:()=>u,VN:()=>V,Vy:()=>z,Xq:()=>_,ZA:()=>d,ZW:()=>C,_R:()=>R,_h:()=>N,ax:()=>n,dV:()=>A,g:()=>s,gg:()=>o,gq:()=>D,n:()=>m,nF:()=>c,pt:()=>g,rE:()=>B,t0:()=>a,u8:()=>H,vC:()=>r,wD:()=>I,wP:()=>x});let r=e=>["tabindex",e],n=()=>["role","treegrid"],o=()=>["role","presentation"],s=()=>["role","gridcell"],l=()=>["role","rowheader"],a=()=>["role","rowgroup"],h=()=>["role","columnheader"],u=()=>["role","row"],c=()=>["role","menu"],d=()=>["role","menuitem"],g=()=>["role","menuitemcheckbox"],f=()=>["role","combobox"],p=()=>["role","listbox"],m=()=>["role","option"],w=()=>["role","checkbox"],y=()=>["scope","col"],b=()=>["scope","row"],C=()=>["type","text"],S=e=>["aria-label",e],E=()=>["aria-hidden","true"],R=()=>["aria-disabled","true"],T=()=>["aria-multiselectable","true"],x=e=>["aria-haspopup",e],M=e=>["aria-rowcount",e],O=e=>["aria-colcount",e],k=e=>["aria-rowindex",e],I=e=>["aria-colindex",e],A=e=>["aria-expanded",e],N=e=>["aria-sort",e],H=()=>["aria-readonly","true"],P=()=>["aria-invalid","true"],_=e=>["aria-checked",e],L=()=>["aria-selected","true"],D=()=>["aria-autocomplete","list"],F=e=>["aria-controls",e],V=e=>["aria-activedescendant",e],W=e=>["aria-live",e],B=e=>["aria-relevant",e],j=e=>["aria-setsize",e],z=e=>["aria-posinset",e]},91826:(e,t,i)=>{"use strict";i.d(t,{E6:()=>r,Hb:()=>l,LX:()=>o,OS:()=>u,PP:()=>n,QP:()=>h,Yt:()=>s,_8:()=>a});let r="active-header",n="header",o="area",s="focus",l="fill",a="row",h="column",u="custom-selection"},92743:e=>{"use strict";var t=String;e.exports=function(e){try{return t(e)}catch(e){return"Object"}}},93277:(e,t,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(50320),s=i(8883),l=i(7475),a=i(38516),h=i(31338),u=i(76093),c=i(72255),d=i(99842),g=i(56395),f=!c&&!d("flatMap",function(){}),p=!c&&!f&&g("flatMap",TypeError),m=c||f||p,w=h(function(){for(var e,t,i=this.iterator,r=this.mapper;;){if(t=this.inner)try{if(!(e=s(n(t.next,t.iterator))).done)return e.value;this.inner=null}catch(e){u(i,"throw",e)}if(e=s(n(this.next,i)),this.done=!!e.done)return;try{this.inner=a(r(e.value,this.counter++),!1)}catch(e){u(i,"throw",e)}}});r({target:"Iterator",proto:!0,real:!0,forced:m},{flatMap:function(e){s(this);try{o(e)}catch(e){u(this,"throw",e)}return p?n(p,this,e):new w(l(this),{mapper:e,inner:null})}})},93484:(e,t,i)=>{"use strict";var r=i(94272),n=i(16954).add,o=i(71310),s=i(15743),l=i(6497);e.exports=function(e){var t=r(this),i=s(e).getIterator(),a=o(t);return l(i,function(e){n(a,e)}),a}},93840:(e,t,i)=>{"use strict";var r=i(98774),n=Function.prototype,o=n.call,s=r&&n.bind.bind(o,o);e.exports=r?s:function(e){return function(){return o.apply(e,arguments)}}},93924:(e,t,i)=>{"use strict";i.r(t),i.d(t,{equalsIgnoreCase:()=>es,isPercentValue:()=>ea,randomString:()=>el,sanitize:()=>ec,stripTags:()=>eu,substitute:()=>eh,toUpperCaseFirst:()=>eo}),i(19398);let{entries:r,setPrototypeOf:n,isFrozen:o,getPrototypeOf:s,getOwnPropertyDescriptor:l}=Object,{freeze:a,seal:h,create:u}=Object,{apply:c,construct:d}="undefined"!=typeof Reflect&&Reflect;a||(a=function(e){return e}),h||(h=function(e){return e}),c||(c=function(e,t,i){return e.apply(t,i)}),d||(d=function(e,t){return new e(...t)});let g=O(Array.prototype.forEach),f=O(Array.prototype.lastIndexOf),p=O(Array.prototype.pop),m=O(Array.prototype.push),w=O(Array.prototype.splice),y=O(String.prototype.toLowerCase),b=O(String.prototype.toString),C=O(String.prototype.match),S=O(String.prototype.replace),E=O(String.prototype.indexOf),R=O(String.prototype.trim),T=O(Object.prototype.hasOwnProperty),x=O(RegExp.prototype.test),M=(Z=TypeError,function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return d(Z,t)});function O(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return c(e,t,r)}}function k(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;n&&n(e,null);let r=t.length;for(;r--;){let n=t[r];if("string"==typeof n){let e=i(n);e!==n&&(o(t)||(t[r]=e),n=e)}e[n]=!0}return e}function I(e){let t=u(null);for(let[i,n]of r(e))T(e,i)&&(Array.isArray(n)?t[i]=function(e){for(let t=0;t<e.length;t++)T(e,t)||(e[t]=null);return e}(n):n&&"object"==typeof n&&n.constructor===Object?t[i]=I(n):t[i]=n);return t}function A(e,t){for(;null!==e;){let i=l(e,t);if(i){if(i.get)return O(i.get);if("function"==typeof i.value)return O(i.value)}e=s(e)}return function(){return null}}let N=a(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),H=a(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),P=a(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_=a(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),L=a(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),D=a(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=a(["#text"]),V=a(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),W=a(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B=a(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),j=a(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=h(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U=h(/<%[\w\W]*|[\w\W]*%>/gm),$=h(/\$\{[\w\W]*/gm),G=h(/^data-[\-\w.\u00B7-\uFFFF]+$/),Y=h(/^aria-[\-\w]+$/),K=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=h(/^(?:\w+script|data):/i),q=h(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),J=h(/^html$/i);var Z,Q=Object.freeze({__proto__:null,ARIA_ATTR:Y,ATTR_WHITESPACE:q,CUSTOM_ELEMENT:h(/^[a-z][.\w]*(-[.\w]+)+$/i),DATA_ATTR:G,DOCTYPE_NAME:J,ERB_EXPR:U,IS_ALLOWED_URI:K,IS_SCRIPT_OR_DATA:X,MUSTACHE_EXPR:z,TMPLIT_EXPR:$});let ee={element:1,text:3,progressingInstruction:7,comment:8,document:9},et=function(e,t){if("object"!=typeof e||"function"!=typeof e.createPolicy)return null;let i=null,r="data-tt-policy-suffix";t&&t.hasAttribute(r)&&(i=t.getAttribute(r));let n="dompurify"+(i?"#"+i:"");try{return e.createPolicy(n,{createHTML:e=>e,createScriptURL:e=>e})}catch(e){return console.warn("TrustedTypes policy "+n+" could not be created."),null}},ei=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};var er=function e(){let t,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,n=t=>e(t);if(n.version="3.2.6",n.removed=[],!i||!i.document||i.document.nodeType!==ee.document||!i.Element)return n.isSupported=!1,n;let{document:o}=i,s=o,l=s.currentScript,{DocumentFragment:h,HTMLTemplateElement:c,Node:d,Element:O,NodeFilter:z,NamedNodeMap:U=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:$,DOMParser:G,trustedTypes:Y}=i,X=O.prototype,q=A(X,"cloneNode"),Z=A(X,"remove"),er=A(X,"nextSibling"),en=A(X,"childNodes"),eo=A(X,"parentNode");if("function"==typeof c){let e=o.createElement("template");e.content&&e.content.ownerDocument&&(o=e.content.ownerDocument)}let es="",{implementation:el,createNodeIterator:ea,createDocumentFragment:eh,getElementsByTagName:eu}=o,{importNode:ec}=s,ed=ei();n.isSupported="function"==typeof r&&"function"==typeof eo&&el&&void 0!==el.createHTMLDocument;let{MUSTACHE_EXPR:eg,ERB_EXPR:ef,TMPLIT_EXPR:ep,DATA_ATTR:em,ARIA_ATTR:ew,IS_SCRIPT_OR_DATA:ey,ATTR_WHITESPACE:ev,CUSTOM_ELEMENT:eb}=Q,{IS_ALLOWED_URI:eC}=Q,eS=null,eE=k({},[...N,...H,...P,...L,...F]),eR=null,eT=k({},[...V,...W,...B,...j]),ex=Object.seal(u(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),eM=null,eO=null,ek=!0,eI=!0,eA=!1,eN=!0,eH=!1,eP=!0,e_=!1,eL=!1,eD=!1,eF=!1,eV=!1,eW=!1,eB=!0,ej=!1,ez=!0,eU=!1,e$={},eG=null,eY=k({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),eK=null,eX=k({},["audio","video","img","source","image","track"]),eq=null,eJ=k({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),eZ="http://www.w3.org/1998/Math/MathML",eQ="http://www.w3.org/2000/svg",e0="http://www.w3.org/1999/xhtml",e1=e0,e2=!1,e3=null,e5=k({},[eZ,eQ,e0],b),e9=k({},["mi","mo","mn","ms","mtext"]),e8=k({},["annotation-xml"]),e4=k({},["title","style","font","a","script"]),e7=null,e6=["application/xhtml+xml","text/html"],te=null,tt=null,ti=o.createElement("form"),tr=function(e){return e instanceof RegExp||e instanceof Function},tn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!tt||tt!==e){if(e&&"object"==typeof e||(e={}),e=I(e),te="application/xhtml+xml"===(e7=-1===e6.indexOf(e.PARSER_MEDIA_TYPE)?"text/html":e.PARSER_MEDIA_TYPE)?b:y,eS=T(e,"ALLOWED_TAGS")?k({},e.ALLOWED_TAGS,te):eE,eR=T(e,"ALLOWED_ATTR")?k({},e.ALLOWED_ATTR,te):eT,e3=T(e,"ALLOWED_NAMESPACES")?k({},e.ALLOWED_NAMESPACES,b):e5,eq=T(e,"ADD_URI_SAFE_ATTR")?k(I(eJ),e.ADD_URI_SAFE_ATTR,te):eJ,eK=T(e,"ADD_DATA_URI_TAGS")?k(I(eX),e.ADD_DATA_URI_TAGS,te):eX,eG=T(e,"FORBID_CONTENTS")?k({},e.FORBID_CONTENTS,te):eY,eM=T(e,"FORBID_TAGS")?k({},e.FORBID_TAGS,te):I({}),eO=T(e,"FORBID_ATTR")?k({},e.FORBID_ATTR,te):I({}),e$=!!T(e,"USE_PROFILES")&&e.USE_PROFILES,ek=!1!==e.ALLOW_ARIA_ATTR,eI=!1!==e.ALLOW_DATA_ATTR,eA=e.ALLOW_UNKNOWN_PROTOCOLS||!1,eN=!1!==e.ALLOW_SELF_CLOSE_IN_ATTR,eH=e.SAFE_FOR_TEMPLATES||!1,eP=!1!==e.SAFE_FOR_XML,e_=e.WHOLE_DOCUMENT||!1,eF=e.RETURN_DOM||!1,eV=e.RETURN_DOM_FRAGMENT||!1,eW=e.RETURN_TRUSTED_TYPE||!1,eD=e.FORCE_BODY||!1,eB=!1!==e.SANITIZE_DOM,ej=e.SANITIZE_NAMED_PROPS||!1,ez=!1!==e.KEEP_CONTENT,eU=e.IN_PLACE||!1,eC=e.ALLOWED_URI_REGEXP||K,e1=e.NAMESPACE||e0,e9=e.MATHML_TEXT_INTEGRATION_POINTS||e9,e8=e.HTML_INTEGRATION_POINTS||e8,ex=e.CUSTOM_ELEMENT_HANDLING||{},e.CUSTOM_ELEMENT_HANDLING&&tr(e.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ex.tagNameCheck=e.CUSTOM_ELEMENT_HANDLING.tagNameCheck),e.CUSTOM_ELEMENT_HANDLING&&tr(e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ex.attributeNameCheck=e.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),e.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(ex.allowCustomizedBuiltInElements=e.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),eH&&(eI=!1),eV&&(eF=!0),e$&&(eS=k({},F),eR=[],!0===e$.html&&(k(eS,N),k(eR,V)),!0===e$.svg&&(k(eS,H),k(eR,W),k(eR,j)),!0===e$.svgFilters&&(k(eS,P),k(eR,W),k(eR,j)),!0===e$.mathMl&&(k(eS,L),k(eR,B),k(eR,j))),e.ADD_TAGS&&(eS===eE&&(eS=I(eS)),k(eS,e.ADD_TAGS,te)),e.ADD_ATTR&&(eR===eT&&(eR=I(eR)),k(eR,e.ADD_ATTR,te)),e.ADD_URI_SAFE_ATTR&&k(eq,e.ADD_URI_SAFE_ATTR,te),e.FORBID_CONTENTS&&(eG===eY&&(eG=I(eG)),k(eG,e.FORBID_CONTENTS,te)),ez&&(eS["#text"]=!0),e_&&k(eS,["html","head","body"]),eS.table&&(k(eS,["tbody"]),delete eM.tbody),e.TRUSTED_TYPES_POLICY){if("function"!=typeof e.TRUSTED_TYPES_POLICY.createHTML)throw M('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof e.TRUSTED_TYPES_POLICY.createScriptURL)throw M('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');es=(t=e.TRUSTED_TYPES_POLICY).createHTML("")}else void 0===t&&(t=et(Y,l)),null!==t&&"string"==typeof es&&(es=t.createHTML(""));a&&a(e),tt=e}},to=k({},[...H,...P,..._]),ts=k({},[...L,...D]),tl=function(e){let t=eo(e);t&&t.tagName||(t={namespaceURI:e1,tagName:"template"});let i=y(e.tagName),r=y(t.tagName);return!!e3[e.namespaceURI]&&(e.namespaceURI===eQ?t.namespaceURI===e0?"svg"===i:t.namespaceURI===eZ?"svg"===i&&("annotation-xml"===r||e9[r]):!!to[i]:e.namespaceURI===eZ?t.namespaceURI===e0?"math"===i:t.namespaceURI===eQ?"math"===i&&e8[r]:!!ts[i]:e.namespaceURI===e0?(t.namespaceURI!==eQ||!!e8[r])&&(t.namespaceURI!==eZ||!!e9[r])&&!ts[i]&&(e4[i]||!to[i]):"application/xhtml+xml"===e7&&!!e3[e.namespaceURI])},ta=function(e){m(n.removed,{element:e});try{eo(e).removeChild(e)}catch(t){Z(e)}},th=function(e,t){try{m(n.removed,{attribute:t.getAttributeNode(e),from:t})}catch(e){m(n.removed,{attribute:null,from:t})}if(t.removeAttribute(e),"is"===e)if(eF||eV)try{ta(t)}catch(e){}else try{t.setAttribute(e,"")}catch(e){}},tu=function(e){let i=null,r=null;if(eD)e="<remove></remove>"+e;else{let t=C(e,/^[\r\n\t ]+/);r=t&&t[0]}"application/xhtml+xml"===e7&&e1===e0&&(e='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+e+"</body></html>");let n=t?t.createHTML(e):e;if(e1===e0)try{i=new G().parseFromString(n,e7)}catch(e){}if(!i||!i.documentElement){i=el.createDocument(e1,"template",null);try{i.documentElement.innerHTML=e2?es:n}catch(e){}}let s=i.body||i.documentElement;return(e&&r&&s.insertBefore(o.createTextNode(r),s.childNodes[0]||null),e1===e0)?eu.call(i,e_?"html":"body")[0]:e_?i.documentElement:s},tc=function(e){return ea.call(e.ownerDocument||e,e,z.SHOW_ELEMENT|z.SHOW_COMMENT|z.SHOW_TEXT|z.SHOW_PROCESSING_INSTRUCTION|z.SHOW_CDATA_SECTION,null)},td=function(e){return e instanceof $&&("string"!=typeof e.nodeName||"string"!=typeof e.textContent||"function"!=typeof e.removeChild||!(e.attributes instanceof U)||"function"!=typeof e.removeAttribute||"function"!=typeof e.setAttribute||"string"!=typeof e.namespaceURI||"function"!=typeof e.insertBefore||"function"!=typeof e.hasChildNodes)},tg=function(e){return"function"==typeof d&&e instanceof d};function tf(e,t,i){g(e,e=>{e.call(n,t,i,tt)})}let tp=function(e){let t=null;if(tf(ed.beforeSanitizeElements,e,null),td(e))return ta(e),!0;let i=te(e.nodeName);if(tf(ed.uponSanitizeElement,e,{tagName:i,allowedTags:eS}),eP&&e.hasChildNodes()&&!tg(e.firstElementChild)&&x(/<[/\w!]/g,e.innerHTML)&&x(/<[/\w!]/g,e.textContent)||e.nodeType===ee.progressingInstruction||eP&&e.nodeType===ee.comment&&x(/<[/\w]/g,e.data))return ta(e),!0;if(!eS[i]||eM[i]){if(!eM[i]&&tw(i)&&(ex.tagNameCheck instanceof RegExp&&x(ex.tagNameCheck,i)||ex.tagNameCheck instanceof Function&&ex.tagNameCheck(i)))return!1;if(ez&&!eG[i]){let t=eo(e)||e.parentNode,i=en(e)||e.childNodes;if(i&&t){let r=i.length;for(let n=r-1;n>=0;--n){let r=q(i[n],!0);r.__removalCount=(e.__removalCount||0)+1,t.insertBefore(r,er(e))}}}return ta(e),!0}return e instanceof O&&!tl(e)||("noscript"===i||"noembed"===i||"noframes"===i)&&x(/<\/no(script|embed|frames)/i,e.innerHTML)?(ta(e),!0):(eH&&e.nodeType===ee.text&&(t=e.textContent,g([eg,ef,ep],e=>{t=S(t,e," ")}),e.textContent!==t&&(m(n.removed,{element:e.cloneNode()}),e.textContent=t)),tf(ed.afterSanitizeElements,e,null),!1)},tm=function(e,t,i){if(eB&&("id"===t||"name"===t)&&(i in o||i in ti))return!1;if(eI&&!eO[t]&&x(em,t));else if(ek&&x(ew,t));else if(!eR[t]||eO[t]){if(!(tw(e)&&(ex.tagNameCheck instanceof RegExp&&x(ex.tagNameCheck,e)||ex.tagNameCheck instanceof Function&&ex.tagNameCheck(e))&&(ex.attributeNameCheck instanceof RegExp&&x(ex.attributeNameCheck,t)||ex.attributeNameCheck instanceof Function&&ex.attributeNameCheck(t))||"is"===t&&ex.allowCustomizedBuiltInElements&&(ex.tagNameCheck instanceof RegExp&&x(ex.tagNameCheck,i)||ex.tagNameCheck instanceof Function&&ex.tagNameCheck(i))))return!1}else if(eq[t]);else if(x(eC,S(i,ev,"")));else if(("src"===t||"xlink:href"===t||"href"===t)&&"script"!==e&&0===E(i,"data:")&&eK[e]);else if(eA&&!x(ey,S(i,ev,"")));else if(i)return!1;return!0},tw=function(e){return"annotation-xml"!==e&&C(e,eb)},ty=function(e){tf(ed.beforeSanitizeAttributes,e,null);let{attributes:i}=e;if(!i||td(e))return;let r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:eR,forceKeepAttr:void 0},o=i.length;for(;o--;){let{name:s,namespaceURI:l,value:a}=i[o],h=te(s),u="value"===s?a:R(a);if(r.attrName=h,r.attrValue=u,r.keepAttr=!0,r.forceKeepAttr=void 0,tf(ed.uponSanitizeAttribute,e,r),u=r.attrValue,ej&&("id"===h||"name"===h)&&(th(s,e),u="user-content-"+u),eP&&x(/((--!?|])>)|<\/(style|title)/i,u)){th(s,e);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr||!eN&&x(/\/>/i,u)){th(s,e);continue}eH&&g([eg,ef,ep],e=>{u=S(u,e," ")});let c=te(e.nodeName);if(!tm(c,h,u)){th(s,e);continue}if(t&&"object"==typeof Y&&"function"==typeof Y.getAttributeType)if(l);else switch(Y.getAttributeType(c,h)){case"TrustedHTML":u=t.createHTML(u);break;case"TrustedScriptURL":u=t.createScriptURL(u)}if(u!==a)try{l?e.setAttributeNS(l,s,u):e.setAttribute(s,u),td(e)?ta(e):p(n.removed)}catch(t){th(s,e)}}tf(ed.afterSanitizeAttributes,e,null)},tv=function e(t){let i=null,r=tc(t);for(tf(ed.beforeSanitizeShadowDOM,t,null);i=r.nextNode();)tf(ed.uponSanitizeShadowNode,i,null),tp(i),ty(i),i.content instanceof h&&e(i.content);tf(ed.afterSanitizeShadowDOM,t,null)};return n.sanitize=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null,l=null,a=null;if((e2=!e)&&(e="\x3c!--\x3e"),"string"!=typeof e&&!tg(e))if("function"==typeof e.toString){if("string"!=typeof(e=e.toString()))throw M("dirty is not a string, aborting")}else throw M("toString is not a function");if(!n.isSupported)return e;if(eL||tn(i),n.removed=[],"string"==typeof e&&(eU=!1),eU){if(e.nodeName){let t=te(e.nodeName);if(!eS[t]||eM[t])throw M("root node is forbidden and cannot be sanitized in-place")}}else if(e instanceof d)(o=(r=tu("\x3c!----\x3e")).ownerDocument.importNode(e,!0)).nodeType===ee.element&&"BODY"===o.nodeName?r=o:"HTML"===o.nodeName?r=o:r.appendChild(o);else{if(!eF&&!eH&&!e_&&-1===e.indexOf("<"))return t&&eW?t.createHTML(e):e;if(!(r=tu(e)))return eF?null:eW?es:""}r&&eD&&ta(r.firstChild);let u=tc(eU?e:r);for(;l=u.nextNode();)tp(l),ty(l),l.content instanceof h&&tv(l.content);if(eU)return e;if(eF){if(eV)for(a=eh.call(r.ownerDocument);r.firstChild;)a.appendChild(r.firstChild);else a=r;return(eR.shadowroot||eR.shadowrootmode)&&(a=ec.call(s,a,!0)),a}let c=e_?r.outerHTML:r.innerHTML;return e_&&eS["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&x(J,r.ownerDocument.doctype.name)&&(c="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+c),eH&&g([eg,ef,ep],e=>{c=S(c,e," ")}),t&&eW?t.createHTML(c):c},n.setConfig=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};tn(e),eL=!0},n.clearConfig=function(){tt=null,eL=!1},n.isValidAttribute=function(e,t,i){return tt||tn({}),tm(te(e),te(t),i)},n.addHook=function(e,t){"function"==typeof t&&m(ed[e],t)},n.removeHook=function(e,t){if(void 0!==t){let i=f(ed[e],t);return -1===i?void 0:w(ed[e],i,1)[0]}return p(ed[e])},n.removeHooks=function(e){ed[e]=[]},n.removeAllHooks=function(){ed=ei()},n}(),en=i(78887);function eo(e){return e[0].toUpperCase()+e.substr(1)}function es(){let e=[];for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];let n=i.length;for(;n;){n-=1;let t=(0,en.stringify)(i[n]).toLowerCase();-1===e.indexOf(t)&&e.push(t)}return 1===e.length}function el(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+e()+e()}function ea(e){return/^([0-9][0-9]?%$)|(^100%$)/.test(e)}function eh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${e}`.replace(/(?:\\)?\[([^[\]]+)]/g,(e,i)=>"\\"===e.charAt(0)?e.substr(1,e.length-1):void 0===t[i]?"":t[i])}function eu(e){return ec(`${e}`,{ALLOWED_TAGS:[]})}function ec(e,t){return er.sanitize(e,t)}},94094:(e,t,i)=>{"use strict";var r=i(54076),n=i(1416),o=i(61101);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("symmetricDifference")||!o("symmetricDifference")},{symmetricDifference:n})},94272:(e,t,i)=>{"use strict";var r=i(16954).has;e.exports=function(e){return r(e),e}},94767:(e,t,i)=>{"use strict";var r=i(72255),n=i(42620),o=i(7687),s="__core-js_shared__",l=e.exports=n[s]||o(s,{});(l.versions||(l.versions=[])).push({version:"3.43.0",mode:r?"pure":"global",copyright:"\xa9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"})},94857:(e,t,i)=>{"use strict";i.d(t,{A:()=>er}),i(41658),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(20775),i(75036);var r=i(91826),n=i(19857),o=i(81174);class s{constructor(e,t){this.settings=e,this.cellRange=t||null}isEmpty(){return null===this.cellRange}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let e=this.cellRange.getOuterTopStartCorner(),t=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,t.row,t.col]}destroy(){this.runLocalHooks("destroy")}}(0,n.mixin)(s,o.A);let l=s;class a extends l{constructor(e,t){super(e,null),function(e,t,i){var r;(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:null,enumerable:!0,configurable:!0,writable:!0}):e[t]=null}(this,"visualCellRange",null),this.visualCellRange=t||null,this.commit()}add(e){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:t,to:i}=e,r=this.getNearestNotHiddenCoords(t,1),n=this.getNearestNotHiddenCoords(i,-1);return null===r||null===n?null:((r.row>n.row||r.col>n.col)&&(r=t,n=i),this.settings.createCellRange(r,r,n))}getNearestNotHiddenCoords(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,t);if(null===r)return null;let n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return null===n?null:this.settings.createCellCoords(r,n)}getNearestNotHiddenIndex(e,t,i){return t<0?t:e.getNearestNotHiddenIndex(t,i)}commit(){if(null===this.visualCellRange)return this;let e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===e?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){let t=e.from.clone().normalize(),i="N-S"===e.getVerticalDirection()?1:-1,r="W-E"===e.getHorizontalDirection()?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),o=null;if((null===n||null===n.col||null===n.row)&&(o=this.getNearestNotHiddenCoords(t,i,r)),null!==o&&e.overlaps(o)){let t=e.highlight.clone();if(t.row>=0&&(t.row=o.row),t.col>=0&&(t.col=o.col),null===this.cellRange){let e=this.settings.visualToRenderableCoords(t);this.cellRange=this.settings.createCellRange(e)}e.setHighlight(t)}return"focus"===this.settings.selectionType&&null!==n&&null===o&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:e,to:t}=this.cellRange;return[Math.min(e.row,t.row),Math.min(e.col,t.col),Math.max(e.row,t.row),Math.max(e.col,t.col)]}getVisualCorners(){let e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),t=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,t.row,t.col]}createRenderableCellRange(e,t){let i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(t);return null===i.row||null===i.col||null===r.row||null===r.col?null:this.settings.createCellRange(i,i,r)}}function h(e){let{activeHeaderClassName:t,...i}=e;return new a({className:t,...i,selectionType:r.E6})}function u(e){let{areaCornerVisible:t,...i}=e;return new a({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:t},...i,selectionType:r.LX})}function c(e){let{...t}=e;return new a({className:"highlight",...t,selectionType:r.LX})}function d(e){let{columnClassName:t,...i}=e;return new a({className:t,...i,selectionType:r.QP})}var g=i(91748);function f(e){let{headerClassName:t,...i}=e;return new a({className:t,...i,selectionType:r.PP})}function p(e){let{rowClassName:t,...i}=e;return new a({className:t,...i,selectionType:r._8})}var m=i(95061);function w(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function y(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var b=new WeakSet;class C{constructor(e){!function(e,t){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.add(e)}(this,b),w(this,"options",void 0),w(this,"layerLevel",0),w(this,"focus",void 0),w(this,"fill",void 0),w(this,"layeredAreas",new Map),w(this,"areas",new Map),w(this,"rowHeaders",new Map),w(this,"columnHeaders",new Map),w(this,"activeRowHeaders",new Map),w(this,"activeColumnHeaders",new Map),w(this,"activeCornerHeaders",new Map),w(this,"rowHighlights",new Map),w(this,"columnHighlights",new Map),w(this,"customSelections",[]),this.options=e,this.focus=function(e){let{cellCornerVisible:t,...i}=e;return new a({className:"current",headerAttributes:[(0,g.H0)()],border:{width:2,color:"#4b89ff",cornerVisible:t},...i,selectionType:r.Yt})}(e),this.fill=function(e){let{...t}=e;return new a({className:"fill",border:{width:1,color:"#ff0000"},...t,selectionType:r.Hb})}(e)}isEnabledFor(e,t){let i=e;e===r.Yt&&(i="current");let n=this.options.disabledCellSelection(t.row,t.col);return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(i)}useLayerLevel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return y(b,this,S).call(this,this.layeredAreas,u)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return y(b,this,S).call(this,this.areas,c)}getAreas(){return[...this.areas.values()]}createRowHeader(){return y(b,this,S).call(this,this.rowHeaders,f)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return y(b,this,S).call(this,this.columnHeaders,f)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return y(b,this,S).call(this,this.activeRowHeaders,h)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return y(b,this,S).call(this,this.activeColumnHeaders,h)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return y(b,this,S).call(this,this.activeCornerHeaders,h)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return y(b,this,S).call(this,this.rowHighlights,p)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return y(b,this,S).call(this,this.columnHighlights,d)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(function(e){let{border:t,visualCellRange:i,...n}=e;return new a({...t,...n,selectionType:r.OS},i)}({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),(0,m.arrayEach)(this.areas.values(),e=>void e.clear()),(0,m.arrayEach)(this.layeredAreas.values(),e=>void e.clear()),(0,m.arrayEach)(this.rowHeaders.values(),e=>void e.clear()),(0,m.arrayEach)(this.columnHeaders.values(),e=>void e.clear()),(0,m.arrayEach)(this.activeRowHeaders.values(),e=>void e.clear()),(0,m.arrayEach)(this.activeColumnHeaders.values(),e=>void e.clear()),(0,m.arrayEach)(this.activeCornerHeaders.values(),e=>void e.clear()),(0,m.arrayEach)(this.rowHighlights.values(),e=>void e.clear()),(0,m.arrayEach)(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function S(e,t){let i=this.layerLevel;if(e.has(i))return e.get(i);let r=t({layerLevel:i,...this.options});return e.set(i,r),r}function E(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}class R{constructor(e){E(this,"ranges",[]),E(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return 0===this.size()}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){return this.ranges.some(t=>t.includes(e))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t>=0&&t<this.size()&&(e=this.ranges[t]),e}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var T=i(78887),x=i(13455);function M(e,t,i){O(e,t),t.set(e,i)}function O(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")}function k(e,t){return e.get(A(e,t))}function I(e,t,i){return e.set(A(e,t),i),i}function A(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var N=new WeakMap,H=new WeakMap,P=new WeakMap,_=new WeakSet;class L{constructor(e,t){!function(e,t){O(e,t),t.add(e)}(this,_),M(this,N,void 0),M(this,H,void 0),M(this,P,{x:0,y:0}),I(N,this,e),I(H,this,t)}transformStart(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=k(H,this).createCellCoords(e,t),o=k(N,this).current().highlight,s=k(H,this).visualToRenderableCoords(o),l=0,a=0;if(this.runLocalHooks("beforeTransformStart",r),null!==s.row&&null!==s.col){let{width:e,height:t}=A(_,this,F).call(this),{row:s,col:h}=A(_,this,B).call(this,o),u=k(H,this).fixedRowsBottom(),c=k(H,this).minSpareRows(),d=k(H,this).minSpareCols(),g=k(H,this).autoWrapRow(),f=k(H,this).autoWrapCol(),p=k(H,this).createCellCoords(s+r.row,h+r.col);if(p.row>=t){let r=(0,n.createObjectPropListener)(i&&c>0&&0===u),o=p.col+1,s=k(H,this).createCellCoords(p.row-t,o>=e?o-e:o);this.runLocalHooks("beforeColumnWrap",r,A(_,this,j).call(this,s),o>=e),r.value?this.runLocalHooks("insertRowRequire",k(H,this).countRenderableRows()):f&&p.assign(s)}else if(p.row<0){let i=(0,n.createObjectPropListener)(f),r=p.col-1,o=k(H,this).createCellCoords(t+p.row,r<0?e+r:r);this.runLocalHooks("beforeColumnWrap",i,A(_,this,j).call(this,o),r<0),f&&p.assign(o)}if(p.col>=e){let r=(0,n.createObjectPropListener)(i&&d>0),o=p.row+1,s=k(H,this).createCellCoords(o>=t?o-t:o,p.col-e);this.runLocalHooks("beforeRowWrap",r,A(_,this,j).call(this,s),o>=t),r.value?this.runLocalHooks("insertColRequire",k(H,this).countRenderableColumns()):g&&p.assign(s)}else if(p.col<0){let i=(0,n.createObjectPropListener)(g),r=p.row-1,o=k(H,this).createCellCoords(r<0?t+r:r,e+p.col);this.runLocalHooks("beforeRowWrap",i,A(_,this,j).call(this,o),r<0),g&&p.assign(o)}let{rowDir:m,colDir:w}=A(_,this,D).call(this,p);l=m,a=w,o=A(_,this,j).call(this,p)}return this.runLocalHooks("afterTransformStart",o,l,a),o}transformEnd(e,t){let i=k(H,this).createCellCoords(e,t),r=k(N,this).current(),n=k(H,this).visualToRenderableCoords(r.highlight),o=A(_,this,V).call(this,r.to.row,r.from.row),s=A(_,this,W).call(this,r.to.col,r.from.col),l=r.to.clone(),a=0,h=0;if(this.runLocalHooks("beforeTransformEnd",i),null!==n.row&&null!==n.col&&null!==o&&null!==s){let{row:e,col:t}=A(_,this,B).call(this,r.highlight),n=k(H,this).createCellCoords(o+i.row,s+i.col),u=r.getTopStartCorner(),c=r.getTopEndCorner(),d=r.getBottomEndCorner();if(i.col<0&&s>=t&&n.col<t){let e=n.col-t;n.col=A(_,this,W).call(this,u.col,c.col)+e}else if(i.col>0&&s<=t&&n.col>t){let e=A(_,this,W).call(this,c.col,u.col),t=Math.max(n.col-e,1);n.col=e+t}if(i.row<0&&o>=e&&n.row<e){let t=n.row-e;n.row=A(_,this,V).call(this,u.row,d.row)+t}else if(i.row>0&&o<=e&&n.row>e){let e=A(_,this,V).call(this,d.row,u.row),t=Math.max(n.row-e,1);n.row=e+t}let{rowDir:g,colDir:f}=A(_,this,D).call(this,n);a=g,h=f;let p=A(_,this,j).call(this,n);0===i.row&&0!==i.col?l.col=p.col:0!==i.row&&0===i.col?l.row=p.row:(l.row=p.row,l.col=p.col)}return this.runLocalHooks("afterTransformEnd",l,a,h),l}setOffsetSize(e){let{x:t,y:i}=e;I(P,this,{x:t,y:i})}resetOffsetSize(){I(P,this,{x:0,y:0})}}function D(e){let{width:t,height:i}=A(_,this,F).call(this),r=0,n=0;return e.row<0?(r=-1,e.row=0):e.row>0&&e.row>=i&&(r=1,e.row=i-1),e.col<0?(n=-1,e.col=0):e.col>0&&e.col>=t&&(n=1,e.col=t-1),{rowDir:r,colDir:n}}function F(){return{width:k(P,this).x+k(H,this).countRenderableColumns(),height:k(P,this).y+k(H,this).countRenderableRows()}}function V(e,t){let i=k(H,this).findFirstNonHiddenRenderableRow(e,t);return null===i?null:k(P,this).y+i}function W(e,t){let i=k(H,this).findFirstNonHiddenRenderableColumn(e,t);return null===i?null:k(P,this).x+i}function B(e){let{row:t,col:i}=k(H,this).visualToRenderableCoords(e);if(null===t||null===i)throw Error("Renderable coords are not visible.");return k(H,this).createCellCoords(k(P,this).y+t,k(P,this).x+i)}function j(e){let t=e.clone();return t.col=e.col-k(P,this).x,t.row=e.row-k(P,this).y,k(H,this).renderableToVisualCoords(t)}(0,n.mixin)(L,o.A);var z=i(16932),U=i(83457);function $(e,t,i){(function(e,t){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object")})(e,t),t.set(e,i)}function G(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:r+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function Y(e,t){return e.get(X(e,t))}function K(e,t,i){return e.set(X(e,t),i),i}function X(e,t,i){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:i;throw TypeError("Private element is not present on this object")}var q=new WeakMap,J=new WeakMap,Z=new WeakMap,Q=new WeakMap,ee=new WeakMap,et=new WeakMap;class ei{constructor(e,t){var i=this;G(this,"settings",void 0),G(this,"tableProps",void 0),G(this,"inProgress",!1),G(this,"selectedRange",new R((e,t,i)=>this.tableProps.createCellRange(e,t,i))),G(this,"highlight",void 0),$(this,q,void 0),$(this,J,void 0),G(this,"selectedByRowHeader",new Set),G(this,"selectedByColumnHeader",new Set),$(this,Z,!1),$(this,Q,!1),$(this,ee,"unknown"),$(this,et,-1),this.settings=e,this.tableProps=t,this.highlight=new C({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[(0,g.H0)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(e,t)=>this.tableProps.isDisabledCellSelection(e,t),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),createCellRange:(e,t,i)=>this.tableProps.createCellRange(e,t,i)}),K(q,this,new L(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),K(J,this,new L(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{let e=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{let e=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)},visualToRenderableCoords:e=>this.tableProps.visualToRenderableCoords(e),renderableToVisualCoords:e=>this.tableProps.renderableToVisualCoords(e),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(e,t)=>this.tableProps.createCellCoords(e,t),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Y(q,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformStart",...t)}),Y(q,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("afterModifyTransformStart",...t)}),Y(q,this).addLocalHook("beforeTransformEnd",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformEnd",...t)}),Y(q,this).addLocalHook("afterTransformEnd",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("afterModifyTransformEnd",...t)}),Y(q,this).addLocalHook("insertRowRequire",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("insertRowRequire",...t)}),Y(q,this).addLocalHook("insertColRequire",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("insertColRequire",...t)}),Y(q,this).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("beforeRowWrap",...t)}),Y(q,this).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("beforeColumnWrap",...t)}),Y(J,this).addLocalHook("beforeTransformStart",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformFocus",...t)}),Y(J,this).addLocalHook("afterTransformStart",function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return i.runLocalHooks("afterModifyTransformFocus",...t)})}getSelectedRange(){return this.selectedRange}markSource(e){K(ee,this,e)}markEndSource(){K(ee,this,"unknown")}getSelectionSource(){return Y(ee,this)}setExpectedLayers(e){K(et,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,K(et,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,n="multiple"===this.settings.selectionMode,o=(0,T.isUndefined)(t)?this.tableProps.getShortcutManager().isCtrlPressed():t,s=e.clone();K(Z,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,s),(!n||n&&!o&&(0,T.isUndefined)(t))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;this.setRangeStart(e,t,!0,i)}setRangeEnd(e){if(this.selectedRange.isEmpty())return;let t=e.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(e).isSingleHeader();if((i>0||r>0)&&(0===i&&t.col<0&&!n||0===r&&t.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",t),this.begin();let o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),"single"===this.settings.selectionMode)o.setFrom(o.highlight),o.setTo(o.highlight);else{let e=o.getHorizontalDirection(),i=o.getVerticalDirection(),r=this.isMultiple();o.setTo(t),r&&(e!==o.getHorizontalDirection()||1===o.getWidth()&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),r&&(i!==o.getVerticalDirection()||1===o.getHeight()&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();let s=-1===Y(et,this)||this.selectedRange.size()===Y(et,this);this.runLocalHooks("afterSetRangeEnd",e,s)}applyAndCommit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel(),i=this.tableProps.countRows(),n=this.tableProps.countCols();t<this.highlight.layerLevel&&((0,m.arrayEach)(this.highlight.getAreas(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getLayeredAreas(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getRowHeaders(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getColumnHeaders(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getActiveRowHeaders(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getActiveColumnHeaders(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getActiveCornerHeaders(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getRowHighlights(),e=>void e.clear()),(0,m.arrayEach)(this.highlight.getColumnHighlights(),e=>void e.clear())),this.highlight.useLayerLevel(t);let o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),l.clear(),a.clear(),h.clear(),u.clear(),c.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(r.LX,e.highlight)&&(this.isMultiple()||t>=1)&&(o.add(e.from).add(e.to).commit(),s.add(e.from).add(e.to).commit(),1===t)){let e=this.selectedRange.previous();this.highlight.useLayerLevel(t-1),this.highlight.createArea().add(e.from).commit().syncWith(e),this.highlight.createLayeredArea().add(e.from).commit().syncWith(e),this.highlight.useLayerLevel(t)}if(this.highlight.isEnabledFor(r.PP,e.highlight)){if(!e.isSingleHeader()){let t=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),i=this.tableProps.createCellCoords(e.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),n=this.tableProps.createCellCoords(-1,e.to.col);"single"===this.settings.selectionMode?(l.add(t).commit(),a.add(r).commit(),d.add(t).commit(),g.add(r).commit()):(l.add(t).add(i).commit(),a.add(r).add(n).commit(),d.add(t).add(i).commit(),g.add(r).add(n).commit())}let t=!Y(Q,this)&&this.isEntireRowSelected()&&(n>0&&n===e.getWidth()||0===n&&this.isSelectedByRowHeader()),r=!Y(Q,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||0===i&&this.isSelectedByColumnHeader());t&&h.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),r&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),t&&r&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){if(this.selectedRange.isEmpty())return;let t=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",e);let i=this.highlight.getFocus();i.clear(),t.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(r.Yt,t.highlight)&&i.add(t.highlight).commit().syncWith(t),this.inProgress||(K(Z,this,!0),this.runLocalHooks("afterSetFocus",t.highlight))}transformStart(e,t){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?Y(q,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Y(q,this).resetOffsetSize(),this.setRangeStart(Y(q,this).transformStart(e,t,i))}transformEnd(e,t){this.settings.navigableHeaders?Y(q,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):Y(q,this).resetOffsetSize(),this.setRangeEnd(Y(q,this).transformEnd(e,t))}transformFocus(e,t){let i=this.selectedRange.current(),{row:r,col:n}=i.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,n-1),s=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?Y(J,this).setOffsetSize({x:n<0?Math.abs(n):-o,y:r<0?Math.abs(r):-s}):Y(J,this).setOffsetSize({x:n<0?0:-o,y:r<0?0:-s});let l=Y(J,this).transformStart(e,t);this.setRangeFocus(l.normalize())}shiftRows(e,t){if(!this.isSelected())return;let i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){let{from:r,to:n,highlight:o}=i,s=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=a?-1:0;this.getSelectedRange().pop();let u=this.tableProps.createCellCoords((0,x.clamp)(r.row+(a?0:t),h,s-1),r.col),c=this.tableProps.createCellCoords((0,x.clamp)(n.row+t,h,s-1),n.col);this.markSource("shift"),o.row>=e?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords((0,x.clamp)(o.row+t,0,s-1),o.col)):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(c),this.markEndSource()}}shiftColumns(e,t){if(!this.isSelected())return;let i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){let{from:r,to:n,highlight:o}=i,s=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=l?-1:0;this.getSelectedRange().pop();let u=this.tableProps.createCellCoords(r.row,(0,x.clamp)(r.col+(l?0:t),h,s-1)),c=this.tableProps.createCellCoords(n.row,(0,x.clamp)(n.col+t,h,s-1));this.markSource("shift"),o.col>=e?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(o.row,(0,x.clamp)(o.col+t,0,s-1))):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(c),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;let e=(0,n.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",e),e.value}isFocusSelectionChanged(){return this.isSelected()&&Y(Z,this)}isSelectedByRowHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(-1===e?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),t=e=>{let{col:t}=e.getOuterTopStartCorner(),i=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(i>0&&t<0||0===i)&&e.getWidth()===r};if(-1===e)return Array.from(this.selectedRange).some(e=>t(e));let i=this.selectedRange.peekByIndex(e);return!!i&&t(i)}isSelectedByColumnHeader(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===e?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),t=e=>{let{row:t}=e.getOuterTopStartCorner(),i=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(i>0&&t<0||0===i)&&e.getHeight()===r};if(-1===e)return Array.from(this.selectedRange).some(e=>t(e));let i=this.selectedRange.peekByIndex(e);return!!i&&t(i)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){let t=this.tableProps.visualToRenderableCoords(e);return null!==t.row&&null!==t.col}isAreaCornerVisible(e){return(!Number.isInteger(e)||e===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},n=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=i?-l:0,h=t?-s:0;if(0===a&&0===h&&(0===n||0===o))return;let u=null===(e=this.getSelectedRange().current())||void 0===e?void 0:e.highlight,{focusPosition:c,disableHeadersHighlight:d}=r;K(Q,this,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(u=this.tableProps.createCellCoords((0,x.clamp)(c.row,a,n-1),(0,x.clamp)(c.col,h,o-1)));let g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,u),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),K(Q,this,!1)}selectCells(e){var t=this;let i=(0,z.ML)(e);if(i===z.Qz)return!1;if(i===z.ay)throw Error((0,U.O)`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let r=(0,z._e)(i,{createCellCoords:function(){return t.tableProps.createCellCoords(...arguments)},createCellRange:function(){return t.tableProps.createCellRange(...arguments)},propToCol:e=>this.tableProps.propToCol(e),keepDirection:!0}),n=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},s=!e.some(e=>{let t=r(e),i=t.isValid(o);return!(i&&!t.containsHeaders()||i&&t.containsHeaders()&&t.isSingleHeader())});return s&&(this.clear(),this.setExpectedLayers(e.length),(0,m.arrayEach)(e,e=>{let{from:t,to:i}=r(e);this.setRangeStartOnly(t.clone(),!1),this.setRangeEnd(i.clone())}),this.finish()),s}selectColumns(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r="string"==typeof e?this.tableProps.propToCol(e):e,n="string"==typeof t?this.tableProps.propToCol(t):t,o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,r),u=this.tableProps.createCellCoords(o-1,n),c=this.tableProps.createCellRange(h,h,u).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:l});if(c){let e=0,t=0;Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(e=(0,x.clamp)(i.row,a,o-1),t=(0,x.clamp)(i.col,Math.min(r,n),Math.max(r,n))):(e=(0,x.clamp)(i,a,o-1),t=r);let s=this.tableProps.createCellCoords(e,t),h=0===l?0:(0,x.clamp)(s.row,a,-1),u=o-1,c=this.tableProps.createCellCoords(h,r),d=this.tableProps.createCellCoords(u,n);this.runLocalHooks("beforeSelectColumns",c,d,s),c.row=h,d.row=u,this.setRangeStartOnly(c,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",c,d,s),this.finish()}return c}selectRows(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,l=this.tableProps.createCellCoords(e,s),a=this.tableProps.createCellCoords(t,n-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:r,countCols:n,countRowHeaders:o,countColHeaders:0});if(h){let r=0,l=0;Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(r=(0,x.clamp)(i.row,Math.min(e,t),Math.max(e,t)),l=(0,x.clamp)(i.col,s,n-1)):(r=e,l=(0,x.clamp)(i,s,n-1));let a=this.tableProps.createCellCoords(r,l),h=0===o?0:(0,x.clamp)(a.col,s,-1),u=n-1,c=this.tableProps.createCellCoords(e,h),d=this.tableProps.createCellCoords(t,u);this.runLocalHooks("beforeSelectRows",c,d,a),c.col=h,d.col=u,this.setRangeStartOnly(c,void 0,a),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",c,d,a),this.finish()}return h}refresh(){if(!this.isSelected())return;let e=this.tableProps.countRows(),t=this.tableProps.countCols();if(0===e||0===t){this.deselect();return}let i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:n,to:o,highlight:s}=i;this.clear(),s.assign({row:(0,x.clamp)(s.row,-1/0,e-1),col:(0,x.clamp)(s.col,-1/0,t-1)}),n.assign({row:(0,x.clamp)(n.row,-1/0,e-1),col:(0,x.clamp)(n.col,-1/0,t-1)}),o.assign({row:(0,x.clamp)(o.row,0,e-1),col:(0,x.clamp)(o.col,0,t-1)}),this.selectedRange.ranges.push(i),this.highlight.isEnabledFor(r.Yt,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(e=>{e.commit()}),!this.isSelected())return;let e=this.getLayerLevel(),t=this.selectedRange.current();this.highlight.isEnabledFor(r.Yt,t.highlight)&&this.highlight.getFocus().commit().syncWith(t);for(let e=0;e<this.selectedRange.size();e+=1){this.highlight.useLayerLevel(e);let t=this.highlight.createArea(),i=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),n=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();t.commit(),i.commit(),r.commit(),n.commit(),o.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(e)}}(0,n.mixin)(ei,o.A);let er=ei},94948:(e,t,i)=>{"use strict";var r=i(32730);e.exports=function(e){return r(e.length)}},95061:(e,t,i)=>{"use strict";function r(e){let t=e.length,i=0;for(;i<t;)e[i]=[e[i]],i+=1}function n(e,t){let i=t.length,r=0;for(;r<i;)e.push(t[r]),r+=1}function o(e){let t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;let i=e.length,r=e[0].length;for(let n=0;n<i;n++)for(let i=0;i<r;i++)t[i]||(t[i]=[]),t[i][n]=e[n][i];return t}function s(e,t,i,r){let n=-1,o=e,s=i;Array.isArray(e)||(o=Array.from(e));let l=o.length;for(r&&l&&(n+=1,s=o[n]),n+=1;n<l;)s=t(s,o[n],n,o),n+=1;return s}function l(e,t){let i=0,r=e;Array.isArray(e)||(r=Array.from(e));let n=r.length,o=[],s=-1;for(;i<n;){let e=r[i];t(e,i,r)&&(o[s+=1]=e),i+=1}return o}function a(e,t){let i=0,r=e;Array.isArray(e)||(r=Array.from(e));let n=r.length,o=[],s=-1;for(;i<n;){let e=r[i];o[s+=1]=t(e,i,r),i+=1}return o}function h(e,t){let i=0,r=e;Array.isArray(e)||(r=Array.from(e));let n=r.length;for(;i<n&&!1!==t(r[i],i,r);)i+=1;return e}function u(e){return s(e,(e,t)=>e+t,0)}function c(e){return s(e,(e,t)=>e>t?e:t,Array.isArray(e)?e[0]:void 0)}function d(e){return s(e,(e,t)=>e<t?e:t,Array.isArray(e)?e[0]:void 0)}function g(e){return e.length?u(e)/e.length:0}function f(e){let t=[];return h(e,e=>{-1===t.indexOf(e)&&t.push(e)}),t}function p(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,...n]=[...t],o=r;return h(n,e=>{o=o.filter(t=>!e.includes(t))}),o}function m(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,...n]=[...t],o=r;return h(n,e=>{o=o.filter(t=>e.includes(t))}),o}function w(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];let[r,...n]=[...t],o=new Set(r);return h(n,e=>{h(e,e=>{o.has(e)||o.add(e)})}),Array.from(o)}function y(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e.split(t)}i.r(t),i.d(t,{arrayAvg:()=>g,arrayEach:()=>h,arrayFilter:()=>l,arrayFlatten:()=>function e(t){return s(t,(t,i)=>t.concat(Array.isArray(i)?e(i):i),[])},arrayMap:()=>a,arrayMax:()=>c,arrayMin:()=>d,arrayReduce:()=>s,arraySum:()=>u,arrayUnique:()=>f,extendArray:()=>n,getDifferenceOfArrays:()=>p,getIntersectionOfArrays:()=>m,getUnionOfArrays:()=>w,pivot:()=>o,stringToArray:()=>y,to2dArray:()=>r}),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(29954)},95283:(e,t,i)=>{"use strict";var r=i(27764),n=i(38896),o=i(56135),s=i(54733),l=i(7107)("iterator");e.exports=function(e){if(!o(e))return n(e,l)||n(e,"@@iterator")||s[r(e)]}},95467:(e,t,i)=>{"use strict";var r=i(93840),n=i(33325),o=r({}.hasOwnProperty);e.exports=Object.hasOwn||function(e,t){return o(n(e),t)}},95696:(e,t,i)=>{"use strict";i.r(t),i.d(t,{CHECKBOX_CHECKED:()=>eA,CHECKBOX_RENDERER_NAMESPACE:()=>eI,CHECKBOX_UNCHECKED:()=>eN,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>T,CONTEXTMENU_ITEMS_ALIGNMENT:()=>k,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>L,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>A,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>H,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>I,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>N,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>P,CONTEXTMENU_ITEMS_BORDERS:()=>D,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>W,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>B,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>V,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>F,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>f,CONTEXTMENU_ITEMS_COPY:()=>p,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>y,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>w,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>m,CONTEXTMENU_ITEMS_CUT:()=>b,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>x,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>C,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>$,CONTEXTMENU_ITEMS_HIDE_ROW:()=>Y,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>l,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>a,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>E,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>U,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>z,CONTEXTMENU_ITEMS_NO_ITEMS:()=>n,CONTEXTMENU_ITEMS_READ_ONLY:()=>g,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>O,CONTEXTMENU_ITEMS_REDO:()=>d,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>j,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>u,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>M,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>h,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>o,CONTEXTMENU_ITEMS_ROW_BELOW:()=>s,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>G,CONTEXTMENU_ITEMS_SHOW_ROW:()=>K,CONTEXTMENU_ITEMS_UNDO:()=>c,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>S,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>R,CONTEXT_MENU_ITEMS_NAMESPACE:()=>r,FILTERS_BUTTONS_CANCEL:()=>ex,FILTERS_BUTTONS_CLEAR:()=>eR,FILTERS_BUTTONS_OK:()=>eT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>eM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>ek,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>eO,FILTERS_BUTTONS_SELECT_ALL:()=>eE,FILTERS_CONDITIONS_AFTER:()=>eg,FILTERS_CONDITIONS_BEFORE:()=>ef,FILTERS_CONDITIONS_BEGINS_WITH:()=>ei,FILTERS_CONDITIONS_BETWEEN:()=>ec,FILTERS_CONDITIONS_BY_VALUE:()=>es,FILTERS_CONDITIONS_CONTAINS:()=>en,FILTERS_CONDITIONS_EMPTY:()=>Z,FILTERS_CONDITIONS_ENDS_WITH:()=>er,FILTERS_CONDITIONS_EQUAL:()=>ee,FILTERS_CONDITIONS_GREATER_THAN:()=>el,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>ea,FILTERS_CONDITIONS_LESS_THAN:()=>eh,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>eu,FILTERS_CONDITIONS_NAMESPACE:()=>q,FILTERS_CONDITIONS_NONE:()=>J,FILTERS_CONDITIONS_NOT_BETWEEN:()=>ed,FILTERS_CONDITIONS_NOT_CONTAIN:()=>eo,FILTERS_CONDITIONS_NOT_EMPTY:()=>Q,FILTERS_CONDITIONS_NOT_EQUAL:()=>et,FILTERS_CONDITIONS_TODAY:()=>ep,FILTERS_CONDITIONS_TOMORROW:()=>em,FILTERS_CONDITIONS_YESTERDAY:()=>ew,FILTERS_DIVS_FILTER_BY_CONDITION:()=>ey,FILTERS_DIVS_FILTER_BY_VALUE:()=>ev,FILTERS_LABELS_CONJUNCTION:()=>eb,FILTERS_LABELS_DISJUNCTION:()=>eC,FILTERS_NAMESPACE:()=>X,FILTERS_VALUES_BLANK_CELLS:()=>eS});let r="ContextMenu:items",n=`${r}.noItems`,o=`${r}.insertRowAbove`,s=`${r}.insertRowBelow`,l=`${r}.insertColumnOnTheLeft`,a=`${r}.insertColumnOnTheRight`,h=`${r}.removeRow`,u=`${r}.removeColumn`,c=`${r}.undo`,d=`${r}.redo`,g=`${r}.readOnly`,f=`${r}.clearColumn`,p=`${r}.copy`,m=`${r}.copyWithHeaders`,w=`${r}.copyWithGroupHeaders`,y=`${r}.copyHeadersOnly`,b=`${r}.cut`,C=`${r}.freezeColumn`,S=`${r}.unfreezeColumn`,E=`${r}.mergeCells`,R=`${r}.unmergeCells`,T=`${r}.addComment`,x=`${r}.editComment`,M=`${r}.removeComment`,O=`${r}.readOnlyComment`,k=`${r}.align`,I=`${r}.align.left`,A=`${r}.align.center`,N=`${r}.align.right`,H=`${r}.align.justify`,P=`${r}.align.top`,_=`${r}.align.middle`,L=`${r}.align.bottom`,D=`${r}.borders`,F=`${r}.borders.top`,V=`${r}.borders.right`,W=`${r}.borders.bottom`,B=`${r}.borders.left`,j=`${r}.borders.remove`,z=`${r}.nestedHeaders.insertChildRow`,U=`${r}.nestedHeaders.detachFromParent`,$=`${r}.hideColumn`,G=`${r}.showColumn`,Y=`${r}.hideRow`,K=`${r}.showRow`,X="Filters:",q=`${X}conditions`,J=`${q}.none`,Z=`${q}.isEmpty`,Q=`${q}.isNotEmpty`,ee=`${q}.isEqualTo`,et=`${q}.isNotEqualTo`,ei=`${q}.beginsWith`,er=`${q}.endsWith`,en=`${q}.contains`,eo=`${q}.doesNotContain`,es=`${q}.byValue`,el=`${q}.greaterThan`,ea=`${q}.greaterThanOrEqualTo`,eh=`${q}.lessThan`,eu=`${q}.lessThanOrEqualTo`,ec=`${q}.isBetween`,ed=`${q}.isNotBetween`,eg=`${q}.after`,ef=`${q}.before`,ep=`${q}.today`,em=`${q}.tomorrow`,ew=`${q}.yesterday`,ey=`${X}labels.filterByCondition`,ev=`${X}labels.filterByValue`,eb=`${X}labels.conjunction`,eC=`${X}labels.disjunction`,eS=`${X}values.blankCells`,eE=`${X}buttons.selectAll`,eR=`${X}buttons.clear`,eT=`${X}buttons.ok`,ex=`${X}buttons.cancel`,eM=`${X}buttons.placeholder.search`,eO=`${X}buttons.placeholder.value`,ek=`${X}buttons.placeholder.secondValue`,eI="CheckboxRenderer:",eA=`${eI}checked`,eN=`${eI}unchecked`},96770:(e,t,i)=>{"use strict";i.d(t,{w:()=>g});for(var r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},o="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),s="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),l=0;l<10;l++)r[48+l]=r[96+l]=String(l);for(var l=1;l<=24;l++)r[l+111]="F"+l;for(var l=65;l<=90;l++)r[l]=String.fromCharCode(l+32),n[l]=String.fromCharCode(l);for(var a in r)n.hasOwnProperty(a)||(n[a]=r[a]);var h=i(52571);let u="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),c="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function d(e,t,i=!0){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),i&&t.shiftKey&&(e="Shift-"+e),e}function g(e){let t;return new h.k_({props:{handleKeyDown:(t=function(e){let t=Object.create(null);for(let i in e)t[function(e){let t,i,r,n,o=e.split(/-(?!$)/),s=o[o.length-1];"Space"==s&&(s=" ");for(let e=0;e<o.length-1;e++){let s=o[e];if(/^(cmd|meta|m)$/i.test(s))n=!0;else if(/^a(lt)?$/i.test(s))t=!0;else if(/^(c|ctrl|control)$/i.test(s))i=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))u?n=!0:i=!0;else throw Error("Unrecognized modifier name: "+s)}return t&&(s="Alt-"+s),i&&(s="Ctrl-"+s),n&&(s="Meta-"+s),r&&(s="Shift-"+s),s}(i)]=e[i];return t}(e),function(e,i){var l;let a=("Esc"==(l=!(o&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||s&&i.shiftKey&&i.key&&1==i.key.length||"Unidentified"==i.key)&&i.key||(i.shiftKey?n:r)[i.keyCode]||i.key||"Unidentified")&&(l="Escape"),"Del"==l&&(l="Delete"),"Left"==l&&(l="ArrowLeft"),"Up"==l&&(l="ArrowUp"),"Right"==l&&(l="ArrowRight"),"Down"==l&&(l="ArrowDown"),l),h,u=t[d(a,i)];if(u&&u(e.state,e.dispatch,e))return!0;if(1==a.length&&" "!=a){if(i.shiftKey){let r=t[d(a,i,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((i.altKey||i.metaKey||i.ctrlKey)&&!(c&&i.ctrlKey&&i.altKey)&&(h=r[i.keyCode])&&h!=a){let r=t[d(h,i)];if(r&&r(e.state,e.dispatch,e))return!0}}return!1})}})}},96843:(e,t,i)=>{"use strict";var r=i(13517),n=i(81938),o=i(94948),s=function(e){return function(t,i,s){var l,a=r(t),h=o(a);if(0===h)return!e&&-1;var u=n(s,h);if(e&&i!=i){for(;h>u;)if((l=a[u++])!=l)return!0}else for(;h>u;u++)if((e||u in a)&&a[u]===i)return e||u||0;return!e&&-1}};e.exports={includes:s(!0),indexOf:s(!1)}},97156:(e,t,i)=>{"use strict";var r=i(54674),n=i(66627).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,n)}},98416:(e,t,i)=>{"use strict";i(66256),i(88109)},98590:(e,t,i)=>{"use strict";var r=i(24851).f;e.exports=function(e,t,i){i in e||r(e,i,{configurable:!0,get:function(){return t[i]},set:function(e){t[i]=e}})}},98774:(e,t,i)=>{"use strict";e.exports=!i(56963)(function(){var e=(function(){}).bind();return"function"!=typeof e||e.hasOwnProperty("prototype")})},99206:(e,t,i)=>{"use strict";i.d(t,{L3:()=>d,M8:()=>g,VA:()=>f,aZ:()=>a,sY:()=>h}),i(41658);var r=i(16880),n=i(21413);let o=new WeakMap,{register:s,getItem:l,hasItem:a,getNames:h,getValues:u}=(0,n.A)("editors");function c(e){let t={};this.getConstructor=function(){return e},this.getInstance=function(i){return i.guid in t||(t[i.guid]=new e(i)),t[i.guid]},r.R.getSingleton().add("afterDestroy",function(){t[this.guid]=null})}function d(e,t){let i;if("function"==typeof e)o.get(e)||f(null,e),i=o.get(e);else if("string"==typeof e)i=l(e);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error(`No editor registered under name "${e}"`);return i.getInstance(t)}function g(e){if("function"==typeof e)return e;if(!a(e))throw Error(`No registered editor found under "${e}" name`);return l(e).getConstructor()}function f(e,t){e&&"string"!=typeof e&&(e=(t=e).EDITOR_TYPE);let i=new c(t);"string"==typeof e&&s(e,i),o.set(t,i)}},99365:e=>{"use strict";var t="object"==typeof document&&document.all;e.exports=void 0===t&&void 0!==t?function(e){return"function"==typeof e||e===t}:function(e){return"function"==typeof e}},99842:e=>{"use strict";e.exports=function(e,t){var i="function"==typeof Iterator&&Iterator.prototype[e];if(i)try{i.call({next:null},t).next()}catch(e){return!0}}},99848:(e,t,i)=>{"use strict";var r=i(54076),n=i(27226),o=i(56963);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("difference",function(e){return 0===e.size})||o(function(){var e=new Set([1,2,3,4]);return 3!==e.difference({size:1,has:function(){return!0},keys:function(){var t=0;return{next:function(){var i=t++>1;return e.has(1)&&e.clear(),{done:i,value:2}}}}}).size})},{difference:n})}}]);