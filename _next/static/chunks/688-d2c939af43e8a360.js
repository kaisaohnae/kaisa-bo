(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[688],{25:(t,e,i)=>{"use strict";var r,n,o=i(42620),s=i(53469),l=o.process,a=o.Deno,h=l&&l.versions||a&&a.version,u=h&&h.v8;u&&(n=(r=u.split("."))[0]>0&&r[0]<4?1:+(r[0]+r[1])),!n&&s&&(!(r=s.match(/Edge\/(\d+)/))||r[1]>=74)&&(r=s.match(/Chrome\/(\d+)/))&&(n=+r[1]),t.exports=n},241:(t,e,i)=>{"use strict";var r=i(82309),n=i(99365),o=i(7411),s=i(2048),l=Object;t.exports=s?function(t){return"symbol"==typeof t}:function(t){var e=r("Symbol");return n(e)&&o(e.prototype,l(t))}},255:(t,e,i)=>{"use strict";i.d(e,{A:()=>S}),i(41658),i(12252),i(20775);var r=i(19857);i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var n=i(59149);function o(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,o="string"==typeof e.type?(0,n.r0)(e.type):e.type;if(t._automaticallyAssignedMetaProps&&(0,r.objectEach)(e,(e,i)=>void t._automaticallyAssignedMetaProps.delete(i)),!(0,r.isObject)(o))return;i!==t||t._automaticallyAssignedMetaProps||(t._automaticallyAssignedMetaProps=new Set);let s={};(0,r.objectEach)(o,(e,n)=>{var o,l;"CELL_TYPE"!==n&&((null===(o=i._automaticallyAssignedMetaProps)||void 0===o?void 0:o.has(n))||!(0,r.hasOwnProperty)(i,n))&&(s[n]=e,null===(l=t._automaticallyAssignedMetaProps)||void 0===l||l.add(n))}),(0,r.extend)(t,s)}function s(t){return Number.isInteger(t)&&t>=0}function l(t,e){if(!t())throw Error(`Assertion failed: ${e}`)}var a=i(5322);function h(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class u{constructor(t){h(this,"metaCtor",class{}),h(this,"meta",void 0),this.meta=this.metaCtor.prototype,(0,r.extend)(this.meta,(0,a.A)()),this.meta.instance=t}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(t){var e;(0,r.extend)(this.meta,t),o(this.meta,{...t,type:null!==(e=t.type)&&void 0!==e?e:this.meta.type},t)}}class c{constructor(t){!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"meta",void 0);let e=t.getMetaConstructor();this.meta=new e}getMeta(){return this.meta}updateMeta(t){(0,r.extend)(this.meta,t),o(this.meta,t,t)}}function d(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(19398),i(29954);class g{constructor(t){d(this,"valueFactory",void 0),d(this,"data",[]),d(this,"index",[]),d(this,"holes",new Set),this.valueFactory=t}obtain(t){let e;l(()=>s(t),"Expecting an unsigned number.");let i=this._getStorageIndexByKey(t);if(i>=0)void 0===(e=this.data[i])&&(e=this.valueFactory(t),this.data[i]=e);else if(e=this.valueFactory(t),this.holes.size>0){let i=this.holes.values().next().value;this.holes.delete(i),this.data[i]=e,this.index[t]=i}else this.data.push(e),this.index[t]=this.data.length-1;return e}insert(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(()=>s(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=[],r=this.data.length;for(let t=0;t<e;t++)i.push(r+t),this.data.push(void 0);let n=null==t?this.index.length:t;this.index=[...this.index.slice(0,n),...i,...this.index.slice(n)]}remove(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;l(()=>s(t)||null==t,"Expecting an unsigned number or null/undefined argument.");let i=this.index.splice(null==t?this.index.length-e:t,e);for(let t=0;t<i.length;t++){let e=i[t];"number"==typeof e&&this.holes.add(e)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((t,e)=>void 0!==t&&!this.holes.has(e))[Symbol.iterator]()}entries(){let t=[];for(let e=0;e<this.data.length;e++){let i=this._getKeyByStorageIndex(e);-1!==i&&void 0!==this.data[e]&&t.push([i,this.data[e]])}let e=0;return{next:()=>{if(e<t.length){let i=t[e];return e+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(t){return this.index.length>t?this.index[t]:-1}_getKeyByStorageIndex(t){return this.index.indexOf(t)}[Symbol.iterator](){return this.entries()}}function f(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let p=["data","width"];class m{constructor(t){f(this,"globalMeta",void 0),f(this,"metas",new g(()=>this._createMeta())),this.globalMeta=t,this.metas=new g(()=>this._createMeta())}updateMeta(t,e){let i=this.getMeta(t);(0,r.extend)(i,e),o(i,e)}createColumn(t,e){this.metas.insert(t,e)}removeColumn(t,e){this.metas.remove(t,e)}getMeta(t){return this.metas.obtain(t)}getMetaConstructor(t){return this.metas.obtain(t).constructor}clearCache(){this.metas.clear()}_createMeta(){return function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];function i(){}(0,r.inherit)(i,t);for(let t=0;t<e.length;t++)i.prototype[e[t]]=void 0;return i}(this.globalMeta.getMetaConstructor(),p).prototype}}var w=i(78887);function y(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class b{constructor(t){y(this,"columnMeta",void 0),y(this,"metas",new g(()=>this._createRow())),this.columnMeta=t}updateMeta(t,e,i){let n=this.getMeta(t,e);(0,r.extend)(n,i),o(n,i)}createRow(t,e){this.metas.insert(t,e)}createColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(t,e)}removeRow(t,e){this.metas.remove(t,e)}removeColumn(t,e){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(t,e)}getMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);return void 0===i?r:r[i]}setMeta(t,e,i,r){var n;let o=this.metas.obtain(t).obtain(e);null===(n=o._automaticallyAssignedMetaProps)||void 0===n||n.delete(i),o[i]=r}removeMeta(t,e,i){let r=this.metas.obtain(t).obtain(e);delete r[i]}getMetas(){let t=[],e=Array.from(this.metas.values());for(let i=0;i<e.length;i++)(0,w.isDefined)(e[i])&&t.push(...e[i].values());return t}getMetasAtRow(t){l(()=>s(t),"Expecting an unsigned number.");let e=new Map(this.metas);return e.has(t)?Array.from(e.get(t).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new g(t=>this._createMeta(t))}_createMeta(t){return new(this.columnMeta.getMetaConstructor(t))}}var C=i(81174);class S{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];this.hot=t,this.globalMeta=new u(t),this.tableMeta=new c(this.globalMeta),this.columnMeta=new m(this.globalMeta),this.cellMeta=new b(this.columnMeta),i.forEach(t=>new t(this)),this.globalMeta.updateMeta(e)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(t){this.globalMeta.updateMeta(t)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(t){this.tableMeta.updateMeta(t)}getColumnMeta(t){return this.columnMeta.getMeta(t)}updateColumnMeta(t,e){this.columnMeta.updateMeta(t,e)}getCellMeta(t,e,i){let r=this.cellMeta.getMeta(t,e);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=t,r.col=e,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(t,e,i){if("string"!=typeof i)throw Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(t,e,i)}setCellMeta(t,e,i,r){this.cellMeta.setMeta(t,e,i,r)}updateCellMeta(t,e,i){this.cellMeta.updateMeta(t,e,i)}removeCellMeta(t,e,i){this.cellMeta.removeMeta(t,e,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(t){return this.cellMeta.getMetasAtRow(t)}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createRow(t,e)}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeRow(t,e)}createColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.createColumn(t,e),this.columnMeta.createColumn(t,e)}removeColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.cellMeta.removeColumn(t,e),this.columnMeta.removeColumn(t,e)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}(0,r.mixin)(S,C.A)},808:(t,e,i)=>{"use strict";i.d(e,{$L:()=>k,Lm:()=>o,Ln:()=>p,Um:()=>M,Wg:()=>m,X9:()=>s,dL:()=>V,jP:()=>b,n9:()=>x,oM:()=>C,zy:()=>T});var r=i(10156);class n{constructor(t,e,i){this.pos=t,this.delInfo=e,this.recover=i}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class o{constructor(t,e=!1){if(this.ranges=t,this.inverted=e,!t.length&&o.empty)return o.empty}recover(t){let e=0,i=65535&t;if(!this.inverted)for(let t=0;t<i;t++)e+=this.ranges[3*t+2]-this.ranges[3*t+1];return this.ranges[3*i]+e+(t-(65535&t))/65536}mapResult(t,e=1){return this._map(t,e,!1)}map(t,e=1){return this._map(t,e,!0)}_map(t,e,i){let r=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let l=0;l<this.ranges.length;l+=3){let a=this.ranges[l]-(this.inverted?r:0);if(a>t)break;let h=this.ranges[l+o],u=this.ranges[l+s],c=a+h;if(t<=c){let o=h?t==a?-1:t==c?1:e:e,s=a+r+(o<0?0:u);if(i)return s;let d=t==(e<0?a:c)?null:l/3+(t-a)*65536,g=t==a?2:t==c?1:4;return(e<0?t!=a:t!=c)&&(g|=8),new n(s,g,d)}r+=u-h}return i?t+r:new n(t+r,0,null)}touches(t,e){let i=0,r=65535&e,n=this.inverted?2:1,o=this.inverted?1:2;for(let e=0;e<this.ranges.length;e+=3){let s=this.ranges[e]-(this.inverted?i:0);if(s>t)break;let l=this.ranges[e+n];if(t<=s+l&&e==3*r)return!0;i+=this.ranges[e+o]-l}return!1}forEach(t){let e=this.inverted?2:1,i=this.inverted?1:2;for(let r=0,n=0;r<this.ranges.length;r+=3){let o=this.ranges[r],s=o-(this.inverted?n:0),l=o+(this.inverted?0:n),a=this.ranges[r+e],h=this.ranges[r+i];t(s,s+a,l,l+h),n+=h-a}}invert(){return new o(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(t){return 0==t?o.empty:new o(t<0?[0,-t,0]:[0,0,t])}}o.empty=new o([]);class s{constructor(t,e,i=0,r=t?t.length:0){this.mirror=e,this.from=i,this.to=r,this._maps=t||[],this.ownData=!(t||e)}get maps(){return this._maps}slice(t=0,e=this.maps.length){return new s(this._maps,this.mirror,t,e)}appendMap(t,e){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(t),null!=e&&this.setMirror(this._maps.length-1,e)}appendMapping(t){for(let e=0,i=this._maps.length;e<t._maps.length;e++){let r=t.getMirror(e);this.appendMap(t._maps[e],null!=r&&r<e?i+r:void 0)}}getMirror(t){if(this.mirror){for(let e=0;e<this.mirror.length;e++)if(this.mirror[e]==t)return this.mirror[e+(e%2?-1:1)]}}setMirror(t,e){this.mirror||(this.mirror=[]),this.mirror.push(t,e)}appendMappingInverted(t){for(let e=t.maps.length-1,i=this._maps.length+t._maps.length;e>=0;e--){let r=t.getMirror(e);this.appendMap(t._maps[e].invert(),null!=r&&r>e?i-r-1:void 0)}}invert(){let t=new s;return t.appendMappingInverted(this),t}map(t,e=1){if(this.mirror)return this._map(t,e,!0);for(let i=this.from;i<this.to;i++)t=this._maps[i].map(t,e);return t}mapResult(t,e=1){return this._map(t,e,!1)}_map(t,e,i){let r=0;for(let i=this.from;i<this.to;i++){let n=this._maps[i].mapResult(t,e);if(null!=n.recover){let e=this.getMirror(i);if(null!=e&&e>i&&e<this.to){i=e,t=this._maps[e].recover(n.recover);continue}}r|=n.delInfo,t=n.pos}return i?t:new n(t,r,null)}}let l=Object.create(null);class a{getMap(){return o.empty}merge(t){return null}static fromJSON(t,e){if(!e||!e.stepType)throw RangeError("Invalid input for Step.fromJSON");let i=l[e.stepType];if(!i)throw RangeError(`No step type ${e.stepType} defined`);return i.fromJSON(t,e)}static jsonID(t,e){if(t in l)throw RangeError("Duplicate use of step JSON ID "+t);return l[t]=e,e.prototype.jsonID=t,e}}class h{constructor(t,e){this.doc=t,this.failed=e}static ok(t){return new h(t,null)}static fail(t){return new h(null,t)}static fromReplace(t,e,i,n){try{return h.ok(t.replace(e,i,n))}catch(t){if(t instanceof r.vI)return h.fail(t.message);throw t}}}function u(t,e,i){let n=[];for(let r=0;r<t.childCount;r++){let o=t.child(r);o.content.size&&(o=o.copy(u(o.content,e,o))),o.isInline&&(o=e(o,i,r)),n.push(o)}return r.FK.fromArray(n)}class c extends a{constructor(t,e,i){super(),this.from=t,this.to=e,this.mark=i}apply(t){let e=t.slice(this.from,this.to),i=t.resolve(this.from),n=i.node(i.sharedDepth(this.to)),o=new r.Ji(u(e.content,(t,e)=>t.isAtom&&e.type.allowsMarkType(this.mark.type)?t.mark(this.mark.addToSet(t.marks)):t,n),e.openStart,e.openEnd);return h.fromReplace(t,this.from,this.to,o)}invert(){return new d(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),i=t.mapResult(this.to,-1);return e.deleted&&i.deleted||e.pos>=i.pos?null:new c(e.pos,i.pos,this.mark)}merge(t){return t instanceof c&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new c(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw RangeError("Invalid input for AddMarkStep.fromJSON");return new c(e.from,e.to,t.markFromJSON(e.mark))}}a.jsonID("addMark",c);class d extends a{constructor(t,e,i){super(),this.from=t,this.to=e,this.mark=i}apply(t){let e=t.slice(this.from,this.to),i=new r.Ji(u(e.content,t=>t.mark(this.mark.removeFromSet(t.marks)),t),e.openStart,e.openEnd);return h.fromReplace(t,this.from,this.to,i)}invert(){return new c(this.from,this.to,this.mark)}map(t){let e=t.mapResult(this.from,1),i=t.mapResult(this.to,-1);return e.deleted&&i.deleted||e.pos>=i.pos?null:new d(e.pos,i.pos,this.mark)}merge(t){return t instanceof d&&t.mark.eq(this.mark)&&this.from<=t.to&&this.to>=t.from?new d(Math.min(this.from,t.from),Math.max(this.to,t.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw RangeError("Invalid input for RemoveMarkStep.fromJSON");return new d(e.from,e.to,t.markFromJSON(e.mark))}}a.jsonID("removeMark",d);class g extends a{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return h.fail("No node at mark step's position");let i=e.type.create(e.attrs,null,this.mark.addToSet(e.marks));return h.fromReplace(t,this.pos,this.pos+1,new r.Ji(r.FK.from(i),0,+!e.isLeaf))}invert(t){let e=t.nodeAt(this.pos);if(e){let t=this.mark.addToSet(e.marks);if(t.length==e.marks.length){for(let i=0;i<e.marks.length;i++)if(!e.marks[i].isInSet(t))return new g(this.pos,e.marks[i]);return new g(this.pos,this.mark)}}return new f(this.pos,this.mark)}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new g(e.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new g(e.pos,t.markFromJSON(e.mark))}}a.jsonID("addNodeMark",g);class f extends a{constructor(t,e){super(),this.pos=t,this.mark=e}apply(t){let e=t.nodeAt(this.pos);if(!e)return h.fail("No node at mark step's position");let i=e.type.create(e.attrs,null,this.mark.removeFromSet(e.marks));return h.fromReplace(t,this.pos,this.pos+1,new r.Ji(r.FK.from(i),0,+!e.isLeaf))}invert(t){let e=t.nodeAt(this.pos);return e&&this.mark.isInSet(e.marks)?new g(this.pos,this.mark):this}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new f(e.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(t,e){if("number"!=typeof e.pos)throw RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new f(e.pos,t.markFromJSON(e.mark))}}a.jsonID("removeNodeMark",f);class p extends a{constructor(t,e,i,r=!1){super(),this.from=t,this.to=e,this.slice=i,this.structure=r}apply(t){return this.structure&&w(t,this.from,this.to)?h.fail("Structure replace would overwrite content"):h.fromReplace(t,this.from,this.to,this.slice)}getMap(){return new o([this.from,this.to-this.from,this.slice.size])}invert(t){return new p(this.from,this.from+this.slice.size,t.slice(this.from,this.to))}map(t){let e=t.mapResult(this.from,1),i=t.mapResult(this.to,-1);return e.deletedAcross&&i.deletedAcross?null:new p(e.pos,Math.max(e.pos,i.pos),this.slice,this.structure)}merge(t){if(!(t instanceof p)||t.structure||this.structure)return null;if(this.from+this.slice.size!=t.from||this.slice.openEnd||t.slice.openStart)if(t.to!=this.from||this.slice.openStart||t.slice.openEnd)return null;else{let e=this.slice.size+t.slice.size==0?r.Ji.empty:new r.Ji(t.slice.content.append(this.slice.content),t.slice.openStart,this.slice.openEnd);return new p(t.from,this.to,e,this.structure)}{let e=this.slice.size+t.slice.size==0?r.Ji.empty:new r.Ji(this.slice.content.append(t.slice.content),this.slice.openStart,t.slice.openEnd);return new p(this.from,this.to+(t.to-t.from),e,this.structure)}}toJSON(){let t={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to)throw RangeError("Invalid input for ReplaceStep.fromJSON");return new p(e.from,e.to,r.Ji.fromJSON(t,e.slice),!!e.structure)}}a.jsonID("replace",p);class m extends a{constructor(t,e,i,r,n,o,s=!1){super(),this.from=t,this.to=e,this.gapFrom=i,this.gapTo=r,this.slice=n,this.insert=o,this.structure=s}apply(t){if(this.structure&&(w(t,this.from,this.gapFrom)||w(t,this.gapTo,this.to)))return h.fail("Structure gap-replace would overwrite content");let e=t.slice(this.gapFrom,this.gapTo);if(e.openStart||e.openEnd)return h.fail("Gap is not a flat range");let i=this.slice.insertAt(this.insert,e.content);return i?h.fromReplace(t,this.from,this.to,i):h.fail("Content does not fit in gap")}getMap(){return new o([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(t){let e=this.gapTo-this.gapFrom;return new m(this.from,this.from+this.slice.size+e,this.from+this.insert,this.from+this.insert+e,t.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(t){let e=t.mapResult(this.from,1),i=t.mapResult(this.to,-1),r=this.from==this.gapFrom?e.pos:t.map(this.gapFrom,-1),n=this.to==this.gapTo?i.pos:t.map(this.gapTo,1);return e.deletedAcross&&i.deletedAcross||r<e.pos||n>i.pos?null:new m(e.pos,i.pos,r,n,this.slice,this.insert,this.structure)}toJSON(){let t={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(t.slice=this.slice.toJSON()),this.structure&&(t.structure=!0),t}static fromJSON(t,e){if("number"!=typeof e.from||"number"!=typeof e.to||"number"!=typeof e.gapFrom||"number"!=typeof e.gapTo||"number"!=typeof e.insert)throw RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new m(e.from,e.to,e.gapFrom,e.gapTo,r.Ji.fromJSON(t,e.slice),e.insert,!!e.structure)}}function w(t,e,i){let r=t.resolve(e),n=i-e,o=r.depth;for(;n>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,n--;if(n>0){let t=r.node(o).maybeChild(r.indexAfter(o));for(;n>0;){if(!t||t.isLeaf)return!0;t=t.firstChild,n--}}return!1}function y(t,e,i,n=i.contentMatch,o=!0){let s=t.doc.nodeAt(e),l=[],a=e+1;for(let e=0;e<s.childCount;e++){let h=s.child(e),u=a+h.nodeSize,c=n.matchType(h.type);if(c){n=c;for(let e=0;e<h.marks.length;e++)i.allowsMarkType(h.marks[e].type)||t.step(new d(a,u,h.marks[e]));if(o&&h.isText&&"pre"!=i.whitespace){let t,e=/\r?\n|\r/g,n;for(;t=e.exec(h.text);)n||(n=new r.Ji(r.FK.from(i.schema.text(" ",i.allowedMarks(h.marks))),0,0)),l.push(new p(a+t.index,a+t.index+t[0].length,n))}}else l.push(new p(a,u,r.Ji.empty));a=u}if(!n.validEnd){let e=n.fillBefore(r.FK.empty,!0);t.replace(a,a,new r.Ji(e,0,0))}for(let e=l.length-1;e>=0;e--)t.step(l[e])}function b(t){let e=t.parent.content.cutByIndex(t.startIndex,t.endIndex);for(let i=t.depth;;--i){let r=t.$from.node(i),n=t.$from.index(i),o=t.$to.indexAfter(i);if(i<t.depth&&r.canReplace(n,o,e))return i;if(0==i||r.type.spec.isolating||!((0==n||r.canReplace(n,r.childCount))&&(o==r.childCount||r.canReplace(0,o))))break}return null}function C(t,e,i=null,r=t){let n=function(t,e){let{parent:i,startIndex:r,endIndex:n}=t,o=i.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return i.canReplaceWith(r,n,s)?o:null}(t,e),o=n&&function(t,e){let{parent:i,startIndex:r,endIndex:n}=t,o=i.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let t=r;l&&t<n;t++)l=l.matchType(i.child(t).type);return l&&l.validEnd?s:null}(r,e);return o?n.map(S).concat({type:e,attrs:i}).concat(o.map(S)):null}function S(t){return{type:t,attrs:null}}function E(t,e,i,r){e.forEach((n,o)=>{if(n.isText){let s,l=/\r?\n|\r/g;for(;s=l.exec(n.text);){let n=t.mapping.slice(r).map(i+1+o+s.index);t.replaceWith(n,n+1,e.type.schema.linebreakReplacement.create())}}})}function R(t,e,i,r){e.forEach((n,o)=>{if(n.type==n.type.schema.linebreakReplacement){let n=t.mapping.slice(r).map(i+1+o);t.replaceWith(n,n+1,e.type.schema.text("\n"))}})}function T(t,e,i=1,r){let n=t.resolve(e),o=n.depth-i,s=r&&r[r.length-1]||n.parent;if(o<0||n.parent.type.spec.isolating||!n.parent.canReplace(n.index(),n.parent.childCount)||!s.type.validContent(n.parent.content.cutByIndex(n.index(),n.parent.childCount)))return!1;for(let t=n.depth-1,e=i-2;t>o;t--,e--){let i=n.node(t),o=n.index(t);if(i.type.spec.isolating)return!1;let s=i.content.cutByIndex(o,i.childCount),l=r&&r[e+1];l&&(s=s.replaceChild(0,l.type.create(l.attrs)));let a=r&&r[e]||i;if(!i.canReplace(o+1,i.childCount)||!a.type.validContent(s))return!1}let l=n.indexAfter(o),a=r&&r[0];return n.node(o).canReplaceWith(l,l,a?a.type:n.node(o+1).type)}function x(t,e){let i=t.resolve(e),r=i.index();return function(t,e){return!!(t&&e&&!t.isLeaf&&function(t,e){e.content.size||t.type.compatibleContent(e.type);let i=t.contentMatchAt(t.childCount),{linebreakReplacement:r}=t.type.schema;for(let n=0;n<e.childCount;n++){let o=e.child(n),s=o.type==r?t.type.schema.nodes.text:o.type;if(!(i=i.matchType(s))||!t.type.allowsMarks(o.marks))return!1}return i.validEnd}(t,e))}(i.nodeBefore,i.nodeAfter)&&i.parent.canReplace(r,r+1)}a.jsonID("replaceAround",m);function M(t,e,i){let r=t.resolve(e);if(!i.content.size)return e;let n=i.content;for(let t=0;t<i.openStart;t++)n=n.firstChild.content;for(let t=1;t<=(0==i.openStart&&i.size?2:1);t++)for(let e=r.depth;e>=0;e--){let i=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,o=r.index(e)+ +(i>0),s=r.node(e),l=!1;if(1==t)l=s.canReplace(o,o,n);else{let t=s.contentMatchAt(o).findWrapping(n.firstChild.type);l=t&&s.canReplaceWith(o,o,t[0])}if(l)return 0==i?r.pos:i<0?r.before(e+1):r.after(e+1)}return null}function k(t,e,i=e,n=r.Ji.empty){if(e==i&&!n.size)return null;let o=t.resolve(e),s=t.resolve(i);return O(o,s,n)?new p(e,i,n):new I(o,s,n).fit()}function O(t,e,i){return!i.openStart&&!i.openEnd&&t.start()==e.start()&&t.parent.canReplace(t.index(),e.index(),i.content)}class I{constructor(t,e,i){this.$from=t,this.$to=e,this.unplaced=i,this.frontier=[],this.placed=r.FK.empty;for(let e=0;e<=t.depth;e++){let i=t.node(e);this.frontier.push({type:i.type,match:i.contentMatchAt(t.indexAfter(e))})}for(let e=t.depth;e>0;e--)this.placed=r.FK.from(t.node(e).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let t=this.findFittable();t?this.placeNodes(t):this.openMore()||this.dropNode()}let t=this.mustMoveInline(),e=this.placed.size-this.depth-this.$from.depth,i=this.$from,n=this.close(t<0?this.$to:i.doc.resolve(t));if(!n)return null;let o=this.placed,s=i.depth,l=n.depth;for(;s&&l&&1==o.childCount;)o=o.firstChild.content,s--,l--;let a=new r.Ji(o,s,l);return t>-1?new m(i.pos,t,this.$to.pos,this.$to.end(),a,e):a.size||i.pos!=this.$to.pos?new p(i.pos,n.pos,a):null}findFittable(){let t=this.unplaced.openStart;for(let e=this.unplaced.content,i=0,r=this.unplaced.openEnd;i<t;i++){let n=e.firstChild;if(e.childCount>1&&(r=0),n.type.spec.isolating&&r<=i){t=i;break}e=n.content}for(let e=1;e<=2;e++)for(let i=1==e?t:this.unplaced.openStart;i>=0;i--){let t,n=null,o=(i?(n=H(this.unplaced.content,i-1).firstChild).content:this.unplaced.content).firstChild;for(let t=this.depth;t>=0;t--){let{type:s,match:l}=this.frontier[t],a,h=null;if(1==e&&(o?l.matchType(o.type)||(h=l.fillBefore(r.FK.from(o),!1)):n&&s.compatibleContent(n.type)))return{sliceDepth:i,frontierDepth:t,parent:n,inject:h};if(2==e&&o&&(a=l.findWrapping(o.type)))return{sliceDepth:i,frontierDepth:t,parent:n,wrap:a};if(n&&l.matchType(n.type))break}}}openMore(){let{content:t,openStart:e,openEnd:i}=this.unplaced,n=H(t,e);return!!n.childCount&&!n.firstChild.isLeaf&&(this.unplaced=new r.Ji(t,e+1,Math.max(i,n.size+e>=t.size-i?e+1:0)),!0)}dropNode(){let{content:t,openStart:e,openEnd:i}=this.unplaced,n=H(t,e);if(n.childCount<=1&&e>0){let o=t.size-e<=e+n.size;this.unplaced=new r.Ji(A(t,e-1,1),e-1,o?e-1:i)}else this.unplaced=new r.Ji(A(t,e,1),e,i)}placeNodes({sliceDepth:t,frontierDepth:e,parent:i,inject:n,wrap:o}){for(;this.depth>e;)this.closeFrontierNode();if(o)for(let t=0;t<o.length;t++)this.openFrontierNode(o[t]);let s=this.unplaced,l=i?i.content:s.content,a=s.openStart-t,h=0,u=[],{match:c,type:d}=this.frontier[e];if(n){for(let t=0;t<n.childCount;t++)u.push(n.child(t));c=c.matchFragment(n)}let g=l.size+t-(s.content.size-s.openEnd);for(;h<l.childCount;){let t=l.child(h),e=c.matchType(t.type);if(!e)break;(++h>1||0==a||t.content.size)&&(c=e,u.push(function t(e,i,n){if(i<=0)return e;let o=e.content;return i>1&&(o=o.replaceChild(0,t(o.firstChild,i-1,1==o.childCount?n-1:0))),i>0&&(o=e.type.contentMatch.fillBefore(o).append(o),n<=0&&(o=o.append(e.type.contentMatch.matchFragment(o).fillBefore(r.FK.empty,!0)))),e.copy(o)}(t.mark(d.allowedMarks(t.marks)),1==h?a:0,h==l.childCount?g:-1)))}let f=h==l.childCount;f||(g=-1),this.placed=N(this.placed,e,r.FK.from(u)),this.frontier[e].match=c,f&&g<0&&i&&i.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let t=0,e=l;t<g;t++){let t=e.lastChild;this.frontier.push({type:t.type,match:t.contentMatchAt(t.childCount)}),e=t.content}this.unplaced=f?0==t?r.Ji.empty:new r.Ji(A(s.content,t-1,1),t-1,g<0?s.openEnd:t-1):new r.Ji(A(s.content,t,h),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return -1;let t=this.frontier[this.depth],e;if(!t.type.isTextblock||!P(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return -1;let{depth:i}=this.$to,r=this.$to.after(i);for(;i>1&&r==this.$to.end(--i);)++r;return r}findCloseLevel(t){t:for(let e=Math.min(this.depth,t.depth);e>=0;e--){let{match:i,type:r}=this.frontier[e],n=e<t.depth&&t.end(e+1)==t.pos+(t.depth-(e+1)),o=P(t,e,r,i,n);if(o){for(let i=e-1;i>=0;i--){let{match:e,type:r}=this.frontier[i],n=P(t,i,r,e,!0);if(!n||n.childCount)continue t}return{depth:e,fit:o,move:n?t.doc.resolve(t.after(e+1)):t}}}}close(t){let e=this.findCloseLevel(t);if(!e)return null;for(;this.depth>e.depth;)this.closeFrontierNode();e.fit.childCount&&(this.placed=N(this.placed,e.depth,e.fit)),t=e.move;for(let i=e.depth+1;i<=t.depth;i++){let e=t.node(i),r=e.type.contentMatch.fillBefore(e.content,!0,t.index(i));this.openFrontierNode(e.type,e.attrs,r)}return t}openFrontierNode(t,e=null,i){let n=this.frontier[this.depth];n.match=n.match.matchType(t),this.placed=N(this.placed,this.depth,r.FK.from(t.create(e,i))),this.frontier.push({type:t,match:t.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(r.FK.empty,!0);t.childCount&&(this.placed=N(this.placed,this.frontier.length,t))}}function A(t,e,i){return 0==e?t.cutByIndex(i,t.childCount):t.replaceChild(0,t.firstChild.copy(A(t.firstChild.content,e-1,i)))}function N(t,e,i){return 0==e?t.append(i):t.replaceChild(t.childCount-1,t.lastChild.copy(N(t.lastChild.content,e-1,i)))}function H(t,e){for(let i=0;i<e;i++)t=t.firstChild.content;return t}function P(t,e,i,r,n){let o=t.node(e),s=n?t.indexAfter(e):t.index(e);if(s==o.childCount&&!i.compatibleContent(o.type))return null;let l=r.fillBefore(o.content,!0,s);return l&&!function(t,e,i){for(let r=i;r<e.childCount;r++)if(!t.allowsMarks(e.child(r).marks))return!0;return!1}(i,o.content,s)?l:null}function _(t,e){let i=[],r=Math.min(t.depth,e.depth);for(let n=r;n>=0;n--){let r=t.start(n);if(r<t.pos-(t.depth-n)||e.end(n)>e.pos+(e.depth-n)||t.node(n).type.spec.isolating||e.node(n).type.spec.isolating)break;(r==e.start(n)||n==t.depth&&n==e.depth&&t.parent.inlineContent&&e.parent.inlineContent&&n&&e.start(n-1)==r-1)&&i.push(n)}return i}class D extends a{constructor(t,e,i){super(),this.pos=t,this.attr=e,this.value=i}apply(t){let e=t.nodeAt(this.pos);if(!e)return h.fail("No node at attribute step's position");let i=Object.create(null);for(let t in e.attrs)i[t]=e.attrs[t];i[this.attr]=this.value;let n=e.type.create(i,null,e.marks);return h.fromReplace(t,this.pos,this.pos+1,new r.Ji(r.FK.from(n),0,+!e.isLeaf))}getMap(){return o.empty}invert(t){return new D(this.pos,this.attr,t.nodeAt(this.pos).attrs[this.attr])}map(t){let e=t.mapResult(this.pos,1);return e.deletedAfter?null:new D(e.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(t,e){if("number"!=typeof e.pos||"string"!=typeof e.attr)throw RangeError("Invalid input for AttrStep.fromJSON");return new D(e.pos,e.attr,e.value)}}a.jsonID("attr",D);class L extends a{constructor(t,e){super(),this.attr=t,this.value=e}apply(t){let e=Object.create(null);for(let i in t.attrs)e[i]=t.attrs[i];e[this.attr]=this.value;let i=t.type.create(e,t.content,t.marks);return h.ok(i)}getMap(){return o.empty}invert(t){return new L(this.attr,t.attrs[this.attr])}map(t){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(t,e){if("string"!=typeof e.attr)throw RangeError("Invalid input for DocAttrStep.fromJSON");return new L(e.attr,e.value)}}a.jsonID("docAttr",L);let F=class extends Error{};(F=function t(e){let i=Error.call(this,e);return i.__proto__=t.prototype,i}).prototype=Object.create(Error.prototype),F.prototype.constructor=F,F.prototype.name="TransformError";class V{constructor(t){this.doc=t,this.steps=[],this.docs=[],this.mapping=new s}get before(){return this.docs.length?this.docs[0]:this.doc}step(t){let e=this.maybeStep(t);if(e.failed)throw new F(e.failed);return this}maybeStep(t){let e=t.apply(this.doc);return e.failed||this.addStep(t,e.doc),e}get docChanged(){return this.steps.length>0}addStep(t,e){this.docs.push(this.doc),this.steps.push(t),this.mapping.appendMap(t.getMap()),this.doc=e}replace(t,e=t,i=r.Ji.empty){let n=k(this.doc,t,e,i);return n&&this.step(n),this}replaceWith(t,e,i){return this.replace(t,e,new r.Ji(r.FK.from(i),0,0))}delete(t,e){return this.replace(t,e,r.Ji.empty)}insert(t,e){return this.replaceWith(t,t,e)}replaceRange(t,e,i){return!function(t,e,i,n){if(!n.size)return t.deleteRange(e,i);let o=t.doc.resolve(e),s=t.doc.resolve(i);if(O(o,s,n))return t.step(new p(e,i,n));let l=_(o,t.doc.resolve(i));0==l[l.length-1]&&l.pop();let a=-(o.depth+1);l.unshift(a);for(let t=o.depth,e=o.pos-1;t>0;t--,e--){let i=o.node(t).type.spec;if(i.defining||i.definingAsContext||i.isolating)break;l.indexOf(t)>-1?a=t:o.before(t)==e&&l.splice(1,0,-t)}let h=l.indexOf(a),u=[],c=n.openStart;for(let t=n.content,e=0;;e++){let i=t.firstChild;if(u.push(i),e==n.openStart)break;t=i.content}for(let t=c-1;t>=0;t--){var d;let e=u[t],i=(d=e.type).spec.defining||d.spec.definingForContent;if(i&&!e.sameMarkup(o.node(Math.abs(a)-1)))c=t;else if(i||!e.type.isTextblock)break}for(let e=n.openStart;e>=0;e--){let a=(e+c+1)%(n.openStart+1),d=u[a];if(d)for(let e=0;e<l.length;e++){let u=l[(e+h)%l.length],c=!0;u<0&&(c=!1,u=-u);let g=o.node(u-1),f=o.index(u-1);if(g.canReplaceWith(f,f,d.type,d.marks))return t.replace(o.before(u),c?s.after(u):i,new r.Ji(function t(e,i,n,o,s){if(i<n){let r=e.firstChild;e=e.replaceChild(0,r.copy(t(r.content,i+1,n,o,r)))}if(i>o){let t=s.contentMatchAt(0),i=t.fillBefore(e).append(e);e=i.append(t.matchFragment(i).fillBefore(r.FK.empty,!0))}return e}(n.content,0,n.openStart,a),a,n.openEnd))}}let g=t.steps.length;for(let r=l.length-1;r>=0&&(t.replace(e,i,n),!(t.steps.length>g));r--){let t=l[r];t<0||(e=o.before(t),i=s.after(t))}}(this,t,e,i),this}replaceRangeWith(t,e,i){return!function(t,e,i,n){if(!n.isInline&&e==i&&t.doc.resolve(e).parent.content.size){let r=function(t,e,i){let r=t.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),i))return e;if(0==r.parentOffset)for(let t=r.depth-1;t>=0;t--){let e=r.index(t);if(r.node(t).canReplaceWith(e,e,i))return r.before(t+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let t=r.depth-1;t>=0;t--){let e=r.indexAfter(t);if(r.node(t).canReplaceWith(e,e,i))return r.after(t+1);if(e<r.node(t).childCount)break}return null}(t.doc,e,n.type);null!=r&&(e=i=r)}t.replaceRange(e,i,new r.Ji(r.FK.from(n),0,0))}(this,t,e,i),this}deleteRange(t,e){return!function(t,e,i){let r=t.doc.resolve(e),n=t.doc.resolve(i),o=_(r,n);for(let e=0;e<o.length;e++){let i=o[e],s=e==o.length-1;if(s&&0==i||r.node(i).type.contentMatch.validEnd)return t.delete(r.start(i),n.end(i));if(i>0&&(s||r.node(i-1).canReplace(r.index(i-1),n.indexAfter(i-1))))return t.delete(r.before(i),n.after(i))}for(let o=1;o<=r.depth&&o<=n.depth;o++)if(e-r.start(o)==r.depth-o&&i>r.end(o)&&n.end(o)-i!=n.depth-o&&r.start(o-1)==n.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),n.index(o-1)))return t.delete(r.before(o),i);t.delete(e,i)}(this,t,e),this}lift(t,e){return!function(t,e,i){let{$from:n,$to:o,depth:s}=e,l=n.before(s+1),a=o.after(s+1),h=l,u=a,c=r.FK.empty,d=0;for(let t=s,e=!1;t>i;t--)e||n.index(t)>0?(e=!0,c=r.FK.from(n.node(t).copy(c)),d++):h--;let g=r.FK.empty,f=0;for(let t=s,e=!1;t>i;t--)e||o.after(t+1)<o.end(t)?(e=!0,g=r.FK.from(o.node(t).copy(g)),f++):u++;t.step(new m(h,u,l,a,new r.Ji(c.append(g),d,f),c.size-d,!0))}(this,t,e),this}join(t,e=1){return!function(t,e,i){let n=null,{linebreakReplacement:o}=t.doc.type.schema,s=t.doc.resolve(e-i),l=s.node().type;if(o&&l.inlineContent){let t="pre"==l.whitespace,e=!!l.contentMatch.matchType(o);t&&!e?n=!1:!t&&e&&(n=!0)}let a=t.steps.length;if(!1===n){let r=t.doc.resolve(e+i);R(t,r.node(),r.before(),a)}l.inlineContent&&y(t,e+i-1,l,s.node().contentMatchAt(s.index()),null==n);let h=t.mapping.slice(a),u=h.map(e-i);if(t.step(new p(u,h.map(e+i,-1),r.Ji.empty,!0)),!0===n){let e=t.doc.resolve(u);E(t,e.node(),e.before(),t.steps.length)}}(this,t,e),this}wrap(t,e){return!function(t,e,i){let n=r.FK.empty;for(let t=i.length-1;t>=0;t--){if(n.size){let e=i[t].type.contentMatch.matchFragment(n);if(!e||!e.validEnd)throw RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}n=r.FK.from(i[t].type.create(i[t].attrs,n))}let o=e.start,s=e.end;t.step(new m(o,s,o,s,new r.Ji(n,0,0),i.length,!0))}(this,t,e),this}setBlockType(t,e=t,i,n=null){return!function(t,e,i,n,o){if(!n.isTextblock)throw RangeError("Type given to setBlockType should be a textblock");let s=t.steps.length;t.doc.nodesBetween(e,i,(e,i)=>{var l,a,h;let u,c,d="function"==typeof o?o(e):o;if(e.isTextblock&&!e.hasMarkup(n,d)&&(l=t.doc,a=t.mapping.slice(s).map(i),h=n,c=(u=l.resolve(a)).index(),u.parent.canReplaceWith(c,c+1,h))){let o=null;if(n.schema.linebreakReplacement){let t="pre"==n.whitespace,e=!!n.contentMatch.matchType(n.schema.linebreakReplacement);t&&!e?o=!1:!t&&e&&(o=!0)}!1===o&&R(t,e,i,s),y(t,t.mapping.slice(s).map(i,1),n,void 0,null===o);let l=t.mapping.slice(s),a=l.map(i,1),h=l.map(i+e.nodeSize,1);return t.step(new m(a,h,a+1,h-1,new r.Ji(r.FK.from(n.create(d,null,e.marks)),0,0),1,!0)),!0===o&&E(t,e,i,s),!1}})}(this,t,e,i,n),this}setNodeMarkup(t,e,i=null,n){return!function(t,e,i,n,o){let s=t.doc.nodeAt(e);if(!s)throw RangeError("No node at given position");i||(i=s.type);let l=i.create(n,null,o||s.marks);if(s.isLeaf)return t.replaceWith(e,e+s.nodeSize,l);if(!i.validContent(s.content))throw RangeError("Invalid content for node type "+i.name);t.step(new m(e,e+s.nodeSize,e+1,e+s.nodeSize-1,new r.Ji(r.FK.from(l),0,0),1,!0))}(this,t,e,i,n),this}setNodeAttribute(t,e,i){return this.step(new D(t,e,i)),this}setDocAttribute(t,e){return this.step(new L(t,e)),this}addNodeMark(t,e){return this.step(new g(t,e)),this}removeNodeMark(t,e){let i=this.doc.nodeAt(t);if(!i)throw RangeError("No node at position "+t);if(e instanceof r.CU)e.isInSet(i.marks)&&this.step(new f(t,e));else{let r=i.marks,n,o=[];for(;n=e.isInSet(r);)o.push(new f(t,n)),r=n.removeFromSet(r);for(let t=o.length-1;t>=0;t--)this.step(o[t])}return this}split(t,e=1,i){return!function(t,e,i=1,n){let o=t.doc.resolve(e),s=r.FK.empty,l=r.FK.empty;for(let t=o.depth,e=o.depth-i,a=i-1;t>e;t--,a--){s=r.FK.from(o.node(t).copy(s));let e=n&&n[a];l=r.FK.from(e?e.type.create(e.attrs,l):o.node(t).copy(l))}t.step(new p(e,e,new r.Ji(s.append(l),i,i),!0))}(this,t,e,i),this}addMark(t,e,i){var r;let n,o,s,l;return r=this,s=[],l=[],r.doc.nodesBetween(t,e,(r,a,h)=>{if(!r.isInline)return;let u=r.marks;if(!i.isInSet(u)&&h.type.allowsMarkType(i.type)){let h=Math.max(a,t),g=Math.min(a+r.nodeSize,e),f=i.addToSet(u);for(let t=0;t<u.length;t++)u[t].isInSet(f)||(n&&n.to==h&&n.mark.eq(u[t])?n.to=g:s.push(n=new d(h,g,u[t])));o&&o.to==h?o.to=g:l.push(o=new c(h,g,i))}}),s.forEach(t=>r.step(t)),l.forEach(t=>r.step(t)),this}removeMark(t,e,i){var n;let o,s;return n=this,o=[],s=0,n.doc.nodesBetween(t,e,(n,l)=>{if(!n.isInline)return;s++;let a=null;if(i instanceof r.sX){let t=n.marks,e;for(;e=i.isInSet(t);)(a||(a=[])).push(e),t=e.removeFromSet(t)}else i?i.isInSet(n.marks)&&(a=[i]):a=n.marks;if(a&&a.length){let i=Math.min(l+n.nodeSize,e);for(let e=0;e<a.length;e++){let r=a[e],n;for(let t=0;t<o.length;t++){let e=o[t];e.step==s-1&&r.eq(o[t].style)&&(n=e)}n?(n.to=i,n.step=s):o.push({style:r,from:Math.max(l,t),to:i,step:s})}}}),o.forEach(t=>n.step(new d(t.from,t.to,t.style))),this}clearIncompatible(t,e,i){return y(this,t,e,i),this}}},927:(t,e,i)=>{"use strict";i.d(e,{v:()=>n,z:()=>o}),i(12252),i(29954);var r=i(95061);function n(t,e){return(0,r.arrayMap)(t,t=>t-e.filter(e=>e<t).length)}function o(t,e){let i=e[0],n=e.length;return(0,r.arrayMap)(t,t=>t>=i?t+n:t)}},1354:(t,e,i)=>{"use strict";i.d(e,{p:()=>p}),i(41658),i(19398);var r=i(93924),n=i(75708);i(12252),i(29954),i(20775);var o=i(18045),s=i(15616),l=i(19857),a=i(95061),h=i(13455),u=i(78887);function c(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class d{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(t,e,i){c(this,"hot",void 0),c(this,"metaManager",void 0),c(this,"tableMeta",void 0),c(this,"dataSource",void 0),c(this,"duckSchema",void 0),c(this,"colToPropCache",void 0),c(this,"propToColCache",void 0),this.hot=t,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=e,this.refreshDuckSchema(),this.createMap()}createMap(){let t,e=this.getSchema();if(void 0===e)throw Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");let i=this.tableMeta.columns;if(this.colToPropCache=[],this.propToColCache=new Map,i){let r=0,n=0,o=!1;if("function"==typeof i){let t=(0,l.deepObjectSize)(e);r=t>0?t:this.countFirstRowKeys(),o=!0}else r=Math.min(this.tableMeta.maxCols,i.length);for(t=0;t<r;t++){let e=o?i(t):i[t];if((0,l.isObject)(e)){if(void 0!==e.data){let i=o?n:t;this.colToPropCache[i]=e.data,this.propToColCache.set(e.data,i)}n+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return(0,s.countFirstRowKeys)(this.dataSource)}recursiveDuckColumns(t,e,i){let r,n=e,o=i;return void 0===n&&(n=0,o=""),"object"!=typeof t||Array.isArray(t)||(0,l.objectEach)(t,(t,e)=>{null===t?(r=o+e,this.colToPropCache.push(r),this.propToColCache.set(r,n),n+=1):n=this.recursiveDuckColumns(t,n,`${e}.`)}),n}colToProp(t){if(!1===Number.isInteger(t))return t;let e=this.hot.toPhysicalColumn(t);return null===e?t:this.colToPropCache&&(0,u.isDefined)(this.colToPropCache[e])?this.colToPropCache[e]:e}propToCol(t){let e=this.propToColCache.get(t);if((0,u.isDefined)(e))return this.hot.toVisualColumn(e);let i=this.hot.toVisualColumn(t);return null===i?t:i}getSchema(){let t=this.tableMeta.dataSchema;return t?"function"==typeof t?t():t:(0,this.duckSchema)}createDuckSchema(){return this.dataSource&&this.dataSource[0]?(0,l.duckSchema)(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=this.hot.countSourceRows(),o=n,s=0,a=t;if(("number"!=typeof a||a>=n)&&(a=n),a<this.hot.countRows()&&(o=this.hot.toPhysicalRow(a)),!1===this.hot.runHooks("beforeCreateRow",a,e,i)||null===o)return{delta:0};let u=this.tableMeta.maxRows,c=this.getSchema().length,d=[];for(;s<e&&n+s<u;){let t=null;"array"===this.hot.dataType?this.tableMeta.dataSchema?t=(0,l.deepClone)(this.getSchema()):(t=[],(0,h.rangeEach)(c-1,()=>t.push(null))):"function"===this.hot.dataType?t=this.tableMeta.dataSchema(a+s):(t={},(0,l.deepExtend)(t,this.getSchema())),d.push(t),s+=1}this.hot.rowIndexMapper.insertIndexes(a,s),"below"===r&&(o=Math.min(o+1,n)),this.spliceData(o,0,d);let g=this.hot.toVisualRow(o);return this.hot.countSourceRows()===d.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),s>0&&(null==t?this.metaManager.createRow(null,s):"auto"!==i&&this.metaManager.createRow(o,e)),this.hot.runHooks("afterCreateRow",g,s,i),{delta:s,startPhysicalIndex:o}}createCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");let n=this.dataSource,o=this.tableMeta.maxCols,s=this.hot.countSourceCols(),l=t;if(("number"!=typeof l||l>=s)&&(l=s),!1===this.hot.runHooks("beforeCreateCol",l,e,i))return{delta:0};let a=s;l<this.hot.countCols()&&(a=this.hot.toPhysicalColumn(l));let h=this.hot.countSourceRows(),u=this.hot.countCols(),c=0,d=a;"end"===r&&(d=Math.min(d+1,s));let g=d;for(;c<e&&u<o;){if("number"!=typeof l||l>=u)if(h>0)for(let t=0;t<h;t+=1)void 0===n[t]&&(n[t]=[]),n[t].push(null);else n.push([null]);else for(let t=0;t<h;t++)n[t].splice(d,0,null);c+=1,d+=1,u+=1}this.hot.columnIndexMapper.insertIndexes(l,c),c>0&&(null==t?this.metaManager.createColumn(null,c):"auto"!==i&&this.metaManager.createColumn(g,e));let f=this.hot.toVisualColumn(g);return this.hot.runHooks("afterCreateCol",f,c,i),this.refreshDuckSchema(),{delta:c,startPhysicalIndex:g}}removeRow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(t)?t:-e,n=this.visualRowsToPhysical(r,e),o=this.hot.countSourceRows();if(r=(o+r)%o,!1===this.hot.runHooks("beforeRemoveRow",r,n.length,n,i))return!1;let s=n.length;if(this.filterData(r,s,n),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(n);let t=(0,u.isDefined)(this.tableMeta.columns)||(0,u.isDefined)(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;0!==this.hot.rowIndexMapper.getNotTrimmedIndexesLength()||t||this.hot.columnIndexMapper.setIndexesSequence([])}return n.slice(0).sort((t,e)=>e-t).forEach(t=>{this.metaManager.removeRow(t,1)}),this.hot.runHooks("afterRemoveRow",r,s,n,i),!0}removeCol(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if("object"===this.hot.dataType||this.tableMeta.columns)throw Error("cannot remove column with object data source or columns option specified");let r="number"!=typeof t?-e:t;r=(this.hot.countCols()+r)%this.hot.countCols();let n=this.visualColumnsToPhysical(r,e),o=n.slice(0).sort((t,e)=>e-t);if(!1===this.hot.runHooks("beforeRemoveCol",r,e,n,i))return!1;let s=!0,l=o.length,a=this.dataSource;for(let t=0;t<l;t++)s&&n[0]!==n[t]-t&&(s=!1);if(s)for(let t=0,i=this.hot.countSourceRows();t<i;t++)a[t].splice(n[0],e),0===t&&this.metaManager.removeColumn(n[0],e);else for(let t=0,e=this.hot.countSourceRows();t<e;t++)for(let e=0;e<l;e++)a[t].splice(o[e],1),0===t&&this.metaManager.removeColumn(o[e],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(n),this.tableMeta.rowHeaders||0!==this.hot.columnIndexMapper.getNotTrimmedIndexesLength()||this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,e,n,i),this.refreshDuckSchema(),!0}spliceCol(t,e,i){let r=this.hot.getDataAtCol(t),n=r.slice(e,e+i),o=r.slice(e+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.extendArray)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return(0,a.to2dArray)(l),this.hot.populateFromArray(e,t,l,null,null,"spliceCol"),n}spliceRow(t,e,i){let r=this.hot.getSourceDataAtRow(t),n=r.slice(e,e+i),o=r.slice(e+i);for(var s=arguments.length,l=Array(s>3?s-3:0),h=3;h<s;h++)l[h-3]=arguments[h];(0,a.extendArray)(l,o);let u=0;for(;u<i;)l.push(null),u+=1;return this.hot.populateFromArray(t,e,[l],null,null,"spliceRow"),n}spliceData(t,e,i){if(!1!==this.hot.runHooks("beforeDataSplice",t,e,i)){let e=[...this.dataSource.slice(0,t),...i,...this.dataSource.slice(t)];this.dataSource.length=0,e.forEach(t=>this.dataSource.push(t))}}filterData(t,e,i){let r=this.hot.runHooks("filterData",t,e,i);!1===Array.isArray(r)&&(r=this.dataSource.filter((t,e)=>-1===i.indexOf(e))),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(t,e){let i=this.hot.toPhysicalRow(t),r=this.dataSource[i],n=this.hot.runHooks("modifyRowData",i);r=isNaN(n)?n:r;let{dataDotNotation:o}=this.hot.getSettings(),s=null;if(r&&r.hasOwnProperty&&(0,l.hasOwnProperty)(r,e))s=r[e];else if(o&&"string"==typeof e&&e.indexOf(".")>-1){let t=r;if(!t)return null;let i=e.split(".");for(let e=0,r=i.length;e<r;e++)if(void 0===(t=t[i[e]]))return null;s=t}else"function"==typeof e&&(s=e(this.dataSource.slice(i,i+1)[0]));if(this.hot.hasHook("modifyData")){let t=(0,l.createObjectPropListener)(s);this.hot.runHooks("modifyData",i,this.propToCol(e),t,"get"),t.isTouched()&&(s=t.value)}return s}getCopyable(t,e){return this.hot.getCellMeta(t,this.propToCol(e)).copyable?this.get(t,e):""}set(t,e,i){let r=this.hot.toPhysicalRow(t),n=i,o=this.dataSource[r],s=this.hot.runHooks("modifyRowData",r);if(o=isNaN(s)?s:o,this.hot.hasHook("modifyData")){let t=(0,l.createObjectPropListener)(n);this.hot.runHooks("modifyData",r,this.propToCol(e),t,"set"),t.isTouched()&&(n=t.value)}let{dataDotNotation:a}=this.hot.getSettings();if(o&&o.hasOwnProperty&&(0,l.hasOwnProperty)(o,e))o[e]=n;else if(a&&"string"==typeof e&&e.indexOf(".")>-1){let t,i=o,r=0,s=e.split(".");for(r=0,t=s.length-1;r<t;r++){if("__proto__"===s[r]||"constructor"===s[r]||"prototype"===s[r])return;void 0===i[s[r]]&&(i[s[r]]={}),i=i[s[r]]}i[s[r]]=n}else if("function"==typeof e)e(this.dataSource.slice(r,r+1)[0],n);else{if("__proto__"===e||"constructor"===e||"prototype"===e)return;o[e]=n}}visualRowsToPhysical(t,e){let i=this.hot.countSourceRows(),r=[],n=(i+t)%i,o=e;for(;n<i&&o;)r.push(this.hot.toPhysicalRow(n)),o-=1,n+=1;return r}visualColumnsToPhysical(t,e){let i=this.hot.countCols(),r=[],n=(i+t)%i,o=e;for(;n<i&&o;){let t=this.hot.toPhysicalColumn(n);r.push(t),o-=1,n+=1}return r}clear(){for(let t=0;t<this.hot.countSourceRows();t++)for(let e=0;e<this.hot.countCols();e++)this.set(t,this.colToProp(e),"")}getLength(){let t=this.tableMeta.maxRows;return Math.min(this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),t<0||0===t?0:t||1/0)}getAll(){let t={row:0,col:0},e={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return t.row-e.row!=0||this.hot.countSourceRows()?this.getRange(t,e,d.DESTINATION_RENDERER):[]}countCachedColumns(){return this.colToPropCache.length}getRange(t,e,i){let r,n,o,s=[],l=this.tableMeta.maxRows,a=this.tableMeta.maxCols;if(0===l||0===a)return[];let h=i===d.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,u=Math.min(Math.max(l-1,0),Math.max(t.row,e.row)),c=Math.min(Math.max(a-1,0),Math.max(t.col,e.col));for(r=Math.min(t.row,e.row);r<=u;r++){o=[];let i=r>=0?this.hot.toPhysicalRow(r):r;for(n=Math.min(t.col,e.col);n<=c&&null!==i;n++)o.push(h.call(this,r,this.colToProp(n)));null!==i&&s.push(o)}return s}getText(t,e){return(0,o.A)(this.getRange(t,e,d.DESTINATION_RENDERER))}getCopyableText(t,e){return(0,o.A)(this.getRange(t,e,d.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}var g=i(33787),f=i(91748);function p(t,e,i,o){let{hotInstance:s,dataMap:a,dataSource:h,internalSource:u,source:c,metaManager:p,firstRun:m}=o,w=(0,r.toUpperCaseFirst)(u),y=s.getSettings();Array.isArray(y.dataSchema)?s.dataType="array":(0,n.isFunction)(y.dataSchema)?s.dataType="function":s.dataType="object",a&&a.destroy(),t=s.runHooks(`before${w}`,t,m,c);let b=new d(s,t,p);if(e(b),"object"==typeof t&&null!==t)t.push&&t.splice||(t=[t]);else if(null===t){let e,i=b.getSchema();t=[];let r=0,n=0;for(r=0,n=y.startRows;r<n;r++)if(("object"===s.dataType||"function"===s.dataType)&&y.dataSchema)e=(0,l.deepClone)(i),t.push(e);else if("array"===s.dataType)e=(0,l.deepClone)(i[0]),t.push(e);else{e=[];for(let t=0,i=y.startCols;t<i;t++)e.push(null);t.push(e)}}else throw Error(`${u} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(s.dataType="array"),y.data=t,b.dataSource=t,h.data=t,h.dataType=s.dataType,h.colToProp=b.colToProp.bind(b),h.propToCol=b.propToCol.bind(b),h.countCachedColumns=b.countCachedColumns.bind(b),i(b),s.runHooks(`after${w}`,t,m,c),m||(s.runHooks("afterChange",null,u),s.render()),s.getSettings().ariaTags&&(0,g.setAttribute)(s.rootElement,[(0,f.DZ)(-1),(0,f.Nb)(s.countCols()+(s.view?s.countRowHeaders():0))])}},1416:(t,e,i)=>{"use strict";var r=i(94272),n=i(16954),o=i(71310),s=i(15743),l=i(6497),a=n.add,h=n.has,u=n.remove;t.exports=function(t){var e=r(this),i=s(t).getIterator(),n=o(e);return l(i,function(t){h(e,t)?u(n,t):a(n,t)}),n}},1728:(t,e,i)=>{"use strict";var r=i(76494),n=i(24201);t.exports=function(t,e){r(e)&&"cause"in e&&n(t,"cause",e.cause)}},1730:(t,e,i)=>{"use strict";var r=i(42620),n=i(62495),o=i(99365),s=i(28060),l=i(53469),a=i(13928),h=i(46724),u=r.Function,c=/MSIE .\./.test(l)||"BUN"===s&&function(){var t=r.Bun.version.split(".");return t.length<3||"0"===t[0]&&(t[1]<3||"3"===t[1]&&"0"===t[2])}();t.exports=function(t,e){var i=e?2:1;return c?function(r,s){var l=h(arguments.length,1)>i,c=o(r)?r:u(r),d=l?a(arguments,i):[],g=l?function(){n(c,this,d)}:c;return e?t(g,s):t(g)}:t}},2048:(t,e,i)=>{"use strict";t.exports=i(11609)&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},2254:(t,e,i)=>{"use strict";var r=i(85592);t.exports=Array.isArray||function(t){return"Array"===r(t)}},2769:(t,e,i)=>{"use strict";var r=i(14412),n=i(2254),o=TypeError,s=Object.getOwnPropertyDescriptor;t.exports=r&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}()?function(t,e){if(n(t)&&!s(t,"length").writable)throw new o("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},3422:(t,e,i)=>{"use strict";i.d(e,{A:()=>iA}),i(41658),i(19398);var r=i(33787),n=i(57555),o=i(13115),s=i(75708),l=i(23544),a=i(59594),h=i(78887);function u(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function c(t,e){return t.get(g(t,e))}function d(t,e,i){return t.set(g(t,e),i),i}function g(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var f=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakMap,C=new WeakMap,S=new WeakMap,E=new WeakMap,R=new WeakMap;class T{constructor(t,e,i,r,n,o){let s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;u(this,f,void 0),u(this,p,void 0),u(this,m,void 0),u(this,w,void 0),u(this,y,void 0),u(this,b,void 0),u(this,C,void 0),u(this,S,void 0),u(this,E,[null,null]),u(this,R,[null,null]),d(f,this,i),d(p,this,e),d(m,this,n),d(w,this,o),d(y,this,s),d(b,this,r),d(C,this,t),this.registerEvents()}registerEvents(){c(b,this).addEventListener(c(m,this).holder,"contextmenu",t=>this.onContextMenu(t)),c(b,this).addEventListener(c(m,this).TABLE,"mouseover",t=>this.onMouseOver(t)),c(b,this).addEventListener(c(m,this).TABLE,"mouseout",t=>this.onMouseOut(t));let t=()=>{c(b,this).addEventListener(c(m,this).holder,"touchstart",t=>this.onTouchStart(t)),c(b,this).addEventListener(c(m,this).holder,"touchend",t=>this.onTouchEnd(t)),this.momentumScrolling||(this.momentumScrolling={}),c(b,this).addEventListener(c(m,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||c(f,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,c(f,this).getSetting("onAfterMomentumScroll"))},200)})};(0,a.isMobileBrowser)()?t():((0,l.isTouchSupported)()&&t(),c(b,this).addEventListener(c(m,this).holder,"mouseup",t=>this.onMouseUp(t)),c(b,this).addEventListener(c(m,this).holder,"mousedown",t=>this.onMouseDown(t)))}selectedCellWasTouched(t){let e=this.parentCell(t).coords;if(c(S,this)&&e){let[t,i]=[e.row,c(S,this).from.row],[r,n]=[e.col,c(S,this).from.col];return t===i&&r===n}return!1}parentCell(t){let e={},i=c(m,this).TABLE,n=(0,r.closestDown)(t,["TD","TH"],i);return n?(e.coords=c(m,this).getCoords(n),e.TD=n):(0,r.hasClass)(t,"wtBorder")&&(0,r.hasClass)(t,"current")?(e.coords=c(w,this).getFocusSelection().cellRange.highlight,e.TD=c(m,this).getCell(e.coords)):(0,r.hasClass)(t,"wtBorder")&&(0,r.hasClass)(t,"area")&&c(w,this).getAreaSelection().cellRange&&(e.coords=c(w,this).getAreaSelection().cellRange.to,e.TD=c(m,this).getCell(e.coords)),e}onMouseDown(t){let e=c(p,this).rootDocument.activeElement,i=(0,s.partial)(r.getParent,t.target),n=t.target;if(!["TD","TH"].includes(e.nodeName)&&(n===e||i(0)===e||i(1)===e))return;let o=this.parentCell(n);(0,r.hasClass)(n,"corner")?c(f,this).getSetting("onCellCornerMouseDown",t,n):o.TD&&c(f,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",t,o.coords,o.TD),(0===t.button||this.touchApplied)&&o.TD&&(c(R,this)[0]=o.TD,clearTimeout(c(E,this)[0]),c(E,this)[0]=setTimeout(()=>{c(R,this)[0]=null},1e3))}onContextMenu(t){if(c(f,this).has("onCellContextMenu")){let e=this.parentCell(t.target);e.TD&&this.callListener("onCellContextMenu",t,e.coords,e.TD)}}onMouseOver(t){if(!c(f,this).has("onCellMouseOver"))return;let e=c(m,this).TABLE,i=(0,r.closestDown)(t.target,["TD","TH"],e),n=c(y,this)||this;i&&i!==n.lastMouseOver&&(0,r.isChildOf)(i,e)&&(n.lastMouseOver=i,this.callListener("onCellMouseOver",t,c(m,this).getCoords(i),i))}onMouseOut(t){if(!c(f,this).has("onCellMouseOut"))return;let e=c(m,this).TABLE,i=(0,r.closestDown)(t.target,["TD","TH"],e),n=(0,r.closestDown)(t.relatedTarget,["TD","TH"],e),o=c(y,this)||this;i&&i!==n&&(0,r.isChildOf)(i,e)&&(this.callListener("onCellMouseOut",t,c(m,this).getCoords(i),i),null===n&&(o.lastMouseOver=null))}onMouseUp(t){let e=this.parentCell(t.target);e.TD&&c(f,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",t,e.coords,e.TD),(0===t.button||this.touchApplied)&&(e.TD===c(R,this)[0]&&e.TD===c(R,this)[1]?((0,r.hasClass)(t.target,"corner")?this.callListener("onCellCornerDblClick",t,e.coords,e.TD):this.callListener("onCellDblClick",t,e.coords,e.TD),c(R,this)[0]=null,c(R,this)[1]=null):e.TD===c(R,this)[0]&&(c(R,this)[1]=e.TD,clearTimeout(c(E,this)[1]),c(E,this)[1]=setTimeout(()=>{c(R,this)[1]=null},500)))}onTouchStart(t){d(S,this,c(w,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(t)}onTouchEnd(t){var e;let i=t.target,r=null===(e=this.parentCell(i))||void 0===e?void 0:e.coords,n=(0,h.isDefined)(r)&&r.row>=0&&r.col>=0;t.cancelable&&n&&c(f,this).getSetting("isDataViewInstance")&&((0,a.isIOS)()&&((0,a.isChromeWebKit)()||(0,a.isFirefoxWebKit)())&&this.selectedCellWasTouched(i)&&!["A","BUTTON","INPUT"].includes(i.tagName)?t.preventDefault():this.selectedCellWasTouched(i)||t.preventDefault()),this.onMouseUp(t),this.touchApplied=!1}callListener(t,e,i,r){let n=c(f,this).getSettingPure(t);n&&n(e,i,r,c(C,this).call(this))}destroy(){clearTimeout(c(E,this)[0]),clearTimeout(c(E,this)[1]),c(b,this).destroy()}}i(12252),i(20775),i(43942);var x=i(95061),M=i(79791),k=i(57193);function O(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class I{constructor(t,e,i){O(this,"offset",void 0),O(this,"total",void 0),O(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleRowHeadedColumnToSourceColumn(t){return this.renderedToSource(this.offsettedTH(t))}sourceColumnToVisibleRowHeadedColumn(t){return this.unOffsettedTH(this.sourceToRendered(t))}}function A(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class N{constructor(t,e,i){A(this,"offset",void 0),A(this,"total",void 0),A(this,"countTH",void 0),this.offset=t,this.total=e,this.countTH=i}offsetted(t){return t+this.offset}unOffsetted(t){return t-this.offset}renderedToSource(t){return this.offsetted(t)}sourceToRendered(t){return this.unOffsetted(t)}offsettedTH(t){return t-this.countTH}unOffsettedTH(t){return t+this.countTH}visibleColHeadedRowToSourceRow(t){return this.renderedToSource(this.offsettedTH(t))}sourceRowToVisibleColHeadedRow(t){return this.unOffsettedTH(this.sourceToRendered(t))}}function H(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P{constructor(){H(this,"currentSize",0),H(this,"nextSize",0),H(this,"currentOffset",0),H(this,"nextOffset",0)}setSize(t){this.currentSize=this.nextSize,this.nextSize=t}setOffset(t){this.currentOffset=this.nextOffset,this.nextOffset=t}}function _(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class D{constructor(){_(this,"size",new P),_(this,"workingSpace",0),_(this,"sharedSize",null)}setSize(t){this.size.setSize(t)}setOffset(t){this.size.setOffset(t)}getViewSize(){return this.size}isShared(){return null!==this.sharedSize}isPlaceOn(t){return this.workingSpace===t}append(t){this.workingSpace=1,t.workingSpace=2,this.sharedSize=t.getViewSize()}prepend(t){this.workingSpace=2,t.workingSpace=1,this.sharedSize=t.getViewSize()}}i(69607);class L{constructor(t,e){!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"order",[]),this.order=[...Array(e).keys()].map(e=>t+e)}get length(){return this.order.length}has(t){return this.order.indexOf(t)>-1}get(t){return t<this.order.length?this.order[t]:-1}remove(t){this.order.splice(this.order.indexOf(t),1)}prepend(t){return this.order.unshift(t),this.order.pop()}}class F{constructor(t){!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"sizeSet",void 0),this.sizeSet=t}diff(){let{sizeSet:t}=this,{currentSize:e,nextSize:i}=t.getViewSize(),r=Math.max(i,e);if(0===r)return[];let{currentOffset:n,nextOffset:o}=t.getViewSize(),s=new L(n,e),l=new L(o,i),a=[];for(let e=0;e<r;e++){let n=s.get(e),o=l.get(e);if(-1===o)a.push(["remove",n]);else if(-1===n)!t.isShared()||t.isShared()&&t.isPlaceOn(2)?a.push(["append",o]):a.push(["prepend",o]);else if(o>n)s.has(o)&&(s.remove(o),i<=s.length&&(r-=1)),a.push(["replace",o,n]);else if(o<n){let t=s.prepend(o);a.push(["insert_before",o,n,t])}else a.push(["none",o])}return a}}function V(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class W{constructor(t,e){V(this,"rootNode",void 0),V(this,"nodesPool",void 0),V(this,"sizeSet",new D),V(this,"collectedNodes",[]),V(this,"viewDiffer",new F(this.sizeSet)),V(this,"leads",[]),this.rootNode=t,this.nodesPool=e}setSize(t){return this.sizeSet.setSize(t),this}setOffset(t){return this.sizeSet.setOffset(t),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(t){return t<this.collectedNodes.length?this.collectedNodes[t]:null}getCurrentNode(){let t=this.collectedNodes.length;return t>0?this.collectedNodes[t-1]:null}applyCommand(t){let{rootNode:e}=this,[i,r,n,o]=t,s=this.nodesPool(r);switch(this.collectedNodes.push(s),i){case"prepend":e.insertBefore(s,e.firstChild);break;case"append":e.appendChild(s);break;case"insert_before":e.insertBefore(s,this.nodesPool(n)),e.removeChild(this.nodesPool(o));break;case"replace":e.replaceChild(s,this.nodesPool(n));break;case"remove":e.removeChild(s)}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class B extends W{prependView(t){return this.sizeSet.prepend(t.sizeSet),t.sizeSet.append(this.sizeSet),this}appendView(t){return this.sizeSet.append(t.sizeSet),t.sizeSet.prepend(this.sizeSet),this}}function j(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class z{constructor(t){j(this,"nodeType",void 0),j(this,"pool",new Map),this.nodeType=t.toUpperCase()}setRootDocument(t){this.rootDocument=t}obtain(t,e){let i="number"==typeof e?`${t}x${e}`:t.toString();if(this.pool.has(i))return this.pool.get(i);let r=this.rootDocument.createElement(this.nodeType);return this.pool.set(i,r),r}}function U(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ${constructor(t,e){U(this,"nodesPool",null),U(this,"nodeType",void 0),U(this,"rootNode",void 0),U(this,"table",null),U(this,"renderedNodes",0),this.nodesPool="string"==typeof t?new z(t):null,this.nodeType=t,this.rootNode=e}setTable(t){this.nodesPool&&this.nodesPool.setRootDocument(t.rootDocument),this.table=t}adjust(){}render(){}}var Y=i(91748);function G(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class q extends ${constructor(){super("TH"),G(this,"orderViews",new WeakMap),G(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new B(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t)),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,rowHeaderFunctions:e,rowHeadersCount:i,rows:n,cells:o}=this.table;for(let s=0;s<t;s++){let t=this.table.renderedRowToSource(s),l=n.getRenderedNode(s);this.sourceRowIndex=t;let a=this.obtainOrderView(l),h=o.obtainOrderView(l);a.appendView(h).setSize(i).setOffset(0).start();for(let n=i-1;n>=0;n--){a.render();let i=a.getCurrentNode();i.className="",i.removeAttribute("style"),(0,r.removeAttribute)(i,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.setAttribute)(i,[(0,Y.Nf)(),(0,Y.D9)(),(0,Y.wD)(n+1),(0,Y.vC)(-1)]),e[n](t,i,n)}a.end()}}}class X extends ${constructor(t){super(null,t)}adjust(){let{columnHeadersCount:t,rowHeadersCount:e}=this.table,i=this.rootNode.firstChild;if(t){let{columnsToRender:r}=this.table,n=r+e;for(let e=0;e<t;e++){for((i=this.rootNode.childNodes[e])||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<n;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>n;)i.removeChild(i.lastChild),this.renderedNodes-=1}let o=this.rootNode.childNodes.length;if(o>t)for(let e=t;e<o;e++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&(0,r.empty)(i)}render(){let{columnHeadersCount:t}=this.table;this.table.isAriaEnabled()&&(0,r.setAttribute)(this.rootNode,[(0,Y.t0)()]);for(let e=0;e<t;e+=1){let{columnHeaderFunctions:t,columnsToRender:i,rowHeadersCount:n}=this.table,o=this.rootNode.childNodes[e];this.table.isAriaEnabled()&&(0,r.setAttribute)(o,[(0,Y.Sb)(),(0,Y.Qg)(e+1)]);for(let s=-1*n;s<i;s+=1){let i=this.table.renderedColumnToSource(s),l=o.childNodes[s+n];l.className="",l.removeAttribute("style"),(0,r.removeAttribute)(l,[RegExp("aria-(.*)"),/role/]),this.table.isAriaEnabled()&&(0,r.setAttribute)(l,[(0,Y.wD)(s+1+this.table.rowHeadersCount),(0,Y.vC)(-1),(0,Y.Jg)(),...s>=0?[(0,Y.L2)()]:[(0,Y.Sb)()]]),t[e](i,l,e)}}}}var K=i(83457);let J=!1;class Q extends ${constructor(t){super(null,t)}adjust(){let{columnsToRender:t,rowHeadersCount:e}=this.table,i=t+e;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();let{columnsToRender:t,rowHeadersCount:e}=this.table;!J&&t>1e3&&(J=!0,(0,k.R8)((0,K.O)`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let t=0;t<e;t++){let e=this.table.renderedColumnToSource(t),i=this.table.columnUtils.getHeaderWidth(e);this.rootNode.childNodes[t].style.width=`${i}px`}for(let i=0;i<t;i++){let t=this.table.renderedColumnToSource(i),r=this.table.columnUtils.getWidth(t);this.rootNode.childNodes[i+e].style.width=`${r}px`}let i=this.rootNode.firstChild;i&&(0,r.addClass)(i,"rowHeader")}}let Z={rowEven:"ht__row_even",rowOdd:"ht__row_odd"},tt=!1;class te extends ${constructor(t){super("TR",t),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"orderView",void 0),this.orderView=new W(t,t=>this.nodesPool.obtain(t))}getRenderedNode(t){return this.orderView.getNode(t)}hasStaleContent(t){return this.orderView.hasStaleContent(t)}render(){let{rowsToRender:t}=this.table;!tt&&t>1e3&&(tt=!0,(0,k.R8)((0,K.O)`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&(0,r.setAttribute)(this.rootNode,[(0,Y.t0)()]),this.orderView.setSize(t).setOffset(this.table.renderedRowToSource(0)).start();for(let n=0;n<t;n++){this.orderView.render();let t=this.orderView.getCurrentNode(),o=this.table.renderedRowToSource(n);if(this.table.isAriaEnabled()){var e,i;(0,r.setAttribute)(t,[(0,Y.Sb)(),(0,Y.Qg)(o+(null!==(e=null===(i=this.table.rowUtils)||void 0===i||null===(i=i.dataAccessObject)||void 0===i?void 0:i.columnHeaders.length)&&void 0!==e?e:0)+1)])}(o+1)%2==0?(0,r.hasClass)(t,Z.rowEven)||((0,r.removeClass)(t,Z.rowOdd),(0,r.addClass)(t,Z.rowEven)):(0,r.hasClass)(t,Z.rowOdd)||((0,r.removeClass)(t,Z.rowEven),(0,r.addClass)(t,Z.rowOdd))}this.orderView.end()}}function ti(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tr extends ${constructor(){super("TD"),ti(this,"orderViews",new WeakMap),ti(this,"sourceRowIndex",0)}obtainOrderView(t){let e;return this.orderViews.has(t)?e=this.orderViews.get(t):(e=new B(t,t=>this.nodesPool.obtain(this.sourceRowIndex,t),this.nodeType),this.orderViews.set(t,e)),e}render(){let{rowsToRender:t,columnsToRender:e,rows:i,rowHeaders:n}=this.table;for(let l=0;l<t;l++){let t=this.table.renderedRowToSource(l),a=i.getRenderedNode(l);this.sourceRowIndex=t;let h=this.obtainOrderView(a),u=n.obtainOrderView(a);h.prependView(u).setSize(e).setOffset(0).start();for(let i=0;i<e;i++){h.render();let e=this.table.renderedColumnToSource(i),n=h.getCurrentNode();if((0,r.hasClass)(n,"hide")||(n.className=""),n.removeAttribute("style"),n.removeAttribute("dir"),(0,r.removeAttribute)(n,[RegExp("aria-(.*)"),/role/]),this.table.cellRenderer(t,e,n),this.table.isAriaEnabled()){var o,s;(0,r.setAttribute)(n,[...n.hasAttribute("role")?[]:[(0,Y.g)()],(0,Y.vC)(-1),(0,Y.wD)(e+(null!==(o=null===(s=this.table.rowUtils)||void 0===s||null===(s=s.dataAccessObject)||void 0===s?void 0:s.rowHeaders.length)&&void 0!==o?o:0)+1)])}}h.end()}}}function tn(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class to{constructor(t){let{cellRenderer:e,stylesHandler:i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};tn(this,"rootNode",void 0),tn(this,"rootDocument",void 0),tn(this,"rowHeaders",null),tn(this,"columnHeaders",null),tn(this,"colGroup",null),tn(this,"rows",null),tn(this,"cells",null),tn(this,"rowFilter",null),tn(this,"columnFilter",null),tn(this,"rowUtils",null),tn(this,"columnUtils",null),tn(this,"rowsToRender",0),tn(this,"columnsToRender",0),tn(this,"rowHeaderFunctions",[]),tn(this,"rowHeadersCount",0),tn(this,"columnHeaderFunctions",[]),tn(this,"columnHeadersCount",0),tn(this,"cellRenderer",void 0),tn(this,"activeOverlayName",void 0),tn(this,"stylesHandler",void 0),this.rootNode=t,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=e,this.stylesHandler=i}setActiveOverlayName(t){this.activeOverlayName=t}setAxisUtils(t,e){this.rowUtils=t,this.columnUtils=e}setViewportSize(t,e){this.rowsToRender=t,this.columnsToRender=e}setFilters(t,e){this.rowFilter=t,this.columnFilter=e}setHeaderContentRenderers(t,e){this.rowHeaderFunctions=t,this.rowHeadersCount=t.length,this.columnHeaderFunctions=e,this.columnHeadersCount=e.length}setRenderers(){let{rowHeaders:t,columnHeaders:e,colGroup:i,rows:r,cells:n}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.setTable(this),e.setTable(this),i.setTable(this),r.setTable(this),n.setTable(this),this.rowHeaders=t,this.columnHeaders=e,this.colGroup=i,this.rows=r,this.cells=n}renderedRowToSource(t){return this.rowFilter.renderedToSource(t)}renderedColumnToSource(t){return this.columnFilter.renderedToSource(t)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();let{rowsToRender:t,rows:e}=this;for(let i=0;i<t;i++){let t=e.getRenderedNode(i),r=this.rowUtils;if(t.firstChild){let e=this.renderedRowToSource(i),n=r.getHeightByOverlayName(e,this.activeOverlayName),o=+!this.stylesHandler.areCellsBorderBox();n?t.firstChild.style.height=`${n-o}px`:t.firstChild.style.height=""}}}}class ts{constructor(){let{TABLE:t,THEAD:e,COLGROUP:i,TBODY:r,rowUtils:n,columnUtils:o,cellRenderer:s,stylesHandler:l}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.renderer=new to(t,{cellRenderer:s,stylesHandler:l}),this.renderer.setRenderers({rowHeaders:new q,columnHeaders:new X(e),colGroup:new Q(i),rows:new te(r),cells:new tr}),this.renderer.setAxisUtils(n,o)}setActiveOverlayName(t){return this.renderer.setActiveOverlayName(t),this}setFilters(t,e){return this.renderer.setFilters(t,e),this}setViewportSize(t,e){return this.renderer.setViewportSize(t,e),this}setHeaderContentRenderers(t,e){return this.renderer.setHeaderContentRenderers(t,e),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function tl(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ta{constructor(t,e){tl(this,"dataAccessObject",void 0),tl(this,"wtSettings",void 0),tl(this,"headerWidths",new Map),this.dataAccessObject=t,this.wtSettings=e}getWidth(t){return this.wtSettings.getSetting("columnWidth",t)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(t){let e=this.dataAccessObject.stylesHandler.getDefaultRowHeight(),i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[t];return void 0!==i&&(e=e?Math.max(e,i):i),e}getHeaderWidth(t){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(t))}calculateWidths(){let{wtSettings:t}=this,e=t.getSetting("rowHeaderWidth");if(null!=(e=t.getSetting("onModifyRowHeaderWidth",e))){let i=t.getSetting("rowHeaders").length,r=t.getSetting("defaultColumnWidth");for(let t=0;t<i;t++){let i=Array.isArray(e)?e[t]:e;i=null==i?r:i,this.headerWidths.set(t,i)}}}}function th(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tu{constructor(t,e){th(this,"dataAccessObject",void 0),th(this,"wtSettings",void 0),this.dataAccessObject=t,this.wtSettings=e}getHeight(t){let e=this.wtSettings.getSetting("rowHeight",t),i=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==i&&(e=void 0===e?i:Math.max(e,i)),e}getHeightByOverlayName(t,e){let i=this.wtSettings.getSetting("rowHeightByOverlayName",t,e),r=this.dataAccessObject.wtViewport.oversizedRows[t];return void 0!==r&&(i=void 0===i?r:Math.max(i,r)),i}}let tc="bottom",td="inline_start",tg="top_inline_start_corner",tf="bottom_inline_start_corner",tp=["top",tc,td,tg,tf],tm=new Map([["top","ht_clone_top"],[tc,`ht_clone_${tc}`],[td,`ht_clone_${td} ht_clone_left`],[tg,`ht_clone_${tg} ht_clone_top_left_corner`],[tf,`ht_clone_${tf} ht_clone_bottom_left_corner`]]);function tw(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tv{constructor(t,e,i,n,o){tw(this,"wtSettings",null),tw(this,"domBindings",void 0),tw(this,"TBODY",null),tw(this,"THEAD",null),tw(this,"COLGROUP",null),tw(this,"hasTableHeight",!0),tw(this,"hasTableWidth",!0),tw(this,"isTableVisible",!1),tw(this,"tableOffset",0),tw(this,"holderOffset",0),this.domBindings=i,this.isMaster="master"===o,this.name=o,this.dataAccessObject=t,this.facadeGetter=e,this.wtSettings=n,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,(0,r.removeTextNodes)(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;let s=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(s)),this.rowUtils=new tu(this.dataAccessObject,this.wtSettings),this.columnUtils=new ta(this.dataAccessObject,this.wtSettings),this.tableRenderer=new ts({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.dataAccessObject.stylesHandler})}is(t){return this.name===t}fixTableDomTree(){let t=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=t.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=t.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=t.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(t){let e,i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.hasClass)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtSpreader",i&&i.insertBefore(e,t),e.appendChild(t)),e.style.position="relative",this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(e,[(0,Y.gg)()]),e}createHider(t){let e,i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.hasClass)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).className="wtHider",i&&i.insertBefore(e,t),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(e,[(0,Y.gg)()]),e}createHolder(t){let e,i=t.parentNode;return i&&i.nodeType===Node.ELEMENT_NODE&&(0,r.hasClass)(i,"wtHolder")||((e=this.domBindings.rootDocument.createElement("div")).style.position="relative",e.className="wtHolder",(0,r.setAttribute)(e,[(0,Y.vC)(-1)]),i&&i.insertBefore(e,t),this.isMaster&&(e.parentNode.className+="ht_master handsontable",e.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(e.parentNode,[(0,Y.gg)()])),e.appendChild(t)),this.wtSettings.getSetting("ariaTags")&&(0,r.setAttribute)(e,[(0,Y.gg)()]),e}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this,{wtOverlays:i,wtViewport:n}=this.dataAccessObject,o=e.getSetting("totalRows"),s=e.getSetting("totalColumns"),l=e.getSetting("rowHeaders"),a=l.length,h=e.getSetting("columnHeaders"),u=h.length,c=t;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=(0,r.offset)(this.holder),c=n.createCalculators(c),a&&!e.getSetting("fixedColumnsStart"))){let t=i.inlineStartOverlay.getScrollPosition(),e=this.correctHeaderWidth;this.correctHeaderWidth=0!==t,e!==this.correctHeaderWidth&&(c=!1)}if(c)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=(0,r.offset)(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;let t=Math.max(this.getFirstRenderedRow(),0),e=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new N(t,o,u),this.columnFilter=new I(e,s,a);let c=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();let t={};this.wtSettings.getSetting("beforeDraw",!0,t),c=!0!==t.skipRender}c&&(this.tableRenderer.setHeaderContentRenderers(l,h),(this.is(tc)||this.is(tf))&&this.tableRenderer.setHeaderContentRenderers(l,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(tc))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||n.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(tc)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let d=!1;return this.isMaster&&(d=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(d=i.bottomOverlay.resetFixedPosition()||d),d=i.inlineStartOverlay.resetFixedPosition()||d,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),d?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(c),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(t){let e,i,n,o=this.columnFilter.renderedToSource(t),s=this.wtSettings.getSetting("columnHeaders").length,l=this.dataAccessObject.stylesHandler.getDefaultRowHeight(),a=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;s;)s-=1,e=this.getColumnHeaderHeight(s),(i=this.getColumnHeader(o,s))&&(n=(0,r.innerHeight)(i),(!e&&l<n||e<n)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=n),Array.isArray(a)?null!==a[s]&&void 0!==a[s]&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]):isNaN(a)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a),this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]<(a[s]||a)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[s]=a[s]||a))}adjustColumnHeaderHeights(){let{wtSettings:t}=this,e=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=t.getSetting("columnHeaders");for(let t=0,n=r.length;t<n;t++)if(i[t]){if(!e[t]||0===e[t].childNodes.length)return;e[t].childNodes[0].style.height=`${i[t]}px`}}resetOversizedRows(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject;if((this.isMaster||this.is(tc))&&!t.getSetting("externalRowCalculator")){let t=this.getRenderedRowsCount();for(let i=0;i<t;i++){let t=this.rowFilter.renderedToSource(i);e.oversizedRows&&e.oversizedRows[t]&&(e.oversizedRows[t]=void 0)}}}getCell(t){let e=t.row,i=t.col,r=this.wtSettings.getSetting("onModifyGetCellCoords",e,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([e,i]=r),this.isRowBeforeRenderedRows(e))return -1;if(this.isRowAfterRenderedRows(e))return -2;if(this.isColumnBeforeRenderedColumns(i))return -3;if(this.isColumnAfterRenderedColumns(i))return -4;let n=this.getRow(e);if(!n&&e>=0)throw Error("TR was expected to be rendered but is not");let o=n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!o&&i>=0)throw Error("TD or TH was expected to be rendered but is not");return o}getRow(t){var e,i;let r=null,n=null;return t<0?(r=null===(e=this.rowFilter)||void 0===e?void 0:e.sourceRowToVisibleColHeadedRow(t),n=this.THEAD):(r=null===(i=this.rowFilter)||void 0===i?void 0:i.sourceToRendered(t),n=this.TBODY),void 0!==r&&void 0!==n&&!(n.childNodes.length<r+1)&&n.childNodes[r]}getColumnHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this.THEAD.childNodes[e];return null==i?void 0:i.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t)]}getColumnHeaders(t){let e=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(t);return this.THEAD.childNodes.forEach(t=>{let r=t.childNodes[i];r&&e.push(r)}),e}getRowHeader(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(e>=this.wtSettings.getSetting("rowHeaders").length)return;let i=this.rowFilter.sourceToRendered(t),r=i<0?this.rowFilter.sourceRowToVisibleColHeadedRow(t):i,n=(i<0?this.THEAD:this.TBODY).childNodes[r];return null==n?void 0:n.childNodes[e]}getRowHeaders(t){let e=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){let i=this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)],n=null==i?void 0:i.childNodes[r];n&&e.push(n)}return e}getCoords(t){let e=t;if("TD"!==e.nodeName&&"TH"!==e.nodeName&&(e=(0,r.closest)(e,["TD","TH"])),null===e)return null;let i=e.parentNode;if(!i)return null;let n=i.parentNode,o=(0,r.index)(i),s=e.cellIndex;(0,r.overlayContainsElement)(tg,e,this.wtRootElement)||(0,r.overlayContainsElement)("top",e,this.wtRootElement)?"THEAD"===n.nodeName&&(o-=n.childNodes.length):(0,r.overlayContainsElement)(tf,e,this.wtRootElement)||(0,r.overlayContainsElement)(tc,e,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-n.childNodes.length+o:n===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),(0,r.overlayContainsElement)(tg,e,this.wtRootElement)||(0,r.overlayContainsElement)(td,e,this.wtRootElement)||(0,r.overlayContainsElement)(tf,e,this.wtRootElement)?s=this.columnFilter.offsettedTH(s):this.columnFilter&&(s=this.columnFilter.visibleRowHeadedColumnToSourceColumn(s));let l=this.wtSettings.getSetting("onModifyGetCoordsElement",o,s);return l&&Array.isArray(l)&&([o,s]=l),this.wot.createCellCoords(o,s)}markOversizedRows(){let t,e,i,n,o;if(this.wtSettings.getSetting("externalRowCalculator"))return;let s=this.TBODY.childNodes.length,l=s*this.dataAccessObject.stylesHandler.getDefaultRowHeight(),a=(0,r.innerHeight)(this.TBODY)-1,h=this.wot.stylesHandler.areCellsBorderBox(),u=h?r.outerHeight:r.innerHeight,c=+!h,d=+!!h;if(l!==a||this.wtSettings.getSetting("fixedRowsBottom"))for(;s;){s-=1,i=this.rowFilter.renderedToSource(s),t=this.getRowHeight(i),o=(n=this.getTrForRow(i)).querySelector("th");let r=0===i?d:0;e=o?u(o):u(n)-c,(!t&&this.dataAccessObject.stylesHandler.getDefaultRowHeight()<e-r||t<e)&&(h||(e+=1),this.dataAccessObject.wtViewport.oversizedRows[i]=e)}}getTrForRow(t){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(t)]}isColumnHeaderRendered(t){return!(t>=0)&&Math.abs(t)<=this.wtSettings.getSetting("rowHeaders").length}isRowHeaderRendered(t){return!(t>=0)&&Math.abs(t)<=this.wtSettings.getSetting("columnHeaders").length}isRowBeforeRenderedRows(t){let e=this.getFirstRenderedRow();return t<0&&e<=0?!this.isRowHeaderRendered(t):t<e}isRowAfterRenderedRows(t){return t>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(t){let e=this.getFirstRenderedColumn();return t<0&&e<=0?!this.isColumnHeaderRendered(t):t<e}isColumnAfterRenderedColumns(t){return this.columnFilter&&t>this.getLastRenderedColumn()}isColumnAfterViewport(t){return this.columnFilter&&t>this.getLastVisibleColumn()}isRowAfterViewport(t){return this.rowFilter&&t>this.getLastVisibleRow()}isColumnBeforeViewport(t){return this.columnFilter&&0>this.columnFilter.sourceToRendered(t)&&t>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(t){return this.rowUtils.getHeight(t)}getColumnHeaderHeight(t){return this.columnUtils.getHeaderHeight(t)}getColumnWidth(t){return this.columnUtils.getWidth(t)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return(0,r.outerWidth)(this.TABLE)}getHeight(){return(0,r.outerHeight)(this.TABLE)}getTotalWidth(){let t=(0,r.outerWidth)(this.hider);return 0!==t?t:this.getWidth()}getTotalHeight(){let t=(0,r.outerHeight)(this.hider);return 0!==t?t:this.getHeight()}isVisible(){return(0,r.isVisible)(this.TABLE)}_modifyRowHeaderWidth(t){let e=(0,s.isFunction)(t)?t():null;return Array.isArray(e)?(e=[...e])[e.length-1]=this._correctRowHeaderWidth(e[e.length-1]):e=this._correctRowHeaderWidth(e),e}_correctRowHeaderWidth(t){let e=t;return"number"!=typeof t&&(e=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(e+=1),e}}let ty=tv;var tb=i(19857);let tC={getFirstRenderedRow(){return 0===this.getRenderedRowsCount()?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,tb.defineGetter)(tC,"MIXIN_NAME","stickyRowsTop",{writable:!1,enumerable:!1});let tS={getFirstRenderedColumn(){let t=this.dataAccessObject.startColumnRendered;return null===t?-1:t},getFirstVisibleColumn(){let t=this.dataAccessObject.startColumnVisible;return null===t?-1:t},getFirstPartiallyVisibleColumn(){let t=this.dataAccessObject.startColumnPartiallyVisible;return null===t?-1:t},getLastRenderedColumn(){let t=this.dataAccessObject.endColumnRendered;return null===t?-1:t},getLastVisibleColumn(){let t=this.dataAccessObject.endColumnVisible;return null===t?-1:t},getLastPartiallyVisibleColumn(){let t=this.dataAccessObject.endColumnPartiallyVisible;return null===t?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,tb.defineGetter)(tS,"MIXIN_NAME","calculatedColumns",{writable:!1,enumerable:!1});class tE extends ty{constructor(t,e,i,r){super(t,e,i,r,"top")}}(0,tb.mixin)(tE,tC),(0,tb.mixin)(tE,tS);var tR=i(93924);function tT(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var tx=new WeakSet;class tM{constructor(t){!function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,tx),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"dataAccessObject",void 0),this.dataAccessObject=t}scrollViewport(t,e,i){if(t.col<0||t.row<0)return!1;let r=this.scrollViewportHorizontally(t.col,e),n=this.scrollViewportVertically(t.row,i);return r||n}scrollViewportHorizontally(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;let n=(0,tb.createObjectPropListener)(e);if(!Number.isInteger(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",t,n))||t<0||t>r)return!1;e=n.value;let{fixedColumnsStart:o,inlineStartOverlay:s}=this.dataAccessObject,l="auto"===e;if(l&&t<o)return!1;let a=this.getFirstVisibleColumn(),h=this.getLastVisibleColumn(),u=!1;return(l&&(t<a||t>h)||!l)&&(u=s.scrollTo(t,l?t>=this.getLastPartiallyVisibleColumn():"end"===e)),u}scrollViewportVertically(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;let n=(0,tb.createObjectPropListener)(e);if(!Number.isInteger(t=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",t,n))||t<0||t>r)return!1;e=n.value;let{fixedRowsBottom:o,fixedRowsTop:s,topOverlay:l}=this.dataAccessObject,a="auto"===e;if(a&&(t<s||t>r-o-1))return!1;let h=this.getFirstVisibleRow(),u=this.getLastVisibleRow(),c=!1;return(a&&(t<h||t>u)||!a)&&(c=l.scrollTo(t,a?t>=this.getLastPartiallyVisibleRow():"bottom"===e)),c}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return tT(tx,this,tO).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return tT(tx,this,tO).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return tT(tx,this,tk).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return tT(tx,this,tk).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function tk(t){let{wtSettings:e,inlineStartOverlay:i,wtTable:n,wtViewport:o,totalColumns:s,rootWindow:l}=this.dataAccessObject;if(i.mainTableScrollableElement===l){let a=e.getSetting("rtlMode"),h=null;if(a){let t=n.TABLE.getBoundingClientRect(),e=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(t.right-e)}else h=(0,r.offset)(n.wtRootElement).left;let u=Math.abs((0,r.getScrollLeft)(l,l));if(h>u){let e=(0,r.innerWidth)(l),n=o.getRowHeaderWidth();for(let r=1;r<=s;r++)if(h+(n+=i.sumCellSizes(r-1,r))-u>=e){t=r-2;break}}}return t}function tO(t){let{topOverlay:e,wtTable:i,wtViewport:n,totalRows:o,rootWindow:s}=this.dataAccessObject;if(e.mainTableScrollableElement===s){let l=(0,r.offset)(i.wtRootElement),a=(0,r.getScrollTop)(s,s);if(l.top>a){let i=(0,r.innerHeight)(s),h=n.getColumnHeaderHeight();for(let r=1;r<=o;r++)if(h+=e.sumCellSizes(r-1,r),l.top+h-a>=i){t=r-2;break}}}return t}var tI=i(73183),tA=i(71190);function tN(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class tH{get eventManager(){return new n.A(this)}constructor(t,e){tN(this,"wtTable",void 0),tN(this,"wtScroll",void 0),tN(this,"wtViewport",void 0),tN(this,"wtOverlays",void 0),tN(this,"selectionManager",void 0),tN(this,"wtEvent",void 0),tN(this,"guid",`wt_${(0,tR.randomString)()}`),tN(this,"drawInterrupted",!1),tN(this,"drawn",!1),tN(this,"activeOverlayName","master"),tN(this,"domBindings",void 0),tN(this,"wtSettings",void 0),this.domBindings={rootTable:t,rootDocument:t.ownerDocument,rootWindow:t.ownerDocument.defaultView},this.wtSettings=e,this.wtScroll=new tM(this.createScrollDao())}findOriginalHeaders(){let t=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let e=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;e<i;e++)t.push(this.wtTable.THEAD.childNodes[0].childNodes[e].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(e,i){(0,r.fastInnerText)(i,t[e])}])}}createCellCoords(t,e){return new tI.A(t,e,this.wtSettings.getSetting("rtlMode"))}createCellRange(t,e,i){return new tA.A(t,e,i,this.wtSettings.getSetting("rtlMode"))}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.drawInterrupted=!1,!this.wtTable.isVisible()||(0,r.hasZeroHeight)(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return this.wtTable.getCell(t);let i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),n=this.wtSettings.getSetting("fixedRowsBottom"),o=this.wtSettings.getSetting("fixedColumnsStart");if(t.row<r&&t.col<o)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(t);if(t.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(t);if(t.col<o&&t.row>=i-n){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(t)}else if(t.col<o)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(t);else if(t.row<i&&t.row>=i-n&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(t);return this.wtTable.getCell(t)}scrollViewport(t,e,i){return this.wtScroll.scrollViewport(t,e,i)}scrollViewportHorizontally(t,e){return this.wtScroll.scrollViewportHorizontally(t,e)}scrollViewportVertically(t,e){return this.wtScroll.scrollViewportVertically(t,e)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){let t=this;return{get drawn(){return t.drawn},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get wtTable(){return t.wtTable},get wtViewport(){return t.wtViewport},get wtSettings(){return t.wtSettings},get rootWindow(){return t.domBindings.rootWindow},get totalRows(){return t.wtSettings.getSetting("totalRows")},get totalColumns(){return t.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return t.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return t.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return t.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){let t=this;return{get wot(){return t},get parentTableOffset(){return t.cloneSource.wtTable.tableOffset},get cloneSource(){return t.cloneSource},get workspaceWidth(){return t.wtViewport.getWorkspaceWidth()},get wtViewport(){return t.wtViewport},get wtOverlays(){return t.wtOverlays},get selectionManager(){return t.selectionManager},get stylesHandler(){return t.stylesHandler},get drawn(){return t.drawn},set drawn(v){t.drawn=v},get wtTable(){return t.wtTable},get startColumnRendered(){return t.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return t.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return t.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return t.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return t.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return t.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return t.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return t.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return t.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return t.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return t.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return t.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return t.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return t.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return t.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return t.wtSettings.getSetting("rowHeaders")}}}}function tP(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class t_ extends tH{constructor(t,e,i){super(t,e),tP(this,"cloneSource",void 0),tP(this,"cloneOverlay",void 0);let r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.stylesHandler=i.stylesHandler,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new T(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}class tD{constructor(t,e,i,n,o){!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[e]=null}(this,"wtSettings",null),(0,tb.defineGetter)(this,"wot",t,{writable:!1}),this.domBindings=o,this.facadeGetter=e,this.wtSettings=n;let{TABLE:s,hider:l,spreader:a,holder:h,wtRootElement:u}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=s,this.hider=l,this.spreader=a,this.holder=h,this.wtRootElement=u,this.trimmingContainer=(0,r.getTrimmingContainer)(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(t){"before"===t&&this.shouldBeRendered()?this.needFullRender=!0:"after"!==t||this.shouldBeRendered()||(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=(0,r.getTrimmingContainer)(this.hider.parentNode.parentNode)}updateMainScrollableElement(){let{wtTable:t}=this.wot,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=(0,r.getScrollableElement)(t.TABLE)}getRelativeCellPosition(t,e,i){if(!1===this.clone.wtTable.holder.contains(t)){(0,k.R8)(`The provided element is not a child of the ${this.type} overlay`);return}let r=this.mainTableScrollableElement===this.domBindings.rootWindow,n=i<this.wtSettings.getSetting("fixedColumnsStart"),o=e<this.wtSettings.getSetting("fixedRowsTop"),s=e>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),l=this.clone.wtTable.spreader,a={start:this.getRelativeStartPosition(l),top:l.offsetTop},h={start:this.getRelativeStartPosition(t),top:t.offsetTop},u=null;return r?this.getRelativeCellPositionWithinWindow(o,n,h,a):this.getRelativeCellPositionWithinHolder(o,s,n,h,a)}getRelativeStartPosition(t){return this.isRtl()?t.offsetParent.offsetWidth-t.offsetLeft-t.offsetWidth:t.offsetLeft}getRelativeCellPositionWithinWindow(t,e,i,n){let o=this.wot.wtTable.wtRootElement.getBoundingClientRect(),s=0,l=0;if(e){let t=o.left;this.isRtl()&&(t=this.domBindings.rootWindow.innerWidth-(o.left+o.width+(0,r.getScrollbarWidth)())),s=t<=0?-1*t:0}else s=n.start;return l=t?this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:n.top,{start:i.start+s,top:i.top+l}}getRelativeCellPositionWithinHolder(t,e,i,r,n){let o={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()},s=0,l=0;if(i||(s=o.horizontal-n.start),e){let t=this.wot.wtTable.wtRootElement.getBoundingClientRect();l=-+this.clone.wtTable.TABLE.getBoundingClientRect().top+t.top}else t||(l=o.vertical-n.top);return{start:r.start-s,top:r.top-l}}makeClone(){if(-1===tp.indexOf(this.type))throw Error(`Clone type "${this.type}" is not supported.`);let{wtTable:t,wtSettings:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=i.createElement("div"),s=i.createElement("table"),l=t.wtRootElement.parentNode;o.className=`${tm.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,e.getSetting("ariaTags")&&(0,r.setAttribute)(o,[(0,Y.gg)()]),s.className=t.TABLE.className,t.TABLE.getAttribute("role")&&s.setAttribute("role",t.TABLE.getAttribute("role")),o.appendChild(s),l.appendChild(o);let a=this.wtSettings.getSetting("preventOverflow");return!0===a||"horizontal"===a&&"top"===this.type||"vertical"===a&&this.type===td?this.mainTableScrollableElement=n:"hidden"===n.getComputedStyle(l).getPropertyValue("overflow")?this.mainTableScrollableElement=t.holder:this.mainTableScrollableElement=(0,r.getScrollableElement)(t.TABLE),new t_(s,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager,stylesHandler:this.wot.stylesHandler})}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.needFullRender){let e=this.clone.cloneSource;e.activeOverlayName=this.clone.wtTable.name,this.clone.draw(t),e.activeOverlayName="master"}}reset(){let t=this.clone.wtTable.holder,e=this.clone.wtTable.hider,i=t.style;[i,e.style,t.parentNode.style].forEach(t=>{t.width="",t.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}let tL=t=>{let e=t.stylesHandler;if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});let i=e.getCSSVariableValue("cell-autofill-size");return Object.freeze({width:i,height:i,borderWidth:e.getCSSVariableValue("cell-autofill-border-width"),borderStyle:"solid",borderColor:e.getCSSVariableValue("cell-autofill-border-color")})};class tF extends tD{constructor(t,e,i,r){super(t,e,"top",i,r),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:-1,enumerable:!0,configurable:!0,writable:!0}):t[e]=-1}(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tE(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode,{rootWindow:e}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow"),n=0,o=!1;if(this.trimmingContainer!==e||i&&"vertical"===i)n=this.getScrollPosition(),(0,r.resetCssTransform)(t);else{let{wtTable:e}=this.wot;o=Math.ceil(e.hider.getBoundingClientRect().bottom)===t.offsetHeight,n=this.getOverlayOffset(),(0,r.setOverlayPosition)(t,"0px",`${n}px`)}let s=this.adjustHeaderBordersPosition(n,o);return this.adjustElementsSize(),s}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=this.mainTableScrollableElement,n=!1;if(i===e&&t!==e.scrollY){let i=e.scrollY;e.scrollTo((0,r.getWindowScrollLeft)(e),t),n=i!==e.scrollY}else if(t!==i.scrollTop){let e=i.scrollTop;i.scrollTop=t,n=e!==i.scrollTop}return n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let i=this.wot.stylesHandler.getDefaultRowHeight(),r=t,n=0;for(;r<e;){let t=this.wot.wtTable.getRowHeight(r);n+=void 0===t?i:t,r+=1}return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===s){let n=e.getWorkspaceWidth();e.hasVerticalScroll()&&(n-=(0,r.getScrollbarWidth)(i)),n=Math.min(n,t.wtRootElement.scrollWidth),o.width=`${n}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=(0,r.outerHeight)(this.clone.wtTable.TABLE);t.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=tL(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(e.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=`${parseInt(t.parentNode.style.height,10)+i}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let{wot:i,wtSettings:n}=this,o=(i.cloneSource?i.cloneSource:i).wtTable.holder,s=n.getSetting("columnHeaders"),l=+(0===n.getSetting("fixedRowsTop")&&s.length>0&&!(0,r.hasClass)(o.parentNode,"innerBorderTop")),a=this.getTableParentOffset(),h=0;if(e&&this.wot.wtTable.getRowHeight(t)>this.wot.wtViewport.getViewportHeight()&&(e=!1),e&&o.offsetHeight!==o.clientHeight&&(h=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),e){let e=n.getSetting("fixedRowsBottom"),r=n.getSetting("totalRows");a+=this.sumCellSizes(0,t+1),a-=i.wtViewport.getViewportHeight()-this.sumCellSizes(r-e,r),a+=1,a+=l}else a+=this.sumCellSizes(n.getSetting("fixedRowsTop"),t);return a+=h,(0,r.getMaximumScrollTop)(this.mainTableScrollableElement)===a-l&&l>0&&this.wot.wtOverlays.expandHiderVerticallyBy(l),this.setScrollPosition(a)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight();(i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{wtSettings:i}=this,n=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),s="horizontal"===i.getSetting("preventOverflow");o?(0,r.removeClass)(n,"emptyColumns"):(0,r.addClass)(n,"emptyColumns");let l=!1;if(!e&&!s){let e=i.getSetting("fixedRowsTop"),o=this.cachedFixedRowsTop!==e,s=i.getSetting("columnHeaders");if((o||0===e)&&s.length>0){let e=(0,r.hasClass)(n,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),t||0===i.getSetting("totalRows")?((0,r.addClass)(n,"innerBorderTop"),l=!e):((0,r.removeClass)(n,"innerBorderTop"),l=e)}}return l}}let tV={getFirstRenderedRow(){let t=this.getRenderedRowsCount();return 0===t?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return 0===this.getRenderedRowsCount()?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount:()=>0};(0,tb.defineGetter)(tV,"MIXIN_NAME","stickyRowsBottom",{writable:!1,enumerable:!1});class tW extends ty{constructor(t,e,i,r){super(t,e,i,r,tc)}}(0,tb.mixin)(tW,tV),(0,tb.mixin)(tW,tS);class tB extends tD{constructor(t,e,i,r){super(t,e,tc,i,r),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:-1,enumerable:!0,configurable:!0,writable:!0}):t[e]=-1}(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tW(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;let{rootWindow:t}=this.domBindings,e=this.clone.wtTable.holder.parentNode;e.style.top="";let i=0,r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer!==t||r&&"vertical"===r?(i=this.getScrollPosition(),this.repositionOverlay()):(i=this.getOverlayOffset(),e.style.bottom=`${i}px`);let n=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),n}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,r.getScrollbarWidth)(i)),n.style.bottom=`${o}px`}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=this.mainTableScrollableElement,n=!1;if(i===e&&t!==e.scrollY){let t=e.scrollY;e.scrollTo((0,r.getWindowScrollLeft)(e),top),n=t!==e.scrollY}else if(t!==i.scrollTop){let e=i.scrollTop;i.scrollTop=t,n=e!==i.scrollTop}return n}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(t,e){let{wtTable:i,stylesHandler:r}=this.wot,n=r.getDefaultRowHeight(),o=t,s=0;for(;o<e;){let t=i.getRowHeight(o);s+=void 0===t?n:t,o+=1}return s}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"horizontal"===s){let n=e.getWorkspaceWidth();e.hasVerticalScroll()&&(n-=(0,r.getScrollbarWidth)(i)),n=Math.min(n,t.wtRootElement.scrollWidth),o.width=`${n}px`}else o.width="";this.clone.wtTable.holder.style.width=o.width;let l=(0,r.outerHeight)(this.clone.wtTable.TABLE);t.hasDefinedSize()||(l=0),o.height=`${l}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,t.style.width=t.parentNode.style.width,t.style.height=t.parentNode.style.height}applyToDOM(){let t=this.wtSettings.getSetting("totalRows");if("number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition)this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style.top="0";else throw Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){let t=this.isRtl()?"right":"left",{spreader:e}=this.clone.wtTable;"number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition?e.style[t]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:e.style[t]=""}scrollTo(t,e){let i=this.getTableParentOffset(),n=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,o=0;e&&n.offsetHeight!==n.clientHeight&&(o=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),e?(i+=this.sumCellSizes(0,t+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),t),i+=o,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return(0,r.getScrollTop)(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"vertical"!==e)){let t=this.wot.wtTable.getTotalHeight(),e=this.clone.wtTable.getTotalHeight(),r=this.domBindings.rootDocument.documentElement.clientHeight;(i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-r+t,0))>t-e&&(i=0)}return i}adjustHeaderBordersPosition(t){let e=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==e,n=this.wtSettings.getSetting("columnHeaders"),o=!1;if((i||0===e)&&n.length>0){let e=this.wot.wtTable.holder.parentNode,i=(0,r.hasClass)(e,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),t||0===this.wtSettings.getSetting("totalRows")?((0,r.addClass)(e,"innerBorderBottom"),o=!i):((0,r.removeClass)(e,"innerBorderBottom"),o=i)}return o}}let tj={getFirstRenderedRow(){let t=this.dataAccessObject.startRowRendered;return null===t?-1:t},getFirstVisibleRow(){let t=this.dataAccessObject.startRowVisible;return null===t?-1:t},getFirstPartiallyVisibleRow(){let t=this.dataAccessObject.startRowPartiallyVisible;return null===t?-1:t},getLastRenderedRow(){let t=this.dataAccessObject.endRowRendered;return null===t?-1:t},getLastVisibleRow(){let t=this.dataAccessObject.endRowVisible;return null===t?-1:t},getLastPartiallyVisibleRow(){let t=this.dataAccessObject.endRowPartiallyVisible;return null===t?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};(0,tb.defineGetter)(tj,"MIXIN_NAME","calculatedRows",{writable:!1,enumerable:!1});let tz={getFirstRenderedColumn(){return 0===this.getRenderedColumnsCount()?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};(0,tb.defineGetter)(tz,"MIXIN_NAME","stickyColumnsStart",{writable:!1,enumerable:!1});class tU extends ty{constructor(t,e,i,r){super(t,e,i,r,td)}}(0,tb.mixin)(tU,tj),(0,tb.mixin)(tU,tz);class t$ extends tD{constructor(t,e,i,r){super(t,e,td,i,r)}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tU(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wtTable:t}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!t.holder.parentNode)return!1;let{rootWindow:e}=this.domBindings,i=this.clone.wtTable.holder.parentNode,n=this.wtSettings.getSetting("preventOverflow"),o=0;this.trimmingContainer!==e||n&&"horizontal"===n?(o=this.getScrollPosition(),(0,r.resetCssTransform)(i)):(o=this.getOverlayOffset()*(this.isRtl()?-1:1),(0,r.setOverlayPosition)(i,`${o}px`,"0px"));let s=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),s}setScrollPosition(t){let{rootWindow:e}=this.domBindings,i=!1;this.isRtl()&&(t=-t);let n=this.mainTableScrollableElement;if(n===e&&t!==e.scrollX){let n=e.scrollX;e.scrollTo(t,(0,r.getWindowScrollTop)(e)),i=n!==e.scrollX}else if(t!==n.scrollLeft){let e=n.scrollLeft;n.scrollLeft=t,i=e!==n.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(t,e){let i=this.wtSettings.getSetting("defaultColumnWidth"),r=t,n=0;for(;r<e;)n+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return n}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i,rootWindow:n}=this.domBindings,o=this.clone.wtTable.holder.parentNode.style,s=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==n||"vertical"===s){let n=e.getWorkspaceHeight();e.hasHorizontalScroll()&&(n-=(0,r.getScrollbarWidth)(i)),n=Math.min(n,t.wtRootElement.scrollHeight),o.height=`${n}px`}else o.height="";this.clone.wtTable.holder.style.height=o.height;let l=(0,r.outerWidth)(this.clone.wtTable.TABLE);o.width=`${l}px`}adjustRootChildrenSize(){let{holder:t}=this.clone.wtTable,e=tL(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(e.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,t.style.height=t.parentNode.style.height,t.style.width=`${parseInt(t.parentNode.style.width,10)+i}px`}applyToDOM(){let t=this.wtSettings.getSetting("totalColumns"),e=this.isRtl()?"right":"left";if("number"==typeof this.wot.wtViewport.columnsRenderCalculator.startPosition)this.spreader.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(0===t)this.spreader.style[e]="0";else throw Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){"number"==typeof this.wot.wtViewport.rowsRenderCalculator.startPosition?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(t,e){let{wtSettings:i}=this,n=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),s=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,l=+(0===o&&n.length>0&&!(0,r.hasClass)(s.parentNode,"innerBorderInlineStart")),a=this.getTableParentOffset(),h=0;return e&&this.wot.wtTable.getColumnWidth(t)>this.wot.wtViewport.getViewportWidth()&&(e=!1),e&&s.offsetWidth!==s.clientWidth&&(h=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),e?(a+=this.sumCellSizes(0,t+1),a-=this.wot.wtViewport.getViewportWidth(),a+=l):a+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),t),a+=h,(0,r.getMaximumScrollLeft)(this.mainTableScrollableElement)===a-l&&l>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(l),this.setScrollPosition(a)}getTableParentOffset(){let t=this.wtSettings.getSetting("preventOverflow"),e=0;return t||this.trimmingContainer!==this.domBindings.rootWindow||(e=this.wot.wtTable.holderOffset.left),e}getScrollPosition(){return Math.abs((0,r.getScrollLeft)(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){let{rootWindow:t}=this.domBindings,e=this.wtSettings.getSetting("preventOverflow"),i=0;if(this.trimmingContainer===t&&(!e||"horizontal"!==e)){i=this.isRtl()?Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);let t=this.wot.wtTable.getTotalWidth();i>t-this.clone.wtTable.getTotalWidth()&&(i=0)}return i}adjustHeaderBordersPosition(t){let{wtSettings:e}=this,i=this.wot.wtTable.holder.parentNode,n=e.getSetting("rowHeaders"),o=e.getSetting("fixedColumnsStart"),s=e.getSetting("totalRows"),l="vertical"===e.getSetting("preventOverflow");s?(0,r.removeClass)(i,"emptyRows"):(0,r.addClass)(i,"emptyRows");let a=!1;if(!l){if(o&&!n.length)(0,r.addClass)(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&n.length){let e=(0,r.hasClass)(i,"innerBorderInlineStart");t?((0,r.addClass)(i,"innerBorderLeft innerBorderInlineStart"),a=!e):((0,r.removeClass)(i,"innerBorderLeft innerBorderInlineStart"),a=e)}}return a}}class tY extends ty{constructor(t,e,i,r){super(t,e,i,r,tg)}}function tG(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,tb.mixin)(tY,tC),(0,tb.mixin)(tY,tz);class tq extends tD{constructor(t,e,i,r,n,o){super(t,e,tg,i,r),tG(this,"topOverlay",void 0),tG(this,"inlineStartOverlay",void 0),this.topOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tY(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;let t=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){let e=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),i=this.topOverlay.getOverlayOffset();(0,r.setOverlayPosition)(t,`${e}px`,`${i}px`)}else(0,r.resetCssTransform)(t);let e=(0,r.outerHeight)(this.clone.wtTable.TABLE),i=(0,r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(e=0),t.style.height=`${e}px`,t.style.width=`${i}px`,!1}}class tX extends ty{constructor(t,e,i,r){super(t,e,i,r,tf)}}(0,tb.mixin)(tX,tV),(0,tb.mixin)(tX,tz);class tK extends tD{constructor(t,e,i,r,n,o){super(t,e,tf,i,r),this.bottomOverlay=n,this.inlineStartOverlay=o}createTable(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return new tX(...e)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){let{wot:t}=this;if(this.updateTrimmingContainer(),!t.wtTable.holder.parentNode)return!1;let e=this.clone.wtTable.holder.parentNode;if(e.style.top="",this.trimmingContainer===this.domBindings.rootWindow){let t=this.inlineStartOverlay.getOverlayOffset(),i=this.bottomOverlay.getOverlayOffset();e.style[this.isRtl()?"right":"left"]=`${t}px`,e.style.bottom=`${i}px`}else(0,r.resetCssTransform)(e),this.repositionOverlay();let i=(0,r.outerHeight)(this.clone.wtTable.TABLE),n=(0,r.outerWidth)(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),e.style.height=`${i}px`,e.style.width=`${n}px`,!1}repositionOverlay(){let{wtTable:t,wtViewport:e}=this.wot,{rootDocument:i}=this.domBindings,n=this.clone.wtTable.holder.parentNode,o=0;e.hasVerticalScroll()||(o+=e.getWorkspaceHeight()-t.getTotalHeight()),e.hasVerticalScroll()&&e.hasHorizontalScroll()&&(o+=(0,r.getScrollbarWidth)(i)),n.style.bottom=`${o}px`}}function tJ(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function tQ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tZ(t,e,i){return t.set(t1(t,e),i),i}function t0(t,e){return t.get(t1(t,e))}function t1(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var t2=new WeakMap,t3=new WeakMap,t9=new WeakMap,t4=new WeakMap;class t5{constructor(t,e,i,n,o,s){tQ(this,"wot",null),tJ(this,t2,[]),tQ(this,"topOverlay",null),tQ(this,"bottomOverlay",null),tQ(this,"inlineStartOverlay",null),tQ(this,"topInlineStartCornerOverlay",null),tQ(this,"bottomInlineStartCornerOverlay",null),tQ(this,"browserLineHeight",void 0),tQ(this,"wtSettings",null),tJ(this,t3,!1),tJ(this,t9,0),tJ(this,t4,null),tQ(this,"resizeObserver",new ResizeObserver(t=>{(0,l.requestAnimationFrame)(()=>{Array.isArray(t)&&t.length&&(tZ(t9,this,t0(t9,this)+1),100===t0(t9,this)&&((0,k.R8)("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),null!==t0(t4,this)&&clearTimeout(t0(t4,this)),tZ(t4,this,setTimeout(()=>{tZ(t9,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=t,this.wtSettings=n,this.domBindings=i,this.facadeGetter=e,this.wtTable=s;let{rootDocument:a,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=(0,r.getScrollbarWidth)(a);let u="hidden"===h.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow");this.scrollableElement=u?s.holder:(0,r.getScrollableElement)(s.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=[...t0(t2,this)];return t&&e.push(this.wtTable),e}initBrowserLineHeight(){let{rootWindow:t,rootDocument:e}=this.domBindings,i=t.getComputedStyle(e.body),r=parseInt(i.lineHeight,10),n=1.2*parseInt(i.fontSize,10);this.browserLineHeight=r||n}initOverlays(){let t=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new tF(...t),this.bottomOverlay=new tB(...t),this.inlineStartOverlay=new t$(...t),this.topInlineStartCornerOverlay=new tq(...t,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new tK(...t,this.bottomOverlay,this.inlineStartOverlay),tZ(t2,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){tZ(t3,this,t0(t2,this).reduce((t,e)=>e.hasRenderingStateChanged()||t,!1)),t0(t2,this).forEach(t=>t.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),t0(t2,this).forEach(t=>{let e=t.hasRenderingStateChanged();t.updateStateOfRendering("after"),e&&!t.needFullRender&&t.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){let t,{rootDocument:e,rootWindow:i}=this.domBindings,{mainTableScrollableElement:r}=this.topOverlay,{mainTableScrollableElement:n}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",t=>this.onKeyDown(t)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(r,"scroll",t=>this.onTableScroll(t),{passive:!0}),r!==n&&this.eventManager.addEventListener(n,"scroll",t=>this.onTableScroll(t),{passive:!0});let o=i.devicePixelRatio&&i.devicePixelRatio>1,s=this.scrollableElement===i,h=this.wtSettings.getSetting("preventWheel"),u={passive:s};(h||o||!(0,a.isChrome)())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",t=>this.onCloneWheel(t,h),u),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(t=>{this.eventManager.addEventListener(t.clone.wtTable.holder,"wheel",t=>this.onCloneWheel(t,h),u)}),this.eventManager.addEventListener(i,"resize",()=>{(0,l.requestAnimationFrame)(()=>{clearTimeout(t),this.wtSettings.getSetting("onWindowResize"),t=setTimeout(()=>{tZ(t9,this,0)},200)})}),s||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(t){let e=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,n=t.target;(!this.keyPressed||(r===e||n===e||t.target.contains(r))&&(i===e||n===e||t.target.contains(i)))&&this.syncScrollPositions(t)}onCloneWheel(t,e){let{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,n=this.topOverlay.mainTableScrollableElement,o=t.target,s=n!==i&&o!==i&&!o.contains(n),l=r!==i&&o!==i&&!o.contains(r);if(this.keyPressed&&(s||l)||this.scrollableElement===i)return;let a=this.translateMouseWheelToScroll(t);(e||this.scrollableElement!==i&&a)&&t.preventDefault()}onKeyDown(t){this.keyPressed=(0,M.isKey)(t.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(t){let e=isNaN(t.deltaY)?-1*t.wheelDeltaY:t.deltaY,i=isNaN(t.deltaX)?-1*t.wheelDeltaX:t.deltaX;1===t.deltaMode&&(i+=i*this.browserLineHeight,e+=e*this.browserLineHeight);let r=this.scrollVertically(e),n=this.scrollHorizontally(i);return r||n}scrollVertically(t){let e=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=t,e!==this.scrollableElement.scrollTop}scrollHorizontally(t){let e=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=t,e!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;let t=this.topOverlay.clone.wtTable.holder,e=this.inlineStartOverlay.clone.wtTable.holder,i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){t.scrollLeft=i;let e=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;e&&(e.scrollLeft=i)}this.verticalScrolling&&(e.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!t0(t3,this))return;let{scrollLeft:t,scrollTop:e}=this.topOverlay.mainTableScrollableElement;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=t),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=t),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=e),tZ(t3,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();let{wtTable:t}=this,{rootWindow:e}=this.domBindings;"hidden"===e.getComputedStyle(t.wtRootElement.parentNode).getPropertyValue("overflow")?this.scrollableElement=t.holder:this.scrollableElement=(0,r.getScrollableElement)(t.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(t),this.inlineStartOverlay.refresh(t),this.topOverlay.refresh(t),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(t),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(t)}updateLastSpreaderSize(){let t=this.wtTable.spreader,e=t.clientWidth,i=t.clientHeight,r=e!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=e,this.spreaderLastSize.height=i),r}adjustElementsSize(){let{wtViewport:t}=this.wot,{wtTable:e}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,n=this.wtSettings.getSetting("totalColumns"),o=this.wtSettings.getSetting("totalRows"),s=t.getRowHeaderWidth(),l=t.getColumnHeaderHeight()+this.topOverlay.sumCellSizes(0,o)+1,a=s+this.inlineStartOverlay.sumCellSizes(0,n),h=e.hider.style,u=+!!(!r&&this.scrollableElement.scrollTop>Math.max(0,l-e.holder.clientHeight)),c=+!!(!r&&this.scrollableElement.scrollLeft>Math.max(0,a-e.holder.clientWidth));h.width=`${a+c}px`,h.height=`${l+u}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(t){let{wtTable:e}=this;e.hider.style.height=`${parseInt(e.hider.style.height,10)+t}px`}expandHiderHorizontallyBy(t){let{wtTable:e}=this;e.hider.style.width=`${parseInt(e.hider.style.width,10)+t}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(t){if(!t)return null;let e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay],i=null;return(0,x.arrayEach)(e,e=>{e&&e.clone&&e.clone.wtTable.TABLE.contains(t)&&(i=e.clone)}),i}syncOverlayTableClassNames(){let t=this.wtTable.TABLE,e=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];(0,x.arrayEach)(e,e=>{e&&(e.clone.wtTable.TABLE.className=t.className)})}}function t8(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class t7{constructor(t){t8(this,"settings",{}),t8(this,"defaults",Object.freeze(this.getDefaults())),(0,tb.objectEach)(this.defaults,(e,i)=>{if(void 0!==t[i])this.settings[i]=t[i];else if(void 0===e)throw Error(`A required setting "${i}" was not provided`);else this.settings[i]=e})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow:()=>!1,preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders:()=>[],columnHeaders:()=>[],totalRows:void 0,totalColumns:void 0,cellRenderer:(t,e,i)=>{let n=this.getSetting("data",t,e);(0,r.fastInnerText)(i,null==n?"":n)},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:t=>t,onBeforeViewportScrollVertically:t=>t,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:t=>t,onBeforeHighlightingColumnHeader:t=>t,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0}}update(t,e){return void 0===e?(0,tb.objectEach)(t,(t,e)=>{this.settings[e]=t}):this.settings[t]=e,this}getSetting(t,e,i,r,n){return"function"==typeof this.settings[t]?this.settings[t](e,i,r,n):void 0!==e&&Array.isArray(this.settings[t])?this.settings[t][e]:this.settings[t]}getSettingPure(t){return this.settings[t]}has(t){return!!this.settings[t]}}class t6 extends ty{constructor(t,e,i,r){super(t,e,i,r,"master")}alignOverlaysWithTrimmingContainer(){let t=(0,r.getTrimmingContainer)(this.wtRootElement),{rootWindow:e}=this.domBindings;if(t===e)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{let i=t.parentElement,n=(0,r.getStyle)(t,"height",e),o=(0,r.getStyle)(t,"overflow",e),s=this.holder.style,{scrollWidth:l,scrollHeight:a}=t,h=t.offsetWidth,u=t.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){let r=t.cloneNode(!1);r.style.overflow="auto",r.style.position="absolute",t.nextElementSibling?i.insertBefore(r,t.nextElementSibling):i.appendChild(r);let n=parseInt(e.getComputedStyle(r).height,10);i.removeChild(r),0===n&&(u=0)}u=Math.min(u,a),s.height="auto"===n?"auto":`${u}px`,h=Math.min(h,l),s.width=`${h}px`,s.overflow="",this.hasTableHeight="auto"===s.height||u>0,this.hasTableWidth=h>0}this.isTableVisible=(0,r.isVisible)(this.TABLE)}markOversizedColumnHeaders(){let{wtSettings:t}=this,{wtViewport:e}=this.dataAccessObject,i="master",r=t.getSetting("columnHeaders").length;if(r&&!e.hasOversizedColumnHeadersMarked[i]){let n=t.getSetting("rowHeaders").length,o=this.getRenderedColumnsCount();for(let t=0;t<r;t++)for(let t=-1*n;t<o;t++)this.markIfOversizedColumnHeader(t);e.hasOversizedColumnHeadersMarked[i]=!0}}}function et(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,tb.mixin)(t6,tj),(0,tb.mixin)(t6,tS),i(85522);class ee{constructor(){et(this,"count",0),et(this,"startRow",0),et(this,"endRow",0),et(this,"startPosition",0),et(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalRows:e}=t;this.count=e,this.endRow=this.count-1}process(){}finalize(){}}function ei(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(72979),i(70527);class er{constructor(){ei(this,"count",0),ei(this,"startRow",null),ei(this,"endRow",null),ei(this,"startPosition",null),ei(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){let{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:n}=e;i<=r&&(this.startRow=t),i>=r&&i<=n&&null===this.startRow&&(this.startRow=t),this.endRow=t}finalize(t){var e;let{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:n,totalRows:o,needReverse:s,startPositions:l,rowHeight:a}=t;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){let t=l[this.endRow]+a-l[this.startRow-1];if(this.startRow-=1,t>=r-n)break}this.startPosition=null!==(e=l[this.startRow])&&void 0!==e?e:null,i+r-n<0||i>l.at(-1)+a?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function en(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class eo extends er{constructor(){super(...arguments),en(this,"rowStartOffset",0),en(this,"rowEndOffset",0)}finalize(t){var e;super.finalize(t);let{overrideFn:i,totalRows:r,startPositions:n}=t;if(null!==this.startRow&&"function"==typeof i){let t=this.startRow,e=this.endRow;i(this),this.rowStartOffset=t-this.startRow,this.rowEndOffset=this.endRow-e}this.startRow<0&&(this.startRow=0),this.startPosition=null!==(e=n[this.startRow])&&void 0!==e?e:null,r<this.endRow&&(this.endRow=r-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function es(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class el{constructor(){es(this,"count",0),es(this,"startRow",null),es(this,"endRow",null),es(this,"startPosition",null),es(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){let{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:n,rowHeight:o}=e;i>=r&&i+o<=n&&(null===this.startRow&&(this.startRow=t),this.endRow=t)}finalize(t){var e;let{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:n,totalRows:o,needReverse:s,startPositions:l,rowHeight:a}=t;if(this.endRow===o-1&&s)for(this.startRow=this.endRow;this.startRow>0;){let t=l[this.endRow]+a-l[this.startRow-1];if(t<=r-n&&(this.startRow-=1),t>=r-n)break}this.startPosition=null!==(e=l[this.startRow])&&void 0!==e?e:null,i+r-n<(null===this.startRow?0:t.getRowHeight(this.startRow))||i>l.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,o<this.endRow&&(this.endRow=o-1),null!==this.startRow&&(this.count=this.endRow-this.startRow+1)}}function ea(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class eh{constructor(){ea(this,"count",0),ea(this,"startColumn",0),ea(this,"endColumn",0),ea(this,"startPosition",0),ea(this,"isVisibleInTrimmingContainer",!0)}initialize(t){let{totalColumns:e}=t;this.count=e,this.endColumn=this.count-1}process(){}finalize(){}}function eu(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ec{constructor(){eu(this,"count",0),eu(this,"startColumn",null),eu(this,"endColumn",null),eu(this,"startPosition",null),eu(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){let{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:n}=e;i<=r&&(this.startColumn=t),i>=r&&i<=r+(r>0?n+1:n)&&(null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=t),this.endColumn=t}finalize(t){var e;let{scrollOffset:i,viewportWidth:r,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=t;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){let t=a[this.endColumn]+h-a[this.startColumn-1];if(this.startColumn-=1,t>r)break}this.startPosition=null!==(e=a[this.startColumn])&&void 0!==e?e:null,i+r-(o>0?r+1:r)<-1*n||i>a.at(-1)+h||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function ed(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class eg extends ec{constructor(){super(...arguments),ed(this,"columnStartOffset",0),ed(this,"columnEndOffset",0)}finalize(t){var e;super.finalize(t);let{overrideFn:i,totalColumns:r,startPositions:n}=t;if(null!==this.startColumn&&"function"==typeof i){let t=this.startColumn,e=this.endColumn;i(this),this.columnStartOffset=t-this.startColumn,this.columnEndOffset=this.endColumn-e}this.startColumn<0&&(this.startColumn=0),this.startPosition=null!==(e=n[this.startColumn])&&void 0!==e?e:null,r<this.endColumn&&(this.endColumn=r-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}function ef(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ep{constructor(){ef(this,"count",0),ef(this,"startColumn",null),ef(this,"endColumn",null),ef(this,"startPosition",null),ef(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(t,e){let{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:n,columnWidth:o}=e;i>=r&&i+o<=r+(r>0?n+1:n)&&((null===this.startColumn||void 0===this.startColumn)&&(this.startColumn=t),this.endColumn=t)}finalize(t){var e;let{scrollOffset:i,viewportWidth:r,inlineStartOffset:n,zeroBasedScrollOffset:o,totalColumns:s,needReverse:l,startPositions:a,columnWidth:h}=t;if(this.endColumn===s-1&&l)for(this.startColumn=this.endColumn;this.startColumn>0;){let t=a[this.endColumn]+h-a[this.startColumn-1];if(t<=r&&(this.startColumn-=1),t>=r)break}this.startPosition=null!==(e=a[this.startColumn])&&void 0!==e?e:null;let u=null===this.startColumn?0:t.getColumnWidth(this.startColumn);i+r-(o>0?r+1:r)<-1*n||i>a.at(-1)||-1*i-r>-1*u?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,s<this.endColumn&&(this.endColumn=s-1),null!==this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}}var em=i(27704);function ew(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ev extends em.C{constructor(t){let{calculationTypes:e,viewportHeight:i,scrollOffset:r,totalRows:n,defaultRowHeight:o,rowHeightFn:s,overrideFn:l,horizontalScrollbarHeight:a}=t;super(e),ew(this,"viewportHeight",0),ew(this,"scrollOffset",0),ew(this,"zeroBasedScrollOffset",0),ew(this,"totalRows",0),ew(this,"rowHeightFn",null),ew(this,"rowHeight",0),ew(this,"overrideFn",null),ew(this,"horizontalScrollbarHeight",0),ew(this,"innerViewportHeight",0),ew(this,"totalCalculatedHeight",0),ew(this,"startPositions",[]),ew(this,"needReverse",!0),this.defaultHeight=o,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=n,this.rowHeightFn=s,this.overrideFn=l,this.horizontalScrollbarHeight=null!=a?a:0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalRows;t++)if(this.rowHeight=this.getRowHeight(t),this._process(t,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(t){let e=this.rowHeightFn(t);return isNaN(e)?this.defaultHeight:e}}var ey=i(67758);class eb{constructor(t,e,i,r,n){this.dataAccessObject=t,this.wot=t.wot,this.instance=this.wot,this.domBindings=e,this.wtSettings=i,this.wtTable=n,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new ee:new eo],["fullyVisible",()=>new el],["partiallyVisible",()=>new er]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new eh:new eg],["fullyVisible",()=>new ep],["partiallyVisible",()=>new ec]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){let t=this.domBindings.rootDocument,e=this.dataAccessObject.topOverlayTrimmingContainer,i=0;return e===this.domBindings.rootWindow?t.documentElement.clientHeight:(0,r.outerHeight)(e)>0&&e.clientHeight>0?e.clientHeight:1/0}getViewportHeight(){let t=this.getWorkspaceHeight();if(t===1/0)return t;let e=this.getColumnHeaderHeight();return e>0&&(t-=e),t}getWorkspaceWidth(){let t,{rootDocument:e,rootWindow:i}=this.domBindings,r=this.dataAccessObject.inlineStartOverlayTrimmingContainer;if(r===i){let i=this.wtSettings.getSetting("totalColumns");t=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,i)>t&&(t=e.documentElement.clientWidth)}else t=r.clientWidth;return t}getViewportWidth(){let t=this.getWorkspaceWidth();if(t===1/0)return t;let e=this.getRowHeaderWidth();return e>0?t-e:t}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){let t=this.domBindings.rootDocument.documentElement;return t.scrollHeight>t.clientHeight}let{holder:t,hider:e}=this.wtTable,i=t.clientHeight,r=e.offsetHeight;return i<r||r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){let t=this.domBindings.rootDocument.documentElement;return t.scrollWidth>t.clientWidth}let{holder:t,hider:e}=this.wtTable,i=t.clientWidth,r=e.offsetWidth;return i<r||r>this.getWorkspaceWidth()}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(t,e){let i=0,r=t;for(;r<e;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return(0,r.offset)(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=(0,r.outerHeight)(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){let t=this.wtSettings.getSetting("rowHeaderWidth"),e=this.wtSettings.getSetting("rowHeaders");if(t){this.rowHeaderWidth=0;for(let i=0,r=e.length;i<r;i++)this.rowHeaderWidth+=t[i]||t}if(isNaN(this.rowHeaderWidth))if(e.length){let t=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let i=0,n=e.length;i<n;i++)t?(this.rowHeaderWidth+=(0,r.outerWidth)(t),t=t.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:n,wtTable:o}=this,s=this.getViewportHeight();this.rowHeaderWidth=NaN;let l=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset,a=n.getSetting("fixedRowsTop"),h=n.getSetting("fixedRowsBottom"),u=n.getSetting("totalRows");return a&&l>=0&&(l+=e=this.dataAccessObject.topOverlay.sumCellSizes(0,a),s-=e),h&&this.dataAccessObject.bottomOverlay.clone&&(s-=e=this.dataAccessObject.bottomOverlay.sumCellSizes(u-h,u)),t=o.holder.clientHeight===o.holder.offsetHeight?0:(0,r.getScrollbarWidth)(this.domBindings.rootDocument),new ev({calculationTypes:i.map(t=>[t,this.rowsCalculatorTypes.get(t)()]),viewportHeight:s,scrollOffset:l,totalRows:n.getSetting("totalRows"),defaultRowHeight:this.instance.stylesHandler.getDefaultRowHeight(),rowHeightFn:t=>o.getRowHeight(t),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:t})}createColumnsCalculator(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["rendered","fullyVisible","partiallyVisible"],{wtSettings:e,wtTable:i}=this,n=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;let s=e.getSetting("fixedColumnsStart");if(s&&o>=0){let t=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,s);o+=t,n-=t}return i.holder.clientWidth!==i.holder.offsetWidth&&(n-=(0,r.getScrollbarWidth)(this.domBindings.rootDocument)),new ey.U({calculationTypes:t.map(t=>[t,this.columnsCalculatorTypes.get(t)()]),viewportWidth:n,scrollOffset:o,totalColumns:e.getSetting("totalColumns"),columnWidthFn:t=>i.getColumnWidth(t),overrideFn:e.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{wtSettings:e}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(t&&!e.getSetting("renderAllRows")){let e=i.getResultsFor("fullyVisible");t=this.areAllProposedVisibleRowsAlreadyRendered(e)}if(t&&!e.getSetting("renderAllColumns")){let e=r.getResultsFor("fullyVisible");t=this.areAllProposedVisibleColumnsAlreadyRendered(e)}return t||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),t}createVisibleCalculators(){let t=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),e=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=t.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=e.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=t.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(t){if(!this.rowsVisibleCalculator)return!1;let{startRow:e,endRow:i}=t;if(null===e&&null===i){if(!t.isVisibleInTrimmingContainer)return!0;e=this.rowsPartiallyVisibleCalculator.startRow,i=this.rowsPartiallyVisibleCalculator.endRow}let{startRow:r,endRow:n,rowStartOffset:o,rowEndOffset:s}=this.rowsRenderCalculator,l=this.wtSettings.getSetting("totalRows")-1,a=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(a)&&a>0?(e=Math.max(0,e-Math.min(o,a)),i=Math.min(l,i+Math.min(s,a))):"auto"===a&&(e=Math.max(0,e-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(s/2))),!(e<r)&&(e!==r||!(e>0))&&!(i>n)&&(i!==n||!(i<l))}areAllProposedVisibleColumnsAlreadyRendered(t){if(!this.columnsVisibleCalculator)return!1;let{startColumn:e,endColumn:i}=t;if(null===e&&null===i){if(!t.isVisibleInTrimmingContainer)return!0;e=this.columnsPartiallyVisibleCalculator.startColumn,i=this.columnsPartiallyVisibleCalculator.endColumn}let{startColumn:r,endColumn:n,columnStartOffset:o,columnEndOffset:s}=this.columnsRenderCalculator,l=this.wtSettings.getSetting("totalColumns")-1,a=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(a)&&a>0?(e=Math.max(0,e-Math.min(o,a)),i=Math.min(l,i+Math.min(s,a))):"auto"===a&&(e=Math.max(0,e-Math.ceil(o/2)),i=Math.min(l,i+Math.ceil(s/2))),!(e<r)&&(e!==r||!(e>0))&&!(i>n)&&(i!==n||!(i<l))}resetHasOversizedColumnHeadersMarked(){(0,tb.objectEach)(this.hasOversizedColumnHeadersMarked,(t,e,i)=>{i[e]=void 0})}}function eC(t,e,i){eS(t,e),e.set(t,i)}function eS(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eE(t,e){return t.get(eT(t,e))}function eR(t,e,i){return t.set(eT(t,e),i),i}function eT(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}i(87426),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var ex=new WeakMap,eM=new WeakMap,ek=new WeakSet;class eO{constructor(){!function(t,e){eS(t,e),e.add(t)}(this,ek),eC(this,ex,void 0),eC(this,eM,void 0)}setActiveOverlay(t){return eR(eM,this,t),this}setActiveSelection(t){return eR(ex,this,t),this}scan(){let t=eE(ex,this).settings.selectionType,e=new Set;return"active-header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"area"===t?this.scanCellsRange(t=>e.add(t)):"focus"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t)),this.scanCellsRange(t=>e.add(t))):"fill"===t?this.scanCellsRange(t=>e.add(t)):"header"===t?(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanRowsInHeadersRange(t=>e.add(t))):"row"===t?(this.scanRowsInHeadersRange(t=>e.add(t)),this.scanRowsInCellsRange(t=>e.add(t))):"column"===t&&(this.scanColumnsInHeadersRange(t=>e.add(t)),this.scanColumnsInCellsRange(t=>e.add(t))),e}scanColumnsInHeadersRange(t){let[e,i,r,n]=eE(ex,this).getCorners(),{wtTable:o}=eE(eM,this),s=o.getRenderedColumnsCount(),l=o.getColumnHeadersCount(),a=0;for(let h=-o.getRowHeadersCount();h<s;h++){let s=o.columnFilter.renderedToSource(h);if(!(s<i)&&!(s>n)){for(let h=-l;h<0;h++){if(h<e||h>r)continue;let u=h+l,c=o.getColumnHeader(s,u),d=eE(eM,this).getSetting("onBeforeHighlightingColumnHeader",s,u,{selectionType:eE(ex,this).settings.selectionType,columnCursor:a,selectionWidth:n-i+1});null!==d&&(d!==s&&(c=o.getColumnHeader(d,u)),t(c))}a+=1}}}scanRowsInHeadersRange(t){let[e,i,r,n]=eE(ex,this).getCorners(),{wtTable:o}=eE(eM,this),s=o.getRenderedRowsCount(),l=o.getRowHeadersCount(),a=0;for(let h=-o.getColumnHeadersCount();h<s;h++){let s=o.rowFilter.renderedToSource(h);if(!(s<e)&&!(s>r)){for(let h=-l;h<0;h++){if(h<i||h>n)continue;let u=h+l,c=o.getRowHeader(s,u),d=eE(eM,this).getSetting("onBeforeHighlightingRowHeader",s,u,{selectionType:eE(ex,this).settings.selectionType,rowCursor:a,selectionHeight:r-e+1});null!==d&&(d!==s&&(c=o.getRowHeader(d,u)),t(c))}a+=1}}}scanCellsRange(t){let{wtTable:e}=eE(eM,this);eT(ek,this,eI).call(this,(i,n)=>{let o=e.getCell(eE(eM,this).createCellCoords(i,n)),s=eE(eM,this).getSetting("onAfterDrawSelection",i,n,eE(ex,this).settings.layerLevel);"string"==typeof s&&(0,r.addClass)(o,s),t(o)})}scanRowsInCellsRange(t){let[e,,i]=eE(ex,this).getCorners(),{wtTable:r}=eE(eM,this);eT(ek,this,eA).call(this,(n,o)=>{n>=e&&n<=i&&t(r.getCell(eE(eM,this).createCellCoords(n,o)))})}scanColumnsInCellsRange(t){let[,e,,i]=eE(ex,this).getCorners(),{wtTable:r}=eE(eM,this);eT(ek,this,eA).call(this,(n,o)=>{o>=e&&o<=i&&t(r.getCell(eE(eM,this).createCellCoords(n,o)))})}}function eI(t){let[e,i,n,o]=eE(ex,this).getCorners();if(e<0&&n<0||i<0&&o<0)return;let{wtTable:s}=eE(eM,this),l=e!==n||i!==o;if(i=Math.max(i,0),o=Math.max(o,0),e=Math.max(e,0),n=Math.max(n,0),l){if(i=Math.max(i,s.getFirstRenderedColumn()),o=Math.min(o,s.getLastRenderedColumn()),e=Math.max(e,s.getFirstRenderedRow()),n=Math.min(n,s.getLastRenderedRow()),o<i||n<e)return}else{let t=s.getCell(eE(eM,this).createCellCoords(e,i));if(!(0,r.isHTMLElement)(t))return}for(let r=e;r<=n;r+=1)for(let e=i;e<=o;e+=1)t(r,e)}function eA(t){let{wtTable:e}=eE(eM,this),i=e.getRenderedRowsCount(),r=e.getRenderedColumnsCount();for(let n=0;n<i;n+=1){let i=e.rowFilter.renderedToSource(n);for(let n=0;n<r;n+=1)t(i,e.columnFilter.renderedToSource(n))}}class eN{constructor(t,e){if(!e)return;this.eventManager=t.eventManager,this.instance=t,this.wot=t,this.settings=e,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=tL(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(e),this.registerListeners()}registerListeners(){let t=this.wot.rootDocument.body;this.eventManager.addEventListener(t,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(t,"mouseup",()=>this.onMouseUp());for(let t=0,e=this.main.childNodes.length;t<e;t++){let e=this.main.childNodes[t];this.eventManager.addEventListener(e,"mouseenter",e=>this.onMouseEnter(e,this.main.childNodes[t]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(t,e){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;t.preventDefault(),(0,o.stopImmediatePropagation)(t);let i=this,r=this.wot.rootDocument.body,n=e.getBoundingClientRect();e.style.display="none",this.eventManager.addEventListener(r,"mousemove",function t(o){(function(t){if(t.clientY<Math.floor(n.top)||t.clientY>Math.ceil(n.top+n.height)||t.clientX<Math.floor(n.left)||t.clientX>Math.ceil(n.left+n.width))return!0})(o)&&(i.eventManager.removeEventListener(r,"mousemove",t),e.style.display="block")})}createBorders(t){let{rootDocument:e}=this.wot;this.main=e.createElement("div");let i=["top","start","bottom","end","corner"],r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let n=0;n<5;n++){let o=i[n],s=e.createElement("div");s.className=`wtBorder ${this.settings.className||""}`,this.settings[o]&&this.settings[o].hide&&(s.className+=" hidden"),(r=s.style).backgroundColor=this.settings[o]&&this.settings[o].color?this.settings[o].color:t.border.color,r.height=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,r.width=this.settings[o]&&this.settings[o].width?`${this.settings[o].width}px`:`${t.border.width}px`,this.main.appendChild(s)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),(0,a.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();let{wtTable:n}=this.wot,o=n.bordersHolder;o||((o=e.createElement("div")).className="htBorders",n.bordersHolder=o,n.spreader.appendChild(o)),o.appendChild(this.main)}createMultipleSelectorHandles(){let{rootDocument:t,stylesHandler:e}=this.wot,i=e.getCSSVariableValue("cell-mobile-handle-size"),r=e.getCSSVariableValue("cell-mobile-handle-border-radius"),n=e.getCSSVariableValue("cell-mobile-handle-background-color"),o=e.getCSSVariableValue("cell-mobile-handle-border-width"),s=e.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:t.createElement("DIV"),topHitArea:t.createElement("DIV"),bottom:t.createElement("DIV"),bottomHitArea:t.createElement("DIV")},this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};let l={position:"absolute",height:"40px",width:"40px","border-radius":`${parseInt(40/1.5,10)}px`};(0,tb.objectEach)(l,(t,e)=>{this.selectionHandles.styles.bottomHitArea[e]=t,this.selectionHandles.styles.topHitArea[e]=t});let a=e.isClassicTheme()?{position:"absolute",height:"10px",width:"10px","border-radius":`${parseInt(10/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${i}px`,width:`${i}px`,"border-radius":`${r}px`,background:`${n}`,border:`${o}px solid ${s}`};(0,tb.objectEach)(a,(t,e)=>{this.selectionHandles.styles.bottom[e]=t,this.selectionHandles.styles.top[e]=t}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(t,e){let i=this.wot.selectionManager.getAreaSelection();return!!i.cellRange&&(t!==i.cellRange.to.row||e!==i.cellRange.to.col)}updateMultipleSelectionHandlesPosition(t,e,i,r,n,o){let s=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:l,topHitArea:a,bottom:h,bottomHitArea:u}=this.selectionHandles.styles,c=parseInt(l.borderWidth,10),d=parseInt(l.width,10),g=parseInt(a.width,10),f=this.wot.wtTable.getWidth(),p=this.wot.wtTable.getHeight();l.top=`${parseInt(i-d-1,10)}px`,l[s]=`${parseInt(r-d-1,10)}px`,a.top=`${parseInt(i-g/4*3,10)}px`,a[s]=`${parseInt(r-g/4*3,10)}px`;let m=Math.min(parseInt(r+n,10),f-d-2*c),w=Math.min(parseInt(r+n-g/4,10),f-g-2*c);h[s]=`${m}px`,u[s]=`${w}px`;let y=Math.min(parseInt(i+o,10),p-d-2*c),b=Math.min(parseInt(i+o-g/4,10),p-g-2*c);h.top=`${y}px`,u.top=`${b}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(l.display="block",a.display="block",this.isPartRange(t,e)?(h.display="none",u.display="none"):(h.display="block",u.display="block")):(l.display="none",h.display="none",a.display="none",u.display="none"),t===this.wot.wtSettings.getSetting("fixedRowsTop")||e===this.wot.wtSettings.getSetting("fixedColumnsStart")?(l.zIndex="9999",a.zIndex="9999"):(l.zIndex="",a.zIndex="")}appear(t){let e;if(this.disabled)return;let[i,n,o,s]=t;if(i<0&&o<0||n<0&&s<0){this.disappear();return}let{wtTable:l,rootDocument:h,rootWindow:u}=this.wot,c=i!==o||n!==s,d=l.getFirstRenderedRow(),g=l.getLastRenderedRow(),f=l.getFirstRenderedColumn(),p=l.getLastRenderedColumn();if(f<0&&p<0||d<0&&g<0){this.disappear();return}if(c){if(n=Math.max(n,f),s=Math.min(s,p),i=Math.max(i,d),o=Math.min(o,g),s<n||o<i){this.disappear();return}e=l.getCell(this.wot.createCellCoords(i,n))}else if(e=l.getCell(this.wot.createCellCoords(i,n)),!(0,r.isHTMLElement)(e)){this.disappear();return}let m=c?l.getCell(this.wot.createCellCoords(o,s)):e,w=(0,r.offset)(e),y=c?(0,r.offset)(m):w,b=(0,r.offset)(l.TABLE),C=w.top,S=w.left,E=this.wot.wtSettings.getSetting("rtlMode"),R=0,T=0;if(E){let t=(0,r.outerWidth)(l.TABLE),i=(0,r.outerWidth)(e),n=u.innerWidth-b.left-t;T=S+i-y.left,R=u.innerWidth-S-i-n-1}else T=y.left+(0,r.outerWidth)(m)-S,R=S-b.left-1;if(this.isEntireColumnSelected(i,o)){let t=i,r=this.getDimensionsFromHeader("columns",n,s,t,b),o=null;r&&([o,R,T]=r),o&&(e=o)}let x=C-b.top-1,M=y.top+(0,r.outerHeight)(m)-C;if(this.isEntireRowSelected(n,s)){let t=n,r=this.getDimensionsFromHeader("rows",i,o,t,b),s=null;r&&([s,x,M]=r),s&&(e=s)}let k=u.getComputedStyle(e);parseInt(k.borderTopWidth,10)>0&&(x+=1,M=M>0?M-1:0),parseInt(k[E?"borderRightWidth":"borderLeftWidth"],10)>0&&(R+=1,T=T>0?T-1:0);let O=E?"right":"left";this.topStyle.top=`${x}px`,this.topStyle[O]=`${R}px`,this.topStyle.width=`${T}px`,this.topStyle.display="block",this.startStyle.top=`${x}px`,this.startStyle[O]=`${R}px`,this.startStyle.height=`${M}px`,this.startStyle.display="block";let I=Math.floor(this.settings.border.width/2);this.bottomStyle.top=`${x+M-I}px`,this.bottomStyle[O]=`${R}px`,this.bottomStyle.width=`${T}px`,this.bottomStyle.display="block",this.endStyle.top=`${x}px`,this.endStyle[O]=`${R+T-I}px`,this.endStyle.height=`${M+1}px`,this.endStyle.display="block";let A=this.settings.border.cornerVisible;A="function"==typeof A?A(this.settings.layerLevel):A;let N=this.wot.getSetting("onModifyGetCellCoords",o,s,!1,"render"),[H,P]=[o,s];if(N&&Array.isArray(N)&&([,,H,P]=N),(0,a.isMobileBrowser)()||!A||this.isPartRange(H,P))this.cornerStyle.display="none";else{this.cornerStyle.top=`${x+M+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[O]=`${R+T+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let t=(0,r.getTrimmingContainer)(l.TABLE),e=t===u;e&&(t=h.documentElement);let i=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,n=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),a=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(s===this.wot.getSetting("totalColumns")-1){let o=e?m.getBoundingClientRect().left:m.offsetLeft,s=!1,l=0;(E?o-parseInt(this.cornerDefaultStyle.width,10)/2<0:o+(0,r.outerWidth)(m)+parseInt(this.cornerDefaultStyle.width,10)/2>=(0,r.innerWidth)(t))&&(this.cornerStyle[O]=`${Math.floor(R+T+this.cornerCenterPointOffset-n-i)}px`,this.cornerStyle[E?"borderLeftWidth":"borderRightWidth"]=0)}if(o===this.wot.getSetting("totalRows")-1){let n=(e?m.getBoundingClientRect().top:m.offsetTop)+(0,r.outerHeight)(m)+parseInt(this.cornerDefaultStyle.height,10)/2>=(0,r.innerHeight)(t),o=this.wot.stylesHandler.isClassicTheme();if(n){let t=Math.floor(x+M+this.cornerCenterPointOffset-a-i);o?(this.cornerStyle.top=`${t}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${t-1}px`}}this.cornerStyle.display="block"}(0,a.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(o,s,x,R,T,M)}isEntireColumnSelected(t,e){return t===this.wot.wtTable.getFirstRenderedRow()&&e===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(t,e){return t===this.wot.wtTable.getFirstRenderedColumn()&&e===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(t,e,i,n,o){let{wtTable:s}=this.wot,l=s.wtRootElement.parentNode,a=null,h=null,u=null,c=null,d=null,g=null,f=null,p=null;switch(t){case"rows":a=function(){return s.getRowHeader(...arguments)},h=function(){return(0,r.outerHeight)(...arguments)},u="ht__selection--rows",g="top";break;case"columns":a=function(){return s.getColumnHeader(...arguments)},h=function(){return(0,r.outerWidth)(...arguments)},u="ht__selection--columns",g="left"}if(l.classList.contains(u)){let t=this.wot.getSetting("columnHeaders").length;if(f=a(e,t-n),p=a(i,t-n),!f||!p)return!1;let s=(0,r.offset)(f),l=(0,r.offset)(p);return f&&p&&(c=s[g]-o[g]-1,d=l[g]+h(p)-s[g]),[f,c,d]}return!1}changeBorderStyle(t,e){let i=this[t].style,n=e[t];!n||n.hide?(0,r.addClass)(this[t],"hidden"):((0,r.hasClass)(this[t],"hidden")&&(0,r.removeClass)(this[t],"hidden"),i.backgroundColor=n.color,("top"===t||"bottom"===t)&&(i.height=`${n.width}px`),("start"===t||"end"===t)&&(i.width=`${n.width}px`))}changeBorderToDefaultStyle(t){let e=this[t].style;e.backgroundColor="#000",e.width="1px",e.height="1px"}toggleHiddenClass(t,e){this.changeBorderToDefaultStyle(t),e?(0,r.addClass)(this[t],"hidden"):(0,r.removeClass)(this[t],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",(0,a.isMobileBrowser)()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function eH(t,e,i){eP(t,e),e.set(t,i)}function eP(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function e_(t,e){return t.get(eL(t,e))}function eD(t,e,i){return t.set(eL(t,e),i),i}function eL(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var eF=new WeakMap,eV=new WeakMap,eW=new WeakMap,eB=new WeakMap,ej=new WeakMap,ez=new WeakMap,eU=new WeakSet;class e${constructor(t){!function(t,e){eP(t,e),e.add(t)}(this,eU),eH(this,eF,void 0),eH(this,eV,void 0),eH(this,eW,new eO),eH(this,eB,new WeakMap),eH(this,ej,new WeakSet),eH(this,ez,new Map),eD(eV,this,t)}setActiveOverlay(t){return eD(eF,this,t),e_(eW,this).setActiveOverlay(e_(eF,this)),e_(eB,this).has(e_(eF,this))||e_(eB,this).set(e_(eF,this),new Set),this}getFocusSelection(){return null!==e_(eV,this)?e_(eV,this).getFocus():null}getAreaSelection(){return null!==e_(eV,this)?e_(eV,this).createLayeredArea():null}getBorderInstance(t){if(!t.settings.border)return null;if(e_(ez,this).has(t)){let e=e_(ez,this).get(t);if(e.has(e_(eF,this)))return e.get(e_(eF,this));let i=new eN(e_(eF,this),t.settings);return e.set(e_(eF,this),i),i}let e=new eN(e_(eF,this),t.settings);return e_(ez,this).set(t,new Map([[e_(eF,this),e]])),e}getBorderInstances(t){var e,i;return Array.from(null!==(e=null===(i=e_(ez,this).get(t))||void 0===i?void 0:i.values())&&void 0!==e?e:[])}destroyBorders(t){e_(ez,this).get(t).forEach(t=>t.destroy()),e_(ez,this).delete(t)}render(t){if(null===e_(eV,this))return;t&&eL(eU,this,eY).call(this);let e=Array.from(e_(eV,this)),i=new Map,n=new Map;for(let t=0;t<e.length;t++){let r=e[t],{className:o,headerAttributes:s,createLayers:l,selectionType:a}=r.settings;e_(ej,this).has(r)||(e_(ej,this).add(r),r.addLocalHook("destroy",()=>this.destroyBorders(r)));let h=this.getBorderInstance(r);if(r.isEmpty()){null==h||h.disappear();continue}o&&e_(eW,this).setActiveSelection(r).scan().forEach(t=>{if(i.has(t)){let e=i.get(t);e.has(o)&&!0===l?e.set(o,e.get(o)+1):e.set(o,1)}else i.set(t,new Map([[o,1]]));s&&(n.has(t)||n.set(t,[]),"TH"===t.nodeName&&n.get(t).push(...s))});let u=r.getCorners();e_(eF,this).getSetting("onBeforeDrawBorders",u,a),null==h||h.appear(u)}i.forEach((t,e)=>{var i;let n=Array.from(t).map(t=>{let[e,i]=t;return 1===i?e:[e,...Array.from({length:i-1},(t,i)=>`${e}-${i+1}`)]}).flat();n.forEach(t=>e_(eB,this).get(e_(eF,this)).add(t)),(0,r.addClass)(e,n),"TD"===e.nodeName&&Array.isArray(null===(i=e_(eV,this).options)||void 0===i?void 0:i.cellAttributes)&&(0,r.setAttribute)(e,e_(eV,this).options.cellAttributes)}),Array.from(n.keys()).forEach(t=>{(0,r.setAttribute)(t,[...n.get(t)])})}}function eY(){let t=e_(eB,this).get(e_(eF,this)),e=e_(eF,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let i=0;i<e.length;i++)t.add(e[i]);t.forEach(t=>{var e,i;let n=e_(eF,this).wtTable.TABLE.querySelectorAll(`.${t}`),o=[];Array.isArray(null===(e=e_(eV,this).options)||void 0===e?void 0:e.cellAttributes)&&(o=e_(eV,this).options.cellAttributes.map(t=>t[0])),Array.isArray(null===(i=e_(eV,this).options)||void 0===i?void 0:i.headerAttributes)&&(o=[...o,...e_(eV,this).options.headerAttributes.map(t=>t[0])]);for(let e=0,i=n.length;e<i;e++)(0,r.removeClass)(n[e],t),(0,r.removeAttribute)(n[e],o)}),t.clear()}function eG(t,e,i){eq(t,e),e.set(t,i)}function eq(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eX(t,e){return t.get(eJ(t,e))}function eK(t,e,i){return t.set(eJ(t,e),i),i}function eJ(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var eQ=new WeakMap,eZ=new WeakMap,e0=new WeakMap,e1=new WeakMap,e2=new WeakMap,e3=new WeakMap,e9=new WeakMap,e4=new WeakSet;class e5{constructor(t){!function(t,e){eq(t,e),e.add(t)}(this,e4),eG(this,eQ,void 0),eG(this,eZ,void 0),eG(this,e0,void 0),eG(this,e1,void 0),eG(this,e2,!0),eG(this,e3,{}),eG(this,e9,{}),eK(eZ,this,t.rootTable.parentElement.parentElement),eK(e1,this,t.rootDocument)}isClassicTheme(){return eX(e2,this)}getCSSVariableValue(t){var e;if(eX(e2,this))return null;if(eX(e3,this)[`--ht-${t}`])return eX(e3,this)[`--ht-${t}`];let i=null!==(e=eJ(e4,this,ie).call(this,`--ht-${t}`))&&void 0!==e?e:eJ(e4,this,ii).call(this,`--ht-${t}`);if(null!==i)return eX(e3,this)[`--ht-${t}`]=i,i}getStyleForTD(t){var e;return null===(e=eX(e9,this))||void 0===e?void 0:e.td[t]}getDefaultRowHeight(){if(eX(e2,this))return 23;let t=eJ(e4,this,e8).call(this);return!t&&(0,r.hasClass)(eX(eZ,this),"ht-wrapper")?((0,k.R8)(`The "${eX(eQ,this)}" theme is enabled, but its stylesheets are missing or not imported correctly. \
Import the correct CSS files in order to use that theme.`),eK(e2,this,!0),this.useTheme(),23):t}areCellsBorderBox(){return"border-box"===this.getStyleForTD("box-sizing")}useTheme(t){if(!t){eJ(e4,this,e6).call(this),eK(e2,this,!0),eK(eQ,this,t||void 0);return}t&&t!==eX(eQ,this)&&(eX(eQ,this)&&eJ(e4,this,ir).call(this),eK(eQ,this,t),eK(e2,this,!1),eJ(e4,this,e7).call(this),eJ(e4,this,e6).call(this))}getThemeName(){return eX(eQ,this)}removeClassNames(){(0,r.hasClass)(eX(eZ,this),eX(eQ,this))&&(0,r.removeClass)(eX(eZ,this),eX(eQ,this))}}function e8(){let t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),i=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return null===t||null===e||isNaN(i)?null:t+2*e+i}function e7(){(0,r.removeClass)(eX(eZ,this),/ht-theme-.*/g),(0,r.addClass)(eX(eZ,this),eX(eQ,this))}function e6(){this.isClassicTheme()||eK(e0,this,getComputedStyle(eX(eZ,this)));let t=eJ(e4,this,it).call(this,["box-sizing","border-bottom-width"]);eX(e9,this).td={...eX(e9,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function it(t){let e=eX(e1,this),i=eX(eZ,this),r=e.createElement("table"),n=e.createElement("tbody"),o=e.createElement("tr"),s=e.createElement("tr"),l=e.createElement("td");s.appendChild(l),n.appendChild(o),n.appendChild(s),r.appendChild(n),i.appendChild(r);let a=getComputedStyle(l),h={};return t.forEach(t=>{h[t]=a.getPropertyValue(t)}),i.removeChild(r),h}function ie(t){let e=Math.ceil(parseFloat(eJ(e4,this,ii).call(this,t)));return Number.isNaN(e)?null:e}function ii(t){let e=eX(e0,this).getPropertyValue(t);return""===e?null:e}function ir(){eK(e9,this,{}),eK(e3,this,{}),eK(e2,this,!0)}class io extends tH{constructor(t,e){super(t,new t7(e)),this.stylesHandler=new e5(this.domBindings);let i=this.wtSettings.getSetting("facade",this);this.wtTable=new t6(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new eb(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new e$(this.wtSettings.getSetting("selections")),this.wtEvent=new T(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new t5(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){let t=[],e=[];(0,tb.objectEach)({rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},(i,r)=>{this.wtSettings.getSetting(r).length&&e.push(i),t.push(i)}),(0,r.removeClass)(this.wtTable.wtRootElement.parentNode,t),(0,r.addClass)(this.wtTable.wtRootElement.parentNode,e)}getOverlayByName(t){var e;if(!tp.includes(t))return null;let i=t.replace(/_([a-z])/g,t=>t[1].toUpperCase());return null!==(e=this.wtOverlays[`${i}Overlay`])&&void 0!==e?e:null}getViewportDao(){let t=this;return{get wot(){return t},get topOverlayTrimmingContainer(){return t.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return t.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return t.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return t.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return t.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return t.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return t.wtOverlays.topOverlay},get inlineStartOverlay(){return t.wtOverlays.inlineStartOverlay},get bottomOverlay(){return t.wtOverlays.bottomOverlay}}}}class is{constructor(t){t instanceof tH?this._wot=t:this._initFromSettings(t)}_initFromSettings(t){t.facade=t=>{let e=new is(t);return()=>e},this._wot=new io(t.table,t)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(t){this._wot.drawn=t}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(t){this._wot.drawInterrupted=t}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(t){this._wot.lastMouseOver=t}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(t){this._wot.momentumScrolling=t}get touchApplied(){return this._wot.touchApplied}set touchApplied(t){this._wot.touchApplied=t}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(t){this._wot.eventListeners=t}get eventManager(){return this._wot.eventManager}get stylesHandler(){return this._wot.stylesHandler}createCellCoords(t,e){return this._wot.createCellCoords(t,e)}createCellRange(t,e,i){return this._wot.createCellRange(t,e,i)}draw(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._wot.draw(t),this}getCell(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._wot.getCell(t,e)}scrollViewport(t,e,i){return this._wot.scrollViewport(t,e,i)}scrollViewportHorizontally(t,e){return this._wot.scrollViewportHorizontally(t,e)}scrollViewportVertically(t,e){return this._wot.scrollViewportVertically(t,e)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(t){return this._wot.getOverlayByName(t)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(t,e){return this._wot.wtSettings.update(t,e),this}getSetting(t,e,i,r,n){return this._wot.wtSettings.getSetting(t,e,i,r,n)}hasSetting(t){return this._wot.wtSettings.hasSetting(t)}destroy(){this._wot.destroy()}}function il(t){let{isShiftKey:e,isLeftClick:i,isRightClick:r,coords:n,selection:o,controller:s,cellCoordsFactory:l}=t,a=o.isSelected()?o.getSelectedRange().current():null,h=o.isSelectedByCorner(),u=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&a)n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(n):(h||u)&&n.row>=0&&n.col>=0&&!s.cell?o.setRangeEnd(l(n.row,n.col)):h&&n.row<0&&!s.column?o.setRangeEnd(l(a.to.row,n.col)):u&&n.col<0&&!s.row?o.setRangeEnd(l(n.row,a.to.col)):(!h&&!u&&n.col<0||h&&n.col<0)&&!s.row?o.selectRows(Math.max(a.from.row,0),n.row,n.col):(!h&&!u&&n.row<0||u&&n.row<0)&&!s.column&&o.selectColumns(Math.max(a.from.col,0),n.col,n.row);else{let t=!o.inInSelection(n),e=i||r&&t;n.row<0&&n.col>=0&&!s.column?e&&o.selectColumns(n.col,n.col,n.row):n.col<0&&n.row>=0&&!s.row?e&&o.selectRows(n.row,n.row,n.col):n.col>=0&&n.row>=0&&!s.cell?e&&o.setRangeStart(n):n.col<0&&n.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}let ia=new Map([["mousedown",il],["mouseover",function(t){let{isLeftClick:e,coords:i,selection:r,controller:n,cellCoordsFactory:o}=t;if(!e)return;let s=r.isSelectedByRowHeader(),l=r.isSelectedByColumnHeader(),a=r.tableProps.countCols(),h=r.tableProps.countRows();r.markSource("mouse"),l&&!n.column?r.setRangeEnd(o(h-1,i.col)):s&&!n.row?r.setRangeEnd(o(i.row,a-1)):n.cell||r.setRangeEnd(i),r.markEndSource()}],["touchstart",il]]);function ih(t,e){let{coords:i,selection:r,controller:n,cellCoordsFactory:s}=e;ia.get(t.type)({coords:i,selection:r,controller:n,cellCoordsFactory:s,isShiftKey:t.shiftKey,isLeftClick:(0,o.isLeftClick)(t)||"touchstart"===t.type,isRightClick:(0,o.isRightClick)(t)})}var iu=i(36425);function ic(t,e,i){id(t,e),e.set(t,i)}function id(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ig(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ip(t,e){return t.get(iw(t,e))}function im(t,e,i){return t.set(iw(t,e),i),i}function iw(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var iv=new WeakMap,iy=new WeakMap,ib=new WeakMap,iC=new WeakMap,iS=new WeakMap,iE=new WeakMap,iR=new WeakMap,iT=new WeakMap,ix=new WeakSet;class iM{constructor(t){!function(t,e){id(t,e),e.add(t)}(this,ix),ig(this,"hot",void 0),ig(this,"eventManager",void 0),ig(this,"settings",void 0),ig(this,"THEAD",void 0),ig(this,"TBODY",void 0),ig(this,"_wt",void 0),ig(this,"activeWt",void 0),ic(this,iv,0),ic(this,iy,0),ig(this,"postponedAdjustElementsSize",!1),ic(this,ib,!1),ic(this,iC,void 0),ic(this,iS,void 0),ic(this,iE,0),ic(this,iR,0),ic(this,iT,null),this.hot=t,this.eventManager=new n.A(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){let t=this.hot.forceFullRender;this.hot.runHooks("beforeRender",t),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize()),this._wt.draw(!t),iw(ix,this,iI).call(this),this.hot.runHooks("afterRender",t),this.hot.forceFullRender=!1}}adjustElementsSize(){this.hot.isRenderSuspended()?this.postponedAdjustElementsSize=!0:this._wt.wtOverlays.adjustElementsSize()}getCellAtCoords(t,e){let i=this._wt.getCell(t,e);return i<0?null:i}scrollViewport(t,e,i){return this._wt.scrollViewport(t,e,i)}scrollViewportHorizontally(t,e){return this._wt.scrollViewportHorizontally(t,e)}scrollViewportVertically(t,e){return this._wt.scrollViewportVertically(t,e)}createElements(){let{rootElement:t,rootDocument:e}=this.hot,i=t.getAttribute("style");i&&t.setAttribute("data-originalstyle",i),(0,r.addClass)(t,"handsontable"),im(iS,this,e.createElement("TABLE")),(0,r.addClass)(ip(iS,this),"htCore"),this.hot.getSettings().tableClassName&&(0,r.addClass)(ip(iS,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&((0,r.setAttribute)(ip(iS,this),[(0,Y.gg)()]),(0,r.setAttribute)(t,[(0,Y.ax)(),(0,Y.DZ)(-1),(0,Y.Nb)(this.hot.countCols()),(0,Y.L4)()])),this.THEAD=e.createElement("THEAD"),ip(iS,this).appendChild(this.THEAD),this.TBODY=e.createElement("TBODY"),ip(iS,this).appendChild(this.TBODY),this.hot.table=ip(iS,this),this.hot.container.insertBefore(ip(iS,this),this.hot.container.firstChild)}registerEvents(){let{rootElement:t,rootDocument:e,selection:i,rootWindow:n}=this.hot,s=e.documentElement;this.eventManager.addEventListener(t,"mousedown",t=>{im(ib,this,!0),this.isTextSelectionAllowed(t.target)||((0,r.clearTextSelection)(n),t.preventDefault(),n.focus())}),this.eventManager.addEventListener(t,"mouseup",()=>{im(ib,this,!1)}),this.eventManager.addEventListener(t,"mousemove",t=>{ip(ib,this)&&!this.isTextSelectionAllowed(t.target)&&(this.settings.fragmentSelection&&(0,r.clearTextSelection)(n),t.preventDefault())}),this.eventManager.addEventListener(s,"keyup",t=>{i.isInProgress()&&!t.shiftKey&&i.finish()}),this.eventManager.addEventListener(s,"mouseup",n=>{i.isInProgress()&&(0,o.isLeftClick)(n)&&i.finish(),im(iC,this,!1);let s=(0,r.isOutsideInput)(e.activeElement);(0,r.isInput)(e.activeElement)&&!s||!s&&(i.isSelected()||i.isSelectedByAnyHeader()||t.contains(n.target)||(0,o.isRightClick)(n))||this.hot.unlisten()}),this.eventManager.addEventListener(s,"contextmenu",t=>{i.isInProgress()&&(0,o.isRightClick)(t)&&(i.finish(),im(iC,this,!1))}),this.eventManager.addEventListener(s,"touchend",()=>{i.isInProgress()&&i.finish(),im(iC,this,!1)}),this.eventManager.addEventListener(s,"mousedown",i=>{let n=i.target,o=i.x||i.clientX,l=i.y||i.clientY,a=i.target;if(ip(iC,this)||!t||!this.hot.view)return;let{holder:h}=this._wt.wtTable;if(a===h){let t=(0,r.getScrollbarWidth)(e);if(e.elementFromPoint(o+t,l)!==h||e.elementFromPoint(o,l+t)!==h)return}else for(;a!==s;){if(null===a){if(i.isTargetWebComponent)break;return}if(a===t)return;a=a.parentNode}("function"==typeof this.settings.outsideClickDeselects?this.settings.outsideClickDeselects(n):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let l=(0,r.getParentWindow)(n);for(;null!==l;)this.eventManager.addEventListener(l.document.documentElement,"click",()=>{this.hot.unlisten()}),l=(0,r.getParentWindow)(l);this.eventManager.addEventListener(ip(iS,this),"selectstart",t=>{this.settings.fragmentSelection||(0,r.isInput)(t.target)||t.preventDefault()})}translateFromRenderableToVisualCoords(t){let{row:e,col:i}=t;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(e,i))}translateFromRenderableToVisualIndex(t,e){let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t,r=e>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(e):e;return null===i&&(i=t),null===r&&(r=e),[i,r]}countRenderableIndexes(t,e){let i=Math.min(t.getNotTrimmedIndexesLength(),e),r=t.getNearestNotHiddenIndex(i-1,-1);return null===r?0:t.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(t,e){return this.countNotHiddenIndexes(t,e,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(t,e,i,r){if(isNaN(t)||t<0)return 0;let n=i.getNearestNotHiddenIndex(t,e),o=i.getRenderableFromVisualIndex(n);if(!Number.isInteger(o))return 0;let s=0;return e<0?s=o+1:e>0&&(s=r-o),s}countNotHiddenFixedColumnsStart(){let t=this.hot.countCols(),e=Math.min(parseInt(this.settings.fixedColumnsStart,10),t)-1;return this.countNotHiddenColumnIndexes(e,-1)}countNotHiddenFixedRowsTop(){let t=this.hot.countRows(),e=Math.min(parseInt(this.settings.fixedRowsTop,10),t)-1;return this.countNotHiddenRowIndexes(e,-1)}countNotHiddenFixedRowsBottom(){let t=Math.max(this.hot.countRows()-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(t,1)}countRenderableColumnsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}countRenderableRowsInRange(t,e){let i=0;for(let r=t;r<=e;r++)null!==this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)&&(i+=1);return i}getStylesHandler(){return this._wt.stylesHandler}getDefaultRowHeight(){return this._wt.stylesHandler.getDefaultRowHeight()}addClassNameToLicenseElement(t){var e;let i=null===(e=this.hot.rootElement.parentNode)||void 0===e?void 0:e.querySelector(".hot-display-license-info");i&&(0,r.addClass)(i,t)}removeClassNameFromLicenseElement(t){var e;let i=null===(e=this.hot.rootElement.parentNode)||void 0===e?void 0:e.querySelector(".hot-display-license-info");i&&(0,r.removeClass)(i,t)}isMainTableNotFullyCoveredByOverlays(){let t=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),e=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>t&&this.hot.countRenderedCols()>e}initializeWalkontable(){let t={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:ip(iS,this),isDataViewInstance:()=>(0,iu.yn)(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(t,e)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(t,e)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||t.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||t.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{let t=[];return this.hot.hasRowHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(t):t;this.appendRowHeader(i,e)}),this.hot.runHooks("afterGetRowHeaderRenderers",t),im(iy,this,t.length),this.hot.getSettings().ariaTags&&iw(ix,this,ik).call(this)===this.hot.countCols()&&iw(ix,this,iO).call(this,ip(iy,this)),t},columnHeaders:()=>{let t=[];return this.hot.hasColHeaders()&&t.push((t,e)=>{let i=t>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(t):t;this.appendColHeader(i,e)}),this.hot.runHooks("afterGetColumnHeaderRenderers",t),im(iv,this,t.length),t},columnWidth:t=>{let e=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getColWidth(null===e?t:e)},rowHeight:t=>{let e=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t);return this.hot.getRowHeight(null===e?t:e)},rowHeightByOverlayName:(t,e)=>{let i=this.hot.rowIndexMapper.getVisualFromRenderableIndex(t),r=null===i?t:i;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(r),r,e)},cellRenderer:(t,e,i)=>{let[r,n]=this.translateFromRenderableToVisualIndex(t,e),o=this.hot.runHooks("modifyGetCellCoords",r,n,!1,"meta"),s=r,l=n;Array.isArray(o)&&([s,l]=o);let a=this.hot.getCellMeta(s,l),h=this.hot.colToProp(l),u=this.hot.getDataAtRowProp(s,h);this.hot.hasHook("beforeValueRender")&&(u=this.hot.runHooks("beforeValueRender",u,a)),this.hot.runHooks("beforeRenderer",i,r,n,h,u,a),this.hot.getCellRenderer(a)(this.hot,i,r,n,h,u,a),this.hot.runHooks("afterRenderer",i,r,n,h,u,a)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&(0,r.isVisible)(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=r,im(iC,this,!0),im(iT,this,{x:t.clientX,y:t.clientY}),this.hot.runHooks("beforeOnCellMouseDown",t,n,i,s),(0,o.isImmediatePropagationStopped)(t)||(ih(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseDown",t,n,i),this.activeWt=this._wt)},onCellContextMenu:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,im(iC,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",t,n,i),(0,o.isImmediatePropagationStopped)(t)||(this.hot.runHooks("afterOnCellContextMenu",t,n,i),this.activeWt=this._wt)},onCellMouseOut:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOut",t,n,i),(0,o.isImmediatePropagationStopped)(t)||(this.hot.runHooks("afterOnCellMouseOut",t,n,i),this.activeWt=this._wt)},onCellMouseOver:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e),s={row:!1,column:!1,cell:!1};this.activeWt=r,this.hot.runHooks("beforeOnCellMouseOver",t,n,i,s),(0,o.isImmediatePropagationStopped)(t)||(ip(iC,this)&&(!ip(iT,this)||ip(iT,this).x!==t.clientX||ip(iT,this).y!==t.clientY)&&ih(t,{coords:n,selection:this.hot.selection,controller:s,cellCoordsFactory:(t,e)=>this.hot._createCellCoords(t,e)}),this.hot.runHooks("afterOnCellMouseOver",t,n,i),this.activeWt=this._wt,im(iT,this,null))},onCellMouseUp:(t,e,i,r)=>{let n=this.translateFromRenderableToVisualCoords(e);this.activeWt=r,this.hot.runHooks("beforeOnCellMouseUp",t,n,i),(0,o.isImmediatePropagationStopped)(t)||this.hot.isDestroyed||(this.hot.runHooks("afterOnCellMouseUp",t,n,i),this.activeWt=this._wt)},onCellCornerMouseDown:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",t)},onCellCornerDblClick:t=>{t.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",t)},beforeDraw:(t,e)=>this.beforeRender(t,e),onDraw:t=>this.afterRender(t),onBeforeViewportScrollVertically:(t,e)=>{let i=this.hot.rowIndexMapper,r=t<0,n=t;return r||null!==(n=i.getVisualFromRenderableIndex(t))?(n=this.hot.runHooks("beforeViewportScrollVertically",n,e),this.hot.runHooks("beforeViewportScroll"),r)?n:i.getRenderableFromVisualIndex(n):t},onBeforeViewportScrollHorizontally:(t,e)=>{let i=this.hot.columnIndexMapper,r=t<0,n=t;return r||null!==(n=i.getVisualFromRenderableIndex(t))?(n=this.hot.runHooks("beforeViewportScrollHorizontally",n,e),this.hot.runHooks("beforeViewportScroll"),r)?n:i.getRenderableFromVisualIndex(n):t},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(t,e,i)=>{let r=this.hot.rowIndexMapper,n=t<0,o=t;n||(o=r.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingRowHeader",o,e,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onBeforeHighlightingColumnHeader:(t,e,i)=>{let r=this.hot.columnIndexMapper,n=t<0,o=t;n||(o=r.getVisualFromRenderableIndex(t));let s=this.hot.runHooks("beforeHighlightingColumnHeader",o,e,i);return n?s:r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(s,1))},onAfterDrawSelection:(t,e,i)=>{let r,[n,o]=this.translateFromRenderableToVisualIndex(t,e),s=this.hot.selection.getSelectedRange();if(s.size()>0){let t=s.peekByIndex(null!=i?i:0);r=[t.from.row,t.from.col,t.to.row,t.to.col]}return this.hot.runHooks("afterDrawSelection",n,o,r,i)},onBeforeDrawBorders:(t,e)=>{let[i,r,n,o]=t,s=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(i),this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),this.hot.rowIndexMapper.getVisualFromRenderableIndex(n),this.hot.columnIndexMapper.getVisualFromRenderableIndex(o)];return this.hot.runHooks("beforeDrawBorders",s,e)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:t=>this.hot.runHooks("modifyRowHeaderWidth",t),onModifyGetCellCoords:(t,e,i,r)=>{let n=this.hot.rowIndexMapper,o=this.hot.columnIndexMapper,s=e>=0?o.getVisualFromRenderableIndex(e):e,l=t>=0?n.getVisualFromRenderableIndex(t):t,a=this.hot.runHooks("modifyGetCellCoords",l,s,i,r);if(Array.isArray(a)){let[t,e,i,r]=a;return[t>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(t,1)):t,e>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(e,1)):e,i>=0?n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(i,-1)):i,r>=0?o.getRenderableFromVisualIndex(o.getNearestNotHiddenIndex(r,-1)):r]}},onModifyGetCoordsElement:(t,e)=>{let i=this.hot.rowIndexMapper,r=this.hot.columnIndexMapper,n=e>=0?r.getVisualFromRenderableIndex(e):e,o=t>=0?i.getVisualFromRenderableIndex(t):t,s=this.hot.runHooks("modifyGetCoordsElement",o,n);if(Array.isArray(s)){let[t,e]=s;return[t>=0?i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(t,1)):t,e>=0?r.getRenderableFromVisualIndex(r.getNearestNotHiddenIndex(e,1)):e]}},viewportRowCalculatorOverride:t=>{let e=this.settings.viewportRowRenderingOffset;if("auto"===e&&this.settings.fixedRowsTop&&(e=10),e>0||"auto"===e){let i=this.countRenderableRows(),r=t.startRow,n=t.endRow;if("number"==typeof e)t.startRow=Math.max(r-e,0),t.endRow=Math.min(n+e,i-1);else if("auto"===e){let e=Math.max(1,Math.ceil(n/i*12));t.startRow=Math.max(r-e,0),t.endRow=Math.min(n+e,i-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",t)},viewportColumnCalculatorOverride:t=>{let e=this.settings.viewportColumnRenderingOffset;if("auto"===e&&this.settings.fixedColumnsStart&&(e=10),e>0||"auto"===e){let i=this.countRenderableColumns(),r=t.startColumn,n=t.endColumn;if("number"==typeof e&&(t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(n+e,i-1)),"auto"===e){let e=Math.max(1,Math.ceil(n/i*6));t.startColumn=Math.max(r-e,0),t.endColumn=Math.min(n+e,i-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",t)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{let t=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||t}};this.hot.runHooks("beforeInitWalkontable",t),this._wt=new is(t),this.activeWt=this._wt;let e=this._wt.wtTable.spreader,{width:i,height:n}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,n),this.eventManager.addEventListener(e,"mousedown",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(e,"contextmenu",t=>{t.target===e&&3===t.which&&t.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(t){if((0,r.isInput)(t))return!0;let e=(0,r.isChildOf)(t,this._wt.wtTable.spreader);return!!(!0===this.settings.fragmentSelection&&e||"cell"===this.settings.fragmentSelection&&this.isSelectedOnlyCell()&&e||!this.settings.fragmentSelection&&this.isCellEdited()&&this.isSelectedOnlyCell())}isMouseDown(){return ip(iC,this)}isSelectedOnlyCell(){var t,e;return null!==(t=null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingleCell())&&void 0!==t&&t}isCellEdited(){let t=this.hot.getActiveEditor();return t&&t.isOpened()}beforeRender(t,e){t&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,e)}afterRender(t){t&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(t,e){if(e.firstChild){let i=e.firstChild;if(!(0,r.hasClass)(i,"relative")){(0,r.empty)(e),this.appendRowHeader(t,e);return}this.updateCellHeader(i.querySelector(".rowHeader"),t,this.hot.getRowHeader)}else{let{rootDocument:i,getRowHeader:r}=this.hot,n=i.createElement("div"),o=i.createElement("span");n.className="relative",o.className="rowHeader",this.updateCellHeader(o,t,r),n.appendChild(o),e.appendChild(n)}this.hot.runHooks("afterGetRowHeader",t,e)}appendColHeader(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.hot.getColHeader,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=()=>{let e=t>=0?this.hot.getColumnMeta(t).headerClassName:null;return e?e.split(" "):[]};if(e.firstChild){let s=e.firstChild;(0,r.hasClass)(s,"relative")?(this.updateCellHeader(s.querySelector(".colHeader"),t,i,n),s.className="",(0,r.addClass)(s,["relative",...o()])):((0,r.empty)(e),this.appendColHeader(t,e,i,n))}else{let{rootDocument:s}=this.hot,l=s.createElement("div"),a=s.createElement("span"),h=o();l.classList.add("relative",...h),a.className="colHeader",this.settings.ariaTags&&((0,r.setAttribute)(l,...(0,Y.gg)()),(0,r.setAttribute)(a,...(0,Y.gg)())),this.updateCellHeader(a,t,i,n),l.appendChild(a),e.appendChild(l)}this.hot.runHooks("afterGetColHeader",t,e,n)}updateCellHeader(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e,s=this._wt.wtOverlays.getParentOverlay(t)||this._wt;t.parentNode&&((0,r.hasClass)(t,"colHeader")?o=s.wtTable.columnFilter.sourceToRendered(e):(0,r.hasClass)(t,"rowHeader")&&(o=s.wtTable.rowFilter.sourceToRendered(e))),o>-1?(0,r.fastInnerHTML)(t,i(e,n)):((0,r.fastInnerText)(t,String.fromCharCode(160)),(0,r.addClass)(t,"cornerHeader"))}maximumVisibleElementWidth(t){let e=this._wt.wtViewport.getWorkspaceWidth()-t;return e>0?e:0}maximumVisibleElementHeight(t){let e=this._wt.wtViewport.getWorkspaceHeight()-t;return e>0?e:0}setLastSize(t,e){im(iE,this,t),im(iR,this,e)}getLastSize(){return{width:ip(iE,this),height:ip(iR,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;let t=this.hot.rowIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return t.getNearestNotHiddenIndex(null!=e?e:0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;let t=this.hot.rowIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return t.getNearestNotHiddenIndex(null!=e?e:this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;let t=this.hot.columnIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return t.getNearestNotHiddenIndex(null!=e?e:0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;let t=this.hot.columnIndexMapper,e=t.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return t.getNearestNotHiddenIndex(null!=e?e:this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return ip(iv,this)}getRowHeadersCount(){return ip(iy,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(t){var e;return(null!==(e=this._wt.wtOverlays.getParentOverlay(t))&&void 0!==e?e:this._wt).wtTable.name}getOverlayByName(t){return this._wt.getOverlayByName(t)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function ik(){return parseInt(this.hot.rootElement.getAttribute((0,Y.Nb)()[0]),10)}function iO(t){let e=iw(ix,this,ik).call(this)+t;(0,r.setAttribute)(this.hot.rootElement,...(0,Y.Nb)(e))}function iI(){let t=this.hot.rootElement;this.hasVerticalScroll()?(0,r.addClass)(t,"htHasScrollY"):(0,r.removeClass)(t,"htHasScrollY"),this.hasHorizontalScroll()?(0,r.addClass)(t,"htHasScrollX"):(0,r.removeClass)(t,"htHasScrollX")}let iA=iM},3898:(t,e,i)=>{"use strict";i.d(e,{r:()=>o});var r=i(61183),n=i(6711);function o(t,e,i){let[o,s]=(0,r.x)(null==i?void 0:i.in,t,e);return+(0,n.o)(o)==+(0,n.o)(s)}},4083:(t,e,i)=>{"use strict";var r=i(42620),n=i(56963),o=r.RegExp;t.exports={correct:!n(function(){var t=!0;try{o(".","d")}catch(e){t=!1}var e={},i="",r=t?"dgimsy":"gimsy",n=function(t,r){Object.defineProperty(e,t,{get:function(){return i+=r,!0}})},s={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};for(var l in t&&(s.hasIndices="d"),s)n(l,s[l]);return Object.getOwnPropertyDescriptor(o.prototype,"flags").get.call(e)!==r||i!==r})}},4230:(t,e,i)=>{"use strict";var r=i(67297),n=i(99365),o=i(76494),s=TypeError;t.exports=function(t,e){var i,l;if("string"===e&&n(i=t.toString)&&!o(l=r(i,t))||n(i=t.valueOf)&&!o(l=r(i,t))||"string"!==e&&n(i=t.toString)&&!o(l=r(i,t)))return l;throw new s("Can't convert object to primitive value")}},4389:t=>{"use strict";t.exports={}},5383:t=>{"use strict";var e=Math.ceil,i=Math.floor;t.exports=Math.trunc||function(t){var r=+t;return(r>0?i:e)(r)}},6213:(t,e,i)=>{"use strict";var r=i(8883);t.exports=function(){var t=r(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e}},6497:(t,e,i)=>{"use strict";var r=i(67297);t.exports=function(t,e,i){for(var n,o,s=i?t:t.iterator,l=t.next;!(n=r(l,s)).done;)if(void 0!==(o=e(n.value)))return o}},6711:(t,e,i)=>{"use strict";i.d(e,{o:()=>n});var r=i(89447);function n(t,e){let i=(0,r.a)(t,null==e?void 0:e.in);return i.setHours(0,0,0,0),i}},7038:(t,e,i)=>{"use strict";i.d(e,{F:()=>n});var r=i(89447);function n(t,e){return Math.trunc((0,r.a)(t,null==e?void 0:e.in).getMonth()/3)+1}},7107:(t,e,i)=>{"use strict";var r=i(42620),n=i(87699),o=i(95467),s=i(39584),l=i(11609),a=i(2048),h=r.Symbol,u=n("wks"),c=a?h.for||h:h&&h.withoutSetter||s;t.exports=function(t){return o(u,t)||(u[t]=l&&o(h,t)?h[t]:c("Symbol."+t)),u[t]}},7239:(t,e,i)=>{"use strict";i.d(e,{w:()=>n});var r=i(25703);function n(t,e){return"function"==typeof t?t(e):t&&"object"==typeof t&&r._P in t?t[r._P](e):t instanceof Date?new t.constructor(e):new Date(e)}},7346:(t,e,i)=>{"use strict";i.d(e,{B:()=>r,b:()=>n});let r="gridDefault",n="editorManager.handlingEditor"},7411:(t,e,i)=>{"use strict";t.exports=i(93840)({}.isPrototypeOf)},7475:t=>{"use strict";t.exports=function(t){return{iterator:t,next:t.next,done:!1}}},7537:(t,e)=>{"use strict";var i={}.propertyIsEnumerable,r=Object.getOwnPropertyDescriptor;e.f=r&&!i.call({1:2},1)?function(t){var e=r(this,t);return!!e&&e.enumerable}:i},7687:(t,e,i)=>{"use strict";var r=i(42620),n=Object.defineProperty;t.exports=function(t,e){try{n(r,t,{value:e,configurable:!0,writable:!0})}catch(i){r[t]=e}return e}},7729:(t,e,i)=>{"use strict";i.d(e,{b6:()=>b,ZS:()=>E,tN:()=>S,mk:()=>R});var r=function(){};r.prototype.append=function(t){return t.length?(t=r.from(t),!this.length&&t||t.length<200&&this.leafAppend(t)||this.length<200&&t.leafPrepend(this)||this.appendInner(t)):this},r.prototype.prepend=function(t){return t.length?r.from(t).append(this):this},r.prototype.appendInner=function(t){return new o(this,t)},r.prototype.slice=function(t,e){return(void 0===t&&(t=0),void 0===e&&(e=this.length),t>=e)?r.empty:this.sliceInner(Math.max(0,t),Math.min(this.length,e))},r.prototype.get=function(t){if(!(t<0)&&!(t>=this.length))return this.getInner(t)},r.prototype.forEach=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=this.length),e<=i?this.forEachInner(t,e,i,0):this.forEachInvertedInner(t,e,i,0)},r.prototype.map=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=this.length);var r=[];return this.forEach(function(e,i){return r.push(t(e,i))},e,i),r},r.from=function(t){return t instanceof r?t:t&&t.length?new n(t):r.empty};var n=function(t){function e(e){t.call(this),this.values=e}t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e;var i={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(t,i){return 0==t&&i==this.length?this:new e(this.values.slice(t,i))},e.prototype.getInner=function(t){return this.values[t]},e.prototype.forEachInner=function(t,e,i,r){for(var n=e;n<i;n++)if(!1===t(this.values[n],r+n))return!1},e.prototype.forEachInvertedInner=function(t,e,i,r){for(var n=e-1;n>=i;n--)if(!1===t(this.values[n],r+n))return!1},e.prototype.leafAppend=function(t){if(this.length+t.length<=200)return new e(this.values.concat(t.flatten()))},e.prototype.leafPrepend=function(t){if(this.length+t.length<=200)return new e(t.flatten().concat(this.values))},i.length.get=function(){return this.values.length},i.depth.get=function(){return 0},Object.defineProperties(e.prototype,i),e}(r);r.empty=new n([]);var o=function(t){function e(e,i){t.call(this),this.left=e,this.right=i,this.length=e.length+i.length,this.depth=Math.max(e.depth,i.depth)+1}return t&&(e.__proto__=t),e.prototype=Object.create(t&&t.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(t){return t<this.left.length?this.left.get(t):this.right.get(t-this.left.length)},e.prototype.forEachInner=function(t,e,i,r){var n=this.left.length;if(e<n&&!1===this.left.forEachInner(t,e,Math.min(i,n),r)||i>n&&!1===this.right.forEachInner(t,Math.max(e-n,0),Math.min(this.length,i)-n,r+n))return!1},e.prototype.forEachInvertedInner=function(t,e,i,r){var n=this.left.length;if(e>n&&!1===this.right.forEachInvertedInner(t,e-n,Math.max(i,n)-n,r+n)||i<n&&!1===this.left.forEachInvertedInner(t,Math.min(e,n),i,r))return!1},e.prototype.sliceInner=function(t,e){if(0==t&&e==this.length)return this;var i=this.left.length;return e<=i?this.left.slice(t,e):t>=i?this.right.slice(t-i,e-i):this.left.slice(t,i).append(this.right.slice(0,e-i))},e.prototype.leafAppend=function(t){var i=this.right.leafAppend(t);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(t){var i=this.left.leafPrepend(t);if(i)return new e(i,this.right)},e.prototype.appendInner=function(t){return this.left.depth>=Math.max(this.right.depth,t.depth)+1?new e(this.left,new e(this.right,t)):new e(this,t)},e}(r),s=i(808),l=i(52571);class a{constructor(t,e){this.items=t,this.eventCount=e}popEvent(t,e){let i,r,n,o;if(0==this.eventCount)return null;let s=this.items.length;for(;;s--)if(this.items.get(s-1).selection){--s;break}e&&(r=(i=this.remapping(s,this.items.length)).maps.length);let l=t.tr,u=[],c=[];return this.items.forEach((t,e)=>{if(!t.step){i||(r=(i=this.remapping(s,e+1)).maps.length),r--,c.push(t);return}if(i){c.push(new h(t.map));let e=t.step.map(i.slice(r)),n;e&&l.maybeStep(e).doc&&(n=l.mapping.maps[l.mapping.maps.length-1],u.push(new h(n,void 0,void 0,u.length+c.length))),r--,n&&i.appendMap(n,r)}else l.maybeStep(t.step);if(t.selection)return n=i?t.selection.map(i.slice(r)):t.selection,o=new a(this.items.slice(0,s).append(c.reverse().concat(u)),this.eventCount-1),!1},this.items.length,0),{remaining:o,transform:l,selection:n}}addTransform(t,e,i,r){var n,o;let s,l=[],u=this.eventCount,d=this.items,g=!r&&d.length?d.get(d.length-1):null;for(let i=0;i<t.steps.length;i++){let n=t.steps[i].invert(t.docs[i]),o=new h(t.mapping.maps[i],n,e),s;(s=g&&g.merge(o))&&(o=s,i?l.pop():d=d.slice(0,d.length-1)),l.push(o),e&&(u++,e=void 0),r||(g=o)}let f=u-i.depth;return f>c&&(n=d,o=f,n.forEach((t,e)=>{if(t.selection&&0==o--)return s=e,!1}),d=n.slice(s),u-=f),new a(d.append(l),u)}remapping(t,e){let i=new s.X9;return this.items.forEach((e,r)=>{let n=null!=e.mirrorOffset&&r-e.mirrorOffset>=t?i.maps.length-e.mirrorOffset:void 0;i.appendMap(e.map,n)},t,e),i}addMaps(t){return 0==this.eventCount?this:new a(this.items.append(t.map(t=>new h(t))),this.eventCount)}rebased(t,e){if(!this.eventCount)return this;let i=[],r=Math.max(0,this.items.length-e),n=t.mapping,o=t.steps.length,s=this.eventCount;this.items.forEach(t=>{t.selection&&s--},r);let l=e;this.items.forEach(e=>{let r=n.getMirror(--l);if(null==r)return;o=Math.min(o,r);let a=n.maps[r];if(e.step){let o=t.steps[r].invert(t.docs[r]),u=e.selection&&e.selection.map(n.slice(l+1,r));u&&s++,i.push(new h(a,o,u))}else i.push(new h(a))},r);let u=[];for(let t=e;t<o;t++)u.push(new h(n.maps[t]));let c=new a(this.items.slice(0,r).append(u).append(i),s);return c.emptyItemCount()>500&&(c=c.compress(this.items.length-i.length)),c}emptyItemCount(){let t=0;return this.items.forEach(e=>{!e.step&&t++}),t}compress(t=this.items.length){let e=this.remapping(0,t),i=e.maps.length,n=[],o=0;return this.items.forEach((r,s)=>{if(s>=t)n.push(r),r.selection&&o++;else if(r.step){let t=r.step.map(e.slice(i)),s=t&&t.getMap();if(i--,s&&e.appendMap(s,i),t){let l=r.selection&&r.selection.map(e.slice(i));l&&o++;let a=new h(s.invert(),t,l),u,c=n.length-1;(u=n.length&&n[c].merge(a))?n[c]=u:n.push(a)}}else r.map&&i--},this.items.length,0),new a(r.from(n.reverse()),o)}}a.empty=new a(r.empty,0);class h{constructor(t,e,i,r){this.map=t,this.step=e,this.selection=i,this.mirrorOffset=r}merge(t){if(this.step&&t.step&&!t.selection){let e=t.step.merge(this.step);if(e)return new h(e.getMap().invert(),e,this.selection)}}}class u{constructor(t,e,i,r,n){this.done=t,this.undone=e,this.prevRanges=i,this.prevTime=r,this.prevComposition=n}}let c=20;function d(t){let e=[];for(let i=t.length-1;i>=0&&0==e.length;i--)t[i].forEach((t,i,r,n)=>e.push(r,n));return e}function g(t,e){if(!t)return null;let i=[];for(let r=0;r<t.length;r+=2){let n=e.map(t[r],1),o=e.map(t[r+1],-1);n<=o&&i.push(n,o)}return i}let f=!1,p=null;function m(t){let e=t.plugins;if(p!=e){f=!1,p=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){f=!0;break}}return f}let w=new l.hs("history"),y=new l.hs("closeHistory");function b(t={}){return t={depth:t.depth||100,newGroupDelay:t.newGroupDelay||500},new l.k_({key:w,state:{init:()=>new u(a.empty,a.empty,null,0,-1),apply:(e,i,r)=>(function(t,e,i,r){let n=i.getMeta(w),o;if(n)return n.historyState;i.getMeta(y)&&(t=new u(t.done,t.undone,null,0,-1));let s=i.getMeta("appendedTransaction");if(0==i.steps.length)return t;if(s&&s.getMeta(w))if(s.getMeta(w).redo)return new u(t.done.addTransform(i,void 0,r,m(e)),t.undone,d(i.mapping.maps),t.prevTime,t.prevComposition);else return new u(t.done,t.undone.addTransform(i,void 0,r,m(e)),null,t.prevTime,t.prevComposition);if(!1===i.getMeta("addToHistory")||s&&!1===s.getMeta("addToHistory"))if(o=i.getMeta("rebased"))return new u(t.done.rebased(i,o),t.undone.rebased(i,o),g(t.prevRanges,i.mapping),t.prevTime,t.prevComposition);else return new u(t.done.addMaps(i.mapping.maps),t.undone.addMaps(i.mapping.maps),g(t.prevRanges,i.mapping),t.prevTime,t.prevComposition);{let n=i.getMeta("composition"),o=0==t.prevTime||!s&&t.prevComposition!=n&&(t.prevTime<(i.time||0)-r.newGroupDelay||!function(t,e){if(!e)return!1;if(!t.docChanged)return!0;let i=!1;return t.mapping.maps[0].forEach((t,r)=>{for(let n=0;n<e.length;n+=2)t<=e[n+1]&&r>=e[n]&&(i=!0)}),i}(i,t.prevRanges)),l=s?g(t.prevRanges,i.mapping):d(i.mapping.maps);return new u(t.done.addTransform(i,o?e.selection.getBookmark():void 0,r,m(e)),a.empty,l,i.time,null==n?t.prevComposition:n)}})(i,r,e,t)},config:t,props:{handleDOMEvents:{beforeinput(t,e){let i=e.inputType,r="historyUndo"==i?S:"historyRedo"==i?E:null;return!!r&&(e.preventDefault(),r(t.state,t.dispatch))}}}})}function C(t,e){return(i,r)=>{let n=w.getState(i);if(!n||0==(t?n.undone:n.done).eventCount)return!1;if(r){let o=function(t,e,i){let r=m(e),n=w.get(e).spec.config,o=(i?t.undone:t.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),l=(i?t.done:t.undone).addTransform(o.transform,e.selection.getBookmark(),n,r),a=new u(i?l:o.remaining,i?o.remaining:l,null,0,-1);return o.transform.setSelection(s).setMeta(w,{redo:i,historyState:a})}(n,i,t);o&&r(e?o.scrollIntoView():o)}return!0}}let S=C(!1,!0),E=C(!0,!0);function R(t){let e=w.getState(t);return e?e.done.eventCount:0}C(!1,!1),C(!0,!1)},8093:(t,e,i)=>{"use strict";i.d(e,{c:()=>h});let r={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function n(t){return function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=e.width?String(e.width):t.defaultWidth;return t.formats[i]||t.formats[t.defaultWidth]}}let o={date:n({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:n({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:n({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},s={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function l(t){return(e,i)=>{let r;if("formatting"===((null==i?void 0:i.context)?String(i.context):"standalone")&&t.formattingValues){let e=t.defaultFormattingWidth||t.defaultWidth,n=(null==i?void 0:i.width)?String(i.width):e;r=t.formattingValues[n]||t.formattingValues[e]}else{let e=t.defaultWidth,n=(null==i?void 0:i.width)?String(i.width):t.defaultWidth;r=t.values[n]||t.values[e]}return r[t.argumentCallback?t.argumentCallback(e):e]}}function a(t){return function(e){let i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.width,o=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],s=e.match(o);if(!s)return null;let l=s[0],a=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],h=Array.isArray(a)?function(t,e){for(let i=0;i<t.length;i++)if(e(t[i]))return i}(a,t=>t.test(l)):function(t,e){for(let i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e(t[i]))return i}(a,t=>t.test(l));return i=t.valueCallback?t.valueCallback(h):h,{value:i=r.valueCallback?r.valueCallback(i):i,rest:e.slice(l.length)}}}let h={code:"en-US",formatDistance:(t,e,i)=>{let n,o=r[t];if(n="string"==typeof o?o:1===e?o.one:o.other.replace("{{count}}",e.toString()),null==i?void 0:i.addSuffix)if(i.comparison&&i.comparison>0)return"in "+n;else return n+" ago";return n},formatLong:o,formatRelative:(t,e,i,r)=>s[t],localize:{ordinalNumber:(t,e)=>{let i=Number(t),r=i%100;if(r>20||r<10)switch(r%10){case 1:return i+"st";case 2:return i+"nd";case 3:return i+"rd"}return i+"th"},era:l({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:l({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:t=>t-1}),month:l({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:l({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:l({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:function(t){return function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.match(t.matchPattern);if(!r)return null;let n=r[0],o=e.match(t.parsePattern);if(!o)return null;let s=t.valueCallback?t.valueCallback(o[0]):o[0];return{value:s=i.valueCallback?i.valueCallback(s):s,rest:e.slice(n.length)}}}({matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:t=>parseInt(t,10)}),era:a({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:a({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:t=>t+1}),month:a({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:a({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:a({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}}},8496:(t,e,i)=>{"use strict";var r=i(93840),n=i(50320);t.exports=function(t,e,i){try{return r(n(Object.getOwnPropertyDescriptor(t,e)[i]))}catch(t){}}},8883:(t,e,i)=>{"use strict";var r=i(76494),n=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(n(t)+" is not an object")}},9107:(t,e,i)=>{"use strict";i.d(e,{e:()=>n});var r=i(40714);function n(t,e,i){return(0,r.f)(t,-e,i)}},9234:(t,e,i)=>{"use strict";var r=i(14412),n=i(56963);t.exports=r&&n(function(){return 42!==Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype})},9329:(t,e,i)=>{"use strict";var r=i(82309),n=i(93840),o=i(97156),s=i(22229),l=i(8883),a=n([].concat);t.exports=r("Reflect","ownKeys")||function(t){var e=o.f(l(t)),i=s.f;return i?a(e,i(t)):e}},10027:(t,e,i)=>{"use strict";var r=i(7107),n=i(54733),o=r("iterator"),s=Array.prototype;t.exports=function(t){return void 0!==t&&(n.Array===t||s[o]===t)}},10156:(t,e,i)=>{"use strict";function r(t){this.content=t}i.d(e,{S4:()=>B,ZF:()=>K,FK:()=>n,CU:()=>a,sX:()=>F,bP:()=>R,u$:()=>S,vI:()=>h,Sj:()=>V,Ji:()=>u}),r.prototype={constructor:r,find:function(t){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===t)return e;return -1},get:function(t){var e=this.find(t);return -1==e?void 0:this.content[e+1]},update:function(t,e,i){var n=i&&i!=t?this.remove(i):this,o=n.find(t),s=n.content.slice();return -1==o?s.push(i||t,e):(s[o+1]=e,i&&(s[o]=i)),new r(s)},remove:function(t){var e=this.find(t);if(-1==e)return this;var i=this.content.slice();return i.splice(e,2),new r(i)},addToStart:function(t,e){return new r([t,e].concat(this.remove(t).content))},addToEnd:function(t,e){var i=this.remove(t).content.slice();return i.push(t,e),new r(i)},addBefore:function(t,e,i){var n=this.remove(e),o=n.content.slice(),s=n.find(t);return o.splice(-1==s?o.length:s,0,e,i),new r(o)},forEach:function(t){for(var e=0;e<this.content.length;e+=2)t(this.content[e],this.content[e+1])},prepend:function(t){return(t=r.from(t)).size?new r(t.content.concat(this.subtract(t).content)):this},append:function(t){return(t=r.from(t)).size?new r(this.subtract(t).content.concat(t.content)):this},subtract:function(t){var e=this;t=r.from(t);for(var i=0;i<t.content.length;i+=2)e=e.remove(t.content[i]);return e},toObject:function(){var t={};return this.forEach(function(e,i){t[e]=i}),t},get size(){return this.content.length>>1}},r.from=function(t){if(t instanceof r)return t;var e=[];if(t)for(var i in t)e.push(i,t[i]);return new r(e)};class n{constructor(t,e){if(this.content=t,this.size=e||0,null==e)for(let e=0;e<t.length;e++)this.size+=t[e].nodeSize}nodesBetween(t,e,i,r=0,n){for(let o=0,s=0;s<e;o++){let l=this.content[o],a=s+l.nodeSize;if(a>t&&!1!==i(l,r+s,n||null,o)&&l.content.size){let n=s+1;l.nodesBetween(Math.max(0,t-n),Math.min(l.content.size,e-n),i,r+n)}s=a}}descendants(t){this.nodesBetween(0,this.size,t)}textBetween(t,e,i,r){let n="",o=!0;return this.nodesBetween(t,e,(s,l)=>{let a=s.isText?s.text.slice(Math.max(t,l)-l,e-l):s.isLeaf?r?"function"==typeof r?r(s):r:s.type.spec.leafText?s.type.spec.leafText(s):"":"";s.isBlock&&(s.isLeaf&&a||s.isTextblock)&&i&&(o?o=!1:n+=i),n+=a},0),n}append(t){if(!t.size)return this;if(!this.size)return t;let e=this.lastChild,i=t.firstChild,r=this.content.slice(),o=0;for(e.isText&&e.sameMarkup(i)&&(r[r.length-1]=e.withText(e.text+i.text),o=1);o<t.content.length;o++)r.push(t.content[o]);return new n(r,this.size+t.size)}cut(t,e=this.size){if(0==t&&e==this.size)return this;let i=[],r=0;if(e>t)for(let n=0,o=0;o<e;n++){let s=this.content[n],l=o+s.nodeSize;l>t&&((o<t||l>e)&&(s=s.isText?s.cut(Math.max(0,t-o),Math.min(s.text.length,e-o)):s.cut(Math.max(0,t-o-1),Math.min(s.content.size,e-o-1))),i.push(s),r+=s.nodeSize),o=l}return new n(i,r)}cutByIndex(t,e){return t==e?n.empty:0==t&&e==this.content.length?this:new n(this.content.slice(t,e))}replaceChild(t,e){let i=this.content[t];if(i==e)return this;let r=this.content.slice(),o=this.size+e.nodeSize-i.nodeSize;return r[t]=e,new n(r,o)}addToStart(t){return new n([t].concat(this.content),this.size+t.nodeSize)}addToEnd(t){return new n(this.content.concat(t),this.size+t.nodeSize)}eq(t){if(this.content.length!=t.content.length)return!1;for(let e=0;e<this.content.length;e++)if(!this.content[e].eq(t.content[e]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(t){let e=this.content[t];if(!e)throw RangeError("Index "+t+" out of range for "+this);return e}maybeChild(t){return this.content[t]||null}forEach(t){for(let e=0,i=0;e<this.content.length;e++){let r=this.content[e];t(r,i,e),i+=r.nodeSize}}findDiffStart(t,e=0){return function t(e,i,r){for(let n=0;;n++){if(n==e.childCount||n==i.childCount)return e.childCount==i.childCount?null:r;let o=e.child(n),s=i.child(n);if(o==s){r+=o.nodeSize;continue}if(!o.sameMarkup(s))return r;if(o.isText&&o.text!=s.text){for(let t=0;o.text[t]==s.text[t];t++)r++;return r}if(o.content.size||s.content.size){let e=t(o.content,s.content,r+1);if(null!=e)return e}r+=o.nodeSize}}(this,t,e)}findDiffEnd(t,e=this.size,i=t.size){return function t(e,i,r,n){for(let o=e.childCount,s=i.childCount;;){if(0==o||0==s)return o==s?null:{a:r,b:n};let l=e.child(--o),a=i.child(--s),h=l.nodeSize;if(l==a){r-=h,n-=h;continue}if(!l.sameMarkup(a))return{a:r,b:n};if(l.isText&&l.text!=a.text){let t=0,e=Math.min(l.text.length,a.text.length);for(;t<e&&l.text[l.text.length-t-1]==a.text[a.text.length-t-1];)t++,r--,n--;return{a:r,b:n}}if(l.content.size||a.content.size){let e=t(l.content,a.content,r-1,n-1);if(e)return e}r-=h,n-=h}}(this,t,e,i)}findIndex(t,e=-1){if(0==t)return s(0,t);if(t==this.size)return s(this.content.length,t);if(t>this.size||t<0)throw RangeError(`Position ${t} outside of fragment (${this})`);for(let i=0,r=0;;i++){let n=r+this.child(i).nodeSize;if(n>=t){if(n==t||e>0)return s(i+1,n);return s(i,r)}r=n}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(t=>t.toJSON()):null}static fromJSON(t,e){if(!e)return n.empty;if(!Array.isArray(e))throw RangeError("Invalid input for Fragment.fromJSON");return new n(e.map(t.nodeFromJSON))}static fromArray(t){if(!t.length)return n.empty;let e,i=0;for(let r=0;r<t.length;r++){let n=t[r];i+=n.nodeSize,r&&n.isText&&t[r-1].sameMarkup(n)?(e||(e=t.slice(0,r)),e[e.length-1]=n.withText(e[e.length-1].text+n.text)):e&&e.push(n)}return new n(e||t,i)}static from(t){if(!t)return n.empty;if(t instanceof n)return t;if(Array.isArray(t))return this.fromArray(t);if(t.attrs)return new n([t],t.nodeSize);throw RangeError("Can not convert "+t+" to a Fragment"+(t.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}n.empty=new n([],0);let o={index:0,offset:0};function s(t,e){return o.index=t,o.offset=e,o}function l(t,e){if(t===e)return!0;if(!(t&&"object"==typeof t)||!(e&&"object"==typeof e))return!1;let i=Array.isArray(t);if(Array.isArray(e)!=i)return!1;if(i){if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!l(t[i],e[i]))return!1}else{for(let i in t)if(!(i in e)||!l(t[i],e[i]))return!1;for(let i in e)if(!(i in t))return!1}return!0}class a{constructor(t,e){this.type=t,this.attrs=e}addToSet(t){let e,i=!1;for(let r=0;r<t.length;r++){let n=t[r];if(this.eq(n))return t;if(this.type.excludes(n.type))e||(e=t.slice(0,r));else{if(n.type.excludes(this.type))return t;!i&&n.type.rank>this.type.rank&&(e||(e=t.slice(0,r)),e.push(this),i=!0),e&&e.push(n)}}return e||(e=t.slice()),i||e.push(this),e}removeFromSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return t.slice(0,e).concat(t.slice(e+1));return t}isInSet(t){for(let e=0;e<t.length;e++)if(this.eq(t[e]))return!0;return!1}eq(t){return this==t||this.type==t.type&&l(this.attrs,t.attrs)}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return t}static fromJSON(t,e){if(!e)throw RangeError("Invalid input for Mark.fromJSON");let i=t.marks[e.type];if(!i)throw RangeError(`There is no mark type ${e.type} in this schema`);let r=i.create(e.attrs);return i.checkAttrs(r.attrs),r}static sameSet(t,e){if(t==e)return!0;if(t.length!=e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].eq(e[i]))return!1;return!0}static setFrom(t){if(!t||Array.isArray(t)&&0==t.length)return a.none;if(t instanceof a)return[t];let e=t.slice();return e.sort((t,e)=>t.type.rank-e.type.rank),e}}a.none=[];class h extends Error{}class u{constructor(t,e,i){this.content=t,this.openStart=e,this.openEnd=i}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(t,e){let i=function t(e,i,r,n){let{index:o,offset:s}=e.findIndex(i),l=e.maybeChild(o);if(s==i||l.isText)return n&&!n.canReplace(o,o,r)?null:e.cut(0,i).append(r).append(e.cut(i));let a=t(l.content,i-s-1,r);return a&&e.replaceChild(o,l.copy(a))}(this.content,t+this.openStart,e);return i&&new u(i,this.openStart,this.openEnd)}removeBetween(t,e){return new u(function t(e,i,r){let{index:n,offset:o}=e.findIndex(i),s=e.maybeChild(n),{index:l,offset:a}=e.findIndex(r);if(o==i||s.isText){if(a!=r&&!e.child(l).isText)throw RangeError("Removing non-flat range");return e.cut(0,i).append(e.cut(r))}if(n!=l)throw RangeError("Removing non-flat range");return e.replaceChild(n,s.copy(t(s.content,i-o-1,r-o-1)))}(this.content,t+this.openStart,e+this.openStart),this.openStart,this.openEnd)}eq(t){return this.content.eq(t.content)&&this.openStart==t.openStart&&this.openEnd==t.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let t={content:this.content.toJSON()};return this.openStart>0&&(t.openStart=this.openStart),this.openEnd>0&&(t.openEnd=this.openEnd),t}static fromJSON(t,e){if(!e)return u.empty;let i=e.openStart||0,r=e.openEnd||0;if("number"!=typeof i||"number"!=typeof r)throw RangeError("Invalid input for Slice.fromJSON");return new u(n.fromJSON(t,e.content),i,r)}static maxOpen(t,e=!0){let i=0,r=0;for(let r=t.firstChild;r&&!r.isLeaf&&(e||!r.type.spec.isolating);r=r.firstChild)i++;for(let i=t.lastChild;i&&!i.isLeaf&&(e||!i.type.spec.isolating);i=i.lastChild)r++;return new u(t,i,r)}}function c(t,e){if(!e.type.compatibleContent(t.type))throw new h("Cannot join "+e.type.name+" onto "+t.type.name)}function d(t,e,i){let r=t.node(i);return c(r,e.node(i)),r}function g(t,e){let i=e.length-1;i>=0&&t.isText&&t.sameMarkup(e[i])?e[i]=t.withText(e[i].text+t.text):e.push(t)}function f(t,e,i,r){let n=(e||t).node(i),o=0,s=e?e.index(i):n.childCount;t&&(o=t.index(i),t.depth>i?o++:t.textOffset&&(g(t.nodeAfter,r),o++));for(let t=o;t<s;t++)g(n.child(t),r);e&&e.depth==i&&e.textOffset&&g(e.nodeBefore,r)}function p(t,e){return t.type.checkContent(e),t.copy(e)}function m(t,e,i){let r=[];return f(null,t,i,r),t.depth>i&&g(p(d(t,e,i+1),m(t,e,i+1)),r),f(e,null,i,r),new n(r)}u.empty=new u(n.empty,0,0);class w{constructor(t,e,i){this.pos=t,this.path=e,this.parentOffset=i,this.depth=e.length/3-1}resolveDepth(t){return null==t?this.depth:t<0?this.depth+t:t}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(t){return this.path[3*this.resolveDepth(t)]}index(t){return this.path[3*this.resolveDepth(t)+1]}indexAfter(t){return t=this.resolveDepth(t),this.index(t)+(t!=this.depth||this.textOffset?1:0)}start(t){return 0==(t=this.resolveDepth(t))?0:this.path[3*t-1]+1}end(t){return t=this.resolveDepth(t),this.start(t)+this.node(t).content.size}before(t){if(!(t=this.resolveDepth(t)))throw RangeError("There is no position before the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]}after(t){if(!(t=this.resolveDepth(t)))throw RangeError("There is no position after the top-level node");return t==this.depth+1?this.pos:this.path[3*t-1]+this.path[3*t].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let t=this.parent,e=this.index(this.depth);if(e==t.childCount)return null;let i=this.pos-this.path[this.path.length-1],r=t.child(e);return i?t.child(e).cut(i):r}get nodeBefore(){let t=this.index(this.depth),e=this.pos-this.path[this.path.length-1];return e?this.parent.child(t).cut(0,e):0==t?null:this.parent.child(t-1)}posAtIndex(t,e){e=this.resolveDepth(e);let i=this.path[3*e],r=0==e?0:this.path[3*e-1]+1;for(let e=0;e<t;e++)r+=i.child(e).nodeSize;return r}marks(){let t=this.parent,e=this.index();if(0==t.content.size)return a.none;if(this.textOffset)return t.child(e).marks;let i=t.maybeChild(e-1),r=t.maybeChild(e);if(!i){let t=i;i=r,r=t}let n=i.marks;for(var o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n}marksAcross(t){let e=this.parent.maybeChild(this.index());if(!e||!e.isInline)return null;let i=e.marks,r=t.parent.maybeChild(t.index());for(var n=0;n<i.length;n++)!1!==i[n].type.spec.inclusive||r&&i[n].isInSet(r.marks)||(i=i[n--].removeFromSet(i));return i}sharedDepth(t){for(let e=this.depth;e>0;e--)if(this.start(e)<=t&&this.end(e)>=t)return e;return 0}blockRange(t=this,e){if(t.pos<this.pos)return t.blockRange(this);for(let i=this.depth-(this.parent.inlineContent||this.pos==t.pos?1:0);i>=0;i--)if(t.pos<=this.end(i)&&(!e||e(this.node(i))))return new S(this,t,i);return null}sameParent(t){return this.pos-this.parentOffset==t.pos-t.parentOffset}max(t){return t.pos>this.pos?t:this}min(t){return t.pos<this.pos?t:this}toString(){let t="";for(let e=1;e<=this.depth;e++)t+=(t?"/":"")+this.node(e).type.name+"_"+this.index(e-1);return t+":"+this.parentOffset}static resolve(t,e){if(!(e>=0&&e<=t.content.size))throw RangeError("Position "+e+" out of range");let i=[],r=0,n=e;for(let e=t;;){let{index:t,offset:o}=e.content.findIndex(n),s=n-o;if(i.push(e,t,r+o),!s||(e=e.child(t)).isText)break;n=s-1,r+=o+1}return new w(e,i,n)}static resolveCached(t,e){let i=C.get(t);if(i)for(let t=0;t<i.elts.length;t++){let r=i.elts[t];if(r.pos==e)return r}else C.set(t,i=new y);let r=i.elts[i.i]=w.resolve(t,e);return i.i=(i.i+1)%b,r}}class y{constructor(){this.elts=[],this.i=0}}let b=12,C=new WeakMap;class S{constructor(t,e,i){this.$from=t,this.$to=e,this.depth=i}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}let E=Object.create(null);class R{constructor(t,e,i,r=a.none){this.type=t,this.attrs=e,this.marks=r,this.content=i||n.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(t){return this.content.child(t)}maybeChild(t){return this.content.maybeChild(t)}forEach(t){this.content.forEach(t)}nodesBetween(t,e,i,r=0){this.content.nodesBetween(t,e,i,r,this)}descendants(t){this.nodesBetween(0,this.content.size,t)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(t,e,i,r){return this.content.textBetween(t,e,i,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(t){return this==t||this.sameMarkup(t)&&this.content.eq(t.content)}sameMarkup(t){return this.hasMarkup(t.type,t.attrs,t.marks)}hasMarkup(t,e,i){return this.type==t&&l(this.attrs,e||t.defaultAttrs||E)&&a.sameSet(this.marks,i||a.none)}copy(t=null){return t==this.content?this:new R(this.type,this.attrs,t,this.marks)}mark(t){return t==this.marks?this:new R(this.type,this.attrs,this.content,t)}cut(t,e=this.content.size){return 0==t&&e==this.content.size?this:this.copy(this.content.cut(t,e))}slice(t,e=this.content.size,i=!1){if(t==e)return u.empty;let r=this.resolve(t),n=this.resolve(e),o=i?0:r.sharedDepth(e),s=r.start(o);return new u(r.node(o).content.cut(r.pos-s,n.pos-s),r.depth-o,n.depth-o)}replace(t,e,i){var r=this.resolve(t),o=this.resolve(e);if(i.openStart>r.depth)throw new h("Inserted content deeper than insertion position");if(r.depth-i.openStart!=o.depth-i.openEnd)throw new h("Inconsistent open depths");return function t(e,i,r,o){let s=e.index(o),l=e.node(o);if(s==i.index(o)&&o<e.depth-r.openStart){let n=t(e,i,r,o+1);return l.copy(l.content.replaceChild(s,n))}if(!r.content.size)return p(l,m(e,i,o));if(r.openStart||r.openEnd||e.depth!=o||i.depth!=o){let{start:t,end:s}=function(t,e){let i=e.depth-t.openStart,r=e.node(i).copy(t.content);for(let t=i-1;t>=0;t--)r=e.node(t).copy(n.from(r));return{start:r.resolveNoCache(t.openStart+i),end:r.resolveNoCache(r.content.size-t.openEnd-i)}}(r,e);return p(l,function t(e,i,r,o,s){let l=e.depth>s&&d(e,i,s+1),a=o.depth>s&&d(r,o,s+1),h=[];return f(null,e,s,h),l&&a&&i.index(s)==r.index(s)?(c(l,a),g(p(l,t(e,i,r,o,s+1)),h)):(l&&g(p(l,m(e,i,s+1)),h),f(i,r,s,h),a&&g(p(a,m(r,o,s+1)),h)),f(o,null,s,h),new n(h)}(e,t,s,i,o))}{let t=e.parent,n=t.content;return p(t,n.cut(0,e.parentOffset).append(r.content).append(n.cut(i.parentOffset)))}}(r,o,i,0)}nodeAt(t){for(let e=this;;){let{index:i,offset:r}=e.content.findIndex(t);if(!(e=e.maybeChild(i)))return null;if(r==t||e.isText)return e;t-=r+1}}childAfter(t){let{index:e,offset:i}=this.content.findIndex(t);return{node:this.content.maybeChild(e),index:e,offset:i}}childBefore(t){if(0==t)return{node:null,index:0,offset:0};let{index:e,offset:i}=this.content.findIndex(t);if(i<t)return{node:this.content.child(e),index:e,offset:i};let r=this.content.child(e-1);return{node:r,index:e-1,offset:i-r.nodeSize}}resolve(t){return w.resolveCached(this,t)}resolveNoCache(t){return w.resolve(this,t)}rangeHasMark(t,e,i){let r=!1;return e>t&&this.nodesBetween(t,e,t=>(i.isInSet(t.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let t=this.type.name;return this.content.size&&(t+="("+this.content.toStringInner()+")"),x(this.marks,t)}contentMatchAt(t){let e=this.type.contentMatch.matchFragment(this.content,0,t);if(!e)throw Error("Called contentMatchAt on a node with invalid content");return e}canReplace(t,e,i=n.empty,r=0,o=i.childCount){let s=this.contentMatchAt(t).matchFragment(i,r,o),l=s&&s.matchFragment(this.content,e);if(!l||!l.validEnd)return!1;for(let t=r;t<o;t++)if(!this.type.allowsMarks(i.child(t).marks))return!1;return!0}canReplaceWith(t,e,i,r){if(r&&!this.type.allowsMarks(r))return!1;let n=this.contentMatchAt(t).matchType(i),o=n&&n.matchFragment(this.content,e);return!!o&&o.validEnd}canAppend(t){return t.content.size?this.canReplace(this.childCount,this.childCount,t.content):this.type.compatibleContent(t.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let t=a.none;for(let e=0;e<this.marks.length;e++){let i=this.marks[e];i.type.checkAttrs(i.attrs),t=i.addToSet(t)}if(!a.sameSet(t,this.marks))throw RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let t={type:this.type.name};for(let e in this.attrs){t.attrs=this.attrs;break}return this.content.size&&(t.content=this.content.toJSON()),this.marks.length&&(t.marks=this.marks.map(t=>t.toJSON())),t}static fromJSON(t,e){let i;if(!e)throw RangeError("Invalid input for Node.fromJSON");if(e.marks){if(!Array.isArray(e.marks))throw RangeError("Invalid mark data for Node.fromJSON");i=e.marks.map(t.markFromJSON)}if("text"==e.type){if("string"!=typeof e.text)throw RangeError("Invalid text node in JSON");return t.text(e.text,i)}let r=n.fromJSON(t,e.content),o=t.nodeType(e.type).create(e.attrs,r,i);return o.type.checkAttrs(o.attrs),o}}R.prototype.text=void 0;class T extends R{constructor(t,e,i,r){if(super(t,e,null,r),!i)throw RangeError("Empty text nodes are not allowed");this.text=i}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):x(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(t,e){return this.text.slice(t,e)}get nodeSize(){return this.text.length}mark(t){return t==this.marks?this:new T(this.type,this.attrs,this.text,t)}withText(t){return t==this.text?this:new T(this.type,this.attrs,t,this.marks)}cut(t=0,e=this.text.length){return 0==t&&e==this.text.length?this:this.withText(this.text.slice(t,e))}eq(t){return this.sameMarkup(t)&&this.text==t.text}toJSON(){let t=super.toJSON();return t.text=this.text,t}}function x(t,e){for(let i=t.length-1;i>=0;i--)e=t[i].type.name+"("+e+")";return e}class M{constructor(t){this.validEnd=t,this.next=[],this.wrapCache=[]}static parse(t,e){var i;let r,n=new k(t,e);if(null==n.next)return M.empty;let o=function t(e){let i=[];do i.push(function(e){let i=[];do i.push(function(e){let i=function(e){if(e.eat("(")){let i=t(e);return e.eat(")")||e.err("Missing closing paren"),i}if(/\W/.test(e.next))e.err("Unexpected token '"+e.next+"'");else{let t=(function(t,e){let i=t.nodeTypes,r=i[e];if(r)return[r];let n=[];for(let t in i){let r=i[t];r.isInGroup(e)&&n.push(r)}return 0==n.length&&t.err("No node type or group '"+e+"' found"),n})(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}}(e);for(;;)if(e.eat("+"))i={type:"plus",expr:i};else if(e.eat("*"))i={type:"star",expr:i};else if(e.eat("?"))i={type:"opt",expr:i};else if(e.eat("{"))i=function(t,e){let i=O(t),r=i;return t.eat(",")&&(r="}"!=t.next?O(t):-1),t.eat("}")||t.err("Unclosed braced range"),{type:"range",min:i,max:r,expr:e}}(e,i);else break;return i}(e));while(e.next&&")"!=e.next&&"|"!=e.next);return 1==i.length?i[0]:{type:"seq",exprs:i}}(e));while(e.eat("|"));return 1==i.length?i[0]:{type:"choice",exprs:i}}(n);n.next&&n.err("Unexpected trailing text");let s=(i=function(t){let e=[[]];return n(function t(e,o){if("choice"==e.type)return e.exprs.reduce((e,i)=>e.concat(t(i,o)),[]);if("seq"==e.type)for(let r=0;;r++){let s=t(e.exprs[r],o);if(r==e.exprs.length-1)return s;n(s,o=i())}else if("star"==e.type){let s=i();return r(o,s),n(t(e.expr,s),s),[r(s)]}else if("plus"==e.type){let s=i();return n(t(e.expr,o),s),n(t(e.expr,s),s),[r(s)]}else if("opt"==e.type)return[r(o)].concat(t(e.expr,o));else if("range"==e.type){let s=o;for(let r=0;r<e.min;r++){let r=i();n(t(e.expr,s),r),s=r}if(-1==e.max)n(t(e.expr,s),s);else for(let o=e.min;o<e.max;o++){let o=i();r(s,o),n(t(e.expr,s),o),s=o}return[r(s)]}else if("name"==e.type)return[r(o,void 0,e.value)];else throw Error("Unknown expr type")}(t,0),i()),e;function i(){return e.push([])-1}function r(t,i,r){let n={term:r,to:i};return e[t].push(n),n}function n(t,e){t.forEach(t=>t.to=e)}}(o),r=Object.create(null),function t(e){let n=[];e.forEach(t=>{i[t].forEach(({term:t,to:e})=>{let r;if(t){for(let e=0;e<n.length;e++)n[e][0]==t&&(r=n[e][1]);A(i,e).forEach(e=>{r||n.push([t,r=[]]),-1==r.indexOf(e)&&r.push(e)})}})});let o=r[e.join(",")]=new M(e.indexOf(i.length-1)>-1);for(let e=0;e<n.length;e++){let i=n[e][1].sort(I);o.next.push({type:n[e][0],next:r[i.join(",")]||t(i)})}return o}(A(i,0)));return function(t,e){for(let i=0,r=[t];i<r.length;i++){let t=r[i],n=!t.validEnd,o=[];for(let e=0;e<t.next.length;e++){let{type:i,next:s}=t.next[e];o.push(i.name),n&&!(i.isText||i.hasRequiredAttrs())&&(n=!1),-1==r.indexOf(s)&&r.push(s)}n&&e.err("Only non-generatable nodes ("+o.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(s,n),s}matchType(t){for(let e=0;e<this.next.length;e++)if(this.next[e].type==t)return this.next[e].next;return null}matchFragment(t,e=0,i=t.childCount){let r=this;for(let n=e;r&&n<i;n++)r=r.matchType(t.child(n).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let t=0;t<this.next.length;t++){let{type:e}=this.next[t];if(!(e.isText||e.hasRequiredAttrs()))return e}return null}compatible(t){for(let e=0;e<this.next.length;e++)for(let i=0;i<t.next.length;i++)if(this.next[e].type==t.next[i].type)return!0;return!1}fillBefore(t,e=!1,i=0){let r=[this];return function o(s,l){let a=s.matchFragment(t,i);if(a&&(!e||a.validEnd))return n.from(l.map(t=>t.createAndFill()));for(let t=0;t<s.next.length;t++){let{type:e,next:i}=s.next[t];if(!(e.isText||e.hasRequiredAttrs())&&-1==r.indexOf(i)){r.push(i);let t=o(i,l.concat(e));if(t)return t}}return null}(this,[])}findWrapping(t){for(let e=0;e<this.wrapCache.length;e+=2)if(this.wrapCache[e]==t)return this.wrapCache[e+1];let e=this.computeWrapping(t);return this.wrapCache.push(t,e),e}computeWrapping(t){let e=Object.create(null),i=[{match:this,type:null,via:null}];for(;i.length;){let r=i.shift(),n=r.match;if(n.matchType(t)){let t=[];for(let e=r;e.type;e=e.via)t.push(e.type);return t.reverse()}for(let t=0;t<n.next.length;t++){let{type:o,next:s}=n.next[t];o.isLeaf||o.hasRequiredAttrs()||o.name in e||r.type&&!s.validEnd||(i.push({match:o.contentMatch,type:o,via:r}),e[o.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(t){if(t>=this.next.length)throw RangeError(`There's no ${t}th edge in this content match`);return this.next[t]}toString(){let t=[];return!function e(i){t.push(i);for(let r=0;r<i.next.length;r++)-1==t.indexOf(i.next[r].next)&&e(i.next[r].next)}(this),t.map((e,i)=>{let r=i+(e.validEnd?"*":" ")+" ";for(let i=0;i<e.next.length;i++)r+=(i?", ":"")+e.next[i].type.name+"->"+t.indexOf(e.next[i].next);return r}).join("\n")}}M.empty=new M(!0);class k{constructor(t,e){this.string=t,this.nodeTypes=e,this.inline=null,this.pos=0,this.tokens=t.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(t){return this.next==t&&(this.pos++||!0)}err(t){throw SyntaxError(t+" (in content expression '"+this.string+"')")}}function O(t){/\D/.test(t.next)&&t.err("Expected number, got '"+t.next+"'");let e=Number(t.next);return t.pos++,e}function I(t,e){return e-t}function A(t,e){let i=[];return function e(r){let n=t[r];if(1==n.length&&!n[0].term)return e(n[0].to);i.push(r);for(let t=0;t<n.length;t++){let{term:r,to:o}=n[t];r||-1!=i.indexOf(o)||e(o)}}(e),i.sort(I)}function N(t){let e=Object.create(null);for(let i in t){let r=t[i];if(!r.hasDefault)return null;e[i]=r.default}return e}function H(t,e){let i=Object.create(null);for(let r in t){let n=e&&e[r];if(void 0===n){let e=t[r];if(e.hasDefault)n=e.default;else throw RangeError("No value supplied for attribute "+r)}i[r]=n}return i}function P(t,e,i,r){for(let r in e)if(!(r in t))throw RangeError(`Unsupported attribute ${r} for ${i} of type ${r}`);for(let i in t){let r=t[i];r.validate&&r.validate(e[i])}}function _(t,e){let i=Object.create(null);if(e)for(let r in e)i[r]=new L(t,r,e[r]);return i}class D{constructor(t,e,i){this.name=t,this.schema=e,this.spec=i,this.markSet=null,this.groups=i.group?i.group.split(" "):[],this.attrs=_(t,i.attrs),this.defaultAttrs=N(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(i.inline||"text"==t),this.isText="text"==t}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==M.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(t){return this.groups.indexOf(t)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let t in this.attrs)if(this.attrs[t].isRequired)return!0;return!1}compatibleContent(t){return this==t||this.contentMatch.compatible(t.contentMatch)}computeAttrs(t){return!t&&this.defaultAttrs?this.defaultAttrs:H(this.attrs,t)}create(t=null,e,i){if(this.isText)throw Error("NodeType.create can't construct text nodes");return new R(this,this.computeAttrs(t),n.from(e),a.setFrom(i))}createChecked(t=null,e,i){return e=n.from(e),this.checkContent(e),new R(this,this.computeAttrs(t),e,a.setFrom(i))}createAndFill(t=null,e,i){if(t=this.computeAttrs(t),(e=n.from(e)).size){let t=this.contentMatch.fillBefore(e);if(!t)return null;e=t.append(e)}let r=this.contentMatch.matchFragment(e),o=r&&r.fillBefore(n.empty,!0);return o?new R(this,t,e.append(o),a.setFrom(i)):null}validContent(t){let e=this.contentMatch.matchFragment(t);if(!e||!e.validEnd)return!1;for(let e=0;e<t.childCount;e++)if(!this.allowsMarks(t.child(e).marks))return!1;return!0}checkContent(t){if(!this.validContent(t))throw RangeError(`Invalid content for node ${this.name}: ${t.toString().slice(0,50)}`)}checkAttrs(t){P(this.attrs,t,"node",this.name)}allowsMarkType(t){return null==this.markSet||this.markSet.indexOf(t)>-1}allowsMarks(t){if(null==this.markSet)return!0;for(let e=0;e<t.length;e++)if(!this.allowsMarkType(t[e].type))return!1;return!0}allowedMarks(t){let e;if(null==this.markSet)return t;for(let i=0;i<t.length;i++)this.allowsMarkType(t[i].type)?e&&e.push(t[i]):e||(e=t.slice(0,i));return e?e.length?e:a.none:t}static compile(t,e){let i=Object.create(null);t.forEach((t,r)=>i[t]=new D(t,e,r));let r=e.spec.topNode||"doc";if(!i[r])throw RangeError("Schema is missing its top node type ('"+r+"')");if(!i.text)throw RangeError("Every schema needs a 'text' type");for(let t in i.text.attrs)throw RangeError("The text node type should not have attributes");return i}}class L{constructor(t,e,i){this.hasDefault=Object.prototype.hasOwnProperty.call(i,"default"),this.default=i.default,this.validate="string"==typeof i.validate?function(t,e,i){let r=i.split("|");return i=>{let n=null===i?"null":typeof i;if(0>r.indexOf(n))throw RangeError(`Expected value of type ${r} for attribute ${e} on type ${t}, got ${n}`)}}(t,e,i.validate):i.validate}get isRequired(){return!this.hasDefault}}class F{constructor(t,e,i,r){this.name=t,this.rank=e,this.schema=i,this.spec=r,this.attrs=_(t,r.attrs),this.excluded=null;let n=N(this.attrs);this.instance=n?new a(this,n):null}create(t=null){return!t&&this.instance?this.instance:new a(this,H(this.attrs,t))}static compile(t,e){let i=Object.create(null),r=0;return t.forEach((t,n)=>i[t]=new F(t,r++,e,n)),i}removeFromSet(t){for(var e=0;e<t.length;e++)t[e].type==this&&(t=t.slice(0,e).concat(t.slice(e+1)),e--);return t}isInSet(t){for(let e=0;e<t.length;e++)if(t[e].type==this)return t[e]}checkAttrs(t){P(this.attrs,t,"mark",this.name)}excludes(t){return this.excluded.indexOf(t)>-1}}class V{constructor(t){this.linebreakReplacement=null,this.cached=Object.create(null);let e=this.spec={};for(let i in t)e[i]=t[i];e.nodes=r.from(t.nodes),e.marks=r.from(t.marks||{}),this.nodes=D.compile(this.spec.nodes,this),this.marks=F.compile(this.spec.marks,this);let i=Object.create(null);for(let t in this.nodes){if(t in this.marks)throw RangeError(t+" can not be both a node and a mark");let e=this.nodes[t],r=e.spec.content||"",n=e.spec.marks;if(e.contentMatch=i[r]||(i[r]=M.parse(r,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==n?null:n?W(this,n.split(" ")):""!=n&&e.inlineContent?null:[]}for(let t in this.marks){let e=this.marks[t],i=e.spec.excludes;e.excluded=null==i?[e]:""==i?[]:W(this,i.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(t,e=null,i,r){if("string"==typeof t)t=this.nodeType(t);else if(t instanceof D){if(t.schema!=this)throw RangeError("Node type from different schema used ("+t.name+")")}else throw RangeError("Invalid node type: "+t);return t.createChecked(e,i,r)}text(t,e){let i=this.nodes.text;return new T(i,i.defaultAttrs,t,a.setFrom(e))}mark(t,e){return"string"==typeof t&&(t=this.marks[t]),t.create(e)}nodeFromJSON(t){return R.fromJSON(this,t)}markFromJSON(t){return a.fromJSON(this,t)}nodeType(t){let e=this.nodes[t];if(!e)throw RangeError("Unknown node type: "+t);return e}}function W(t,e){let i=[];for(let r=0;r<e.length;r++){let n=e[r],o=t.marks[n],s=o;if(o)i.push(o);else for(let e in t.marks){let r=t.marks[e];("_"==n||r.spec.group&&r.spec.group.split(" ").indexOf(n)>-1)&&i.push(s=r)}if(!s)throw SyntaxError("Unknown mark type: '"+e[r]+"'")}return i}class B{constructor(t,e){this.schema=t,this.rules=e,this.tags=[],this.styles=[];let i=this.matchedStyles=[];e.forEach(t=>{if(null!=t.tag)this.tags.push(t);else if(null!=t.style){let e=/[^=]*/.exec(t.style)[0];0>i.indexOf(e)&&i.push(e),this.styles.push(t)}}),this.normalizeLists=!this.tags.some(e=>{if(!/^(ul|ol)\b/.test(e.tag)||!e.node)return!1;let i=t.nodes[e.node];return i.contentMatch.matchType(i)})}parse(t,e={}){let i=new G(this,e,!1);return i.addAll(t,a.none,e.from,e.to),i.finish()}parseSlice(t,e={}){let i=new G(this,e,!0);return i.addAll(t,a.none,e.from,e.to),u.maxOpen(i.finish())}matchTag(t,e,i){for(let o=i?this.tags.indexOf(i)+1:0;o<this.tags.length;o++){var r,n;let i=this.tags[o];if(r=t,n=i.tag,(r.matches||r.msMatchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector).call(r,n)&&(void 0===i.namespace||t.namespaceURI==i.namespace)&&(!i.context||e.matchesContext(i.context))){if(i.getAttrs){let e=i.getAttrs(t);if(!1===e)continue;i.attrs=e||void 0}return i}}}matchStyle(t,e,i,r){for(let n=r?this.styles.indexOf(r)+1:0;n<this.styles.length;n++){let r=this.styles[n],o=r.style;if(0==o.indexOf(t)&&(!r.context||i.matchesContext(r.context))&&(!(o.length>t.length)||61==o.charCodeAt(t.length)&&o.slice(t.length+1)==e)){if(r.getAttrs){let t=r.getAttrs(e);if(!1===t)continue;r.attrs=t||void 0}return r}}}static schemaRules(t){let e=[];function i(t){let i=null==t.priority?50:t.priority,r=0;for(;r<e.length;r++){let t=e[r];if((null==t.priority?50:t.priority)<i)break}e.splice(r,0,t)}for(let e in t.marks){let r=t.marks[e].spec.parseDOM;r&&r.forEach(t=>{i(t=q(t)),t.mark||t.ignore||t.clearMark||(t.mark=e)})}for(let e in t.nodes){let r=t.nodes[e].spec.parseDOM;r&&r.forEach(t=>{i(t=q(t)),t.node||t.ignore||t.mark||(t.node=e)})}return e}static fromSchema(t){return t.cached.domParser||(t.cached.domParser=new B(t,B.schemaRules(t)))}}let j={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},z={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},U={ol:!0,ul:!0};function $(t,e,i){return null!=e?+!!e|2*("full"===e):t&&"pre"==t.whitespace?3:-5&i}class Y{constructor(t,e,i,r,n,o){this.type=t,this.attrs=e,this.marks=i,this.solid=r,this.options=o,this.content=[],this.activeMarks=a.none,this.match=n||(4&o?null:t.contentMatch)}findWrapping(t){if(!this.match){if(!this.type)return[];let e=this.type.contentMatch.fillBefore(n.from(t));if(e)this.match=this.type.contentMatch.matchFragment(e);else{let e=this.type.contentMatch,i;return(i=e.findWrapping(t.type))?(this.match=e,i):null}}return this.match.findWrapping(t.type)}finish(t){if(!(1&this.options)){let t=this.content[this.content.length-1],e;t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))&&(t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=t.withText(t.text.slice(0,t.text.length-e[0].length)))}let e=n.from(this.content);return!t&&this.match&&(e=e.append(this.match.fillBefore(n.empty,!0))),this.type?this.type.create(this.attrs,e,this.marks):e}inlineContext(t){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:t.parentNode&&!j.hasOwnProperty(t.parentNode.nodeName.toLowerCase())}}class G{constructor(t,e,i){this.parser=t,this.options=e,this.isOpen=i,this.open=0,this.localPreserveWS=!1;let r=e.topNode,n,o=$(null,e.preserveWhitespace,0)|4*!!i;n=r?new Y(r.type,r.attrs,a.none,!0,e.topMatch||r.type.contentMatch,o):i?new Y(null,null,a.none,!0,null,o):new Y(t.schema.topNodeType,null,a.none,!0,null,o),this.nodes=[n],this.find=e.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(t,e){3==t.nodeType?this.addTextNode(t,e):1==t.nodeType&&this.addElement(t,e)}addTextNode(t,e){let i=t.nodeValue,r=this.top,n=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===n||r.inlineContext(t)||/[^ \t\r\n\u000c]/.test(i)){if(n)i="full"!==n?i.replace(/\r?\n|\r/g," "):i.replace(/\r\n?/g,"\n");else if(i=i.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(i)&&this.open==this.nodes.length-1){let e=r.content[r.content.length-1],n=t.previousSibling;(!e||n&&"BR"==n.nodeName||e.isText&&/[ \t\r\n\u000c]$/.test(e.text))&&(i=i.slice(1))}i&&this.insertNode(this.parser.schema.text(i),e,!/\S/.test(i)),this.findInText(t)}else this.findInside(t)}addElement(t,e,i){let r=this.localPreserveWS,n=this.top;("PRE"==t.tagName||/pre/.test(t.style&&t.style.whiteSpace))&&(this.localPreserveWS=!0);let o=t.nodeName.toLowerCase(),s;U.hasOwnProperty(o)&&this.parser.normalizeLists&&function(t){for(let e=t.firstChild,i=null;e;e=e.nextSibling){let t=1==e.nodeType?e.nodeName.toLowerCase():null;t&&U.hasOwnProperty(t)&&i?(i.appendChild(e),e=i):"li"==t?i=e:t&&(i=null)}}(t);let l=this.options.ruleFromNode&&this.options.ruleFromNode(t)||(s=this.parser.matchTag(t,this,i));e:if(l?l.ignore:z.hasOwnProperty(o))this.findInside(t),this.ignoreFallback(t,e);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(t=l.skip);let i,r=this.needsBlock;if(j.hasOwnProperty(o))n.content.length&&n.content[0].isInline&&this.open&&(this.open--,n=this.top),i=!0,n.type||(this.needsBlock=!0);else if(!t.firstChild){this.leafFallback(t,e);break e}let s=l&&l.skip?e:this.readStyles(t,e);s&&this.addAll(t,s),i&&this.sync(n),this.needsBlock=r}else{let i=this.readStyles(t,e);i&&this.addElementByRule(t,l,i,!1===l.consuming?s:void 0)}this.localPreserveWS=r}leafFallback(t,e){"BR"==t.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(t.ownerDocument.createTextNode("\n"),e)}ignoreFallback(t,e){"BR"!=t.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),e,!0)}readStyles(t,e){let i=t.style;if(i&&i.length)for(let t=0;t<this.parser.matchedStyles.length;t++){let r=this.parser.matchedStyles[t],n=i.getPropertyValue(r);if(n)for(let t;;){let i=this.parser.matchStyle(r,n,this,t);if(!i)break;if(i.ignore)return null;if(e=i.clearMark?e.filter(t=>!i.clearMark(t)):e.concat(this.parser.schema.marks[i.mark].create(i.attrs)),!1===i.consuming)t=i;else break}}return e}addElementByRule(t,e,i,r){let n,o;if(e.node)if((o=this.parser.schema.nodes[e.node]).isLeaf)this.insertNode(o.create(e.attrs),i,"BR"==t.nodeName)||this.leafFallback(t,i);else{let t=this.enter(o,e.attrs||null,i,e.preserveWhitespace);t&&(n=!0,i=t)}else{let t=this.parser.schema.marks[e.mark];i=i.concat(t.create(e.attrs))}let s=this.top;if(o&&o.isLeaf)this.findInside(t);else if(r)this.addElement(t,i,r);else if(e.getContent)this.findInside(t),e.getContent(t,this.parser.schema).forEach(t=>this.insertNode(t,i,!1));else{let r=t;"string"==typeof e.contentElement?r=t.querySelector(e.contentElement):"function"==typeof e.contentElement?r=e.contentElement(t):e.contentElement&&(r=e.contentElement),this.findAround(t,r,!0),this.addAll(r,i),this.findAround(t,r,!1)}n&&this.sync(s)&&this.open--}addAll(t,e,i,r){let n=i||0;for(let o=i?t.childNodes[i]:t.firstChild,s=null==r?null:t.childNodes[r];o!=s;o=o.nextSibling,++n)this.findAtPoint(t,n),this.addDOM(o,e);this.findAtPoint(t,n)}findPlace(t,e,i){let r,n;for(let e=this.open,o=0;e>=0;e--){let s=this.nodes[e],l=s.findWrapping(t);if(l&&(!r||r.length>l.length+o)&&(r=l,n=s,!l.length))break;if(s.solid){if(i)break;o+=2}}if(!r)return null;this.sync(n);for(let t=0;t<r.length;t++)e=this.enterInner(r[t],null,e,!1);return e}insertNode(t,e,i){if(t.isInline&&this.needsBlock&&!this.top.type){let t=this.textblockFromContext();t&&(e=this.enterInner(t,null,e))}let r=this.findPlace(t,e,i);if(r){this.closeExtra();let e=this.top;e.match&&(e.match=e.match.matchType(t.type));let i=a.none;for(let n of r.concat(t.marks))(e.type?e.type.allowsMarkType(n.type):X(n.type,t.type))&&(i=n.addToSet(i));return e.content.push(t.mark(i)),!0}return!1}enter(t,e,i,r){let n=this.findPlace(t.create(e),i,!1);return n&&(n=this.enterInner(t,e,i,!0,r)),n}enterInner(t,e,i,r=!1,n){this.closeExtra();let o=this.top;o.match=o.match&&o.match.matchType(t);let s=$(t,n,o.options);4&o.options&&0==o.content.length&&(s|=4);let l=a.none;return i=i.filter(e=>(o.type?!o.type.allowsMarkType(e.type):!X(e.type,t))||(l=e.addToSet(l),!1)),this.nodes.push(new Y(t,e,l,r,null,s)),this.open++,i}closeExtra(t=!1){let e=this.nodes.length-1;if(e>this.open){for(;e>this.open;e--)this.nodes[e-1].content.push(this.nodes[e].finish(t));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(t){for(let e=this.open;e>=0;e--)if(this.nodes[e]==t)return this.open=e,!0;else this.localPreserveWS&&(this.nodes[e].options|=1);return!1}get currentPos(){this.closeExtra();let t=0;for(let e=this.open;e>=0;e--){let i=this.nodes[e].content;for(let e=i.length-1;e>=0;e--)t+=i[e].nodeSize;e&&t++}return t}findAtPoint(t,e){if(this.find)for(let i=0;i<this.find.length;i++)this.find[i].node==t&&this.find[i].offset==e&&(this.find[i].pos=this.currentPos)}findInside(t){if(this.find)for(let e=0;e<this.find.length;e++)null==this.find[e].pos&&1==t.nodeType&&t.contains(this.find[e].node)&&(this.find[e].pos=this.currentPos)}findAround(t,e,i){if(t!=e&&this.find)for(let r=0;r<this.find.length;r++)null==this.find[r].pos&&1==t.nodeType&&t.contains(this.find[r].node)&&e.compareDocumentPosition(this.find[r].node)&(i?2:4)&&(this.find[r].pos=this.currentPos)}findInText(t){if(this.find)for(let e=0;e<this.find.length;e++)this.find[e].node==t&&(this.find[e].pos=this.currentPos-(t.nodeValue.length-this.find[e].offset))}matchesContext(t){if(t.indexOf("|")>-1)return t.split(/\s*\|\s*/).some(this.matchesContext,this);let e=t.split("/"),i=this.options.context,r=!this.isOpen&&(!i||i.parent.type==this.nodes[0].type),n=-(i?i.depth+1:0)+ +!r,o=(t,s)=>{for(;t>=0;t--){let l=e[t];if(""==l){if(t==e.length-1||0==t)continue;for(;s>=n;s--)if(o(t-1,s))return!0;return!1}{let t=s>0||0==s&&r?this.nodes[s].type:i&&s>=n?i.node(s-n).type:null;if(!t||t.name!=l&&!t.isInGroup(l))return!1;s--}}return!0};return o(e.length-1,this.open)}textblockFromContext(){let t=this.options.context;if(t)for(let e=t.depth;e>=0;e--){let i=t.node(e).contentMatchAt(t.indexAfter(e)).defaultType;if(i&&i.isTextblock&&i.defaultAttrs)return i}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function q(t){let e={};for(let i in t)e[i]=t[i];return e}function X(t,e){let i=e.schema.nodes;for(let r in i){let n=i[r];if(!n.allowsMarkType(t))continue;let o=[],s=t=>{o.push(t);for(let i=0;i<t.edgeCount;i++){let{type:r,next:n}=t.edge(i);if(r==e||0>o.indexOf(n)&&s(n))return!0}};if(s(n.contentMatch))return!0}}class K{constructor(t,e){this.nodes=t,this.marks=e}serializeFragment(t,e={},i){i||(i=Q(e).createDocumentFragment());let r=i,n=[];return t.forEach(t=>{if(n.length||t.marks.length){let i=0,o=0;for(;i<n.length&&o<t.marks.length;){let e=t.marks[o];if(!this.marks[e.type.name]){o++;continue}if(!e.eq(n[i][0])||!1===e.type.spec.spanning)break;i++,o++}for(;i<n.length;)r=n.pop()[1];for(;o<t.marks.length;){let i=t.marks[o++],s=this.serializeMark(i,t.isInline,e);s&&(n.push([i,r]),r.appendChild(s.dom),r=s.contentDOM||s.dom)}}r.appendChild(this.serializeNodeInner(t,e))}),i}serializeNodeInner(t,e){let{dom:i,contentDOM:r}=tt(Q(e),this.nodes[t.type.name](t),null,t.attrs);if(r){if(t.isLeaf)throw RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(t.content,e,r)}return i}serializeNode(t,e={}){let i=this.serializeNodeInner(t,e);for(let r=t.marks.length-1;r>=0;r--){let n=this.serializeMark(t.marks[r],t.isInline,e);n&&((n.contentDOM||n.dom).appendChild(i),i=n.dom)}return i}serializeMark(t,e,i={}){let r=this.marks[t.type.name];return r&&tt(Q(i),r(t,e),null,t.attrs)}static renderSpec(t,e,i=null,r){return tt(t,e,i,r)}static fromSchema(t){return t.cached.domSerializer||(t.cached.domSerializer=new K(this.nodesFromSchema(t),this.marksFromSchema(t)))}static nodesFromSchema(t){let e=J(t.nodes);return e.text||(e.text=t=>t.text),e}static marksFromSchema(t){return J(t.marks)}}function J(t){let e={};for(let i in t){let r=t[i].spec.toDOM;r&&(e[i]=r)}return e}function Q(t){return t.document||window.document}let Z=new WeakMap;function tt(t,e,i,r){let n,o,s;if("string"==typeof e)return{dom:t.createTextNode(e)};if(null!=e.nodeType)return{dom:e};if(e.dom&&null!=e.dom.nodeType)return e;let l=e[0],a;if("string"!=typeof l)throw RangeError("Invalid array passed to renderSpec");if(r&&(void 0===(o=Z.get(r))&&Z.set(r,(s=null,function t(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])s||(s=[]),s.push(e);else for(let i=0;i<e.length;i++)t(e[i]);else for(let i in e)t(e[i])}(r),o=s)),a=o)&&a.indexOf(e)>-1)throw RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let h=l.indexOf(" ");h>0&&(i=l.slice(0,h),l=l.slice(h+1));let u=i?t.createElementNS(i,l):t.createElement(l),c=e[1],d=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){for(let t in d=2,c)if(null!=c[t]){let e=t.indexOf(" ");e>0?u.setAttributeNS(t.slice(0,e),t.slice(e+1),c[t]):u.setAttribute(t,c[t])}}for(let o=d;o<e.length;o++){let s=e[o];if(0===s){if(o<e.length-1||o>d)throw RangeError("Content hole must be the only child of its parent node");return{dom:u,contentDOM:u}}{let{dom:e,contentDOM:o}=tt(t,s,i,r);if(u.appendChild(e),o){if(n)throw RangeError("Multiple content holes");n=o}}}return{dom:u,contentDOM:n}}},10265:(t,e,i)=>{"use strict";i.d(e,{c:()=>n});var r=i(39624);function n(t,e,i){return(0,r.z)(t,-e,i)}},10932:(t,e,i)=>{"use strict";i.d(e,{q:()=>o}),i(19398);var r=i(12522),n=i(95061);class o extends r._{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getTrimmedIndexes(){return(0,n.arrayReduce)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}},11055:(t,e,i)=>{"use strict";i.r(e),i.d(e,{_dataToHTML:()=>l,htmlToGridSettings:()=>a,instanceToHTML:()=>s}),i(19398),i(81698),i(12252),i(29954),i(85522),i(43942);var r=i(78887);let n={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},o=RegExp(Object.keys(n).map(t=>`(${t})`).join("|"),"gi");function s(t){let e=t.hasColHeaders(),i=t.hasRowHeaders(),n=[e?-1:0,i?-1:0,t.countRows()-1,t.countCols()-1],o=t.getData(...n),s=o.length,l=s>0?o[0].length:0,a=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],u=["<tbody>","</tbody>"],c=+!!i,d=+!!e;for(let n=0;n<s;n+=1){let s=e&&0===n,a=[];for(let e=0;e<l;e+=1){let l=!s&&i&&0===e,h="";if(s)h=`<th>${t.getColHeader(e-c)}</th>`;else if(l)h=`<th>${t.getRowHeader(n-d)}</th>`;else{let i=o[n][e],{hidden:s,rowspan:l,colspan:a}=t.getCellMeta(n-d,e-c);if(!s){let t=[];if(l&&t.push(`rowspan="${l}"`),a&&t.push(`colspan="${a}"`),(0,r.isEmpty)(i))h=`<td ${t.join(" ")}></td>`;else{let e=i.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");h=`<td ${t.join(" ")}>${e}</td>`}}}a.push(h)}let g=["<tr>",...a,"</tr>"].join("");s?h.splice(1,0,g):u.splice(-1,0,g)}return a.splice(1,0,h.join(""),u.join("")),a.join("")}function l(t){let e=t.length,i=["<table>"];for(let n=0;n<e;n+=1){let o=t[n],s=o.length,l=[];0===n&&i.push("<tbody>");for(let t=0;t<s;t+=1){let e=o[t],i=(0,r.isEmpty)(e)?"":e.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,"<br>\r\n").replace(/\x20{2,}/gi,t=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(t.length-1)} </span>`).replace(/\t/gi,"&#9;");l.push(`<td>${i}</td>`)}i.push("<tr>",...l,"</tr>"),n+1===e&&i.push("</tbody>")}return i.push("</table>"),i.join("")}function a(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document,r={},s=i.createDocumentFragment(),l=i.createElement("div");s.appendChild(l);let a=t;if("string"==typeof a){let t=a.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,t=>{let e=t.match(/<td\b[^>]*?>/g)[0],i=t.substring(e.length,t.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(/<p.*?>/g,"\n").replace("\n","").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${e}${i}</td>`});l.insertAdjacentHTML("afterbegin",`${t}`),a=l.querySelector("table")}if(!a||"TABLE"!==((e=a)&&e.nodeName||""))return;let h=l.querySelector('meta[name$="enerator"]'),u=null!==a.querySelector("tbody th"),c=a.querySelector("tr"),d=c?Array.from(c.cells).reduce((t,e)=>t+e.colSpan,0)-+!!u:0,g=a.tFoot&&Array.from(a.tFoot.rows)||[],f=[],p=!1,m=0,w=0;if(a.tHead){let t=Array.from(a.tHead.rows).filter(t=>{let e=null!==t.querySelector("td");return e&&f.push(t),!e});p=(m=t.length)>0,m>1?r.nestedHeaders=Array.from(t).reduce((t,e)=>{let i=Array.from(e.cells).reduce((t,e,i)=>{if(u&&0===i)return t;let{colSpan:r,innerHTML:n}=e;return t.push(r>1?{label:n,colspan:r}:n),t},[]);return t.push(i),t},[]):p&&(r.colHeaders=Array.from(t[0].children).reduce((t,e,i)=>(u&&0===i||t.push(e.innerHTML),t),[]))}f.length&&(r.fixedRowsTop=f.length),g.length&&(r.fixedRowsBottom=g.length);let y=[...f,...Array.from(a.tBodies).reduce((t,e)=>(t.push(...Array.from(e.rows)),t),[]),...g],b=Array(w=y.length);for(let t=0;t<w;t++)b[t]=Array(d);let C=[],S=[];for(let t=0;t<w;t++){let e=Array.from(y[t].cells),i=e.length;for(let r=0;r<i;r++){let i=e[r],{nodeName:s,innerHTML:l,rowSpan:a,colSpan:u}=i,c=b[t].findIndex(t=>void 0===t);if("TD"===s){if(a>1||u>1){for(let e=t;e<t+a;e++)if(e<w)for(let t=c;t<c+u;t++)b[e][t]=null;let e=i.getAttribute("style");e&&e.includes("mso-ignore:colspan")||C.push({col:c,row:t,rowspan:a,colspan:u})}let e="";e=h&&/excel/gi.test(h.content)?l.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,"\r\n"):l.replace(/<br(\s*|\/)>[\r\n]?/gim,"\r\n"),b[t][c]=e.replace(o,t=>n[t])}else S.push(l)}}return C.length&&(r.mergeCells=C),S.length&&(r.rowHeaders=S),b.length&&(r.data=b),r}},11351:(t,e,i)=>{"use strict";var r=i(54076),n=i(93840),o=i(50320),s=i(13517),l=i(16526),a=i(66212),h=i(81315),u=Array,c=n(a("Array","sort"));r({target:"Array",proto:!0},{toSorted:function(t){return void 0!==t&&o(t),c(l(u,s(this)),t)}}),h("toSorted")},11609:(t,e,i)=>{"use strict";var r=i(25),n=i(56963),o=i(42620).String;t.exports=!!Object.getOwnPropertySymbols&&!n(function(){var t=Symbol("symbol detection");return!o(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&r&&r<41})},12252:(t,e,i)=>{"use strict";i(79031)},12522:(t,e,i)=>{"use strict";i.d(e,{_:()=>o});var r=i(82505),n=i(59932);class o extends r.n{insert(t,e){this.indexedValues=(0,n.N)(this.indexedValues,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){this.indexedValues=(0,n.H)(this.indexedValues,t),super.remove(t)}}},13115:(t,e,i)=>{"use strict";i.r(e),i.d(e,{isImmediatePropagationStopped:()=>o,isLeftClick:()=>l,isRightClick:()=>s,isTouchEvent:()=>a,offsetRelativeTo:()=>h,stopImmediatePropagation:()=>n});var r=i(33787);function n(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function o(t){return!1===t.isImmediatePropagationEnabled}function s(t){return 2===t.button}function l(t){return 0===t.button}function a(t){return t instanceof TouchEvent}function h(t,e){let i={x:t.offsetX,y:t.offsetY},n=t.target;if(!(0,r.isHTMLElement)(e)||n!==e&&n.contains(e))return i;for(;n!==e;)i.x+=n.offsetLeft,i.y+=n.offsetTop,n=n.offsetParent;return i}},13455:(t,e,i)=>{"use strict";function r(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=typeof t;if("number"===i)return!isNaN(t)&&isFinite(t);if("string"===i){if(0===t.length)return!1;if(1===t.length)return/\d/.test(t);let i=Array.from(new Set([".",...e])).map(t=>`\\${t}`).join("|");return RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}return"object"===i&&!!t&&"number"==typeof t.valueOf()&&!(t instanceof Date)}function n(t){return r(t,[","])}function o(t,e,i){let r=-1;for("function"==typeof e?(i=e,e=t):r=t-1;++r<=e&&!1!==i(r););}function s(t,e,i){let r=t+1;for("function"==typeof e&&(i=e,e=0);--r>=e&&!1!==i(r););}function l(t,e){return parseInt(t*(e=isNaN(e=parseInt(e.toString().replace("%",""),10))?0:e)/100,10)}function a(t,e,i){return Math.min(t,e)===t?e:Math.max(t,i)===t?i:t}i.r(e),i.d(e,{clamp:()=>a,isNumeric:()=>r,isNumericLike:()=>n,rangeEach:()=>o,rangeEachReverse:()=>s,valueAccordingPercent:()=>l}),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(85522)},13517:(t,e,i)=>{"use strict";var r=i(35889),n=i(16604);t.exports=function(t){return r(n(t))}},13928:(t,e,i)=>{"use strict";t.exports=i(93840)([].slice)},14412:(t,e,i)=>{"use strict";t.exports=!i(56963)(function(){return 7!==Object.defineProperty({},1,{get:function(){return 7}})[1]})},15030:(t,e,i)=>{"use strict";var r=i(54076),n=i(56963),o=i(16528);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("intersection",function(t){return 2===t.size&&t.has(1)&&t.has(2)})||n(function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))})},{intersection:o})},15567:(t,e,i)=>{"use strict";var r=i(42620),n=i(76494),o=r.document,s=n(o)&&n(o.createElement);t.exports=function(t){return s?o.createElement(t):{}}},15616:(t,e,i)=>{"use strict";i.r(e),i.d(e,{countFirstRowKeys:()=>d,createEmptySpreadsheetData:()=>u,createSpreadsheetData:()=>a,createSpreadsheetObjectData:()=>h,dataRowToChangesArray:()=>c,isArrayOfArrays:()=>g,isArrayOfObjects:()=>f,spreadsheetColumnIndex:()=>l,spreadsheetColumnLabel:()=>s}),i(19398),i(12252),i(63723),i(20775);var r=i(19857);let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",o=n.length;function s(t){let e,i=t+1,r="";for(;i>0;)r=String.fromCharCode(65+(e=(i-1)%o))+r,i=parseInt((i-e)/o,10);return r}function l(t){let e=0;if(t)for(let i=0,r=t.length-1;i<t.length;i+=1,r-=1)e+=o**r*(n.indexOf(t[i])+1);return e-1}function a(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=[];for(t=0;t<i;t++){let i=[];for(e=0;e<r;e++)i.push(s(e)+(t+1));n.push(i)}return n}function h(){let t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=[];for(t=0;t<i;t++){let i={};for(e=0;e<r;e++)i[`prop${e}`]=s(e)+(t+1);n.push(i)}return n}function u(t,e){let i,r=[];for(let n=0;n<t;n++){i=[];for(let t=0;t<e;t++)i.push("");r.push(i)}return r}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=t,r=[];return Array.isArray(t)&&Array.isArray(t[0])||(i=[t]),i.forEach((t,i)=>{Array.isArray(t)?t.forEach((t,n)=>{r.push([i+e,n,t])}):Object.keys(t).forEach(n=>{r.push([i+e,n,t[n]])})}),r}function d(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&(0,r.isObject)(t[0])&&(e=(0,r.deepObjectSize)(t[0]))),e}function g(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>Array.isArray(t)))}function f(t){return!!(Array.isArray(t)&&t.length&&t.every(t=>"object"==typeof t&&!Array.isArray(t)&&null!==t))}},15625:(t,e,i)=>{"use strict";var r=i(82309),n=i(95467),o=i(24201),s=i(7411),l=i(65847),a=i(37e3),h=i(98590),u=i(55415),c=i(27643),d=i(1728),g=i(91615),f=i(14412),p=i(72255);t.exports=function(t,e,i,m){var w="stackTraceLimit",y=m?2:1,b=t.split("."),C=b[b.length-1],S=r.apply(null,b);if(S){var E=S.prototype;if(!p&&n(E,"cause")&&delete E.cause,!i)return S;var R=r("Error"),T=e(function(t,e){var i=c(m?e:t,void 0),r=m?new S(t):new S;return void 0!==i&&o(r,"message",i),g(r,T,r.stack,2),this&&s(E,this)&&u(r,this,T),arguments.length>y&&d(r,arguments[y]),r});if(T.prototype=E,"Error"!==C?l?l(T,R):a(T,R,{name:!0}):f&&w in S&&(h(T,S,w),h(T,S,"prepareStackTrace")),a(T,S),!p)try{E.name!==C&&o(E,"name",C),E.constructor=T}catch(t){}return T}}},15743:(t,e,i)=>{"use strict";var r=i(50320),n=i(8883),o=i(67297),s=i(42665),l=i(7475),a="Invalid size",h=RangeError,u=TypeError,c=Math.max,d=function(t,e){this.set=t,this.size=c(e,0),this.has=r(t.has),this.keys=r(t.keys)};d.prototype={getIterator:function(){return l(n(o(this.keys,this.set)))},includes:function(t){return o(this.has,this.set,t)}},t.exports=function(t){n(t);var e=+t.size;if(e!=e)throw new u(a);var i=s(e);if(i<0)throw new h(a);return new d(t,i)}},16526:(t,e,i)=>{"use strict";var r=i(94948);t.exports=function(t,e,i){for(var n=0,o=arguments.length>2?i:r(e),s=new t(o);o>n;)s[n]=e[n++];return s}},16528:(t,e,i)=>{"use strict";var r=i(94272),n=i(16954),o=i(57580),s=i(15743),l=i(69905),a=i(6497),h=n.Set,u=n.add,c=n.has;t.exports=function(t){var e=r(this),i=s(t),n=new h;return o(e)>i.size?a(i.getIterator(),function(t){c(e,t)&&u(n,t)}):l(e,function(t){i.includes(t)&&u(n,t)}),n}},16569:(t,e,i)=>{"use strict";var r=i(76494);t.exports=function(t){return r(t)||null===t}},16604:(t,e,i)=>{"use strict";var r=i(56135),n=TypeError;t.exports=function(t){if(r(t))throw new n("Can't call method on "+t);return t}},16683:(t,e,i)=>{"use strict";var r=i(95467),n=i(99365),o=i(33325),s=i(37889),l=i(60009),a=s("IE_PROTO"),h=Object,u=h.prototype;t.exports=l?h.getPrototypeOf:function(t){var e=o(t);if(r(e,a))return e[a];var i=e.constructor;return n(i)&&e instanceof i?i.prototype:e instanceof h?u:null}},16687:(t,e,i)=>{"use strict";i.d(e,{g:()=>n});var r=i(89447);function n(t,e,i){let n=(0,r.a)(t,null==i?void 0:i.in);return n.setSeconds(e),n}},16880:(t,e,i)=>{"use strict";i.d(e,{R:()=>R}),i(41658),i(19398);var r=i(95061),n=i(93924),o=i(57193),s=i(83457),l=i(75708);let a=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],h=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),u=new Map([[]]);function c(t,e,i){d(t,e),e.set(t,i)}function d(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function g(t,e,i){return t.set(p(t,e),i),i}function f(t,e){return t.get(p(t,e))}function p(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}i(11351),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(29954),i(21591),i(20775);var m=new WeakMap,w=new WeakMap,y=new WeakMap,b=new WeakSet;class C{constructor(){!function(t,e){d(t,e),e.add(t)}(this,b),c(this,m,new Map),c(this,w,new Map),c(this,y,new Set),a.forEach(t=>p(b,this,S).call(this,t))}getHooks(t){var e;return null!==(e=f(m,this).get(t))&&void 0!==e?e:[]}add(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};f(m,this).has(t)||(p(b,this,S).call(this,t),a.push(t));let r=f(m,this).get(t);if(r.find(t=>t.callback===e))return;let n=Number.isInteger(i.orderIndex)?i.orderIndex:0,o=!!i.runOnce,s=!!i.initialHook,l=!1;if(s){let t=r.find(t=>t.initialHook);t&&(t.callback=e,l=!0)}if(!l){r.push({callback:e,orderIndex:n,runOnce:o,initialHook:s,skip:!1});let i=f(y,this).has(t);i||0===n||(i=!0,f(y,this).add(t)),i&&r.length>1&&f(m,this).set(t,r.toSorted((t,e)=>t.orderIndex-e.orderIndex))}}has(t){return f(m,this).has(t)&&f(m,this).get(t).length>0}remove(t,e){if(!f(m,this).has(t))return!1;let i=f(m,this).get(t),r=i.find(t=>t.callback===e);if(r){let e=f(w,this).get(t);return r.skip=!0,(e+=1)>100&&(f(m,this).set(t,i.filter(t=>!t.skip)),e=0),f(w,this).set(t,e),!0}return!1}destroy(){f(m,this).clear(),f(w,this).clear(),g(m,this,null),g(w,this,null)}}function S(t){f(m,this).set(t,[]),f(w,this).set(t,0)}let E=(0,s.O)`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class R{constructor(){!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"globalBucket",new C)}static getSingleton(){return T}getBucket(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return t?(t.pluginHookBucket||(t.pluginHookBucket=new C),t.pluginHookBucket):this.globalBucket}add(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,s=arguments.length>3?arguments[3]:void 0;return Array.isArray(e)?(0,r.arrayEach)(e,e=>this.add(t,e,i)):(h.has(t)&&(0,o.R8)((0,n.substitute)(E,{hookName:t,removedInVersion:h.get(t)})),u.has(t)&&(0,o.R8)(u.get(t)),this.getBucket(i).add(t,e,{orderIndex:s,runOnce:!1})),this}once(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3?arguments[3]:void 0;return Array.isArray(e)?(0,r.arrayEach)(e,e=>this.once(t,e,i)):this.getBucket(i).add(t,e,{orderIndex:n,runOnce:!0}),this}addAsFixed(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(e)?(0,r.arrayEach)(e,e=>this.addAsFixed(t,e,i)):this.getBucket(i).add(t,e,{initialHook:!0}),this}remove(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.getBucket(i).remove(t,e)}has(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getBucket(e).has(t)}run(t,e,i,r,n,o,s,a){{let h=this.getBucket().getHooks(e),u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,l.fastCall)(h[c].callback,t,i,r,n,o,s,a);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(e,h[c].callback),c+=1}}{let h=this.getBucket(t).getHooks(e),u=h?h.length:0,c=0;if(u)for(;c<u;){if(!h[c]||h[c].skip){c+=1;continue}let u=(0,l.fastCall)(h[c].callback,t,i,r,n,o,s,a);void 0!==u&&(i=u),h[c]&&h[c].runOnce&&this.remove(e,h[c].callback,t),c+=1}}return i}destroy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.getBucket(t).destroy()}register(t){this.isRegistered(t)||a.push(t)}deregister(t){this.isRegistered(t)&&a.splice(a.indexOf(t),1)}isDeprecated(t){return u.has(t)||h.has(t)}isRegistered(t){return a.indexOf(t)>=0}getRegistered(){return a}}let T=new R},16932:(t,e,i)=>{"use strict";i.d(e,{ML:()=>d,NB:()=>f,Qz:()=>l,_e:()=>g,ay:()=>s,f7:()=>p}),i(41658),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(75036);var r=i(71190),n=i(95061),o=i(78887);let s=0,l=1,a=[3,2],h=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],u=Symbol("root"),c=Symbol("child");function d(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;if(e!==u&&e!==c)throw Error("The second argument is used internally only and cannot be overwritten.");let i=Array.isArray(t),n=e===u,o=s;if(i){let e=t[0];0===t.length?o=l:n&&e instanceof r.A?o=3:n&&Array.isArray(e)?o=d(e,c):t.length>=2&&t.length<=4&&!t.some((t,e)=>!h[e].includes(typeof t))&&(o=2)}return o}function g(t){let{createCellCoords:e,createCellRange:i,keepDirection:r=!1,propToCol:n}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!a.includes(t))throw Error("Unsupported selection ranges schema type was provided.");return function(s){let l=3===t,a=l?s.from.row:s[0],h=l?s.from.col:s[1],u=l?s.to.row:s[2],c=l?s.to.col:s[3];if("function"==typeof n&&("string"==typeof h&&(h=n(h)),"string"==typeof c&&(c=n(c))),(0,o.isUndefined)(u)&&(u=a),(0,o.isUndefined)(c)&&(c=h),!r){let t=a,e=h,i=u,r=c;a=Math.min(t,i),h=Math.min(e,r),u=Math.max(t,i),c=Math.max(e,r)}let d=e(a,h);return i(d,d,e(u,c))}}function f(t){let e=d(t.getSelected());if(e===s||e===l)return[];let i=g(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,n.arrayEach)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.col,0),l=o.col-s+1;(0,n.arrayEach)(Array.from(Array(l),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e);return(0,n.arrayReduce)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[])}function p(t){let e=d(t.getSelected());if(e===s||e===l)return[];let i=g(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),r=new Set;(0,n.arrayEach)(t.getSelected(),t=>{let{from:e,to:o}=i(t),s=Math.max(e.row,0),l=o.row-s+1;(0,n.arrayEach)(Array.from(Array(l),(t,e)=>s+e),t=>{r.has(t)||r.add(t)})});let o=Array.from(r).sort((t,e)=>t-e);return(0,n.arrayReduce)(o,(t,e,i,r)=>(0!==i&&e===r[i-1]+1?t[t.length-1][1]+=1:t.push([e,1]),t),[])}},16954:(t,e,i)=>{"use strict";var r=i(93840),n=Set.prototype;t.exports={Set:Set,add:r(n.add),has:r(n.has),remove:r(n.delete),proto:n}},17480:(t,e,i)=>{"use strict";i.d(e,{sd:()=>m,f4:()=>p,Mt:()=>w,F3:()=>y}),i(41658);var r=i(93924);i(12252),i(85522);var n=i(13455),o=i(75708);let s=new Map([["asc",[-1,1]],["desc",[1,-1]]]),l=t=>`The priority '${t}' is already declared in a map.`,a=t=>`The priority '${t}' is not a number.`;var h=i(89658);i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);let u=t=>`'${t}' value is already declared in a unique set.`,c=t=>`There is already registered "${t}" plugin.`,d=function(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=new Map;return t=(0,o.isFunction)(t)?t:l,e=(0,o.isFunction)(e)?e:a,{addItem:function(r,o){if(!(0,n.isNumeric)(r))throw Error(e(r));if(i.has(r))throw Error(t(r));i.set(r,o)},getItems:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"asc",[e,r]=s.get(t)||s.get("asc");return[...i].sort((t,i)=>t[0]<i[0]?e:r).map(t=>t[1])}}}({errorPriorityExists:t=>`There is already registered plugin on priority "${t}".`,errorPriorityNaN:t=>`The priority "${t}" is not a number.`}),g=function(){let{errorItemExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Set;return t=(0,o.isFunction)(t)?t:u,{addItem:function(i){if(e.has(i))throw Error(t(i));e.add(i)},clear:function(){e.clear()},getItems:function(){return[...e]}}}({errorItemExists:c}),f=(0,h.u)({errorIdExists:c});function p(){return[...d.getItems(),...g.getItems()]}function m(t){let e=(0,r.toUpperCaseFirst)(t);return f.getItem(e)}function w(t){return!!m(t)}function y(t,e,i){var n,o,s;[t,e,i]=(n=t,o=e,s=i,"function"==typeof n&&(n=(o=n).PLUGIN_KEY,s=o.PLUGIN_PRIORITY),[n,o,s]),void 0===m(t)&&function(t,e,i){let n=(0,r.toUpperCaseFirst)(t);if(f.hasItem(n))throw Error(c(n));void 0===i?g.addItem(n):d.addItem(i,n),f.addItem(n,e)}(t,e,i)}},17519:(t,e,i)=>{"use strict";i.d(e,{s:()=>a});var r=i(25703),n=i(70540),o=i(7239),s=i(71182),l=i(89447);function a(t,e){let i=(0,l.a)(t,null==e?void 0:e.in);return Math.round((+(0,n.b)(i)-+function(t,e){let i=(0,s.p)(t,void 0),r=(0,o.w)(t,0);return r.setFullYear(i,0,4),r.setHours(0,0,0,0),(0,n.b)(r)}(i))/r.my)+1}},18045:(t,e,i)=>{"use strict";i.d(e,{A:()=>l,q:()=>s});let r=/^(\r\n|\n\r|\r|\n)/,n=/^[^\t\r\n]+/,o=/^\t/;function s(t){let e,i=[[""]];if(0===t.length)return i;let s=0,l=0;for(;t.length>0&&e!==t.length;)if(e=t.length,t.match(o))t=t.replace(o,""),s+=1,i[l][s]="";else if(t.match(r))t=t.replace(r,""),s=0,i[l+=1]=[""];else{let e="";if(t.startsWith('"')){let i=0,r=!0;for(;r;){let n=t.slice(0,1);'"'===n&&(i+=1),e+=n,(0===(t=t.slice(1)).length||t.match(/^[\t\r\n]/)&&i%2==0)&&(r=!1)}e=e.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,t=>Array(Math.floor(t.length/2)).fill('"').join(""))}else{let i=t.match(n);e=i?i[0]:"",t=t.slice(e.length)}i[l][s]=e}return i}function l(t){let e,i,r,n,o,s="";for(e=0,i=t.length;e<i;e+=1){for(r=0,n=t[e].length;r<n;r+=1)r>0&&(s+="	"),"string"==typeof(o=t[e][r])?o.indexOf("\n")>-1?s+=`"${o.replace(/"/g,'""')}"`:s+=o:null==o?s+="":s+=o;e!==i-1&&(s+="\n")}return s}},19315:(t,e,i)=>{"use strict";i.d(e,{h:()=>l});var r=i(95490),n=i(7239),o=i(84423),s=i(89447);function l(t,e){var i,l,a,h,u,c,d,g;let f=(0,s.a)(t,null==e?void 0:e.in),p=f.getFullYear(),m=(0,r.q)(),w=null!==(g=null!==(d=null!==(c=null!==(u=null==e?void 0:e.firstWeekContainsDate)&&void 0!==u?u:null==e?void 0:null===(l=e.locale)||void 0===l?void 0:null===(i=l.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==c?c:m.firstWeekContainsDate)&&void 0!==d?d:null===(h=m.locale)||void 0===h?void 0:null===(a=h.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==g?g:1,y=(0,n.w)((null==e?void 0:e.in)||t,0);y.setFullYear(p+1,0,w),y.setHours(0,0,0,0);let b=(0,o.k)(y,e),C=(0,n.w)((null==e?void 0:e.in)||t,0);C.setFullYear(p,0,w),C.setHours(0,0,0,0);let S=(0,o.k)(C,e);return+f>=+b?p+1:+f>=+S?p:p-1}},19398:(t,e,i)=>{"use strict";var r=i(54076),n=i(33325),o=i(94948),s=i(2769),l=i(42947);r({target:"Array",proto:!0,arity:1,forced:i(56963)(function(){return 0x100000001!==[].push.call({length:0x100000000},1)})||!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}()},{push:function(t){var e=n(this),i=o(e),r=arguments.length;l(i+r);for(var a=0;a<r;a++)e[i]=arguments[a],i++;return s(e,i),i}})},19828:(t,e,i)=>{"use strict";i.d(e,{D:()=>n});var r=i(89447);function n(t,e){let i=(0,r.a)(t,null==e?void 0:e.in);return i.setHours(23,59,59,999),i}},19857:(t,e,i)=>{"use strict";i.r(e),i.d(e,{clone:()=>l,createObjectPropListener:()=>m,deepClone:()=>s,deepExtend:()=>function t(e,i){d(i,(r,n)=>{i[n]&&"object"==typeof i[n]?(e[n]||(Array.isArray(i[n])?e[n]=[]:"[object Date]"===Object.prototype.toString.call(i[n])?e[n]=i[n]:e[n]={}),t(e[n],i[n])):e[n]=i[n]})},deepObjectSize:()=>p,defineGetter:()=>c,duckSchema:()=>function t(e){let i;return Array.isArray(e)?i=e.length?Array(e.length).fill(null):[]:(i={},d(e,(e,r)=>{"__children"!==r&&(e&&"object"==typeof e&&!Array.isArray(e)?i[r]=t(e):Array.isArray(e)?e.length&&"object"==typeof e[0]&&!Array.isArray(e[0])?i[r]=[t(e[0])]:i[r]=[]:i[r]=null)})),i},extend:()=>o,getProperty:()=>g,hasOwnProperty:()=>w,inherit:()=>n,isObject:()=>u,isObjectEqual:()=>h,mixin:()=>a,objectEach:()=>d,setProperty:()=>f}),i(41658),i(19398),i(89750),i(12252),i(20775);var r=i(95061);function n(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function o(t,e,i){let r=Array.isArray(i);return d(e,(e,n)=>{(!1===r||i.includes(n))&&(t[n]=e)}),t}function s(t){return"object"==typeof t?JSON.parse(JSON.stringify(t)):t}function l(t){let e={};return d(t,(t,i)=>{e[i]=t}),e}function a(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return(0,r.arrayEach)(i,e=>{t.MIXINS.push(e.MIXIN_NAME),d(e,(e,i)=>{if(void 0!==t.prototype[i])throw Error(`Mixin conflict. Property '${i}' already exist and cannot be overwritten.`);"function"==typeof e?t.prototype[i]=e:Object.defineProperty(t.prototype,i,{get:function(t,e){let i=`_${t}`,r=t=>{let e=t;return(Array.isArray(e)||u(e))&&(e=s(e)),e};return function(){return void 0===this[i]&&(this[i]=r(e)),this[i]}}(i,e),set:function(t){let e=`_${t}`;return function(t){this[e]=t}}(i),configurable:!0})})}),t}function h(t,e){return JSON.stringify(t)===JSON.stringify(e)}function u(t){return"[object Object]"===Object.prototype.toString.call(t)}function c(t,e,i,r){r.value=i,r.writable=!1!==r.writable,r.enumerable=!1!==r.enumerable,r.configurable=!1!==r.configurable,Object.defineProperty(t,e,r)}function d(t,e){for(let i in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,i))&&!1===e(t[i],i,t))break;return t}function g(t,e){let i=e.split("."),r=t;return d(i,t=>{if(void 0===(r=r[t]))return r=void 0,!1}),r}function f(t,e,i){if("string"!=typeof e)return;let r=e.split("."),n=t;r.forEach((t,e)=>{"__proto__"!==t&&"constructor"!==t&&"prototype"!==t&&(e!==r.length-1?(w(n,t)||(n[t]={}),n=n[t]):n[t]=i)})}function p(t){if(!u(t))return 0;let e=function(t){let i=0;return u(t)?d(t,(t,r)=>{"__children"!==r&&(i+=e(t))}):i+=1,i};return e(t)}function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"value",i=`_${e}`,r={_touched:!1,[i]:t,isTouched(){return this._touched}};return Object.defineProperty(r,e,{get(){return this[i]},set(t){this._touched=!0,this[i]=t},enumerable:!0,configurable:!0}),r}function w(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},20775:(t,e,i)=>{"use strict";i(63462)},20856:(t,e,i)=>{"use strict";i.d(e,{T:()=>o});var r=i(7239),n=i(89447);function o(t,e){let i,o=null==e?void 0:e.in;return t.forEach(t=>{o||"object"!=typeof t||(o=r.w.bind(null,t));let e=(0,n.a)(t,o);(!i||i<e||isNaN(+e))&&(i=e)}),(0,r.w)(o,i||NaN)}},21391:(t,e,i)=>{"use strict";i.d(e,{N:()=>h});var r=i(25703),n=i(84423),o=i(95490),s=i(7239),l=i(19315),a=i(89447);function h(t,e){let i=(0,a.a)(t,null==e?void 0:e.in);return Math.round((+(0,n.k)(i,e)-+function(t,e){var i,r,a,h,u,c,d,g;let f=(0,o.q)(),p=null!==(g=null!==(d=null!==(c=null!==(u=null==e?void 0:e.firstWeekContainsDate)&&void 0!==u?u:null==e?void 0:null===(r=e.locale)||void 0===r?void 0:null===(i=r.options)||void 0===i?void 0:i.firstWeekContainsDate)&&void 0!==c?c:f.firstWeekContainsDate)&&void 0!==d?d:null===(h=f.locale)||void 0===h?void 0:null===(a=h.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==g?g:1,m=(0,l.h)(t,e),w=(0,s.w)((null==e?void 0:e.in)||t,0);return w.setFullYear(m,0,p),w.setHours(0,0,0,0),(0,n.k)(w,e)}(i,e))/r.my)+1}},21413:(t,e,i)=>{"use strict";i.d(e,{A:()=>n});let r=new Map;function n(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"common";r.has(t)||r.set(t,new Map);let e=r.get(t);return{register:function(t,i){e.set(t,i)},getItem:function(t){return e.get(t)},hasItem:function(t){return e.has(t)},getNames:function(){return[...e.keys()]},getValues:function(){return[...e.values()]}}}},21591:(t,e,i)=>{"use strict";i(26122)},22229:(t,e)=>{"use strict";e.f=Object.getOwnPropertySymbols},22636:(t,e,i)=>{"use strict";i.d(e,{W:()=>n});var r=i(89447);function n(t){return+(0,r.a)(t)}},22739:(t,e,i)=>{"use strict";i.d(e,{i:()=>o});var r=i(7239),n=i(89447);function o(t,e,i){let o=(0,n.a)(t,null==i?void 0:i.in);return isNaN(+o)?(0,r.w)((null==i?void 0:i.in)||t,NaN):(o.setFullYear(e),o)}},23068:(t,e,i)=>{"use strict";i.d(e,{f:()=>o});var r=i(99026),n=i(89447);function o(t){return!(!(0,r.$)(t)&&"number"!=typeof t||isNaN(+(0,n.a)(t)))}},23544:(t,e,i)=>{"use strict";let r;function n(t){return window.requestAnimationFrame(t)}function o(t){window.cancelAnimationFrame(t)}function s(){return"ontouchstart"in window}function l(){return"undefined"!=typeof window}function a(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r||(r="object"==typeof Intl?new Intl.Collator(t,e).compare:"function"==typeof String.prototype.localeCompare?(t,e)=>`${t}`.localeCompare(e):(t,e)=>t===e?0:t>e?-1:1)}i.r(e),i.d(e,{cancelAnimationFrame:()=>o,getComparisonFunction:()=>a,isCSR:()=>l,isTouchSupported:()=>s,requestAnimationFrame:()=>n})},23910:(t,e,i)=>{"use strict";i.d(e,{p:()=>n});var r=i(89447);function n(t,e){return(0,r.a)(t,null==e?void 0:e.in).getDate()}},23967:(t,e,i)=>{"use strict";i.d(e,{_:()=>P}),i(41658),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(29954),i(75036);var r=i(95061),n=i(57496),o=i(44065),s=i(82505),l=i(88215),a=i(12522),h=i(10932);let u=new Map([["hiding",o.o],["index",s.n],["linkedPhysicalIndexToValue",l.z],["physicalIndexToValue",a._],["trimming",h.q]]);var c=i(33774);i(19398);var d=i(41973),g=i(78887);function f(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class p extends d.p{constructor(t,e){super(),f(this,"mergedValuesCache",[]),f(this,"aggregationFunction",void 0),f(this,"fallbackValue",void 0),this.aggregationFunction=t,this.fallbackValue=e}getMergedValues(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!0===t)return this.mergedValuesCache;if(0===this.getLength())return[];let e=(0,r.arrayMap)(this.get(),t=>t.getValues()),i=[],n=(0,g.isDefined)(e[0])&&e[0].length||0;for(let t=0;t<n;t+=1){let r=[];for(let i=0;i<this.getLength();i+=1)r.push(e[i][t]);i.push(r)}return(0,r.arrayMap)(i,this.aggregationFunction)}getMergedValueAtIndex(t,e){let i=this.getMergedValues(e)[t];return(0,g.isDefined)(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}var m=i(81174),w=i(19857);function y(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}i(20775);var b=new WeakMap;class C{constructor(){!function(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}(this,b,[])}subscribe(t){return this.addLocalHook("change",t),this._write(b.get(y(b,this))),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(t){return t.length>0&&this.runLocalHooks("change",t),this}_writeInitialChanges(t){b.set(y(b,this),t)}}function S(t,e){let i=[],r=0,n=0;for(;r<t.length&&n<e.length;r++,n++)t[r]!==e[n]&&i.push({op:"replace",index:n,oldValue:t[r],newValue:e[n]});for(;r<e.length;r++)i.push({op:"insert",index:r,oldValue:void 0,newValue:e[r]});for(;n<t.length;n++)i.push({op:"remove",index:n,oldValue:t[n],newValue:void 0});return i}function E(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function R(t,e){return t.get(x(t,e))}function T(t,e,i){return t.set(x(t,e),i),i}function x(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,w.mixin)(C,m.A);var M=new WeakMap,k=new WeakMap,O=new WeakMap,I=new WeakMap,A=new WeakMap;class N{constructor(){let{initialIndexValue:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};E(this,M,new Set),E(this,k,[]),E(this,O,[]),E(this,I,!1),E(this,A,!1),T(A,this,null!=t&&t)}createObserver(){let t=new C;return R(M,this).add(t),t.addLocalHook("unsubscribe",()=>{R(M,this).delete(t)}),t._writeInitialChanges(S(R(k,this),R(O,this))),t}emit(t){let e=R(O,this);R(I,this)&&R(k,this).length===t.length||(0===t.length?t=Array(e.length).fill(R(A,this)):T(k,this,Array(t.length).fill(R(A,this))),R(I,this)||(T(I,this,!0),e=R(k,this)));let i=S(e,t);R(M,this).forEach(t=>t._write(i)),T(O,this,t)}}function H(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class P{constructor(){H(this,"indexesSequence",new n.K),H(this,"trimmingMapsCollection",new p(t=>t.some(t=>!0===t),!1)),H(this,"hidingMapsCollection",new p(t=>t.some(t=>!0===t),!1)),H(this,"variousMapsCollection",new d.p),H(this,"hidingChangesObservable",new N({initialIndexValue:!1})),H(this,"notTrimmedIndexesCache",[]),H(this,"notHiddenIndexesCache",[]),H(this,"isBatched",!1),H(this,"indexesSequenceChanged",!1),H(this,"indexesChangeSource",void 0),H(this,"trimmedIndexesChanged",!1),H(this,"hiddenIndexesChanged",!1),H(this,"renderablePhysicalIndexesCache",[]),H(this,"fromPhysicalToVisualIndexesCache",new Map),H(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",t=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",t=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",t,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",t=>{this.runLocalHooks("change",t,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(t){if("hiding"!==t)throw Error(`Unsupported index map type "${t}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(t,e,i){return this.registerMap(t,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!u.has(t))throw Error(`The provided map type ("${t}") does not exist.`);return new(u.get(t))(e)}(e,i))}registerMap(t,e){if(this.trimmingMapsCollection.get(t)||this.hidingMapsCollection.get(t)||this.variousMapsCollection.get(t))throw Error(`Map with name "${t}" has been already registered.`);e instanceof h.q?this.trimmingMapsCollection.register(t,e):e instanceof o.o?this.hidingMapsCollection.register(t,e):this.variousMapsCollection.register(t,e);let i=this.getNumberOfIndexes();return i>0&&e.init(i),e}unregisterMap(t){this.trimmingMapsCollection.unregister(t),this.hidingMapsCollection.unregister(t),this.variousMapsCollection.unregister(t)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(t){let e=this.notTrimmedIndexesCache[t];return(0,g.isDefined)(e)?e:null}getPhysicalFromRenderableIndex(t){let e=this.renderablePhysicalIndexesCache[t];return(0,g.isDefined)(e)?e:null}getVisualFromPhysicalIndex(t){let e=this.fromPhysicalToVisualIndexesCache.get(t);return(0,g.isDefined)(e)?e:null}getVisualFromRenderableIndex(t){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(t))}getRenderableFromVisualIndex(t){let e=this.fromVisualToRenderableIndexesCache.get(t);return(0,g.isDefined)(e)?e:null}getNearestNotHiddenIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===this.getPhysicalFromVisualIndex(t))return null;if(this.fromVisualToRenderableIndexesCache.has(t))return t;let r=Array.from(this.fromVisualToRenderableIndexesCache.keys()),n=-1;return -1===(n=e>0?r.findIndex(e=>e>t):r.reverse().findIndex(e=>e<t))?i?this.getNearestNotHiddenIndex(t,-e,!1):null:(0,r[n])}initToLength(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...Array(t).keys()],this.notHiddenIndexesCache=[...Array(t).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(t),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(t),this.variousMapsCollection.initEvery(t),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(t){let e=this.getNumberOfIndexes();if(t<e){let e=[...Array(this.getNumberOfIndexes()-t).keys()].map(e=>e+t);this.removeIndexes(e)}else this.insertIndexes(e,t-e)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(t){void 0===this.indexesChangeSource&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(t),"update"===this.indexesChangeSource&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(t=>!1===this.isTrimmed(t))}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.notHiddenIndexesCache:this.getIndexesSequence().filter(t=>!1===this.isHidden(t))}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];return!0===t?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(t=>!1===this.isHidden(t))}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(t,e){"number"==typeof t&&(t=[t]);let i=(0,r.arrayMap)(t,t=>this.getPhysicalFromVisualIndex(t)),n=this.getNotTrimmedIndexesLength(),o=t.length,s=(0,c.H)(this.getIndexesSequence(),i),l=s.filter(t=>!1===this.isTrimmed(t)),a=s.indexOf(l[l.length-1])+1;if(e+o<n){let t=l[e];a=s.indexOf(t)}this.indexesChangeSource="move",this.setIndexesSequence((0,c.N)(s,a,i)),this.indexesChangeSource=void 0}isTrimmed(t){return this.trimmingMapsCollection.getMergedValueAtIndex(t)}isHidden(t){return this.hidingMapsCollection.getMergedValueAtIndex(t)}insertIndexes(t,e){let i=this.getNotTrimmedIndexes()[t],n=(0,g.isDefined)(i)?i:this.getNumberOfIndexes(),o=this.getIndexesSequence().includes(i)?this.getIndexesSequence().indexOf(i):this.getNumberOfIndexes(),s=(0,r.arrayMap)(Array(e).fill(n),(t,e)=>t+e);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(o,s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.insertToEvery(o,s),this.hidingMapsCollection.insertToEvery(o,s),this.variousMapsCollection.insertToEvery(o,s),this.resumeOperations()}removeIndexes(t){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(t),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(t),this.hidingMapsCollection.removeFromEvery(t),this.variousMapsCollection.removeFromEvery(t),this.resumeOperations()}updateCache(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(!0===t||!1===this.isBatched&&!0===e)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){let t=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromVisualIndex(e);this.fromPhysicalToVisualIndexesCache.set(t,e)}}cacheFromVisualToRenderableIndexes(){let t=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let e=0;e<t;e+=1){let t=this.getPhysicalFromRenderableIndex(e),i=this.getVisualFromPhysicalIndex(t);this.fromVisualToRenderableIndexesCache.set(i,e)}}}(0,w.mixin)(P,m.A)},24113:(t,e,i)=>{"use strict";i.d(e,{nF:()=>d,bN:()=>b,W5:()=>S,E9:()=>E,Mj:()=>R,Lp:()=>C,eb:()=>y});var r=i(19857),n=i(95061),o=i(78887),s=i(84536),l=i(21413);let{register:a,getValues:h}=(0,l.A)("phraseFormatters");a("pluralize",function(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t});var u=i(95696);let c={languageCode:"en-US",[u.CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[u.CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[u.CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[u.CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[u.CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[u.CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[u.CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[u.CONTEXTMENU_ITEMS_UNDO]:"Undo",[u.CONTEXTMENU_ITEMS_REDO]:"Redo",[u.CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[u.CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[u.CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[u.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[u.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[u.CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[u.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[u.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[u.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[u.CONTEXTMENU_ITEMS_BORDERS]:"Borders",[u.CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[u.CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[u.CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[u.CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[u.CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[u.CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[u.CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[u.CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[u.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[u.CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[u.CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[u.CONTEXTMENU_ITEMS_COPY]:"Copy",[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[u.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[u.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[u.CONTEXTMENU_ITEMS_CUT]:"Cut",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[u.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[u.CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[u.CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[u.CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[u.CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[u.FILTERS_CONDITIONS_NONE]:"None",[u.FILTERS_CONDITIONS_EMPTY]:"Is empty",[u.FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[u.FILTERS_CONDITIONS_EQUAL]:"Is equal to",[u.FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[u.FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[u.FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[u.FILTERS_CONDITIONS_CONTAINS]:"Contains",[u.FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[u.FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[u.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[u.FILTERS_CONDITIONS_LESS_THAN]:"Less than",[u.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[u.FILTERS_CONDITIONS_BETWEEN]:"Is between",[u.FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[u.FILTERS_CONDITIONS_AFTER]:"After",[u.FILTERS_CONDITIONS_BEFORE]:"Before",[u.FILTERS_CONDITIONS_TODAY]:"Today",[u.FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[u.FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[u.FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[u.FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[u.FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[u.FILTERS_LABELS_CONJUNCTION]:"And",[u.FILTERS_LABELS_DISJUNCTION]:"Or",[u.FILTERS_BUTTONS_SELECT_ALL]:"Select all",[u.FILTERS_BUTTONS_CLEAR]:"Clear",[u.FILTERS_BUTTONS_OK]:"OK",[u.FILTERS_BUTTONS_CANCEL]:"Cancel",[u.FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[u.FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[u.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[u.CHECKBOX_CHECKED]:"Checked",[u.CHECKBOX_UNCHECKED]:"Unchecked"},d=u,g=c.languageCode,{register:f,getItem:p,hasItem:m,getValues:w}=(0,l.A)("languagesDictionaries");function y(t,e){var i,n;let o=t,l=e;return(0,r.isObject)(t)&&(o=(l=t).languageCode),i=o,n=l,i!==g&&(0,s.DW)(n,p(g)),f(o,(0,r.deepClone)(l)),(0,r.deepClone)(l)}function b(t){return m(t)?(0,r.deepClone)(p(t)):null}function C(t){return m(t)}function S(){return w()}function E(t,e,i){var r,s;let l,a=b(t);if(null===a)return null;let u=a[e];if((0,o.isUndefined)(u))return null;let c=(r=u,s=i,l=r,(0,n.arrayEach)(h(),t=>{l=t(r,s)}),l);return Array.isArray(c)?c[0]:c}function R(t){let e=(0,s.Jn)(t);return!m(e)&&(e=g,(0,s.A$)(t)),e}y(c)},24201:(t,e,i)=>{"use strict";var r=i(14412),n=i(24851),o=i(32138);t.exports=r?function(t,e,i){return n.f(t,e,o(1,i))}:function(t,e,i){return t[e]=i,t}},24696:(t,e,i)=>{"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{Z:()=>o}),i(41658),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(20775);var n=new WeakMap;class o{constructor(t){r(this,"metaManager",void 0),r(this,"usageTracker",new Set),r(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(t){if(this.metaManager.hot.isRtl()&&"fixedColumnsLeft"===t)throw Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),function(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}(this,n,(t,e,i)=>{if(!i)throw Error(`The \`${t}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=t,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((t,e)=>{let{initOnly:i,target:r,onChange:o}=t,s="string"==typeof r,l=s?r:e,a=`_${l}`;if(this.metaManager.globalMeta.meta[a]=this.metaManager.globalMeta.meta[l],o)this.installPropWatcher(e,a,o),s&&this.installPropWatcher(r,a,o);else if(i)this.installPropWatcher(e,a,n.get(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(n,this))),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(e)})}installPropWatcher(t,e,i){let r=this;Object.defineProperty(this.metaManager.globalMeta.meta,t,{get(){return this[e]},set(n){let o=!r.usageTracker.has(t);r.usageTracker.add(t),i.call(r,t,n,o),this[e]=n},enumerable:!0,configurable:!0})}}},24711:(t,e,i)=>{"use strict";var r=i(14412),n=i(56963),o=i(15567);t.exports=!r&&!n(function(){return 7!==Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a})},24771:(t,e,i)=>{"use strict";var r=i(94272),n=i(16954).has,o=i(57580),s=i(15743),l=i(69905),a=i(6497),h=i(76093);t.exports=function(t){var e=r(this),i=s(t);if(o(e)<=i.size)return!1!==l(e,function(t){if(i.includes(t))return!1},!0);var u=i.getIterator();return!1!==a(u,function(t){if(n(e,t))return h(u,"normal",!1)})}},24851:(t,e,i)=>{"use strict";var r=i(14412),n=i(24711),o=i(9234),s=i(8883),l=i(64409),a=TypeError,h=Object.defineProperty,u=Object.getOwnPropertyDescriptor,c="enumerable",d="configurable",g="writable";e.f=r?o?function(t,e,i){if(s(t),e=l(e),s(i),"function"==typeof t&&"prototype"===e&&"value"in i&&g in i&&!i[g]){var r=u(t,e);r&&r[g]&&(t[e]=i.value,i={configurable:d in i?i[d]:r[d],enumerable:c in i?i[c]:r[c],writable:!1})}return h(t,e,i)}:h:function(t,e,i){if(s(t),e=l(e),s(i),n)try{return h(t,e,i)}catch(t){}if("get"in i||"set"in i)throw new a("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},25126:(t,e,i)=>{"use strict";i.d(e,{Jt:()=>a,OS:()=>s});var r,n=i(12115);function o(){let t=navigator.userAgentData;return t&&Array.isArray(t.brands)?t.brands.map(t=>{let{brand:e,version:i}=t;return e+"/"+i}).join(" "):navigator.userAgent}var s="undefined"!=typeof document?n.useLayoutEffect:function(){};let l={...r||(r=i.t(n,2))}.useInsertionEffect||(t=>t());function a(t){let e=n.useRef(()=>{});return l(()=>{e.current=t}),n.useCallback(function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return null==e.current?void 0:e.current(...i)},[])}let h=()=>({getShadowRoot:!0,displayCheck:"function"==typeof ResizeObserver&&ResizeObserver.toString().includes("[native code]")?"full":"none"})},25645:(t,e,i)=>{"use strict";i.d(e,{e:()=>n});var r=i(48882);function n(t,e,i){return(0,r.P)(t,12*e,i)}},25703:(t,e,i)=>{"use strict";i.d(e,{Cg:()=>o,_P:()=>a,_m:()=>l,my:()=>r,s0:()=>s,w4:()=>n});let r=6048e5,n=864e5,o=6e4,s=36e5,l=1e3,a=Symbol.for("constructDateFrom")},25737:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("some",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{some:function(t){l(this);try{s(t)}catch(t){h(this,"throw",t)}if(u)return n(u,this,t);var e=a(this),i=0;return o(e,function(e,r){if(t(e,i++))return r()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},26122:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("find",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{find:function(t){l(this);try{s(t)}catch(t){h(this,"throw",t)}if(u)return n(u,this,t);var e=a(this),i=0;return o(e,function(e,r){if(t(e,i++))return r(e)},{IS_RECORD:!0,INTERRUPTED:!0}).result}})},26382:(t,e,i)=>{"use strict";i.d(e,{n:()=>n});var r=i(89447);function n(t,e){return+(0,r.a)(t)==+(0,r.a)(e)}},26464:t=>{!function(){"use strict";var e={928:function(t,e,i){var r=i(322);t.exports=function(t,e,i){var n,o;if(i=i||0,!r(e))return -1;if(Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t,i);for(o=e.length,n=i;i>=0&&n<o;n+=1)if(e[n]===t)return n;return -1}},690:function(t,e,i){var r=i(322),n=i(893),o=i(956);t.exports=function(t,e,i){r(t)?n(t,e,i):o(t,e,i)}},893:function(t){t.exports=function(t,e,i){var r=0,n=t.length;for(i=i||null;r<n&&!1!==e.call(i,t[r],r,t);r+=1);}},956:function(t){t.exports=function(t,e,i){var r;for(r in i=i||null,t)if(t.hasOwnProperty(r)&&!1===e.call(i,t[r],r,t))break}},990:function(t,e,i){var r=i(893);t.exports=function(t){var e;try{e=Array.prototype.slice.call(t)}catch(i){e=[],r(t,function(t){e.push(t)})}return e}},24:function(t,e,i){var r=i(322),n=i(929);t.exports=function(t,e){if(e=(e=r(e)?e.join(" "):e).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),n(t.className.baseVal)){t.className=e;return}t.className.baseVal=e}},204:function(t,e,i){var r=i(690),n=i(928),o=i(902),s=i(24);t.exports=function(t){var e,i=Array.prototype.slice.call(arguments,1),l=t.classList,a=[];if(l){r(i,function(e){t.classList.add(e)});return}(e=o(t))&&(i=[].concat(e.split(/\s+/),i)),r(i,function(t){0>n(t,a)&&a.push(t)}),s(t,a)}},522:function(t,e,i){var r=i(758),n=i(690);t.exports=function(t,e,i){var o=t.style;if(r(e)){o[e]=i;return}n(e,function(t,e){o[e]=t})}},902:function(t,e,i){var r=i(929);t.exports=function(t){return t&&t.className?r(t.className.baseVal)?t.className:t.className.baseVal:""}},714:function(t,e,i){var r=i(928),n=i(902);t.exports=function(t,e){return t.classList?t.classList.contains(e):r(e,n(t).split(/\s+/))>-1}},462:function(t,e,i){var r=i(893),n=i(928),o=i(902),s=i(24);t.exports=function(t){var e,i,l=Array.prototype.slice.call(arguments,1),a=t.classList;if(a){r(l,function(t){a.remove(t)});return}e=o(t).split(/\s+/),i=[],r(e,function(t){0>n(t,l)&&i.push(t)}),s(t,i)}},322:function(t){t.exports=function(t){return t instanceof Array}},294:function(t){t.exports=function(t){return t instanceof Function}},758:function(t){t.exports=function(t){return"string"==typeof t||t instanceof String}},929:function(t){t.exports=function(t){return void 0===t}}},i={};function r(t){var n=i[t];if(void 0!==n)return n.exports;var o=i[t]={exports:{}};return e[t](o,o.exports,r),o.exports}r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,{a:e}),e},r.d=function(t,e){for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)};var n={};!function(){r.d(n,{default:function(){return M}});var t=r(294),e=r.n(t),i=r(758),o=r.n(i),s=function(t,e){for(var i=0,r=e.length,n=t.length;i<r;i++,n++)t[n]=e[i];return t};function l(t,e,i){var r,n=e.pmView,l=[];return(r=[],t.descendants(function(t,e){t.isBlock&&"codeBlock"===t.type.name&&r.push({node:t,pos:e})}),r).forEach(function(t){var e=t.pos,r=t.node,a=r.attrs.language,h=i.languages[a],u=function t(e){return e.reduce(function(e,i){return e.concat(Array.isArray(i)?t(i):i)},[])}(function t(e,i){return(void 0===i&&(i=[]),o()(e))?[{text:e,classes:i}]:e.map(function(e){var r=e.type,n=e.alias,l=[],a=[];r&&(l=["token",r]),n&&(a=o()(n)?[n]:n);var h=s(s(s([],i),l),a);return o()(e)?{text:e,classes:h}:t(e.content,h)})}(h?i.tokenize(r.textContent,h):[])),c=e+1;u.forEach(function(t){var e=t.text,i=t.classes,r=c,o=r+e.length;c=o;var s=i.join(" "),a=n.Decoration.inline(r,o,{class:s});s.length&&l.push(a)})}),n.DecorationSet.create(t,l)}var a=r(204),h=r.n(a);function u(t){return parseInt(t,10)}function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return t.map(function(t){return"toastui-editor-"+t}).join(" ")}var d=r(522),g=r.n(d),f=r(462),p=r.n(f),m=r(714),w=r.n(m),y=r(990),b=r.n(y),C=r(928),S=r.n(C),E="data-language",R=function(){function t(t,e,i){var r=this;this.buttons=[],this.prevStoredLanguage="",this.onSelectToggleButton=function(t){var e,i,n,o,s=getComputedStyle(t.target,":after"),l=t.offsetX,a=t.offsetY;e=u(s.left),i=u(s.top),n=u(s.width)+u(s.paddingLeft)+u(s.paddingRight),o=u(s.height)+u(s.paddingTop)+u(s.paddingBottom),l>=e&&l<=e+n&&a>=i&&a<=i+o&&(t.preventDefault(),r.toggleFocus())},this.onSelectLanguageButtons=function(t){var e=t.target.getAttribute(E);e&&r.selectLanguage(e)},this.handleKeydown=function(t){var e=t.key;"ArrowUp"===e?(r.selectPrevLanguage(),t.preventDefault()):"ArrowDown"===e?(r.selectNextLanguage(),t.preventDefault()):"Enter"===e||"Tab"===e?(r.storeInputLanguage(),t.preventDefault()):r.hideList()},this.showLangugaeSelectBox=function(t,e){var i=t.top,n=t.right;e&&r.setLanguage(e),r.show();var o=r.input.parentElement.getBoundingClientRect().width;g()(r.wrapper,{top:i+10+"px",left:n-o-10+"px"}),r.toggleFocus()},this.rootEl=t,this.eventEmitter=e,this.languages=i,this.createElement(),this.bindDOMEvent(),this.bindEvent()}return t.prototype.createElement=function(){this.wrapper=document.createElement("div"),h()(this.wrapper,c("code-block-language")),this.createInputElement(),this.createLanguageListElement(),this.rootEl.appendChild(this.wrapper),this.hide()},t.prototype.createInputElement=function(){var t=document.createElement("span");h()(t,c("code-block-language-input"));var e=document.createElement("input");e.type="text",e.setAttribute("maxlength","20"),this.input=e,t.appendChild(this.input),this.wrapper.appendChild(t)},t.prototype.createLanguageListElement=function(){this.list=document.createElement("div"),h()(this.list,c("code-block-language-list"));var t=document.createElement("div");h()(t,"buttons"),t.innerHTML=this.languages.map(function(t){return'<button type="button" data-language="'+t+'">'+t+"</button>"}).join(""),this.buttons=b()(t.children),this.list.appendChild(t),this.wrapper.appendChild(this.list),this.activateButtonByIndex(0),this.hideList()},t.prototype.bindDOMEvent=function(){var t=this;this.wrapper.addEventListener("mousedown",this.onSelectToggleButton),this.input.addEventListener("keydown",this.handleKeydown),this.input.addEventListener("focus",function(){return t.activateSelectBox()}),this.input.addEventListener("blur",function(){return t.inactivateSelectBox()}),this.list.addEventListener("mousedown",this.onSelectLanguageButtons)},t.prototype.bindEvent=function(){this.eventEmitter.listen("showCodeBlockLanguages",this.showLangugaeSelectBox)},t.prototype.activateSelectBox=function(){h()(this.wrapper,"active"),g()(this.list,{display:"block"})},t.prototype.inactivateSelectBox=function(){this.input.value=this.prevStoredLanguage,p()(this.wrapper,"active"),this.hideList()},t.prototype.toggleFocus=function(){w()(this.wrapper,"active")?this.input.blur():this.input.focus()},t.prototype.storeInputLanguage=function(){var t=this.input.value;this.setLanguage(t),this.hideList(),this.eventEmitter.emit("selectLanguage",t)},t.prototype.activateButtonByIndex=function(t){this.currentButton&&p()(this.currentButton,"active"),this.buttons.length&&(this.currentButton=this.buttons[t],this.input.value=this.currentButton.getAttribute(E),h()(this.currentButton,"active"),this.currentButton.scrollIntoView())},t.prototype.selectLanguage=function(t){this.input.value=t,this.storeInputLanguage()},t.prototype.selectPrevLanguage=function(){var t=S()(this.currentButton,this.buttons)-1;t<0&&(t=this.buttons.length-1),this.activateButtonByIndex(t)},t.prototype.selectNextLanguage=function(){var t=S()(this.currentButton,this.buttons)+1;t>=this.buttons.length&&(t=0),this.activateButtonByIndex(t)},t.prototype.hideList=function(){g()(this.list,{display:"none"})},t.prototype.show=function(){g()(this.wrapper,{display:"inline-block"})},t.prototype.hide=function(){g()(this.wrapper,{display:"none"})},t.prototype.setLanguage=function(t){this.prevStoredLanguage=t,this.input.value=t;var e=this.buttons.filter(function(e){return e.getAttribute(E)===t});if(e.length){var i=S()(e[0],this.buttons);this.activateButtonByIndex(i)}},t.prototype.destroy=function(){var t;(t=this.wrapper).parentNode&&t.parentNode.removeChild(t),this.eventEmitter.removeEventHandler("showCodeBlockLanguages",this.showLangugaeSelectBox)},t}(),T=function(){return(T=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)},x=function(){function t(t,i,r,n,o){var s=this;this.node=t,this.view=i,this.getPos=r,this.eventEmitter=n,this.languages=o,this.contentDOM=null,this.languageSelectBox=null,this.onSelectLanguage=function(t){s.languageEditing&&s.changeLanguage(t)},this.onClickEditingButton=function(t){if("none"!==getComputedStyle(t.target,":after").backgroundImage&&e()(s.getPos)){var i=s.view.coordsAtPos(s.getPos());s.openLanguageSelectBox(i)}},this.finishLanguageEditing=function(){s.languageEditing&&s.reset()},this.node=t,this.view=i,this.getPos=r,this.eventEmitter=n,this.languageEditing=!1,this.languages=o,this.createElement(),this.bindDOMEvent(),this.bindEvent()}return t.prototype.createElement=function(){var t=this.node.attrs.language,e=document.createElement("div");e.setAttribute("data-language",t||"text"),h()(e,c("ww-code-block-highlighting"));var i=this.createCodeBlockElement(),r=i.firstChild;t&&(h()(i,"language-"+t),h()(r,"language-"+t)),e.appendChild(i),this.dom=e,this.contentDOM=r},t.prototype.createCodeBlockElement=function(){var t,e,i,r=document.createElement("pre"),n=document.createElement("code"),o=this.node.attrs.language,s=(e=(t=this.node.attrs).htmlAttrs,i=t.classNames,T(T({},e),{class:i?i.join(" "):null}));return o&&n.setAttribute("data-language",o),Object.keys(s).forEach(function(t){s[t]&&r.setAttribute(t,s[t])}),r.appendChild(n),r},t.prototype.bindDOMEvent=function(){this.dom&&(this.dom.addEventListener("click",this.onClickEditingButton),this.view.dom.addEventListener("mousedown",this.finishLanguageEditing),window.addEventListener("resize",this.finishLanguageEditing))},t.prototype.bindEvent=function(){this.eventEmitter.listen("selectLanguage",this.onSelectLanguage),this.eventEmitter.listen("scroll",this.finishLanguageEditing),this.eventEmitter.listen("finishLanguageEditing",this.finishLanguageEditing)},t.prototype.openLanguageSelectBox=function(t){this.languageSelectBox=new R(this.view.dom.parentElement,this.eventEmitter,this.languages),this.eventEmitter.emit("showCodeBlockLanguages",t,this.node.attrs.language),this.languageEditing=!0},t.prototype.changeLanguage=function(t){if(e()(this.getPos)){this.reset();var i=this.getPos(),r=this.view.state.tr;r.setNodeMarkup(i,null,{language:t}),this.view.dispatch(r)}},t.prototype.reset=function(){this.languageSelectBox&&(this.languageSelectBox.destroy(),this.languageSelectBox=null),this.languageEditing=!1},t.prototype.stopEvent=function(){return!0},t.prototype.update=function(t){return!!t.sameMarkup(this.node)&&(this.node=t,!0)},t.prototype.destroy=function(){this.reset(),this.dom&&(this.dom.removeEventListener("click",this.onClickEditingButton),this.view.dom.removeEventListener("mousedown",this.finishLanguageEditing),window.removeEventListener("resize",this.finishLanguageEditing)),this.eventEmitter.removeEventHandler("selectLanguage",this.onSelectLanguage),this.eventEmitter.removeEventHandler("scroll",this.finishLanguageEditing),this.eventEmitter.removeEventHandler("finishLanguageEditing",this.finishLanguageEditing)},t}();window.Prism=window.Prism||{},window.Prism.manual=!0;var M=function(t,i){if(i){var r=t.eventEmitter,n=i.highlighter;r.addEventType("showCodeBlockLanguages"),r.addEventType("selectLanguage"),r.addEventType("finishLanguageEditing");var o=n.languages,s=Object.keys(o).filter(function(t){return!e()(o[t])});return{toHTMLRenderers:{codeBlock:function(t){var e=t.fenceLength,i=t.info,r=i?i.split(/\s+/):[],o=[],s={};e>3&&(s["data-backticks"]=e);var l=t.literal;if(r.length&&r[0].length){var a=r[0];o.push("lang-"+a),s["data-language"]=a;var h=n.languages[a];h&&(l=n.highlight(t.literal,h,a))}return[{type:"openTag",tagName:"pre",classNames:o},{type:"openTag",tagName:"code",attributes:s},{type:"html",content:l},{type:"closeTag",tagName:"code"},{type:"closeTag",tagName:"pre"}]}},wysiwygPlugins:[function(){return new t.pmState.Plugin({state:{init:function(e,i){return l(i.doc,t,n)},apply:function(e,i){return e.docChanged?l(e.doc,t,n):i.map(e.mapping,e.doc)}},props:{decorations:function(t){return this.getState(t)}}})}],wysiwygNodeViews:{codeBlock:function(t,e,i,r){return new x(t,e,i,r,s)}}}}return{}}}(),t.exports=n.default}()},26681:(t,e,i)=>{"use strict";i.d(e,{GP:()=>k});var r=i(8093),n=i(95490),o=i(50007),s=i(67386),l=i(89447),a=i(17519),h=i(71182),u=i(21391),c=i(19315);function d(t,e){let i=Math.abs(t).toString().padStart(e,"0");return(t<0?"-":"")+i}let g={y(t,e){let i=t.getFullYear(),r=i>0?i:1-i;return d("yy"===e?r%100:r,e.length)},M(t,e){let i=t.getMonth();return"M"===e?String(i+1):d(i+1,2)},d:(t,e)=>d(t.getDate(),e.length),a(t,e){let i=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return i.toUpperCase();case"aaa":return i;case"aaaaa":return i[0];default:return"am"===i?"a.m.":"p.m."}},h:(t,e)=>d(t.getHours()%12||12,e.length),H:(t,e)=>d(t.getHours(),e.length),m:(t,e)=>d(t.getMinutes(),e.length),s:(t,e)=>d(t.getSeconds(),e.length),S(t,e){let i=e.length;return d(Math.trunc(t.getMilliseconds()*Math.pow(10,i-3)),e.length)}},f={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},p={G:function(t,e,i){let r=+(t.getFullYear()>0);switch(e){case"G":case"GG":case"GGG":return i.era(r,{width:"abbreviated"});case"GGGGG":return i.era(r,{width:"narrow"});default:return i.era(r,{width:"wide"})}},y:function(t,e,i){if("yo"===e){let e=t.getFullYear();return i.ordinalNumber(e>0?e:1-e,{unit:"year"})}return g.y(t,e)},Y:function(t,e,i,r){let n=(0,c.h)(t,r),o=n>0?n:1-n;return"YY"===e?d(o%100,2):"Yo"===e?i.ordinalNumber(o,{unit:"year"}):d(o,e.length)},R:function(t,e){return d((0,h.p)(t),e.length)},u:function(t,e){return d(t.getFullYear(),e.length)},Q:function(t,e,i){let r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return d(r,2);case"Qo":return i.ordinalNumber(r,{unit:"quarter"});case"QQQ":return i.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return i.quarter(r,{width:"narrow",context:"formatting"});default:return i.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,i){let r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return d(r,2);case"qo":return i.ordinalNumber(r,{unit:"quarter"});case"qqq":return i.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return i.quarter(r,{width:"narrow",context:"standalone"});default:return i.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,i){let r=t.getMonth();switch(e){case"M":case"MM":return g.M(t,e);case"Mo":return i.ordinalNumber(r+1,{unit:"month"});case"MMM":return i.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return i.month(r,{width:"narrow",context:"formatting"});default:return i.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,i){let r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return d(r+1,2);case"Lo":return i.ordinalNumber(r+1,{unit:"month"});case"LLL":return i.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return i.month(r,{width:"narrow",context:"standalone"});default:return i.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,i,r){let n=(0,u.N)(t,r);return"wo"===e?i.ordinalNumber(n,{unit:"week"}):d(n,e.length)},I:function(t,e,i){let r=(0,a.s)(t);return"Io"===e?i.ordinalNumber(r,{unit:"week"}):d(r,e.length)},d:function(t,e,i){return"do"===e?i.ordinalNumber(t.getDate(),{unit:"date"}):g.d(t,e)},D:function(t,e,i){let r=function(t,e){let i=(0,l.a)(t,void 0);return(0,o.m)(i,(0,s.D)(i))+1}(t);return"Do"===e?i.ordinalNumber(r,{unit:"dayOfYear"}):d(r,e.length)},E:function(t,e,i){let r=t.getDay();switch(e){case"E":case"EE":case"EEE":return i.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return i.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(r,{width:"short",context:"formatting"});default:return i.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,i,r){let n=t.getDay(),o=(n-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(o);case"ee":return d(o,2);case"eo":return i.ordinalNumber(o,{unit:"day"});case"eee":return i.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return i.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(n,{width:"short",context:"formatting"});default:return i.day(n,{width:"wide",context:"formatting"})}},c:function(t,e,i,r){let n=t.getDay(),o=(n-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(o);case"cc":return d(o,e.length);case"co":return i.ordinalNumber(o,{unit:"day"});case"ccc":return i.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return i.day(n,{width:"narrow",context:"standalone"});case"cccccc":return i.day(n,{width:"short",context:"standalone"});default:return i.day(n,{width:"wide",context:"standalone"})}},i:function(t,e,i){let r=t.getDay(),n=0===r?7:r;switch(e){case"i":return String(n);case"ii":return d(n,e.length);case"io":return i.ordinalNumber(n,{unit:"day"});case"iii":return i.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return i.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return i.day(r,{width:"short",context:"formatting"});default:return i.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,i){let r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return i.dayPeriod(r,{width:"narrow",context:"formatting"});default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(t,e,i){let r,n=t.getHours();switch(r=12===n?f.noon:0===n?f.midnight:n/12>=1?"pm":"am",e){case"b":case"bb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return i.dayPeriod(r,{width:"narrow",context:"formatting"});default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(t,e,i){let r,n=t.getHours();switch(r=n>=17?f.evening:n>=12?f.afternoon:n>=4?f.morning:f.night,e){case"B":case"BB":case"BBB":return i.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return i.dayPeriod(r,{width:"narrow",context:"formatting"});default:return i.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(t,e,i){if("ho"===e){let e=t.getHours()%12;return 0===e&&(e=12),i.ordinalNumber(e,{unit:"hour"})}return g.h(t,e)},H:function(t,e,i){return"Ho"===e?i.ordinalNumber(t.getHours(),{unit:"hour"}):g.H(t,e)},K:function(t,e,i){let r=t.getHours()%12;return"Ko"===e?i.ordinalNumber(r,{unit:"hour"}):d(r,e.length)},k:function(t,e,i){let r=t.getHours();return(0===r&&(r=24),"ko"===e)?i.ordinalNumber(r,{unit:"hour"}):d(r,e.length)},m:function(t,e,i){return"mo"===e?i.ordinalNumber(t.getMinutes(),{unit:"minute"}):g.m(t,e)},s:function(t,e,i){return"so"===e?i.ordinalNumber(t.getSeconds(),{unit:"second"}):g.s(t,e)},S:function(t,e){return g.S(t,e)},X:function(t,e,i){let r=t.getTimezoneOffset();if(0===r)return"Z";switch(e){case"X":return w(r);case"XXXX":case"XX":return y(r);default:return y(r,":")}},x:function(t,e,i){let r=t.getTimezoneOffset();switch(e){case"x":return w(r);case"xxxx":case"xx":return y(r);default:return y(r,":")}},O:function(t,e,i){let r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+m(r,":");default:return"GMT"+y(r,":")}},z:function(t,e,i){let r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+m(r,":");default:return"GMT"+y(r,":")}},t:function(t,e,i){return d(Math.trunc(+t/1e3),e.length)},T:function(t,e,i){return d(+t,e.length)}};function m(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=t>0?"-":"+",r=Math.abs(t),n=Math.trunc(r/60),o=r%60;return 0===o?i+String(n):i+String(n)+e+d(o,2)}function w(t,e){return t%60==0?(t>0?"-":"+")+d(Math.abs(t)/60,2):y(t,e)}function y(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=Math.abs(t);return(t>0?"-":"+")+d(Math.trunc(i/60),2)+e+d(i%60,2)}var b=i(51308),C=i(40861),S=i(23068);let E=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,R=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,T=/^'([^]*?)'?$/,x=/''/g,M=/[a-zA-Z]/;function k(t,e,i){var o,s,a,h,u,c,d,g,f,m,w,y,k,O,I,A,N,H;let P=(0,n.q)(),_=null!==(m=null!==(f=null==i?void 0:i.locale)&&void 0!==f?f:P.locale)&&void 0!==m?m:r.c,D=null!==(O=null!==(k=null!==(y=null!==(w=null==i?void 0:i.firstWeekContainsDate)&&void 0!==w?w:null==i?void 0:null===(s=i.locale)||void 0===s?void 0:null===(o=s.options)||void 0===o?void 0:o.firstWeekContainsDate)&&void 0!==y?y:P.firstWeekContainsDate)&&void 0!==k?k:null===(h=P.locale)||void 0===h?void 0:null===(a=h.options)||void 0===a?void 0:a.firstWeekContainsDate)&&void 0!==O?O:1,L=null!==(H=null!==(N=null!==(A=null!==(I=null==i?void 0:i.weekStartsOn)&&void 0!==I?I:null==i?void 0:null===(c=i.locale)||void 0===c?void 0:null===(u=c.options)||void 0===u?void 0:u.weekStartsOn)&&void 0!==A?A:P.weekStartsOn)&&void 0!==N?N:null===(g=P.locale)||void 0===g?void 0:null===(d=g.options)||void 0===d?void 0:d.weekStartsOn)&&void 0!==H?H:0,F=(0,l.a)(t,null==i?void 0:i.in);if(!(0,S.f)(F))throw RangeError("Invalid time value");let V=e.match(R).map(t=>{let e=t[0];return"p"===e||"P"===e?(0,b.m[e])(t,_.formatLong):t}).join("").match(E).map(t=>{if("''"===t)return{isToken:!1,value:"'"};let e=t[0];if("'"===e)return{isToken:!1,value:function(t){let e=t.match(T);return e?e[1].replace(x,"'"):t}(t)};if(p[e])return{isToken:!0,value:t};if(e.match(M))throw RangeError("Format string contains an unescaped latin alphabet character `"+e+"`");return{isToken:!1,value:t}});_.localize.preprocessor&&(V=_.localize.preprocessor(F,V));let W={firstWeekContainsDate:D,weekStartsOn:L,locale:_};return V.map(r=>{if(!r.isToken)return r.value;let n=r.value;return(!(null==i?void 0:i.useAdditionalWeekYearTokens)&&(0,C.xM)(n)||!(null==i?void 0:i.useAdditionalDayOfYearTokens)&&(0,C.ef)(n))&&(0,C.Ss)(n,e,String(t)),(0,p[n[0]])(F,n,_.localize,W)}).join("")}},27226:(t,e,i)=>{"use strict";var r=i(94272),n=i(16954),o=i(71310),s=i(57580),l=i(15743),a=i(69905),h=i(6497),u=n.has,c=n.remove;t.exports=function(t){var e=r(this),i=l(t),n=o(e);return s(e)<=i.size?a(e,function(t){i.includes(t)&&c(n,t)}):h(i.getIterator(),function(t){u(n,t)&&c(n,t)}),n}},27643:(t,e,i)=>{"use strict";var r=i(80763);t.exports=function(t,e){return void 0===t?arguments.length<2?"":e:r(t)}},27704:(t,e,i)=>{"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i.d(e,{C:()=>n}),i(41658),i(12252),i(20775);class n{constructor(t){r(this,"calculationTypes",[]),r(this,"calculationResults",new Map),this.calculationTypes=t}_initialize(t){this.calculationTypes.forEach(e=>{let[i,r]=e;this.calculationResults.set(i,r),r.initialize(t)})}_process(t,e){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(t,e)})}_finalize(t){this.calculationTypes.forEach(e=>{let[,i]=e;return i.finalize(t)})}getResultsFor(t){return this.calculationResults.get(t)}}},27764:(t,e,i)=>{"use strict";var r=i(40392),n=i(99365),o=i(85592),s=i(7107)("toStringTag"),l=Object,a="Arguments"===o(function(){return arguments}()),h=function(t,e){try{return t[e]}catch(t){}};t.exports=r?o:function(t){var e,i,r;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=h(e=l(t),s))?i:a?o(e):"Object"===(r=o(e))&&n(e.callee)?"Arguments":r}},27981:(t,e,i)=>{"use strict";i.d(e,{a:()=>n});var r=i(89447);function n(t,e){let i=(0,r.a)(t,null==e?void 0:e.in),n=i.getMonth();return i.setMonth(n-n%3,1),i.setHours(0,0,0,0),i}},28060:(t,e,i)=>{"use strict";var r=i(42620),n=i(53469),o=i(85592),s=function(t){return n.slice(0,t.length)===t};t.exports=s("Bun/")?"BUN":s("Cloudflare-Workers")?"CLOUDFLARE":s("Deno/")?"DENO":s("Node.js/")?"NODE":r.Bun&&"string"==typeof Bun.version?"BUN":r.Deno&&"object"==typeof Deno.version?"DENO":"process"===o(r.process)?"NODE":r.window&&r.document?"BROWSER":"REST"},28738:(t,e,i)=>{"use strict";i.d(e,{qg:()=>tb});var r=i(8093),n=i(51308),o=i(40861),s=i(7239),l=i(95490),a=i(89447);class h{validate(t,e){return!0}constructor(){this.subPriority=0}}class u extends h{validate(t,e){return this.validateValue(t,this.value,e)}set(t,e,i){return this.setValue(t,e,this.value,i)}constructor(t,e,i,r,n){super(),this.value=t,this.validateValue=e,this.setValue=i,this.priority=r,n&&(this.subPriority=n)}}class c extends h{set(t,e){return e.timestampIsSet?t:(0,s.w)(t,function(t,e){var i,r;let n="function"==typeof(i=e)&&(null===(r=i.prototype)||void 0===r?void 0:r.constructor)===i?new e(0):(0,s.w)(e,0);return n.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),n}(t,this.context))}constructor(t,e){super(),this.priority=10,this.subPriority=-1,this.context=t||(t=>(0,s.w)(e,t))}}class d{run(t,e,i,r){let n=this.parse(t,e,i,r);return n?{setter:new u(n.value,this.validate,this.set,this.priority,this.subPriority),rest:n.rest}:null}validate(t,e,i){return!0}}class g extends d{parse(t,e,i){switch(e){case"G":case"GG":case"GGG":return i.era(t,{width:"abbreviated"})||i.era(t,{width:"narrow"});case"GGGGG":return i.era(t,{width:"narrow"});default:return i.era(t,{width:"wide"})||i.era(t,{width:"abbreviated"})||i.era(t,{width:"narrow"})}}set(t,e,i){return e.era=i,t.setFullYear(i,0,1),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=140,this.incompatibleTokens=["R","u","t","T"]}}var f=i(25703);let p={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},m={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function w(t,e){return t?{value:e(t.value),rest:t.rest}:t}function y(t,e){let i=e.match(t);return i?{value:parseInt(i[0],10),rest:e.slice(i[0].length)}:null}function b(t,e){let i=e.match(t);if(!i)return null;if("Z"===i[0])return{value:0,rest:e.slice(1)};let r="+"===i[1]?1:-1,n=i[2]?parseInt(i[2],10):0,o=i[3]?parseInt(i[3],10):0,s=i[5]?parseInt(i[5],10):0;return{value:r*(n*f.s0+o*f.Cg+s*f._m),rest:e.slice(i[0].length)}}function C(t){return y(p.anyDigitsSigned,t)}function S(t,e){switch(t){case 1:return y(p.singleDigit,e);case 2:return y(p.twoDigits,e);case 3:return y(p.threeDigits,e);case 4:return y(p.fourDigits,e);default:return y(RegExp("^\\d{1,"+t+"}"),e)}}function E(t,e){switch(t){case 1:return y(p.singleDigitSigned,e);case 2:return y(p.twoDigitsSigned,e);case 3:return y(p.threeDigitsSigned,e);case 4:return y(p.fourDigitsSigned,e);default:return y(RegExp("^-?\\d{1,"+t+"}"),e)}}function R(t){switch(t){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function T(t,e){let i,r=e>0,n=r?e:1-e;if(n<=50)i=t||100;else{let e=n+50;i=t+100*Math.trunc(e/100)-100*(t>=e%100)}return r?i:1-i}function x(t){return t%400==0||t%4==0&&t%100!=0}class M extends d{parse(t,e,i){let r=t=>({year:t,isTwoDigitYear:"yy"===e});switch(e){case"y":return w(S(4,t),r);case"yo":return w(i.ordinalNumber(t,{unit:"year"}),r);default:return w(S(e.length,t),r)}}validate(t,e){return e.isTwoDigitYear||e.year>0}set(t,e,i){let r=t.getFullYear();if(i.isTwoDigitYear){let e=T(i.year,r);return t.setFullYear(e,0,1),t.setHours(0,0,0,0),t}let n="era"in e&&1!==e.era?1-i.year:i.year;return t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=130,this.incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"]}}var k=i(19315),O=i(84423);class I extends d{parse(t,e,i){let r=t=>({year:t,isTwoDigitYear:"YY"===e});switch(e){case"Y":return w(S(4,t),r);case"Yo":return w(i.ordinalNumber(t,{unit:"year"}),r);default:return w(S(e.length,t),r)}}validate(t,e){return e.isTwoDigitYear||e.year>0}set(t,e,i,r){let n=(0,k.h)(t,r);if(i.isTwoDigitYear){let e=T(i.year,n);return t.setFullYear(e,0,r.firstWeekContainsDate),t.setHours(0,0,0,0),(0,O.k)(t,r)}let o="era"in e&&1!==e.era?1-i.year:i.year;return t.setFullYear(o,0,r.firstWeekContainsDate),t.setHours(0,0,0,0),(0,O.k)(t,r)}constructor(...t){super(...t),this.priority=130,this.incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}}var A=i(70540);class N extends d{parse(t,e){return"R"===e?E(4,t):E(e.length,t)}set(t,e,i){let r=(0,s.w)(t,0);return r.setFullYear(i,0,4),r.setHours(0,0,0,0),(0,A.b)(r)}constructor(...t){super(...t),this.priority=130,this.incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}}class H extends d{parse(t,e){return"u"===e?E(4,t):E(e.length,t)}set(t,e,i){return t.setFullYear(i,0,1),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=130,this.incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}}class P extends d{parse(t,e,i){switch(e){case"Q":case"QQ":return S(e.length,t);case"Qo":return i.ordinalNumber(t,{unit:"quarter"});case"QQQ":return i.quarter(t,{width:"abbreviated",context:"formatting"})||i.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return i.quarter(t,{width:"narrow",context:"formatting"});default:return i.quarter(t,{width:"wide",context:"formatting"})||i.quarter(t,{width:"abbreviated",context:"formatting"})||i.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=1&&e<=4}set(t,e,i){return t.setMonth((i-1)*3,1),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=120,this.incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}}class _ extends d{parse(t,e,i){switch(e){case"q":case"qq":return S(e.length,t);case"qo":return i.ordinalNumber(t,{unit:"quarter"});case"qqq":return i.quarter(t,{width:"abbreviated",context:"standalone"})||i.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return i.quarter(t,{width:"narrow",context:"standalone"});default:return i.quarter(t,{width:"wide",context:"standalone"})||i.quarter(t,{width:"abbreviated",context:"standalone"})||i.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=1&&e<=4}set(t,e,i){return t.setMonth((i-1)*3,1),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=120,this.incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}}class D extends d{parse(t,e,i){let r=t=>t-1;switch(e){case"M":return w(y(p.month,t),r);case"MM":return w(S(2,t),r);case"Mo":return w(i.ordinalNumber(t,{unit:"month"}),r);case"MMM":return i.month(t,{width:"abbreviated",context:"formatting"})||i.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return i.month(t,{width:"narrow",context:"formatting"});default:return i.month(t,{width:"wide",context:"formatting"})||i.month(t,{width:"abbreviated",context:"formatting"})||i.month(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=11}set(t,e,i){return t.setMonth(i,1),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"],this.priority=110}}class L extends d{parse(t,e,i){let r=t=>t-1;switch(e){case"L":return w(y(p.month,t),r);case"LL":return w(S(2,t),r);case"Lo":return w(i.ordinalNumber(t,{unit:"month"}),r);case"LLL":return i.month(t,{width:"abbreviated",context:"standalone"})||i.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return i.month(t,{width:"narrow",context:"standalone"});default:return i.month(t,{width:"wide",context:"standalone"})||i.month(t,{width:"abbreviated",context:"standalone"})||i.month(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=0&&e<=11}set(t,e,i){return t.setMonth(i,1),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=110,this.incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}}var F=i(21391);class V extends d{parse(t,e,i){switch(e){case"w":return y(p.week,t);case"wo":return i.ordinalNumber(t,{unit:"week"});default:return S(e.length,t)}}validate(t,e){return e>=1&&e<=53}set(t,e,i,r){return(0,O.k)(function(t,e,i){let r=(0,a.a)(t,null==i?void 0:i.in),n=(0,F.N)(r,i)-e;return r.setDate(r.getDate()-7*n),(0,a.a)(r,null==i?void 0:i.in)}(t,i,r),r)}constructor(...t){super(...t),this.priority=100,this.incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}}var W=i(17519);class B extends d{parse(t,e,i){switch(e){case"I":return y(p.week,t);case"Io":return i.ordinalNumber(t,{unit:"week"});default:return S(e.length,t)}}validate(t,e){return e>=1&&e<=53}set(t,e,i){return(0,A.b)(function(t,e,i){let r=(0,a.a)(t,void 0),n=(0,W.s)(r,void 0)-e;return r.setDate(r.getDate()-7*n),r}(t,i))}constructor(...t){super(...t),this.priority=100,this.incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}}let j=[31,28,31,30,31,30,31,31,30,31,30,31],z=[31,29,31,30,31,30,31,31,30,31,30,31];class U extends d{parse(t,e,i){switch(e){case"d":return y(p.date,t);case"do":return i.ordinalNumber(t,{unit:"date"});default:return S(e.length,t)}}validate(t,e){let i=x(t.getFullYear()),r=t.getMonth();return i?e>=1&&e<=z[r]:e>=1&&e<=j[r]}set(t,e,i){return t.setDate(i),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=90,this.subPriority=1,this.incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}}class $ extends d{parse(t,e,i){switch(e){case"D":case"DD":return y(p.dayOfYear,t);case"Do":return i.ordinalNumber(t,{unit:"date"});default:return S(e.length,t)}}validate(t,e){return x(t.getFullYear())?e>=1&&e<=366:e>=1&&e<=365}set(t,e,i){return t.setMonth(0,i),t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=90,this.subpriority=1,this.incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}}var Y=i(40714);function G(t,e,i){var r,n,o,s,h,u,c,d;let g=(0,l.q)(),f=null!==(d=null!==(c=null!==(u=null!==(h=null==i?void 0:i.weekStartsOn)&&void 0!==h?h:null==i?void 0:null===(n=i.locale)||void 0===n?void 0:null===(r=n.options)||void 0===r?void 0:r.weekStartsOn)&&void 0!==u?u:g.weekStartsOn)&&void 0!==c?c:null===(s=g.locale)||void 0===s?void 0:null===(o=s.options)||void 0===o?void 0:o.weekStartsOn)&&void 0!==d?d:0,p=(0,a.a)(t,null==i?void 0:i.in),m=p.getDay(),w=7-f,y=e<0||e>6?e-(m+w)%7:((e%7+7)%7+w)%7-(m+w)%7;return(0,Y.f)(p,y,i)}class q extends d{parse(t,e,i){switch(e){case"E":case"EE":case"EEE":return i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return i.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});default:return i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=6}set(t,e,i,r){return(t=G(t,i,r)).setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=90,this.incompatibleTokens=["D","i","e","c","t","T"]}}class X extends d{parse(t,e,i,r){let n=t=>{let e=7*Math.floor((t-1)/7);return(t+r.weekStartsOn+6)%7+e};switch(e){case"e":case"ee":return w(S(e.length,t),n);case"eo":return w(i.ordinalNumber(t,{unit:"day"}),n);case"eee":return i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});case"eeeee":return i.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"});default:return i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"})}}validate(t,e){return e>=0&&e<=6}set(t,e,i,r){return(t=G(t,i,r)).setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=90,this.incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}}class K extends d{parse(t,e,i,r){let n=t=>{let e=7*Math.floor((t-1)/7);return(t+r.weekStartsOn+6)%7+e};switch(e){case"c":case"cc":return w(S(e.length,t),n);case"co":return w(i.ordinalNumber(t,{unit:"day"}),n);case"ccc":return i.day(t,{width:"abbreviated",context:"standalone"})||i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"});case"ccccc":return i.day(t,{width:"narrow",context:"standalone"});case"cccccc":return i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"});default:return i.day(t,{width:"wide",context:"standalone"})||i.day(t,{width:"abbreviated",context:"standalone"})||i.day(t,{width:"short",context:"standalone"})||i.day(t,{width:"narrow",context:"standalone"})}}validate(t,e){return e>=0&&e<=6}set(t,e,i,r){return(t=G(t,i,r)).setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=90,this.incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}}class J extends d{parse(t,e,i){let r=t=>0===t?7:t;switch(e){case"i":case"ii":return S(e.length,t);case"io":return i.ordinalNumber(t,{unit:"day"});case"iii":return w(i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"}),r);case"iiiii":return w(i.day(t,{width:"narrow",context:"formatting"}),r);case"iiiiii":return w(i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"}),r);default:return w(i.day(t,{width:"wide",context:"formatting"})||i.day(t,{width:"abbreviated",context:"formatting"})||i.day(t,{width:"short",context:"formatting"})||i.day(t,{width:"narrow",context:"formatting"}),r)}}validate(t,e){return e>=1&&e<=7}set(t,e,i){return(t=function(t,e,i){let r=(0,a.a)(t,void 0),n=function(t,e){let i=(0,a.a)(t,null==e?void 0:e.in).getDay();return 0===i?7:i}(r,void 0);return(0,Y.f)(r,e-n,i)}(t,i)).setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=90,this.incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}}class Q extends d{parse(t,e,i){switch(e){case"a":case"aa":case"aaa":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return i.dayPeriod(t,{width:"narrow",context:"formatting"});default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,i){return t.setHours(R(i),0,0,0),t}constructor(...t){super(...t),this.priority=80,this.incompatibleTokens=["b","B","H","k","t","T"]}}class Z extends d{parse(t,e,i){switch(e){case"b":case"bb":case"bbb":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return i.dayPeriod(t,{width:"narrow",context:"formatting"});default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,i){return t.setHours(R(i),0,0,0),t}constructor(...t){super(...t),this.priority=80,this.incompatibleTokens=["a","B","H","k","t","T"]}}class tt extends d{parse(t,e,i){switch(e){case"B":case"BB":case"BBB":return i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return i.dayPeriod(t,{width:"narrow",context:"formatting"});default:return i.dayPeriod(t,{width:"wide",context:"formatting"})||i.dayPeriod(t,{width:"abbreviated",context:"formatting"})||i.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,e,i){return t.setHours(R(i),0,0,0),t}constructor(...t){super(...t),this.priority=80,this.incompatibleTokens=["a","b","t","T"]}}class te extends d{parse(t,e,i){switch(e){case"h":return y(p.hour12h,t);case"ho":return i.ordinalNumber(t,{unit:"hour"});default:return S(e.length,t)}}validate(t,e){return e>=1&&e<=12}set(t,e,i){let r=t.getHours()>=12;return r&&i<12?t.setHours(i+12,0,0,0):r||12!==i?t.setHours(i,0,0,0):t.setHours(0,0,0,0),t}constructor(...t){super(...t),this.priority=70,this.incompatibleTokens=["H","K","k","t","T"]}}class ti extends d{parse(t,e,i){switch(e){case"H":return y(p.hour23h,t);case"Ho":return i.ordinalNumber(t,{unit:"hour"});default:return S(e.length,t)}}validate(t,e){return e>=0&&e<=23}set(t,e,i){return t.setHours(i,0,0,0),t}constructor(...t){super(...t),this.priority=70,this.incompatibleTokens=["a","b","h","K","k","t","T"]}}class tr extends d{parse(t,e,i){switch(e){case"K":return y(p.hour11h,t);case"Ko":return i.ordinalNumber(t,{unit:"hour"});default:return S(e.length,t)}}validate(t,e){return e>=0&&e<=11}set(t,e,i){return t.getHours()>=12&&i<12?t.setHours(i+12,0,0,0):t.setHours(i,0,0,0),t}constructor(...t){super(...t),this.priority=70,this.incompatibleTokens=["h","H","k","t","T"]}}class tn extends d{parse(t,e,i){switch(e){case"k":return y(p.hour24h,t);case"ko":return i.ordinalNumber(t,{unit:"hour"});default:return S(e.length,t)}}validate(t,e){return e>=1&&e<=24}set(t,e,i){return t.setHours(i<=24?i%24:i,0,0,0),t}constructor(...t){super(...t),this.priority=70,this.incompatibleTokens=["a","b","h","H","K","t","T"]}}class to extends d{parse(t,e,i){switch(e){case"m":return y(p.minute,t);case"mo":return i.ordinalNumber(t,{unit:"minute"});default:return S(e.length,t)}}validate(t,e){return e>=0&&e<=59}set(t,e,i){return t.setMinutes(i,0,0),t}constructor(...t){super(...t),this.priority=60,this.incompatibleTokens=["t","T"]}}class ts extends d{parse(t,e,i){switch(e){case"s":return y(p.second,t);case"so":return i.ordinalNumber(t,{unit:"second"});default:return S(e.length,t)}}validate(t,e){return e>=0&&e<=59}set(t,e,i){return t.setSeconds(i,0),t}constructor(...t){super(...t),this.priority=50,this.incompatibleTokens=["t","T"]}}class tl extends d{parse(t,e){return w(S(e.length,t),t=>Math.trunc(t*Math.pow(10,-e.length+3)))}set(t,e,i){return t.setMilliseconds(i),t}constructor(...t){super(...t),this.priority=30,this.incompatibleTokens=["t","T"]}}var ta=i(97444);class th extends d{parse(t,e){switch(e){case"X":return b(m.basicOptionalMinutes,t);case"XX":return b(m.basic,t);case"XXXX":return b(m.basicOptionalSeconds,t);case"XXXXX":return b(m.extendedOptionalSeconds,t);default:return b(m.extended,t)}}set(t,e,i){return e.timestampIsSet?t:(0,s.w)(t,t.getTime()-(0,ta.G)(t)-i)}constructor(...t){super(...t),this.priority=10,this.incompatibleTokens=["t","T","x"]}}class tu extends d{parse(t,e){switch(e){case"x":return b(m.basicOptionalMinutes,t);case"xx":return b(m.basic,t);case"xxxx":return b(m.basicOptionalSeconds,t);case"xxxxx":return b(m.extendedOptionalSeconds,t);default:return b(m.extended,t)}}set(t,e,i){return e.timestampIsSet?t:(0,s.w)(t,t.getTime()-(0,ta.G)(t)-i)}constructor(...t){super(...t),this.priority=10,this.incompatibleTokens=["t","T","X"]}}class tc extends d{parse(t){return C(t)}set(t,e,i){return[(0,s.w)(t,1e3*i),{timestampIsSet:!0}]}constructor(...t){super(...t),this.priority=40,this.incompatibleTokens="*"}}class td extends d{parse(t){return C(t)}set(t,e,i){return[(0,s.w)(t,i),{timestampIsSet:!0}]}constructor(...t){super(...t),this.priority=20,this.incompatibleTokens="*"}}let tg={G:new g,y:new M,Y:new I,R:new N,u:new H,Q:new P,q:new _,M:new D,L:new L,w:new V,I:new B,d:new U,D:new $,E:new q,e:new X,c:new K,i:new J,a:new Q,b:new Z,B:new tt,h:new te,H:new ti,K:new tr,k:new tn,m:new to,s:new ts,S:new tl,X:new th,x:new tu,t:new tc,T:new td},tf=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,tp=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,tm=/^'([^]*?)'?$/,tw=/''/g,tv=/\S/,ty=/[a-zA-Z]/;function tb(t,e,i,h){var u,d,g,f,p,m,w,y,b,C,S,E,R,T,x,M,k,O;let I=()=>(0,s.w)((null==h?void 0:h.in)||i,NaN),A=Object.assign({},(0,l.q)()),N=null!==(C=null!==(b=null==h?void 0:h.locale)&&void 0!==b?b:A.locale)&&void 0!==C?C:r.c,H=null!==(T=null!==(R=null!==(E=null!==(S=null==h?void 0:h.firstWeekContainsDate)&&void 0!==S?S:null==h?void 0:null===(d=h.locale)||void 0===d?void 0:null===(u=d.options)||void 0===u?void 0:u.firstWeekContainsDate)&&void 0!==E?E:A.firstWeekContainsDate)&&void 0!==R?R:null===(f=A.locale)||void 0===f?void 0:null===(g=f.options)||void 0===g?void 0:g.firstWeekContainsDate)&&void 0!==T?T:1,P=null!==(O=null!==(k=null!==(M=null!==(x=null==h?void 0:h.weekStartsOn)&&void 0!==x?x:null==h?void 0:null===(m=h.locale)||void 0===m?void 0:null===(p=m.options)||void 0===p?void 0:p.weekStartsOn)&&void 0!==M?M:A.weekStartsOn)&&void 0!==k?k:null===(y=A.locale)||void 0===y?void 0:null===(w=y.options)||void 0===w?void 0:w.weekStartsOn)&&void 0!==O?O:0;if(!e)return t?I():(0,a.a)(i,null==h?void 0:h.in);let _={firstWeekContainsDate:H,weekStartsOn:P,locale:N},D=[new c(null==h?void 0:h.in,i)],L=e.match(tp).map(t=>{let e=t[0];return e in n.m?(0,n.m[e])(t,N.formatLong):t}).join("").match(tf),F=[];for(let i of L){!(null==h?void 0:h.useAdditionalWeekYearTokens)&&(0,o.xM)(i)&&(0,o.Ss)(i,e,t),!(null==h?void 0:h.useAdditionalDayOfYearTokens)&&(0,o.ef)(i)&&(0,o.Ss)(i,e,t);let r=i[0],n=tg[r];if(n){let{incompatibleTokens:e}=n;if(Array.isArray(e)){let t=F.find(t=>e.includes(t.token)||t.token===r);if(t)throw RangeError("The format string mustn't contain `".concat(t.fullToken,"` and `").concat(i,"` at the same time"))}else if("*"===n.incompatibleTokens&&F.length>0)throw RangeError("The format string mustn't contain `".concat(i,"` and any other token at the same time"));F.push({token:r,fullToken:i});let o=n.run(t,i,N.match,_);if(!o)return I();D.push(o.setter),t=o.rest}else{if(r.match(ty))throw RangeError("Format string contains an unescaped latin alphabet character `"+r+"`");if("''"===i?i="'":"'"===r&&(i=i.match(tm)[1].replace(tw,"'")),0!==t.indexOf(i))return I();t=t.slice(i.length)}}if(t.length>0&&tv.test(t))return I();let V=D.map(t=>t.priority).sort((t,e)=>e-t).filter((t,e,i)=>i.indexOf(t)===e).map(t=>D.filter(e=>e.priority===t).sort((t,e)=>e.subPriority-t.subPriority)).map(t=>t[0]),W=(0,a.a)(i,null==h?void 0:h.in);if(isNaN(+W))return I();let B={};for(let t of V){if(!t.validate(W,_))return I();let e=t.set(W,B,_);Array.isArray(e)?(W=e[0],Object.assign(B,e[1])):W=e}return W}},29161:(t,e,i)=>{"use strict";i.d(e,{Y:()=>n});var r=i(89447);function n(t,e){return+(0,r.a)(t)<+(0,r.a)(e)}},29239:(t,e,i)=>{"use strict";i.d(e,{c:()=>y}),i(41658);var r=i(57193),n=i(33787),o=i(75708);function s(t,e,i){l(t,e),e.set(t,i)}function l(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function a(t,e){return t.get(u(t,e))}function h(t,e,i){return t.set(u(t,e),i),i}function u(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let c=Object.freeze({CELL:"cell",MIXED:"mixed"});var d=new WeakMap,g=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakMap,w=new WeakSet;class y{constructor(t){var e=this;!function(t,e){l(t,e),e.add(t)}(this,w),s(this,d,void 0),s(this,g,void 0),s(this,f,1),s(this,p,null),s(this,m,new Map);let i=t.getSettings();h(d,this,t),h(g,this,i.imeFastEdit?c.MIXED:c.CELL),a(d,this).addHook("afterUpdateSettings",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return u(w,e,E).call(e,...i)}),a(d,this).addHook("afterSelection",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return u(w,e,C).call(e,...i)}),a(d,this).addHook("afterSelectionFocusSet",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return u(w,e,C).call(e,...i)}),a(d,this).addHook("afterSelectionEnd",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return u(w,e,S).call(e,...i)})}getFocusMode(){return a(g,this)}setFocusMode(t){Object.values(c).includes(t)?h(g,this,t):(0,r.R8)(`"${t}" is not a valid focus mode.`)}getRefocusDelay(){return a(f,this)}setRefocusDelay(t){h(f,this,t)}setRefocusElementGetter(t){h(p,this,t)}getRefocusElement(){var t;return"function"==typeof a(p,this)?a(p,this).call(this):null===(t=a(d,this).getActiveEditor())||void 0===t?void 0:t.TEXTAREA}focusOnHighlightedCell(t){let e=t=>{var e,i;let r=null===(e=a(d,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!r)return;let o=a(d,this).runHooks("modifyFocusedElement",r.row,r.col,t);(0,n.isHTMLElement)(o)||(o=t),o&&!(null!==(i=a(d,this).getActiveEditor())&&void 0!==i&&i.isOpened())&&o.focus({preventScroll:!0})};t?e(t):u(w,this,b).call(this,t=>e(t))}refocusToEditorTextarea(){var t,e,i;let r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a(f,this);a(d,this).getSettings().imeFastEdit&&!(null!==(t=a(d,this).getActiveEditor())&&void 0!==t&&t.isOpened())&&(null===(e=a(d,this).getActiveEditor())||void 0===e||null===(i=e.refreshValue)||void 0===i||i.call(e),a(m,this).has(r)||a(m,this).set(r,(0,o.debounce)(()=>{if(!a(d,this).isDestroyed){var t;null===(t=this.getRefocusElement())||void 0===t||t.select()}},r)),a(m,this).get(r)())}}function b(t){var e;let i=null===(e=a(d,this).getSelectedRangeLast())||void 0===e?void 0:e.highlight;if(!i||!a(d,this).selection.isCellVisible(i)){t(null);return}let r=a(d,this).getCell(i.row,i.col,!0);null===r?a(d,this).addHookOnce("afterScroll",()=>{t(a(d,this).getCell(i.row,i.col,!0))}):t(r)}function C(){u(w,this,b).call(this,t=>{let{activeElement:e}=a(d,this).rootDocument;e&&(0,n.isOutsideInput)(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function S(){u(w,this,b).call(this,t=>{this.getFocusMode()===c.MIXED&&(null==t?void 0:t.nodeName)==="TD"&&this.refocusToEditorTextarea()})}function E(t){"boolean"==typeof t.imeFastEdit&&this.setFocusMode(t.imeFastEdit?c.MIXED:c.CELL)}},29440:(t,e,i)=>{"use strict";var r,n=i(8883),o=i(72887),s=i(66627),l=i(4389),a=i(56899),h=i(15567),u=i(37889),c="prototype",d="script",g=u("IE_PROTO"),f=function(){},p=function(t){return"<"+d+">"+t+"</"+d+">"},m=function(t){t.write(p("")),t.close();var e=t.parentWindow.Object;return t=null,e},w=function(){var t,e=h("iframe");return e.style.display="none",a.appendChild(e),e.src=String("java"+d+":"),(t=e.contentWindow.document).open(),t.write(p("document.F=Object")),t.close(),t.F},y=function(){try{r=new ActiveXObject("htmlfile")}catch(t){}y="undefined"!=typeof document?document.domain&&r?m(r):w():m(r);for(var t=s.length;t--;)delete y[c][s[t]];return y()};l[g]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(f[c]=n(t),i=new f,f[c]=null,i[g]=t):i=y(),void 0===e?i:o.f(i,e)}},29954:(t,e,i)=>{"use strict";i(67043)},30832:function(t){t.exports=function(){"use strict";var t="millisecond",e="second",i="minute",r="hour",n="week",o="month",s="quarter",l="year",a="date",h="Invalid Date",u=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,c=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(t,e,i){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(i)+t},g="en",f={};f[g]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(t){var e=["th","st","nd","rd"],i=t%100;return"["+t+(e[(i-20)%10]||e[i]||e[0])+"]"}};var p="$isDayjsObject",m=function(t){return t instanceof C||!(!t||!t[p])},w=function t(e,i,r){var n;if(!e)return g;if("string"==typeof e){var o=e.toLowerCase();f[o]&&(n=o),i&&(f[o]=i,n=o);var s=e.split("-");if(!n&&s.length>1)return t(s[0])}else{var l=e.name;f[l]=e,n=l}return!r&&n&&(g=n),n||!r&&g},y=function(t,e){if(m(t))return t.clone();var i="object"==typeof e?e:{};return i.date=t,i.args=arguments,new C(i)},b={s:d,z:function(t){var e=-t.utcOffset(),i=Math.abs(e);return(e<=0?"+":"-")+d(Math.floor(i/60),2,"0")+":"+d(i%60,2,"0")},m:function t(e,i){if(e.date()<i.date())return-t(i,e);var r=12*(i.year()-e.year())+(i.month()-e.month()),n=e.clone().add(r,o),s=i-n<0,l=e.clone().add(r+(s?-1:1),o);return+(-(r+(i-n)/(s?n-l:l-n))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(h){return({M:o,y:l,w:n,d:"day",D:a,h:r,m:i,s:e,ms:t,Q:s})[h]||String(h||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}};b.l=w,b.i=m,b.w=function(t,e){return y(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var C=function(){function d(t){this.$L=w(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[p]=!0}var g=d.prototype;return g.parse=function(t){this.$d=function(t){var e=t.date,i=t.utc;if(null===e)return new Date(NaN);if(b.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(u);if(r){var n=r[2]-1||0,o=(r[7]||"0").substring(0,3);return i?new Date(Date.UTC(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)):new Date(r[1],n,r[3]||1,r[4]||0,r[5]||0,r[6]||0,o)}}return new Date(e)}(t),this.init()},g.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},g.$utils=function(){return b},g.isValid=function(){return this.$d.toString()!==h},g.isSame=function(t,e){var i=y(t);return this.startOf(e)<=i&&i<=this.endOf(e)},g.isAfter=function(t,e){return y(t)<this.startOf(e)},g.isBefore=function(t,e){return this.endOf(e)<y(t)},g.$g=function(t,e,i){return b.u(t)?this[e]:this.set(i,t)},g.unix=function(){return Math.floor(this.valueOf()/1e3)},g.valueOf=function(){return this.$d.getTime()},g.startOf=function(t,s){var h=this,u=!!b.u(s)||s,c=b.p(t),d=function(t,e){var i=b.w(h.$u?Date.UTC(h.$y,e,t):new Date(h.$y,e,t),h);return u?i:i.endOf("day")},g=function(t,e){return b.w(h.toDate()[t].apply(h.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(e)),h)},f=this.$W,p=this.$M,m=this.$D,w="set"+(this.$u?"UTC":"");switch(c){case l:return u?d(1,0):d(31,11);case o:return u?d(1,p):d(0,p+1);case n:var y=this.$locale().weekStart||0,C=(f<y?f+7:f)-y;return d(u?m-C:m+(6-C),p);case"day":case a:return g(w+"Hours",0);case r:return g(w+"Minutes",1);case i:return g(w+"Seconds",2);case e:return g(w+"Milliseconds",3);default:return this.clone()}},g.endOf=function(t){return this.startOf(t,!1)},g.$set=function(n,s){var h,u=b.p(n),c="set"+(this.$u?"UTC":""),d=((h={}).day=c+"Date",h[a]=c+"Date",h[o]=c+"Month",h[l]=c+"FullYear",h[r]=c+"Hours",h[i]=c+"Minutes",h[e]=c+"Seconds",h[t]=c+"Milliseconds",h)[u],g="day"===u?this.$D+(s-this.$W):s;if(u===o||u===l){var f=this.clone().set(a,1);f.$d[d](g),f.init(),this.$d=f.set(a,Math.min(this.$D,f.daysInMonth())).$d}else d&&this.$d[d](g);return this.init(),this},g.set=function(t,e){return this.clone().$set(t,e)},g.get=function(t){return this[b.p(t)]()},g.add=function(t,s){var a,h=this;t=Number(t);var u=b.p(s),c=function(e){var i=y(h);return b.w(i.date(i.date()+Math.round(e*t)),h)};if(u===o)return this.set(o,this.$M+t);if(u===l)return this.set(l,this.$y+t);if("day"===u)return c(1);if(u===n)return c(7);var d=((a={})[i]=6e4,a[r]=36e5,a[e]=1e3,a)[u]||1,g=this.$d.getTime()+t*d;return b.w(g,this)},g.subtract=function(t,e){return this.add(-1*t,e)},g.format=function(t){var e=this,i=this.$locale();if(!this.isValid())return i.invalidDate||h;var r=t||"YYYY-MM-DDTHH:mm:ssZ",n=b.z(this),o=this.$H,s=this.$m,l=this.$M,a=i.weekdays,u=i.months,d=i.meridiem,g=function(t,i,n,o){return t&&(t[i]||t(e,r))||n[i].slice(0,o)},f=function(t){return b.s(o%12||12,t,"0")},p=d||function(t,e,i){var r=t<12?"AM":"PM";return i?r.toLowerCase():r};return r.replace(c,function(t,r){return r||function(t){switch(t){case"YY":return String(e.$y).slice(-2);case"YYYY":return b.s(e.$y,4,"0");case"M":return l+1;case"MM":return b.s(l+1,2,"0");case"MMM":return g(i.monthsShort,l,u,3);case"MMMM":return g(u,l);case"D":return e.$D;case"DD":return b.s(e.$D,2,"0");case"d":return String(e.$W);case"dd":return g(i.weekdaysMin,e.$W,a,2);case"ddd":return g(i.weekdaysShort,e.$W,a,3);case"dddd":return a[e.$W];case"H":return String(o);case"HH":return b.s(o,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return p(o,s,!0);case"A":return p(o,s,!1);case"m":return String(s);case"mm":return b.s(s,2,"0");case"s":return String(e.$s);case"ss":return b.s(e.$s,2,"0");case"SSS":return b.s(e.$ms,3,"0");case"Z":return n}return null}(t)||n.replace(":","")})},g.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},g.diff=function(t,a,h){var u,c=this,d=b.p(a),g=y(t),f=(g.utcOffset()-this.utcOffset())*6e4,p=this-g,m=function(){return b.m(c,g)};switch(d){case l:u=m()/12;break;case o:u=m();break;case s:u=m()/3;break;case n:u=(p-f)/6048e5;break;case"day":u=(p-f)/864e5;break;case r:u=p/36e5;break;case i:u=p/6e4;break;case e:u=p/1e3;break;default:u=p}return h?u:b.a(u)},g.daysInMonth=function(){return this.endOf(o).$D},g.$locale=function(){return f[this.$L]},g.locale=function(t,e){if(!t)return this.$L;var i=this.clone(),r=w(t,e,!0);return r&&(i.$L=r),i},g.clone=function(){return b.w(this.$d,this)},g.toDate=function(){return new Date(this.valueOf())},g.toJSON=function(){return this.isValid()?this.toISOString():null},g.toISOString=function(){return this.$d.toISOString()},g.toString=function(){return this.$d.toUTCString()},d}(),S=C.prototype;return y.prototype=S,[["$ms",t],["$s",e],["$m",i],["$H",r],["$W","day"],["$M",o],["$y",l],["$D",a]].forEach(function(t){S[t[1]]=function(e){return this.$g(e,t[0],t[1])}}),y.extend=function(t,e){return t.$i||(t(e,C,y),t.$i=!0),y},y.locale=w,y.isDayjs=m,y.unix=function(t){return y(1e3*t)},y.en=f[g],y.Ls=f,y.p={},y}()},31338:(t,e,i)=>{"use strict";var r=i(67297),n=i(29440),o=i(24201),s=i(42001),l=i(7107),a=i(82831),h=i(38896),u=i(66163).IteratorPrototype,c=i(91337),d=i(76093),g=i(65911),f=l("toStringTag"),p="IteratorHelper",m="WrapForValidIterator",w="normal",y="throw",b=a.set,C=function(t){var e=a.getterFor(t?m:p);return s(n(u),{next:function(){var i=e(this);if(t)return i.nextHandler();if(i.done)return c(void 0,!0);try{var r=i.nextHandler();return i.returnHandlerResult?r:c(r,i.done)}catch(t){throw i.done=!0,t}},return:function(){var i=e(this),n=i.iterator;if(i.done=!0,t){var o=h(n,"return");return o?r(o,n):c(void 0,!0)}if(i.inner)try{d(i.inner.iterator,w)}catch(t){return d(n,y,t)}if(i.openIters)try{g(i.openIters,w)}catch(t){return d(n,y,t)}return n&&d(n,w),c(void 0,!0)}})},S=C(!0),E=C(!1);o(E,f,"Iterator Helper"),t.exports=function(t,e,i){var r=function(r,n){n?(n.iterator=r.iterator,n.next=r.next):n=r,n.type=e?m:p,n.returnHandlerResult=!!i,n.nextHandler=t,n.counter=0,n.done=!1,b(this,n)};return r.prototype=e?S:E,r}},32138:t=>{"use strict";t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},32730:(t,e,i)=>{"use strict";var r=i(42665),n=Math.min;t.exports=function(t){var e=r(t);return e>0?n(e,0x1fffffffffffff):0}},32886:(t,e,i)=>{"use strict";i.d(e,{J:()=>n});var r=i(33787);function n(t){let{classNames:e}=(0,r.findFirstParentWithClass)(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}},32944:(t,e,i)=>{"use strict";i.d(e,{p:()=>n});var r=i(89447);function n(t,e){let i=(0,r.a)(t,null==e?void 0:e.in),n=i.getMonth();return i.setFullYear(i.getFullYear(),n+1,0),i.setHours(23,59,59,999),i}},33325:(t,e,i)=>{"use strict";var r=i(16604),n=Object;t.exports=function(t){return n(r(t))}},33773:(t,e,i)=>{"use strict";i.d(e,{b7:()=>u,_T:()=>h}),i(41658);var r=i(78887),n=i(19857);i(19398);var o=i(95061);let s={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){(0,o.arrayEach)(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){(0,n.objectEach)(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};(0,n.defineGetter)(s,"MIXIN_NAME","hooksRefRegisterer",{writable:!1,enumerable:!1});var l=i(33787);function a(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let h=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class u{static get EDITOR_TYPE(){return"base"}constructor(t){a(this,"hot",void 0),a(this,"state",h.VIRGIN),a(this,"_opened",!1),a(this,"_fullEditMode",!1),a(this,"_closeCallback",null),a(this,"TD",null),a(this,"row",null),a(this,"col",null),a(this,"prop",null),a(this,"originalValue",null),a(this,"cellProperties",null),this.hot=t,this.init()}_fireCallbacks(t){this._closeCallback&&(this._closeCallback(t),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(t,e,i,r,n,o){this.TD=r,this.row=t,this.col=e,this.prop=i,this.originalValue=n,this.cellProperties=o,this.state=this.isOpened()?this.state:h.VIRGIN}extend(){return class extends this.constructor{}}saveValue(t,e){let i,r,n,o;if(e){let t=this.hot.getSelectedLast();i=Math.max(Math.min(t[0],t[2]),0),r=Math.max(Math.min(t[1],t[3]),0),n=Math.max(t[0],t[2]),o=Math.max(t[1],t[3])}else[i,r,n,o]=[this.row,this.col,null,null];let s=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(s)&&([i,r]=s),this.hot.populateFromArray(i,r,t,n,o,"edit")}beginEditing(t,e){if(this.state!==h.VIRGIN)return;let i=this.hot,n=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),s=()=>{if(this.state=h.EDITING,this.isInFullEditMode()){let e="string"==typeof t?t:(0,r.stringify)(this.originalValue);this.setValue(e)}this.open(e),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",s),i.view.scrollViewport(i._createCellCoords(n,o))||(this.hot.removeHook("afterScroll",s),s())}finishEditing(t,e,i){let r;if(i){let t=this._closeCallback;this._closeCallback=e=>{t&&t(e),i(e),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===h.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===h.EDITING){if(t){this.cancelChanges(),this.hot.view.render();return}let i=this.getValue();r=this.cellProperties.trimWhitespace?[["string"==typeof i?String.prototype.trim.call(i||""):i]]:[[i]],this.state=h.WAITING,this.saveValue(r,e),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",t=>{this.state=h.FINISHED,this.discardEditor(t)}):(this.state=h.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=h.FINISHED,this.discardEditor()}discardEditor(t){this.state===h.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=h.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=h.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===h.WAITING}getEditedCellRect(){var t;let e=this.getEditedCell();if(!e)return;let{wtOverlays:i,wtViewport:r}=this.hot.view._wt,n=this.hot.rootWindow,o=(0,l.offset)(e),s=(0,l.outerWidth)(e),a=(0,l.offset)(this.hot.rootElement),h=(0,l.outerWidth)(this.hot.rootElement),u=i.topOverlay.holder,c=i.inlineStartOverlay.holder,d=u!==n?u.scrollTop:0,g=c!==n?c.scrollLeft:0,f=n.innerWidth-a.left-h,{wtTable:p}=null!==(t=i.getParentOverlay(e))&&void 0!==t?t:this.hot.view._wt,m=p.name,w=["master","inline_start"].includes(m)?d:0,y=["master","top","bottom"].includes(m)?g:0,b=+(o.top!==a.top),C=o.top-a.top-b-w,S=0;S=this.hot.isRtl()?n.innerWidth-o.left-s-f-1+y:o.left-a.left-1-y,["top","top_inline_start_corner"].includes(m)&&(C+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(m)&&(S+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));let E=this.hot.hasColHeaders(),R=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),T=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),x=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(E&&R<=0||R===x)&&(C+=1),T<=0&&(S+=1);let M=r.rowsRenderCalculator.startPosition,k=r.columnsRenderCalculator.startPosition,O=Math.abs(i.inlineStartOverlay.getScrollPosition()),I=i.topOverlay.getScrollPosition(),A=(0,l.getScrollbarWidth)(this.hot.rootDocument),N=e.offsetTop;if(["inline_start","master"].includes(m)&&(N+=M-I),["bottom","bottom_inline_start_corner"].includes(m)){let{wtViewport:t,wtTable:e}=i.bottomOverlay.clone;N+=t.getWorkspaceHeight()-e.getHeight()-A}let H=e.offsetLeft;this.hot.isRtl()?H=(H>=0?p.getWidth()-e.offsetLeft:Math.abs(H))+(k-O-s):["top","master","bottom"].includes(m)&&(H+=k-O);let P=n.getComputedStyle(this.TD),_=parseInt(P[this.hot.isRtl()?"borderRightWidth":"borderLeftWidth"],10)>0?0:1,D=parseInt(P.borderTopWidth,10)>0?0:1,L=(0,l.outerWidth)(e)+_,F=(0,l.outerHeight)(e)+D,V=(0,l.hasVerticalScrollbar)(u)?A:0,W=(0,l.hasHorizontalScrollbar)(c)?A:0,B=this.hot.view.maximumVisibleElementWidth(H)-V+_;return{top:C,start:S,height:F,maxHeight:Math.max(this.hot.view.maximumVisibleElementHeight(N)-W+D,this.hot.view.getDefaultRowHeight()),width:L,maxWidth:B}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){let t=this.hot.countRows(),e="";return this.row<this.hot.getSettings().fixedRowsTop?e=this.col<this.hot.getSettings().fixedColumnsStart?"top-inline-start-corner":"top":this.hot.getSettings().fixedRowsBottom&&this.row>=t-this.hot.getSettings().fixedRowsBottom?e=this.col<this.hot.getSettings().fixedColumnsStart?"bottom-inline-start-corner":"bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(e="inline-start"),e}}(0,n.mixin)(u,s)},33774:(t,e,i)=>{"use strict";i.d(e,{H:()=>o,N:()=>n});var r=i(95061);function n(t,e,i){return[...t.slice(0,e),...i,...t.slice(e)]}function o(t,e){return(0,r.arrayFilter)(t,t=>!1===e.includes(t))}},33787:(t,e,i)=>{"use strict";let r;i.r(e),i.d(e,{HTML_CHARACTERS:()=>x,addClass:()=>C,addEvent:()=>$,clearTextSelection:()=>K,closest:()=>c,closestDown:()=>d,empty:()=>T,fastInnerHTML:()=>M,fastInnerText:()=>k,findFirstParentWithClass:()=>g,getCaretPosition:()=>G,getCssTransform:()=>ti,getFrameElement:()=>a,getMaximumScrollLeft:()=>L,getMaximumScrollTop:()=>D,getParent:()=>s,getParentWindow:()=>h,getScrollLeft:()=>P,getScrollTop:()=>H,getScrollableElement:()=>_,getScrollbarWidth:()=>Q,getSelectionEndPosition:()=>q,getSelectionText:()=>X,getStyle:()=>V,getTrimmingContainer:()=>F,getWindowScrollLeft:()=>N,getWindowScrollTop:()=>A,hasAccessToParentWindow:()=>u,hasClass:()=>b,hasHorizontalScrollbar:()=>tt,hasVerticalScrollbar:()=>Z,hasZeroHeight:()=>O,index:()=>p,innerHeight:()=>z,innerWidth:()=>U,isChildOf:()=>f,isDetached:()=>tl,isHTMLElement:()=>td,isInput:()=>tn,isInternalElement:()=>l,isOutsideInput:()=>to,isVisible:()=>function t(e){let i=e.ownerDocument.documentElement,r=e.ownerDocument.defaultView,n=e;for(;n!==i;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(!n.host)return!1;else{if(n.host.impl)return t(n.host.impl);if(n.host)return t(n.host);throw Error("Lost in Web Components world")}if("none"===r.getComputedStyle(n).display)return!1;n=n.parentNode}return!0},makeElementContentEditableAndSelectItsContent:()=>th,matchesCSSRules:()=>W,observeVisibilityChangeOnce:()=>ta,offset:()=>I,outerHeight:()=>j,outerWidth:()=>B,overlayContainsElement:()=>m,removeAttribute:()=>R,removeClass:()=>S,removeContentEditableFromElementAndDeselect:()=>tu,removeEvent:()=>Y,removeTextNodes:()=>function t(e){if(3===e.nodeType)e.parentNode.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1){let i=e.childNodes;for(let e=i.length-1;e>=0;e--)t(i[e])}},resetCssTransform:()=>tr,runWithSelectedContendEditableElement:()=>tc,selectElementIfAllowed:()=>ts,setAttribute:()=>E,setCaretPosition:()=>J,setOverlayPosition:()=>te}),i(41658),i(19398),i(12252),i(29954),i(20775);var n=i(93924),o=i(91748);function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=-1,r=null,n=t;for(;null!==n;){if(i===e){r=n;break}n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n=n.host:(i+=1,n=n.parentNode)}return r}function l(t,e){let i=t.closest(".handsontable");return!!i&&(i.parentNode===e||i===e)}function a(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function h(t){return a(t)&&t.parent}function u(t){return!!Object.getPrototypeOf(t.parent)}function c(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,{ELEMENT_NODE:r,DOCUMENT_FRAGMENT_NODE:n}=Node,o=t;for(;null!=o&&o!==i;){let{nodeType:t,nodeName:i}=o;if(t===r&&(e.includes(i)||e.includes(o)))return o;let{host:s}=o;o=s&&t===n?s:o.parentNode}return null}function d(t,e,i){let r=[],n=t;for(;n&&(n=c(n,e,i))&&(!i||i.contains(n));)r.push(n),n=n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE?n.host:n.parentNode;let o=r.length;return o?r[o-1]:null}function g(t,e){let i={element:void 0,classNames:[]},r=t;for(;null!==r&&r!==t.ownerDocument.documentElement&&!i.element;){if("string"==typeof e&&r.classList.contains(e))i.element=r,i.classNames.push(e);else if(e instanceof RegExp){let t=Array.from(r.classList).filter(t=>e.test(t));t.length&&(i.element=r,i.classNames.push(...t))}r=r.parentElement}return i}function f(t,e){let i=t.parentNode,r=[];for("string"==typeof e?r=t.defaultView?Array.prototype.slice.call(t.querySelectorAll(e),0):Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):r.push(e);null!==i;){if(r.indexOf(i)>-1)return!0;i=i.parentNode}return!1}function p(t){let e=0,i=t;if(i.previousSibling)for(;i=i.previousSibling;)e+=1;return e}function m(t,e,i){let r=i.parentElement.querySelector(`.ht_clone_${t}`);return r?r.contains(e):null}function w(t){return t&&t.length?t.filter(t=>!!t):[]}function y(t,e){if(!t||!t.length)return e?{regexFree:[],regexes:[]}:[];let i=[],r=[];return r.push(...t.filter(t=>{let r=t instanceof RegExp;return r&&e&&i.push(t),!r})),e?{regexFree:r,regexes:i}:r}function b(t,e){return void 0!==t.classList&&"string"==typeof e&&""!==e&&t.classList.contains(e)}function C(t,e){"string"==typeof e&&(e=e.split(" ")),(e=w(e)).length>0&&t.classList.add(...e)}function S(t,e){"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=y(e,!0);(i=w(i)).length>0&&t.classList.remove(...i),r.forEach(e=>{t.classList.forEach(i=>{e.test(i)&&t.classList.remove(i)})})}function E(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,i]]),e.forEach(e=>{Array.isArray(e)&&""!==e[0]&&t.setAttribute(...e)})}function R(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];"string"==typeof e?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:i,regexes:r}=y(e,!0);i.forEach(e=>{""!==e&&t.removeAttribute(e)}),r.forEach(e=>{t.getAttributeNames().forEach(i=>{e.test(i)&&t.removeAttribute(i)})})}function T(t){let e;for(;e=t.lastChild;)t.removeChild(e)}let x=/(<(.*)>|&(.*);)/;function M(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];x.test(e)?t.innerHTML=i?(0,n.sanitize)(e):e:k(t,e)}function k(t,e){let i=t.firstChild;i&&3===i.nodeType&&null===i.nextSibling?i.textContent=e:(T(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function O(t){let e=t.ownerDocument.defaultView,i=t;for(;i.parentNode;){if("0px"===i.style.height||"0"===i.style.height)return"hidden"===e.getComputedStyle(i).overflow;i=i.parentNode}return!1}function I(t){let e,i,r,n=t.ownerDocument,o=n.defaultView,s=n.documentElement,l=t;for(e=l.offsetLeft,i=l.offsetTop,r=l;(l=l.offsetParent)&&l!==n.body&&"offsetLeft"in l;)e+=l.offsetLeft,i+=l.offsetTop,r=l;return r&&"fixed"===r.style.position&&(e+=o.pageXOffset||s.scrollLeft,i+=o.pageYOffset||s.scrollTop),{left:e,top:i}}function A(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollY}function N(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;return t.scrollX}function H(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?A(e):t.scrollTop}function P(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return t===e?N(e):t.scrollLeft}function _(t){let e=t.ownerDocument,i=e?e.defaultView:void 0;e||(i=(e=t.document?t.document:t).defaultView);let r=["auto","scroll"],n=t.parentNode;for(;n&&n.style&&e.body!==n;){let{overflow:t,overflowX:e,overflowY:o}=n.style;if([t,e,o].includes("scroll")||({overflow:t,overflowX:e,overflowY:o}=i.getComputedStyle(n),r.includes(t)||r.includes(e)||r.includes(o))||n.clientHeight<=n.scrollHeight+1&&(r.includes(o)||r.includes(t))||n.clientWidth<=n.scrollWidth+1&&(r.includes(e)||r.includes(t)))return n;n=n.parentNode}return i}function D(t){return t.scrollHeight-t.clientHeight}function L(t){return t.scrollWidth-t.clientWidth}function F(t){let e=t.ownerDocument,i=e.defaultView,r=t.parentNode;for(;r&&r.style&&e.body!==r;){if("visible"!==r.style.overflow&&""!==r.style.overflow)return r;let t=i.getComputedStyle(r),e=["scroll","hidden","auto"],n=t.getPropertyValue("overflow"),o=t.getPropertyValue("overflow-y"),s=t.getPropertyValue("overflow-x");if(e.includes(n)||e.includes(o)||e.includes(s))return r;r=r.parentNode}return i}function V(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window;if(!t)return;if(t===i)return"width"===e?`${i.innerWidth}px`:"height"===e?`${i.innerHeight}px`:void 0;let r=t.style[e];if(""!==r&&void 0!==r)return r;let n=i.getComputedStyle(t);if(""!==n[e]&&void 0!==n[e])return n[e]}function W(t,e){let{selectorText:i}=e,r=!1;return e.type===CSSRule.STYLE_RULE&&i&&(t.msMatchesSelector?r=t.msMatchesSelector(i):t.matches&&(r=t.matches(i))),r}function B(t){return t.offsetWidth}function j(t){return t.offsetHeight}function z(t){return t.clientHeight||t.innerHeight}function U(t){return t.clientWidth||t.innerWidth}function $(t,e,i){t.addEventListener(e,i,!1)}function Y(t,e,i){t.removeEventListener(e,i,!1)}function G(t){return t.selectionStart?t.selectionStart:0}function q(t){return t.selectionEnd?t.selectionEnd:0}function X(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window,e=t.document,i="";return t.getSelection?i=t.getSelection().toString():e.selection&&"Control"!==e.selection.type&&(i=e.selection.createRange().text),i}function K(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function J(t,e,i){if(void 0===i&&(i=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,i)}catch(o){let r=t.parentNode,n=r.style.display;r.style.display="block",t.setSelectionRange(e,i),r.style.display=n}}}function Q(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document;return void 0===r&&(r=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,e=t.createElement("div");e.style.height="200px",e.style.width="100%";let i=t.createElement("div");i.style.boxSizing="content-box",i.style.height="150px",i.style.left="0px",i.style.overflow="hidden",i.style.position="absolute",i.style.top="0px",i.style.width="200px",i.style.visibility="hidden",i.appendChild(e),(t.body||t.documentElement).appendChild(i);let r=e.offsetWidth;i.style.overflow="scroll";let n=e.offsetWidth;return r===n&&(n=i.clientWidth),(t.body||t.documentElement).removeChild(i),r-n}(t)),r}function Z(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function tt(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function te(t,e,i){t.style.transform=`translate3d(${e},${i},0)`}function ti(t){let e;return t.style.transform&&""!==(e=t.style.transform)?["transform",e]:-1}function tr(t){t.style.transform&&""!==t.style.transform&&(t.style.transform="")}function tn(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||"true"===t.contentEditable)}function to(t){return tn(t)&&!1===t.hasAttribute("data-hot-input")}function ts(t){to(t.ownerDocument.activeElement)||t.select()}function tl(t){return!t.parentNode}function ta(t,e){new IntersectionObserver((i,r)=>{i.forEach(i=>{i.isIntersecting&&null!==t.offsetParent&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function th(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=t.ownerDocument,n=r.createRange(),s=r.defaultView.getSelection();E(t,"contenteditable",!0),i&&E(t,...(0,o.MG)()),e&&C(t,"invisibleSelection"),n.selectNodeContents(t),s.removeAllRanges(),s.addRange(n)}function tu(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),i.removeAllRanges(),e&&S(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function tc(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];th(t,i),e(),tu(t,i)}function td(t){var e;let i=null==t||null===(e=t.ownerDocument)||void 0===e?void 0:e.defaultView.Element;return!!(i&&null!==i&&t instanceof i)}},33920:(t,e,i)=>{"use strict";i.d(e,{s:()=>R}),i(41658);var r=i(89658),n=i(13115);i(19398),i(12252),i(29954),i(20775),i(85522);let o=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),s=t=>t.map(t=>{let e=t.toLowerCase();return o.has(e)?o.get(e):e}).sort().join("+"),l=t=>t.split("+"),a=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),h=t=>{let{which:e,key:i}=t;if(a.has(e))return a.get(e);let r=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(r)?r:i.toLowerCase()};var u=i(78887),c=i(75708),d=i(19857),g=i(83457);let f=Symbol("shortcut-context");function p(t){return(0,d.isObject)(t)&&t.__kindOf===f}let m=t=>{let e=(0,r.u)({errorIdExists:e=>`The "${e}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:t,callback:i,group:r,runOnlyIf:n=()=>!0,captureCtrl:o=!1,preventDefault:l=!0,stopPropagation:a=!1,relativeToGroup:h,position:d,forwardToContext:f}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,u.isUndefined)(r))throw Error("You need to define the shortcut's group.");if(!1===(0,c.isFunction)(i))throw Error("The shortcut's callback needs to be a function.");if(!1===Array.isArray(t))throw Error((0,g.O)`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);let m={callback:i,group:r,runOnlyIf:n,captureCtrl:o,preventDefault:l,stopPropagation:a};(0,u.isDefined)(h)&&(m.relativeToGroup=h,m.position=d),p(f)&&(m.forwardToContext=f),t.forEach(t=>{let i=s(t);if(e.hasItem(i)){let t=e.getItem(i),r=t.findIndex(t=>t.group===h);-1!==r?"before"===d?r-=1:r+=1:r=t.length,t.splice(r,0,m)}else e.addItem(i,[m])})},n=t=>{let i=s(t);e.removeItem(i)};return{__kindOf:f,addShortcut:i,addShortcuts:function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.forEach(t=>{(0,d.objectEach)(e,(i,r)=>{!1===Object.prototype.hasOwnProperty.call(t,r)&&(t[r]=e[r])}),i(t)})},getShortcuts:t=>{let i=s(t),r=e.getItem(i);return(0,u.isDefined)(r)?r.slice():[]},hasShortcut:t=>{let i=s(t);return e.hasItem(i)},removeShortcutsByKeys:n,removeShortcutsByGroup:t=>{e.getItems().forEach(e=>{let[i,r]=e,o=r.filter(e=>e.group!==t);0===o.length?n(l(i)):(r.length=0,r.push(...o))})}}};i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var w=i(33787),y=i(59594);let b=["meta","alt","shift","control"],C=function(){let t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed:e=>t.has(e)}}(),S=[],E=0,R=t=>{let{ownerWindow:e,handleEvent:i,beforeKeyDown:o,afterKeyDown:s}=t,l=(0,r.u)({errorIdExists:t=>`The "${t}" context name is already registered.`}),a="grid",u=()=>a,c=t=>l.getItem(t),d=!1,f=function(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u(),r=p(i)?i:c(i),o=!1;if(!r.hasShortcut(e))return o;let s=r.getShortcuts(e);for(let i=0;i<s.length;i++){let{callback:r,runOnlyIf:l,preventDefault:a,stopPropagation:h,captureCtrl:u,forwardToContext:c}=s[i];if(!0===l(t)){if(d=u,o=!1===r(t,e),d=!1,a&&t.preventDefault(),h&&((0,n.stopImmediatePropagation)(t),t.stopPropagation()),o)break;c&&f(t,e,c)}}return o},R=function(t,e,i,r,o){let s=t=>b.includes(t),l=function(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=[];return t.altKey&&i.push("alt"),e&&(t.ctrlKey||t.metaKey)?i.push("control/meta"):(t.ctrlKey&&i.push("control"),t.metaKey&&i.push("meta")),t.shiftKey&&i.push("shift"),i},a=t=>{if(!1===e(t)||!1===i(t)||229===t.keyCode||"string"!=typeof t.key||(0,n.isImmediatePropagationStopped)(t))return;let a=h(t),u=[];s(a)||(u=l(t)),!o(t,[a].concat(u))&&((0,y.isMacOS)()&&u.includes("meta")||!(0,y.isMacOS)()&&u.includes("control"))&&o(t,[a].concat(l(t,!0))),r(t)},u=t=>{if("string"==typeof t.key){let e=h(t);s(e)&&C.press(e)}},c=t=>{if("string"==typeof t.key){let e=h(t);s(e)&&C.release(e)}},d=()=>{C.releaseAll()};return{mount:()=>{let e=t;for(E+=1;e;)1===E&&(e.document.documentElement.addEventListener("keydown",u),S.push({event:"keydown",listener:u}),e.document.documentElement.addEventListener("keyup",c),S.push({event:"keyup",listener:c})),e.document.documentElement.addEventListener("keydown",a),e.document.documentElement.addEventListener("blur",d),e=(0,w.getParentWindow)(e)},unmount:()=>{let e=t;for(E-=1;e;){if(0===E){for(let t=0;t<S.length;t++){let{event:i,listener:r}=S[t];e.document.documentElement.removeEventListener(i,r)}S.length=0}e.document.documentElement.removeEventListener("keydown",a),e.document.documentElement.removeEventListener("blur",d),e=(0,w.getParentWindow)(e)}},isPressed:t=>C.isPressed(t),releasePressedKeys:()=>C.releaseAll()}}(e,i,o,s,f);return R.mount(),{addContext:t=>{let e=m(t);return l.addItem(t,e),e},getActiveContextName:u,getContext:c,setActiveContextName:t=>{if(!l.hasItem(t))throw Error((0,g.O)`You've tried to activate the "${t}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=t},isCtrlPressed:()=>!d&&(R.isPressed("control")||R.isPressed("meta")),releasePressedKeys:()=>R.releasePressedKeys(),destroy:()=>R.unmount()}}},34138:(t,e,i)=>{"use strict";i.d(e,{z:()=>o});var r=i(49291),n=i(89447);function o(t,e,i){let o=(0,n.a)(t,null==i?void 0:i.in),s=Math.trunc(o.getMonth()/3)+1;return(0,r.Z)(o,o.getMonth()+3*(e-s))}},34175:(t,e,i)=>{"use strict";var r=i(56963),n=i(32138);t.exports=!r(function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",n(1,7)),7!==t.stack)})},34323:(t,e,i)=>{"use strict";var r=i(93840),n=i(56963),o=i(99365),s=i(95467),l=i(14412),a=i(58958).CONFIGURABLE,h=i(72132),u=i(82831),c=u.enforce,d=u.get,g=String,f=Object.defineProperty,p=r("".slice),m=r("".replace),w=r([].join),y=l&&!n(function(){return 8!==f(function(){},"length",{value:8}).length}),b=String(String).split("String"),C=t.exports=function(t,e,i){"Symbol("===p(g(e),0,7)&&(e="["+m(g(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),i&&i.getter&&(e="get "+e),i&&i.setter&&(e="set "+e),(!s(t,"name")||a&&t.name!==e)&&(l?f(t,"name",{value:e,configurable:!0}):t.name=e),y&&i&&s(i,"arity")&&t.length!==i.arity&&f(t,"length",{value:i.arity});try{i&&s(i,"constructor")&&i.constructor?l&&f(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var r=c(t);return s(r,"source")||(r.source=w(b,"string"==typeof e?e:"")),t};Function.prototype.toString=C(function(){return o(this)&&d(this).source||h(this)},"toString")},34498:(t,e,i)=>{"use strict";var r=i(53469);t.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(r)},34760:(t,e,i)=>{"use strict";i(93277)},34988:(t,e,i)=>{"use strict";var r=i(99365),n=i(24851),o=i(34323),s=i(7687);t.exports=function(t,e,i,l){l||(l={});var a=l.enumerable,h=void 0!==l.name?l.name:e;if(r(i)&&o(i,h,l),l.global)a?t[e]=i:s(e,i);else{try{l.unsafe?t[e]&&(a=!0):delete t[e]}catch(t){}a?t[e]=i:n.f(t,e,{value:i,enumerable:!1,configurable:!l.nonConfigurable,writable:!l.nonWritable})}return t}},35279:()=>{},35889:(t,e,i)=>{"use strict";var r=i(93840),n=i(56963),o=i(85592),s=Object,l=r("".split);t.exports=n(function(){return!s("z").propertyIsEnumerable(0)})?function(t){return"String"===o(t)?l(t,""):s(t)}:s},36096:(t,e,i)=>{"use strict";var r=i(16569),n=String,o=TypeError;t.exports=function(t){if(r(t))return t;throw new o("Can't set "+n(t)+" as a prototype")}},36425:(t,e,i)=>{"use strict";i.d(e,{JP:()=>o,K5:()=>s,Wz:()=>n,yn:()=>l});let r=new WeakMap,n=Symbol("rootInstance");function o(t){r.set(t,!0)}function s(t){return t===n}function l(t){return r.has(t)}},36489:(t,e,i)=>{"use strict";i.d(e,{q:()=>n});var r=i(89447);function n(t,e){return(0,r.a)(t,null==e?void 0:e.in).getHours()}},37e3:(t,e,i)=>{"use strict";var r=i(95467),n=i(9329),o=i(64897),s=i(24851);t.exports=function(t,e,i){for(var l=n(e),a=s.f,h=o.f,u=0;u<l.length;u++){var c=l[u];r(t,c)||i&&r(i,c)||a(t,c,h(e,c))}}},37223:(t,e,i)=>{"use strict";i.d(e,{a:()=>n});var r=i(48882);function n(t,e,i){return(0,r.P)(t,-e,i)}},37412:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("every",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{every:function(t){l(this);try{s(t)}catch(t){h(this,"throw",t)}if(u)return n(u,this,t);var e=a(this),i=0;return!o(e,function(e,r){if(!t(e,i++))return r()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},37889:(t,e,i)=>{"use strict";var r=i(87699),n=i(39584),o=r("keys");t.exports=function(t){return o[t]||(o[t]=n(t))}},38516:(t,e,i)=>{"use strict";var r=i(67297),n=i(8883),o=i(7475),s=i(95283);t.exports=function(t,e){e&&"string"==typeof t||n(t);var i=s(t);return o(n(void 0!==i?r(i,t):t))}},38619:(t,e,i)=>{"use strict";i.d(e,{g:()=>n});var r=i(89447);function n(t,e,i){let n=(0,r.a)(t,null==i?void 0:i.in);return n.setMinutes(e),n}},38896:(t,e,i)=>{"use strict";var r=i(50320),n=i(56135);t.exports=function(t,e){var i=t[e];return n(i)?void 0:r(i)}},38991:(t,e,i)=>{"use strict";i.d(e,{A:()=>o});var r=i(7239),n=i(89447);function o(t,e,i){return(0,r.w)((null==i?void 0:i.in)||t,+(0,n.a)(t)+e)}},39584:(t,e,i)=>{"use strict";var r=i(93840),n=0,o=Math.random(),s=r(1.1.toString);t.exports=function(t){return"Symbol("+(void 0===t?"":t)+")_"+s(++n+o,36)}},39615:(t,e,i)=>{"use strict";var r=i(7411),n=TypeError;t.exports=function(t,e){if(r(e,t))return t;throw new n("Incorrect invocation")}},39624:(t,e,i)=>{"use strict";i.d(e,{z:()=>n});var r=i(48882);function n(t,e,i){return(0,r.P)(t,3*e,i)}},40150:(t,e,i)=>{"use strict";i.d(e,{p:()=>n});var r=i(38991);function n(t,e,i){return(0,r.A)(t,1e3*e,i)}},40392:(t,e,i)=>{"use strict";var r=i(7107)("toStringTag"),n={};n[r]="z",t.exports="[object z]"===String(n)},40714:(t,e,i)=>{"use strict";i.d(e,{f:()=>o});var r=i(7239),n=i(89447);function o(t,e,i){let o=(0,n.a)(t,null==i?void 0:i.in);return isNaN(e)?(0,r.w)((null==i?void 0:i.in)||t,NaN):(e&&o.setDate(o.getDate()+e),o)}},40861:(t,e,i)=>{"use strict";i.d(e,{Ss:()=>a,ef:()=>s,xM:()=>l});let r=/^D+$/,n=/^Y+$/,o=["D","DD","YY","YYYY"];function s(t){return r.test(t)}function l(t){return n.test(t)}function a(t,e,i){let r=function(t,e,i){let r="Y"===t[0]?"years":"days of the month";return"Use `".concat(t.toLowerCase(),"` instead of `").concat(t,"` (in `").concat(e,"`) for formatting ").concat(r," to the input `").concat(i,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md")}(t,e,i);if(console.warn(r),o.includes(t))throw RangeError(r)}},40949:(t,e,i)=>{"use strict";var r=i(93840),n=Error,o=r("".replace),s=String(new n("zxcasd").stack),l=/\n\s*at [^:]*:[^\n]*/,a=l.test(s);t.exports=function(t,e){if(a&&"string"==typeof t&&!n.prepareStackTrace)for(;e--;)t=o(t,l,"");return t}},41312:(t,e,i)=>{"use strict";var r=i(94272),n=i(57580),o=i(69905),s=i(15743);t.exports=function(t){var e=r(this),i=s(t);return!(n(e)>i.size)&&!1!==o(e,function(t){if(!i.includes(t))return!1},!0)}},41658:(t,e,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(62495),s=i(15625),l="WebAssembly",a=n[l],h=7!==Error("e",{cause:7}).cause,u=function(t,e){var i={};i[t]=s(t,e,h),r({global:!0,constructor:!0,arity:1,forced:h},i)},c=function(t,e){if(a&&a[t]){var i={};i[t]=s(l+"."+t,e,h),r({target:l,stat:!0,constructor:!0,arity:1,forced:h},i)}};u("Error",function(t){return function(e){return o(t,this,arguments)}}),u("EvalError",function(t){return function(e){return o(t,this,arguments)}}),u("RangeError",function(t){return function(e){return o(t,this,arguments)}}),u("ReferenceError",function(t){return function(e){return o(t,this,arguments)}}),u("SyntaxError",function(t){return function(e){return o(t,this,arguments)}}),u("TypeError",function(t){return function(e){return o(t,this,arguments)}}),u("URIError",function(t){return function(e){return o(t,this,arguments)}}),c("CompileError",function(t){return function(e){return o(t,this,arguments)}}),c("LinkError",function(t){return function(e){return o(t,this,arguments)}}),c("RuntimeError",function(t){return function(e){return o(t,this,arguments)}})},41973:(t,e,i)=>{"use strict";i.d(e,{o:()=>a,p:()=>l}),i(41658),i(12252),i(20775);var r=i(78887),n=i(19857),o=i(81174);let s=0;class l{constructor(){!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"collection",new Map)}register(t,e){!1===this.collection.has(t)&&(this.collection.set(t,e),e.addLocalHook("change",()=>this.runLocalHooks("change",e)),s+=1)}unregister(t){let e=this.collection.get(t);(0,r.isDefined)(e)&&(e.destroy(),this.collection.delete(t),this.runLocalHooks("change",e),s-=1)}unregisterAll(){this.collection.forEach((t,e)=>this.unregister(e)),this.collection.clear()}get(t){return(0,r.isUndefined)(t)?Array.from(this.collection.values()):this.collection.get(t)}getLength(){return this.collection.size}removeFromEvery(t){this.collection.forEach(e=>{e.remove(t)})}insertToEvery(t,e){this.collection.forEach(i=>{i.insert(t,e)})}initEvery(t){this.collection.forEach(e=>{e.init(t)})}}function a(){return s}(0,n.mixin)(l,o.A)},42001:(t,e,i)=>{"use strict";var r=i(34988);t.exports=function(t,e,i){for(var n in e)r(t,n,e[n],i);return t}},42220:(t,e,i)=>{"use strict";i.d(e,{Ay:()=>wF});var r,n,o,s,l,a={};i.r(a),i.d(a,{getNormalizedDate:()=>ei});var h=i(52763),u=i(36425),c=i(5322),d=i(16880),g=i(24113),f=i(59149);i(41658);var p=i(33773),m=i(57555),w=i(59594),y=i(33787),b=i(13455);function C(t,e,i){t.addEventListener(e,i,!1)}function S(t,e,i){t.removeEventListener(e,i,!1)}function E(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function R(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:t=>t.value,...i},n=t.body,o=t.createTextNode(""),s=t.createElement("span");function l(){var t,i;o.textContent=r.textContent(e),s.style.position="absolute",s.style.fontSize=E(e).fontSize,s.style.fontFamily=E(e).fontFamily,s.style.whiteSpace="pre",n.appendChild(s);let l=parseInt((null===(t=E(e))||void 0===t?void 0:t.paddingInlineStart)||0,10),a=parseInt((null===(i=E(e))||void 0===i?void 0:i.paddingInlineEnd)||0,10),h=s.clientWidth+l+a+1;n.removeChild(s);let u=e.style;u.height=`${r.minHeight}px`,r.minWidth>h?u.width=`${r.minWidth}px`:h>r.maxWidth?u.width=`${r.maxWidth}px`:u.width=`${h}px`;let c=e.scrollHeight?e.scrollHeight-1:0;r.minHeight>c?u.height=`${r.minHeight}px`:r.maxHeight<c?(u.height=`${r.maxHeight}px`,u.overflowY="visible"):u.height=`${c}px`}function a(){t.defaultView.setTimeout(l,0)}return{init:function(t,i){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=t;if(i&&i.minHeight)if("inherit"===i.minHeight)r.minHeight=e.clientHeight;else{let t=parseInt(i.minHeight,10);isNaN(t)||(r.minHeight=t)}if(i&&i.maxHeight)if("inherit"===i.maxHeight)r.maxHeight=e.clientHeight;else{let t=parseInt(i.maxHeight,10);isNaN(t)||(r.maxHeight=t)}if(i&&i.minWidth)if("inherit"===i.minWidth)r.minWidth=e.clientWidth;else{let t=parseInt(i.minWidth,10);isNaN(t)||(r.minWidth=t)}if(i&&i.maxWidth)if("inherit"===i.maxWidth)r.maxWidth=e.clientWidth;else{let t=parseInt(i.maxWidth,10);isNaN(t)||(r.maxWidth=t)}s.firstChild||(s.className="autoResize",s.style.display="inline-block",s.appendChild(o)),"TEXTAREA"===e.nodeName&&(e.style.resize="none",e.style.height=`${r.minHeight}px`,e.style.minWidth=`${r.minWidth}px`,e.style.maxWidth=`${r.maxWidth}px`,e.style.overflowY="hidden"),n&&(C(e,"input",l),C(e,"keydown",a)),l()},resize:l,unObserve(){S(e,"input",l),S(e,"keydown",a)}}}var T=i(78887);function x(t,e){let i=(0,y.getCaretPosition)(e),r=e.value.split("\n"),n=i,o=0;for(let e=0;e<r.length;e++){let s=r[e];0!==e&&(o+=r[e-1].length+1);let l=o+s.length;if("home"===t?n=o:"end"===t&&(n=l),i<=l)break}(0,y.setCaretPosition)(e,n)}var M=i(91748);function k(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let O="ht_editor_hidden",I="textEditor";class A extends p.b7{static get EDITOR_TYPE(){return"text"}constructor(t){super(t),k(this,"eventManager",new m.A(this)),k(this,"autoResize",R(this.hot.rootDocument)),k(this,"TEXTAREA",void 0),k(this,"textareaStyle",void 0),k(this,"TEXTAREA_PARENT",void 0),k(this,"textareaParentStyle",void 0),k(this,"layerClass",void 0),this.eventManager=new m.A(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(t){this.TEXTAREA.value=t}open(){this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this.autoResize.unObserve(),(0,y.isInternalElement)(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(t,e,i,r,n,o){let s=this.state;if(super.prepare(t,e,i,r,n,o),!o.readOnly){this.refreshDimensions(!0);let{allowInvalid:t}=o;t&&!this.isOpened()&&(this.TEXTAREA.value=""),s===p._T.FINISHED||this.isOpened()||this.hideEditableElement()}}beginEditing(t,e){this.state===p._T.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(t,e))}focus(){this.TEXTAREA.select(),(0,y.setCaretPosition)(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){let{rootDocument:t}=this.hot;this.TEXTAREA=t.createElement("TEXTAREA"),(0,y.setAttribute)(this.TEXTAREA,[["data-hot-input",""],(0,M.vC)(-1)]),(0,y.addClass)(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=t.createElement("DIV"),(0,y.addClass)(this.TEXTAREA_PARENT,"handsontableInputHolder"),(0,y.hasClass)(this.TEXTAREA_PARENT,this.layerClass)&&(0,y.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,y.addClass)(this.TEXTAREA_PARENT,O),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){(0,w.isEdge)()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",(0,y.removeClass)(this.TEXTAREA_PARENT,this.layerClass),(0,y.addClass)(this.TEXTAREA_PARENT,O)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";let t=this.TEXTAREA_PARENT.childNodes,e=!1;(0,b.rangeEach)(t.length-1,i=>{let r=t[i];if((0,y.hasClass)(r,"handsontableEditor"))return e=!0,!1}),(0,y.hasClass)(this.TEXTAREA_PARENT,O)&&(0,y.removeClass)(this.TEXTAREA_PARENT,O),e?this.layerClass="ht_editor_visible":this.layerClass=this.getEditedCellsLayerClass(),(0,y.addClass)(this.TEXTAREA_PARENT,this.layerClass)}refreshValue(){let t=this.hot.toPhysicalRow(this.row),e=this.hot.getSourceDataAtCell(t,this.col);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.state!==p._T.EDITING&&!t)return;if(this.TD=this.getEditedCell(),!this.TD){t||this.close();return}let{top:e,start:i,width:r,maxWidth:n,height:o,maxHeight:s}=this.getEditedCellRect();this.textareaParentStyle.top=`${e}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();let l=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=l.fontSize,this.TEXTAREA.style.fontFamily=l.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,n),minHeight:Math.min(o,s),maxWidth:n,maxHeight:s},!0)}bindEvents(){(0,w.isIOS)()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===p._T.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===p._T.EDITING&&this.focus()})}allowKeyEventPropagation(){}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor"),e=()=>{this.hot.rootDocument.execCommand("insertText",!1,"\n")};t.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(e(),!1),runOnlyIf:t=>!this.hot.selection.isMultiple()&&!t.altKey},{keys:[["Meta","Enter"]],callback:()=>(e(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(e(),!1)},{keys:[["Home"]],callback:(t,e)=>{let[i]=e;x(i,this.TEXTAREA)}},{keys:[["End"]],callback:(t,e)=>{let[i]=e;x(i,this.TEXTAREA)}}],{runOnlyIf:()=>(0,T.isDefined)(this.hot.getSelected()),group:I})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(I)}}function N(t,e,i,r,n,o,s){let l=s.ariaTags,a=[],h=[],u=[],c=[];s.className&&(0,y.addClass)(e,s.className),s.readOnly?(a.push(s.readOnlyCellClassName),l&&c.push((0,M.u8)())):l&&u.push((0,M.u8)()[0]),!1===s.valid&&s.invalidCellClassName?(a.push(s.invalidCellClassName),l&&c.push((0,M.PF)())):(h.push(s.invalidCellClassName),l&&u.push((0,M.PF)()[0])),!1===s.wordWrap&&s.noWordWrapClassName&&a.push(s.noWordWrapClassName),!o&&s.placeholder&&a.push(s.placeholderCellClassName),(0,y.removeClass)(e,h),(0,y.addClass)(e,a),(0,y.removeAttribute)(e,u),(0,y.setAttribute)(e,c)}function H(t,e,i,r,n,o,s){N.apply(this,[t,e,i,r,n,o,s]);let l=o;!l&&s.placeholder&&(l=s.placeholder),l=(0,T.stringify)(l),s.trimWhitespace&&(l=l.trim()),(0,y.fastInnerText)(e,l)}i(19398),N.RENDERER_TYPE="base",H.RENDERER_TYPE="text";let P={CELL_TYPE:"text",editor:A,renderer:H};var _=i(73183),D=i(71190);function L(t,e){let i=new h.A(t,e||{},u.Wz);return i.init(),i}(0,f.Gk)(P),L.editors={BaseEditor:p.b7},L.Core=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new h.A(t,e,u.Wz)},L.DefaultSettings=(0,c.A)(),L.hooks=d.R.getSingleton(),L.CellCoords=_.A,L.CellRange=D.A,L.packageName="handsontable",L.buildDate="24/04/2025 10:59:00",L.version="15.3.0",L.languages={dictionaryKeys:g.nF,getLanguageDictionary:g.bN,getLanguagesDictionaries:g.W5,registerLanguageDictionary:g.eb,getTranslatedPhrase:g.E9},i(12252),i(29954),i(21591),i(43942);var F=i(13115),V=i(19857),W=i(7346);let B="handsontableEditor";class j extends A{static get EDITOR_TYPE(){return"handsontable"}open(){super.open();let t=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),t.width="",t.height="",t.overflow=""),"none"===t.display&&(t.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),(0,y.setCaretPosition)(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),this.refreshDimensions()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o);let s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(t,e){let i=this.getSourceData(e.row,e.col);void 0!==i&&s.setValue(i),s.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&(0,V.extend)(l,o.handsontable),this.htOptions=l}beginEditing(t,e){let i=this.hot.getSettings().onBeginEditing;i&&!1===i()||super.beginEditing(t,e)}createElements(){super.createElements();let t=this.hot.rootDocument.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.assignHooks()}finishEditing(t,e,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedLast()){let t=this.htEditor.getValue();void 0!==t&&this.setValue(t)}super.finishEditing(t,e,i)}getHeight(){return this.htEditor.view.getTableHeight()+1}getWidth(){return this.htEditor.view.getTableWidth()}assignHooks(){this.hot.addHook("afterDestroy",()=>{var t;null===(t=this.htEditor)||void 0===t||t.destroy()}),this.hot.addHook("afterSetTheme",(t,e)=>{if(!e){var i;null===(i=this.htEditor)||void 0===i||i.useTheme(t)}})}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();let e={group:B,relativeToGroup:W.b,position:"before"},i=(t,e)=>{let i=this.htEditor;if(void 0!==t&&(t<0||i.flipped&&t>i.countRows()-1?i.deselectCell():i.selectCell(t,0),i.getData().length))return e.preventDefault(),(0,F.stopImmediatePropagation)(e),this.hot.listen(),this.TEXTAREA.focus(),!1};t.addShortcuts([{keys:[["ArrowUp"]],callback:t=>{let e,r,n=this.htEditor;return!n.getSelectedLast()&&n.flipped?e=n.countRows()-1:n.getSelectedLast()&&(e=n.flipped?Math.max(0,n.getSelectedLast()[0]-1):n.getSelectedLast()[0]-1),i(e,t)},preventDefault:!1},{keys:[["ArrowDown"]],callback:t=>{let e,r=this.htEditor;return r.getSelectedLast()||r.flipped?r.getSelectedLast()&&(r.flipped?e=r.getSelectedLast()[0]+1:!r.flipped&&(e=Math.min(r.countRows()-1,r.getSelectedLast()[0]+1))):e=0,i(e,t)},preventDefault:!1}],e)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(B)}}var z=i(95061),U=i(93924),$=i(79791),Y=i(75708);function G(t,e,i){q(t,e),e.set(t,i)}function q(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function X(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function K(t,e){return t.get(J(t,e))}function J(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var Q=new WeakMap,Z=new WeakMap,tt=new WeakSet;class te extends j{constructor(){super(...arguments),function(t,e){q(t,e),e.add(t)}(this,tt),X(this,"query",null),X(this,"strippedChoices",[]),X(this,"rawChoices",[]),G(this,Q,this.hot.guid.slice(0,9)),G(this,Z,(0,Y.debounce)(()=>{this.focus()},100)),X(this,"sortByRelevance",function(t,e,i){let r,n,o,s,l=[],a=[],h=t.length,u=e.length;if(0===h){for(o=0;o<u;o++)a.push(o);return a}for(o=0;o<u;o++){if(n=(0,U.stripTags)((0,T.stringify)(e[o])),i)s=n.indexOf(t);else{let e=this.cellProperties.locale;s=n.toLocaleLowerCase(e).indexOf(t.toLocaleLowerCase(e))}-1!==s&&(r=n.length-s-h,l.push({baseIndex:o,index:s,charsLeft:r,value:n}))}for(l.sort((t,e)=>{if(-1===e.index)return -1;if(-1===t.index)return 1;if(t.index<e.index)return -1;if(e.index<t.index)return 1;if(t.index===e.index){if(t.charsLeft<e.charsLeft)return -1;else if(t.charsLeft>e.charsLeft)return 1}return 0}),o=0,u=l.length;o<u;o++)a.push(l[o].baseIndex);return a})}static get EDITOR_TYPE(){return"autocomplete"}getValue(){let t=this.rawChoices.find(t=>this.stripValueIfNeeded(t)===this.TEXTAREA.value);return(0,T.isDefined)(t)?t:this.TEXTAREA.value}createElements(){super.createElements(),(0,y.addClass)(this.htContainer,"autocompleteEditor"),(0,y.addClass)(this.htContainer,-1===this.hot.rootWindow.navigator.platform.indexOf("Mac")?"":"htMacScroll"),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.TEXTAREA,[(0,M.ZW)(),(0,M.B6)(),(0,M.wP)("listbox"),(0,M.gq)()])}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.TEXTAREA,[(0,M.dV)("false"),(0,M.Ku)(`${K(Q,this)}-listbox-${t}-${e}`)])}open(){super.open();let t=void 0===this.cellProperties.trimDropdown||this.cellProperties.trimDropdown,e=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=null==i?void 0:i.length,{row:n,col:o}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",t=>this.onBeforeKeyDown(t)),this.htEditor.addHook("afterScroll",K(Z,this)),this.htEditor.updateSettings({colWidths:t?[(0,y.outerWidth)(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(t,n,o,s,l,a,h)=>{let u,c;H(t,n,o,s,l,a,h);let{filteringCaseSensitive:d,allowHtml:g,locale:f}=this.cellProperties,p=this.query,m=(0,T.stringify)(a);m&&!g&&-1!==(u=!0===d?m.indexOf(p):m.toLocaleLowerCase(f).indexOf(p.toLocaleLowerCase(f)))&&(c=m.substr(u,p.length),m=m.replace(c,`<strong>${c}</strong>`)),e&&(0,y.setAttribute)(n,[(0,M.n)(),...i?[(0,M.DY)(r)]:[],...i?[(0,M.Vy)(i.indexOf(a)+1)]:[],["id",`${this.htEditor.rootElement.id}_${o}-${s}`]]),n.innerHTML=m},afterSelectionEnd:(t,i)=>{if(e){let e=t=>{(0,y.setAttribute)(t,[(0,M.H0)()]),(0,y.setAttribute)(this.TEXTAREA,...(0,M.VN)(t.id))},r=this.htEditor.getCell(t,i,!0);null!==r?e(r):this.htEditor.addHookOnce("afterScrollVertically",()=>{e(this.htEditor.getCell(t,i,!0))})}}}),e&&((0,y.setAttribute)(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...(0,M.gg)()),(0,y.setAttribute)(this.htEditor.rootElement,[(0,M.$o)(),(0,M.S2)("polite"),(0,M.rE)("text"),["id",`${K(Q,this)}-listbox-${n}-${o}`]]),(0,y.setAttribute)(this.TEXTAREA,...(0,M.dV)("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.TEXTAREA,[(0,M.dV)("false")])}discardEditor(t){super.discardEditor(t),this.hot.view.render()}queryChoices(t){let e=this.cellProperties.source;this.query=t,"function"==typeof e?e.call(this.cellProperties,t,t=>{this.rawChoices=t,this.updateChoicesList(this.stripValuesIfNeeded(t))}):Array.isArray(e)?(this.rawChoices=e,this.updateChoicesList(this.stripValuesIfNeeded(e))):this.updateChoicesList([])}updateChoicesList(t){let e=(0,y.getCaretPosition)(this.TEXTAREA),i=(0,y.getSelectionEndPosition)(this.TEXTAREA),r=this.cellProperties.sortByRelevance,n=this.cellProperties.filter,o=null,s=null,l=t;r&&(o=this.sortByRelevance(this.stripValueIfNeeded(this.getValue()),l,this.cellProperties.filteringCaseSensitive));let a=Array.isArray(o)?o.length:0;if(!1===n)a&&(s=o[0]);else{let t=[];for(let e=0,i=l.length;e<i&&(!r||!(a<=e));e++)a?t.push(l[o[e]]):t.push(l[e]);s=0,l=t}this.strippedChoices=l,0===l.length?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData((0,z.pivot)([l])),l.length>0&&(this.updateDropdownDimensions(),this.flipDropdownIfNeeded(),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(s)),this.hot.listen(),(0,y.setCaretPosition)(this.TEXTAREA,e,e===i?void 0:i)}flipDropdownIfNeeded(){let t=this.getEditedCellRect(),e=t.height,i=t.top;this.hot.view.isVerticallyScrollableByWindow()&&(i=Math.max(i+(this.hot.view.getTableOffset().top-this.hot.rootWindow.scrollY),0));let r=this.getHeight(),n=this.hot.view.getWorkspaceHeight()-i-e,o=r>n&&i>n+e;return o?this.flipDropdown(r):this.unflipDropdown(),this.limitDropdownIfNeeded(o?i:n,r),o}limitDropdownIfNeeded(t,e){if(e>t){let i=0,r=0,n=0,o=null;do i+=n=this.htEditor.getRowHeight(r)||this.htEditor.view.getDefaultRowHeight(),r+=1;while(i<t);o=i-n,this.htEditor.flipped&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+e-o}px`),this.setDropdownHeight(i-n)}}flipDropdown(t){let e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-t}px`,this.htEditor.flipped=!0}unflipDropdown(){let t=this.htEditor.rootElement.style;t.position="absolute",t.top="",this.htEditor.flipped=void 0}updateDropdownDimensions(){this.htEditor.updateSettings({width:this.getWidth(),height:this.getHeight()}),J(tt,this,ti).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(t){this.htEditor.updateSettings({height:t}),J(tt,this,ti).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(t){"number"==typeof t?this.htEditor.selectCell(t,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getHeight(){let t=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),e=parseInt(t.borderTopWidth,10)+parseInt(t.borderBottomWidth,10);return Array.from({length:Math.min(this.cellProperties.visibleRows,this.strippedChoices.length)},(t,e)=>e).reduce((t,e)=>t+(this.htEditor.getRowHeight(e)||this.htEditor.view.getDefaultRowHeight()),0)+e+1}getWidth(){let t=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore")),e=parseInt(t.borderInlineStartWidth,10)+parseInt(t.borderInlineEndWidth,10);return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(t){return this.stripValuesIfNeeded([t])[0]}stripValuesIfNeeded(t){let{allowHtml:e}=this.cellProperties,i=(0,z.arrayMap)(t,t=>(0,T.stringify)(t));return(0,z.arrayMap)(i,t=>e?t:(0,U.stripTags)(t))}allowKeyEventPropagation(t){let e=this.htEditor.getSelectedRangeLast(),i={row:e?e.from.row:-1},r=!1;return t===$.KEY_CODES.ARROW_DOWN&&i.row>0&&i.row<this.htEditor.countRows()-1&&(r=!0),t===$.KEY_CODES.ARROW_UP&&i.row>-1&&(r=!0),r}onBeforeKeyDown(t){if((0,$.isPrintableChar)(t.keyCode)||t.keyCode===$.KEY_CODES.BACKSPACE||t.keyCode===$.KEY_CODES.DELETE||t.keyCode===$.KEY_CODES.INSERT){let e=10;t.keyCode===$.KEY_CODES.C&&(t.ctrlKey||t.metaKey)||(this.isOpened()||(e+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},e))}}}function ti(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getWidth()+(0,y.getScrollbarWidth)(this.hot.rootDocument)})}class tr extends p.b7{static get EDITOR_TYPE(){return"checkbox"}beginEditing(t,e){if(e&&"mouseup"===e.type&&"TD"===e.target.nodeName){let t=this.TD.querySelector('input[type="checkbox"]');(0,y.hasClass)(t,"htBadValue")||t.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}var tn=i(82940);let to=()=>window,ts=()=>window.document,tl=(t,e)=>window.setTimeout(t,e),ta=function(t,e,i,r){t.addEventListener(e,i,!!r)},th=function(t,e,i,r){t.removeEventListener(e,i,!!r)},tu=function(t,e){return -1!==(" "+t.className+" ").indexOf(" "+e+" ")},tc=function(t,e){tu(t,e)||(t.className=""===t.className?e:t.className+" "+e)},td=function(t,e){var i;t.className=(i=(" "+t.className+" ").replace(" "+e+" "," ")).trim?i.trim():i.replace(/^\s+|\s+$/g,"")},tg=function(t){return/Array/.test(Object.prototype.toString.call(t))},tf=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},tp=function(t){let e=t.getDay();return 0===e||6===e},tm=function(t,e){return[31,t%4==0&&t%100!=0||t%400==0?29:28,31,30,31,30,31,31,30,31,30,31][e]},tw=function(t){tf(t)&&t.setHours(0,0,0,0)},tv=function(t,e){return t.getTime()===e.getTime()},ty=function(t,e,i){let r,n;for(r in e)(n=void 0!==t[r])&&"object"==typeof e[r]&&null!==e[r]&&void 0===e[r].nodeName?tf(e[r])?i&&(t[r]=new Date(e[r].getTime())):tg(e[r])?i&&(t[r]=e[r].slice(0)):t[r]=ty({},e[r],i):(i||!n)&&(t[r]=e[r]);return t},tb=function(t,e,i){let r=ts().createEvent("HTMLEvents");r.initEvent(e,!0,!1),r=ty(r,i),t.dispatchEvent(r)},tC=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},tS={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},tE=function(t,e,i){for(e+=t.firstDay;e>=7;)e-=7;return i?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},tR=function(t){let e=[],i="false";if(t.isEmpty)if(!t.showDaysInNextAndPreviousMonths)return'<td class="is-empty"></td>';else e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),i="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+i+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},tT=function(t,e){t.setHours(0,0,0,0);let i=t.getDate(),r=t.getDay(),n=e-1,o=function(t){return(t+7-1)%7};t.setDate(i+n-o(r));let s=new Date(t.getFullYear(),0,e);return 1+Math.round(((t.getTime()-s.getTime())/864e5-n+o(s.getDay()))/7)},tx=function(t,e,i,r,n){let o=new Date(r,i,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():tT(o,n))+"</td>"},tM=function(t){let e,i=[];for(t.showWeekNumber&&i.push("<th></th>"),e=0;e<7;e++)i.push('<th scope="col"><abbr title="'+tE(t,e)+'">'+tE(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?i.reverse():i).join("")+"</tr></thead>"},tk=function(t,e,i,r,n,o){let s,l,a,h=t._o,u=i===h.minYear,c=i===h.maxYear,d='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',g,f,p=!0,m=!0;for(a=[],s=0;s<12;s++)a.push('<option value="'+(i===n?s-e:12+s-e)+'"'+(s===r?' selected="selected"':"")+(u&&s<h.minMonth||c&&s>h.maxMonth?' disabled="disabled"':"")+">"+h.i18n.months[s]+"</option>");for(g='<div class="pika-label">'+h.i18n.months[r]+'<select class="pika-select pika-select-month" tabindex="-1">'+a.join("")+"</select></div>",tg(h.yearRange)?(s=h.yearRange[0],l=h.yearRange[1]+1):(s=i-h.yearRange,l=1+i+h.yearRange),a=[];s<l&&s<=h.maxYear;s++)s>=h.minYear&&a.push('<option value="'+s+'"'+(s===i?' selected="selected"':"")+">"+s+"</option>");return f='<div class="pika-label">'+i+h.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+a.join("")+"</select></div>",h.showMonthAfterYear?d+=f+g:d+=g+f,u&&(0===r||h.minMonth>=r)&&(p=!1),c&&(11===r||h.maxMonth<=r)&&(m=!1),0===e&&(d+='<button class="pika-prev'+(p?"":" is-disabled")+'" type="button">'+h.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(d+='<button class="pika-next'+(m?"":" is-disabled")+'" type="button">'+h.i18n.nextMonth+"</button>"),d+"</div>"};function tO(t){let e=this,i=e.config(t);e._onMouseDown=function(t){if(!e._v)return;let r=(t=t||to().event).target||t.srcElement;if(r)if(!tu(r,"is-disabled")&&(!tu(r,"pika-button")||tu(r,"is-empty")||tu(r.parentNode,"is-disabled")?tu(r,"pika-prev")?e.prevMonth():tu(r,"pika-next")&&e.nextMonth():(e.setDate(new Date(r.getAttribute("data-pika-year"),r.getAttribute("data-pika-month"),r.getAttribute("data-pika-day"))),i.bound&&tl(function(){e.hide(),i.blurFieldOnSelect&&i.field&&i.field.blur()},100))),tu(r,"pika-select"))e._c=!0;else{if(!t.preventDefault)return t.returnValue=!1,!1;t.preventDefault()}},e._onChange=function(t){let i=(t=t||to().event).target||t.srcElement;i&&(tu(i,"pika-select-month")?e.gotoMonth(i.value):tu(i,"pika-select-year")&&e.gotoYear(i.value))},e._onKeyChange=function(t){if(t=t||to().event,e.isVisible())switch(t.keyCode){case 13:case 27:i.field&&i.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null)}},e._parseFieldValue=function(){if(i.parse)return i.parse(i.field.value,i.format);if(!this.hasMoment)return new Date(Date.parse(i.field.value));{let t=this.moment(i.field.value,i.format,i.formatStrict);return t&&t.isValid()?t.toDate():null}},e._onInputChange=function(t){let i;t.firedBy===e||(tf(i=e._parseFieldValue())&&e.setDate(i),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let t=ts().activeElement;do if(tu(t,"pika-single"))return;while(t=t.parentNode);e._c||(e._b=tl(function(){e.hide()},50)),e._c=!1},e._onClick=function(t){let r=(t=t||to().event).target||t.srcElement,n=r;if(r){!hasEventListeners&&tu(r,"pika-select")&&!r.onchange&&(r.setAttribute("onchange","return;"),ta(r,"change",e._onChange));do if(tu(n,"pika-single")||n===i.trigger)return;while(n=n.parentNode);e._v&&r!==i.trigger&&n!==i.trigger&&e.hide()}},e.el=ts().createElement("div"),e.el.className="pika-single"+(i.isRTL?" is-rtl":"")+(i.theme?" "+i.theme:""),ta(e.el,"mousedown",e._onMouseDown,!0),ta(e.el,"touchend",e._onMouseDown,!0),ta(e.el,"change",e._onChange),i.keyboardInput&&ta(ts(),"keydown",e._onKeyChange),i.field&&(i.container?i.container.appendChild(e.el):i.bound?ts().body.appendChild(e.el):i.field.parentNode.insertBefore(e.el,i.field.nextSibling),ta(i.field,"change",e._onInputChange),i.defaultDate||(i.defaultDate=e._parseFieldValue(),i.setDefaultDate=!0));let r=i.defaultDate;tf(r)?i.setDefaultDate?e.setDate(r,!0):e.gotoDate(r):e.gotoDate(new Date),i.bound?(this.hide(),e.el.className+=" is-bound",ta(i.trigger,"click",e._onInputClick),ta(i.trigger,"focus",e._onInputFocus),ta(i.trigger,"blur",e._onInputBlur)):this.show()}function tI(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function tA(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}tO.prototype={config:function(t){this._o||(this._o=ty({},tS,!0));let e=ty(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme="string"==typeof e.theme&&e.theme?e.theme:null,e.bound=!!(void 0!==e.bound?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn="function"==typeof e.disableDayFn?e.disableDayFn:null;let i=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=i>4?4:i,tf(e.minDate)||(e.minDate=!1),tf(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),tg(e.yearRange)){let t=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||t,e.yearRange[1]=parseInt(e.yearRange[1],10)||t}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||tS.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return(t=t||this._o.format,tf(this._d))?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return tf(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",tb(this._o.field,"change",{firedBy:this})),this.draw();if("string"==typeof t&&(t=new Date(Date.parse(t))),!tf(t))return;let i=this._o.minDate,r=this._o.maxDate;tf(i)&&t<i?t=i:tf(r)&&t>r&&(t=r),this._d=new Date(t.getTime()),tw(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),tb(this._o.field,"change",{firedBy:this})),e||"function"!=typeof this._o.onSelect||this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(tf(t)){if(this.calendars){let i=new Date(this.calendars[0].year,this.calendars[0].month,1),r=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),n=t.getTime();r.setMonth(r.getMonth()+1),r.setDate(r.getDate()-1),e=n<i.getTime()||r.getTime()<n}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],"right"===this._o.mainCalendar&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let i,r=this.getDate()||new Date,n=24*parseInt(e)*36e5;"add"===t?i=new Date(r.valueOf()+n):"subtract"===t&&(i=new Date(r.valueOf()-n)),this.setDate(i)},adjustCalendars:function(){this.calendars[0]=tC(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=tC({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(tw(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=tS.minDate,this._o.minYear=tS.minYear,this._o.minMonth=tS.minMonth,this._o.startRange=tS.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(tw(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=tS.maxDate,this._o.maxYear=tS.maxYear,this._o.maxMonth=tS.maxMonth,this._o.endRange=tS.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,i=e.minYear,r=e.maxYear,n=e.minMonth,o=e.maxMonth,s="",l;this._y<=i&&(this._y=i,!isNaN(n)&&this._m<n&&(this._m=n)),this._y>=r&&(this._y=r,!isNaN(o)&&this._m>o&&(this._m=o));for(let t=0;t<e.numberOfMonths;t++)l="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),s+='<div class="pika-lendar">'+tk(this,t,this.calendars[t].year,this.calendars[t].month,this.calendars[0].year,l)+this.render(this.calendars[t].year,this.calendars[t].month,l)+"</div>";this.el.innerHTML=s,e.bound&&"hidden"!==e.field.type&&tl(function(){e.trigger.focus()},1),"function"==typeof this._o.onDraw&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,i,r,n,o,s,l,a,h,u;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,i=this.el.offsetHeight,r=to().innerWidth||ts().documentElement.clientWidth,n=to().innerHeight||ts().documentElement.clientHeight,o=ts().body.scrollTop||ts().documentElement.scrollTop,h=!0,u=!0,s=(a=t.getBoundingClientRect()).left+to().pageXOffset,l=a.bottom+to().pageYOffset,(this._o.reposition&&s+e>r||this._o.position.indexOf("right")>-1&&s-e+t.offsetWidth>0)&&(s=s-e+t.offsetWidth,h=!1),(this._o.reposition&&l+i>n+o||this._o.position.indexOf("top")>-1&&l-i-t.offsetHeight>0)&&(l=l-i-t.offsetHeight,u=!1),s<0&&(s=0),l<0&&(l=0),this.el.style.left=s+"px",this.el.style.top=l+"px",tc(this.el,h?"left-aligned":"right-aligned"),tc(this.el,u?"bottom-aligned":"top-aligned"),td(this.el,h?"right-aligned":"left-aligned"),td(this.el,u?"top-aligned":"bottom-aligned"))},render:function(t,e,i){var r,n,o,s;let l=this._o,a=new Date,h=tm(t,e),u=new Date(t,e,1).getDay(),c=[],d=[];tw(a),l.firstDay>0&&(u-=l.firstDay)<0&&(u+=7);let g=0===e?11:e-1,f=11===e?0:e+1,p=0===e?t-1:t,m=11===e?t+1:t,w=tm(p,g),y=h+u,b=y;for(;b>7;)b-=7;y+=7-b;let C=!1;for(let i=0,o=0;i<y;i++){let s=new Date(t,e,1+(i-u)),y=!!tf(this._d)&&tv(s,this._d),b=tv(s,a),S=-1!==l.events.indexOf(s.toDateString()),E=i<u||i>=h+u,R=1+(i-u),T=e,x=t,M=l.startRange&&tv(l.startRange,s),k=l.endRange&&tv(l.endRange,s),O=l.startRange&&l.endRange&&l.startRange<s&&s<l.endRange,I=l.minDate&&s<l.minDate||l.maxDate&&s>l.maxDate||l.disableWeekends&&tp(s)||l.disableDayFn&&l.disableDayFn(s);E&&(i<u?(R=w+R,T=g,x=p):(R-=h,T=f,x=m));let A={day:R,month:T,year:x,hasEvent:S,isSelected:y,isToday:b,isDisabled:I,isEmpty:E,isStartRange:M,isEndRange:k,isInRange:O,showDaysInNextAndPreviousMonths:l.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:l.enableSelectionDaysInNextAndPreviousMonths};if(l.pickWholeWeek&&y&&(C=!0),d.push(tR(A)),7==++o){l.showWeekNumber&&d.unshift(tx(this,i-u,e,t,l.firstWeekOfYearMinDays)),c.push((r=d,n=l.isRTL,'<tr class="pika-row'+(l.pickWholeWeek?" pick-whole-week":"")+(C?" is-selected":"")+'">'+(n?r.reverse():r).join("")+"</tr>")),d=[],o=0,C=!1}}return o=l,s=c,'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+i+'">'+tM(o)+"<tbody>"+s.join("")+"</tbody></table>"},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),td(this.el,"is-hidden"),this._o.bound&&(ta(ts(),"click",this._onClick),this.adjustPosition()),"function"==typeof this._o.onOpen&&this._o.onOpen.call(this))},hide:function(){let t=this._v;!1!==t&&(this._o.bound&&th(ts(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),tc(this.el,"is-hidden"),this._v=!1,void 0!==t&&"function"==typeof this._o.onClose&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),th(this.el,"mousedown",this._onMouseDown,!0),th(this.el,"touchend",this._onMouseDown,!0),th(this.el,"change",this._onChange),t.keyboardInput&&th(ts(),"keydown",this._onKeyChange),t.field&&(th(t.field,"change",this._onInputChange),t.bound&&(th(t.trigger,"click",this._onInputClick),th(t.trigger,"focus",this._onInputFocus),th(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};let tN="date",tH="dateEditor";var tP=new WeakSet;class t_ extends A{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,tP),tI(this,"parentDestroyed",!1),tI(this,"$datePicker",null)}static get EDITOR_TYPE(){return tN}init(){if("function"!=typeof tn)throw Error("You need to include moment.js to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(t,e)=>{e||((0,y.removeClass)(this.datePicker,/ht-theme-.*/g),(0,y.addClass)(this.datePicker,t))})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),(0,y.addClass)(this.datePicker,"htDatepickerHolder");let t=this.hot.getCurrentThemeName();(0,y.removeClass)(this.datePicker,/ht-theme-.*/g),(0,y.addClass)(this.datePicker,t),this.hot.rootDocument.body.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",t=>{(0,y.hasClass)(t.target,"pika-day")&&this.hideDatepicker(),t.stopPropagation()})}destroyElements(){let t=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),t&&t.removeChild(this.datePicker)}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o)}open(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(t),super.open(),e.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:tH})}close(){var t;this._opened=!1,null!==(t=this.$datePicker)&&void 0!==t&&t.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{let t=this.hot._getEditorManager();t.closeEditor(),this.hot.view.render(),t.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tH),super.close()}finishEditing(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];super.finishEditing(t,e)}showDatepicker(t){let e,i=tA(tP,this,tD).call(this),r=this.hot.view.isMouseDown(),n=!!t&&(0,$.isFunctionKey)(t.keyCode);this.datePicker.style.display="block",this.$datePicker=new tO(this.getDatePickerConfig()),"function"==typeof this.$datePicker.useMoment&&this.$datePicker.useMoment(tn),this.$datePicker._onInputFocus=function(){},this.originalValue?(tn(e=this.originalValue,i,!0).isValid()&&this.$datePicker.setMoment(tn(e,i),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),n||r||this.setValue("")):this.cellProperties.defaultDate?(tn(e=this.cellProperties.defaultDate,i,!0).isValid()&&this.$datePicker.setMoment(tn(e,i),!0),n||r||this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var t;let e=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&(0,V.deepExtend)(i,this.cellProperties.datePickerConfig);let r=i.onSelect,n=i.onClose;return i.field=e,i.trigger=e,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=null!==(t=i.format)&&void 0!==t?t:tA(tP,this,tD).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=t=>{let e=t;isNaN(e.getTime())||(e=tn(e).format(tA(tP,this,tD).call(this))),this.setValue(e),r&&r(),(0,w.isMobileBrowser)()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),n&&n()},i}refreshDimensions(t){var e;if(super.refreshDimensions(t),this.state!==p._T.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}let{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:n}=this.hot.view._wt,{wtTable:o}=null!==(e=n.getParentOverlay(this.TD))&&void 0!==e?e:this.hot.view._wt,s=i.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleRow()),l=i.getVisualFromRenderableIndex(o.getLastPartiallyVisibleRow()),a=r.getVisualFromRenderableIndex(o.getFirstPartiallyVisibleColumn()),h=r.getVisualFromRenderableIndex(o.getLastPartiallyVisibleColumn());if(this.row>=s&&this.row<=l&&this.col>=a&&this.col<=h){let t=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+t.top+(0,y.outerHeight)(this.TD)}px`;let e=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?e+=t.right-(0,y.outerWidth)(this.datePicker):e+=t.left,this.datePickerStyle.left=`${e}px`}else this.hideDatepicker()}}function tD(){var t;return null!==(t=this.cellProperties.dateFormat)&&void 0!==t?t:"DD/MM/YYYY"}class tL extends te{static get EDITOR_TYPE(){return"dropdown"}prepare(t,e,i,r,n,o){o.filter=!1,o.strict=!0,super.prepare(t,e,i,r,n,o)}}class tF extends A{static get EDITOR_TYPE(){return"numeric"}}class tV extends A{constructor(){super(...arguments),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"autoResize",R(this.hot.rootDocument,{textContent:t=>"•".repeat(t.value.length)}))}static get EDITOR_TYPE(){return"password"}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,(0,y.empty)(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}let tW="ht_editor_visible",tB="selectEditor";class tj extends p.b7{static get EDITOR_TYPE(){return"select"}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";let t=this.hot.rootDocument.createElement("DIV"),e=this.hot.getSettings().ariaTags;t.className="htAutocompleteArrow",e&&t.setAttribute(...(0,M.MG)()),t.appendChild(this.hot.rootDocument.createTextNode(String.fromCharCode(9660))),(0,y.addClass)(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(t,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(t){this.select.value=t}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",(0,y.hasClass)(this.selectWrapper,tW)&&(0,y.removeClass)(this.selectWrapper,tW),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(t,e,i,r,n,o){let s;super.prepare(t,e,i,r,n,o);let l=this.cellProperties.selectOptions;s="function"==typeof l?this.prepareOptions(l(this.row,this.col,this.prop)):this.prepareOptions(l),(0,y.empty)(this.select),(0,V.objectEach)(s,(t,e)=>{let i=this.hot.rootDocument.createElement("OPTION");i.value=e,(0,y.fastInnerHTML)(i,t),this.select.appendChild(i)})}prepareOptions(t){let e={};if(Array.isArray(t))for(let i=0,r=t.length;i<r;i++)e[t[i]]=t[i];else"object"==typeof t&&(e=t);return e}refreshValue(){let t=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=t,this.setValue(t),this.refreshDimensions()}refreshDimensions(){if(this.state!==p._T.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}let{top:t,start:e,width:i,height:r}=this.getEditedCellRect(),n=this.selectWrapper.style;n.height=`${r}px`,n.width=`${i}px`,n.top=`${t}px`,n[this.hot.isRtl()?"right":"left"]=`${e}px`,n.margin="0px",(0,y.addClass)(this.selectWrapper,tW)}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("editor");this.isInFullEditMode()&&t.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{let t=this.select.selectedIndex-1;t>=0&&(this.select[t].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{let t=this.select.selectedIndex+1;t<=this.select.length-1&&(this.select[t].selected=!0)}}],{group:tB})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(tB)}}class tz extends A{static get EDITOR_TYPE(){return"time"}prepare(t,e,i,r,n,o){super.prepare(t,e,i,r,n,o),this.TEXTAREA.dir="ltr"}}var tU=i(99206);function t$(t,e,i,r,n,o,s){N.apply(this,[t,e,i,r,n,o,s]),(0,y.fastInnerHTML)(e,null==o?"":o,!1)}function tY(t,e,i,r,n,o,s){let{rootDocument:l}=t,a=s.allowHtml?t$:H,h=l.createElement("DIV"),u=t.getSettings().ariaTags;if(h.className="htAutocompleteArrow",u&&h.setAttribute(...(0,M.MG)()),h.appendChild(l.createTextNode(String.fromCharCode(9660))),a.apply(this,[t,e,i,r,n,o,s]),e.firstChild||e.appendChild(l.createTextNode(String.fromCharCode(160))),e.insertBefore(h,e.firstChild),(0,y.addClass)(e,"htAutocomplete"),!t.acArrowListener){let n=new m.A(t);t.acArrowListener=function(n){(0,y.hasClass)(n.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(i,r),e)},n.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{n.destroy()})}}function tG(t,e,i,r,n,o,s){tY.apply(this,[t,e,i,r,n,o,s])}t$.RENDERER_TYPE="html",tY.RENDERER_TYPE="autocomplete",tG.RENDERER_TYPE="dropdown",i(63723),i(85522);var tq=i(95696);let tX=new WeakMap,tK=new WeakMap,tJ="data-row",tQ="data-col",tZ="checkbox";function t0(t,e,i,r,n,o,s){let{rootDocument:l}=t,a=t.getSettings().ariaTags;N.apply(this,[t,e,i,r,n,o,s]),function(t){let e=tK.get(t);if(!e){let{rootElement:i}=t;(e=new m.A(t)).addEventListener(i,"click",e=>(function(t,e){let{target:i}=t;if(!t1(i)||!i.hasAttribute(tJ)||!i.hasAttribute(tQ))return;let r=parseInt(i.getAttribute(tJ),10),n=parseInt(i.getAttribute(tQ),10);e.getCellMeta(r,n).readOnly&&t.preventDefault()})(e,t)),e.addEventListener(i,"mouseup",e=>(function(t,e){let{target:i}=t;t1(i)&&i.hasAttribute(tJ)&&i.hasAttribute(tQ)&&setTimeout(e.listen,10)})(e,t)),e.addEventListener(i,"change",e=>(function(t,e){let{target:i}=t;if(!t1(i)||!i.hasAttribute(tJ)||!i.hasAttribute(tQ))return;let r=parseInt(i.getAttribute(tJ),10),n=parseInt(i.getAttribute(tQ),10),o=e.getCellMeta(r,n);if(!o.readOnly){let i=null;i=t.target.checked?void 0===o.uncheckedTemplate||o.checkedTemplate:void 0!==o.uncheckedTemplate&&o.uncheckedTemplate,e.setDataAtCell(r,n,i)}})(e,t)),tK.set(t,e)}}(t);let h=function(t){let e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}(l),u=s.label,c=!1;if(void 0===s.checkedTemplate&&(s.checkedTemplate=!0),void 0===s.uncheckedTemplate&&(s.uncheckedTemplate=!1),(0,y.empty)(e),o===s.checkedTemplate||(0,T.stringify)(o).toLocaleLowerCase(s.locale)===(0,T.stringify)(s.checkedTemplate).toLocaleLowerCase(s.locale)?h.checked=!0:o===s.uncheckedTemplate||(0,T.stringify)(o).toLocaleLowerCase(s.locale)===(0,T.stringify)(s.uncheckedTemplate).toLocaleLowerCase(s.locale)?h.checked=!1:(0,T.isEmpty)(o)?(0,y.addClass)(h,"noValue"):(h.style.display="none",(0,y.addClass)(h,"htBadValue"),c=!0),(0,y.setAttribute)(h,[[tJ,i],[tQ,r]]),a&&(0,y.setAttribute)(h,[(0,M.SM)(h.checked?t.getTranslatedPhrase(tq.CHECKBOX_CHECKED):t.getTranslatedPhrase(tq.CHECKBOX_UNCHECKED)),(0,M.Xq)(h.checked),(0,M.Pk)()]),!c&&u){let s="";if(u.value)s="function"==typeof u.value?u.value.call(this,i,r,n,o):u.value;else if(u.property){let e=t.getDataAtRowProp(i,u.property);s=null!==e?e:""}let a=function(t,e,i){let r=t.createElement("label");r.className=`htCheckboxRendererLabel ${i?"fullWidth":""}`;let n=t.createTextNode(e);if(i){let e=t.createElement("span");e.appendChild(n),r.appendChild(e)}else r.appendChild(n);return r.cloneNode(!0)}(l,s,!0!==u.separated);"before"===u.position?u.separated?(e.appendChild(a),e.appendChild(h)):(a.appendChild(h),h=a):u.position&&"after"!==u.position||(u.separated?(e.appendChild(h),e.appendChild(a)):(a.insertBefore(h,a.firstChild),h=a))}function d(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=t.getSelectedRange(),r=[],n=new Map,o=[],s=0;if(i){for(let l=0;l<i.length;l++){let{row:a,col:h}=i[l].getTopStartCorner(),{row:u,col:c}=i[l].getBottomEndCorner();for(let i=a;i<=u;i+=1)for(let l=h;l<=c;l+=1){let a=t.getCellMeta(i,l);if(a.hidden)continue;let h={checkedTemplate:a.checkedTemplate,uncheckedTemplate:a.uncheckedTemplate};if("checkbox"!==a.type){!0!==e||a.readOnly||(n.has(r.length)?n.set(r.length,[...n.get(r.length),[i,l,null]]):n.set(r.length,[[i,l,null]]));continue}if(!0===a.readOnly)continue;void 0===a.checkedTemplate&&(a.checkedTemplate=!0),void 0===a.uncheckedTemplate&&(a.uncheckedTemplate=!1);let u=t.getDataAtCell(i,l);!1===e?[a.checkedTemplate,a.checkedTemplate.toString()].includes(u)?o.push([i,l,a.uncheckedTemplate,h]):[a.uncheckedTemplate,a.uncheckedTemplate.toString(),null,void 0].includes(u)&&o.push([i,l,a.checkedTemplate,h]):o.push([i,l,a.uncheckedTemplate,h]),s+=1}r.push(s),s=0}(o=o.every(t=>{let[,,e]=t;return e===o[0][2]})?o.map(t=>{let[e,i,r]=t;return[e,i,r]}):o.map(t=>{let[e,i,,r]=t;return[e,i,r.checkedTemplate]})).length>0&&r.forEach((e,i)=>{let r=o.splice(0,e);n.size&&n.has(i)&&(r=[...r,...n.get(i)]),t.setDataAtCell(r)})}}function g(){let e=t.getSelectedRange();if(e){for(let i=0;i<e.length;i++){let r=e[i].getTopStartCorner(),n=e[i].getBottomEndCorner();for(let e=r.row;e<=n.row;e++)for(let i=r.col;i<=n.col;i++){if(t.getCellMeta(e,i).readOnly)continue;let r=t.getCell(e,i);if((0,y.isHTMLElement)(r)&&r.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}u&&(!u||u.separated)||e.appendChild(h),c&&e.appendChild(l.createTextNode("#bad-value#")),tX.has(t)||(tX.set(t,!0),function(){let e=t.getShortcutManager().getContext("grid"),i={group:"checkboxRenderer",relativeToGroup:W.b,position:"before"};e.addShortcuts([{keys:[["space"]],callback:()=>(d(),!g()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}},{keys:[["enter"]],callback:()=>(d(),!g()),runOnlyIf:()=>{let e=t.getSelectedRangeLast();return t.getSettings().enterBeginsEditing&&(null==e?void 0:e.highlight.isCell())&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(d(!0),!g()),runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isCell()}}],i)}())}function t1(t){return"INPUT"===t.tagName&&"checkbox"===t.getAttribute("type")}function t2(t,e,i,r,n,o,s){tY.apply(this,[t,e,i,r,n,o,s])}d.R.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,i){let{label:r,type:n,row:o,column:s,prop:l}=e;if(n===tZ){if(r){let{value:e,property:n}=r,a=i;if(e)a="function"==typeof e?e(o,s,l,i):e;else if(n){let t=this.getDataAtRowProp(o,n);a=null!==t?t:i}t=a}return t}}),t0.RENDERER_TYPE=tZ,t2.RENDERER_TYPE="handsontable";var t3=i(78420);function t9(t,e){if((0,b.isNumeric)(t)){let i=e.numericFormat,r=i&&i.culture||"-",n=i&&i.pattern;if(void 0!==r&&!t3.A.languages()[r]){let t=r.replace("-",""),e=t3.A.allLanguages?t3.A.allLanguages[r]:t3.A[t];e&&t3.A.registerLanguage(e)}t3.A.setLanguage(r),t=(0,t3.A)(t).format(n||"0")}return t}function t4(t,e,i,r,n,o,s){let l=o;if((0,b.isNumeric)(l)){let t=[];if(Array.isArray(s.className))t=s.className;else{var a;let e=null!==(a=s.className)&&void 0!==a?a:"";e.length&&(t=e.split(" "))}l=t9(l,s),0>t.indexOf("htLeft")&&0>t.indexOf("htCenter")&&0>t.indexOf("htRight")&&0>t.indexOf("htJustify")&&t.push("htRight"),0>t.indexOf("htNumeric")&&t.push("htNumeric"),s.className=t.join(" "),e.dir="ltr"}H(t,e,i,r,n,l,s)}function t5(t,e,i,r,n,o,s){H.apply(this,[t,e,i,r,n,o,s]);let l=s.hashLength||e.innerHTML.length,a=s.hashSymbol||"*",h="";(0,b.rangeEach)(l-1,()=>{h+=a}),(0,y.fastInnerHTML)(e,h)}function t8(t,e,i,r,n,o,s){H.apply(this,[t,e,i,r,n,o,s])}function t7(t,e,i,r,n,o,s){H.apply(this,[t,e,i,r,n,o,s]),e.dir="ltr"}t4.RENDERER_TYPE="numeric",t5.RENDERER_TYPE="password",t8.RENDERER_TYPE="select",t7.RENDERER_TYPE="time";var t6=i(46420);function et(t,e){let i=t;if(null==i&&(i=""),this.allowEmpty&&""===i){e(!0);return}this.strict&&this.source?"function"==typeof this.source?this.source(i,ee(i,e)):ee(i,e)(this.source):e(!0)}function ee(t,e){return function(i){let r=!1;for(let e=0,n=i.length;e<n;e++)if(t===i[e]){r=!0;break}e(r)}}function ei(t){let e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+6e4*e.getTimezoneOffset())}function er(t,e){let i=(0,tU.L3)(tN,this.instance),r=t,n=!0;null==r&&(r="");let o=tn(r,this.dateFormat||i.defaultDateFormat,!0).isValid(),s=tn(new Date(r)).isValid()||o;if(this.allowEmpty&&""===r&&(s=!0,o=!0),s||(n=!1),!s&&o&&(n=!0),s&&!o)if(!0===this.correctFormat){let t=function(t,e){let i,r=tn(ei(t)),n=tn(t,e),o=t.search(/[A-Za-z]/g)>-1;return(r.isValid()&&r.format("x")===n.format("x")||!n.isValid()||o?r:n).format(e)}(r,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"dateValidator"),n=!0}else n=!1;e(n)}function en(t,e){et.apply(this,[t,e])}function eo(t,e){let i=t;null==i&&(i=""),e(!!this.allowEmpty&&""===i||""!==i&&(0,b.isNumeric)(t))}et.VALIDATOR_TYPE="autocomplete",er.VALIDATOR_TYPE="date",en.VALIDATOR_TYPE="dropdown",eo.VALIDATOR_TYPE="numeric";let es=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"];function el(t,e){let i=this.timeFormat||"h:mm:ss a",r=!0,n=t;null===n&&(n=""),n=/^\d{3,}$/.test(n)?parseInt(n,10):n;let o=/^\d{1,2}$/.test(n);o&&(n+=":00");let s=tn(n,es,!0).isValid()?tn(n):tn(n,i),l=s.isValid(),a=tn(n,i,!0).isValid()&&!o;if(this.allowEmpty&&""===n&&(l=!0,a=!0),l||(r=!1),!l&&a&&(r=!0),l&&!a)if(!0===this.correctFormat){let t=s.format(i);this.instance.setDataAtCell(this.visualRow,this.visualCol,t,"timeValidator"),r=!0}else r=!1;e(r)}el.VALIDATOR_TYPE="time";var ea=i(85917);function eh(t,e,i,r,n,o,s){tY.apply(this,[t,e,i,r,n,o,s])}eh.RENDERER_TYPE="date";i(20775);var eu=i(17480);function ec(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ed(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eg(t,e){return t.get(ef(t,e))}function ef(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let ep=new Map([["plugin",eu.Mt],["cell-type",f.L4],["editor",tU.aZ],["renderer",t6.sl],["validator",ea.tR]]),em=Symbol("mainSetting"),ew=[],ev=null;var ey=new WeakMap,eb=new WeakSet;class eC{static get PLUGIN_KEY(){return"base"}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}constructor(t){!function(t,e){ec(t,e),e.add(t)}(this,eb),ed(this,"eventManager",new m.A(this)),ed(this,"pluginName",null),ed(this,"pluginsInitializedCallbacks",[]),ed(this,"isPluginsReady",!1),ed(this,"enabled",!1),ed(this,"initialized",!1),function(t,e,i){ec(t,e),e.set(t,i)}(this,ey,{}),(0,V.defineGetter)(this,"hot",t,{writable:!1}),ev=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",t=>this.onUpdateSettings(t)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this);let t=this.constructor.PLUGIN_DEPS,e=Array.isArray(t)?t:[];if(e.length>0){let t=[];if(e.forEach(e=>{let[i,r]=e.split(":");if(!ep.has(i))throw Error(`Unknown plugin dependency type "${i}" was found.`);ep.get(i)(r)||t.push(` - ${r} (${i})`)}),t.length>0){let e=`The ${this.pluginName} plugin requires the following modules:
${t.join("\n")}
`;ew.push(e)}}if(ev||(ev=(0,eu.f4)()),ev.indexOf(this.pluginName)>=0&&ev.splice(ev.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),0===ev.length){if(ew.length>0){let t=`${ew.join("\n")}
You have to import and register them manually.`;throw ew.length=0,Error(t)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var t;null===(t=this.eventManager)||void 0===t||t.clear(),this.clearHooks(),this.enabled=!1}getSetting(t){var e,i;let r=this.hot.getSettings()[this.constructor.PLUGIN_KEY];if(void 0===t)return r;let n=this.constructor.DEFAULT_SETTINGS;return(Array.isArray(r)||(0,V.isObject)(r))&&n[em]===t?Array.isArray(r)?r:null!==(e=r[t])&&void 0!==e?e:n[t]:(0,V.isObject)(r)&&null!==(i=r[t])&&void 0!==i?i:n[t]}addHook(t,e,i){eg(ey,this)[t]=eg(ey,this)[t]||[];let r=eg(ey,this)[t];this.hot.addHook(t,e,i),r.push(e),eg(ey,this)[t]=r}removeHooks(t){(0,z.arrayEach)(eg(ey,this)[t]||[],e=>{this.hot.removeHook(t,e)})}clearHooks(){let t=eg(ey,this);(0,V.objectEach)(t,(t,e)=>this.removeHooks(e)),t.length=0}callOnPluginsReady(t){this.isPluginsReady?t():this.pluginsInitializedCallbacks.push(t)}onAfterPluginsInitialized(){(0,z.arrayEach)(this.pluginsInitializedCallbacks,t=>t()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(t){let e=ef(eb,this,eS).call(this,t);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&e&&this.updatePlugin(t))}updatePlugin(){}destroy(){var t;null===(t=this.eventManager)||void 0===t||t.destroy(),this.clearHooks(),(0,V.objectEach)(this,(t,e)=>{"hot"!==e&&(this[e]=null)}),delete this.t,delete this.hot}}function eS(t){if(!t)return!1;let e=this.constructor.SETTING_KEYS;if("boolean"==typeof e)return e;for(let i=0;i<e.length;i++)if(void 0!==t[e[i]])return!0;return!1}var eE=i(23544);function eR(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class eT{constructor(t){eR(this,"hot",null),eR(this,"container",null),eR(this,"injected",!1),eR(this,"rows",[]),eR(this,"columns",[]),eR(this,"samples",null),eR(this,"settings",{useHeaders:!0}),this.hot=t}addRow(t,e){if(this.columns.length)throw Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={row:t};this.rows.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(t)),this.table.tr.appendChild(this.createRow(t)),0===t&&(0,y.addClass)(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(t){if(null!=this.hot.getColHeader(0)){let e={row:-1};this.rows.push(e),this.container=this.createContainer(this.hot.rootElement.className),this.samples=t,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),e.table=this.table.table}}addColumn(t,e){if(this.rows.length)throw Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));let i={col:t};this.columns.push(i),this.samples=e,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&null!==this.hot.getColHeader(t)&&this.hot.view.appendColHeader(t,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(t)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(t){this.injected||this.injectTable(),(0,z.arrayEach)(this.rows,e=>{let{height:i}=e.table.getBoundingClientRect();t(e.row,Math.ceil(i))})}getWidths(t){this.injected||this.injectTable(),(0,z.arrayEach)(this.columns,e=>{let{width:i}=e.table.getBoundingClientRect();t(e.col,Math.ceil(i))})}setSettings(t){this.settings=t}setSetting(t,e){this.settings||(this.settings={}),this.settings[t]=e}getSettings(){return this.settings}getSetting(t){return this.settings?this.settings[t]:null}createColGroupsCol(t){let e=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&e.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{(0,z.arrayEach)(i.strings,i=>{e.appendChild(this.createColElement(i.col,t))})}),e}createRow(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(t,r),i.appendChild(r)),this.samples.forEach(r=>{(0,z.arrayEach)(r.strings,r=>{let n=r.col,o=this.hot.getCellMeta(t,n),s=this.hot.getCellRenderer(o),l=e.createElement("td");l.setAttribute("ghost-table",1),s(this.hot,l,t,n,this.hot.colToProp(n),r.value,o),i.appendChild(l)})}),i}appendColumnHeadersRow(){let{rootDocument:t}=this.hot,e=t.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){let r=t.createElement("th");i.push([-1,r]),e.appendChild(r)}this.samples.forEach(r=>{(0,z.arrayEach)(r.strings,r=>{let n=r.col,o=t.createElement("th");i.push([n,o]),e.appendChild(o)})}),this.table.tHead.appendChild(e),(0,z.arrayEach)(i,t=>{let[e,i]=t;this.hot.view.appendColHeader(e,i)})}createCol(t){let{rootDocument:e}=this.hot,i=e.createDocumentFragment();return this.samples.forEach(r=>{(0,z.arrayEach)(r.strings,r=>{let n=r.row,o=this.hot.getCellMeta(n,t),s=this.hot.getCellRenderer(o),l=e.createElement("td"),a=e.createElement("tr");l.setAttribute("ghost-table",1),s(this.hot,l,n,t,this.hot.colToProp(t),r.value,o),a.appendChild(l),i.appendChild(a)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.injected||((t||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(t,e){let i=this.hot.rootDocument.createElement("col"),r=0;e>=0&&t>=0&&(r=this.hot.getCellMeta(e,t).colspan);let n=this.hot.getColWidth(t);if(r>1)for(let e=t+1;e<t+r;e++)n+=this.hot.getColWidth(e);return i.style.width=`${n}px`,i}createTable(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("table"),n=e.createElement("thead"),o=e.createElement("tbody"),s=e.createElement("colgroup"),l=e.createElement("tr"),a=e.createElement("th");return this.isVertical()&&r.appendChild(s),this.isHorizontal()&&(l.appendChild(a),n.appendChild(l),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(n),this.isVertical()&&o.appendChild(l),r.appendChild(o),(0,y.addClass)(r,t),i.appendChild(r),{fragment:i,table:r,tHead:n,tBody:o,colGroup:s,tr:l,th:a}}createContainer(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",{rootDocument:e}=this.hot,i=e.createDocumentFragment(),r=e.createElement("div"),n=`htGhostTable htAutoSize ${t.trim()}`;return(0,y.addClass)(r,n),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}}function ex(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class eM{static get SAMPLE_COUNT(){return 3}constructor(t){ex(this,"samples",null),ex(this,"dataFactory",null),ex(this,"customSampleCount",null),ex(this,"allowDuplicates",!1),this.dataFactory=t}getSampleCount(){return this.customSampleCount?this.customSampleCount:eM.SAMPLE_COUNT}setSampleCount(t){this.customSampleCount=t}setAllowDuplicates(t){this.allowDuplicates=t}generateRowSamples(t,e){return this.generateSamples("row",e,t)}generateColumnSamples(t,e){return this.generateSamples("col",e,t)}generateSamples(t,e,i){let r=new Map,{from:n,to:o}="number"==typeof i?{from:i,to:i}:i;return(0,b.rangeEach)(n,o,i=>{let n=this.generateSample(t,e,i);r.set(i,n)}),r}generateSample(t,e,i){if("row"!==t&&"col"!==t)throw Error("Unsupported sample type");let r=new Map,n="row"===t?"col":"row",o=[];return(0,b.rangeEach)(e.from,e.to,e=>{let s,l="row"===t?this.dataFactory(i,e):this.dataFactory(e,i);if(!1===l)return;let{value:a,bundleSeed:h}=l,u="string"==typeof h&&h.length>0;s=u?h:(0,V.isObject)(a)?`${Object.keys(a).length}`:Array.isArray(a)?`${a.length}`:`${(0,T.stringify)(a).length}`,r.has(s)||r.set(s,{needed:this.getSampleCount(),strings:[]});let c=r.get(s);c.needed&&(!(o.indexOf(a)>-1)||this.allowDuplicates||u)&&(c.strings.push({value:a,[n]:e}),o.push(a),c.needed-=1)}),r}}var ek=i(67758),eO=i(12522);function eI(t,e,i){eA(t,e),e.set(t,i)}function eA(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function eN(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eH(t,e){return t.get(e_(t,e))}function eP(t,e,i){return t.set(e_(t,e),i),i}function e_(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("modifyAutoColumnSizeSeed");let eD="autoColumnSize";var eL=new WeakMap,eF=new WeakMap,eV=new WeakMap,eW=new WeakSet;class eB extends eC{static get PLUGIN_KEY(){return eD}static get PLUGIN_PRIORITY(){return 10}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(t){super(t),function(t,e){eA(t,e),e.add(t)}(this,eW),eN(this,"ghostTable",new eT(this.hot)),eN(this,"samplesGenerator",new eM((t,e)=>{let i=this.hot.toPhysicalRow(t),r=this.hot.toPhysicalColumn(e);if(this.hot.rowIndexMapper.isHidden(i)||this.hot.columnIndexMapper.isHidden(r))return!1;let n=this.hot.getCellMeta(t,e),o="";n.spanned||(o=this.hot.getDataAtCell(t,e));let s="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(s=this.hot.runHooks("modifyAutoColumnSizeSeed",s,n,o)),{value:o,bundleSeed:s}})),eN(this,"inProgress",!1),eN(this,"measuredColumns",0),eN(this,"columnWidthsMap",new eO._),eI(this,eL,!1),eI(this,eF,[]),eI(this,eV,[]),this.hot.columnIndexMapper.registerMap("autoColumnSize",this.columnWidthsMap),this.addHook("beforeColumnResize",(t,e,i)=>e_(eW,this,eq).call(this,t,e,i))}isEnabled(){return!1!==this.hot.getSettings()[eD]&&!this.hot.getSettings().colWidths}enablePlugin(){var t=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));let e=this.getSetting("samplingRatio");e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return e_(eW,t,eY).call(t,...i)}),this.addHook("beforeChangeRender",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return e_(eW,t,eG).call(t,...i)}),this.addHook("afterFormulasValuesUpdate",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return e_(eW,t,eK).call(t,...i)}),this.addHook("beforeRender",()=>e_(eW,this,e$).call(this)),this.addHook("modifyColWidth",(t,e)=>this.getColumnWidth(e,t)),this.addHook("init",()=>e_(eW,this,eX).call(this)),super.enablePlugin()}updatePlugin(){eP(eV,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(t,e,i)=>e_(eW,this,eq).call(this,t,e,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;let t=this.getFirstVisibleColumn(),e=this.getLastVisibleColumn();if(-1===t||-1===e)return;let i=this.hot.forceFullRender;this.calculateColumnsWidth({from:t,to:e},void 0,i)}calculateColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,n="number"==typeof e?{from:e,to:e}:e;(0,b.rangeEach)(r.from,r.to,t=>{let e=this.hot.toPhysicalColumn(t);null===e&&(e=t),(i||null===this.columnWidthsMap.getValueAtIndex(e)&&!this.hot._getColWidthFromSettings(e))&&e_(eW,this,ez).call(this,t,n)}),this.ghostTable.columns.length&&(e_(eW,this,eU).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0,r=this.hot.countCols()-1,n=null;this.inProgress=!0;let o=()=>{if(!this.hot){(0,eE.cancelAnimationFrame)(n),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+eB.CALCULATION_STEP,r)},t,e),(i=i+eB.CALCULATION_STEP+1)<r?n=(0,eE.requestAnimationFrame)(o):((0,eE.cancelAnimationFrame)(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateColumnsWidth({from:0,to:s},t,e),i=s+1),i<r?o():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){let t=this.hot.getSettings()[eD],e=eB.SYNC_CALCULATION_LIMIT,i=this.hot.countCols()-1;return(0,V.isObject)(t)&&(e=t.syncLimit,(0,U.isPercentValue)(e)?e=(0,b.valueAccordingPercent)(i,e):e>>=0),Math.min(e,i)}getColumnWidth(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=e;return void 0===r&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t)),i&&"number"==typeof r&&(r=Math.max(r,ek.j))),r}getFirstVisibleColumn(){var t;return null!==(t=this.hot.getFirstRenderedVisibleColumn())&&void 0!==t?t:-1}getLastVisibleColumn(){var t;return null!==(t=this.hot.getLastRenderedVisibleColumn())&&void 0!==t?t:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((t,e,i)=>{let r=eH(eF,this).length;return(r-1<i||eH(eF,this)[i]!==e)&&t.push(this.hot.toVisualColumn(i)),r-1<i?eH(eF,this).push(e):eH(eF,this)[i]=e,t},[])}clearCache(t){Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(t=>{this.columnWidthsMap.setValueAtIndex(t,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function ej(t){let e={from:0,to:this.hot.countRows()-1};t.forEach(t=>{let i=this.hot.toPhysicalColumn(t);null===i||this.hot._getColWidthFromSettings(i)||e_(eW,this,ez).call(this,t,e)}),this.ghostTable.columns.length&&(e_(eW,this,eU).call(this),this.ghostTable.clean())}function ez(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((t,e)=>this.ghostTable.addColumn(e,t))}function eU(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{let i=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(i,e)})},!0)}function e$(){this.calculateVisibleColumnsWidth(),this.inProgress||(e_(eW,this,ej).call(this,eH(eV,this)),eP(eV,this,[]))}function eY(t,e){e||this.recalculateAllColumnsWidth()}function eG(t){let e=t.reduce((t,e)=>{let[,i]=e,r=this.hot.propToCol(i);return Number.isInteger(r)&&-1===t.indexOf(r)&&t.push(r),t},[]);eH(eV,this).push(...e)}function eq(t,e,i){let r=t;return i&&(this.calculateColumnsWidth(e,void 0,!0),r=this.getColumnWidth(e,void 0,!1)),r}function eX(){eP(eF,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),eP(eL,this,!0)}function eK(t){if(!eH(eL,this))return;let e=t.reduce((t,e)=>{var i;let r=null===(i=e.address)||void 0===i?void 0:i.col;if(Number.isInteger(r)){let e=this.hot.toVisualColumn(r);-1===t.indexOf(e)&&t.push(e)}return t},[]);eH(eV,this).push(...e)}let eJ={horizontal:"horizontal",vertical:"vertical"};function eQ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function eZ(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("modifyAutofillRange"),d.R.getSingleton().register("beforeAutofill"),d.R.getSingleton().register("afterAutofill");let e0="autofill",e1=["fillHandle"];var e2=new WeakSet;class e3 extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,e2),eQ(this,"addingStarted",!1),eQ(this,"mouseDownOnCellCorner",!1),eQ(this,"mouseDragOutside",!1),eQ(this,"handleDraggedCells",0),eQ(this,"directions",[]),eQ(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return e0}static get PLUGIN_PRIORITY(){return 20}static get SETTING_KEYS(){return[e0,...e1]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",t=>eZ(e2,this,e4).call(this,t)),this.addHook("afterOnCellCornerDblClick",t=>eZ(e2,this,e9).call(this,t)),this.addHook("beforeOnCellMouseOver",(t,e)=>eZ(e2,this,e5).call(this,e)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let t=this.hot.getSelectedRangeLast(),{row:e,col:i}=t.getTopStartCorner(),{row:r,col:n}=t.getBottomEndCorner(),o=this.hot.runHooks("modifyCopyableRange",[{startRow:e,startCol:i,endRow:r,endCol:n}]),s=[],l=[],a=[];return(0,z.arrayEach)(o,t=>{for(let e=t.startRow;e<=t.endRow;e+=1)-1===s.indexOf(e)&&s.push(e);for(let e=t.startCol;e<=t.endCol;e+=1)-1===l.indexOf(e)&&l.push(e)}),(0,z.arrayEach)(s,t=>{let e=[];(0,z.arrayEach)(l,i=>{e.push(this.hot.getCopyableData(t,i))}),a.push(e)}),a}fillIn(){var t;let e,i,r;if(this.hot.selection.highlight.getFill().isEmpty())return!1;let[n,o,s,l]=this.hot.selection.highlight.getFill().getVisualCorners(),a=this.hot.getSelectedRangeLast(),h=a.getTopStartCorner(),u=a.getBottomEndCorner();this.resetSelectionOfDraggedArea();let c=[h.row,h.col,u.row,u.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(h.row,n),Math.min(h.col,o),Math.max(u.row,s),Math.max(u.col,l)],c),{directionOfDrag:g,startOfDragCoords:f,endOfDragCoords:p}=(t=(t,e)=>this.hot._createCellCoords(t,e),d[0]===c[0]&&d[1]<c[1]?(r="left",e=t(d[0],d[1]),i=t(d[2],c[1]-1)):d[2]===c[2]&&d[0]===c[0]&&d[3]>c[3]?(r="right",e=t(d[0],c[3]+1),i=t(d[2],d[3])):d[0]<c[0]&&d[1]===c[1]?(r="up",e=t(d[0],d[1]),i=t(c[0]-1,d[3])):d[2]>c[2]&&d[1]===c[1]&&(r="down",e=t(c[2]+1,d[1]),i=t(d[2],d[3])),e&&e.normalize(),i&&i.normalize(),{directionOfDrag:r,startOfDragCoords:e,endOfDragCoords:i});if(f&&f.row>-1&&f.col>-1){let t=this.getSelectionData(),e=a.clone(),i=this.hot._createCellRange(f,f,p),r=this.hot.runHooks("beforeAutofill",t,e,i,g);if(!1===r)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let n=r;if(["up","left"].indexOf(g)>-1&&(1!==r.length||0!==r[0].length))if(n=[],"up"===g){let t=p.row-f.row+1,e=t%r.length;for(let i=0;i<t;i++)n.push(r[(i+(r.length-e))%r.length])}else{let t=p.col-f.col+1,e=t%r[0].length;for(let i=0;i<r.length;i++){n.push([]);for(let o=0;o<t;o++)n[i].push(r[i][(o+(r[i].length-e))%r[i].length])}}this.hot.populateFromArray(f.row,f.col,n,p.row,p.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",n,e,i,g),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(t){return t.row<0&&(t.row=0),t.col<0&&(t.col=0),t}getCoordsOfDragAndDropBorders(t){let e=this.hot.getSelectedRangeLast(),i=e.getBottomEndCorner(),r=t;if(this.directions.includes(eJ.vertical)&&this.directions.includes(eJ.horizontal)){let n=e.getTopStartCorner();(i.col<=t.col||n.col>=t.col)&&(r=this.hot._createCellCoords(i.row,t.col)),(i.row<t.row||n.row>t.row)&&(r=this.hot._createCellCoords(t.row,i.col))}else if(this.directions.includes(eJ.vertical))r=this.hot._createCellCoords(t.row,i.col);else{if(!this.directions.includes(eJ.horizontal))return;r=this.hot._createCellCoords(i.row,t.col)}return this.reduceSelectionAreaIfNeeded(r)}showBorder(t){let e=this.getCoordsOfDragAndDropBorders(t);e&&this.redrawBorders(e)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter("insert_row_below",void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},200)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&!1===this.addingStarted&&this.autoInsertRow){let t=this.hot.getSelectedLast(),e=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();t[2]<i-1&&e[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(t){let e,i=this.hot.getData(),r=this.hot.countRows();for(let n=t[2]+1;n<r;n++){for(let e=t[1];e<=t[3];e++){let t=i[n][e];if(!(0,T.isEmpty)(t))return -1}let r=i[n][t[1]-1],o=i[n][t[3]+1];(0,T.isEmpty)(r)&&(0,T.isEmpty)(o)||(e=n)}return e}addSelectionFromStartAreaToSpecificRowIndex(t,e){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(t[0],t[1])).add(this.hot._createCellCoords(e,t[3])).commit()}setSelection(t){this.hot.selectCell(...(0,z.arrayMap)(t,t=>Math.max(t,0)),!1,!1)}selectAdjacent(){let t=this.hot.getSelectedLast(),e=this.getIndexOfLastAdjacentFilledInRow(t);return -1!==e&&void 0!==e&&(this.addSelectionFromStartAreaToSpecificRowIndex(t,e),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(t){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(t).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(t){let{documentElement:e}=this.hot.rootDocument,i=(0,y.offset)(this.hot.table).top-(this.hot.rootWindow.pageYOffset||e.scrollTop)+(0,y.outerHeight)(this.hot.table),r=(0,y.offset)(this.hot.table).left-(this.hot.rootWindow.pageXOffset||e.scrollLeft)+(0,y.outerWidth)(this.hot.table);return t.clientY>i&&t.clientX<=r}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mouseup",()=>eZ(e2,this,e8).call(this)),this.eventManager.addEventListener(t,"mousemove",t=>eZ(e2,this,e7).call(this,t))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){let t=function(t){let e={};return!0===t?(e.directions=Object.keys(eJ),e.autoInsertRow=!0):(0,V.isObject)(t)?((0,T.isDefined)(t.autoInsertRow)?t.direction===eJ.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,(0,T.isDefined)(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(eJ)):"string"==typeof t?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}(this.hot.getSettings().fillHandle);this.directions=t.directions,this.autoInsertRow=t.autoInsertRow}destroy(){super.destroy()}}function e9(){this.selectAdjacent()&&this.fillIn()}function e4(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function e5(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function e8(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function e7(t){let e=this.getIfMouseWasDraggedOutside(t);!1===this.addingStarted&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function e6(t,e,i){it(t,e),e.set(t,i)}function it(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ie(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function ii(t,e,i){return t.set(io(t,e),i),i}function ir(t,e){return t.get(io(t,e))}function io(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let is="autoRowSize";var il=new WeakMap,ia=new WeakMap,ih=new WeakSet;class iu extends eC{static get PLUGIN_KEY(){return is}static get PLUGIN_PRIORITY(){return 40}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(t){super(t),function(t,e){it(t,e),e.add(t)}(this,ih),ie(this,"headerHeight",null),ie(this,"ghostTable",new eT(this.hot)),ie(this,"samplesGenerator",new eM((t,e)=>{let i,r=this.hot.toPhysicalRow(t),n=this.hot.toPhysicalColumn(e);return!(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(n))&&(!(t>=0)||!(e>=0)||!this.hot.getCellMeta(t,e).hidden)&&(t>=0?i=this.hot.getDataAtCell(t,e):-1===t&&(i=this.hot.getColHeader(e)),{value:i})})),ie(this,"inProgress",!1),ie(this,"measuredRows",0),ie(this,"rowHeightsMap",new eO._),e6(this,il,[]),e6(this,ia,!1),this.hot.rowIndexMapper.registerMap("autoRowSize",this.rowHeightsMap),this.addHook("beforeRowResize",(t,e,i)=>io(ih,this,ig).call(this,t,e,i))}isEnabled(){let t=this.hot.getSettings()[is];return!0===t||(0,V.isObject)(t)}enablePlugin(){var t=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));let e=this.getSetting("samplingRatio");e&&!isNaN(e)&&this.samplesGenerator.setSampleCount(parseInt(e,10)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return io(ih,t,ip).call(t,...i)}),this.addHook("beforeChangeRender",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return io(ih,t,im).call(t,...i)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return io(ih,t,iv).call(t,...i)}),this.addHook("beforeRender",()=>io(ih,this,id).call(this)),this.addHook("modifyRowHeight",(t,e)=>this.getRowHeight(e,t)),this.addHook("init",()=>io(ih,this,iw).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),this.addHook("beforeRowResize",(t,e,i)=>io(ih,this,ig).call(this,t,e,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;let t=this.getFirstVisibleRow(),e=this.getLastVisibleRow();if(-1===t||-1===e)return;let i=this.hot.forceFullRender;this.calculateRowsHeight({from:t,to:e},void 0,i)}calculateRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countRows()-1},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="number"==typeof t?{from:t,to:t}:t,n="number"==typeof e?{from:e,to:e}:e;if(null!==this.hot.getColHeader(0)){let t=this.samplesGenerator.generateRowSamples(-1,n);this.ghostTable.addColumnHeadersRow(t.get(-1))}(0,b.rangeEach)(r.from,r.to,t=>{let e=this.hot.toPhysicalRow(t);null===e&&(e=t),(i||null===this.rowHeightsMap.getValueAtIndex(e))&&this.samplesGenerator.generateRowSamples(t,n).forEach((t,e)=>this.ghostTable.addRow(e,t))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,e)=>{t<0?this.headerHeight=e:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(t),e)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{from:0,to:this.hot.countCols()-1},e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=0,r=this.hot.countRows()-1,n=null;this.inProgress=!0;let o=()=>{if(!this.hot){(0,eE.cancelAnimationFrame)(n),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+iu.CALCULATION_STEP,r)},t,e),(i=i+iu.CALCULATION_STEP+1)<r?n=(0,eE.requestAnimationFrame)(o):((0,eE.cancelAnimationFrame)(n),this.inProgress=!1,this.hot.view.adjustElementsSize())},s=this.getSyncCalculationLimit();s>=0&&(this.calculateRowsHeight({from:0,to:s},t,e),i=s+1),i<r?o():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){let t=this.hot.getSettings()[is],e=iu.SYNC_CALCULATION_LIMIT,i=this.hot.countRows()-1;return(0,V.isObject)(t)&&(e=t.syncLimit,(0,U.isPercentValue)(e)?e=(0,b.valueAccordingPercent)(i,e):e>>=0),Math.min(e,i)}getRowHeight(t,e){let i=t<0?this.headerHeight:this.rowHeightsMap.getValueAtIndex(this.hot.toPhysicalRow(t)),r=e;return null!==i&&i>(e||0)&&(r=i),r}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var t;return null!==(t=this.hot.getFirstRenderedVisibleRow())&&void 0!==t?t:-1}getLastVisibleRow(){var t;return null!==(t=this.hot.getLastRenderedVisibleRow())&&void 0!==t?t:-1}clearCache(t){this.headerHeight=null,Array.isArray(t)?this.hot.batchExecution(()=>{t.forEach(t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(t){let{from:e,to:i}="number"==typeof t?{from:t,to:t}:t;this.hot.batchExecution(()=>{(0,b.rangeEach)(Math.min(e,i),Math.max(e,i),t=>{this.rowHeightsMap.setValueAtIndex(t,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(t=>null===t).length}destroy(){this.ghostTable.clean(),super.destroy()}}function ic(t){let e={from:0,to:this.hot.countCols()-1};t.forEach(t=>{this.samplesGenerator.generateRowSamples(t,e).forEach((t,e)=>this.ghostTable.addRow(e,t))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((t,e)=>{let i=this.hot.toPhysicalRow(t);this.rowHeightsMap.setValueAtIndex(i,e)})},!0),this.ghostTable.clean())}function id(){this.calculateVisibleRowsHeight(),this.inProgress||(io(ih,this,ic).call(this,ir(il,this)),ii(il,this,[]))}function ig(t,e,i){let r=t;return i&&(this.calculateRowsHeight(e,void 0,!0),r=this.getRowHeight(e)),r}function ip(t,e){e||this.recalculateAllRowsHeight()}function im(t){let e=t.reduce((t,e)=>{let[i]=e;return -1===t.indexOf(i)&&t.push(i),t},[]);ir(il,this).push(...e)}function iw(){this.recalculateAllRowsHeight(),ii(ia,this,!0)}function iv(t){if(!ir(ia,this))return;let e=t.reduce((t,e)=>{var i;let r=null===(i=e.address)||void 0===i?void 0:i.row;if(Number.isInteger(r)){let e=this.hot.toVisualRow(r);-1===t.indexOf(e)&&t.push(e)}return t},[]);ir(il,this).push(...e)}var iy=i(33774),ib=i(59932);let iC=new Map([["indexesSequence",{getListWithInsertedItems:iy.N,getListWithRemovedItems:iy.H}],["physicallyIndexed",{getListWithInsertedItems:ib.N,getListWithRemovedItems:ib.H}]]),iS=t=>{if(!1===iC.has(t))throw Error(`Alter strategy with ID '${t}' does not exist.`);return iC.get(t)};var iE=i(82505),iR=i(927);let{getListWithInsertedItems:iT,getListWithRemovedItems:ix}=iS("physicallyIndexed");class iM extends iE.n{constructor(){super(t=>t)}insert(t,e){let i=(0,iR.z)(this.indexedValues,e);this.indexedValues=iT(i,t,e,this.initValueOrFn),super.insert(t,e)}remove(t){let e=ix(this.indexedValues,t);this.indexedValues=(0,iR.v)(e,t),super.remove(t)}}let{getListWithInsertedItems:ik,getListWithRemovedItems:iO}=iS("physicallyIndexed");class iI extends iE.n{constructor(){super(t=>t)}insert(t,e){this.indexedValues=ik(this.indexedValues,t,e,(t,e)=>this.getNextValue(e)),super.insert(t,e)}remove(t){this.indexedValues=iO(this.indexedValues,t),super.remove(t)}getNextValue(t){return Math.max(...this.getValues())+1+t}}let iA="bindRowsWithHeaders",iN=new Map([["loose",iM],["strict",iI]]);var iH=new WeakSet;class iP extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,iH),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[e]=null}(this,"headerIndexes",null)}static get PLUGIN_KEY(){return iA}static get PLUGIN_PRIORITY(){return 210}isEnabled(){return!!this.hot.getSettings()[iA]}enablePlugin(){var t;if(this.enabled)return;let e=null!==(t=iN.get(this.getSetting()))&&void 0!==t?t:iN.get("loose");this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new e),this.addHook("modifyRowHeader",t=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(iH,this,i_).call(this,t)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function i_(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}var iD=i(57193);function iL(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function iF(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function iV(t,e,i){return t.set(iW(t,e),i),i}function iW(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let iB="collapsibleColumns",ij=["nestedHeaders"],iz="collapsibleIndicator",iU=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var i$=new WeakMap,iY=new WeakSet;class iG extends eC{constructor(){super(...arguments),function(t,e){iL(t,e),e.add(t)}(this,iY),iF(this,"nestedHeadersPlugin",null),iF(this,"headerStateManager",null),function(t,e,i){iL(t,e),e.set(t,null)}(this,i$,0)}static get PLUGIN_KEY(){return iB}static get PLUGIN_PRIORITY(){return 290}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[iB,...ij]}isEnabled(){return!!this.hot.getSettings()[iB]}enablePlugin(){var t=this;if(this.enabled)return;let{nestedHeaders:e}=this.hot.getSettings();e||(0,iD.R8)("You need to configure the Nested Headers plugin in order to use collapsible headers."),iV(i$,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>iW(iY,this,iK).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return iW(iY,t,iJ).call(t,...i)}),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return iW(iY,t,iq).call(t,...i)}),this.addHook("beforeOnCellMouseDown",(t,e,i)=>iW(iY,this,iX).call(this,t,e,i)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){let{collapsibleColumns:t}=this.hot.getSettings();"boolean"==typeof t?this.headerStateManager.mapState(t=>({collapsible:t.origColspan>1})):Array.isArray(t)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(t))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),iV(i$,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var t;let{row:e,col:i}=this.hot.getSelectedRangeLast().highlight,{collapsible:r,isCollapsed:n,columnIndex:o}=null!==(t=this.headerStateManager.getHeaderTreeNodeData(e,i))&&void 0!==t?t:{};if(r)return n?this.expandSection({row:e,col:o}):this.collapseSection({row:e,col:o}),!1},runOnlyIf:()=>{var t,e;return(null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.isSingle())&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader())},group:iB,relativeToGroup:W.b,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(iB)}clearButtons(){if(!this.hot.view)return;let t=this.hot.view._wt.getSetting("columnHeaders").length,e=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,n=function(t){t&&t.parentNode.removeChild(t)};(0,b.rangeEach)(0,t-1,t=>{let o=e.childNodes[t],s=i.childNodes[t],l=r?r.childNodes[t]:null;(0,b.rangeEach)(0,o.childNodes.length-1,t=>{let e=o.childNodes[t].querySelector(`.${iz}`);n(e),s&&s.childNodes[t]&&n(e=s.childNodes[t].querySelector(`.${iz}`)),r&&l&&l.childNodes[t]&&n(e=l.childNodes[t].querySelector(`.${iz}`))})},!0)}expandSection(t){this.toggleCollapsibleSection([t],"expand")}collapseSection(t){this.toggleCollapsibleSection([t],"collapse")}toggleAllCollapsibleSections(t){let e=this.headerStateManager.mapNodes(e=>{let{collapsible:i,origColspan:r,headerLevel:n,columnIndex:o,isCollapsed:s}=e;if(!0===i&&r>1&&(s&&"expand"===t||!s&&"collapse"===t))return{row:this.headerStateManager.levelToRowCoords(n),col:o}});this.toggleCollapsibleSection(e,t)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(t,e){if(!iU.has(e))throw Error(`Unsupported action is passed (${e}).`);if(!Array.isArray(t))return;let i=(0,z.arrayFilter)(t,t=>{let{row:e}=t;return e<0}),r=i.length>0;(0,z.arrayEach)(i,t=>{var i;let{row:n,col:o}=t,{collapsible:s,isCollapsed:l}=null!==(i=this.headerStateManager.getHeaderSettings(n,o))&&void 0!==i?i:{};if(!s||l&&"collapse"===e||!l&&"expand"===e)return r=!1,!1});let n=[],o=[];r&&(0,z.arrayEach)(i,t=>{let{row:i,col:r}=t,{colspanCompensation:s,affectedColumns:l,rollbackModification:a}=this.headerStateManager.triggerNodeModification(e,i,r);s>0&&(o.push(...l),n.push(a))});let s=this.getCollapsedColumns(),l=[];"collapse"===e?l=(0,z.arrayUnique)([...s,...o]):"expand"===e&&(l=(0,z.arrayFilter)(s,t=>!o.includes(t)));let a=iU.get(e);if(!1===this.hot.runHooks(a.beforeHook,s,l,r)){(0,z.arrayEach)(n,t=>{t()});return}this.hot.batchExecution(()=>{(0,z.arrayEach)(o,t=>{i$.get(iW(i$,this)).setValueAtIndex(this.hot.toPhysicalColumn(t),a.hideColumn)})},!0);let h=this.getCollapsedColumns().length!==s.length,u=this.hot.getSelectedRangeLast();if("collapse"===e&&h&&u){let{row:t,col:e}=u.highlight;if((this.hot.rowIndexMapper.isHidden(t)||this.hot.columnIndexMapper.isHidden(e))&&o.includes(e)){let i=t>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(t,1,!0):t,r=e>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(e,1,!0):e;null!==i&&null!==r&&this.hot.selectCell(i,r)}}this.hot.runHooks(a.afterHook,s,l,r,h),this.hot.render(),this.hot.view.adjustElementsSize()}getCollapsedColumns(){return i$.get(iW(i$,this)).getHiddenIndexes()}destroy(){iV(i$,this,null),super.destroy()}}function iq(t,e,i){var r,n;let{collapsible:o,origColspan:s,isCollapsed:l}=null!==(r=this.headerStateManager.getHeaderSettings(i,t))&&void 0!==r?r:{},a=o&&s>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags,u=e.querySelector(`.${iz}`);(0,y.removeAttribute)(e,[(0,M.dV)("")[0]]),a?(u||(u=this.hot.rootDocument.createElement("div"),(0,y.addClass)(u,iz),e.querySelector("div:first-child").appendChild(u)),(0,y.removeClass)(u,["collapsed","expanded"]),l?((0,y.addClass)(u,"collapsed"),(0,y.fastInnerText)(u,"+"),h&&(0,y.setAttribute)(e,...(0,M.dV)(!1))):((0,y.addClass)(u,"expanded"),(0,y.fastInnerText)(u,"-"),h&&(0,y.setAttribute)(e,...(0,M.dV)(!0))),h&&(0,y.setAttribute)(u,...(0,M.MG)())):null===(n=u)||void 0===n||n.remove()}function iX(t,e){(0,y.hasClass)(t.target,iz)&&((0,y.hasClass)(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):(0,y.hasClass)(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),(0,F.stopImmediatePropagation)(t))}function iK(){this.updatePlugin()}function iJ(t,e){e||this.updatePlugin()}var iQ=i(57496),iZ=i(88215);function i0(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let i1=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"];class i2{constructor(t,e){i0(this,"hot",void 0),i0(this,"sortingStates",new iZ.z),i0(this,"sortEmptyCells",!1),i0(this,"indicator",!0),i0(this,"headerAction",!0),i0(this,"compareFunctionFactory",void 0),i0(this,"mapName",void 0),this.hot=t,this.mapName=e,this.hot.columnIndexMapper.registerMap(e,this.sortingStates)}updateAllColumnsProperties(t){(0,V.isObject)(t)&&(0,V.objectEach)(t,(t,e)=>{i1.includes(e)&&(this[e]=t)})}getAllColumnsProperties(){let t={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return"function"==typeof this.compareFunctionFactory&&(t.compareFunctionFactory=this.compareFunctionFactory),t}getSortOrderOfColumn(t){var e;return null===(e=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))||void 0===e?void 0:e.sortOrder}getIndexOfColumnInSortQueue(t){return t=this.hot.toPhysicalColumn(t),this.sortingStates.getEntries().findIndex(e=>{let[i]=e;return i===t})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return 0===this.getNumberOfSortedColumns()}isColumnSorted(t){return(0,V.isObject)(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(t)))}getSortStates(){return null===this.sortingStates?[]:this.sortingStates.getEntries().map(t=>{let[e,i]=t;return{column:this.hot.toVisualColumn(e),...i}})}getColumnSortState(t){let e=this.getSortOrderOfColumn(t);if((0,T.isDefined)(e))return{column:t,sortOrder:e}}setSortStates(t){this.sortingStates.clear();for(let e=0;e<t.length;e+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(t[e].column),{sortOrder:t[e].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function i3(t,e,i){let r=e.locale;return function(e,n){let{sortEmptyCells:o}=i;return("string"==typeof e&&(e=e.toLocaleLowerCase(r)),"string"==typeof n&&(n=n.toLocaleLowerCase(r)),e===n)?ri:(0,T.isEmpty)(e)?(0,T.isEmpty)(n)?ri:o&&"asc"===t?rr:rn:(0,T.isEmpty)(n)?o&&"asc"===t?rn:rr:isNaN(e)&&!isNaN(n)?"asc"===t?rn:rr:!isNaN(e)&&isNaN(n)?"asc"===t?rr:rn:(isNaN(e)||isNaN(n)||(e=parseFloat(e),n=parseFloat(n)),e<n)?"asc"===t?rr:rn:e>n?"asc"===t?rn:rr:ri}}i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(75036);let i9="default";var i4=i(21413);let{register:i5,getItem:i8,hasItem:i7}=(0,i4.A)("sorting.compareFunctionFactory"),{register:i6,getItem:rt}=(0,i4.A)("sorting.mainSortComparator");function re(t){return i7(t)?i8(t):i8(i9)}i5("checkbox",function(t,e,i){let r=e.checkedTemplate,n=e.uncheckedTemplate,{sortEmptyCells:o}=i;return function(s,l){let a=(0,T.isEmpty)(s),h=(0,T.isEmpty)(l),u=a?n:s,c=h?n:l,d=u===n||u===r,g=c===n||c===r;if(!1===o){if(a&&!1===h)return rn;if(!1===a&&h)return rr}return!1===d&&g?"asc"===t?rr:rn:d&&!1===g?"asc"===t?rn:rr:!1===d&&!1===g?i3(t,e,i)(s,l):u===n&&c===r?"asc"===t?rr:rn:u===r&&c===n?"asc"===t?rn:rr:ri}}),i5("date",function(t,e,i){return rd(t,e.dateFormat,i)}),i5(i9,i3),i5("numeric",function(t,e,i){return function(e,r){let n=parseFloat(e),o=parseFloat(r),{sortEmptyCells:s}=i;if(n===o||isNaN(n)&&isNaN(o))return ri;if(s){if((0,T.isEmpty)(e))return"asc"===t?rr:rn;if((0,T.isEmpty)(r))return"asc"===t?rn:rr}return isNaN(n)?rn:isNaN(o)?rr:n<o?"asc"===t?rr:rn:n>o?"asc"===t?rn:rr:ri}}),i5("time",function(t,e,i){return rd(t,e.timeFormat,i)});let ri=0,rr=-1,rn=1;var ro=i(83457);let rs="desc",rl="colHeader";function ra(t){return t===rs?void 0:"asc"===t?rs:"asc"}function rh(t){return t.querySelector(`.${rl}`)}function ru(t,e){if(t<0||!e.parentNode)return!1;let i=e.parentNode.parentNode.childNodes;return Array.from(i).indexOf(e.parentNode)-i.length==-1}function rc(t,e,i){return -1===t&&e>=0&&!1===(0,F.isRightClick)(i)}function rd(t,e,i){return function(r,n){let{sortEmptyCells:o}=i;if(r===n)return ri;if((0,T.isEmpty)(r))return(0,T.isEmpty)(n)?ri:o&&"asc"===t?rr:rn;if((0,T.isEmpty)(n))return o&&"asc"===t?rn:rr;let s=tn(r,e),l=tn(n,e);return s.isValid()?l.isValid()?l.isAfter(s)?"asc"===t?rr:rn:l.isBefore(s)?"asc"===t?rn:rr:ri:rr:rn}}let rg="indicatorDisabled",rf="columnSorting",rp="sortAction",rm=new Map([["asc","ascending"],[rs,"descending"]]);function rw(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function rv(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let ry="columnSorting",rb="append";i6(ry,function(t,e){return function(i,r){let[,...n]=i,[,...o]=r;return function(i){let r=t[0],s=e[0],l=n[i],a=o[i],h=s.columnSorting;return(h.compareFunctionFactory?h.compareFunctionFactory:re(s.type))(r,s,h)(l,a)}(0)}}),d.R.getSingleton().register("beforeColumnSort"),d.R.getSingleton().register("afterColumnSort");let rC=new WeakMap;var rS=new WeakSet;class rE extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,rS),rw(this,"columnStatesManager",null),rw(this,"columnMetaCache",null),rw(this,"pluginKey",ry),rw(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return ry}static get PLUGIN_PRIORITY(){return 50}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var t,e,i=this;if(rC.has(this.hot)&&rC.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),t=rC.get(this.hot),e=this.pluginKey,(0,iD.R8)((0,ro.O)`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`);return}this.enabled||(rC.set(this.hot,this.pluginKey),this.columnStatesManager=new i2(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new eO._(t=>{let e=this.hot.toVisualColumn(t);return null===e&&(e=t),this.getMergedPluginSettings(e)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(t,e)=>rv(rS,this,rT).call(this,t,e)),this.addHook("beforeOnCellMouseDown",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return rv(rS,i,rM).call(i,...e)}),this.addHook("afterOnCellMouseDown",(t,e)=>this.onAfterOnCellMouseDown(t,e)),this.addHook("afterInit",()=>rv(rS,this,rR).call(this)),this.addHook("afterLoadData",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return rv(rS,i,rx).call(i,...e)}),this.hot.view&&rv(rS,this,rR).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){let t=(t,e)=>{let i=rh(e);!1!==ru(t,e)&&null!==i&&this.updateHeaderClasses(i)};rC.delete(this.hot),this.hot.addHook("afterGetColHeader",t),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",t)}),this.hot.batchExecution(()=>{null!==this.indexesSequenceCache&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();return this.sort(this.getColumnNextConfig(t.col)),!1},runOnlyIf:()=>{var t,e;let i=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return i&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(i)&&-1===i.row&&i.col>=0},relativeToGroup:W.b,position:"before",group:ry})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(ry)}sort(t){let e=this.getSortConfig(),i=this.getNormalizedSortConfigs(t),r=this.areValidSortConfigs(i);!1!==this.hot.runHooks("beforeColumnSort",e,i,r)&&(0===e.length&&null===this.indexesSequenceCache&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new iQ.K),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",e,r?i:e,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(t){return(0,T.isDefined)(t)?this.columnStatesManager.getColumnSortState(t):this.columnStatesManager.getSortStates()}setSortConfig(t){let e=this.getNormalizedSortConfigs(t);this.areValidSortConfigs(e)&&this.columnStatesManager.setSortStates(e)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t.slice(0,1):[t]}areValidSortConfigs(t){let e=this.hot.countCols();return function(t){if(t.some(t=>!1===function(t){if(!1===(0,V.isObject)(t))return!1;let{column:e,sortOrder:i}=t;return Number.isInteger(e)&&["asc",rs].includes(i)}(t)))return!1;let e=t.map(t=>{let{column:e}=t;return e});return new Set(e).size===e.length}(t)&&t.every(t=>{let{column:i}=t;return i<=e&&i>=0})}saveAllSortSettings(t){let e=this.columnStatesManager.getAllColumnsProperties();e.initialConfig=(0,z.arrayMap)(t,t=>{let{column:e,...i}=t;return{column:this.hot.toPhysicalColumn(e),...i}}),this.hot.runHooks("persistentStateSave","columnSorting",e)}getAllSavedSortSettings(){let t={};this.hot.runHooks("persistentStateLoad","columnSorting",t);let e=t.value;return(0,T.isDefined)(e)&&Array.isArray(e.initialConfig)&&(e.initialConfig=(0,z.arrayMap)(e.initialConfig,t=>{let{column:e,...i}=t;return{column:this.hot.toVisualColumn(e),...i}})),e}getColumnNextConfig(t){let e=this.columnStatesManager.getSortOrderOfColumn(t);if((0,T.isDefined)(e)){let i=ra(e);return(0,T.isDefined)(i)?{column:t,sortOrder:i}:void 0}let i=this.hot.countCols();if(Number.isInteger(t)&&t>=0&&t<i)return{column:t,sortOrder:ra()}}getNextSortConfig(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rb,i=this.columnStatesManager.getIndexOfColumnInSortQueue(t),r=-1!==i,n=this.getSortConfig(),o=this.getColumnNextConfig(t);if(r){if((0,T.isUndefined)(o))return[...n.slice(0,i),...n.slice(i+1)];if(e===rb)return[...n.slice(0,i),...n.slice(i+1),o];if("replace"===e)return[...n.slice(0,i),o,...n.slice(i+1)]}return(0,T.isDefined)(o)?n.concat(o):n}getPluginColumnConfig(t){if((0,V.isObject)(t)){let e=t[this.pluginKey];if((0,V.isObject)(e))return e}return{}}getMergedPluginSettings(t){let e=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=Object.getPrototypeOf(this.hot.getCellMeta(0,t));return Array.isArray(r.columns)?Object.assign(i,e,this.getPluginColumnConfig(r.columns[t])):(0,Y.isFunction)(r.columns)?Object.assign(i,e,this.getPluginColumnConfig(r.columns(t))):Object.assign(i,e)}getFirstCellSettings(t){let e=Object.create(this.hot.getCellMeta(0,t));return e[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(t)),e}getNumberOfRowsToSort(t){let e=this.hot.getSettings();return e.maxRows<=t?e.maxRows:t-e.minSpareRows}sortByPresetSortStates(t){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),0===t.length)return;let e=[],i=this.hot.countRows(),r=e=>(0,z.arrayMap)(t,t=>this.hot.getDataAtCell(e,t.column));for(let t=0;t<this.getNumberOfRowsToSort(i);t+=1)e.push([this.hot.toPhysicalRow(t)].concat(r(t)));let n=(0,z.arrayMap)(e,t=>t[0]);!function(t,e){let i=rt(e);for(var r=arguments.length,n=Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];t.sort(i(...n))}(e,this.pluginKey,(0,z.arrayMap)(t,t=>t.sortOrder),(0,z.arrayMap)(t,t=>this.getFirstCellSettings(t.column)));for(let t=e.length;t<i;t+=1)e.push([t].concat(r(t)));let o=(0,z.arrayMap)(e,t=>t[0]),s=new Map((0,z.arrayMap)(n,(t,e)=>[t,o[e]])),l=(0,z.arrayMap)(this.hot.rowIndexMapper.getIndexesSequence(),t=>s.has(t)?s.get(t):t);this.hot.rowIndexMapper.setIndexesSequence(l)}sortBySettings(t){if((0,V.isObject)(t)){this.columnStatesManager.updateAllColumnsProperties(t);let e=t.initialConfig;(Array.isArray(e)||(0,V.isObject)(e))&&this.sort(e)}else this.hot.render()}updateHeaderClasses(t){if((0,y.removeClass)(t,Array.from(rm.values()).concat(rp,rg,rf)),!1!==this.enabled){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];(0,y.addClass)(t,function(t,e,i,r){let n=[rf];if(r&&n.push(rp),!1===i)return n.push(rg),n;let o=t.getSortOrderOfColumn(e);return(0,T.isDefined)(o)&&n.push(rm.get(o)),n}(...i))}}onUpdateSettings(t){super.onUpdateSettings(t),null!==this.columnMetaCache&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),(0,T.isDefined)(t[this.pluginKey])&&this.sortBySettings(t[this.pluginKey])}wasClickableHeaderClicked(t,e){return this.getFirstCellSettings(e)[this.pluginKey].headerAction&&(0,y.hasClass)(t.target,rl)}onAfterOnCellMouseDown(t,e){if(!1!==rc(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(e.col));let t=this.hot.getActiveEditor(),i=this.getColumnNextConfig(e.col);null!=t&&t.isOpened()&&this.hot.getCellValidator(t.row,t.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(i)}):this.sort(i)}}destroy(){var t;null===(t=this.columnStatesManager)||void 0===t||t.destroy(),super.destroy()}}function rR(){let t=this.getAllSavedSortSettings();if((0,V.isObject)(t))this.sortBySettings(t);else{let t=this.hot.getSettings()[this.pluginKey];this.sortBySettings(t)}}function rT(t,e){let i=rh(e);if(!1===ru(t,e)||null===i)return;let r=this.getFirstCellSettings(t)[this.pluginKey],n=r.indicator,o=r.headerAction;if(this.updateHeaderClasses(i,this.columnStatesManager,t,n,o),this.hot.getSettings().ariaTags){let i=this.columnStatesManager.getSortOrderOfColumn(t);(0,y.setAttribute)(e,...(0,M._h)(i?`${i}ending`:"none"))}}function rx(t){!0===t&&this.hot.view&&rv(rS,this,rR).call(this)}function rM(t,e,i,r){!1!==rc(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(r.column=!0)}function rk(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class rO{constructor(t,e){rk(this,"plugin",void 0),rk(this,"hot",void 0),rk(this,"endpoints",[]),rk(this,"settings",void 0),rk(this,"settingsType","array"),rk(this,"currentEndpoint",null),rk(this,"cellsToSetCache",[]),this.plugin=t,this.hot=this.plugin.hot,this.settings=e}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(t){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings)[t]:this.endpoints[t]}getAllEndpoints(){return"function"===this.settingsType?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(t){return this.parseSettings(t.call(this))}parseSettings(t){let e=[],i=t;if(!i&&"function"==typeof this.settings){this.settingsType="function";return}return i||(i=this.settings),(0,z.arrayEach)(i,t=>{let i={};this.assignSetting(t,i,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(t,i,"reversedRowCoords",!1),this.assignSetting(t,i,"destinationRow",Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(t,i,"destinationColumn",Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(t,i,"sourceColumn",t.destinationColumn),this.assignSetting(t,i,"type","sum"),this.assignSetting(t,i,"forceNumeric",!1),this.assignSetting(t,i,"suppressDataTypeErrors",!0),this.assignSetting(t,i,"customFunction",null),this.assignSetting(t,i,"readOnly",!0),this.assignSetting(t,i,"roundFloat",!1),e.push(i)}),e}assignSetting(t,e,i,r){if("ranges"===i&&void 0===t[i]){e[i]=r;return}if("ranges"!==i||0!==t[i].length)if(void 0===t[i]){if(r instanceof Error)throw r;e[i]=r}else"destinationRow"===i&&e.reversedRowCoords?e[i]=this.hot.countRows()-t[i]-1:e[i]=t[i]}resetSetupBeforeStructureAlteration(t,e,i){if("function"!==this.settingsType)return;let r=t.indexOf("row")>-1?"row":"col",n=this.getAllEndpoints();(0,z.arrayEach)(n,n=>{"row"===r&&n.destinationRow>=e&&("insert_row"===t?n.alterRowOffset=i:"remove_row"===t&&(n.alterRowOffset=-1*i)),"col"===r&&n.destinationColumn>=e&&("insert_col"===t?n.alterColumnOffset=i:"remove_col"===t&&(n.alterColumnOffset=-1*i))}),this.resetAllEndpoints(n,!1)}resetSetupAfterStructureAlteration(t,e,i,r,n){let o=!(arguments.length>5)||void 0===arguments[5]||arguments[5];if("function"===this.settingsType){let t=()=>(this.hot.removeHook("beforeViewRender",t),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",t);return}let s=t.indexOf("row")>-1?"row":"col",l=t.indexOf("remove")>-1?-1:1,a=this.getAllEndpoints(),h=0===t.indexOf("move_row");(0,z.arrayEach)(a,t=>{"row"===s&&t.destinationRow>=e&&(t.alterRowOffset=l*i),"col"===s&&t.destinationColumn>=e&&(t.alterColumnOffset=l*i)}),this.resetAllEndpoints(a,!h),h?(0,z.arrayEach)(a,t=>{this.extendEndpointRanges(t,e,r[0],r.length),this.recreatePhysicalRanges(t),this.clearOffsetInformation(t)}):(0,z.arrayEach)(a,t=>{this.shiftEndpointCoordinates(t,e)}),o&&this.refreshAllEndpoints()}clearOffsetInformation(t){t.alterRowOffset=void 0,t.alterColumnOffset=void 0}extendEndpointRanges(t,e,i,r){(0,z.arrayEach)(t.ranges,t=>{t[1]&&(e>=t[0]&&e<=t[1]?i>t[1]?t[1]+=r:i<t[0]&&(t[0]-=r):i>=t[0]&&i<=t[1]&&(t[1]-=r,e<=t[0]&&(t[0]+=1,t[1]+=1)))})}recreatePhysicalRanges(t){let e=t.ranges,i=[],r=[];(0,z.arrayEach)(e,t=>{let e=[];if(t[1])for(let i=t[0];i<=t[1];i++)e.push(this.hot.toPhysicalRow(i));else e.push(this.hot.toPhysicalRow(t[0]));r.push(e)}),(0,z.arrayEach)(r,t=>{let e=[];(0,z.arrayEach)(t,(r,n)=>{0===n?e.push(r):t[n]!==t[n-1]+1&&(e.push(t[n-1]),i.push(e),(e=[]).push(r)),n===t.length-1&&(e.push(r),i.push(e))})}),t.ranges=i}shiftEndpointCoordinates(t,e){t.alterRowOffset&&0!==t.alterRowOffset?(t.destinationRow+=t.alterRowOffset||0,(0,z.arrayEach)(t.ranges,i=>{(0,z.arrayEach)(i,(r,n)=>{r>=e&&(i[n]+=t.alterRowOffset||0)})})):t.alterColumnOffset&&0!==t.alterColumnOffset&&(t.destinationColumn+=t.alterColumnOffset||0,t.sourceColumn+=t.alterColumnOffset||0)}resetAllEndpoints(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getAllEndpoints(),e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];t.some(t=>{let e=t.alterRowOffset||0,i=t.alterColumnOffset||0;return!!(t.destinationRow+e>=this.hot.countRows()||t.destinationColumn+i>=this.hot.countCols())})||(this.cellsToSetCache=[],(0,z.arrayEach)(t,t=>{this.resetEndpointValue(t,e)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],(0,z.arrayEach)(this.getAllEndpoints(),t=>{this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(t){let e=[];this.cellsToSetCache=[],(0,z.arrayEach)(t,(t,i,r)=>{`${t[2]||""}`!=`${t[3]}`&&(0,z.arrayEach)(this.getAllEndpoints(),(t,n)=>{this.hot.propToCol(r[i][1])===t.sourceColumn&&-1===e.indexOf(n)&&e.push(n)})}),(0,z.arrayEach)(e,t=>{this.refreshEndpoint(this.getEndpoint(t))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(t=>{let e=this.hot.toVisualRow(t.destinationRow);if(null!==e){let i=this.hot.getCellMeta(e,t.destinationColumn);i.readOnly=t.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(t){this.currentEndpoint=t,this.plugin.calculate(t),this.setEndpointValue(t),this.currentEndpoint=null}resetEndpointValue(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=t.alterRowOffset||0,r=t.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(t.destinationRow+(e?i:0)),this.hot.toVisualColumn(t.destinationColumn+(e?r:0)),""])}setEndpointValue(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.hot.toVisualRow(t.destinationRow);if(t.destinationRow>=this.hot.countRows()||t.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}let n=this.hot.toVisualRow(t.destinationRow);if(null!==n){let i=this.hot.getCellMeta(n,t.destinationColumn);("init"===e||i.readOnly!==t.readOnly)&&(i.readOnly=t.readOnly,i.className="columnSummaryResult")}if((!0===t.roundFloat||Number.isInteger(t.roundFloat))&&!isNaN(t.result)){let e=t.roundFloat,i=0;Number.isInteger(e)&&(i=Math.min(Math.max(0,e),100)),t.result=t.result.toFixed(i)}i?this.hot.setDataAtCell(r,t.destinationColumn,t.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,t.destinationColumn,t.result]),t.alterRowOffset=void 0,t.alterColumnOffset=void 0}throwOutOfBoundsWarning(){(0,iD.R8)("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function rI(t){return null==t||isNaN(t)}function rA(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let rN="columnSummary";var rH=new WeakSet;class rP extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,rH),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[e]=null}(this,"endpoints",null)}static get PLUGIN_KEY(){return rN}static get PLUGIN_PRIORITY(){return 220}isEnabled(){return!!this.hot.getSettings()[rN]}enablePlugin(){var t=this;this.enabled||(this.settings=this.hot.getSettings()[rN],this.endpoints=new rO(this,this.settings),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return rA(rH,t,r_).call(t,...i)}),this.addHook("afterChange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return rA(rH,t,rL).call(t,...i)}),this.addHook("afterUpdateSettings",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return rA(rH,t,rD).call(t,...i)}),this.addHook("beforeCreateRow",(t,e,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",t,e,null,i)),this.addHook("beforeCreateCol",(t,e,i)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",t,e,null,i)),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(t,e,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",t,e,null,i)),this.addHook("afterCreateCol",(t,e,i)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",t,e,null,i)),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return rA(rH,t,rF).call(t,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(t){switch(t.type.toLowerCase()){case"sum":t.result=this.calculateSum(t);break;case"min":case"max":t.result=this.calculateMinMax(t,t.type);break;case"count":t.result=this.countEntries(t);break;case"average":t.result=this.calculateAverage(t);break;case"custom":t.result=t.customFunction.call(this,t)}}calculateSum(t){let e=0;return(0,V.objectEach)(t.ranges,i=>{e+=this.getPartialSum(i,t.sourceColumn)}),e}getPartialSum(t,e){let i=0,r=t[1]||t[0],n=null,o=0;do{if(null!==(n=rI(n=this.getCellValue(r,e))?null:n)){let t=(`${n}`.split(".")[1]||[]).length||1;t>o&&(o=t)}i+=n||0,r-=1}while(r>=t[0]);return Math.round(i*10**o)/10**o}calculateMinMax(t,e){let i=null;return(0,V.objectEach)(t.ranges,r=>{let n=this.getPartialMinMax(r,t.sourceColumn,e);if(null===i&&null!==n&&(i=n),null!==n)switch(e){case"min":i=Math.min(i,n);break;case"max":i=Math.max(i,n)}}),null===i?"Not enough data":i}getPartialMinMax(t,e,i){let r,n=null,o=t[1]||t[0];do{if(r=rI(r=this.getCellValue(o,e))?null:r,null===n)n=r;else if(null!==r)switch(i){case"min":n=Math.min(n,r);break;case"max":n=Math.max(n,r)}o-=1}while(o>=t[0]);return n}countEmpty(t,e){let i,r=0,n=t[1]||t[0];do null===(i=rI(i=this.getCellValue(n,e))?null:i)&&(r+=1),n-=1;while(n>=t[0]);return r}countEntries(t){let e=0,i=t.ranges;return(0,V.objectEach)(i,i=>{let r=void 0===i[1]?1:i[1]-i[0]+1,n=this.countEmpty(i,t.sourceColumn);e+=r,e-=n}),e}calculateAverage(t){return this.calculateSum(t)/this.countEntries(t)}getCellValue(t,e){let i=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),n=this.hot.getSourceDataAtCell(t,e),o="";if(null!==i&&null!==r&&(o=this.hot.getCellMeta(i,r).className||""),o.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&("string"==typeof n&&(n=n.replace(/,/,".")),n=parseFloat(n)),isNaN(n)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw Error((0,ro.O)`ColumnSummary plugin: cell at (${t}, ${e}) is not in a\x20
          numeric format. Cannot do the calculation.`);return n}}function r_(){this.endpoints.initEndpoints()}function rD(t){void 0!==t.columns&&this.endpoints.refreshCellMetas()}function rL(t,e){t&&"ColumnSummary.reset"!==e&&"ColumnSummary.set"!==e&&"loadData"!==e&&this.endpoints.refreshChangedEndpoints(t)}function rF(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}var rV=i(81174);function rW(t,e,i){rB(t,e),e.set(t,i)}function rB(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function rj(t,e){return t.get(rU(t,e))}function rz(t,e,i){return t.set(rU(t,e),i),i}function rU(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var r$=new WeakMap,rY=new WeakMap,rG=new WeakMap,rq=new WeakSet;class rX{constructor(){!function(t,e){rB(t,e),e.add(t)}(this,rq),rW(this,r$,!0),rW(this,rY,null),rW(this,rG,new ResizeObserver(t=>rU(rq,this,rK).call(this,t)))}setObservedElement(t){rz(rY,this,t)}unobserve(){rj(rG,this).unobserve(rj(rY,this))}observe(){rz(r$,this,!0),rj(rG,this).observe(rj(rY,this))}destroy(){rj(rG,this).disconnect()}}function rK(t){if(rj(r$,this)||!Array.isArray(t)||!t.length){rz(r$,this,!1);return}t.forEach(t=>{let{borderBoxSize:e}=t,{inlineSize:i,blockSize:r}=e[0];this.runLocalHooks("resize",i,r)})}function rJ(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function rQ(t,e){return t.get(r0(t,e))}function rZ(t,e,i){return t.set(r0(t,e),i),i}function r0(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,V.mixin)(rX,rV.A);var r1=new WeakMap,r2=new WeakMap,r3=new WeakMap,r9=new WeakMap,r4=new WeakMap,r5=new WeakMap,r8=new WeakMap;class r7{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(t,e){var i=this;rJ(this,r1,void 0),rJ(this,r2,!1),rJ(this,r3,null),rJ(this,r9,void 0),rJ(this,r4,void 0),rJ(this,r5,!0),rJ(this,r8,new rX),rZ(r1,this,t),rZ(r2,this,e),rZ(r9,this,this.createEditor()),rZ(r4,this,rQ(r9,this).style),rQ(r8,this).setObservedElement(this.getInputElement()),rQ(r8,this).addLocalHook("resize",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("resize",...e)}),this.hide()}setPosition(t,e){rQ(r4,this).left=`${t}px`,rQ(r4,this).top=`${e}px`}setSize(t,e){if(t&&e){let i=this.getInputElement();i.style.width=`${t}px`,i.style.height=`${e}px`}}getSize(){return{width:(0,y.outerWidth)(this.getInputElement()),height:(0,y.outerHeight)(this.getInputElement())}}observeSize(){rQ(r8,this).observe()}resetSize(){let t=this.getInputElement();t.style.width="",t.style.height=""}setReadOnlyState(t){this.getInputElement().readOnly=t}show(){rQ(r4,this).display="block",rZ(r5,this,!1)}hide(){rQ(r8,this).unobserve(),rQ(r5,this)||(rQ(r4,this).display="none"),rZ(r5,this,!0)}isVisible(){return"block"===rQ(r4,this).display}setValue(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.getInputElement().value=t||""}getValue(){return this.getInputElement().value}isFocused(){return rQ(r1,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){let t=rQ(r1,this).createElement("div"),e=rQ(r1,this).createElement("textarea");return t.style.display="none",rZ(r3,this,rQ(r1,this).createElement("div")),rQ(r3,this).setAttribute("dir",rQ(r2,this)?"rtl":"ltr"),(0,y.addClass)(rQ(r3,this),r7.CLASS_EDITOR_CONTAINER),rQ(r1,this).body.appendChild(rQ(r3,this)),(0,y.addClass)(t,r7.CLASS_EDITOR),(0,y.addClass)(e,r7.CLASS_INPUT),e.setAttribute("data-hot-input",!0),t.appendChild(e),rQ(r3,this).appendChild(t),t}getInputElement(){return rQ(r9,this).querySelector(`.${r7.CLASS_INPUT}`)}getEditorElement(){return rQ(r9,this)}destroy(){let t=rQ(r3,this)?rQ(r3,this).parentNode:null;rQ(r9,this).parentNode.removeChild(rQ(r9,this)),rZ(r9,this,null),rZ(r4,this,null),rQ(r8,this).destroy(),t&&t.removeChild(rQ(r3,this))}}function r6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,V.mixin)(r7,rV.A);class nt{constructor(t){r6(this,"wasLastActionShow",!0),r6(this,"showDebounced",null),r6(this,"hidingTimer",null),this.updateDelay(t)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{!1===this.wasLastActionShow&&this.runLocalHooks("hide")},250)}show(t){this.wasLastActionShow=!0,this.showDebounced(t)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:250;this.showDebounced=(0,Y.debounce)(t=>{this.wasLastActionShow&&this.runLocalHooks("show",t.from.row,t.from.col)},t)}destroy(){this.clearLocalHooks()}}(0,V.mixin)(nt,rV.A);let ne="---------";function ni(t,e){let i={};return(0,z.arrayEach)(t,t=>{t.forAll((t,r)=>{t>=0&&r>=0&&(i[t]||(i[t]=[]),i[t][r]=e(t,r))})}),i}function nr(t,e,i,r,n){(0,z.arrayEach)(t,t=>{t.forAll((t,o)=>{t>=0&&o>=0&&function(t,e,i,r,n,o){let s=n(t,e),l=r;s.className&&(l="vertical"===i?function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","");return`${i} ${e}`}(s.className,r):function(t,e){if(-1!==t.indexOf(e))return t;let i=t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","");return`${i} ${e}`}(s.className,r)),o(t,e,"className",l)}(t,o,e,i,r,n)})})}function nn(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}function no(t,e){let i=!1;return Array.isArray(t)&&(0,z.arrayEach)(t,t=>(t.forAll((t,r)=>{if(t>=0&&r>=0&&e(t,r))return i=!0,!1}),i)),i}function ns(t,e){let i={top:0,left:0};if(e!==t.ownerDocument){let{frameElement:t}=e.defaultView,{top:r,left:n}=t.getBoundingClientRect();i.top=r,i.left=n}return i}function nl(t,e,i){na(t,e),e.set(t,i)}function na(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function nh(t,e,i){return t.set(nc(t,e),i),i}function nu(t,e){return t.get(nc(t,e))}function nc(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let nd="comments",ng="comment",nf="value",np="style",nm="readOnly",nw=`plugin:${nd}`;var nv=new WeakMap,ny=new WeakMap,nb=new WeakMap,nC=new WeakMap,nS=new WeakMap,nE=new WeakMap,nR=new WeakSet;class nT extends eC{constructor(){super(...arguments),function(t,e){na(t,e),e.add(t)}(this,nR),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"range",{}),nl(this,nv,null),nl(this,ny,null),nl(this,nb,!1),nl(this,nC,!1),nl(this,nS,null),nl(this,nE,"")}static get PLUGIN_KEY(){return nd}static get PLUGIN_PRIORITY(){return 60}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[nd]}enablePlugin(){var t=this;this.enabled||(nu(nv,this)||(nh(nv,this,new r7(this.hot.rootDocument,this.hot.isRtl())),nu(nv,this).addLocalHook("resize",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return nc(nR,t,nH).call(t,...i)})),nu(ny,this)||nh(ny,this,new nt(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",t=>this.addToContextMenu(t)),this.addHook("afterRenderer",(t,e,i,r,n,o)=>nc(nR,this,nI).call(this,t,o)),this.addHook("afterScroll",()=>nc(nR,this,n_).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",t=>nc(nR,this,nP).call(this,t)),this.addHook("beforeCompositionStart",t=>nc(nR,this,nP).call(this,t)),this.addHook("afterSetTheme",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return nc(nR,t,nD).call(t,...i)}),nu(ny,this).addLocalHook("hide",()=>this.hide()),nu(ny,this).addLocalHook("show",(t,e)=>this.showAtCell(t,e)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){nu(ny,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager(),e=t.getContext("grid"),i=t.addContext(nw);e.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{let e=this.hot.getSelectedRangeLast();nh(nC,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(e),this.show(),this.focusEditor(),t.setActiveContextName(nw),this.hot._registerTimeout(()=>{nh(nC,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var t;return null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight.isCell()},group:nd}),i.addShortcut({keys:[["Escape"]],callback:()=>{nu(nv,this).setValue(nu(nE,this)),this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>nu(nv,this).isVisible()&&nu(nv,this).isFocused(),group:nd}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),t.setActiveContextName("grid")},runOnlyIf:()=>nu(nv,this).isVisible()&&nu(nv,this).isFocused(),group:nd}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:t.getContext("grid"),callback:()=>{nu(nv,this).setValue(nu(nv,this).getValue()),this.hide(),t.setActiveContextName("grid")},group:nd})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(nd)}registerListeners(){let{rootDocument:t}=this.hot,e=this.getEditorInputElement();this.eventManager.addEventListener(t,"mouseover",t=>nc(nR,this,nk).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>nc(nR,this,nx).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>nc(nR,this,nO).call(this)),this.eventManager.addEventListener(e,"focus",()=>nc(nR,this,nN).call(this)),this.eventManager.addEventListener(e,"blur",()=>nc(nR,this,nA).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",t=>nc(nR,this,nM).call(this,t))}setRange(t){this.range=t}clearRange(){this.range={}}targetIsCellWithComment(t){let e=(0,y.closest)(t.target,"TD","TBODY");return!!(e&&(0,y.hasClass)(e,"htCommentCell")&&(0,y.closest)(e,[this.hot.rootElement]))}targetIsCommentTextArea(t){return this.getEditorInputElement()===t.target}setComment(t){if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let e=nu(nv,this).getValue(),i="";null!=t?i=t:null!=e&&(i=e);let r=this.range.from.row,n=this.range.from.col;this.updateCommentMeta(r,n,{[nf]:i}),this.hot.render()}setCommentAtCell(t,e,i){this.setRange({from:this.hot._createCellCoords(t,e)}),this.setComment(i)}removeComment(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');this.hot.setCellMeta(this.range.from.row,this.range.from.col,ng),t&&this.hot.render(),this.hide()}removeCommentAtCell(t,e){let i=!(arguments.length>2)||void 0===arguments[2]||arguments[2];this.setRange({from:this.hot._createCellCoords(t,e)}),this.removeComment(i)}getComment(){let t=this.range.from.row,e=this.range.from.col;return this.getCommentMeta(t,e,nf)}getCommentAtCell(t,e){return this.getCommentMeta(t,e,nf)}show(){var t;if(!this.range.from)throw Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');let{from:{row:e,col:i}}=this.range;if(e<0||e>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;let r=this.hot.getCellMeta(this.range.from.row,this.range.from.col);return nu(ny,this).cancelHiding(),nu(nv,this).setValue(null!==(t=r[ng]?r[ng][nf]:null)&&void 0!==t?t:""),nu(nv,this).show(),this.refreshEditor(!0),!0}showAtCell(t,e){return this.setRange({from:this.hot._createCellCoords(t,e)}),this.show()}hide(){nu(nv,this).hide()}refreshEditor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!t&&(!this.range.from||!nu(nv,this).isVisible()))return;let{rowIndexMapper:e,columnIndexMapper:i}=this.hot,{row:r,col:n}=this.range.from,o=e.getRenderableFromVisualIndex(r),s=i.getRenderableFromVisualIndex(n),l=null===o;nu(nv,this).setPosition(0,0),null===o&&(o=e.getRenderableFromVisualIndex(e.getNearestNotHiddenIndex(r,-1))),null===s&&(s=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(n,-1)));let a=null===o,h=null===s;o=null!=o?o:0,s=null!=s?s:0;let{rootWindow:u,view:{_wt:c}}=this.hot,{wtTable:d}=c,g=c.getCell({row:o,col:s},!0),f=this.getCommentMeta(r,n,np);f?nu(nv,this).setSize(f.width,f.height):nu(nv,this).resetSize();let p=h?0:d.getColumnWidth(s),m=l&&!a?(0,y.outerHeight)(g):0,{left:w,top:b,width:C,height:S}=g.getBoundingClientRect(),{width:E,height:R}=nu(nv,this).getSize(),{innerWidth:T,innerHeight:x}=this.hot.rootWindow,M=this.hot.rootDocument.documentElement,k=(0,y.getScrollbarWidth)(this.hot.rootDocument),O=(0,y.hasVerticalScrollbar)(this.hot.rootWindow)?k:0,I=(0,y.hasHorizontalScrollbar)(this.hot.rootWindow)?k:0,A=w+u.scrollX+p,N=b+u.scrollY+m;this.hot.isRtl()&&(A-=E+p),this.hot.isLtr()&&w+C+E>T-O?A=w+u.scrollX-E-1:this.hot.isRtl()&&A<-(M.scrollWidth-M.clientWidth)&&(A=w+u.scrollX+p+1),b+R>x-I&&(N-=R-S+1),nu(nv,this).setPosition(A,N),nu(nv,this).setReadOnlyState(this.getCommentMeta(r,n,nm)),nu(nv,this).observeSize()}focusEditor(){nu(nv,this).focus()}updateCommentMeta(t,e,i){let r,n=this.hot.getCellMeta(t,e)[ng];n?(r=(0,V.deepClone)(n),(0,V.deepExtend)(r,i)):r=i,this.hot.setCellMeta(t,e,ng,r)}getCommentMeta(t,e,i){let r=this.hot.getCellMeta(t,e);if(r[ng])return r[ng][i]}addToContextMenu(t){var e,i,r;t.items.push({name:ne},(e=this,{key:"commentsAddEdit",name(){var t;let i=null===(t=this.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return null!=i&&i.isCell()&&e.getCommentAtCell(i.row,i.col)?this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){let t=this.getSelectedRangeLast();e.setRange(t),e.show(),e.focusEditor()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(i=this,{key:"commentsRemove",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeLast().forAll((t,e)=>{t>=0&&e>=0&&i.removeCommentAtCell(t,e,!1)}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}),(r=this,{key:"commentsReadOnly",name(){let t=this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return no(this.getSelectedRange(),(t,e)=>r.getCommentMeta(t,e,nm))?nn(t):t},callback(){this.getSelectedRangeLast().forAll((t,e)=>{if(t>=0&&e>=0){let i=!!r.getCommentMeta(t,e,nm);r.updateCommentMeta(t,e,{[nm]:!i})}})},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.highlight.isHeader()||!r.getCommentAtCell(t.highlight.row,t.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected())||0===this.countRenderedRows()||0===this.countRenderedCols()}}))}getEditorInputElement(){return nu(nv,this).getInputElement()}destroy(){var t,e;null===(t=nu(nv,this))||void 0===t||t.destroy(),null===(e=nu(ny,this))||void 0===e||e.destroy(),super.destroy()}}function nx(t){if(this.hot.view&&this.hot.view._wt&&!nu(nb,this)&&!this.targetIsCommentTextArea(t)){let e=(0,y.closest)(t.target,"TD","TBODY"),i=null;e&&(i=this.hot.getCoords(e)),(!e||this.range.from&&i&&(this.range.from.row!==i.row||this.range.from.col!==i.col))&&this.hide()}}function nM(t){t.stopPropagation()}function nk(t){let{rootDocument:e}=this.hot;if(!(nu(nb,this)||nu(nv,this).isFocused()||(0,y.hasClass)(t.target,"wtBorder"))&&nu(nS,this)!==t.target&&nu(nv,this))if(nh(nS,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){let e=this.hot._createCellRange(this.hot.getCoords(t.target));nu(ny,this).show(e)}else(0,y.isChildOf)(t.target,e)&&!this.targetIsCommentTextArea(t)&&nu(ny,this).hide()}function nO(){nh(nb,this,!1)}function nI(t,e){e[ng]&&e[ng][nf]&&(0,y.addClass)(t,e.commentedCellClassName)}function nA(){nh(nE,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function nN(){nh(nE,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(nw)}function nH(t,e){this.updateCommentMeta(this.range.from.row,this.range.from.col,{[np]:{width:t,height:e}})}function nP(t){nu(nv,this).isFocused()&&(0,F.stopImmediatePropagation)(t)}function n_(){nu(nC,this)||this.hide()}function nD(){let t=nu(nv,this).getEditorElement();(0,y.removeClass)(t,/ht-theme-.*/g),(0,y.addClass)(t,this.hot.getCurrentThemeName())}function nL(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(69607);class nF{constructor(t){nL(this,"hot",void 0),nL(this,"commands",{}),nL(this,"commonCallback",null),this.hot=t}registerCommand(t,e){this.commands[t]=e}setCommonCallback(t){this.commonCallback=t}execute(t){let e;for(var i,r,n=arguments.length,o=Array(n>1?n-1:0),s=1;s<n;s++)o[s-1]=arguments[s];let l=t.split(":"),a=l[0],h=2===l.length?l[1]:null,u=this.commands[a];if(!u)throw Error(`Menu command '${a}' not exists.`);if(h&&u.submenu&&(i=h,r=u.submenu.items,(0,z.arrayEach)(r,t=>{let r=t.key?t.key.split(":"):null;if(Array.isArray(r)&&r[1]===i)return e=t,!1}),u=e),!0===u.disabled||"function"==typeof u.disabled&&!0===u.disabled.call(this.hot)||(0,V.hasOwnProperty)(u,"submenu"))return;let c=[];"function"==typeof u.callback&&c.push(u.callback),"function"==typeof this.commonCallback&&c.push(this.commonCallback),o.unshift(l.join(":")),(0,z.arrayEach)(c,t=>t.apply(this.hot,o))}}let nV="alignment",nW="clear_column",nB="col_left",nj="col_right",nz="make_read_only",nU="redo";var n$=i(16932);let nY="remove_col",nG="remove_row",nq="row_above",nX="row_below",nK="no_items",nJ="undo",nQ=[nq,nX,nB,nj,nW,nG,nY,nJ,nU,nz,nV,ne,nK],nZ={[ne]:function(){return{name:ne}},[nK]:function(){return{key:nK,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}},[nq]:function(){return{key:nq,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)||!!this.selection.isSelectedByCorner()&&0===this.countRows()},hidden(){return!this.getSettings().allowInsertRow}}},[nX]:function(){return{key:nX,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){let t=this.getSelectedRangeLast().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){let t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}},[nB]:function(){return{key:nB,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){let t=this.getSelectedRangeLast().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)||!!this.selection.isSelectedByCorner()&&0===this.countCols()},hidden(){return!this.getSettings().allowInsertColumn}}},[nj]:function(){return{key:nj,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){let t=this.getSelectedRangeLast().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}},[nW]:function(){return{key:nW,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(t,e){let i=e[0].start.col,r=e[0].end.col;this.countRows()&&this.populateFromArray(0,i,[[null]],Math.max(e[0].start.row,e[0].end.row),r,"ContextMenu.clearColumn")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((t,i)=>{if(t<0||i<0)return!0;let{readOnly:r}=this.getCellMeta(t,i);return!!r||(e=!0,!1)}),!e}}},[nG]:function(){return{key:nG,name(){let t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{let[i,,r]=t[0];i-r!=0&&(e=1)}return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_REMOVE_ROW,e)},callback(){this.alter("remove_row",(0,n$.f7)(this),1,"ContextMenu.removeRow")},disabled(){let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;let e=this.countRows();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByColumnHeader()||0===e},hidden(){return!this.getSettings().allowRemoveRow}}},[nY]:function(){return{key:nY,name(){let t=this.getSelected(),e=0;if(t)if(t.length>1)e=1;else{let[,i,,r]=t[0];i-r!=0&&(e=1)}return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_REMOVE_COLUMN,e)},callback(){this.alter("remove_col",(0,n$.NB)(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;let e=this.countCols();return this.selection.isSelectedByCorner()?0===e:this.selection.isSelectedByRowHeader()||0===e},hidden(){return!this.getSettings().allowRemoveColumn}}},[nJ]:function(){return{key:nJ,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_UNDO)},callback(){this.getPlugin("undoRedo").undo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}},[nU]:function(){return{key:nU,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_REDO)},callback(){this.getPlugin("undoRedo").redo()},hidden(){let t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}},[nz]:function(){return{key:nz,checkable:!0,ariaChecked(){return no(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly)},ariaLabel(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_READ_ONLY)},name(){let t=this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_READ_ONLY);return no(this.getSelectedRange(),(t,e)=>this.getCellMeta(t,e).readOnly)&&(t=nn(t)),t},callback(){let t=this.getSelectedRange(),e=no(t,(t,e)=>this.getCellMeta(t,e).readOnly);(0,z.arrayEach)(t,t=>{t.forAll((t,i)=>{t>=0&&i>=0&&this.setCellMeta(t,i,"readOnly",!e)})}),this.render()},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner())||0===this.countRows()||0===this.countCols()||!this.getSelectedRange()||0===this.getSelectedRange().length}}},[nV]:function(){return{key:nV,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${nV}:left`,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){let t=this.getSelectedRange(),e=ni(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htLeft";this.runHooks("beforeCellAlignment",e,t,i,r),nr(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nV}:center`,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){let t=this.getSelectedRange(),e=ni(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htCenter";this.runHooks("beforeCellAlignment",e,t,i,r),nr(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nV}:right`,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){let t=this.getSelectedRange(),e=ni(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htRight";this.runHooks("beforeCellAlignment",e,t,i,r),nr(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nV}:justify`,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){let t=this.getSelectedRange(),e=ni(t,(t,e)=>this.getCellMeta(t,e).className),i="horizontal",r="htJustify";this.runHooks("beforeCellAlignment",e,t,i,r),nr(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{name:ne},{key:`${nV}:top`,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){let t=this.getSelectedRange(),e=ni(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htTop";this.runHooks("beforeCellAlignment",e,t,i,r),nr(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nV}:middle`,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){let t=this.getSelectedRange(),e=ni(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htMiddle";this.runHooks("beforeCellAlignment",e,t,i,r),nr(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1},{key:`${nV}:bottom`,name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){let t=this.getSelectedRange(),e=ni(t,(t,e)=>this.getCellMeta(t,e).className),i="vertical",r="htBottom";this.runHooks("beforeCellAlignment",e,t,i,r),nr(t,i,r,(t,e)=>this.getCellMeta(t,e),(t,e,i,r)=>this.setCellMeta(t,e,i,r)),this.render()},disabled:!1}]}}}};function n0(){let t={};return(0,V.objectEach)(nZ,(e,i)=>{t[i]=e()}),t}function n1(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class n2{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n1(this,"hot",void 0),n1(this,"predefinedItems",n0()),n1(this,"defaultOrderPattern",void 0),this.hot=t,this.defaultOrderPattern=e}setPredefinedItems(t){let e={};this.defaultOrderPattern.length=0,(0,V.objectEach)(t,(t,i)=>{let r="";t.name===ne?(e[ne]=t,r=ne):(isNaN(parseInt(i,10))?(t.key=void 0===t.key?i:t.key,e[i]=t):e[t.key]=t,r=t.key),this.defaultOrderPattern.push(r)}),this.predefinedItems=e}getItems(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[],n=t;return n&&n.items?n=n.items:Array.isArray(n)||(n=e),(0,V.isObject)(n)?(0,V.objectEach)(n,(t,e)=>{let n=i["string"==typeof t?t:e];n||(n=t),(0,V.isObject)(t)?(0,V.extend)(n,t):"string"==typeof n&&(n={name:n}),void 0===n.key&&(n.key=e),r.push(n)}):(0,z.arrayEach)(n,(t,e)=>{let n=i[t];!n&&nQ.indexOf(t)>=0||(n||(n={name:t,key:`${e}`}),(0,V.isObject)(t)&&(0,V.extend)(n,t),void 0===n.key&&(n.key=e),r.push(n))}),r}(t,this.defaultOrderPattern,this.predefinedItems)}}function n3(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class n9{constructor(t,e){let i,r,n,o,s,l;n3(this,"top",void 0),n3(this,"topRelative",void 0),n3(this,"left",void 0),n3(this,"leftRelative",void 0),n3(this,"scrollTop",void 0),n3(this,"scrollLeft",void 0),n3(this,"cellHeight",void 0),n3(this,"cellWidth",void 0);let a=e.scrollY,h=e.scrollX;this.rootWindow=e,this.type=this.getSourceType(t),"literal"===this.type?(i=parseInt(t.top,10),n=parseInt(t.left,10),s=t.height||0,l=t.width||0,r=i,o=n,i+=a,n+=h):"event"===this.type&&(i=parseInt(t.pageY,10),n=parseInt(t.pageX,10),s=t.target.clientHeight,l=t.target.clientWidth,r=i-a,o=n-h),this.top=i,this.topRelative=r,this.left=n,this.leftRelative=o,this.scrollTop=a,this.scrollLeft=h,this.cellHeight=s,this.cellWidth=l}getSourceType(t){let e="literal";return t instanceof Event&&(e="event"),e}fitsAbove(t){return this.topRelative>=t.offsetHeight}fitsBelow(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+t.offsetHeight<=e}fitsOnRight(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootWindow.innerWidth;return this.leftRelative+this.cellWidth+t.offsetWidth<=e}fitsOnLeft(t){return this.leftRelative>=t.offsetWidth}}function n4(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function n5(t,e){return t.get(n7(t,e))}function n8(t,e,i){return t.set(n7(t,e),i),i}function n7(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var n6=new WeakMap,ot=new WeakMap,oe=new WeakMap,oi=new WeakMap,or=new WeakMap;class on{constructor(t){n4(this,n6,void 0),n4(this,ot,void 0),n4(this,oe,void 0),n4(this,oi,!1),n4(this,or,{above:0,below:0,left:0,right:0}),n8(oi,this,t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return n5(or,this)[t]=e,this}setElement(t){return n8(n6,this,t),this}setParentElement(t){return n8(ot,this,t),this}updatePosition(t){n8(oe,this,new n9(t,n5(n6,this).ownerDocument.defaultView)),n5(oi,this)?(n5(oe,this).fitsBelow(n5(n6,this))?this.setPositionBelowCursor():n5(oe,this).fitsAbove(n5(n6,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){"rtl"===n5(n6,this).dir?n5(oe,this).fitsOnLeft(n5(n6,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():n5(oe,this).fitsOnRight(n5(n6,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let t=n5(or,this).above+n5(oe,this).top-n5(n6,this).offsetHeight;if(n5(ot,this)){let e=n5(ot,this).ownerDocument.defaultView.getComputedStyle(n5(ot,this).querySelector(".ht_master")),i=Number.parseInt(e.paddingTop,10),r=Number.parseInt(e.borderTop,10);t=n5(oe,this).top+n5(oe,this).cellHeight-n5(n6,this).scrollHeight+i+r}n5(n6,this).style.top=`${t}px`}setPositionBelowCursor(){let t=n5(or,this).below+n5(oe,this).top+1;if(n5(ot,this)){let e=n5(ot,this).ownerDocument.defaultView.getComputedStyle(n5(ot,this).querySelector(".ht_master")),i=Number.parseInt(e.paddingTop,10),r=Number.parseInt(e.borderTop,10);t=n5(oe,this).top-i-r-1}n5(n6,this).style.top=`${t}px`}setPositionOnRightOfCursor(){let t=n5(oe,this).left;if(n5(ot,this)){let e=Number.parseInt(n5(ot,this).ownerDocument.defaultView.getComputedStyle(n5(ot,this).querySelector(".htCore")).borderRightWidth,10);t+=n5(oe,this).cellWidth+e}else t+=n5(or,this).right;n5(n6,this).style.left=`${t}px`}setPositionOnLeftOfCursor(){let t=n5(or,this).left+n5(oe,this).left-n5(n6,this).offsetWidth;n5(ot,this)&&(t-=Number.parseInt(n5(ot,this).ownerDocument.defaultView.getComputedStyle(n5(ot,this).querySelector(".htCore")).borderLeftWidth,10)),n5(n6,this).style.left=`${t}px`}}function oo(t){let{initialPage:e=-1,size:i=()=>0,onItemSelect:r=()=>{},onClear:n=()=>{}}=t,o=new Set,s=(0,b.clamp)(e,-1,a()-1);function l(t,e){let i=a()-1;return(t<0&&(t=i),t>i&&(t=0),o.has(t))?-1:(o.add(t),!1===r(t,!1)&&(t=l(1===e?++t:--t,e)),t)}function a(){return Math.max(i(),0)}return{setCurrentPage:function(t){t>-1&&t<a()&&!1!==r(t,!0)&&(s=t)},getCurrentPage:function(){return s},toFirstItem:function(){a()>0&&(o.clear(),s=l(0,1))},toLastItem:function(){a()>0&&(o.clear(),s=l(a()-1,-1))},toNextItem:function(){a()>0&&(o.clear(),s=l(++s,1))},toPreviousItem:function(){a()>0&&(o.clear(),s=l(--s,-1))},getSize:a,clear:function(){o.clear(),s=e,n()}}}function ol(t){return(0,V.hasOwnProperty)(t,"submenu")}function oa(t){return RegExp(ne,"i").test(t.name)}function oh(t,e){return!0===t.disabled||"function"==typeof t.disabled&&!0===t.disabled.call(e)}function ou(t){return(0,V.hasOwnProperty)(t,"disableSelection")}function oc(t,e){let i=t.slice(0);for(;0<i.length;)if(i[0].name===e)i.shift();else break;return i}let od="menu";function og(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function of(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function op(t,e,i){return t.set(ow(t,e),i),i}function om(t,e){return t.get(ow(t,e))}function ow(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var ov=new WeakMap,oy=new WeakMap,ob=new WeakMap;class oC{get tableBorderWidth(){return void 0===om(ob,this)&&this.hotMenu&&op(ob,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),om(ob,this)}constructor(t,e){var i=this;of(this,"hot",void 0),of(this,"options",void 0),of(this,"eventManager",new m.A(this)),of(this,"container",void 0),of(this,"positioner",void 0),of(this,"hotMenu",null),of(this,"hotSubMenus",{}),of(this,"parentMenu",void 0),of(this,"menuItems",null),of(this,"origOutsideClickDeselects",null),og(this,ov,void 0),og(this,oy,void 0),og(this,ob,void 0),this.hot=t,this.options=e||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:215,container:this.hot.rootDocument.documentElement},this.container=this.createContainer(this.options.name),this.positioner=new on(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.parentMenu.runLocalHooks("afterSelectionChange",...e)}),this.hot.addHook("afterSetTheme",(t,e)=>{if(!e){var i;null===(i=this.hotMenu)||void 0===i||i.useTheme(t)}})}registerEvents(){let t=this.hot.rootWindow;for(;t;)this.eventManager.addEventListener(t.document,"mousedown",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"touchstart",t=>this.onDocumentMouseDown(t)),this.eventManager.addEventListener(t.document,"contextmenu",t=>this.onDocumentContextMenu(t)),t=(0,y.getParentWindow)(t)}setMenuItems(t){this.menuItems=t}getNavigator(){return om(ov,this)}getKeyboardShortcutsCtrl(){return om(oy,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedLast()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedLast())}isSubMenu(){return null!==this.parentMenu}open(){var t,e;this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";let i=(0,Y.debounce)(t=>this.openSubMenu(t),300),r=this.options.minWidth||215,n=!1,o=(0,z.arrayFilter)(this.menuItems,t=>{var e;return t.key===nK&&(n=!0),e=this.hot,!t.hidden||!("function"==typeof t.hidden&&t.hidden.call(e))});if(o.length<1&&!n)o.push(n0()[nK]);else if(0===o.length)return;o=function(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ne,r=t.slice(0);return(e=(r=oc(r,i)).slice(0)).reverse(),(e=oc(e,i)).reverse(),r=function(t){let e=[];return(0,z.arrayEach)(t,(t,i)=>{i>0?e[e.length-1].name!==t.name&&e.push(t):e.push(t)}),e}(r=e)}(o,ne);let s=!1,l={data:o,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth:t=>(0,T.isDefined)(t)&&t<r?r:t,autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:(t=this.hot,(e,i,r,n,o,s)=>{let l=e.getSourceDataAtRow(r),a=t.rootDocument.createElement("div"),h="function"==typeof s?s.call(t):s,u="function"==typeof l.ariaLabel?l.ariaLabel.call(t):l.ariaLabel,c="function"==typeof l.ariaChecked?l.ariaChecked.call(t):l.ariaChecked;if((0,y.empty)(i),(0,y.addClass)(a,"htItemWrapper"),t.getSettings().ariaTags){let e=!oh(l,t)&&!ou(l)&&!oa(l);(0,y.setAttribute)(i,[...!0===l.checkable?[(0,M.pt)(),(0,M.SM)(u),(0,M.Xq)(c)]:[(0,M.ZA)(),(0,M.SM)(h)],...e?[(0,M.vC)(-1)]:[],...oh(l,t)?[(0,M._R)()]:[],...ol(l)?[(0,M.dV)(!1)]:[]])}i.className="",i.appendChild(a),oa(l)?(0,y.addClass)(i,"htSeparator"):"function"==typeof l.renderer?((0,y.addClass)(i,"htCustomMenuRenderer"),i.appendChild(l.renderer(e,a,r,n,o,h))):(0,y.fastInnerHTML)(a,h),oh(l,t)?(0,y.addClass)(i,"htDisabled"):ou(l)?(0,y.addClass)(i,"htSelectionDisabled"):ol(l)&&(0,y.addClass)(i,"htSubmenu")})}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(t,e)=>{om(ov,this).setCurrentPage(e.row)},afterOnCellMouseOver:(t,e)=>{this.isAllSubMenusClosed()?i(e.row):this.openSubMenu(e.row)},afterOnCellContextMenu:t=>{t.preventDefault(),(0,w.isWindowsOS)()&&s&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(t,e,i,r,n)=>{this.hotMenu.view.isMouseDown()&&(n.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:t=>{this.hasSelectedItem()&&(s=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(t))},afterOnCellMouseUp:t=>{(!(0,w.isWindowsOS)()||!(0,F.isRightClick)(t))&&s&&this.hasSelectedItem()&&((0,w.isMobileBrowser)()||(0,w.isIpadOS)()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,l),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),op(ov,this,(e=this.hotMenu,oo({size:()=>e.countRows(),onItemSelect(t,i){let r=e.getCell(t,0);if(!r||(0,y.hasClass)(r,"htSeparator")||(0,y.hasClass)(r,"htDisabled")||(0,y.hasClass)(r,"htSelectionDisabled"))return!1;e.selectCell(t,0,...i?[t,0,!1,!1]:[])},onClear(){e.deselectCell()}}))),op(oy,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];function r(t,e){s(e).addShortcuts(t,{group:od})}function n(t,e){let n=s(e);t.forEach(t=>{let{keys:e}=t;e.forEach(t=>n.removeShortcutsByKeys(t))}),i.push({shortcuts:t,contextName:e}),r(t,e)}function o(t){return t?`${od}:${t}`:od}function s(e){var i;let r=t.hotMenu.getShortcutManager(),n=o(e);return null!==(i=r.getContext(n))&&void 0!==i?i:r.addContext(n)}return r(function(t){let{hot:e,hotMenu:i}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{let n=e.getSettings(),o="function"==typeof n.tabMoves?n.tabMoves(i):n.tabMoves;r.includes("shift")?e.selection.transformStart(-o.row,-o.col):e.selection.transformStart(o.row,o.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{let e=i.getSelectedLast();if(e){let i=t.openSubMenu(e[0]);i&&i.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{i.getSelectedLast()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:e=>{let r=i.getSelectedLast();r&&(i.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(e),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(-i.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{i.getSelectedLast()?i.selection.transformStart(i.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}(t)),e.forEach(t=>{let{shortcuts:e,contextName:i}=t;n(e,i)}),{addCustomShortcuts:n,getCustomShortcuts:function(){return[...i]},getContext:s,listen:function(e){t.hotMenu.getShortcutManager().setActiveContextName(o(e))}}}(this)),om(oy,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isOpened()){if(t&&this.isSubMenu())this.parentMenu.close();else if(om(ov,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){let t=this.parentMenu.hotMenu.getSelectedLast();if(t){let e=this.parentMenu.hotMenu.getCell(t[0],0);(0,y.setAttribute)(e,[(0,M.dV)(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(t){if(!this.hotMenu)return!1;let e=this.hotMenu.getCell(t,0);if(this.closeAllSubMenus(),!e||!(0,y.hasClass)(e,"htSubmenu"))return!1;let i=this.hotMenu.getSourceDataAtRow(t),r=new oC(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(e.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&(0,y.setAttribute)(e,[(0,M.dV)(!0)]),r}closeSubMenu(t){let e=this.hotMenu.getSourceDataAtRow(t),i=this.hotSubMenus[e.key];if(i){i.destroy(),delete this.hotSubMenus[e.key];let r=this.hotMenu.getCell(t,0);this.hot.getSettings().ariaTags&&(0,y.setAttribute)(r,[(0,M.dV)(!1)])}}closeAllSubMenus(){(0,z.arrayEach)(this.hotMenu.getData(),(t,e)=>this.closeSubMenu(e))}isAllSubMenusClosed(){return 0===Object.keys(this.hotSubMenus).length}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){let t=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),t&&t.removeChild(this.container)}isOpened(){return null!==this.hotMenu}executeCommand(t){if(!this.isOpened()||!this.hasSelectedItem())return;let e=this.getSelectedItem();if(this.runLocalHooks("select",e,t),this.isCommandPassive(e))return;let i=this.hot.getSelectedRange(),r=i?(0,z.arrayMap)(i,t=>({start:t.getTopStartCorner(),end:t.getBottomEndCorner()})):[];this.runLocalHooks("executeCommand",e.key,r,t),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",e.key,r,t)}isCommandPassive(t){return!1===t.isCommand||oa(t)||oh(t,this.hot)||ol(t)}setOffset(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.positioner.setOffset(t,e)}setPosition(t){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(t)}updateMenuDimensions(){let t=this.hotMenu.view.getStylesHandler(),{wtTable:e}=this.hotMenu.view._wt,i=this.hotMenu.getSettings().data,r=e.hider.style,n=e.holder.style,o=parseInt(r.width,10),s=(0,z.arrayReduce)(i,(t,e,i)=>{let r=this.hotMenu.getCell(i,0)?(0,y.outerHeight)(this.hotMenu.getCell(i,0)):0;return t+(e.name===ne?1:r)},0);t.isClassicTheme()?(n.width=`${o+3}px`,n.height=`${s+3}px`):(n.width=`${o}px`,n.height=`${s}px`),r.height=n.height}createContainer(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=this.options.container.ownerDocument,r=e;return r&&((0,Y.isFunction)(r)&&(r=null===(r=r.call(this.hot))||(0,T.isUndefined)(r)?"":r.toString()),r=r.replace(/[^A-Za-z0-9]/g,"_"),r=`${this.options.className}Sub_${r}`,t=i.querySelector(`.${this.options.className}.${r}`)),t||(t=i.createElement("div"),(0,y.addClass)(t,`htMenu handsontable ${this.options.className}`),r&&(0,y.addClass)(t,r),this.options.container.appendChild(t)),t}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&(0,y.setAttribute)(this.hotMenu.rootElement,[(0,M.nF)(),(0,M.vC)(-1)])}onDocumentMouseDown(t){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!(0,y.isChildOf)(t.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!(0,y.isChildOf)(t.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(t){this.isOpened()&&(0,y.hasClass)(t.target,"htCore")&&(0,y.isChildOf)(t.target,this.hotMenu.rootElement)&&t.preventDefault()}}function oS(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function oE(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,V.mixin)(oC,rV.A);let oR="contextMenu";d.R.getSingleton().register("afterContextMenuDefaultOptions"),d.R.getSingleton().register("beforeContextMenuShow"),d.R.getSingleton().register("afterContextMenuShow"),d.R.getSingleton().register("afterContextMenuHide"),d.R.getSingleton().register("afterContextMenuExecute");var oT=new WeakSet;class ox extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,oT),oS(this,"commandExecutor",new nF(this.hot)),oS(this,"itemsFactory",null),oS(this,"menu",null)}static get PLUGIN_KEY(){return oR}static get PLUGIN_PRIORITY(){return 70}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nq,nX,ne,nB,nj,ne,nG,nY,ne,nJ,nU,ne,nz,ne,nV]}isEnabled(){return!!this.hot.getSettings()[oR]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[oR];"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.menu=new oC(this.hot,{className:"htContextMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.menu.addLocalHook("beforeOpen",()=>oE(oT,this,ok).call(this)),this.menu.addLocalHook("afterOpen",()=>oE(oT,this,oO).call(this)),this.menu.addLocalHook("afterClose",()=>oE(oT,this,oI).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),this.addHook("afterOnCellContextMenu",t=>oE(oT,this,oM).call(this,t)),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();this.hot.scrollToFocusedCell();let e=this.hot.getCell(t.row,t.col,!0).getBoundingClientRect(),i=ns(this.menu.container,this.hot.rootDocument);this.open({left:e.left+i.left,top:e.top+i.top-1+e.height},{left:e.width,above:-e.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&!this.menu.isOpened()},group:oR})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(oR)}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};if(null!==(e=this.menu)&&void 0!==e&&e.isOpened())return;this.prepareMenuItems(),this.menu.open();let r=this.menu.tableBorderWidth>0;(0,V.objectEach)(i,(t,e)=>{let i=["below","right"].includes(e)?t+1:t-1;this.menu.setOffset(e,r?t:i)}),this.menu.setPosition(t)}close(){var t;null===(t=this.menu)||void 0===t||t.close(),this.itemsFactory=null}executeCommand(t){null===this.itemsFactory&&this.prepareMenuItems();for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}prepareMenuItems(){this.itemsFactory=new n2(this.hot,ox.DEFAULT_ITEMS);let t=this.hot.getSettings()[oR],e={items:this.itemsFactory.getItems(t)};this.hot.runHooks("afterContextMenuDefaultOptions",e),this.itemsFactory.setPredefinedItems(e.items);let i=this.itemsFactory.getItems(t);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),(0,z.arrayEach)(i,t=>this.commandExecutor.registerCommand(t.key,t))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function oM(t){let e=this.hot.getSettings(),i=e.rowHeaders,r=e.colHeaders,n=t.target;if(this.close(),(0,y.hasClass)(n,"handsontableInput"))return;if(t.preventDefault(),t.stopPropagation(),!(i||r)){if("TD"!==n.nodeName&&"TD"!==n.parentNode.nodeName&&!((0,y.hasClass)(n,"current")&&(0,y.hasClass)(n,"wtBorder")))return}let o=ns(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+o.top,left:t.clientX+o.left})}function ok(){this.hot.runHooks("beforeContextMenuShow",this)}function oO(){this.hot.runHooks("afterContextMenuShow",this)}function oI(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ox.SEPARATOR={name:ne};var oA=i(18045);class oN{constructor(){this.data={}}setData(t,e){this.data[t]=e}getData(t){return this.data[t]||void 0}}class oH{constructor(){this.clipboardData=new oN}preventDefault(){}composedPath(){return[]}}function oP(t,e,i){o_(t,e),e.set(t,i)}function o_(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function oD(t,e){return t.get(oF(t,e))}function oL(t,e,i){return t.set(oF(t,e),i),i}function oF(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var oV=new WeakMap,oW=new WeakMap,oB=new WeakMap,oj=new WeakMap,oz=new WeakMap,oU=new WeakMap,o$=new WeakSet;class oY{constructor(t){let{countRows:e,countColumns:i,rowsLimit:r,columnsLimit:n,countColumnHeaders:o}=t;!function(t,e){o_(t,e),e.add(t)}(this,o$),oP(this,oV,void 0),oP(this,oW,void 0),oP(this,oB,void 0),oP(this,oj,void 0),oP(this,oz,void 0),oP(this,oU,void 0),oL(oW,this,e),oL(oB,this,i),oL(oj,this,r),oL(oz,this,n),oL(oU,this,o)}setSelectedRange(t){oL(oV,this,t)}getCellsRange(){if(0===oD(oW,this).call(this)||0===oD(oB,this).call(this))return null;let{row:t,col:e}=oD(oV,this).getTopStartCorner(),{row:i,col:r}=oD(oV,this).getBottomEndCorner(),n=oF(o$,this,oq).call(this,t,i),o=oF(o$,this,oG).call(this,e,r);return{isRangeTrimmed:i!==n||r!==o,startRow:t,startCol:e,endRow:n,endCol:o}}getMostBottomColumnHeadersRange(){if(0===oD(oB,this).call(this)||0===oD(oU,this).call(this))return null;let{col:t}=oD(oV,this).getTopStartCorner(),{col:e}=oD(oV,this).getBottomEndCorner(),i=oF(o$,this,oG).call(this,t,e);return{isRangeTrimmed:e!==i,startRow:-1,startCol:t,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(0===oD(oB,this).call(this)||0===oD(oU,this).call(this))return null;let{col:t}=oD(oV,this).getTopStartCorner(),{col:e}=oD(oV,this).getBottomEndCorner(),i=oF(o$,this,oG).call(this,t,e);return{isRangeTrimmed:e!==i,startRow:-oD(oU,this).call(this),startCol:t,endRow:-1,endCol:i}}}function oG(t,e){return Math.min(e,Math.max(t+oD(oz,this).call(this)-1,t))}function oq(t,e){return Math.min(e,Math.max(t+oD(oj,this).call(this)-1,t))}function oX(t){let e=[],i=[];return(0,z.arrayEach)(t,t=>{let r=Math.min(t.startRow,t.endRow),n=Math.max(t.startRow,t.endRow);(0,b.rangeEach)(r,n,t=>{-1===e.indexOf(t)&&e.push(t)});let o=Math.min(t.startCol,t.endCol),s=Math.max(t.startCol,t.endCol);(0,b.rangeEach)(o,s,t=>{-1===i.indexOf(t)&&i.push(t)})}),{rows:e,columns:i}}var oK=i(11055);function oJ(t,e,i){oQ(t,e),e.set(t,i)}function oQ(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function oZ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o0(t,e){return t.get(o2(t,e))}function o1(t,e,i){return t.set(o2(t,e),i),i}function o2(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("afterCopyLimit"),d.R.getSingleton().register("modifyCopyableRange"),d.R.getSingleton().register("beforeCut"),d.R.getSingleton().register("afterCut"),d.R.getSingleton().register("beforePaste"),d.R.getSingleton().register("afterPaste"),d.R.getSingleton().register("beforeCopy"),d.R.getSingleton().register("afterCopy");let o3="copyPaste",o9=["fragmentSelection"],o4='<meta name="generator" content="Handsontable"/><style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>';var o5=new WeakMap,o8=new WeakMap,o7=new WeakMap,o6=new WeakMap,st=new WeakMap,se=new WeakMap,si=new WeakMap,sr=new WeakMap,sn=new WeakSet;class so extends eC{constructor(){super(...arguments),function(t,e){oQ(t,e),e.add(t)}(this,sn),oZ(this,"columnsLimit",1/0),oZ(this,"rowsLimit",1/0),oZ(this,"pasteMode","overwrite"),oZ(this,"uiContainer",this.hot.rootDocument.body),oJ(this,o5,!1),oJ(this,o8,!1),oJ(this,o7,!1),oJ(this,o6,"cells-only"),oJ(this,st,!1),oJ(this,se,!1),oJ(this,si,new oY({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),oJ(this,sr,!1),oZ(this,"copyableRanges",[])}static get PLUGIN_KEY(){return o3}static get SETTING_KEYS(){return[o3,...o9]}static get PLUGIN_PRIORITY(){return 80}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[o3]}enablePlugin(){var t,e,i=this;this.enabled||(this.pasteMode=null!==(t=this.getSetting("pasteMode"))&&void 0!==t?t:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),o1(o5,this,this.getSetting("copyColumnHeaders")),o1(o8,this,this.getSetting("copyColumnGroupHeaders")),o1(o7,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=null!==(e=this.getSetting("uiContainer"))&&void 0!==e?e:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",t=>o2(sn,this,su).call(this,t)),this.addHook("afterSelection",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return o2(sn,i,sc).call(i,...e)}),this.addHook("afterSelectionEnd",()=>o2(sn,this,sd).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),(0,w.isSafari)()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return o2(sn,i,sg).call(i,...e)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return o2(sn,i,sf).call(i,...e)}),this.addHook("afterSelection",()=>o2(sn,this,sp).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"cells-only";o1(o6,this,t),o1(st,this,!0),o2(sn,this,ss).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){o1(se,this,!0),o2(sn,this,ss).call(this,"cut")}getRangedCopyableData(t){return(0,oA.A)(this.getRangedData(t))}getRangedData(t){let e=[],{rows:i,columns:r}=oX(t);return(0,z.arrayEach)(i,t=>{let i=[];(0,z.arrayEach)(r,e=>{t<0?i.push(this.hot.getColHeader(e,t)):i.push(this.hot.getCopyableData(t,e))}),e.push(i)}),e}paste(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(!t&&!e)return;let i=new oH;t&&i.clipboardData.setData("text/plain",t),e&&i.clipboardData.setData("text/html",e),this.onPaste(i)}setCopyableText(){let t=this.hot.getSelectedRangeLast();if(!t)return;if(t.isSingleHeader()){this.copyableRanges=[];return}o0(si,this).setSelectedRange(t);let e=new Map([["headers",null],["cells",null]]);"column-headers-only"===o0(o6,this)?e.set("headers",o0(si,this).getMostBottomColumnHeadersRange()):("with-column-headers"===o0(o6,this)?e.set("headers",o0(si,this).getMostBottomColumnHeadersRange()):"with-column-group-headers"===o0(o6,this)&&e.set("headers",o0(si,this).getAllColumnHeadersRange()),e.set("cells",o0(si,this).getCellsRange())),this.copyableRanges=Array.from(e.values()).filter(t=>null!==t).map(t=>{let{startRow:e,startCol:i,endRow:r,endCol:n}=t;return{startRow:e,startCol:i,endRow:r,endCol:n}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);let i=e.get("cells");if(null!==i&&i.isRangeTrimmed){let{startRow:t,startCol:e,endRow:r,endCol:n}=i;this.hot.runHooks("afterCopyLimit",r-t+1,n-e+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var t;return null===(t=this.hot.getActiveEditor())||void 0===t?void 0:t.isOpened()}populateValues(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hot.getSelectedRangeLast();if(!t.length)return;let i=t.length,r=t[0].length,n=[],{row:o,col:s}=e.getTopStartCorner(),{row:l,col:a}=e.getBottomEndCorner(),h=o,u=s,c=o,d=s;for(;n.length<i||h<=l;){let{skipRowOnPaste:e,visualRow:l}=this.hot.getCellMeta(h,s);if(h=l+1,!0===e)continue;c=l,u=s;let g=[],f=n.length%i;for(;g.length<r||u<=a;){let{skipColumnOnPaste:e,visualCol:i}=this.hot.getCellMeta(o,u);if(u=i+1,!0===e)continue;d=i;let n=g.length%r;g.push(t[f][n])}n.push(g)}return o1(sr,this,!0),this.hot.populateFromArray(o,s,n,void 0,void 0,"CopyPaste.paste",this.pasteMode),[o,s,c,d]}onCopy(t){let e=t.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=null==e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!o0(st,this)||this.isEditorOpened()||(0,y.isHTMLElement)(e)&&(r&&e!==i||!r&&e!==this.hot.rootDocument.body&&!(0,y.isInternalElement)(e,this.hot.rootElement)))return;t.preventDefault(),this.setCopyableText(),o1(st,this,!1);let n=this.getRangedData(this.copyableRanges),o=o2(sn,this,sl).call(this,this.copyableRanges);if(this.hot.runHooks("beforeCopy",n,this.copyableRanges,o)){let e=(0,oA.A)(n);if(t&&t.clipboardData){let i=(0,oK._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[o4,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.runHooks("afterCopy",n,this.copyableRanges,o)}o1(o6,this,"cells-only")}onCut(t){let e=t.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=null==e?void 0:e.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!o0(se,this)||this.isEditorOpened()||(0,y.isHTMLElement)(e)&&(r&&e!==i||!r&&e!==this.hot.rootDocument.body&&!(0,y.isInternalElement)(e,this.hot.rootElement)))return;t.preventDefault(),this.setCopyableText(),o1(se,this,!1);let n=this.getRangedData(this.copyableRanges);if(this.hot.runHooks("beforeCut",n,this.copyableRanges)){let e=(0,oA.A)(n);if(t&&t.clipboardData){let i=(0,oK._dataToHTML)(n,this.hot.rootDocument);t.clipboardData.setData("text/plain",e),t.clipboardData.setData("text/html",[o4,i].join(""))}else"undefined"==typeof ClipboardEvent&&this.hot.rootWindow.clipboardData.setData("Text",e);this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",n,this.copyableRanges)}}onPaste(t){let e,i=t.composedPath()[0],r=this.hot.getFocusManager().getRefocusElement(),n=null==i?void 0:i.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||(0,y.isHTMLElement)(i)&&(n&&i!==r||!n&&i!==this.hot.rootDocument.body&&!(0,y.isInternalElement)(i,this.hot.rootElement)))return;if(t.preventDefault(),t&&void 0!==t.clipboardData){let i=(0,U.sanitize)(t.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});e=i&&/(<table)|(<TABLE)/g.test(i)?(0,oK.htmlToGridSettings)(i,this.hot.rootDocument).data:t.clipboardData.getData("text/plain")}else"undefined"==typeof ClipboardEvent&&void 0!==this.hot.rootWindow.clipboardData&&(e=this.hot.rootWindow.clipboardData.getData("Text"));if("string"==typeof e&&(e=(0,oA.q)(e)),void 0===e||e&&0===e.length||!1===this.hot.runHooks("beforePaste",e,this.copyableRanges))return;let[o,s,l,a]=this.populateValues(e);this.hot.selectCell(o,s,Math.min(this.hot.countRows()-1,l),Math.min(this.hot.countCols()-1,a)),this.hot.runHooks("afterPaste",e,this.copyableRanges)}destroy(){super.destroy()}}function ss(t){if((0,w.isSafari)()){let e=this.hot.getSelectedRangeLast();if(e){let{row:i,col:r}=e.highlight,n=this.hot.getCell(i,r,!0);n&&(0,y.runWithSelectedContendEditableElement)(n,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function sl(t){let{rows:e}=oX(t),i=0;for(let t=0;t<e.length&&!(e[t]>=0);t++)i+=1;return{columnHeadersCount:i}}function sa(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);r&&(0,y.makeElementContentEditableAndSelectItsContent)(r)}}}function sh(){if(this.hot.isListening()){let t=this.hot.getSelectedRangeLast();if(t){let{row:e,col:i}=t.highlight,r=this.hot.getCell(e,i,!0);null!=r&&r.hasAttribute("contenteditable")&&(0,y.removeContentEditableFromElementAndDeselect)(r)}}}function su(t){var e,i,r,n,o;t.items.push({name:"---------"},(e=this,{key:"copy",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_COPY)},callback(){e.copyCellsOnly()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||!!(e.length>1)},hidden:!1})),o0(o5,this)&&t.items.push((i=this,{key:"copy_with_column_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,b.clamp)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,e)},callback(){i.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||!!(e.length>1)},hidden:!1})),o0(o8,this)&&t.items.push((r=this,{key:"copy_with_column_group_headers",name(){let t=this.getSelectedRangeLast(),e=t?(0,b.clamp)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,e)},callback(){r.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||!!(e.length>1)},hidden:!1})),o0(o7,this)&&t.items.push((n=this,{key:"copy_column_headers_only",name(){let t=this.getSelectedRangeLast(),e=t?(0,b.clamp)(t.getWidth()-1,0,1):0;return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,e)},callback(){n.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||!!(e.length>1)},hidden:!1})),t.items.push((o=this,{key:"cut",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_CUT)},callback(){o.cut()},disabled(){if(0===this.countRows()||0===this.countCols())return!0;let t=this.getSelectedRangeLast();if(!t||t.isSingleHeader())return!0;let e=this.getSelected();return!e||!!(e.length>1)},hidden:!1}))}function sc(t,e,i,r,n){o0(sr,this)&&(n.value=!0),o1(sr,this,!1)}function sd(){!this.isEditorOpened()&&(this.hot.getSettings().fragmentSelection||this.setCopyableText())}function sg(){o2(sn,this,sh).call(this)}function sf(){o2(sn,this,sa).call(this)}function sp(){o2(sn,this,sh).call(this)}function sm(t,e){return`border_row${t}col${e}`}function sw(){return{width:1,color:"#000"}}function sv(){return{hide:!0}}function sy(t){var e,i;return((0,T.isDefined)(t.start)||(0,T.isDefined)(t.left))&&(t.start=null!==(e=t.start)&&void 0!==e?e:t.left),((0,T.isDefined)(t.end)||(0,T.isDefined)(t.right))&&(t.end=null!==(i=t.end)&&void 0!==i?i:t.right),delete t.left,delete t.right,t}function sb(t){return(0,T.isDefined)(t.start)&&(t.left=t.start),(0,T.isDefined)(t.end)&&(t.right=t.end),t}function sC(t,e){return{id:sm(t,e),border:{width:1,color:"#000",cornerVisible:!1},row:t,col:e,top:sv(),bottom:sv(),start:sv(),end:sv()}}function sS(t,e){let i=!1;return(0,z.arrayEach)(t.getSelectedRange(),r=>{r.forAll((r,n)=>{if(r<0||n<0)return;let o=t.getCellMeta(r,n).borders;if(o){if(!e)return i=!0,!1;else if(!(0,V.hasOwnProperty)(o[e],"hide")||!1===o[e].hide)return i=!0,!1}})}),i}function sE(t){return`<span class="selected">${String.fromCharCode(10003)}</span>${t}`}let sR=new Map([["left","start"],["right","end"]]);function sT(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let sx="customBorders";var sM=new WeakSet;class sk extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,sM),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"savedBorders",[])}static get PLUGIN_KEY(){return sx}static get PLUGIN_PRIORITY(){return 90}isEnabled(){return!!this.hot.getSettings()[sx]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>sT(sM,this,sO).call(this,t)),this.addHook("init",()=>sT(sM,this,sI).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(t,e){let i=["top","bottom","start","end"],r=null;e&&(this.checkSettingsCohesion([e]),i=Object.keys(e),r=sy(e));let n=(0,n$.ML)(t),o=(0,n$._e)(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});(0,z.arrayEach)(t,t=>{o(t).forAll((t,e)=>{(0,z.arrayEach)(i,i=>{var n;this.prepareBorderFromCustomAdded(t,e,r,null!==(n=sR.get(i))&&void 0!==n?n:i)})})}),this.hot.view.render()}getBorders(t){if(!Array.isArray(t))return this.savedBorders;let e=(0,n$.ML)(t),i=(0,n$._e)(e,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return(0,z.arrayEach)(t,t=>{i(t).forAll((t,e)=>{(0,z.arrayEach)(this.savedBorders,i=>{i.row===t&&i.col===e&&r.push(sb(i))})})}),r}clearBorders(t){t?this.setBorders(t):((0,z.arrayEach)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange(),this.hot.removeCellMeta(t.row,t.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(t,e){this.checkSavedBorders(t)||this.savedBorders.push(t);let i=this.hot._createCellRange(this.hot._createCellCoords(t.row,t.col));this.checkCustomSelections(t,i,e)||this.hot.selection.highlight.addCustomSelection({border:t,visualCellRange:i})}prepareBorderFromCustomAdded(t,e,i,r){let n=this.hot.countRows(),o=this.hot.countCols();if(t>=n||e>=o)return;let s=sC(t,e);if(i){var l;l=s,(0,V.hasOwnProperty)(i,"border")&&i.border&&(l.border=i.border),(0,V.hasOwnProperty)(i,"top")&&(0,T.isDefined)(i.top)&&(i.top?(0,V.isObject)(i.top)||(i.top=sw()):i.top=sv(),l.top=i.top),(0,V.hasOwnProperty)(i,"bottom")&&(0,T.isDefined)(i.bottom)&&(i.bottom?(0,V.isObject)(i.bottom)||(i.bottom=sw()):i.bottom=sv(),l.bottom=i.bottom),(0,V.hasOwnProperty)(i,"start")&&(0,T.isDefined)(i.start)&&(i.start?(0,V.isObject)(i.start)||(i.start=sw()):i.start=sv(),l.start=i.start),(0,V.hasOwnProperty)(i,"end")&&(0,T.isDefined)(i.end)&&(i.end?(0,V.isObject)(i.end)||(i.end=sw()):i.end=sv(),l.end=i.end),s=l,(0,z.arrayEach)(this.hot.selection.highlight.customSelections,t=>{if(s.id===t.settings.id)return Object.assign(t.settings,i),s.id=t.settings.id,s.top=t.settings.top,s.bottom=t.settings.bottom,s.start=t.settings.start,s.end=t.settings.end,!1})}this.hot.setCellMeta(t,e,"borders",sb(s)),this.insertBorderIntoSettings(s,r)}prepareBorderFromCustomAddedRange(t,e){let i=Math.min(t.to.row,this.hot.countRows()-1),r=Math.min(t.to.col,this.hot.countCols()-1);(0,b.rangeEach)(t.from.row,i,i=>{(0,b.rangeEach)(t.from.col,r,r=>{let n=sC(i,r),o=0;i===t.from.row&&(0,V.hasOwnProperty)(e,"top")&&(o+=1,n.top=e.top),i===t.to.row&&(0,V.hasOwnProperty)(e,"bottom")&&(o+=1,n.bottom=e.bottom),r===t.from.col&&(0,V.hasOwnProperty)(e,"start")&&(o+=1,n.start=e.start),r===t.to.col&&(0,V.hasOwnProperty)(e,"end")&&(o+=1,n.end=e.end),o>0&&(this.hot.setCellMeta(i,r,"borders",sb(n)),this.insertBorderIntoSettings(n))})})}removeAllBorders(t,e){let i=sm(t,e);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(t,e,"borders")}setBorder(t,e,i,r){let n=this.hot.getCellMeta(t,e).borders;n=n&&void 0!==n.border?sy(n):sC(t,e),r?(n[i]=sv(),4===this.countHide(n)?this.removeAllBorders(t,e):(this.checkCustomSelectionsFromContextMenu(n,i,r)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(t,e,"borders",sb(n)))):(n[i]=sw(),this.checkCustomSelectionsFromContextMenu(n,i,r)||this.insertBorderIntoSettings(n),this.hot.setCellMeta(t,e,"borders",sb(n)))}prepareBorder(t,e,i){(0,z.arrayEach)(t,t=>{let{start:r,end:n}=t;if(r.row===n.row&&r.col===n.col)"noBorders"===e?this.removeAllBorders(r.row,r.col):this.setBorder(r.row,r.col,e,i);else switch(e){case"noBorders":(0,b.rangeEach)(r.col,n.col,t=>{(0,b.rangeEach)(r.row,n.row,e=>{this.removeAllBorders(e,t)})});break;case"top":(0,b.rangeEach)(r.col,n.col,t=>{this.setBorder(r.row,t,e,i)});break;case"bottom":(0,b.rangeEach)(r.col,n.col,t=>{this.setBorder(n.row,t,e,i)});break;case"start":(0,b.rangeEach)(r.row,n.row,t=>{this.setBorder(t,r.col,e,i)});break;case"end":(0,b.rangeEach)(r.row,n.row,t=>{this.setBorder(t,n.col,e,i)})}})}createCustomBorders(t){(0,z.arrayEach)(t,t=>{let e=sy(t);t.range?this.prepareBorderFromCustomAddedRange(t.range,e):this.prepareBorderFromCustomAdded(t.row,t.col,e)})}countHide(t){let{top:e,bottom:i,start:r,end:n}=t;return(0,z.arrayReduce)([e,i,r,n],(t,e)=>{let i=t;return e&&e.hide&&(i+=1),i},0)}clearBordersFromSelectionSettings(t){let e=(0,z.arrayMap)(this.hot.selection.highlight.customSelections,t=>t.settings.id).indexOf(t);e>-1&&this.hot.selection.highlight.customSelections[e].clear()}clearNullCellRange(){(0,z.arrayEach)(this.hot.selection.highlight.customSelections,(t,e)=>{if(null===t.cellRange)return this.hot.selection.highlight.customSelections[e].destroy(),this.hot.selection.highlight.customSelections.splice(e,1),!1})}hideBorders(){(0,z.arrayEach)(this.savedBorders,t=>{this.clearBordersFromSelectionSettings(t.id),this.clearNullCellRange()})}spliceBorder(t){let e=(0,z.arrayMap)(this.savedBorders,t=>t.id).indexOf(t);e>-1&&this.savedBorders.splice(e,1)}checkSavedBorders(t){let e=!1;return 4===this.countHide(t)?(this.spliceBorder(t.id),e=!0):(0,z.arrayEach)(this.savedBorders,(i,r)=>{if(t.id===i.id)return this.savedBorders[r]=t,e=!0,!1}),e}checkCustomSelectionsFromContextMenu(t,e,i){let r=!1;return(0,z.arrayEach)(this.hot.selection.highlight.customSelections,n=>{if(t.id===n.settings.id){let t=this.hot.view._wt.selectionManager.getBorderInstances(n);return(0,z.arrayEach)(t,t=>{t.toggleHiddenClass(e,i)}),r=!0,!1}}),r}checkCustomSelections(t,e,i){let r=this.countHide(t),n=!1;return 4===r?(this.removeAllBorders(t.row,t.col),n=!0):(0,z.arrayEach)(this.hot.selection.highlight.customSelections,r=>{if(t.id===r.settings.id){if(r.visualCellRange=e,r.commit(),i){let e=this.hot.view._wt.selectionManager.getBorderInstances(r);(0,z.arrayEach)(e,e=>{e.changeBorderStyle(i,t)})}return n=!0,!1}}),n}changeBorderSettings(){let t=this.hot.getSettings()[sx];if(Array.isArray(t)){let e=(0,V.deepClone)(t);this.checkSettingsCohesion(e),e.length||(this.savedBorders=e),this.createCustomBorders(e)}else void 0!==t&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(t){let e=t.some(t=>(0,T.isDefined)(t.left)||(0,T.isDefined)(t.right)),i=t.some(t=>(0,T.isDefined)(t.start)||(0,T.isDefined)(t.end));if(e&&i)throw Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&e)throw Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function sO(t){if(this.hot.getSettings()[sx]){var e,i,r;t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_BORDERS)},disabled(){let t=this.getSelectedRangeLast();return!!(!t||t.isSingleHeader())||this.selection.isSelectedByCorner()},submenu:{items:[(e=this,{key:"borders:top",name(){let t=this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_BORDERS_TOP);return sS(this,"top")&&(t=sE(t)),t},callback(t,i){let r=sS(this,"top");e.prepareBorder(i,"top",r)}}),function(t){let e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let t=this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_BORDERS_RIGHT);return sS(this,e)&&(t=sE(t)),t},callback(i,r){let n=sS(this,e);t.prepareBorder(r,e,n)}}}(this),(i=this,{key:"borders:bottom",name(){let t=this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return sS(this,"bottom")&&(t=sE(t)),t},callback(t,e){let r=sS(this,"bottom");i.prepareBorder(e,"bottom",r)}}),function(t){let e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let t=this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_BORDERS_LEFT);return sS(this,e)&&(t=sE(t)),t},callback(i,r){let n=sS(this,e);t.prepareBorder(r,e,n)}}}(this),(r=this,{key:"borders:no_borders",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(t,e){r.prepareBorder(e,"noBorders")},disabled(){return!sS(this)}})]}})}}function sI(){this.changeBorderSettings()}function sA(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sN(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let sH="dragToScroll";var sP=new WeakSet;class s_ extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,sP),sA(this,"boundaries",null),sA(this,"callback",null),sA(this,"listening",!1)}static get PLUGIN_KEY(){return sH}static get PLUGIN_PRIORITY(){return 100}isEnabled(){return!!this.hot.getSettings()[sH]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",t=>sN(sP,this,sD).call(this,t)),this.addHook("afterOnCellCornerMouseDown",t=>sN(sP,this,sD).call(this,t)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=t}setCallback(t){this.callback=t}check(t,e){let i=0,r=0;e<this.boundaries.top?r=e-this.boundaries.top:e>this.boundaries.bottom&&(r=e-this.boundaries.bottom),t<this.boundaries.left?i=t-this.boundaries.left:t>this.boundaries.right&&(i=t-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){let{rootWindow:t}=this.hot,e=t;for(;e;)this.eventManager.addEventListener(e.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(e.document,"mousemove",t=>this.onMouseMove(t)),e=(0,y.getParentWindow)(e)}unregisterEvents(){this.eventManager.clear()}onMouseMove(t){this.isListening()&&this.check(t.clientX,t.clientY)}destroy(){super.destroy()}}function sD(t){if((0,F.isRightClick)(t))return;let e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((t,i)=>{var r,n;let o=null!==(r=e.scrollLeft)&&void 0!==r?r:e.scrollX,s=null!==(n=e.scrollTop)&&void 0!==n?n:e.scrollY;e.scroll(o+50*Math.sign(t),s+20*Math.sign(i))}),this.listen()}function sL(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function sF(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function sV(t,e,i){return t.set(sW(t,e),i),i}function sW(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("afterDropdownMenuDefaultOptions"),d.R.getSingleton().register("beforeDropdownMenuShow"),d.R.getSingleton().register("afterDropdownMenuShow"),d.R.getSingleton().register("afterDropdownMenuHide"),d.R.getSingleton().register("afterDropdownMenuExecute");let sB="dropdownMenu",sj="changeType";var sz=new WeakMap,sU=new WeakSet;class s$ extends eC{static get PLUGIN_KEY(){return sB}static get PLUGIN_PRIORITY(){return 230}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[nB,nj,ne,nY,ne,nW,ne,nz,ne,nV]}constructor(t){super(t),function(t,e){sL(t,e),e.add(t)}(this,sU),sF(this,"commandExecutor",new nF(this.hot)),sF(this,"itemsFactory",null),sF(this,"menu",null),function(t,e,i){sL(t,e),e.set(t,i)}(this,sz,!1),this.hot.addHook("afterGetColHeader",(t,e)=>sW(sU,this,sq).call(this,t,e))}isEnabled(){return this.hot.getSettings()[sB]}enablePlugin(){var t=this;if(this.enabled)return;this.itemsFactory=new n2(this.hot,s$.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return sW(sU,t,s0).call(t,...i)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return sW(sU,t,sZ).call(t,...i)});let e=this.hot.getSettings()[sB],i={items:this.itemsFactory.getItems(e)};this.registerEvents(),"function"==typeof e.callback&&this.commandExecutor.setCommonCallback(e.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);let r=this.itemsFactory.getItems(e);this.menu&&this.menu.destroy(),this.menu=new oC(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:e.uiContainer||this.hot.rootDocument.body}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>sW(sU,this,sX).call(this)),this.menu.addLocalHook("afterOpen",()=>sW(sU,this,sK).call(this)),this.menu.addLocalHook("afterSubmenuOpen",t=>sW(sU,this,sJ).call(this,t)),this.menu.addLocalHook("afterClose",()=>sW(sU,this,sQ).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return t.executeCommand.call(t,...i)}),(0,z.arrayEach)(r,t=>this.commandExecutor.registerCommand(t.key,t))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){let t=this.hot.getShortcutManager().getContext("grid"),e=()=>{let{highlight:t}=this.hot.getSelectedRangeLast();if((t.isHeader()&&-1===t.row||t.isCell())&&t.col>=0){this.hot.selectColumns(t.col,t.col,-1);let{from:e}=this.hot.getSelectedRangeLast(),i=ns(this.menu.container,this.hot.rootDocument),r=this.hot.getCell(-1,e.col,!0).querySelector(`.${sj}`),n=r.getBoundingClientRect();this.open({left:n.left+i.left,top:n.top+r.offsetHeight+i.top},{left:n.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};t.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:sB},{keys:[["Shift","Alt","ArrowDown"]],callback:e,runOnlyIf:()=>{var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e&&this.hot.selection.isCellVisible(e)&&e.isCell()&&!this.menu.isOpened()},group:sB}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(sB)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",t=>sW(sU,this,sG).call(this,t))}open(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{above:0,below:0,left:0,right:0};null!==(e=this.menu)&&void 0!==e&&e.isOpened()||(this.menu.open(),(0,V.objectEach)(i,(t,e)=>{this.menu.setOffset(e,t)}),this.menu.setPosition(t))}close(){var t;null===(t=this.menu)||void 0===t||t.close()}executeCommand(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];this.commandExecutor.execute(t,...i)}setListening(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.menu.isOpened()&&(t?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function sY(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function sG(t){if((0,y.hasClass)(t.target,sj)){let e=ns(this.menu.container,this.hot.rootDocument),i=t.target.getBoundingClientRect();t.stopPropagation(),sV(sz,this,!1),this.open({left:i.left+e.left,top:i.top+t.target.offsetHeight+e.top},{left:i.width,right:0,above:0,below:3})}}function sq(t,e){let i=e.parentNode;if(!i)return;let r=i.parentNode.childNodes,n=Array.prototype.indexOf.call(r,i);if(t<0||n!==r.length-1)return;let o=e.querySelector(`.${sj}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}let s=this.hot.rootDocument.createElement("button");s.className=sj,s.type="button",s.tabIndex=-1,this.hot.getSettings().ariaTags&&((0,y.setAttribute)(s,[(0,M.MG)(),(0,M.SM)(" ")]),(0,y.setAttribute)(e,[(0,M.wP)("menu")])),s.onclick=function(){return!1},e.firstChild.insertBefore(s,e.firstChild.firstChild)}function sX(){this.hot.runHooks("beforeDropdownMenuShow",this)}function sK(){this.hot.runHooks("afterDropdownMenuShow",this),sW(sU,this,sY).call(this,this.menu)}function sJ(t){sW(sU,this,sY).call(this,t)}function sQ(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function sZ(t){return sz.get(sW(sz,this))?null:t}function s0(t){(0,y.hasClass)(t.target,sj)&&sV(sz,this,!0)}function s1(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}s$.SEPARATOR={name:ne};class s2{constructor(t){s1(this,"hot",void 0),s1(this,"options",{}),this.hot=t}setOptions(t){this.options=t}getData(){let{startRow:t,startCol:e,endRow:i,endCol:r}=this._getDataRange(),n=this.options,o=[];return(0,b.rangeEach)(t,i,t=>{let i=[];!n.exportHiddenRows&&this._isHiddenRow(t)||((0,b.rangeEach)(e,r,e=>{!n.exportHiddenColumns&&this._isHiddenColumn(e)||i.push(this.hot.getDataAtCell(t,e))}),o.push(i))}),o}getRowHeaders(){let t=[];if(this.options.rowHeaders){let{startRow:e,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();(0,b.rangeEach)(e,i,e=>{!this.options.exportHiddenRows&&this._isHiddenRow(e)||t.push(r[e])})}return t}getColumnHeaders(){let t=[];if(this.options.columnHeaders){let{startCol:e,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();(0,b.rangeEach)(e,i,e=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(e)||t.push(r[e])})}return t}_getDataRange(){let t=this.hot.countCols()-1,e=this.hot.countRows()-1,[i=0,r=0,n=e,o=t]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),{startRow:i,startCol:r,endRow:n=Math.min(n,e),endCol:o=Math.min(o,t)}}_isHiddenRow(t){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(t))}_isHiddenColumn(t){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(t))}}function s3(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class s9{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(t,e){s3(this,"dataProvider",void 0),s3(this,"options",void 0),this.dataProvider=t,this.options=this._mergeOptions(e),this.dataProvider.setOptions(this.options)}_mergeOptions(t){let e=(0,V.clone)(this.constructor.DEFAULT_OPTIONS),i=new Date;return e=(0,V.extend)((0,V.clone)(s9.DEFAULT_OPTIONS),e),(e=(0,V.extend)(e,t)).filename=(0,U.substitute)(e.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),e}}let s4=s9;function s5(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var s8=new WeakSet;class s7 extends s4{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,s8)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:"\r\n",sanitizeValues:!1}}export(){let t=this.options,e=this.dataProvider.getData(),i=this.dataProvider.getColumnHeaders(),r=i.length>0,n=this.dataProvider.getRowHeaders(),o=n.length>0,s=t.bom?String.fromCharCode(65279):"";return r&&(i=(0,z.arrayMap)(i,e=>this._escapeCell(e,{force:!0,sanitizeValue:t.sanitizeValues})),o&&(s+=t.columnDelimiter),s+=i.join(t.columnDelimiter),s+=t.rowDelimiter),(0,z.arrayEach)(e,(e,i)=>{i>0&&(s+=t.rowDelimiter),o&&(s+=this._escapeCell(n[i],{sanitizeValue:t.sanitizeValues}),s+=t.columnDelimiter);let r=e.map(e=>this._escapeCell(e,{sanitizeValue:t.sanitizeValues})).join(t.columnDelimiter);s+=r}),s}_escapeCell(t){let{force:e=!1,sanitizeValue:i=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,T.stringify)(t);return""===r||(i&&(e=!0),i instanceof RegExp?r=s5(s8,this,lt).call(this,r,i):"function"==typeof i?r=i(r):i&&(r=s5(s8,this,s6).call(this,r)),(e||r.indexOf("\r")>=0||r.indexOf('"')>=0||r.indexOf("\n")>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function s6(t){return t.startsWith("=")||t.startsWith("+")||t.startsWith("-")||t.startsWith("@")||t.startsWith("	")||t.startsWith("\r")?`'${t}`:t}function lt(t,e){return e.test(t)?`'${t}`:t}let le={csv:s7};class li extends eC{static get PLUGIN_KEY(){return"exportFile"}static get PLUGIN_PRIORITY(){return 240}isEnabled(){return!0}exportAsString(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createTypeFormatter(t,e).export()}exportAsBlob(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._createBlob(this._createTypeFormatter(t,e))}downloadFile(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{rootDocument:i,rootWindow:r}=this.hot,n=this._createTypeFormatter(t,e),o=this._createBlob(n),s=r.URL||r.webkitURL,l=i.createElement("a"),a=`${n.options.filename}.${n.options.fileExtension}`;if(void 0!==l.download){let t=s.createObjectURL(o);l.style.display="none",l.setAttribute("href",t),l.setAttribute("download",a),i.body.appendChild(l),l.dispatchEvent(new MouseEvent("click")),i.body.removeChild(l),setTimeout(()=>{s.revokeObjectURL(t)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(o,a)}_createTypeFormatter(t){var e;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!le[t])throw Error(`Export format type "${t}" is not supported.`);return e=new s2(this.hot),"function"==typeof le[t]?new le[t](e,i):null}_createBlob(t){let e=null;return"undefined"!=typeof Blob&&(e=new Blob([t.export()],{type:`${t.options.mimeType};charset=${t.options.encoding}`})),e}}function lr(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(87426);class ln{constructor(t,e){let{id:i,stateless:r=!0}=e;lr(this,"hot",void 0),lr(this,"id",void 0),lr(this,"elements",[]),lr(this,"hidden",!1),lr(this,"stateId",""),lr(this,"state",void 0),this.hot=t,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new iZ.z)}getElements(){return this.elements}reset(){(0,z.arrayEach)(this.elements,t=>t.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return null===this.hot||this.hidden}restoreState(t){this.state&&this.setState(this.state.getValueAtIndex(t))}setState(){throw Error("The state setting logic is not implemented")}saveState(t){this.state&&this.state.setValueAtIndex(t,this.getState())}getState(){throw Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),(0,z.arrayEach)(this.elements,t=>t.destroy()),this.state=null,this.elements=null,this.hot=null}}(0,V.mixin)(ln,rV.A);let lo={};function ls(t,e){if(!lo[t])throw Error(`Filter condition "${t}" does not exist.`);let{condition:i,descriptor:r}=lo[t],n=e;return r.inputValuesDecorator&&(n=r.inputValuesDecorator(n)),function(t){return i.apply(t.meta.instance,[].concat([t],[n]))}}function ll(t){if(!lo[t])throw Error(`Filter condition "${t}" does not exist.`);return lo[t].descriptor}function la(t,e,i){i.key=t,lo[t]={condition:e,descriptor:i}}let lh="none";la(lh,function(){return!0},{name:tq.FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});let lu="empty";la(lu,function(t){return(0,T.isEmpty)(t.value)},{name:tq.FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});let lc="not_empty";la(lc,function(t,e){return!ls(lu,e)(t)},{name:tq.FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0}),la("eq",function(t,e){let[i]=e;return(0,T.stringify)(t.value).toLocaleLowerCase(t.meta.locale)===(0,T.stringify)(i)},{name:tq.FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0}),la("neq",function(t,e){return!ls("eq",e)(t)},{name:tq.FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0}),la("gt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>r},{name:tq.FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0}),la("gte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value>=r},{name:tq.FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0}),la("lt",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<r},{name:tq.FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0}),la("lte",function(t,e){let[i]=e,r=i;return"numeric"===t.meta.type&&(r=parseFloat(r,10)),t.value<=r},{name:tq.FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});let ld="date_after";la(ld,function(t,e){let[i]=e,r=tn(t.value,t.meta.dateFormat),n=tn(i,t.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&r.diff(n)>=0},{name:tq.FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});let lg="date_before";la(lg,function(t,e){let[i]=e,r=tn(t.value,t.meta.dateFormat),n=tn(i,t.meta.dateFormat);return!!(r.isValid()&&n.isValid())&&0>=r.diff(n)},{name:tq.FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});let lf="between";la(lf,function(t,e){let[i,r]=e,n=i,o=r;if("numeric"===t.meta.type){let t=parseFloat(n,10),e=parseFloat(o,10);n=Math.min(t,e),o=Math.max(t,e)}else if("date"===t.meta.type){let e=ls(lg,[o]),i=ls(ld,[n]);return e(t)&&i(t)}return t.value>=n&&t.value<=o},{name:tq.FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});let lp="not_between";la(lp,function(t,e){return!ls(lf,e)(t)},{name:tq.FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});let lm="begins_with";la(lm,function(t,e){let[i]=e;return(0,T.stringify)(t.value).toLocaleLowerCase(t.meta.locale).startsWith((0,T.stringify)(i))},{name:tq.FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});let lw="ends_with";la(lw,function(t,e){let[i]=e;return(0,T.stringify)(t.value).toLocaleLowerCase(t.meta.locale).endsWith((0,T.stringify)(i))},{name:tq.FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});let lv="contains";la(lv,function(t,e){let[i]=e;return(0,T.stringify)(t.value).toLocaleLowerCase(t.meta.locale).indexOf((0,T.stringify)(i))>=0},{name:tq.FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});let ly="not_contains";la(ly,function(t,e){return!ls(lv,e)(t)},{name:tq.FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});let lb="date_tomorrow";la(lb,function(t){let e=tn(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(tn().subtract(-1,"days").startOf("day"),"d")},{name:tq.FILTERS_CONDITIONS_TOMORROW,inputsCount:0});let lC="date_today";la(lC,function(t){let e=tn(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(tn().startOf("day"),"d")},{name:tq.FILTERS_CONDITIONS_TODAY,inputsCount:0});let lS="date_yesterday";la(lS,function(t){let e=tn(t.value,t.meta.dateFormat);return!!e.isValid()&&e.isSame(tn().subtract(1,"days").startOf("day"),"d")},{name:tq.FILTERS_CONDITIONS_YESTERDAY,inputsCount:0});let lE="text",lR={numeric:[lh,ne,lu,lc,ne,"eq","neq",ne,"gt","gte","lt","lte",lf,lp],[lE]:[lh,ne,lu,lc,ne,"eq","neq",ne,lm,lw,ne,lv,ly],date:[lh,ne,lu,lc,ne,"eq","neq",ne,lg,ld,lf,ne,lb,lC,lS]};function lT(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let lx="built",lM="building",lk=["click","input","keydown","keypress","keyup","focus","blur","change"];class lO{static get DEFAULTS(){return(0,V.clone)({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(t,e){lT(this,"hot",void 0),lT(this,"eventManager",new m.A(this)),lT(this,"options",void 0),lT(this,"_element",void 0),lT(this,"buildState",void 0),this.hot=t,this.options=(0,V.extend)(lO.DEFAULTS,e),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(t){this.options.value=t,this.update()}getValue(){return this.options.value}get element(){return this.buildState===lM||(this.buildState===lx?this.update():(this.buildState=lM,this.build(),this.buildState=lx)),this._element}isBuilt(){return this.buildState===lx}translateIfPossible(t){return"string"==typeof t&&t.startsWith(tq.FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(t):t}build(){let t=(t,e)=>{this.eventManager.addEventListener(t,e,t=>this.runLocalHooks(e,t,this))};if(this.buildState||(this.buildState=lM),this._element.setAttribute("data-hot-input",!0),void 0!==this.options.tabIndex&&this._element.setAttribute("tabindex",this.options.tabIndex),void 0!==this.options.role&&this._element.setAttribute("role",this.options.role),this.options.className&&(0,y.addClass)(this._element,this.options.className),this.options.children.length)(0,z.arrayEach)(this.options.children,t=>this._element.appendChild(t.element));else if(this.options.wrapIt){let e=this.hot.rootDocument.createElement(this.options.tagName);e.setAttribute("data-hot-input",!0),(0,V.objectEach)(this.options,(t,i)=>{void 0!==e[i]&&"className"!==i&&"tagName"!==i&&"children"!==i&&(e[i]=this.translateIfPossible(t))}),this._element.appendChild(e),(0,z.arrayEach)(lk,i=>t(e,i))}else(0,z.arrayEach)(lk,e=>t(this._element,e))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}}function lI(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function lA(t,e){return t.get(lN(t,e))}function lN(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(0,V.mixin)(lO,rV.A);var lH=new WeakMap,lP=new WeakSet;class l_ extends lO{static get DEFAULTS(){return(0,V.clone)({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(t,e){super(t,(0,V.extend)(l_.DEFAULTS,e)),function(t,e){lI(t,e),e.add(t)}(this,lP),function(t,e,i){lI(t,e),e.set(t,i)}(this,lH,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",t=>lN(lP,this,lD).call(this,t))}build(){var t;super.build();let e=this.hot.rootDocument.createElement("div");t=this._element.firstChild,lH.set(lN(lH,this),t),(0,y.addClass)(this._element,"htUIInput"),(0,y.addClass)(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(lA(lH,this).type=this.options.type,lA(lH,this).placeholder=this.translateIfPossible(this.options.placeholder),lA(lH,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&lA(lH,this).focus()}}function lD(t){this.options.value=t.target.value}function lL(t,e,i){lF(t,e),e.set(t,i)}function lF(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function lV(t,e,i){return t.set(lB(t,e),i),i}function lW(t,e){return t.get(lB(t,e))}function lB(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var lj=new WeakMap,lz=new WeakMap,lU=new WeakMap,l$=new WeakMap,lY=new WeakMap,lG=new WeakSet;class lq extends lO{static get DEFAULTS(){return(0,V.clone)({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(t,e){super(t,(0,V.extend)(lq.DEFAULTS,e)),function(t,e){lF(t,e),e.add(t)}(this,lG),lL(this,lj,null),lL(this,lz,[]),lL(this,lU,void 0),lL(this,l$,void 0),lL(this,lY,void 0),this.registerHooks()}getMenu(){return lW(lj,this)}registerHooks(){this.addLocalHook("click",()=>lB(lG,this,lJ).call(this))}setItems(t){lV(lz,this,this.translateNames(t)),lW(lj,this)&&lW(lj,this).setMenuItems(lW(lz,this))}translateNames(t){return(0,z.arrayEach)(t,t=>{t.name=this.translateIfPossible(t.name)}),t}build(){super.build(),lV(lj,this,new oC(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),lW(lj,this).setMenuItems(lW(lz,this));let t=new lO(this.hot,{className:"htUISelectCaption"}),e=new lO(this.hot,{className:"htUISelectDropdown"});lV(lU,this,t),lV(l$,this,t.element),lV(lY,this,e),this.hot.getSettings().ariaTags&&((0,y.setAttribute)(e.element,[(0,M.MG)()]),(0,y.setAttribute)(this._element,[(0,M.$o)()])),(0,z.arrayEach)([t,e],t=>this._element.appendChild(t.element)),lW(lj,this).addLocalHook("select",t=>lB(lG,this,lX).call(this,t)),lW(lj,this).addLocalHook("afterClose",()=>lB(lG,this,lK).call(this)),this.update()}update(){let t;this.isBuilt()&&(t=this.options.value?this.options.value.name:lW(lj,this).hot.getTranslatedPhrase(tq.FILTERS_CONDITIONS_NONE),lW(l$,this).textContent=t,super.update())}openOptions(){let t=this.element.getBoundingClientRect();lW(lj,this)&&(lW(lj,this).open(),lW(lj,this).setPosition({left:this.hot.isLtr()?t.left-5:t.left-31,top:t.top-1,width:t.width,height:t.height}),lW(lj,this).getNavigator().toFirstItem(),lW(lj,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{this.closeOptions(),this.runLocalHooks("tabKeydown",t)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){lW(lj,this)&&lW(lj,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){lW(lj,this)&&(lW(lj,this).destroy(),lV(lj,this,null)),lW(lU,this)&&lW(lU,this).destroy(),lW(lY,this)&&lW(lY,this).destroy(),super.destroy()}}function lX(t){t.name!==ne&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function lK(){this.runLocalHooks("afterClose")}function lJ(){this.openOptions()}function lQ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function lZ(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var l0=new WeakSet;class l1 extends ln{constructor(t,e){super(t,{id:e.id,stateless:!1}),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,l0),lQ(this,"name",""),lQ(this,"addSeparator",!1),this.name=e.name,this.addSeparator=e.addSeparator,this.elements.push(new lq(this.hot,{menuContainer:e.menuContainer})),this.elements.push(new l_(this.hot,{placeholder:tq.FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new l_(this.hot,{placeholder:tq.FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",t=>lZ(l0,this,l2).call(this,t)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",t=>this.runLocalHooks("selectTabKeydown",t)),(0,z.arrayEach)(this.getInputElements(),t=>{t.addLocalHook("keydown",t=>lZ(l0,this,l3).call(this,t))})}setState(t){if(this.reset(),!t)return;let e=(0,V.clone)(t.command);e.name.startsWith(tq.FILTERS_CONDITIONS_NAMESPACE)&&(e.name=this.hot.getTranslatedPhrase(e.name)),this.getSelectElement().setValue(e),(0,z.arrayEach)(t.args,(t,i)=>{if(i>e.inputsCount-1)return!1;let r=this.getInputElement(i);r.setValue(t),r[e.inputsCount>i?"show":"hide"](),i||this.hot._registerTimeout(()=>r.focus(),10)})}getState(){let t=this.getSelectElement().getValue()||ll(lh),e=[];return(0,z.arrayEach)(this.getInputElements(),(i,r)=>{t.inputsCount>r&&e.push(i.getValue())}),{command:t,args:e}}updateState(t,e){let i=t?ll(t.name):ll(lh);this.state.setValueAtIndex(e,{command:i,args:t?t.args:[]}),t||(0,z.arrayEach)(this.getInputElements(),t=>t.setValue(null))}getSelectElement(){return this.elements.filter(t=>t instanceof lq)[0]}getInputElement(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.getInputElements()[t]}getInputElements(){return this.elements.filter(t=>t instanceof l_)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,n,o)=>{(0,y.addClass)(e.parentNode,"htFiltersMenuCondition"),this.addSeparator&&(0,y.addClass)(e.parentNode,"border");let s=this.hot.rootDocument.createElement("div");return(0,y.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,e.appendChild(s),e.parentElement.hasAttribute("ghost-table")||(0,z.arrayEach)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getPlugin("filters").getSelectedColumn(),e=[ll(lh)];if(null!==t){let{visualIndex:i}=t;e=function(t){let e=[],i=t;return lR[i]||(i=lE),(0,z.arrayEach)(lR[i],t=>{let i;i=t===ne?{name:ne}:(0,V.clone)(ll(t)),e.push(i)}),e}(this.hot.getDataType(0,i,this.hot.countRows(),i))}(0,z.arrayEach)(this.getInputElements(),t=>t.hide()),this.getSelectElement().setItems(e),super.reset(),this.getSelectElement().setValue(e[0])}}function l2(t){(0,z.arrayEach)(this.getInputElements(),(e,i)=>{e[t.inputsCount>i?"show":"hide"](),0===i&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function l3(t){(0,$.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,F.stopImmediatePropagation)(t))}let l9={};function l4(t,e,i){l9[t]={name:e,func:i}}let l5="conjunction";l4(l5,tq.FILTERS_LABELS_CONJUNCTION,function(t,e){return t.every(t=>t.func(e))});let l8="disjunction";l4(l8,tq.FILTERS_LABELS_DISJUNCTION,function(t,e){return t.some(t=>t.func(e))});let l7="disjunctionWithExtraCondition";function l6(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function at(t,e){return t.get(ai(t,e))}function ae(t,e,i){return t.set(ai(t,e),i),i}function ai(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}l4(l7,tq.FILTERS_LABELS_DISJUNCTION,function(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(t=>t.func(e))&&t[t.length-1].func(e)});var ar=new WeakMap,an=new WeakMap;class ao extends lO{static get DEFAULTS(){return(0,V.clone)({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(t,e){super(t,(0,V.extend)(ao.DEFAULTS,e)),l6(this,ar,void 0),l6(this,an,void 0)}build(){super.build();let t=this.hot.rootDocument.createElement("label");t.textContent=this.translateIfPossible(this.options.label.textContent),t.htmlFor=this.translateIfPossible(this.options.label.htmlFor),ae(an,this,t),ae(ar,this,this._element.firstChild),at(ar,this).checked=this.options.checked,this._element.appendChild(t),this.update()}update(){this.isBuilt()&&(at(an,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return!!this.isBuilt()&&at(ar,this).checked}setChecked(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];this.isBuilt()&&(at(ar,this).checked=t)}focus(){this.isBuilt()&&at(ar,this).focus()}}var as=new WeakSet;class al extends ln{constructor(t,e){super(t,{id:e.id,stateless:!1}),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,as),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:"",enumerable:!0,configurable:!0,writable:!0}):t[e]=""}(this,"name",""),this.name=e.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,y.addClass)(e.parentNode,"htFiltersMenuOperators"),(0,z.arrayEach)(this.elements,t=>e.appendChild(t.element)),e)}}buildOperatorsElement(){let t=[l5,l8];(0,z.arrayEach)(t,e=>{let i=new ao(this.hot,{name:"operator",label:{htmlFor:e,textContent:l9[e].name},value:e,checked:e===t[0],id:e});i.addLocalHook("change",t=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(as,this,aa).call(this,t)),this.elements.push(i)})}setChecked(t){if(this.elements.length<t)throw Error((0,ro.O)`Radio button with index ${t} doesn't exist.`);(0,z.arrayEach)(this.elements,(e,i)=>{e.setChecked(i===t)})}getActiveOperationId(){let t=this.elements.find(t=>t instanceof ao&&t.isChecked());return t?t.getValue():l5}getState(){return this.getActiveOperationId()}setState(t){this.reset(),t&&this.getActiveOperationId()!==t&&(0,z.arrayEach)(this.elements,e=>{e.setChecked(e.getValue()===t)})}updateState(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l5,e=arguments.length>1?arguments[1]:void 0,i=t;i===l7&&(i=l8),this.state.setValueAtIndex(e,i)}reset(){this.setChecked(0)}}function aa(t){this.setState(t.target.value)}function ah(t){let e=new Set(t);return function(t){return e.has(t)}}function au(t){return null==t?"":t}function ac(t){return Array.from(new Set(t)).map(t=>au(t)).sort((t,e)=>"number"==typeof t&&"number"==typeof e?t-e:t===e?0:t>e?1:-1)}function ad(t,e,i,r){let n,o=[],s=t===e;return s||(n=ah(e)),t.forEach(t=>{let e,l=!1;(s||n(t))&&(l=!0);let a={checked:l,value:t,visualValue:(""===(e=t)&&(e=`(${i})`),e)};r&&r(a),o.push(a)}),o}(0,eE.getComparisonFunction)();var ag=i(15616);function af(t,e){return t.get(ap(t,e))}function ap(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var am=new WeakMap;class aw extends lO{static get DEFAULTS(){return(0,V.clone)({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(t,e){super(t,(0,V.extend)(aw.DEFAULTS,e)),function(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}(this,am,void 0)}build(){var t;super.build(),t=this._element.firstChild,am.set(ap(am,this),t)}update(){this.isBuilt()&&(af(am,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&af(am,this).focus()}activate(){af(am,this).click()}}function av(t,e,i){ay(t,e),e.set(t,i)}function ay(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function ab(t,e){return t.get(aS(t,e))}function aC(t,e,i){return t.set(aS(t,e),i),i}function aS(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let aE="multipleSelect.itemBox";var aR=new WeakMap,aT=new WeakMap,ax=new WeakMap,aM=new WeakMap,ak=new WeakMap,aO=new WeakMap,aI=new WeakSet;class aA extends lO{static get DEFAULTS(){return(0,V.clone)({className:"htUIMultipleSelect",value:[]})}constructor(t,e){super(t,(0,V.extend)(aA.DEFAULTS,e)),function(t,e){ay(t,e),e.add(t)}(this,aI),av(this,aR,[]),av(this,aT,void 0),av(this,ax,void 0),av(this,aM,void 0),av(this,ak,void 0),av(this,aO,void 0),aC(aM,this,new l_(this.hot,{placeholder:tq.FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),aC(ak,this,new aw(this.hot,{textContent:tq.FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),aC(aO,this,new aw(this.hot,{textContent:tq.FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return ab(aT,this)}registerHooks(){ab(aM,this).addLocalHook("keydown",t=>aS(aI,this,aH).call(this,t)),ab(aM,this).addLocalHook("input",t=>aS(aI,this,aN).call(this,t)),ab(ak,this).addLocalHook("click",t=>aS(aI,this,aP).call(this,t)),ab(aO,this).addLocalHook("click",t=>aS(aI,this,a_).call(this,t))}setItems(t){var e;aC(aR,this,t),null===(e=ab(aT,this))||void 0===e||e.loadData(ab(aR,this))}setLocale(t){aC(ax,this,t)}getLocale(){return ab(ax,this)}getItems(){return[...ab(aR,this)]}getValue(){var t=ab(aR,this);let e=[];return t.forEach(t=>{t.checked&&e.push(t.value)}),e}getSearchInputElement(){return ab(aM,this)}getSelectAllElement(){return ab(ak,this)}getClearAllElement(){return ab(aO,this)}isSelectedAllValues(){return ab(aR,this).length===this.getValue().length}build(){super.build();let{rootDocument:t}=this.hot,e=t.createElement("div"),i=new lO(this.hot,{className:"htUISelectionControls",children:[ab(ak,this),ab(aO,this)]});this._element.appendChild(ab(aM,this).element),this._element.appendChild(i.element),this._element.appendChild(e);let r=e=>{var i;if(!this._element)return;null===(i=ab(aT,this))||void 0===i||i.destroy(),(0,y.addClass)(e,"htUIMultipleSelectHot"),aC(aT,this,new this.hot.constructor(e,{data:ab(aR,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(t,e,i,r,n,o)=>{t.title=o.instance.getDataAtRowProp(e,o.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{ab(aT,this).listen()},modifyColWidth:e=>{let i=ab(aT,this).container.scrollWidth-(0,y.getScrollbarWidth)(t);return void 0!==e&&e<i?i:e},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),ab(aT,this).init(),this.hot.addHook("afterSetTheme",(t,e)=>{e||ab(aT,this).useTheme(t)});let r=ab(aT,this).getShortcutManager().getContext("grid");r.removeShortcutsByKeys(["Tab"]),r.removeShortcutsByKeys(["Shift","Tab"]),r.addShortcut({keys:[["Escape"]],callback:t=>{this.runLocalHooks("keydown",t,this)},group:aE}),r.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:t=>{ab(aT,this).deselectCell(),this.runLocalHooks("keydown",t,this),this.runLocalHooks("listTabKeydown",t,this)},group:aE})};r(e),this.hot._registerTimeout(()=>r(e),100)}focus(){this.isBuilt()&&ab(aT,this).listen()}reset(){ab(aM,this).reset(),ab(ak,this).reset(),ab(aO,this).reset()}update(){this.isBuilt()&&(ab(aT,this).loadData(function(t,e){let i=ah(e);return t.map(t=>(t.checked=i(t.value),t))}(ab(aR,this),this.options.value)),super.update())}destroy(){var t;null===(t=ab(aT,this))||void 0===t||t.destroy(),ab(aM,this).destroy(),ab(aO,this).destroy(),ab(ak,this).destroy(),aC(aM,this,null),aC(aO,this,null),aC(ak,this,null),aC(aT,this,null),aC(aR,this,null),super.destroy()}}function aN(t){let e,i=t.target.value.toLocaleLowerCase(this.getLocale());e=""===i?[...ab(aR,this)]:ab(aR,this).filter(t=>`${t.value}`.toLocaleLowerCase(this.getLocale()).indexOf(i)>=0),ab(aT,this).loadData(e)}function aH(t){this.runLocalHooks("keydown",t,this),(0,Y.partial)($.isKey,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),(0,F.stopImmediatePropagation)(t),ab(aT,this).listen(),ab(aT,this).selectCell(0,0))}function aP(t){let e=[];t.preventDefault(),ab(aT,this).getSourceData().forEach((t,i)=>{t.checked=!0,e.push((0,ag.dataRowToChangesArray)(t,i)[0])}),ab(aT,this).setSourceDataAtCell(e)}function a_(t){let e=[];t.preventDefault(),ab(aT,this).getSourceData().forEach((t,i)=>{t.checked=!1,e.push((0,ag.dataRowToChangesArray)(t,i)[0])}),ab(aT,this).setSourceDataAtCell(e)}let aD="by_value";function aL(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}la(aD,function(t,e){let[i]=e;return i(t.value)},{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[ah(e)]},showOperators:!1});var aF=new WeakSet;class aV extends ln{constructor(t,e){super(t,{id:e.id,stateless:!1}),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,aF),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:"",enumerable:!0,configurable:!0,writable:!0}):t[e]=""}(this,"name",""),this.name=e.name,this.elements.push(new aA(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",t=>aL(aF,this,aW).call(this,t)).addLocalHook("listTabKeydown",t=>this.runLocalHooks("listTabKeydown",t)),this.hot.addHook("modifyFiltersMultiSelectValue",(t,e)=>aL(aF,this,aj).call(this,t,e))}getElements(){let t=this.getMultipleSelectElement();return[t.getSearchInputElement(),t.getSelectAllElement(),t.getClearAllElement(),this.getMultipleSelectElement()]}setState(t){if(this.reset(),t&&t.command.key===aD){let e=this.getMultipleSelectElement();e.setItems(t.itemsSnapshot),e.setValue(t.args[0]),e.setLocale(t.locale)}}getState(){let t=this.getMultipleSelectElement(),e=t.getItems();return{command:{key:t.isSelectedAllValues()||!e.length?lh:aD},args:[t.getValue()],itemsSnapshot:e}}updateState(t){let e=(e,i,r,n,o)=>{let[s]=(0,z.arrayFilter)(i,t=>t.name===aD),l={},a=this.hot.getTranslatedPhrase(tq.FILTERS_VALUES_BLANK_CELLS);if(s){let i=n(e,o),h=(0,z.arrayMap)(i,t=>t.value),u=new Map(i.map(t=>[t.value,this.hot.getCellMeta(t.meta.visualRow,t.meta.visualCol)])),c=ac(h);r&&(s.args[0]=r);let d=[],g=ad(c,s.args[0],a,t=>{t.checked&&d.push(t.value),aL(aF,this,aB).call(this,t,u)}),f=t.editedConditionStack.column;l.locale=this.hot.getCellMeta(0,f).locale,l.args=[d],l.command=ll(aD),l.itemsSnapshot=g}else l.args=[],l.command=ll(lh);this.state.setValueAtIndex(e,l)};e(t.editedConditionStack.column,t.editedConditionStack.conditions,t.conditionArgsChange,t.filteredRowsFactory),t.dependentConditionStacks.length&&e(t.dependentConditionStacks[0].column,t.dependentConditionStacks[0].conditions,t.conditionArgsChange,t.filteredRowsFactory,t.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(t=>t instanceof aA)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e,i,r,n,o)=>{(0,y.addClass)(e.parentNode,"htFiltersMenuValue");let s=this.hot.rootDocument.createElement("div");return(0,y.addClass)(s,"htFiltersMenuLabel"),s.textContent=o,e.appendChild(s),e.parentElement.hasAttribute("ghost-table")||(0,z.arrayEach)(this.elements,t=>e.appendChild(t.element)),e}}}reset(){let t=this.hot.getTranslatedPhrase(tq.FILTERS_VALUES_BLANK_CELLS),e=this._getColumnVisibleValues(),i=e.map(t=>t.value),r=new Map(e.map(t=>[t.value,t.meta])),n=ac(i),o=ad(n,n,t,t=>{aL(aF,this,aB).call(this,t,r)});this.getMultipleSelectElement().setItems(o),super.reset(),this.getMultipleSelectElement().setValue(n);let s=this.hot.getPlugin("filters").getSelectedColumn();null!==s&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,s.visualIndex).locale)}_getColumnVisibleValues(){let t=this.hot.getPlugin("filters").getSelectedColumn();return null===t?[]:(0,z.arrayMap)(this.hot.getDataAtCol(t.visualIndex),(e,i)=>({value:au(e),meta:this.hot.getCellMeta(i,t.visualIndex)}))}}function aW(t){(0,$.isKey)(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),(0,F.stopImmediatePropagation)(t))}function aB(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function aj(t,e){return"numeric"===e.type?t9(t,e):t}var az=new WeakSet;class aU extends ln{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(t,e){super(t,{id:e.id,stateless:!0}),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,az),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:"",enumerable:!0,configurable:!0,writable:!0}):t[e]=""}(this,"name",""),this.name=e.name,this.elements.push(new l_(this.hot,{type:"button",value:tq.FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:aU.BUTTON_OK})),this.elements.push(new l_(this.hot,{type:"button",value:tq.FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:aU.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){(0,z.arrayEach)(this.elements,t=>{t.addLocalHook("click",(t,e)=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(az,this,a$).call(this,t,e))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(t,e)=>((0,y.addClass)(e.parentNode,"htFiltersMenuActionBar"),(0,z.arrayEach)(this.elements,t=>e.appendChild(t.element)),e)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}function a$(t,e){e.options.identifier===aU.BUTTON_OK?this.accept():this.cancel()}function aY(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let aG="ConditionCollection.filteringStates";class aq{constructor(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];aY(this,"hot",void 0),aY(this,"isMapRegistrable",void 0),aY(this,"filteringStates",new iZ.z),this.hot=t,this.isMapRegistrable=e,!0===this.isMapRegistrable?this.hot.columnIndexMapper.registerMap(aG,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return 0===this.getFilteredColumns().length}isMatch(t,e){var i;let r=this.filteringStates.getValueAtIndex(e),n=null!==(i=null==r?void 0:r.conditions)&&void 0!==i?i:[],o=null==r?void 0:r.operation;return this.isMatchInConditions(n,t,o)}isMatchInConditions(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l5;return!t.length||(function(t){if(!l9[t])throw Error(`Operation with id "${t}" does not exist.`);let e=l9[t].func;return function(t,i){return e(t,i)}})(i)(t,e)}addCondition(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:l5,r=arguments.length>3?arguments[3]:void 0,n=this.hot.getCellMeta(0,t).locale,o=e.args.map(t=>"string"==typeof t?t.toLocaleLowerCase(n):t),s=e.name||e.command.key;this.runLocalHooks("beforeAdd",t);let l=this.getOperation(t);if(l){if(l!==i)throw Error((0,ro.O)`The column of index ${t} has been already applied with a \`${l}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if((0,T.isUndefined)(l9[i]))throw Error((0,ro.O)`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);let a=this.getConditions(t);0===a.length?this.filteringStates.setValueAtIndex(t,{operation:i,conditions:[{name:s,args:o,func:ls(s,o)}]},r):a.push({name:s,args:o,func:ls(s,o)}),this.runLocalHooks("afterAdd",t)}getConditions(t){var e,i;return null!==(e=null===(i=this.filteringStates.getValueAtIndex(t))||void 0===i?void 0:i.conditions)&&void 0!==e?e:[]}getOperation(t){var e;return null===(e=this.filteringStates.getValueAtIndex(t))||void 0===e?void 0:e.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(t=>{let[e]=t;return e})}getColumnStackPosition(t){return this.getFilteredColumns().indexOf(t)}exportAllConditions(){return this.filteringStates.getEntries().reduce((t,e)=>{let[i,{operation:r,conditions:n}]=e;return t.push({column:i,operation:r,conditions:n.map(t=>{let{name:e,args:i}=t;return{name:e,args:[...i]}})}),t},[])}importAllConditions(t){this.clean(),t.forEach(t=>{t.conditions.forEach(e=>this.addCondition(t.column,e))})}removeConditions(t){this.runLocalHooks("beforeRemove",t),this.filteringStates.clearValue(t),this.runLocalHooks("afterRemove",t)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(t,e){let i=this.getConditions(t);return e?i.some(t=>t.name===e):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(aG),this.filteringStates=null,this.clearLocalHooks()}}function aX(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}(0,V.mixin)(aq,rV.A);class aK{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:()=>[];aX(this,"conditionCollection",void 0),aX(this,"columnDataFactory",void 0),this.conditionCollection=t,this.columnDataFactory=e}filter(){let t=[];return(0,z.arrayEach)(this.conditionCollection.getFilteredColumns(),(e,i)=>{let r=this.columnDataFactory(e);i&&(r=this._getIntersectData(r,t)),t=this.filterByColumn(e,r)}),t}filterByColumn(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=[];return(0,z.arrayEach)(e,e=>{void 0!==e&&this.conditionCollection.isMatch(e,t)&&i.push(e)}),i}_getIntersectData(t,e){let i=[];return(0,z.arrayEach)(e,e=>{let r=e.meta.visualRow;void 0!==t[r]&&(i[r]=t[r])}),i}}function aJ(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function aQ(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var aZ=new WeakSet;class a0{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>[];!function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,aZ),aJ(this,"hot",void 0),aJ(this,"conditionCollection",void 0),aJ(this,"columnDataFactory",void 0),aJ(this,"changes",[]),aJ(this,"grouping",!1),aJ(this,"latestEditedColumnPosition",-1),aJ(this,"latestOrderStack",[]),this.hot=t,this.conditionCollection=e,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",t=>aQ(aZ,this,a1).call(this,t)),this.conditionCollection.addLocalHook("afterRemove",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("afterAdd",t=>this.updateStatesAtColumn(t)),this.conditionCollection.addLocalHook("beforeClean",()=>aQ(aZ,this,a2).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>aQ(aZ,this,a3).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,(0,z.arrayEach)(this.changes,t=>{this.updateStatesAtColumn(t)}),this.changes.length=0}updateStatesAtColumn(t,e){var i=this;if(this.grouping){-1===this.changes.indexOf(t)&&this.changes.push(t);return}let r=this.conditionCollection.exportAllConditions(),n=this.conditionCollection.getColumnStackPosition(t);-1===n&&(n=this.latestEditedColumnPosition);let o=r.slice(0,n),s=r.slice(n);s.length&&s[0].column===t&&s.shift();let l=(0,Y.curry)(function(t,e){let r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],o=new aq(i.hot,!1),s=[].concat(t,n);o.importAllConditions(s);let l=i.columnDataFactory(e);r=o.isEmpty()?l:new aK(o,t=>i.columnDataFactory(t)).filter();let a=ah(r=(0,z.arrayMap)(r,t=>t.meta.visualRow));return o.destroy(),(0,z.arrayFilter)(l,t=>a(t.meta.visualRow))})(o),a=[].concat(this.conditionCollection.getConditions(t));this.runLocalHooks("update",{editedConditionStack:{column:t,conditions:a},dependentConditionStacks:s,filteredRowsFactory:l,conditionArgsChange:e})}destroy(){this.clearLocalHooks(),(0,V.objectEach)(this,(t,e)=>{this[e]=null})}}function a1(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function a2(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function a3(){(0,z.arrayEach)(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}(0,V.mixin)(a0,rV.A);let a9="filters";var a4=i(10932);function a5(t,e,i){a8(t,e),e.set(t,i)}function a8(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function a7(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a6(t,e,i){return t.set(he(t,e),i),i}function ht(t,e){return t.get(he(t,e))}function he(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let hi="filters";var hr=new WeakMap,hn=new WeakMap,ho=new WeakMap,hs=new WeakSet;class hl extends eC{static get PLUGIN_KEY(){return hi}static get PLUGIN_PRIORITY(){return 250}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(t){var e;super(t),e=this,function(t,e){a8(t,e),e.add(t)}(this,hs),a7(this,"dropdownMenuPlugin",null),a7(this,"conditionCollection",null),a7(this,"conditionUpdateObserver",null),a7(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),a7(this,"filtersRowsMap",null),a5(this,hr,void 0),a5(this,hn,new WeakSet),a5(this,ho,[]),this.hot.addHook("afterGetColHeader",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return he(hs,e,hm).call(e,...i)})}isEnabled(){return!!this.hot.getSettings()[hi]}enablePlugin(){var t=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new a4.q),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");let e=this.hot.getSettings().dropdownMenu,i=e&&e.uiContainer||this.hot.rootDocument.body,r=t=>(t.addLocalHook("accept",()=>he(hs,this,hg).call(this,"accept")),t.addLocalHook("cancel",()=>he(hs,this,hg).call(this,"cancel")),t.addLocalHook("change",e=>he(hs,this,hf).call(this,t,e)),t);if(!this.components.get("filter_by_condition")){let t=new l1(this.hot,{id:"filter_by_condition",name:()=>`${this.hot.getTranslatedPhrase(tq.FILTERS_DIVS_FILTER_BY_CONDITION)}:`,addSeparator:!1,menuContainer:i});t.addLocalHook("afterClose",()=>he(hs,this,hp).call(this)),this.components.set("filter_by_condition",r(t))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new al(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){let t=new l1(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});t.addLocalHook("afterClose",()=>he(hs,this,hp).call(this)),this.components.set("filter_by_condition2",r(t))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new aV(this.hot,{id:"filter_by_value",name:()=>`${this.hot.getTranslatedPhrase(tq.FILTERS_DIVS_FILTER_BY_VALUE)}:`}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new aU(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new aq(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new a0(this.hot,this.conditionCollection,t=>this.getDataMapAtColumn(t)),this.conditionUpdateObserver.addLocalHook("update",t=>he(hs,this,hw).call(this,t))),this.components.forEach(t=>t.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return he(hs,t,hd).call(t,...i)}),this.addHook("beforeDropdownMenuShow",()=>he(hs,this,hc).call(this)),this.addHook("afterDropdownMenuShow",()=>he(hs,this,hh).call(this)),this.addHook("afterDropdownMenuHide",()=>he(hs,this,hu).call(this)),this.addHook("afterChange",t=>he(hs,this,ha).call(this,t)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ht(hr,this)&&this.dropdownMenuPlugin.enabled){let t=[{focus:()=>{let t=ht(hr,this).getMenu(),e=t.getNavigator(),i=ht(hr,this).getLastMenuPage();t.focus(),i>0?e.setCurrentPage(i):e.toFirstItem()}},...Array.from(this.components).map(t=>{let[,e]=t;return e.getElements()}).flat()];a6(hr,this,function(t,e){let i,r=-1,n=oo({initialPage:0,size:()=>e.length,onItemSelect:(t,i)=>{let r=e[t];return r instanceof aA?i:(!r.element||!!(0,y.isVisible)(r.element))&&void r.focus()}}),o=t=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(a9),n.setCurrentPage(e.indexOf(t))};function s(t){let o=i.getKeyboardShortcutsCtrl(),s=t.getKeyboardShortcutsCtrl();n.clear(),s.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:o.getContext(a9),callback:()=>{t.isSubMenu()&&t.close(),o.listen(a9)}}]),t.isSubMenu()||o.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:t=>{let e=i.getNavigator();e.getCurrentPage()>-1&&(r=e.getCurrentPage()),e.clear(),t.shiftKey?n.toPreviousItem():n.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:t=>{let i=e[n.getCurrentPage()];i instanceof lq&&(i.openOptions(),t.preventDefault()),i instanceof aw&&(i.activate(),t.preventDefault()),i instanceof lO||t.preventDefault()}}],a9)}function l(t){t.addLocalHook("afterSelectionChange",t=>{t.key.startsWith("filter_")||n.clear()}),t.addLocalHook("afterSubmenuOpen",s),t.addLocalHook("afterOpen",s),i=t}return e.forEach(t=>{t instanceof lO&&(t.addLocalHook("click",o(t)),t.addLocalHook("focus",o(t)),t.addLocalHook("afterClose",o(t)))}),l(t),{...n,listen:function(){i.focus(),i.getKeyboardShortcutsCtrl().listen(a9)},setMenu:l,getMenu:function(){return i},getLastMenuPage:function(){return r}}}(this.dropdownMenuPlugin.menu,t));let e=t=>{ht(hr,this).listen(),t.preventDefault(),(0,$.isKey)(t.keyCode,"TAB")&&(t.shiftKey?ht(hr,this).toPreviousItem():ht(hr,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",e),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",e)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var t;null!==(t=this.dropdownMenuPlugin)&&void 0!==t&&t.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((t,e)=>{t.destroy(),this.components.set(e,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{let t=this.hot.getSelected();this.clearConditions(),this.filter(),t&&this.hot.selectCells(t)},group:hi})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(hi)}addCondition(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l5,n=this.hot.toPhysicalColumn(t);this.conditionCollection.addCondition(n,{command:{key:e},args:i},r)}removeConditions(t){let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}clearConditions(t){if(void 0===t)this.conditionCollection.clean();else{let e=this.hot.toPhysicalColumn(t);this.conditionCollection.removeConditions(e)}}importConditions(t){this.conditionCollection.importAllConditions(t)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){let{navigableHeaders:t}=this.hot.getSettings(),e=this._createDataFilter(),i=!this.conditionCollection.isEmpty(),r=[],n=this.exportConditions(),o=this.hot.runHooks("beforeFilter",n,ht(ho,this));if(!1!==o&&i){let i=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear();let t=ah(r=(0,z.arrayMap)(e.filter(),t=>t.meta.visualRow));(0,b.rangeEach)(this.hot.countSourceRows()-1,e=>{t(e)||i.push(e)}),(0,z.arrayEach)(i,t=>{this.filtersRowsMap.setValueAtIndex(t,!0)})},!0),t||r.length||this.hot.deselectCell(),a6(ho,this,this.exportConditions())}else!1===o||i?this.importConditions(ht(ho,this)):(a6(ho,this,this.exportConditions()),this.filtersRowsMap.clear());this.hot.selection.isSelected()&&this.hot.selectCell(t?-1:0,this.hot.getSelectedRangeLast().highlight.col),!1!==o&&(this.hot.runHooks("afterFilter",n),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var t;let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return e?{visualIndex:e.col,physicalIndex:this.hot.toPhysicalColumn(e.col)}:null}getDataMapAtColumn(t){let e=this.hot.toVisualColumn(t),i=[];return(0,z.arrayEach)(this.hot.getSourceDataAtCol(e),(t,r)=>{var n;let{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d}=this.hot.getCellMeta(r,e),g=null!==(n=this.hot.getDataAtCell(this.hot.toVisualRow(r),e))&&void 0!==n?n:t;i.push({meta:{row:o,col:s,visualCol:l,visualRow:a,type:h,instance:u,dateFormat:c,locale:d},value:au(g)})}),i}updateValueComponentCondition(t){let e=ac(this.hot.getDataAtCol(t));this.conditionUpdateObserver.updateStatesAtColumn(t,e)}restoreComponents(t){var e;let i=null===(e=this.getSelectedColumn())||void 0===e?void 0:e.physicalIndex;t.forEach(t=>{t.isHidden()||t.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(t,e,i,r){let n=t;return n===l8&&e.command.key!==lh&&i.command.key!==lh&&r.command.key!==lh?n=l7:r.command.key!==lh&&(e.command.key===lh||i.command.key===lh)&&(n=l5),n}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){let{command:t}=this.components.get("filter_by_condition").getState(),e=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];t.showOperators?this.showComponents(...e):this.hideComponents(...e)}_createDataFilter(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.conditionCollection;return new aK(t,t=>this.getDataMapAtColumn(t))}getIndexesOfComponents(){let t=[];if(!this.dropdownMenuPlugin)return t;let e=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return(0,z.arrayEach)(r,i=>{(0,z.arrayEach)(e.menuItems,(e,r)=>{e.key===i.getMenuItemDescriptor().key&&t.push(r)})}),t}changeComponentsVisibility(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];if(!this.dropdownMenuPlugin)return;let e=this.dropdownMenuPlugin.menu.hotMenu,i=e.getPlugin("hiddenRows");for(var r=arguments.length,n=Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];let s=this.getIndexesOfComponents(...n);t?i.showRows(s):i.hideRows(s),e.render()}hideComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!1,...e)}showComponents(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.changeComponentsVisibility(!0,...e)}destroy(){this.enabled&&(this.components.forEach((t,e)=>{null!==t&&(t.destroy(),this.components.set(e,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function ha(t){t&&(0,z.arrayEach)(t,t=>{let[,e]=t,i=this.hot.propToCol(e);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function hh(){let t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function hu(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function hc(){let t=this.dropdownMenuPlugin.menu;ht(hn,this).has(t)||ht(hr,this).setMenu(t),ht(hn,this).add(t)}function hd(t){t.items.push({name:ne}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function hg(t){var e,i;if("accept"===t){let t=this.getSelectedColumn();if(null===t){null===(i=this.dropdownMenuPlugin)||void 0===i||i.close();return}let{physicalIndex:e}=t,r=this.components.get("filter_by_condition").getState(),n=this.components.get("filter_by_condition2").getState(),o=this.components.get("filter_by_value").getState(),s=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),r,n,o);this.conditionUpdateObserver.groupChanges();let l=this.conditionCollection.getColumnStackPosition(e);-1===l&&(l=void 0),this.conditionCollection.removeConditions(e),r.command.key!==lh&&(this.conditionCollection.addCondition(e,r,s,l),n.command.key!==lh&&this.conditionCollection.addCondition(e,n,s,l)),o.command.key!==lh&&this.conditionCollection.addCondition(e,o,s,l),this.conditionUpdateObserver.flush(),this.components.forEach(t=>t.saveState(e)),this.filter()}null===(e=this.dropdownMenuPlugin)||void 0===e||e.close()}function hf(t,e){let i=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor!==l1||e.inputsCount||this.setListeningDropdownMenu(),i.updateMenuDimensions()}function hp(){this.setListeningDropdownMenu()}function hm(t,e,i){let r=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(r)&&i===this.hot.view.getColumnHeadersCount()-1?(0,y.addClass)(e,"htFiltersActive"):(0,y.removeClass)(e,"htFiltersActive")}function hw(t){var e;if(!(null!==(e=this.dropdownMenuPlugin)&&void 0!==e&&e.enabled))return;let{editedConditionStack:{conditions:i,column:r},conditionArgsChange:n}=t;Array.isArray(n)&&a6(ho,this,ht(ho,this).map(t=>(t.column===r&&i.length>0&&t.conditions.forEach(t=>{"by_value"===t.name&&(t.args=[[...n]])}),t)));let o=i.filter(t=>t.name===aD),s=i.filter(t=>t.name!==aD);if(o.length>=2||s.length>=3)(0,iD.R8)((0,ro.O)`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{let e=this.conditionCollection.getOperation(r);this.components.get("filter_by_condition").updateState(s[0],r),this.components.get("filter_by_condition2").updateState(s[1],r),this.components.get("filter_operators").updateState(e,r),this.components.get("filter_by_value").updateState(t)}}i(89750);let hv="internal-use-in-handsontable",hy={licenseKey:hv,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function hb(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:null===(e=t[h7])||void 0===e||null===(e=e.language)||void 0===e?void 0:e.langCode}}function hC(t){return Object.keys(t).reduce((e,i)=>("hyperformula"!==i&&(e[i]=t[i]),e),{})}function hS(){let t="engine_relationship",e=(0,i4.A)(h7);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function hE(){let t="shared_engine_usage",e=(0,i4.A)(h7);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function hR(t){var e;let i=hS();return new Map((0===i.size?[]:Array.from(null!==(e=i.get(t))&&void 0!==e?e:[])).map(t=>[t.getPlugin("formulas").sheetId,t]))}function hT(t,e){if(t){let i=hS(),r=i.get(t),n=hE(),o=n.get(t);r&&r.includes(e)&&(r.splice(r.indexOf(e),1),0===r.length&&i.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),0===o.length&&(n.delete(t),t.destroy()))}}let hx="DD/MM/YYYY";function hM(t,e){return"string"==typeof t&&"date"===e}function hk(t,e){return tn(t,e,!0).isValid()}function hO(t,e){return tn(t,e,!0).format(hx)}function hI(t,e){return tn(new Date(Date.UTC(0,0,t+-1))).format(e)}function hA(t,e,i){var r;return(r=function(t,e){let i=[];return t.forEach(t=>{let r={from:t,to:e};i.forEach(t=>{let e=t.from>t.to,i=t.to<=r.from;t.from>r.from&&i&&e&&(r.from+=1)}),r.from>=e&&(e+=1),i.push(r)}),i}(t,function(t,e,i){let r=Array.from(Array(i).keys()).filter(e=>!1===t.includes(e));if(0===e){var n;return null!==(n=r[e])&&void 0!==n?n:0}return r[e-1]+1}(t,e,i))).forEach((t,e)=>{r.slice(e+1).forEach(e=>{let i=e.from<e.to;e.from>t.from&&i&&(e.from-=1)})}),r}function hN(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function hH(t,e){return t.get(h_(t,e))}function hP(t,e,i){return t.set(h_(t,e),i),i}function h_(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var hD=new WeakMap,hL=new WeakMap,hF=new WeakMap,hV=new WeakMap,hW=new WeakMap,hB=new WeakMap,hj=new WeakMap;class hz{constructor(t,e,i){hN(this,hD,void 0),hN(this,hL,void 0),hN(this,hF,void 0),hN(this,hV,[]),hN(this,hW,[]),hN(this,hB,void 0),hN(this,hj,[]),hP(hD,this,t),hP(hL,this,e),hP(hF,this,i)}setRemovedHfIndexes(t){return hP(hj,this,t.map(t=>{let e=hH(hL,this).getVisualFromPhysicalIndex(t);return this.getHfIndexFromVisualIndex(e)})),hH(hj,this)}getRemovedHfIndexes(){return hH(hj,this)}getHfIndexFromVisualIndex(t){let e=hH(hL,this).getIndexesSequence(),i=hH(hL,this).getNotTrimmedIndexes();return e.indexOf(i[t],t)}syncMoves(t){let e=`move${(0,U.toUpperCaseFirst)(hH(hD,this))}s`;hH(hF,this).getEngine().batch(()=>{t.forEach(t=>{let i=t.from!==t.to,r=t.from+1!==t.to;i&&r&&hH(hF,this).getEngine()[e](hH(hF,this).getSheetId(),t.from,1,t.to)})})}storeMovesInformation(t,e,i){!1!==i&&(hP(hW,this,t.map(t=>this.getHfIndexFromVisualIndex(t))),hP(hB,this,this.getHfIndexFromVisualIndex(e)))}calculateAndSyncMoves(t,e){if(hH(hF,this).isPerformingUndoRedo()||!1===t||!1===e)return;let i=hA(hH(hW,this),hH(hB,this),hH(hL,this).getNumberOfIndexes());null===hH(hF,this).getSheetId()?hH(hF,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){let t=`set${(0,U.toUpperCaseFirst)(hH(hD,this))}Order`;return e=>{if(hH(hF,this).isPerformingUndoRedo())return;let i=hH(hL,this).getIndexesSequence();if("update"===e&&i.length>0){let e,r=hH(hV,this).map(t=>i.indexOf(t)),n=hH(hF,this).getEngine().getSheetDimensions(hH(hF,this).getSheetId());e="row"===hH(hD,this)?n.height:n.width;let o=r.length;for(let t=o;t<e;t+=1)r.push(t);hH(hF,this).getEngine()[t](hH(hF,this).getSheetId(),r)}hP(hV,this,i)}}init(){hP(hV,this,hH(hL,this).getIndexesSequence())}}function hU(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function h$(t,e){return t.get(hG(t,e))}function hY(t,e,i){return t.set(hG(t,e),i),i}function hG(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var hq=new WeakMap,hX=new WeakMap,hK=new WeakMap,hJ=new WeakMap,hQ=new WeakMap,hZ=new WeakMap,h0=new WeakMap;class h1{constructor(t,e,i){hU(this,hq,void 0),hU(this,hX,void 0),hU(this,hK,void 0),hU(this,hJ,!1),hU(this,hQ,!1),hU(this,hZ,null),hU(this,h0,null),hY(hq,this,new hz("row",t,this)),hY(hX,this,new hz("column",e,this)),hY(hK,this,i)}getForAxis(t){return"row"===t?h$(hq,this):h$(hX,this)}setPerformUndo(t){hY(hJ,this,t)}setPerformRedo(t){hY(hQ,this,t)}isPerformingUndoRedo(){return h$(hJ,this)||h$(hQ,this)}getSheetId(){return h$(h0,this)}getEngine(){return h$(hZ,this)}getPostponeAction(){return h$(hK,this)}setupSyncEndpoint(t,e){hY(hZ,this,t),hY(h0,this,e),h$(hq,this).init(),h$(hX,this).init()}}function h2(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function h3(t,e,i){h9(t,e),e.set(t,i)}function h9(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function h4(t,e,i){return t.set(h8(t,e),i),i}function h5(t,e){return t.get(h8(t,e))}function h8(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let h7="formulas",h6=["maxRows","maxColumns","language"];d.R.getSingleton().register("afterNamedExpressionAdded"),d.R.getSingleton().register("afterNamedExpressionRemoved"),d.R.getSingleton().register("afterSheetAdded"),d.R.getSingleton().register("afterSheetRemoved"),d.R.getSingleton().register("afterSheetRenamed"),d.R.getSingleton().register("afterFormulasValuesUpdate");let ut=t=>"UndoRedo.undo"===t||"UndoRedo.redo"===t||"auto"===t;var ue=new WeakMap,ui=new WeakMap,ur=new WeakMap,un=new WeakSet;class uo extends eC{constructor(){var t;super(...arguments),t=this,function(t,e){h9(t,e),e.add(t)}(this,un),h3(this,ue,!1),h3(this,ui,!1),h3(this,ur,[["valuesUpdated",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h8(un,t,uT).call(t,...i)}],["namedExpressionAdded",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h8(un,t,ux).call(t,...i)}],["namedExpressionRemoved",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h8(un,t,uM).call(t,...i)}],["sheetAdded",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h8(un,t,uk).call(t,...i)}],["sheetRenamed",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h8(un,t,uO).call(t,...i)}],["sheetRemoved",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return h8(un,t,uI).call(t,...i)}]]),h2(this,"staticRegister",(0,i4.A)("formulas")),h2(this,"engine",null),h2(this,"sheetId",null),h2(this,"sheetName",null),h2(this,"indexSyncer",null),h2(this,"rowAxisSyncer",null),h2(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return h7}static get PLUGIN_PRIORITY(){return 260}static get SETTING_KEYS(){return[h7,...h6]}isEnabled(){return!!this.hot.getSettings()[h7]}enablePlugin(){var t,e=this;if(!this.enabled){if(this.engine=null!==(t=function(t){let e=t.getSettings(),i=e[h7],r=null==i?void 0:i.engine;if(!0===i||(0,T.isUndefined)(r))return null;if("function"==typeof r.hyperformula||"function"==typeof r){var n;return function(t,e,i){var r,n,o,s;let l=e[h7],a=function(t){var e;let i=t[h7],r=hC(null!=i&&null!==(e=i.engine)&&void 0!==e&&e.hyperformula?i.engine:{}),n=hb(t);return{...hy,...r,...n}}(e),h=hS(),u=hE();r=t,(n=l.functions)&&n.forEach(t=>{let{name:e,plugin:i,translations:n}=t;try{r.registerFunction(e,i,n)}catch(t){(0,iD.R8)(t.message)}}),function(t,e){if(e){let{langCode:i}=e;try{t.registerLanguage(i,e)}catch(t){(0,iD.R8)(t.message)}}}(t,l.language);let c=t.buildEmpty(a);return h.set(c,[i]),u.set(c,[i.guid]),o=c,(s=l.namedExpressions)&&(o.suspendEvaluation(),s.forEach(t=>{let{name:e,expression:i,scope:r,options:n}=t;try{o.addNamedExpression(e,i,r,n)}catch(t){(0,iD.R8)(t.message)}}),o.resumeEvaluation()),c.on("sheetAdded",()=>{c.rebuildAndRecalculate()}),c.on("sheetRemoved",()=>{c.rebuildAndRecalculate()}),c}(null!==(n=r.hyperformula)&&void 0!==n?n:r,e,t)}if("object"==typeof r&&(0,T.isUndefined)(r.hyperformula)){let e=hS(),i=hE().get(r);return e.has(r)||e.set(r,[]),e.get(r).push(t),i&&i.push(t.guid),r.getConfig().licenseKey||r.updateConfig({licenseKey:hv}),(r.getConfig().leapYear1900!==hy.leapYear1900||!1===(0,V.isObjectEqual)(r.getConfig().nullDate,hy.nullDate))&&(0,iD.R8)((0,ro.O)`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),r}return null}(this.hot))&&void 0!==t?t:this.engine,!this.engine){(0,iD.R8)("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(null!==this.sheetName&&!this.engine.doesSheetExist(this.sheetName)){let t=this.addSheet(this.sheetName,this.hot.getSourceDataArray());!1!==t&&h8(un,this,us).call(this,t)}this.addHook("beforeLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uh).call(e,...i)}),this.addHook("afterLoadData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uc).call(e,...i)}),this.addHook("beforeUpdateData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uh).call(e,...i)}),this.addHook("afterUpdateData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uc).call(e,...i)}),this.addHook("modifyData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,ud).call(e,...i)}),this.addHook("modifySourceData",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,ug).call(e,...i)}),this.addHook("beforeValidate",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,ul).call(e,...i)}),this.addHook("afterSetSourceDataAtCell",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,up).call(e,...i)}),this.addHook("afterSetDataAtCell",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uf).call(e,...i)}),this.addHook("afterSetDataAtRowProp",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uf).call(e,...i)}),this.addHook("beforeCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,um).call(e,...i)}),this.addHook("beforeCreateCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uw).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,ub).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uC).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uv).call(e,...i)}),this.addHook("beforeRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uy).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uS).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uE).call(e,...i)}),this.indexSyncer=new h1(this.hot.rowIndexMapper,this.hot.columnIndexMapper,t=>{this.hot.addHookOnce("init",()=>{t()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(t,e,i,r)=>{this.rowAxisSyncer.storeMovesInformation(t,e,r)}),this.hot.addHook("beforeColumnMove",(t,e,i,r)=>{this.columnAxisSyncer.storeMovesInformation(t,e,r)}),this.hot.addHook("afterRowMove",(t,e,i,r,n)=>{this.rowAxisSyncer.calculateAndSyncMoves(r,n)}),this.hot.addHook("afterColumnMove",(t,e,i,r,n)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,n)}),this.hot.addHook("beforeColumnFreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart,e)}),this.hot.addHook("afterColumnFreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.hot.addHook("beforeColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.storeMovesInformation([t],this.hot.getSettings().fixedColumnsStart-1,e)}),this.hot.addHook("afterColumnUnfreeze",(t,e)=>{this.columnAxisSyncer.calculateAndSyncMoves(e,e)}),this.addHook("afterCellMetaReset",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uu).call(e,...i)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,uR).call(e,...i)}),this.addHook("beforeAutofill",function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];return h8(un,e,ua).call(e,...i)}),h5(ur,this).forEach(t=>{let[e,i]=t;return this.engine.on(e,i)}),super.enablePlugin()}}disablePlugin(){h5(ur,this).forEach(t=>{let[e,i]=t;return this.engine.off(e,i)}),hT(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(t){var e;let i=function(t){var e;let i=t[h7],r=hC(null!=i&&null!==(e=i.engine)&&void 0!==e&&e.hyperformula?i.engine:{}),n=hb(t);return{...r,...n}}(this.hot.getSettings());e=this.engine.getConfig(),Object.keys(i).some(t=>void 0!==i[t]&&i[t]!==e[t])&&this.engine.updateConfig(i);let r=this.hot.getSettings()[h7];if((0,T.isDefined)(r)&&(0,T.isDefined)(r.sheetName)&&r.sheetName!==this.sheetName&&this.switchSheet(r.sheetName),!t.data&&null===this.sheetName){let t=this.hot.getSettings()[h7].sheetName;if(t&&this.engine.doesSheetExist(t))this.switchSheet(this.sheetName);else{let e=this.addSheet(null!=t?t:void 0,this.hot.getSourceDataArray());h8(un,this,us).call(this,e)}}super.updatePlugin(t)}destroy(){h5(ur,this).forEach(t=>{var e;let[i,r]=t;return null===(e=this.engine)||void 0===e?void 0:e.off(i,r)}),h4(ur,this,null),hT(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(t,e){if((0,T.isDefined)(e)&&!(0,ag.isArrayOfArrays)(e))return(0,iD.R8)("The provided data should be an array of arrays."),!1;if(null!=t&&this.engine.doesSheetExist(t))return(0,iD.R8)("Sheet with the provided name already exists."),!1;try{let i=this.engine.addSheet(null!=t?t:void 0);return e&&this.engine.setSheetContent(this.engine.getSheetId(i),e),i}catch(t){return(0,iD.R8)(t.message),!1}}switchSheet(t){if(!this.engine.doesSheetExist(t)){(0,iD.z3)(`The sheet named \`${t}\` does not exist, switch aborted.`);return}h8(un,this,us).call(this,t);let e=this.engine.getSheetSerialized(this.sheetId);e.length>0&&this.hot.loadData(e,`${(0,U.toUpperCaseFirst)(h7)}.switchSheet`)}getCellType(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId,r=this.hot.toPhysicalRow(t),n=this.hot.toPhysicalColumn(e);return null!==r&&null!==n?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)}):"EMPTY"}isFormulaCellType(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e)})}renderDependentSheets(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=new Set;t.forEach(t=>{var e;let r=null==t||null===(e=t.address)||void 0===e?void 0:e.sheet;void 0===r||i.has(r)||i.add(r)}),hR(this.engine).forEach((t,r)=>{if((e||r!==this.sheetId)&&i.has(r)){var n;t.render(),null===(n=t.view)||void 0===n||n.adjustElementsSize()}})}validateDependentCells(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=t=>{var e;let{row:i,col:r,sheet:n}=null!==(e=null==t?void 0:t.address)&&void 0!==e?e:{};return(0,T.isDefined)(n)?`${n}:${i}x${r}`:""},r=new Set(e.map(t=>i(t)));t.forEach(t=>{var e,n;let{row:o,col:s}=null!==(e=t.address)&&void 0!==e?e:{};if(!1===(0,T.isDefined)(o)||!1===(0,T.isDefined)(s)||o>=this.hot.countRows()||s>=this.hot.countCols())return;let l=null==t||null===(n=t.address)||void 0===n?void 0:n.sheet,a=i(t);if(void 0!==l&&!r.has(a)){let t=hR(this.engine).get(l);if(!t)return;t.validateCell(t.getDataAtCell(o,s),t.getCellMeta(o,s),()=>{})}})}syncChangeWithEngine(t,e,i){let r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){(0,iD.R8)(`Not possible to set cell data at ${JSON.stringify(r)}`);return}let n=this.hot.getCellMeta(t,e);if(hM(i,n.type))if(hk(i,n.dateFormat))i=hO(i,n.dateFormat);else{var o;!1===("string"==typeof(o=i)&&o.startsWith("="))&&(i=`'${i}`)}return this.engine.setCellContents(r,i)}}function us(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function ul(t,e,i){let r=this.hot.propToCol(i);if(this.isFormulaCellType(e,r)){let t={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},i=this.hot.getCellMeta(e,r),n=this.engine.getCellValue(t);return"date"===i.type&&(0,b.isNumeric)(n)&&(n=hI(n,i.dateFormat)),"object"==typeof n&&null!==n?n.value:n}return t}function ua(t,e,i){let{row:r,col:n}=e.getTopStartCorner(),{row:o,col:s}=e.getBottomEndCorner(),{row:l,col:a}=i.getTopStartCorner(),{row:h,col:u}=i.getBottomEndCorner(),c={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId}},d={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(l),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId}};if(!1===this.engine.isItPossibleToSetCellContents(d))return!1;let g=this.engine.getFillRangeData(c,d),{row:f,col:p}=c.start,{row:m,col:w}=c.end,y=m-f+1,b=w-p+1;for(let t=0;t<g.length;t+=1)for(let e=0;e<g[t].length;e+=1){let i=g[t][e],r=f+t%y,n=p+e%b,o=this.hot.getCellMeta(r,n);if(hM(i,o.type)){if(i.startsWith("'"))g[t][e]=i.slice(1);else if(!1===this.isFormulaCellType(r,n,this.sheetId)){var C;g[t][e]=(C=o.dateFormat,tn(i,hx,!0).format(C))}}}return g}function uh(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";i.includes((0,U.toUpperCaseFirst)(h7))||h4(ui,this,(0,T.isUndefined)(this.hot.getSettings().data))}function uu(){if(h5(ui,this)){this.switchSheet(this.sheetName);return}let t=this.hot.getSourceDataArray();t.forEach((e,i)=>{e.forEach((e,r)=>{let n=this.hot.getCellMeta(i,r,{skipMetaExtension:!0}),o=n.dateFormat;hM(e,n.type)&&(hk(e,o)?t[i][r]=hO(e,o):e.startsWith("=")||(t[i][r]=`'${e}`))})}),h4(ue,this,!0);let e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),h4(ue,this,!1)}function uc(t,e){var i,r;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if(n.includes((0,U.toUpperCaseFirst)(h7)))return;let o=(i=this.engine,r=this.hot.getSettings()[h7].sheetName,((0,T.isUndefined)(r)||!i.doesSheetExist(r))&&(r=i.addSheet(r)),r);if(h8(un,this,us).call(this,o),"updateSettings"!==n)if(h5(ui,this))this.switchSheet(this.sheetName);else{let t=this.hot.getSourceDataArray();if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,t)){h4(ue,this,!0);let e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),h4(ue,this,!1)}}}function ud(t,e,i,r){if("get"!==r||h5(ue,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(t);if(null===n||null===e)return;let o=this.getCellType(n,e);if("VALUE"===o||"EMPTY"===o){var s,l;i.value="string"==typeof(l=s=i.value)&&"'"===l.charAt(0)&&"="===l.charAt(1)?s.substr(1):s;return}let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId},h=this.engine.getCellValue(a),u=this.hot.getCellMeta(n,e,{skipMetaExtension:!0});"date"===u.type&&(0,b.isNumeric)(h)&&(h=hI(h,u.dateFormat)),i.value="object"==typeof h&&null!==h?h.value:h}function ug(t,e,i,r){if("get"!==r||h5(ue,this)||null===this.sheetName||!this.engine.doesSheetExist(this.sheetName))return;let n=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(null===n||null===o)return;let s=this.getCellType(n,o);if("VALUE"===s||"EMPTY"===s)return;let l=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(0===l.width&&0===l.height)return;let a={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(n),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};i.value=this.engine.getCellSerialized(a)}function uf(t,e){if(ut(e))return;let i=[],r=[],n=this.engine.batch(()=>{t.forEach(t=>{let[e,n,,o]=t,s=this.hot.propToCol(n),l=this.hot.toPhysicalRow(e),a=this.hot.toPhysicalColumn(s),h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};null!==l&&null!==a?this.syncChangeWithEngine(e,s,o):i.push([e,s,o]),r.push({address:h})})});i.length&&this.hot.addHookOnce("afterChange",()=>{let t=this.engine.batch(()=>{i.forEach(t=>{let[e,i,r]=t;this.syncChangeWithEngine(e,i,r)})});this.renderDependentSheets(t,!0)}),this.renderDependentSheets(n),this.validateDependentCells(n,r)}function up(t,e){if(ut(e))return;let i=[],r=[];t.forEach(t=>{let[e,n,,o]=t,s=this.hot.propToCol(n);if(!(0,b.isNumeric)(s))return;let l={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(l)){(0,iD.R8)(`Not possible to set source cell data at ${JSON.stringify(l)}`);return}r.push({address:l}),i.push(...this.engine.setCellContents(l,o))}),this.renderDependentSheets(i),this.validateDependentCells(i,r)}function um(t,e){let i=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(i=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[i,e]))return!1}function uw(t,e){let i=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(i=t),null===this.sheetId||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[i,e]))return!1}function uv(t,e,i){return!1!==this.rowAxisSyncer.setRemovedHfIndexes(i).every(t=>this.engine.isItPossibleToRemoveRows(this.sheetId,[t,1]))&&void 0}function uy(t,e,i){return!1!==this.columnAxisSyncer.setRemovedHfIndexes(i).every(t=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[t,1]))&&void 0}function ub(t,e,i){if(ut(i))return;let r=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function uC(t,e,i){if(ut(i))return;let r=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(r)}function uS(t,e,i,r){if(ut(r))return;let n=this.rowAxisSyncer.getRemovedHfIndexes().sort((t,e)=>e-t),o=this.engine.batch(()=>{n.forEach(t=>{this.engine.removeRows(this.sheetId,[t,1])})});this.renderDependentSheets(o)}function uE(t,e,i,r){if(ut(r))return;let n=this.columnAxisSyncer.getRemovedHfIndexes().sort((t,e)=>e-t),o=this.engine.batch(()=>{n.forEach(t=>{this.engine.removeColumns(this.sheetId,[t,1])})});this.renderDependentSheets(o)}function uR(t,e,i){var r;h4(ue,this,!0);let n=this.hot.getSourceDataArray(i,0,i+((null===(r=e.__children)||void 0===r?void 0:r.length)||0),this.hot.countSourceCols());h4(ue,this,!1),n.forEach((t,e)=>{t.forEach((t,r)=>{this.engine.setCellContents({col:r,row:i+e,sheet:this.sheetId},[[t]])})})}function uT(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function ux(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function uM(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function uk(t){this.hot.runHooks("afterSheetAdded",t)}function uO(t,e){h8(un,this,us).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function uI(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}var uA=i(44065);function uN(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function uH(t,e){return t.get(u_(t,e))}function uP(t,e,i){return t.set(u_(t,e),i),i}function u_(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeHideColumns"),d.R.getSingleton().register("afterHideColumns"),d.R.getSingleton().register("beforeUnhideColumns"),d.R.getSingleton().register("afterUnhideColumns");let uD="hiddenColumns";var uL=new WeakMap,uF=new WeakSet;class uV extends eC{constructor(){super(...arguments),function(t,e){uN(t,e),e.add(t)}(this,uF),function(t,e,i){uN(t,e),e.set(t,null)}(this,uL,0)}static get PLUGIN_KEY(){return uD}static get PLUGIN_PRIORITY(){return 310}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[uD]}enablePlugin(){var t=this;this.enabled||(uP(uL,this,new uA.o),uH(uL,this).addLocalHook("init",()=>u_(uF,this,u$).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,uH(uL,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u_(uF,t,uU).call(t,...i)}),this.addHook("afterGetCellMeta",(t,e,i)=>u_(uF,this,uB).call(this,t,e,i)),this.addHook("modifyColWidth",(t,e)=>u_(uF,this,uW).call(this,t,e),2),this.addHook("afterGetColHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return u_(uF,t,uz).call(t,...i)}),this.addHook("modifyCopyableRange",t=>u_(uF,this,uj).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(t){let e=this.getHiddenColumns(),i=this.isValidConfig(t),r=e,n=uH(uL,this).getValues().slice(),o=t.length>0;if(i&&o){let e=t.map(t=>this.hot.toPhysicalColumn(t));(0,z.arrayEach)(e,t=>{n[t]=!1}),r=(0,z.arrayReduce)(n,(t,e,i)=>(e&&t.push(this.hot.toVisualColumn(i)),t),[])}!1!==this.hot.runHooks("beforeUnhideColumns",e,r,i&&o)&&(i&&o&&uH(uL,this).setValues(n),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",e,r,i&&o,i&&r.length<e.length))}showColumn(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.showColumns(e)}hideColumns(t){let e=this.getHiddenColumns(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideColumns",e,r,i)&&(i&&this.hot.batchExecution(()=>{(0,z.arrayEach)(t,t=>{uH(uL,this).setValueAtIndex(this.hot.toPhysicalColumn(t),!0)})},!0),this.hot.runHooks("afterHideColumns",e,r,i,i&&r.length>e.length))}hideColumn(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.hideColumns(e)}getHiddenColumns(){return(0,z.arrayMap)(uH(uL,this).getHiddenIndexes(),t=>this.hot.toVisualColumn(t))}isHidden(t){return uH(uL,this).getValueAtIndex(this.hot.toPhysicalColumn(t))||!1}isValidConfig(t){let e=this.hot.countCols();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,z.arrayEach)(this.hot.getCellsMeta(),t=>{t.skipColumnOnPaste=!1})}destroy(){uP(uL,this,null),super.destroy()}}function uW(t,e){return this.isHidden(e)?0:this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&"number"==typeof t&&this.hot.hasColHeaders()?t+15:void 0}function uB(t,e,i){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(e)&&(i.skipColumnOnPaste=!0),this.isHidden(e-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenColumn")&&(i.className+=" afterHiddenColumn");else if(i.className){let t=i.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenColumn");e>-1&&t.splice(e,1),i.className=t.join(" ")}}}function uj(t){if(this.getSetting("copyPasteEnabled"))return t;let e=[],i=(t,i,r,n)=>{e.push({startRow:t,endRow:i,startCol:r,endCol:n})};return(0,z.arrayEach)(t,t=>{let e=!0,r=0;(0,b.rangeEach)(t.startCol,t.endCol,n=>{this.isHidden(n)?(e||i(t.startRow,t.endRow,r,n-1),e=!0):(e&&(r=n),n===t.endCol&&i(t.startRow,t.endRow,r,n),e=!1)})}),e}function uz(t,e){if(!this.getSetting("indicators")||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&i.push("beforeHiddenColumn"),(0,y.addClass)(e,i)}function uU(t){var e;t.items.push({name:ne},(e=this,{key:"hidden_columns_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[,i,,r]=t;i-r!=0&&(e=1)}return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_HIDE_COLUMN,e)},callback(){let{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.col,i.col),0),n=Math.max(t.col,i.col),o=[];for(let t=r;t<=n;t+=1)o.push(t);e.hideColumns(o);let s=o[o.length-1],l=this.columnIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectColumns(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_columns_show",name(){let t=+(e.length>1);return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_SHOW_COLUMN,t)},callback(){var i,r;if(0===e.length)return;let n=e[0],o=e[e.length-1];n=null!==(i=this.columnIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==i?i:0,o=null!==(r=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countCols()-1,t.showColumns(e),this.render(),this.view.adjustElementsSize(),o-n+1!==this.countCols()&&this.selectColumns(n,o)},disabled:!1,hidden(){let i=(0,z.arrayMap)(t.getHiddenColumns(),t=>this.toPhysicalColumn(t));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().col,o=r.getBottomEndCorner().col,s=this.columnIndexMapper,l=s.getRenderableFromVisualIndex(n),a=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(n!==o){if(o-n+1>a-l+1){let t=h.slice(n,o+1);u.push(...t.filter(t=>i.includes(t)))}}else if(0===l&&l<n)u.push(...h.slice(0,n));else if(null===l)u.push(...h.slice(0,this.countCols()));else{let t=this.countCols()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>o&&u.push(...h.slice(o+1))}return(0,z.arrayEach)(u,t=>{e.push(this.toVisualColumn(t))}),0===e.length}}}(this))}function u$(){let t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function uY(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function uG(t,e){return t.get(uX(t,e))}function uq(t,e,i){return t.set(uX(t,e),i),i}function uX(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeHideRows"),d.R.getSingleton().register("afterHideRows"),d.R.getSingleton().register("beforeUnhideRows"),d.R.getSingleton().register("afterUnhideRows");let uK="hiddenRows";var uJ=new WeakMap,uQ=new WeakSet;class uZ extends eC{constructor(){super(...arguments),function(t,e){uY(t,e),e.add(t)}(this,uQ),function(t,e,i){uY(t,e),e.set(t,null)}(this,uJ,0)}static get PLUGIN_KEY(){return uK}static get PLUGIN_PRIORITY(){return 320}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[uK]}enablePlugin(){var t=this;this.enabled||(uq(uJ,this,new uA.o),uG(uJ,this).addLocalHook("init",()=>uX(uQ,this,u4).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,uG(uJ,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uX(uQ,t,u9).call(t,...i)}),this.addHook("afterGetCellMeta",(t,e,i)=>uX(uQ,this,u1).call(this,t,e,i)),this.addHook("modifyRowHeight",(t,e)=>uX(uQ,this,u0).call(this,t,e)),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return uX(uQ,t,u3).call(t,...i)}),this.addHook("modifyCopyableRange",t=>uX(uQ,this,u2).call(this,t)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e,n=uG(uJ,this).getValues().slice(),o=t.length>0;if(i&&o){let e=t.map(t=>this.hot.toPhysicalRow(t));(0,z.arrayEach)(e,t=>{n[t]=!1}),r=(0,z.arrayReduce)(n,(t,e,i)=>(e&&t.push(this.hot.toVisualRow(i)),t),[])}!1!==this.hot.runHooks("beforeUnhideRows",e,r,i&&o)&&(i&&o&&uG(uJ,this).setValues(n),this.hot.runHooks("afterUnhideRows",e,r,i&&o,i&&r.length<e.length))}showRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.showRows(e)}hideRows(t){let e=this.getHiddenRows(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeHideRows",e,r,i)&&(i&&this.hot.batchExecution(()=>{(0,z.arrayEach)(t,t=>{uG(uJ,this).setValueAtIndex(this.hot.toPhysicalRow(t),!0)})},!0),this.hot.runHooks("afterHideRows",e,r,i,i&&r.length>e.length))}hideRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.hideRows(e)}getHiddenRows(){return(0,z.arrayMap)(uG(uJ,this).getHiddenIndexes(),t=>this.hot.toVisualRow(t))}isHidden(t){return uG(uJ,this).getValueAtIndex(this.hot.toPhysicalRow(t))||!1}isValidConfig(t){let e=this.hot.countRows();return!!Array.isArray(t)&&t.length>0&&t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}resetCellsMeta(){(0,z.arrayEach)(this.hot.getCellsMeta(),t=>{t.skipRowOnPaste=!1})}destroy(){uq(uJ,this,null),super.destroy()}}function u0(t,e){return this.isHidden(e)?0:t}function u1(t,e,i){if(!1===this.getSetting("copyPasteEnabled")&&this.isHidden(t)&&(i.skipRowOnPaste=!0),this.isHidden(t-1))i.className=i.className||"",-1===i.className.indexOf("afterHiddenRow")&&(i.className+=" afterHiddenRow");else if(i.className){let t=i.className.split(" ");if(t.length>0){let e=t.indexOf("afterHiddenRow");e>-1&&t.splice(e,1),i.className=t.join(" ")}}}function u2(t){if(this.getSetting("copyPasteEnabled"))return t;let e=[],i=(t,i,r,n)=>{e.push({startRow:t,endRow:i,startCol:r,endCol:n})};return(0,z.arrayEach)(t,t=>{let e=!0,r=0;(0,b.rangeEach)(t.startRow,t.endRow,n=>{this.isHidden(n)?(e||i(r,n-1,t.startCol,t.endCol),e=!0):(e&&(r=n),n===t.endRow&&i(r,n,t.startCol,t.endCol),e=!1)})}),e}function u3(t,e){if(!this.getSetting("indicators")||t<0)return;let i=[];t>=1&&this.isHidden(t-1)&&i.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&i.push("beforeHiddenRow"),(0,y.addClass)(e,i)}function u9(t){var e;t.items.push({name:ne},(e=this,{key:"hidden_rows_hide",name(){let t=this.getSelectedLast(),e=0;if(Array.isArray(t)){let[i,,r]=t;i-r!=0&&(e=1)}return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_HIDE_ROW,e)},callback(){let{from:t,to:i}=this.getSelectedRangeLast(),r=Math.max(Math.min(t.row,i.row),0),n=Math.max(t.row,i.row),o=[];for(let t=r;t<=n;t+=1)o.push(t);e.hideRows(o);let s=o[o.length-1],l=this.rowIndexMapper.getNearestNotHiddenIndex(s,1,!0);Number.isInteger(l)&&l>=0?this.selectRows(l):this.deselectCell(),this.render(),this.view.adjustElementsSize()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}),function(t){let e=[];return{key:"hidden_rows_show",name(){let t=+(e.length>1);return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_SHOW_ROW,t)},callback(){var i,r;if(0===e.length)return;let n=e[0],o=e[e.length-1];n=null!==(i=this.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1))&&void 0!==i?i:0,o=null!==(r=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))&&void 0!==r?r:this.countRows()-1,t.showRows(e),this.render(),this.view.adjustElementsSize(),o-n+1!==this.countRows()&&this.selectRows(n,o)},disabled:!1,hidden(){let i=(0,z.arrayMap)(t.getHiddenRows(),t=>this.toPhysicalRow(t));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||i.length<1)return!0;e.length=0;let r=this.getSelectedRangeLast(),n=r.getTopStartCorner().row,o=r.getBottomEndCorner().row,s=this.rowIndexMapper,l=s.getRenderableFromVisualIndex(n),a=s.getRenderableFromVisualIndex(o),h=s.getNotTrimmedIndexes(),u=[];if(n!==o){if(o-n+1>a-l+1){let t=h.slice(n,o+1);u.push(...t.filter(t=>i.includes(t)))}}else if(0===l&&l<n)u.push(...h.slice(0,n));else if(null===l)u.push(...h.slice(0,this.countRows()));else{let t=this.countRows()-1;a===s.getRenderableFromVisualIndex(s.getNearestNotHiddenIndex(t,-1))&&t>o&&u.push(...h.slice(o+1))}return(0,z.arrayEach)(u,t=>{e.push(this.toVisualRow(t))}),0===e.length}}}(this))}function u4(){let t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function u5(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function u8(t,e){return t.get(u6(t,e))}function u7(t,e,i){return t.set(u6(t,e),i),i}function u6(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeColumnFreeze"),d.R.getSingleton().register("afterColumnFreeze"),d.R.getSingleton().register("beforeColumnUnfreeze"),d.R.getSingleton().register("afterColumnUnfreeze");let ct="manualColumnFreeze";var ce=new WeakMap,ci=new WeakSet;class cr extends eC{constructor(){super(...arguments),function(t,e){u5(t,e),e.add(t)}(this,ci),function(t,e,i){u5(t,e),e.set(t,i)}(this,ce,!1)}static get PLUGIN_KEY(){return ct}static get PLUGIN_PRIORITY(){return 110}isEnabled(){return!!this.hot.getSettings()[ct]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",t=>u6(ci,this,cn).call(this,t)),this.addHook("beforeColumnMove",(t,e)=>u6(ci,this,co).call(this,t,e)),super.enablePlugin())}disablePlugin(){u7(ce,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(t){let e=this.hot.getSettings(),i=e.fixedColumnsStart<this.hot.countCols()&&t>e.fixedColumnsStart-1;u8(ce,this)||u7(ce,this,!0),!1!==this.hot.runHooks("beforeColumnFreeze",t,i)&&(i&&(this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart),e._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",t,i))}unfreezeColumn(t){let e=this.hot.getSettings(),i=e.fixedColumnsStart>0&&t<=e.fixedColumnsStart-1;u8(ce,this)||u7(ce,this,!0),!1!==this.hot.runHooks("beforeColumnUnfreeze",t,i)&&(i&&(e._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(t,e.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",t,i))}}function cn(t){var e,i;t.items.push({name:"---------"},(e=this,{key:"freeze_column",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(t,i){let[{start:{col:r}}]=i;e.freezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){let t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(e=!0),e}}),(i=this,{key:"unfreeze_column",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(t,e){let[{start:{col:r}}]=e;i.unfreezeColumn(r),this.render(),this.view.adjustElementsSize()},hidden(){let t=this.getSelectedRange(),e=!1;return void 0===t?e=!0:t.length>1?e=!0:(t[0].from.col!==t[0].to.col||t[0].from.col>=this.getSettings().fixedColumnsStart)&&(e=!0),e}}))}function co(t,e){if(u8(ce,this)){let i=this.hot.getSettings().fixedColumnsStart;if(e<i||t.some(t=>t<i))return!1}}function cs(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class cl{constructor(t){cs(this,"hot",void 0),cs(this,"_element",null),cs(this,"state",0),cs(this,"inlineProperty",void 0),this.hot=t,this.inlineProperty=t.isRtl()?"right":"left"}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){(0,b.isNumeric)(t)&&(this._element.style.top=t+"px"),(0,b.isNumeric)(e)&&(this._element.style[this.inlineProperty]=e+"px")}getPosition(){let t=this._element.style;return{top:t.top?parseInt(t.top,10):0,start:t[this.inlineProperty]?parseInt(t[this.inlineProperty],10):0}}setSize(t,e){(0,b.isNumeric)(t)&&(this._element.style.width=t+"px"),(0,b.isNumeric)(e)&&(this._element.style.height=e+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){(0,b.isNumeric)(t)&&(this._element.style.marginTop=t+"px"),(0,b.isNumeric)(e)&&(this._element.style[`margin${(0,U.toUpperCaseFirst)(this.inlineProperty)}`]=e+"px")}getOffset(){let t=this._element.style,e=`margin${(0,U.toUpperCaseFirst)(this.inlineProperty)}`;return{top:t.marginTop?parseInt(t.marginTop,10):0,start:t[e]?parseInt(t[e],10):0}}}let ca=cl;class ch extends ca{build(){super.build(),(0,y.addClass)(this._element,"ht__manualColumnMove--backlight")}}class cu extends ca{build(){super.build(),(0,y.addClass)(this._element,"ht__manualColumnMove--guideline")}}function cc(t,e,i){cd(t,e),e.set(t,i)}function cd(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function cg(t,e,i){return t.set(cp(t,e),i),i}function cf(t,e){return t.get(cp(t,e))}function cp(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeColumnMove"),d.R.getSingleton().register("afterColumnMove");let cm="manualColumnMove",cw="ht__manualColumnMove",cv="show-ui",cy="on-moving--columns",cb="after-selection--columns";var cC=new WeakMap,cS=new WeakMap,cE=new WeakMap,cR=new WeakMap,cT=new WeakMap,cx=new WeakMap,cM=new WeakMap,ck=new WeakMap,cO=new WeakMap,cI=new WeakMap,cA=new WeakMap,cN=new WeakSet;class cH extends eC{constructor(){super(...arguments),function(t,e){cd(t,e),e.add(t)}(this,cN),cc(this,cC,new ch(this.hot)),cc(this,cS,new cu(this.hot)),cc(this,cE,[]),cc(this,cR,0),cc(this,cT,!1),cc(this,cx,{}),cc(this,cM,void 0),cc(this,ck,void 0),cc(this,cO,void 0),cc(this,cI,void 0),cc(this,cA,void 0)}static get PLUGIN_KEY(){return cm}static get PLUGIN_PRIORITY(){return 120}isEnabled(){return!!this.hot.getSettings()[cm]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return cp(cN,t,cP).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return cp(cN,t,cD).call(t,...i)}),this.addHook("afterScrollVertically",()=>cp(cN,this,cF).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return cp(cN,t,cV).call(t,...i)}),this.buildPluginUI(),this.registerEvents(),(0,y.addClass)(this.hot.rootElement,cw),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,y.removeClass)(this.hot.rootElement,cw),this.unregisterEvents(),cf(cC,this).destroy(),cf(cS,this).destroy(),super.disablePlugin()}moveColumn(t,e){return this.moveColumns([t],e)}moveColumns(t,e){let i=cf(cM,this),r=this.isMovePossible(t,e),n=this.hot.runHooks("beforeColumnMove",t,e,i,r);if(cg(cM,this,void 0),!1===n)return;r&&this.hot.columnIndexMapper.moveIndexes(t,e);let o=r&&this.isColumnOrderChanged(t,e);return this.hot.runHooks("afterColumnMove",t,e,i,r,o),o}dragColumn(t,e){return this.dragColumns([t],e)}dragColumns(t,e){let i=this.countFinalIndex(t,e);return cg(cM,this,e),this.moveColumns(t,i)}isMovePossible(t,e){let i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>i,n=t.some(t=>t<0),o=t.some(t=>t>=i);return!r&&!(e<0)&&!n&&!o}isColumnOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}countFinalIndex(t,e){let i=(0,z.arrayReduce)(t,(t,i)=>(i<e&&(t+=1),t),0);return e-i}getColumnsWidth(t,e){let i=this.hot.columnIndexMapper,r=0;for(let n=t;n<=e;n+=1){let t=i.getRenderableFromVisualIndex(n);n<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:null!==t&&(r+=this.hot.view._wt.wtTable.getColumnWidth(t)||0)}return r}moveBySettingsOrLoad(){let t=this.hot.getSettings()[cm];if(Array.isArray(t))this.moveColumns(t,0);else if(void 0!==t){let t=this.persistentStateLoad();t.length&&this.moveColumns(t,0)}}isFixedColumnsStart(t){return t<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){let t={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",t),t.value?t.value:[]}prepareColumnsToMoving(t,e){let i=[];return(0,b.rangeEach)(t,e,t=>{i.push(t)}),i}refreshPositions(){let t=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(cf(ck,this))&&t>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(t-1,-1)});let e=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r="number"==typeof i.scrollX?i.scrollX:i.scrollLeft,n=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,cf(ck,this)-1),o=e.hider.offsetWidth,s=e.TBODY.offsetLeft,l=cf(cC,this).getOffset().start,a=cf(cC,this).getSize().width,h=0,u=0;if(this.hot.isRtl()){let t=this.hot.rootWindow,e=(0,y.outerWidth)(this.hot.rootElement),n=t.innerWidth-cf(cO,this)-e;u=t.innerWidth-cf(cx,this).eventPageX-n-(void 0===i.scrollX?r:0)}else u=cf(cx,this).eventPageX-(cf(cO,this)-(void 0===i.scrollX?r:0));if(cf(cI,this)&&(h=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(cf(ck,this))&&(n+=r),n+=h,0>cf(ck,this))cf(cA,this)>0?cf(cx,this).col=0:cf(cx,this).col=t>0?t-1:t;else if(cf(cx,this).TD.offsetWidth/2+n<=u){let t=cf(ck,this)>=cf(cR,this)?cf(cR,this)-1:cf(ck,this);cf(cx,this).col=t+1,n+=cf(cx,this).TD.offsetWidth}else cf(cx,this).col=cf(ck,this);let c=u,d=n;u+a+l>=o?c=o-a-l:u+l<s+h&&(c=s+h+Math.abs(l)),n>=o-1?d=o-1:0===d?d=1:void 0!==i.scrollX&&cf(ck,this)<cf(cA,this)&&(d-=cf(cO,this)<=i.scrollX?cf(cO,this):0),cf(cC,this).setPosition(null,c),cf(cS,this).setPosition(null,d)}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>cp(cN,this,c_).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>cp(cN,this,cL).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){cf(cC,this).build(),cf(cS,this).build()}destroy(){cf(cC,this).destroy(),cf(cS,this).destroy(),super.destroy()}}function cP(t,e,i,r){let n=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),s=this.hot.getSelectedRangeLast(),l=(0,y.hasClass)(t.target,"sortAction");if(!s||!o||cf(cT,this)||0!==t.button||l){cg(cT,this,!1),cf(cE,this).length=0,(0,y.removeClass)(this.hot.rootElement,[cy,cv]);return}let a=cf(cS,this).isBuilt()&&!cf(cS,this).isAppended(),h=cf(cC,this).isBuilt()&&!cf(cC,this).isAppended();a&&h&&(cf(cS,this).appendTo(n.hider),cf(cC,this).appendTo(n.hider));let{from:u,to:c}=s,d=Math.min(u.col,c.col),g=Math.max(u.col,c.col);if(e.row<0&&e.col>=d&&e.col<=g){r.column=!0,cg(cT,this,!0);let o=i.firstChild?(0,F.offsetRelativeTo)(t,i.firstChild).x:t.offsetX;cf(cx,this).eventPageX=t.pageX,cg(ck,this,e.col),cf(cx,this).TD=i,cf(cx,this).col=e.col,cg(cE,this,this.prepareColumnsToMoving(d,g)),cg(cI,this,!!this.hot.getSettings().rowHeaders),cg(cR,this,this.hot.countCols()),cg(cA,this,this.hot.getSettings().fixedColumnsStart),cg(cO,this,(0,y.offset)(this.hot.rootElement).left);let s=cf(cI,this)?-1:0,l=n.holder.scrollTop+n.getColumnHeaderHeight(0)+1,a=e.col<cf(cA,this),h=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),u=Math.abs(o-(this.hot.isRtl()?i.offsetWidth:0)),c=this.getColumnsWidth(d,e.col-1)+u,f=this.getColumnsWidth(s,d-1)+(a?h:0)+c;cf(cC,this).setPosition(l,f),cf(cC,this).setSize(this.getColumnsWidth(d,g),n.hider.offsetHeight-l),cf(cC,this).setOffset(null,-c),(0,y.addClass)(this.hot.rootElement,cy)}else(0,y.removeClass)(this.hot.rootElement,cb),cg(cT,this,!1),cf(cE,this).length=0}function c_(t){cf(cT,this)&&(cf(cx,this).eventPageX=t.pageX,this.refreshPositions())}function cD(t,e,i,r){this.hot.getSelectedRangeLast()&&cf(cT,this)&&(cf(cE,this).indexOf(e.col)>-1?(0,y.removeClass)(this.hot.rootElement,cv):(0,y.addClass)(this.hot.rootElement,cv),r.row=!0,r.column=!0,r.cell=!0,cg(ck,this,e.col),cf(cx,this).TD=i)}function cL(){let t=cf(cx,this).col,e=cf(cE,this).length;if(cg(ck,this,void 0),cg(cT,this,!1),(0,y.removeClass)(this.hot.rootElement,[cy,cv,cb]),this.hot.selection.isSelectedByColumnHeader()&&(0,y.addClass)(this.hot.rootElement,cb),e<1||void 0===t)return;let i=cf(cE,this)[0],r=this.hot.toPhysicalColumn(i),n=this.dragColumns(cf(cE,this),t);if(cf(cE,this).length=0,!0===n){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let t=this.hot.toVisualColumn(r);this.hot.selectColumns(t,t+e-1)}}function cF(){let t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1+t.holder.scrollTop;cf(cC,this).setPosition(e),cf(cC,this).setSize(null,t.hider.offsetHeight-e)}function cV(){this.moveBySettingsOrLoad()}function cW(t,e,i){cB(t,e),e.set(t,i)}function cB(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function cj(t,e,i){return t.set(cU(t,e),i),i}function cz(t,e){return t.get(cU(t,e))}function cU(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let c$="manualColumnResize",cY="manualColumnWidths";var cG=new WeakMap,cq=new WeakMap,cX=new WeakMap,cK=new WeakMap,cJ=new WeakMap,cQ=new WeakMap,cZ=new WeakMap,c0=new WeakMap,c1=new WeakMap,c2=new WeakMap,c3=new WeakMap,c9=new WeakMap,c4=new WeakMap,c5=new WeakMap,c8=new WeakMap,c7=new WeakMap,c6=new WeakSet;class dt extends eC{static get PLUGIN_KEY(){return c$}static get PLUGIN_PRIORITY(){return 130}constructor(t){super(t),function(t,e){cB(t,e),e.add(t)}(this,c6),cW(this,cG,null),cW(this,cq,null),cW(this,cX,[]),cW(this,cK,null),cW(this,cJ,null),cW(this,cQ,null),cW(this,cZ,null),cW(this,c0,null),cW(this,c1,this.hot.rootDocument.createElement("DIV")),cW(this,c2,this.hot.rootDocument.createElement("DIV")),cW(this,c3,null),cW(this,c9,!1),cW(this,c4,0),cW(this,c5,null),cW(this,c8,void 0),cW(this,c7,void 0),(0,y.addClass)(cz(c1,this),"manualColumnResizer"),(0,y.addClass)(cz(c2,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[c$]}enablePlugin(){var t=this;this.enabled||(cj(c8,this,new eO._),cz(c8,this).addLocalHook("init",()=>cU(c6,this,de).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,cz(c8,this)),this.addHook("modifyColWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return cU(c6,t,da).call(t,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return cU(c6,t,dh).call(t,...i)},1),this.addHook("beforeColumnResize",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return cU(c6,t,du).call(t,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){cj(c7,this,cz(c8,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",cY,cz(c8,this).getValues())}loadManualColumnWidths(){let t={};return this.hot.runHooks("persistentStateLoad",cY,t),t.value}setManualSize(t,e){let i=Math.max(e,20),r=this.hot.toPhysicalColumn(t);return cz(c8,this).setValueAtIndex(r,i),i}clearManualSize(t){let e=this.hot.toPhysicalColumn(t);cz(c8,this).setValueAtIndex(e,null)}setupHandlePosition(t){let e;if(!t.parentNode)return;cj(cG,this,t);let{_wt:i}=this.hot.view,r=i.wtTable.getCoords(cz(cG,this)),n=r.col;if(n<0)return;let o=(0,y.outerHeight)(cz(cG,this)),s=cz(cG,this).getBoundingClientRect();n<i.getSetting("fixedColumnsStart")&&(e=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(cz(cG,this),r.row,r.col)),e||(e=i.wtOverlays.topOverlay.getRelativeCellPosition(cz(cG,this),r.row,r.col)),cj(cq,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(n)),cj(cX,this,[]);let l=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&l){let t=this.hot.getSelectedRange();(0,z.arrayEach)(t,t=>{let e=t.getTopStartCorner().col,i=t.getBottomEndCorner().col;(0,b.rangeEach)(e,i,t=>{cz(cX,this).includes(t)||cz(cX,this).push(t)})})}cz(cX,this).includes(cz(cq,this))||cj(cX,this,[cz(cq,this)]),cj(c0,this,e.start-6),cj(cZ,this,parseInt(s.width,10)),cz(c1,this).style.top=`${e.top}px`,cz(c1,this).style[this.inlineDir]=`${cz(c0,this)+cz(cZ,this)}px`,cz(c1,this).style.height=`${o}px`,this.hot.rootElement.appendChild(cz(c1,this))}refreshHandlePosition(){cz(c1,this).style[this.inlineDir]=`${cz(c0,this)+cz(cK,this)}px`}setupGuidePosition(){let t=parseInt((0,y.outerHeight)(cz(c1,this)),10),e=parseInt(cz(c1,this).style.top,10)+t,i=this.hot.view.getTableHeight();(0,y.addClass)(cz(c1,this),"active"),(0,y.addClass)(cz(c2,this),"active"),cz(c2,this).style.top=`${e}px`,this.refreshGuidePosition(),cz(c2,this).style.height=`${i-t}px`,this.hot.rootElement.appendChild(cz(c2,this))}refreshGuidePosition(){cz(c2,this).style[this.inlineDir]=cz(c1,this).style[this.inlineDir]}hideHandleAndGuide(){(0,y.removeClass)(cz(c1,this),"active"),(0,y.removeClass)(cz(c2,this),"active")}checkIfColumnHeader(t){let e=(0,y.closest)(t,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}afterMouseDownTimeout(){let t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(e,i)=>{let r=this.hot.runHooks("beforeColumnResize",cz(cJ,this),e,!0);void 0!==r&&cj(cJ,this,r),this.setManualSize(e,cz(cJ,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",cz(cJ,this),e,!0),i&&t()};cz(c4,this)>=2&&(cz(cX,this).length>1?((0,z.arrayEach)(cz(cX,this),t=>{e(t)}),t()):(0,z.arrayEach)(cz(cX,this),t=>{e(t,!0)})),cj(c4,this,0),cj(c5,this,null)}bindEvents(){let{rootWindow:t,rootElement:e}=this.hot;this.eventManager.addEventListener(e,"mouseover",t=>cU(c6,this,di).call(this,t)),this.eventManager.addEventListener(e,"mousedown",t=>cU(c6,this,dr).call(this,t)),this.eventManager.addEventListener(t,"mousemove",t=>cU(c6,this,dn).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>cU(c6,this,ds).call(this)),this.eventManager.addEventListener(cz(c1,this),"contextmenu",()=>cU(c6,this,dl).call(this))}destroy(){super.destroy()}}function de(){let t=this.hot.getSettings()[c$],e=this.loadManualColumnWidths();void 0!==e?this.hot.batchExecution(()=>{e.forEach((t,e)=>{cz(c8,this).setValueAtIndex(e,t)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((t,e)=>{cz(c8,this).setValueAtIndex(e,t)})},!0),cj(c7,this,t)):!0===t&&Array.isArray(cz(c7,this))&&this.hot.batchExecution(()=>{cz(c7,this).forEach((t,e)=>{cz(c8,this).setValueAtIndex(e,t)})},!0)}function di(t){if(!(0,y.isDetached)(t.target)&&!0!==cz(c9,this)&&this.checkIfColumnHeader(t.target)){let e=this.getClosestTHParent(t.target);if(!e)return;let i=e.getAttribute("colspan");e&&(null===i||"1"===i)&&!cz(c3,this)&&this.setupHandlePosition(e)}}function dr(t){t.target.parentNode===this.hot.rootElement&&(0,y.hasClass)(t.target,"manualColumnResizer")&&(this.setupHandlePosition(cz(cG,this)),this.setupGuidePosition(),cj(c3,this,!0),null===cz(c5,this)&&(cj(c5,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(cz(c5,this))),cj(c4,this,cz(c4,this)+1),this.startX=t.pageX,cj(cJ,this,cz(cZ,this)))}function dn(t){if(cz(c3,this)){let e=(t.pageX-this.startX)*this.hot.getDirectionFactor();cj(cK,this,cz(cZ,this)+e),(0,z.arrayEach)(cz(cX,this),t=>{cj(cJ,this,this.setManualSize(t,cz(cK,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function ds(){let t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(e,i)=>{this.hot.runHooks("beforeColumnResize",cz(cJ,this),e,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",cz(cJ,this),e,!1)};cz(c3,this)&&(this.hideHandleAndGuide(),cj(c3,this,!1),cz(cJ,this)!==cz(cZ,this)&&(cz(cX,this).length>1?((0,z.arrayEach)(cz(cX,this),t=>{e(t)}),t()):(0,z.arrayEach)(cz(cX,this),t=>{e(t,!0)})),this.setupHandlePosition(cz(cG,this)))}function dl(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(cz(c1,this)),this.hot.rootElement.removeChild(cz(c2,this)),cj(c3,this,!1),cj(c9,this,!0),this.hot._registerImmediate(()=>{cj(c9,this,!1)})}function da(t,e){let i=t;if(this.enabled){let t=this.hot.toPhysicalColumn(e),r=cz(c8,this).getValueAtIndex(t);this.hot.getSettings()[c$]&&r&&(i=r)}return i}function dh(t,e){let i=cz(c8,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return"number"==typeof i?i:t}function du(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function dc(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class dd{constructor(t){dc(this,"hot",void 0),dc(this,"_element",null),dc(this,"state",0),this.hot=t}appendTo(t){t.appendChild(this._element),this.state=2}build(){0===this.state&&(this._element=this.hot.rootDocument.createElement("div"),this.state=1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=0}isAppended(){return 2===this.state}isBuilt(){return this.state>=1}setPosition(t,e){void 0!==t&&(this._element.style.top=t+"px"),void 0!==e&&(this._element.style.left=e+"px")}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(t,e){t&&(this._element.style.width=t+"px"),e&&(this._element.style.height=e+"px")}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(t,e){t&&(this._element.style.marginTop=t+"px"),e&&(this._element.style.marginLeft=e+"px")}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}}let dg=dd;class df extends dg{build(){super.build(),(0,y.addClass)(this._element,"ht__manualRowMove--backlight")}}class dp extends dg{build(){super.build(),(0,y.addClass)(this._element,"ht__manualRowMove--guideline")}}function dm(t,e,i){dw(t,e),e.set(t,i)}function dw(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function dv(t,e,i){return t.set(db(t,e),i),i}function dy(t,e){return t.get(db(t,e))}function db(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeRowMove"),d.R.getSingleton().register("afterRowMove");let dC="manualRowMove",dS="ht__manualRowMove",dE="show-ui",dR="on-moving--rows",dT="after-selection--rows";var dx=new WeakMap,dM=new WeakMap,dk=new WeakMap,dO=new WeakMap,dI=new WeakMap,dA=new WeakMap,dN=new WeakSet;class dH extends eC{constructor(){super(...arguments),function(t,e){dw(t,e),e.add(t)}(this,dN),dm(this,dx,new df(this.hot)),dm(this,dM,new dp(this.hot)),dm(this,dk,[]),dm(this,dO,void 0),dm(this,dI,{}),dm(this,dA,void 0)}static get PLUGIN_KEY(){return dC}static get PLUGIN_PRIORITY(){return 140}isEnabled(){return!!this.hot.getSettings()[dC]}enablePlugin(){var t=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return db(dN,t,dP).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return db(dN,t,dD).call(t,...i)}),this.addHook("afterScrollHorizontally",()=>db(dN,this,dF).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return db(dN,t,dV).call(t,...i)}),this.buildPluginUI(),this.registerEvents(),(0,y.addClass)(this.hot.rootElement,dS),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){(0,y.removeClass)(this.hot.rootElement,dS),this.unregisterEvents(),dy(dx,this).destroy(),dy(dM,this).destroy(),super.disablePlugin()}moveRow(t,e){return this.moveRows([t],e)}moveRows(t,e){let i=dy(dA,this),r=this.isMovePossible(t,e),n=this.hot.runHooks("beforeRowMove",t,e,i,r);if(dv(dA,this,void 0),!1===n)return;r&&this.hot.rowIndexMapper.moveIndexes(t,e);let o=r&&this.isRowOrderChanged(t,e);return this.hot.runHooks("afterRowMove",t,e,i,r,o),o}dragRow(t,e){return this.dragRows([t],e)}dragRows(t,e){let i=this.countFinalIndex(t,e);return dv(dA,this,e),this.moveRows(t,i)}isMovePossible(t,e){let i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=t.length+e>i,n=t.some(t=>t<0),o=t.some(t=>t>=i);return!r&&!(e<0)&&!n&&!o}isRowOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}countFinalIndex(t,e){let i=(0,z.arrayReduce)(t,(t,i)=>(i<e&&(t+=1),t),0);return e-i}getRowsHeight(t,e){let i=this.hot.rowIndexMapper,r=0;for(let n=t;n<=e;n++){let t=i.getRenderableFromVisualIndex(n);null!==t&&(r+=this.hot.view._wt.wtTable.getRowHeight(t)||this.hot.view.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){let t=this.hot.getSettings()[dC];if(Array.isArray(t))this.moveRows(t,0);else if(void 0!==t){let t=this.persistentStateLoad();t.length&&this.moveRows(t,0)}}isFixedRowTop(t){return t<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(t){return t>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){let t={};return this.hot.runHooks("persistentStateLoad","manualRowMove",t),t.value?t.value:[]}prepareRowsToMoving(){let t=this.hot.getSelectedRangeLast(),e=[];if(!t)return e;let{from:i,to:r}=t,n=Math.min(i.row,r.row),o=Math.max(i.row,r.row);return(0,b.rangeEach)(n,o,t=>{e.push(t)}),e}refreshPositions(){let t=dy(dI,this).coords,e=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(t.row)&&e>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(e-1,-1)),this.isFixedRowBottom(t.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);let n=this.hot.view._wt.wtTable,o=dy(dI,this).TD,s=this.hot.rootElement,l=(0,y.offset)(s),a=(0,y.getTrimmingContainer)(s),h=n.holder.scrollTop,u=this.hot.rootWindow!==a?a.scrollTop:0,c=l.top-u,d=dy(dI,this).eventPageY-c+h,g=n.hider.offsetHeight,f=n.TBODY.offsetTop,p=dy(dx,this).getOffset().top,m=dy(dx,this).getSize().height,w=o.offsetHeight/2,b=o.offsetHeight,C=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,t.row-1),S=d>=C+w;this.isFixedRowTop(t.row)&&(C+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),t.row<0?dy(dI,this).row=e>0?e-1:e:S?(dy(dI,this).row=t.row+1,C+=0===t.row?b-1:b):dy(dI,this).row=t.row;let E=d,R=C;d+m+p>=g?E=g-m-p:d+p<f&&(E=f+Math.abs(p)),C>=g-1&&(R=g-1),dy(dx,this).setPosition(E),dy(dM,this).setPosition(R)}registerEvents(){let{documentElement:t}=this.hot.rootDocument;this.eventManager.addEventListener(t,"mousemove",t=>db(dN,this,d_).call(this,t)),this.eventManager.addEventListener(t,"mouseup",()=>db(dN,this,dL).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){dy(dx,this).build(),dy(dM,this).build()}destroy(){dy(dx,this).destroy(),dy(dM,this).destroy(),super.destroy()}}function dP(t,e,i,r){let{wtTable:n,wtViewport:o}=this.hot.view._wt,s=this.hot.selection.isSelectedByRowHeader(),l=this.hot.getSelectedRangeLast();if(!l||!s||dy(dO,this)||0!==t.button){dv(dO,this,!1),dy(dk,this).length=0,(0,y.removeClass)(this.hot.rootElement,[dR,dE]);return}let a=dy(dM,this).isBuilt()&&!dy(dM,this).isAppended(),h=dy(dx,this).isBuilt()&&!dy(dx,this).isAppended();a&&h&&(dy(dM,this).appendTo(n.hider),dy(dx,this).appendTo(n.hider));let{from:u,to:c}=l,d=Math.min(u.row,c.row),g=Math.max(u.row,c.row);if(e.col<0&&e.row>=d&&e.row<=g){r.row=!0,dv(dO,this,!0),dy(dI,this).eventPageY=t.pageY,dy(dI,this).coords=e,dy(dI,this).TD=i,dv(dk,this,this.prepareRowsToMoving());let s=n.holder.scrollLeft+o.getRowHeaderWidth(),l=this.getRowsHeight(d,e.row-1)+(t.clientY-i.getBoundingClientRect().top);dy(dx,this).setPosition(null,s),dy(dx,this).setSize(n.hider.offsetWidth-s,this.getRowsHeight(d,g)),dy(dx,this).setOffset(-l,null),(0,y.addClass)(this.hot.rootElement,dR),this.refreshPositions()}else(0,y.removeClass)(this.hot.rootElement,dT),dv(dO,this,!1),dy(dk,this).length=0}function d_(t){dy(dO,this)&&(dy(dI,this).eventPageY=t.pageY,this.refreshPositions())}function dD(t,e,i,r){this.hot.getSelectedRangeLast()&&dy(dO,this)&&(dy(dk,this).indexOf(e.row)>-1?(0,y.removeClass)(this.hot.rootElement,dE):(0,y.addClass)(this.hot.rootElement,dE),r.row=!0,r.column=!0,r.cell=!0,dy(dI,this).coords=e,dy(dI,this).TD=i)}function dL(){let t=dy(dI,this).row,e=dy(dk,this).length;if(dv(dO,this,!1),(0,y.removeClass)(this.hot.rootElement,[dR,dE,dT]),this.hot.selection.isSelectedByRowHeader()&&(0,y.addClass)(this.hot.rootElement,dT),e<1||void 0===t)return;let i=dy(dk,this)[0],r=this.hot.toPhysicalRow(i),n=this.dragRows(dy(dk,this),t);if(dy(dk,this).length=0,!0===n){this.persistentStateSave(),this.hot.render(),this.hot.view.adjustElementsSize();let t=this.hot.toVisualRow(r);this.hot.selectRows(t,t+e-1)}}function dF(){let t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth()+t.holder.scrollLeft;dy(dx,this).setPosition(null,e),dy(dx,this).setSize(t.hider.offsetWidth-e)}function dV(){this.moveBySettingsOrLoad()}function dW(t,e,i){dB(t,e),e.set(t,i)}function dB(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function dj(t,e,i){return t.set(dU(t,e),i),i}function dz(t,e){return t.get(dU(t,e))}function dU(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let d$="manualRowResize",dY="manualRowHeights";var dG=new WeakMap,dq=new WeakMap,dX=new WeakMap,dK=new WeakMap,dJ=new WeakMap,dQ=new WeakMap,dZ=new WeakMap,d0=new WeakMap,d1=new WeakMap,d2=new WeakMap,d3=new WeakMap,d9=new WeakMap,d4=new WeakMap,d5=new WeakMap,d8=new WeakMap,d7=new WeakMap,d6=new WeakSet;class gt extends eC{static get PLUGIN_KEY(){return d$}static get PLUGIN_PRIORITY(){return 30}constructor(t){super(t),function(t,e){dB(t,e),e.add(t)}(this,d6),dW(this,dG,null),dW(this,dq,null),dW(this,dX,[]),dW(this,dK,null),dW(this,dJ,null),dW(this,dQ,null),dW(this,dZ,null),dW(this,d0,null),dW(this,d1,this.hot.rootDocument.createElement("DIV")),dW(this,d2,this.hot.rootDocument.createElement("DIV")),dW(this,d3,!1),dW(this,d9,!1),dW(this,d4,0),dW(this,d5,null),dW(this,d8,void 0),dW(this,d7,void 0),(0,y.addClass)(dz(d1,this),"manualRowResizer"),(0,y.addClass)(dz(d2,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[d$]}enablePlugin(){this.enabled||(dj(d8,this,new eO._),dz(d8,this).addLocalHook("init",()=>dU(d6,this,gl).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,dz(d8,this)),this.addHook("modifyRowHeight",(t,e)=>dU(d6,this,gs).call(this,t,e)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){dj(d7,this,dz(d8,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",dY,dz(d8,this).getValues())}loadManualRowHeights(){let t={};return this.hot.runHooks("persistentStateLoad",dY,t),t.value}setManualSize(t,e){let i=this.hot.toPhysicalRow(t),r=Math.max(e,this.hot.view.getDefaultRowHeight());return dz(d8,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return dz(dK,this)}setupHandlePosition(t){let e;dj(dG,this,t);let{view:i}=this.hot,{_wt:r}=i,n=r.wtTable.getCoords(dz(dG,this)),o=n.row;if(o<0)return;let s=(0,y.outerWidth)(dz(dG,this)),l=dz(dG,this).getBoundingClientRect(),a=o<r.getSetting("fixedRowsTop"),h=o>=i.countNotHiddenRowIndexes(0,1)-r.getSetting("fixedRowsBottom");a?e=r.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(dz(dG,this),n.row,n.col):h&&(e=r.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(dz(dG,this),n.row,n.col)),e||(e=r.wtOverlays.inlineStartOverlay.getRelativeCellPosition(dz(dG,this),n.row,n.col)),dj(dq,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),dj(dX,this,[]);let u=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&u){let t=this.hot.getSelectedRange();(0,z.arrayEach)(t,t=>{let e=t.getTopStartCorner().row,i=t.getBottomStartCorner().row;(0,b.rangeEach)(e,i,t=>{dz(dX,this).includes(t)||dz(dX,this).push(t)})})}dz(dX,this).includes(dz(dq,this))||dj(dX,this,[dz(dq,this)]),dj(d0,this,e.top-6),dj(dZ,this,parseInt(l.height,10)),dz(d1,this).style.top=`${dz(d0,this)+dz(dZ,this)}px`,dz(d1,this).style[this.inlineDir]=`${e.start}px`,dz(d1,this).style.width=`${s}px`,this.hot.rootElement.appendChild(dz(d1,this))}refreshHandlePosition(){dz(d1,this).style.top=`${dz(d0,this)+dz(dK,this)}px`}setupGuidePosition(){let t=parseInt((0,y.outerWidth)(dz(d1,this)),10),e=parseInt(dz(d1,this).style[this.inlineDir],10)+t,i=this.hot.view.getTableWidth();(0,y.addClass)(dz(d1,this),"active"),(0,y.addClass)(dz(d2,this),"active"),dz(d2,this).style.top=dz(d1,this).style.top,dz(d2,this).style[this.inlineDir]=`${e}px`,dz(d2,this).style.width=`${i-t}px`,this.hot.rootElement.appendChild(dz(d2,this))}refreshGuidePosition(){dz(d2,this).style.top=dz(d1,this).style.top}hideHandleAndGuide(){(0,y.removeClass)(dz(d1,this),"active"),(0,y.removeClass)(dz(d2,this),"active")}checkIfRowHeader(t){let e=(0,y.closest)(t,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,n.clone.wtTable.TBODY].includes(e)}getClosestTHParent(t){return"TABLE"!==t.tagName?"TH"===t.tagName?t:this.getClosestTHParent(t.parentNode):null}getActualRowHeight(t){let e=this.hot.view._wt.wtTable.getRowHeight(t);return void 0!==e&&dz(dJ,this)<e?e:dz(dJ,this)}afterMouseDownTimeout(){let t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(e,i)=>{let r=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!0);void 0!==r&&dj(dJ,this,r),this.setManualSize(e,dz(dJ,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!0),i&&t()};dz(d4,this)>=2&&(dz(dX,this).length>1?((0,z.arrayEach)(dz(dX,this),t=>{e(t)}),t()):(0,z.arrayEach)(dz(dX,this),t=>{e(t,!0)})),dj(d4,this,0),dj(d5,this,null)}bindEvents(){let{rootElement:t,rootWindow:e}=this.hot;this.eventManager.addEventListener(t,"mouseover",t=>dU(d6,this,ge).call(this,t)),this.eventManager.addEventListener(t,"mousedown",t=>dU(d6,this,gi).call(this,t)),this.eventManager.addEventListener(e,"mousemove",t=>dU(d6,this,gr).call(this,t)),this.eventManager.addEventListener(e,"mouseup",()=>dU(d6,this,gn).call(this)),this.eventManager.addEventListener(dz(d1,this),"contextmenu",()=>dU(d6,this,go).call(this))}destroy(){super.destroy()}}function ge(t){if(!(0,y.isDetached)(t.target)&&!0!==dz(d9,this)&&this.checkIfRowHeader(t.target)){let e=this.getClosestTHParent(t.target);e&&!dz(d3,this)&&this.setupHandlePosition(e)}}function gi(t){(0,y.hasClass)(t.target,"manualRowResizer")&&(this.setupHandlePosition(dz(dG,this)),this.setupGuidePosition(),dj(d3,this,!0),null===dz(d5,this)&&(dj(d5,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(dz(d5,this))),dj(d4,this,dz(d4,this)+1),dj(dQ,this,t.pageY),dj(dJ,this,dz(dZ,this)))}function gr(t){dz(d3,this)&&(dj(dK,this,dz(dZ,this)+(t.pageY-dz(dQ,this))),(0,z.arrayEach)(dz(dX,this),t=>{dj(dJ,this,this.setManualSize(t,dz(dK,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function gn(){let t=()=>{this.hot.render(),this.hot.view.adjustElementsSize()},e=(e,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(e),e,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(e),e,!1)};dz(d3,this)&&(this.hideHandleAndGuide(),dj(d3,this,!1),dz(dJ,this)!==dz(dZ,this)&&(dz(dX,this).length>1?((0,z.arrayEach)(dz(dX,this),t=>{e(t)}),t()):(0,z.arrayEach)(dz(dX,this),t=>{e(t,!0)})),this.setupHandlePosition(dz(dG,this)))}function go(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(dz(d1,this)),this.hot.rootElement.removeChild(dz(d2,this)),dj(d3,this,!1),dj(d9,this,!0),this.hot._registerImmediate(()=>{dj(d9,this,!1)})}function gs(t,e){let i=t;if(this.enabled){let t=this.hot.toPhysicalRow(e),r=dz(d8,this).getValueAtIndex(t);this.hot.getSettings()[d$]&&r&&(i=r)}return i}function gl(){let t=this.hot.getSettings()[d$],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{void 0!==e?e.forEach((t,e)=>{dz(d8,this).setValueAtIndex(e,t)}):Array.isArray(t)?(t.forEach((t,e)=>{dz(d8,this).setValueAtIndex(e,t)}),dj(d7,this,t)):!0===t&&Array.isArray(dz(d7,this))&&dz(d7,this).forEach((t,e)=>{dz(d8,this).setValueAtIndex(e,t)})},!0)}function ga(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(55289),i(34760);function gh(t,e,i){return t.set(gu(t,e),i),i}function gu(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var gc=new WeakMap;class gd{constructor(t,e,i,r,n,o){ga(this,"row",void 0),ga(this,"col",void 0),ga(this,"rowspan",void 0),ga(this,"colspan",void 0),ga(this,"removed",!1),ga(this,"cellCoordsFactory",void 0),ga(this,"cellRangeFactory",void 0),function(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,null)}(this,gc,0),this.row=t,this.col=e,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=n,this.cellRangeFactory=o}static NEGATIVE_VALUES_WARNING(t){let{row:e,col:i,rowspan:r,colspan:n}=t;return(0,ro.O)`The merged cell declared with {row: ${e}, col: ${i},\x20
      rowspan: ${r}, colspan: ${n}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(t){let{row:e,col:i}=t;return(0,ro.O)`The merged cell declared at [${e}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(t){let{row:e,col:i}=t;return(0,ro.O)`The merged cell declared at [${e}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(t){let{row:e,col:i}=t;return(0,ro.O)`The merged cell declared at [${e}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(t){let{row:e,col:i,rowspan:r,colspan:n}=t;return e<0||i<0||r<0||n<0}static isSingleCell(t){let{rowspan:e,colspan:i}=t;return 1===i&&1===e}static containsZeroSpan(t){let{rowspan:e,colspan:i}=t;return 0===i||0===e}static isOutOfBounds(t,e,i){return t.row<0||t.col<0||t.row>=e||t.row+t.rowspan-1>=e||t.col>=i||t.col+t.colspan-1>=i}normalize(t){let e=t.countRows(),i=t.countCols();this.row<0?this.row=0:this.row>e-1&&(this.row=e-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>e-1&&(this.rowspan=e-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),gh(gc,this,null)}includes(t,e){return this.row<=t&&this.col<=e&&this.row+this.rowspan-1>=t&&this.col+this.colspan-1>=e}includesHorizontally(t){return this.col<=t&&this.col+this.colspan-1>=t}includesVertically(t){return this.row<=t&&this.row+this.rowspan-1>=t}shift(t,e){let i=t[0]||t[1],r=e+Math.abs(t[0]||t[1])-1,n=t[0]?"colspan":"rowspan",o=t[0]?"col":"row",s=Math.min(e,r),l=Math.max(e,r),a=this[o],h=this[o]+this[n]-1;if(a>=e&&(this[o]+=i),i>0)e<=h&&e>a&&(this[n]+=i);else if(i<0)if(s<=a&&l>=h)return this.removed=!0,gh(gc,this,null),!1;else if(a>=s&&a<=l){let t=l-a+1,e=Math.abs(i)-t;this[o]-=e+i,this[n]-=t}else a<=s&&h>=l?this[n]+=i:a<=s&&h>=s&&h<l&&(this[n]-=h-s+1);return gh(gc,this,null),!0}isFarther(t,e){return!t||("down"===e?t.row+t.rowspan-1<this.row+this.rowspan-1:"up"===e?t.row>this.row:"right"===e?t.col+t.colspan-1<this.col+this.colspan-1:"left"===e?t.col>this.col:null)}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return!gc.get(gu(gc,this))&&gh(gc,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),gc.get(gu(gc,this))}}function gg(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function gf(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var gp=new WeakSet;class gm{constructor(t){!function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,gp),gg(this,"plugin",void 0),gg(this,"mergedCells",[]),gg(this,"mergedCellsMatrix",new Map),gg(this,"hot",void 0),this.plugin=t,this.hot=t.hot}static IS_OVERLAPPING_WARNING(t){let{row:e,col:i}=t;return(0,ro.O)`The merged cell declared at [${e}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(t,e){var i;return!!this.mergedCellsMatrix.has(t)&&null!==(i=this.mergedCellsMatrix.get(t).get(e))&&void 0!==i&&i}getByRange(t){let{row:e,col:i}=t.getTopStartCorner(),{row:r,col:n}=t.getBottomEndCorner(),o=this.mergedCells.length,s=!1;for(let t=0;t<o;t++){let o=this.mergedCells[t],{row:l,col:a,rowspan:h,colspan:u}=o;if(l>=e&&l+h-1<=r&&a>=i&&a+u-1<=n){s=o;break}}return s}filterOverlappingMergeCells(t){let e=new Set;return this.mergedCells.forEach(t=>{let{row:i,col:r,colspan:n,rowspan:o}=t;for(let t=i;t<i+o;t++)for(let i=r;i<r+n;i++)e.add(`r${t},c${i}`)}),t.filter(t=>{let{row:i,col:r,colspan:n,rowspan:o}=t,s=new Set,l=!1;for(let a=i;a<i+o;a++){for(let i=r;i<r+n;i++){let r=`r${a},c${i}`;if(e.has(r)){(0,iD.R8)(gm.IS_OVERLAPPING_WARNING(t)),l=!0;break}s.add(r)}if(l)break}return l||e.add(...s),!l})}getWithinRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{row:i,col:r}=t.getTopStartCorner(),{row:n,col:o}=t.getBottomEndCorner(),s=[];for(let t=i;t<=n;t++)for(let i=r;i<=o;i++){let r=this.get(t,i);r&&(e||!e&&r.row===t&&r.col===i)&&s.push(r)}return s}add(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=t.row,r=t.col,n=new gd(i,r,t.rowspan,t.colspan,this.hot._createCellCoords,this.hot._createCellRange),o=this.get(i,r),s=!e&&this.isOverlapping(n);return o||s?(s&&(0,iD.R8)(gm.IS_OVERLAPPING_WARNING(n)),!1):(this.hot&&n.normalize(this.hot),this.mergedCells.push(n),gf(gp,this,gv).call(this,n),n)}remove(t,e){let i=this.get(t,e),r=i?this.mergedCells.indexOf(i):-1;return!!i&&-1!==r&&(this.mergedCells.splice(r,1),gf(gp,this,gy).call(this,i),i)}clear(){(0,z.arrayEach)(this.mergedCells,t=>{let{row:e,col:i,rowspan:r,colspan:n}=t;(0,b.rangeEach)(e,e+r,t=>{(0,b.rangeEach)(i,i+n,e=>{let i=this.hot.getCell(t,e);i&&(i.removeAttribute("rowspan"),i.removeAttribute("colspan"),i.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(t){let e=t.getRange();for(let t=0;t<this.mergedCells.length;t++)if(this.mergedCells[t].getRange().overlaps(e))return!0;return!1}isFirstRenderableMergedCell(t,e){let i=this.get(t,e);if(!i)return!1;let{row:r,col:n,rowspan:o,colspan:s}=i,l=this.hot.view.getActiveOverlayName(),a=["top","top_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleRow(),h=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(l)?0:this.hot.getFirstRenderedVisibleColumn(),u=(0,b.clamp)(a,r,r+o-1),c=(0,b.clamp)(h,n,n+s-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(u,1)===t&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(c,1)===e}getFirstRenderableCoords(t,e){let i=this.get(t,e);if(!i||this.isFirstRenderableMergedCell(t,e))return this.hot._createCellCoords(t,e);let r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),n=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,n)}getStartMostColumnIndex(t,e){let i=gf(gp,this,gw).call(this,t,"col",-1),r=e;for(let t=0;t<i.length;t++)if(i[t]<=e){r=i[t];break}return r}getEndMostColumnIndex(t,e){let i=gf(gp,this,gw).call(this,t,"col",1),r=e;for(let t=0;t<i.length;t++)if(i[t]>=e){r=i[t];break}return r}getTopMostRowIndex(t,e){let i=gf(gp,this,gw).call(this,t,"row",-1),r=e;for(let t=0;t<i.length;t++)if(i[t]<=e){r=i[t];break}return r}getBottomMostRowIndex(t,e){let i=gf(gp,this,gw).call(this,t,"row",1),r=e;for(let t=0;t<i.length;t++)if(i[t]>=e){r=i[t];break}return r}shiftCollections(t,e,i){let r=[0,0];switch(t){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i}let n=[];this.mergedCells.forEach(t=>{t.shift(r,e),t.removed&&n.push(t)}),n.forEach(t=>{this.mergedCells.splice(this.mergedCells.indexOf(t),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(t=>{gf(gp,this,gv).call(this,t)})}}function gw(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=new Map,n=1===i?t.getTopStartCorner():t.getBottomEndCorner(),o=1===i?t.getBottomEndCorner():t.getTopStartCorner();for(let t=n.row;1===i?t<=o.row:t>=o.row;t+=i)for(let s=n.col;1===i?s<=o.col:s>=o.col;s+=i){let n="row"===e?t:s,o=this.get(t,s),l=n;o&&(l=1===i?o[e]+o[`${e}span`]-1:o[e]),r.has(n)||r.set(n,new Set),r.get(n).add(l)}return Array.from(new Set(Array.from(r.entries()).filter(t=>{let[,e]=t;return 1===e.size}).flatMap(t=>{let[,e]=t;return Array.from(e)})))}function gv(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let i=t.col;i<t.col+t.colspan;i++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(i,t)}function gy(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let i=t.col;i<t.col+t.colspan;i++)this.mergedCellsMatrix.get(e).delete(i)}function gb(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class gC{constructor(t){gb(this,"plugin",void 0),gb(this,"mergedCellsCollection",void 0),gb(this,"currentFillData",null),this.plugin=t,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(t,e){let i=null;return e[0]===t[0]&&e[1]===t[1]&&e[3]===t[3]?"down":e[2]===t[2]&&e[1]===t[1]&&e[3]===t[3]?"up":e[1]===t[1]&&e[2]===t[2]?"right":"left"}snapDragArea(t,e,i,r){let n=e.slice(0),o=this.getAutofillSize(t,e,i),[s,l,a,h]=t,u=["up","down"].indexOf(i)>-1?a-s+1:h-l+1,c=Math.floor(o/u)*u,d=o-c,g=this.getFarthestCollection(t,e,i,r);if(g){if("down"===i){let t=g.row+g.rowspan-s-d;n[2]+t>=this.plugin.hot.countRows()?n[2]-=d:n[2]+=d?t:0}else if("right"===i){let t=g.col+g.colspan-l-d;n[3]+t>=this.plugin.hot.countCols()?n[3]-=d:n[3]+=d?t:0}else if("up"===i){let t=a-d-g.row+1;n[0]+t<0?n[0]+=d:n[0]-=d?t:0}else if("left"===i){let t=h-d-g.col+1;n[1]+t<0?n[1]+=d:n[1]-=d?t:0}}return this.updateCurrentFillCache({baseArea:t,dragDirection:i,foundMergedCells:r,fillSize:o,dragArea:n,cycleLength:u}),n}updateCurrentFillCache(t){this.currentFillData||(this.currentFillData={}),(0,V.extend)(this.currentFillData,t)}getAutofillSize(t,e,i){let[r,n,o,s]=t,[l,a,h,u]=e;switch(i){case"up":return r-l;case"down":return h-o;case"left":return n-a;case"right":return u-s;default:return null}}getDragArea(t,e,i){let[r,n,o,s]=t,[l,a,h,u]=e;switch(i){case"up":return[l,a,r-1,s];case"down":{let t=this.mergedCellsCollection.get(h,s);return[o+1,n,h+(t?t.rowspan-1:0),s]}case"left":return[l,a,o,n-1];case"right":{let t=this.mergedCellsCollection.get(h,s);return[r,s+(t?t.colspan-1:0),h,u]}default:return null}}getFarthestCollection(t,e,i,r){let[n,o,s,l]=t,a=["up","down"].indexOf(i)>-1,h=a?s:l,u=a?n:o,c=this.getAutofillSize(t,e,i),d=a?s-n+1:l-o+1,g=Math.floor(c/d)*d,f=c-g,p=null,m=null,w=null;switch(i){case"up":p="includesVertically",w=h-f+1;break;case"left":p="includesHorizontally",w=h-f+1;break;case"down":p="includesVertically",w=u+f-1;break;case"right":p="includesHorizontally",w=u+f-1}return(0,z.arrayEach)(r,t=>{t[p](w)&&t.isFarther(m,i)&&(m=t)}),m}recreateAfterDataPopulation(t){if(!this.currentFillData)return;let e=this.getRangeFromChanges(t),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,n=(t,i)=>{switch(r){case"up":return t.row-i>=e.from.row;case"down":return t.row+t.rowspan-1+i<=e.to.row;case"left":return t.col-i>=e.from.column;case"right":return t.col+t.colspan-1+i<=e.to.column;default:return null}},o=0,s=null,l=1;do for(let t=0;t<i.length;t+=1){if(n(s=i[t],o=l*this.currentFillData.cycleLength))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:s.row-o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:s.row+o,rowspan:s.rowspan,col:s.col,colspan:s.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col-o,colspan:s.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:s.row,rowspan:s.rowspan,col:s.col+o,colspan:s.colspan},!0)}t===i.length-1&&(l+=1)}while(n(s,o));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(t){let e={min:null,max:null},i={min:null,max:null};return(0,z.arrayEach)(t,t=>{let r=t[0],n=this.plugin.hot.propToCol(t[1]);(null===e.min||r<e.min)&&(e.min=r),(null===e.max||r>e.max)&&(e.max=r),(null===i.min||n<i.min)&&(i.min=n),(null===i.max||n>i.max)&&(i.max=n)}),{from:{row:e.min,column:i.min},to:{row:e.max,column:i.max}}}dragAreaOverlapsCollections(t,e,i){let[r,n,o,s]=this.getDragArea(t,e,i),l=this.plugin.hot._createCellCoords(r,n),a=this.plugin.hot._createCellCoords(o,s),h=this.plugin.hot._createCellRange(l,l,a);if(0===this.mergedCellsCollection.getWithinRange(h,!0).length)return!1;let u=this.mergedCellsCollection.getWithinRange(h,!1);return 0===u.length||("up"===i||"down"===i?!u.every(t=>{let{colspan:e}=t;return e===h.getWidth()}):!u.every(t=>{let{rowspan:e}=t;return e===h.getHeight()}))}}function gS(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class gE{constructor(t){gS(this,"plugin",void 0),gS(this,"hot",void 0),gS(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=t,this.hot=t.hot}getSelectedMergedCellClassName(t,e,i,r){let n=Math.min(i[0],i[2]),o=Math.min(i[1],i[3]),s=Math.max(i[0],i[2]),l=Math.max(i[1],i[3]);if(void 0===r||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(t,e))return;let a=this.plugin.mergedCellsCollection.get(t,e);if(!a)return;let h=a.getLastRow(),u=a.getLastColumn();return n<=a.row&&o<=a.col&&s>=h&&l>=u?`${this.fullySelectedMergedCellClassName}-${r}`:this.isMergeCellFullySelected(a,this.plugin.hot.getSelectedRange())?`${this.fullySelectedMergedCellClassName}-multiple`:void 0}isMergeCellFullySelected(t,e){let i=[];if(!e||!t)return!1;for(let e=0;e<t.rowspan;e+=1)for(let r=0;r<t.colspan;r+=1)i.push(this.hot._createCellCoords(t.row+e,t.col+r));for(let t=0;t<i.length;t+=1){let r=[];for(let n=0;n<e.length;n+=1)r[n]=e[n].includes(i[t]);if(!r.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){let t=[];for(let e=0;e<=7;e+=1)t.push(`${this.fullySelectedMergedCellClassName}-${e}`);return t.push(`${this.fullySelectedMergedCellClassName}-multiple`),t}}function gR(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class gT{constructor(t){gR(this,"data",void 0),gR(this,"next",null),gR(this,"prev",null),this.data=t}}class gx{constructor(){gR(this,"first",null),gR(this,"last",null)}push(t){let e=new gT(t);if(null===this.first)this.first=e,this.last=e;else{let t=this.last;this.last=e,e.prev=t,t.next=e}return e}unshift(t){let e=new gT(t);if(null===this.first)this.first=e,this.last=e;else{let t=this.first;this.first=e,e.next=t,t.prev=e}}inorder(t){let e=this.first;for(;e;){let i=t(e);if(e===this.last||!0===i)break;e=e.next}}remove(t){let e,i;if(null===this.first)return!1;let r=this.first;for(;r;){if(r.data===t)return e=r.next,i=r.prev,e&&(e.prev=i),i&&(i.next=e),r===this.first&&(this.first=e),r===this.last&&(this.last=i),!0;r=r.next}return!1}hasCycle(){let t=this.first,e=this.first;for(;;){if(null===t||null===(t=t.next))return!1;if((t=t.next)===(e=e.next))return!0}}pop(){if(null===this.last)return null;let t=this.last;return this.last=this.last.prev,t}shift(){if(null===this.first)return null;let t=this.first;return this.first=this.first.next,t}recursiveReverse(){if(!this.first)return;!function t(e,i){i&&(t(i,i.next),i.next=e)}(this.first,this.first.next),this.first.next=null;let t=this.first;this.first=this.last,this.last=t}reverse(){let t;if(!this.first||!this.first.next)return;let e=this.first.next,i=this.first;for(;e;)t=e.next,e.next=i,i.prev=e,i=e,e=t;this.first.next=null,this.last.prev=null,t=this.first,this.first=i,this.last=t}}function gM(t,e,i){gk(t,e),e.set(t,i)}function gk(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function gO(t,e){return t.get(gA(t,e))}function gI(t,e,i){return t.set(gA(t,e),i),i}function gA(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var gN=new WeakMap,gH=new WeakMap,gP=new WeakMap,g_=new WeakMap,gD=new WeakMap,gL=new WeakMap,gF=new WeakMap,gV=new WeakSet;class gW{constructor(t){let{mergedCellsGetter:e,rowIndexMapper:i,columnIndexMapper:r}=t;!function(t,e){gk(t,e),e.add(t)}(this,gV),gM(this,gN,new gx),gM(this,gH,new gx),gM(this,gP,null),gM(this,g_,null),gM(this,gD,null),gM(this,gL,null),gM(this,gF,null),gI(gD,this,e),gI(gL,this,i),gI(gF,this,r)}getCurrentVerticalNode(){return gO(g_,this).data}getFirstVerticalNode(){return gO(gH,this).first.data}getNextVerticalNode(){return gO(g_,this).next.data}getPrevVerticalNode(){return gO(g_,this).prev.data}getCurrentHorizontalNode(){return gO(gP,this).data}getFirstHorizontalNode(){return gO(gN,this).first.data}getNextHorizontalNode(){return gO(gP,this).next.data}getPrevHorizontalNode(){return gO(gP,this).prev.data}setPrevNodeAsActive(){gI(g_,this,gO(g_,this).prev),gI(gP,this,gO(gP,this).prev)}setNextNodeAsActive(){gI(g_,this,gO(g_,this).next),gI(gP,this,gO(gP,this).next)}buildFocusOrder(t){let e=t.getTopStartCorner(),i=t.getBottomEndCorner(),r=new WeakSet;gI(gN,this,new gx);for(let n=e.row;n<=i.row;n++)if(!gO(gL,this).isHidden(n))for(let o=e.col;o<=i.col;o++){if(gO(gF,this).isHidden(o))continue;let e=gA(gV,this,gB).call(this,t,gO(gN,this),r,n,o);e&&gI(gP,this,e)}gO(gN,this).first&&(gO(gN,this).first.prev=gO(gN,this).last,gO(gN,this).last.next=gO(gN,this).first);let n=new WeakSet;gI(gH,this,new gx);for(let r=e.col;r<=i.col;r++)if(!gO(gF,this).isHidden(r))for(let o=e.row;o<=i.row;o++){if(gO(gL,this).isHidden(o))continue;let e=gA(gV,this,gB).call(this,t,gO(gH,this),n,o,r);e&&gI(g_,this,e)}gO(gH,this).first&&(gO(gH,this).first.prev=gO(gH,this).last,gO(gH,this).last.next=gO(gH,this).first)}setActiveNode(t,e){return gO(gN,this).inorder(i=>{let{rowStart:r,rowEnd:n,colStart:o,colEnd:s}=i.data;if(t>=r&&t<=n&&e>=o&&e<=s)return gI(gP,this,i),!1}),gO(gH,this).inorder(i=>{let{rowStart:r,rowEnd:n,colStart:o,colEnd:s}=i.data;if(t>=r&&t<=n&&e>=o&&e<=s)return gI(g_,this,i),!1}),this}}function gB(t,e,i,r,n){let o=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.highlight.clone().normalize(),a=gO(gD,this).call(this,r,n);if(a&&i.has(a))return null;let h={colStart:n,colEnd:n,rowStart:r,rowEnd:r};if(a){if(i.add(a),a.row<o.row||a.row+a.rowspan-1>s.row||a.col<o.col||a.col+a.colspan-1>s.col)return null;h.colStart=a.col,h.colEnd=a.col+a.colspan-1,h.rowStart=a.row,h.rowEnd=a.row+a.rowspan-1}let u=e.push(h);return r===l.row&&n===l.col||a&&l.row>=a.row&&l.row<=a.row+a.rowspan-1&&l.col>=a.col&&l.col<=a.col+a.colspan-1?u:null}function gj(t,e,i){let{view:r,rowIndexMapper:n}=t,o=r.getStylesHandler(),s=r.getDefaultRowHeight(),l=0;for(let r=e;r<e+i;r++)if(!n.isHidden(r)){var a;l+=null!==(a=t.getRowHeight(r))&&void 0!==a?a:s,0!==r||o.isClassicTheme()||(l+=1)}return l}function gz(t,e,i){gU(t,e),e.set(t,i)}function gU(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function g$(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function gY(t,e,i){return t.set(gq(t,e),i),i}function gG(t,e){return t.get(gq(t,e))}function gq(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}d.R.getSingleton().register("beforeMergeCells"),d.R.getSingleton().register("afterMergeCells"),d.R.getSingleton().register("beforeUnmergeCells"),d.R.getSingleton().register("afterUnmergeCells");let gX="mergeCells";var gK=new WeakMap,gJ=new WeakMap,gQ=new WeakMap,gZ=new WeakMap,g0=new WeakSet;class g1 extends eC{constructor(){super(...arguments),function(t,e){gU(t,e),e.add(t)}(this,g0),g$(this,"mergedCellsCollection",null),g$(this,"autofillCalculations",null),g$(this,"selectionCalculations",null),gz(this,gK,null),gz(this,gJ,{row:0,col:0}),gz(this,gQ,new gW({mergedCellsGetter:(t,e)=>this.mergedCellsCollection.get(t,e),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),gz(this,gZ,function(t){let{hot:e}=t,{rowIndexMapper:i,columnIndexMapper:r}=e,n=new Map;return{before:function(){},after:function(o,s,l){let a=t.mergedCellsCollection.get(s,l);if(!(0,V.isObject)(a)){o.removeAttribute("rowspan"),o.removeAttribute("colspan"),(0,w.isSafari)()&&n.has(s)&&!e.getSettings().rowHeaders&&(o.style.height=`${n.get(s)}px`,n.delete(s)),o.style.display="";return}let{row:h,col:u,colspan:c,rowspan:d}=a,[g,f]=t.translateMergedCellToRenderable(h,d,u,c),p=t.getSetting("virtualized");if((0,w.isSafari)()&&0===u&&!e.getSettings().rowHeaders){let t=gj(e,h,d);n.set(s,t/d)}let m=i.getRenderableFromVisualIndex(s),y=r.getRenderableFromVisualIndex(l),b=i.getNearestNotHiddenIndex(h,1),C=r.getNearestNotHiddenIndex(u,1);if(p){let t=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(t)||(b=Math.max(b,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(t)||(C=Math.max(C,e.getFirstRenderedVisibleColumn()))}let S=Math.min(d,g-m+1),E=Math.min(c,f-y+1);b===s&&C===l?(o.setAttribute("rowspan",S),o.setAttribute("colspan",E)):(o.removeAttribute("rowspan"),o.removeAttribute("colspan"),o.style.display="none")}}}(this))}static get PLUGIN_KEY(){return gX}static get PLUGIN_PRIORITY(){return 150}static get DEFAULT_SETTINGS(){return{[em]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[gX]}enablePlugin(){var t=this;this.enabled||(this.mergedCellsCollection=new gm(this),this.autofillCalculations=new gC(this),this.selectionCalculations=new gE(this),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g2).call(t,...i)}),this.addHook("modifyTransformFocus",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g9).call(t,...i)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g4).call(t,...i)}),this.addHook("modifyTransformEnd",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g5).call(t,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g8).call(t,...i)}),this.addHook("beforeSetRangeStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,ft).call(t,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,ft).call(t,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fe).call(t,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fi).call(t,...i)}),this.addHook("afterSelectionEnd",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fr).call(t,...i)}),this.addHook("modifyGetCellCoords",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g7).call(t,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g7).call(t,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g3).call(t,...i)}),this.addHook("afterRenderer",function(){return gG(gZ,t).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,g6).call(t,...i)}),this.addHook("afterGetCellMeta",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fn).call(t,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fo).call(t,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fs).call(t,...i)}),this.addHook("modifyAutofillRange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fl).call(t,...i)}),this.addHook("afterCreateCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fa).call(t,...i)}),this.addHook("afterRemoveCol",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fh).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fu).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fc).call(t,...i)}),this.addHook("afterChange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fd).call(t,...i)}),this.addHook("beforeDrawBorders",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fg).call(t,...i)}),this.addHook("afterDrawSelection",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,ff).call(t,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fp).call(t,...i)}),this.addHook("beforeBeginEditing",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fm).call(t,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return gq(g0,t,fw).call(t,...i)}),this.addHook("beforeUndoStackChange",(t,e)=>{if("MergeCells"===e)return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!(0,w.isChrome)())return;let t=[],e=[];this.mergedCellsCollection.mergedCells.forEach(t=>{let{row:i,rowspan:r}=t;for(let t=i+1;t<i+r;t++)e.push(t)}),(e=[...new Set(e)]).forEach(e=>{let i=this.hot.rowIndexMapper.getRenderableFromVisualIndex(e);this.hot.view._wt.wtOverlays.getOverlays(!0).map(t=>(null==t?void 0:t.name)==="master"?t:t.clone.wtTable).forEach(e=>{let r=e.getRow(i);r&&(r.style.background=(0,y.getStyle)(r,"backgroundColor").replace(")",", 0.99)"),t.push(r))})}),this.hot._registerTimeout(()=>{t.forEach(t=>{var e;t.style.background=null===(e=(0,y.getStyle)(t,"backgroundColor"))||void 0===e?void 0:e.replace(", 0.99)",")")})},1)}validateSetting(t){return!!t&&(gd.containsNegativeValues(t)?((0,iD.R8)(gd.NEGATIVE_VALUES_WARNING(t)),!1):gd.isOutOfBounds(t,this.hot.countRows(),this.hot.countCols())?((0,iD.R8)(gd.IS_OUT_OF_BOUNDS_WARNING(t)),!1):gd.isSingleCell(t)?((0,iD.R8)(gd.IS_SINGLE_CELL(t)),!1):!gd.containsZeroSpan(t)||((0,iD.R8)(gd.ZERO_SPAN_WARNING(t)),!1))}generateFromSettings(){let t=this.getSetting("cells").filter(t=>this.validateSetting(t)),e=this.mergedCellsCollection.filterOverlappingMergeCells(t),i=[];e.forEach(t=>{let{row:e,col:r,rowspan:n,colspan:o}=t,s=this.hot._createCellCoords(e,r),l=this.hot._createCellCoords(e+n-1,r+o-1),a=this.hot._createCellRange(s,s,l);this.mergeRange(a,!0,!0);for(let t=e;t<e+n;t++)for(let n=r;n<r+o;n++)(t!==e||n!==r)&&i.push([t,n,null])}),0!==i.length&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!!e||this.validateSetting(t)}mergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;t.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");let{from:e,to:i}=t;this.unmergeRange(t,!0),this.mergeRange(t),this.hot.selectCell(e.row,e.col,i.row,i.col,!1)}unmergeSelection(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.hot.getSelectedRangeLast();if(!t)return;let{from:e,to:i}=t;this.unmergeRange(t,!0),this.hot.selectCell(e.row,e.col,i.row,i.col,!1)}mergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.getTopStartCorner(),n=t.getBottomEndCorner(),o={row:r.row,col:r.col,rowspan:n.row-r.row+1,colspan:n.col-r.col+1},s=[],l=null;return!!this.canMergeRange(o,e)&&(this.hot.runHooks("beforeMergeCells",t,e),(0,b.rangeEach)(0,o.rowspan-1,t=>{(0,b.rangeEach)(0,o.colspan-1,e=>{let i=null;s[t]||(s[t]=[]),0===t&&0===e?i=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(o.row),this.hot.toPhysicalColumn(o.col)):this.hot.setCellMeta(o.row+t,o.col+e,"hidden",!0),s[t][e]=i})}),this.hot.setCellMeta(o.row,o.col,"spanned",!0),!this.mergedCellsCollection.add(o,e)||(i?l=[o.row,o.col,s]:this.hot.populateFromArray(o.row,o.col,s,void 0,void 0,this.pluginName),e||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",t,o,e),l))}unmergeRange(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.mergedCellsCollection.getWithinRange(t);0!==i.length&&(this.hot.runHooks("beforeUnmergeCells",t,e),(0,z.arrayEach)(i,t=>{this.mergedCellsCollection.remove(t.row,t.col),(0,b.rangeEach)(0,t.rowspan-1,e=>{(0,b.rangeEach)(0,t.colspan-1,i=>{this.hot.removeCellMeta(t.row+e,t.col+i,"hidden"),this.hot.removeCellMeta(t.row+e,t.col+i,"copyable")})}),this.hot.removeCellMeta(t.row,t.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",t,e),this.hot.render())}toggleMerge(t){let{from:e,to:i}=t.clone().normalize(),r=this.mergedCellsCollection.get(e.row,e.col);r.row===e.row&&r.col===e.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(t):this.mergeSelection(t)}merge(t,e,i,r){let n=this.hot._createCellCoords(t,e),o=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(n,n,o))}unmerge(t,e,i,r){let n=this.hot._createCellCoords(t,e),o=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(n,n,o))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{let t=this.hot.getSelectedRangeLast();t&&!t.isSingleHeader()&&(this.toggleMerge(t),this.hot.render())},runOnlyIf:t=>!t.altKey,group:gX})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(gX)}modifyViewportRowStart(t,e){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(t.startRow);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(r,n);if((0,V.isObject)(o)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.row,1));if(r<t.startRow){t.startRow=r,this.modifyViewportRowStart(t,e);return}}}}modifyViewportRowEnd(t,e){let i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(t.endRow);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(r,n);if((0,V.isObject)(o)){let r=o.row+o.rowspan-1,n=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(n>t.endRow){t.endRow=n,this.modifyViewportRowEnd(t,e);return}}}}modifyViewportColumnStart(t,e){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(t.startColumn);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(n,r);if((0,V.isObject)(o)){let r=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o.col,1));if(r<t.startColumn){t.startColumn=r,this.modifyViewportColumnStart(t,e);return}}}}modifyViewportColumnEnd(t,e){let i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(t.endColumn);for(let n=0;n<e;n+=1){let o=this.mergedCellsCollection.get(n,r);if((0,V.isObject)(o)){let r=o.col+o.colspan-1,n=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(r,-1));if(n>t.endColumn){t.endColumn=n,this.modifyViewportColumnEnd(t,e);return}}}}translateMergedCellToRenderable(t,e,i,r){let n,o,{rowIndexMapper:s,columnIndexMapper:l}=this.hot;return n=0===e?s.getNearestNotHiddenIndex(t,1):s.getNearestNotHiddenIndex(t+e-1,-1),o=0===r?l.getNearestNotHiddenIndex(i,1):l.getNearestNotHiddenIndex(i+r-1,-1),[t>=0?s.getRenderableFromVisualIndex(n):t,i>=0?l.getRenderableFromVisualIndex(o):i]}}function g2(){this.generateFromSettings(),this.hot.render()}function g3(t){if(t){let t=this.mergedCellsCollection.mergedCells,e=this.hot.getSelectedRangeLast(),i=e.getTopStartCorner(),r=e.getBottomEndCorner();for(let e=0;e<t.length;e+=1)if(i.row===t[e].row&&i.col===t[e].col&&r.row===t[e].row+t[e].rowspan-1&&r.col===t[e].col+t[e].colspan-1)return!1}return t}function g9(t){gG(gJ,this).row=t.row,gG(gJ,this).col=t.col}function g4(t){let{highlight:e}=this.hot.getSelectedRangeLast(),{columnIndexMapper:i,rowIndexMapper:r}=this.hot;gG(gK,this)&&(null!==r.getRenderableFromVisualIndex(gG(gK,this).row)&&(e.row=gG(gK,this).row),null!==i.getRenderableFromVisualIndex(gG(gK,this).col)&&(e.col=gG(gK,this).col),gY(gK,this,null));let n=this.mergedCellsCollection.get(e.row,e.col);if(!n)return;let o=n.col,s=n.col+n.colspan-1;if(t.col<0){let r=e.col>=o&&e.col<=s?o-1:s,n=i.getNearestNotHiddenIndex(r,-1);null===n?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(n,e.col)-1,1)}else if(t.col>0){let r=e.col>=o&&e.col<=s?s+1:o,n=i.getNearestNotHiddenIndex(r,1);null===n?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,n)-1,1)}let l=n.row,a=n.row+n.rowspan-1;if(t.row<0){let i=e.row>=l&&e.row<=a?l-1:a,n=r.getNearestNotHiddenIndex(i,-1);null===n?t.row=-this.hot.view.countRenderableRowsInRange(0,e.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(n,e.row)-1,1)}else if(t.row>0){let i=e.row>=l&&e.row<=a?a+1:l,n=r.getNearestNotHiddenIndex(i,1);null===n?t.row=this.hot.view.countRenderableRowsInRange(e.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(e.row,n)-1,1)}}function g5(t){let e=this.hot.getSelectedRangeLast(),i=e.clone(),{to:r}=e,{columnIndexMapper:n,rowIndexMapper:o}=this.hot,s=(t,e)=>{i.expand(this.hot._createCellCoords(t,e));for(let t=0;t<this.mergedCellsCollection.mergedCells.length;t+=1)i.expandByRange(this.mergedCellsCollection.mergedCells[t].getRange())};if(t.col<0){let o=this.mergedCellsCollection.getStartMostColumnIndex(e,r.col)+t.col;s(r.row,o),"E-W"===e.getHorizontalDirection()&&"E-W"===i.getHorizontalDirection()&&(o=i.getTopStartCorner().col);let l=n.getNearestNotHiddenIndex(o,1);null!==l&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(l,r.col)-1,1))}else if(t.col>0){let o=this.mergedCellsCollection.getEndMostColumnIndex(e,r.col)+t.col;s(r.row,o),"W-E"===e.getHorizontalDirection()&&"W-E"===i.getHorizontalDirection()&&(o=i.getBottomEndCorner().col);let l=n.getNearestNotHiddenIndex(o,-1);null!==l&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(r.col,l)-1,1))}if(t.row<0){let n=this.mergedCellsCollection.getTopMostRowIndex(e,r.row)+t.row;s(n,r.col),"S-N"===e.getVerticalDirection()&&"S-N"===i.getVerticalDirection()&&(n=i.getTopStartCorner().row);let l=o.getNearestNotHiddenIndex(n,1);null!==l&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(l,r.row)-1,1))}else if(t.row>0){let n=this.mergedCellsCollection.getBottomMostRowIndex(e,r.row)+t.row;s(n,r.col),"N-S"===e.getVerticalDirection()&&"N-S"===i.getVerticalDirection()&&(n=i.getBottomStartCorner().row);let l=o.getNearestNotHiddenIndex(n,-1);null!==l&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(r.row,l)-1,1))}}function g8(){let t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){gY(gK,this,e.clone());return}for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);for(let e=0;e<this.mergedCellsCollection.mergedCells.length;e+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[e].getRange(),!1);let i=this.mergedCellsCollection.get(e.row,e.col);gY(gK,this,e.clone()),i&&e.assign(i)}function g7(t,e,i,r){if(t<0||e<0)return;let n=this.mergedCellsCollection.get(t,e);if(!n)return;let{row:o,col:s,colspan:l,rowspan:a}=n,h=o+a-1,u=s+l-1;if("render"===r&&this.getSetting("virtualized")){let t=this.hot.view.getActiveOverlayName(),e=["top","top_inline_start_corner"].includes(t)?0:this.hot.getFirstRenderedVisibleRow(),i=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(t)?0:this.hot.getFirstRenderedVisibleColumn();return[(0,b.clamp)(e,o,h),(0,b.clamp)(i,s,u),(0,b.clamp)(this.hot.getLastRenderedVisibleRow(),o,h),(0,b.clamp)(this.hot.getLastRenderedVisibleColumn(),s,u)]}return[o,s,h,u]}function g6(t){var e;t.items.push({name:"---------"},(e=this,{key:"mergeCells",name(){let t=this.getSelectedLast();if(t){let i=e.mergedCellsCollection.get(t[0],t[1]);if(i.row===t[0]&&i.col===t[1]&&i.row+i.rowspan-1===t[2]&&i.col+i.colspan-1===t[3])return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){let t=this.getSelectedRangeLast();if(!t)return;t.setDirection(this.isRtl()?"NE-SW":"NW-SE");let{from:i,to:r}=t;e.toggleMerge(t),this.selectCell(i.row,i.col,r.row,r.col,!1)},disabled(){let t=this.getSelectedLast();return!t||gd.isSingleCell({row:t[0],col:t[1],rowspan:t[2]-t[0]+1,colspan:t[3]-t[1]+1})||this.selection.isSelectedByCorner()},hidden:!1}))}function ft(){gY(gK,this,null)}function fe(){if(gG(gK,this).isCell())return;let t=this.hot.getSelectedRangeLast(),e=t.getVerticalDirection(),i=t.getHorizontalDirection(),r=gG(gK,this).clone().normalize();gG(gQ,this).setActiveNode(r.row,r.col),gG(gJ,this).row>0||gG(gJ,this).col>0?gG(gQ,this).setPrevNodeAsActive():("E-W"===i&&gG(gJ,this).col<0||"S-N"===e&&gG(gJ,this).row<0)&&gG(gQ,this).setNextNodeAsActive()}function fi(t,e){let i=this.hot.getSelectedRangeLast(),{columnIndexMapper:r,rowIndexMapper:n}=this.hot,o=null,s=null;if(gG(gJ,this).col<0){let{rowEnd:t,colEnd:e}=gG(gQ,this).getPrevHorizontalNode();s=r.getNearestNotHiddenIndex(e,-1),o=n.getNearestNotHiddenIndex(t,-1)}else if(gG(gJ,this).col>0){let{rowStart:t,colStart:e}=gG(gQ,this).getNextHorizontalNode();s=r.getNearestNotHiddenIndex(e,1),o=n.getNearestNotHiddenIndex(t,1)}else if(gG(gJ,this).row<0){let{rowEnd:t,colEnd:e}=gG(gQ,this).getPrevVerticalNode();s=r.getNearestNotHiddenIndex(e,-1),o=n.getNearestNotHiddenIndex(t,-1)}else if(gG(gJ,this).row>0){let{rowStart:t,colStart:e}=gG(gQ,this).getNextVerticalNode();s=r.getNearestNotHiddenIndex(e,1),o=n.getNearestNotHiddenIndex(t,1)}if(null!==o||null!==s){let r=this.hot._createCellCoords(o,s),n=this.mergedCellsCollection.get(r.row,r.col),l=this.hot.selection.highlight.getFocus();t=r.row,e=r.col,n?i.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(n.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(n.col,1)}):i.highlight.assign(r),l.clear(),l.add(r).commit()}gG(gQ,this).setActiveNode(t,e),gY(gJ,this,{row:0,col:0})}function fr(){this.hot.getSelectedRangeLast().isHeader()||gG(gQ,this).buildFocusOrder(this.hot.getSelectedRangeLast())}function fn(t,e,i){let r=this.mergedCellsCollection.get(t,e);r&&(r.row!==t||r.col!==e?i.copyable=!1:(i.rowspan=r.rowspan,i.colspan=r.colspan))}function fo(t){if(this.getSetting("virtualized"))return;let e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function fs(t){if(this.getSetting("virtualized"))return;let e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function fl(t,e){let i=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,i))return e;let r=this.hot._createCellCoords(e[0],e[1]),n=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(r,r,n),s=this.mergedCellsCollection.getWithinRange(o);return 0===s.length?t:this.autofillCalculations.snapDragArea(e,t,i,s)}function fa(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function fh(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function fu(t,e,i){"auto"!==i&&this.mergedCellsCollection.shiftCollections("down",t,e)}function fc(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function fd(t,e){"Autofill.fill"===e&&this.autofillCalculations.recreateAfterDataPopulation(t)}function fg(t,e){if(e&&"area"===e){let e=this.hot.getSelectedRangeLast(),i=this.mergedCellsCollection.getWithinRange(e);(0,z.arrayEach)(i,i=>{e.getBottomEndCorner().row===i.getLastRow()&&e.getBottomEndCorner().col===i.getLastColumn()&&(t[2]=i.row,t[3]=i.col)})}}function ff(t,e,i,r){if(i)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,i,r)}function fp(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function fm(t,e,i,r){if(!(r instanceof MouseEvent))return;let n=this.hot.getSelectedRangeLast(),o=this.mergedCellsCollection.getByRange(n);if(!o)return;let s=this.hot._createCellCoords(o.row,o.col),l=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return 0===this.hot.selection.getLayerLevel()&&n.isEqual(this.hot._createCellRange(s,s,l))}function fw(t,e,i){let r,n;if(this.hot.getSettings().rowHeaders||"bottom"===i||"bottom_inline_start_corner"===i)return t;if("master"===i)r=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.getLastRenderedVisibleColumn();else{let t=this.hot.view.getOverlayByName(i);r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getFirstRenderedColumn()),n=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,r))return t;let o=this.hot._createCellCoords(e,r),s=this.hot._createCellCoords(e,n),l=this.hot._createCellRange(o,o,s),a=this.mergedCellsCollection.getWithinRange(l,!0),h=a.reduce((t,e)=>{let{rowspan:i}=e;return Math.max(t,i)},1),u=0;return a.length>1&&a[0].rowspan<h&&(u=h-a[0].rowspan),a.forEach(r=>{let{rowspan:n}=r,o=0;o="top"===i||"top_inline_start_corner"===i?Math.min(h,this.hot.view.countNotHiddenFixedRowsTop()-e):n-u,t=Math.max(null!=t?t:0,gj(this.hot,e,o))}),t}let fv="sort",fy="multiColumnSorting";i6(fy,function(t,e){return function(i,r){let[,...n]=i,[,...o]=r;return function i(r){let s=t[r],l=e[r],a=n[r],h=o[r],u=l.multiColumnSorting,c=(u.compareFunctionFactory?u.compareFunctionFactory:re(l.type))(s,l,u)(a,h);if(c===ri){let t=r+1;if(void 0!==e[t])return i(t)}return c}(0)}});class fb extends rE{constructor(){super(...arguments),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"pluginKey",fy)}static get PLUGIN_KEY(){return fy}static get PLUGIN_PRIORITY(){return 170}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast();return -1===t.row&&t.col>=0&&this.sort(this.getNextSortConfig(t.col,rb)),!1},runOnlyIf:()=>{var t,e;let i=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return i&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:W.b,position:"before",group:fy})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(fy)}sort(t){super.sort(t)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(t){return super.getSortConfig(t)}setSortConfig(t){super.setSortConfig(t)}getNormalizedSortConfigs(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Array.isArray(t)?t:[t]}updateHeaderClasses(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];super.updateHeaderClasses(t,...i),(0,y.removeClass)(t,function(t){let e=t.className.split(" "),i=RegExp(`^${fv}-[0-9]{1,2}$`);return e.filter(t=>i.test(t))}(t)),!1!==this.enabled&&(0,y.addClass)(t,function(t,e,i){let r=[];return!1===i||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&r.push(`${fv}-${t.getIndexOfColumnInSortQueue(e)+1}`),r}(...i))}onAfterOnCellMouseDown(t,e){!1!==rc(e.row,e.col,t)&&this.wasClickableHeaderClicked(t,e.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(e.col),this.sort(this.getNextSortConfig(e.col,rb))):this.sort(this.getColumnNextConfig(e.col)))}}function fC(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class fS extends eC{constructor(){super(...arguments),fC(this,"dragged",[]),fC(this,"lastSetCell",null)}static get PLUGIN_KEY(){return"multipleSelectionHandles"}static get PLUGIN_PRIORITY(){return 160}isEnabled(){return(0,w.isMobileBrowser)()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){let t=this,{rootElement:e}=this.hot;function i(e){if(1===t.dragged.length)return t.dragged.splice(0,t.dragged.length),!0;let i=t.dragged.indexOf(e);if(-1===i)return!1;0===i?t.dragged=t.dragged.slice(0,1):1===i&&(t.dragged=t.dragged.slice(-1))}this.eventManager.addEventListener(e,"touchstart",e=>{let i;return(0,y.hasClass)(e.target,"topSelectionHandle-HitArea")?(i=t.hot.getSelectedRangeLast(),t.dragged.push("top"),t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},e.preventDefault(),!1):(0,y.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(i=t.hot.getSelectedRangeLast(),t.dragged.push("bottom"),t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},e.preventDefault(),!1):void 0}),this.eventManager.addEventListener(e,"touchend",e=>(0,y.hasClass)(e.target,"topSelectionHandle-HitArea")?(i.call(t,"top"),t.touchStartRange=void 0,e.preventDefault(),!1):(0,y.hasClass)(e.target,"bottomSelectionHandle-HitArea")?(i.call(t,"bottom"),t.touchStartRange=void 0,e.preventDefault(),!1):void 0),this.eventManager.addEventListener(e,"touchmove",e=>{let i,r,n,o,s,l,{rootDocument:a}=this.hot;if(0===t.dragged.length)return;let h=a.elementFromPoint(e.touches[0].clientX,e.touches[0].clientY);h&&h!==t.lastSetCell&&(("TD"===h.nodeName||"TH"===h.nodeName)&&(-1===(i=t.hot.getCoords(h)).col&&(i.col=0),n=(r=t.hot.getSelectedRangeLast()).getWidth(),o=r.getHeight(),s=r.getDirection(),1===n&&1===o&&t.hot.selection.setRangeEnd(i),null!==(l=t.getCurrentRangeCoords(r,i,t.touchStartRange.direction,s,t.dragged[0])).start&&t.hot.selection.setRangeStart(l.start),t.hot.selection.setRangeEnd(l.end),t.lastSetCell=h),e.preventDefault())})}getCurrentRangeCoords(t,e,i,r,n){let o=t.getTopStartCorner(),s=t.getBottomEndCorner(),l=t.getBottomStartCorner(),a=t.getTopEndCorner(),h={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":h="top"===n?{start:this.hot._createCellCoords(e.row,t.highlight.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,o.col)};break;case"SE-NW":"bottom"===n&&(h={start:this.hot._createCellCoords(s.row,e.col),end:this.hot._createCellCoords(e.row,o.col)})}break;case"NW-SE":switch(r){case"NE-SW":"top"===n?h={start:e,end:l}:h.end=e;break;case"NW-SE":"top"===n?h={start:e,end:s}:h.end=e;break;case"SE-NW":"top"===n?h={start:e,end:o}:h.end=e;break;case"SW-NE":"top"===n?h={start:e,end:a}:h.end=e}break;case"SW-NE":switch(r){case"NW-SE":h="bottom"===n?{start:this.hot._createCellCoords(e.row,o.col),end:this.hot._createCellCoords(l.row,e.col)}:{start:this.hot._createCellCoords(o.row,e.col),end:this.hot._createCellCoords(e.row,s.col)};break;case"SW-NE":h="top"===n?{start:this.hot._createCellCoords(t.highlight.row,e.col),end:this.hot._createCellCoords(e.row,s.col)}:{start:this.hot._createCellCoords(e.row,o.col),end:this.hot._createCellCoords(o.row,e.col)};break;case"SE-NW":"bottom"===n?h={start:this.hot._createCellCoords(e.row,a.col),end:this.hot._createCellCoords(o.row,e.col)}:"top"===n&&(h={start:l,end:e})}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":"top"===n&&(h.end=e);break;case"SE-NW":"top"===n?h.end=e:h={start:e,end:o}}}return h}isDragged(){return this.dragged.length>0}}var fE=i(91826);function fR(){let{label:t="",colspan:e=1,origColspan:i=1,collapsible:r=!1,crossHiddenColumns:n=[],isCollapsed:o=!1,isHidden:s=!1,isRoot:l=!1,isPlaceholder:a=!1,headerClassNames:h=[]}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{label:t,colspan:e,origColspan:i,collapsible:r,isCollapsed:o,crossHiddenColumns:n,isHidden:s,isRoot:l,isPlaceholder:a,headerClassNames:h}}function fT(){return{label:"",isPlaceholder:!0}}function fx(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function fM(t,e){return t.get(fO(t,e))}function fk(t,e,i){return t.set(fO(t,e),i),i}function fO(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let fI=["label","collapsible"];var fA=new WeakMap,fN=new WeakMap,fH=new WeakMap;class fP{constructor(){fx(this,fA,[]),fx(this,fN,0),fx(this,fH,1/0)}setColumnsLimit(t){fk(fH,this,t)}setData(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];fk(fA,this,function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,i=[];if(0===e)return i;(0,z.arrayEach)(t,t=>{let r=[],n=0;i.push(r),(0,z.arrayEach)(t,t=>{let i=fR();if((0,V.isObject)(t)){let{label:e,colspan:r,headerClassName:n}=t;i.label=(0,T.stringify)(e),"number"==typeof r&&r>1&&(i.colspan=r,i.origColspan=r),"string"==typeof n&&(i.headerClassNames=[...n.split(" ")])}else i.label=(0,T.stringify)(t);n+=i.origColspan;let o=!1;if(n>=e&&(i.colspan=i.origColspan-(n-e),i.origColspan=i.colspan,o=!0),r.push(i),i.colspan>1)for(let t=0;t<i.colspan-1;t++)r.push(fT());return!o})});let r=Math.max(...(0,z.arrayMap)(i,t=>t.length));return(0,z.arrayEach)(i,t=>{if(t.length<r){let e=(0,z.arrayMap)(Array(r-t.length),()=>fR());t.splice(t.length,0,...e)}}),i}(t,fM(fH,this))),fk(fN,this,fM(fA,this).length)}getData(){return fM(fA,this)}mergeWith(t){(0,z.arrayEach)(t,t=>{let{row:e,col:i,...r}=t,n=this.getHeaderSettings(e,i);null!==n&&(0,V.extend)(n,r,fI)})}map(t){(0,z.arrayEach)(fM(fA,this),e=>{(0,z.arrayEach)(e,e=>{let i=t({...e});(0,V.isObject)(i)&&(0,V.extend)(e,i,fI)})})}getHeaderSettings(t,e){var i;if(t>=fM(fN,this)||t<0)return null;let r=fM(fA,this)[t];return!1===Array.isArray(r)||e>=r.length?null:null!==(i=r[e])&&void 0!==i?i:null}getHeadersSettings(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=[];if(t>=fM(fN,this)||t<0)return r;let n=fM(fA,this)[t],o=0;for(let t=e;t<n.length;t++){let e=n[t];if(e.isPlaceholder)throw Error("The first column settings cannot overlap the other header layers");if(o+=e.colspan,r.push(e),e.colspan>1&&(t+=e.colspan-1),o===i)break;if(o>i)throw Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return fM(fN,this)}getColumnsCount(){return fM(fN,this)>0?fM(fA,this)[0].length:0}clear(){fk(fA,this,[]),fk(fN,this,0)}}function f_(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let fD="DF-pre-order";function fL(t,e){let i=t.call(e,this);for(let r=0;r<this.childs.length;r++){if(!1===i)return!1;i=fL.call(this.childs[r],t,e)}return i}function fF(t,e){for(let i=0;i<this.childs.length;i++)if(!1===fF.call(this.childs[i],t,e))return!1;return t.call(e,this)}let fV=new Map([[fD,fL],["DF-post-order",fF],["BF",function(t,e){let i=[this];!function r(){if(0===i.length)return;let n=i.shift();i.push(...n.childs),!1!==t.call(e,n)&&r()}()}]]);class fW{constructor(t){f_(this,"data",{}),f_(this,"parent",null),f_(this,"childs",[]),this.data=t}addChild(t){t.parent=this,this.childs.push(t)}cloneTree(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,e=new fW({...t.data});for(let i=0;i<t.childs.length;i++)e.addChild(this.cloneTree(t.childs[i]));return e}replaceTreeWith(t){this.data={...t.data},this.childs=[];for(let e=0;e<t.childs.length;e++)this.addChild(t.childs[e])}walkDown(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"BF";if(!fV.has(e))throw Error(`Traversal strategy "${e}" does not exist`);fV.get(e).call(this,t,this)}walkUp(t){let e=this,i=r=>{!1!==t.call(e,r)&&null!==r.parent&&i(r.parent)};i(this)}}function fB(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function fj(t,e){return t.get(fz(t,e))}function fz(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var fU=new WeakMap,f$=new WeakMap,fY=new WeakMap;class fG{constructor(t){fB(this,fU,new Map),fB(this,f$,new Map),fB(this,fY,null),function(t,e,i){t.set(fz(t,e),i)}(fY,this,t)}getRoots(){return Array.from(fj(fU,this).values())}getRootByColumn(t){let e;return fj(f$,this).has(t)&&(e=fj(fU,this).get(fj(f$,this).get(t))),e}getNode(t,e){let i,r=this.getRootByColumn(e);if(!r)return;let n=e-fj(f$,this).get(e),o=0;return r.walkDown(r=>{let{data:{origColspan:s,headerLevel:l}}=r;if(t===l){if(n>=o&&n<=o+s-1)return(i=r).data.isRoot=e===i.data.columnIndex,!1;o+=s}}),i}rebuildTreeIndex(){let t=0;fj(f$,this).clear(),(0,z.arrayEach)(fj(fU,this),e=>{let[,{data:{colspan:i}}]=e;for(let e=t;e<t+i;e++)fj(f$,this).set(e,t);t+=i})}buildTree(){this.clear();let t=fj(fY,this).getColumnsCount(),e=0;for(;e<t;){let t=fj(fY,this).getHeaderSettings(0,e),i=new fW;fj(fU,this).set(e,i),this.buildLeaves(i,e,0,t.origColspan),e+=t.origColspan}this.rebuildTreeIndex()}buildLeaves(t,e,i){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,n=fj(fY,this).getHeadersSettings(i,e,r);i+=1,(0,z.arrayEach)(n,r=>{let n,o={...r,headerLevel:i-1,columnIndex:e};1===i?(t.data=o,n=t):(n=new fW(o),t.addChild(n)),i<fj(fY,this).getLayersCount()&&this.buildLeaves(n,e,i,r.origColspan),e+=r.origColspan})}clear(){fj(fU,this).clear(),fj(f$,this).clear()}}function fq(t,e){t.walkDown(t=>{let{data:i,childs:r}=t;if(!i.isHidden&&(e(i.columnIndex),0===r.length))for(let t=1;t<i.colspan;t++)e(i.columnIndex+t)})}function fX(t,e){let{childs:i}=t;if(0!==i.length)return i[0].data[e]}function fK(t){return fX(t,"origColspan")===t.data.origColspan}function fJ(t){let{data:e,childs:i}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fK(t))return fJ(i[0]);e.isCollapsed=!1;let r=i.slice(1),n=new Set,o=0;if(r.length>0)(0,z.arrayEach)(r,t=>{t.replaceTreeWith(t.data.clonedTree),t.data.clonedTree=null;let e=t.data;o+=e.colspan,fq(t,t=>{n.add(t)})});else{let{colspan:t,origColspan:i,columnIndex:r}=e;o=i-t;for(let t=1;t<i;t++)n.add(r+t)}return t.walkUp(t=>{let{data:e}=t;e.colspan+=o,e.colspan>=e.origColspan?(e.colspan=e.origColspan,e.isCollapsed=!1):fK(t)&&(e.isCollapsed=fX(t,"isCollapsed"))}),{rollbackModification:()=>fQ(t),affectedColumns:Array.from(n),colspanCompensation:o}}function fQ(t){var e;let{data:i,childs:r}=t;if(i.isCollapsed||i.isHidden||i.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(fK(t))return fQ(r[0]);i.isCollapsed=!0;let n=r.slice(1),o=new Set;if(n.length>0)(0,z.arrayEach)(n,t=>{fq(t,t=>{o.add(t)}),t.data.clonedTree=t.cloneTree(),t.walkDown(t=>{let{data:e}=t;e.isHidden=!0})});else{let{origColspan:t,columnIndex:e}=i;for(let i=1;i<t;i++){let t=e+i;o.add(t)}}let s=i.colspan-(null!==(e=fX(t,"colspan"))&&void 0!==e?e:1);return t.walkUp(t=>{let{data:e}=t;e.colspan-=s,e.colspan<=1?(e.colspan=1,e.isCollapsed=!0):fK(t)&&(e.isCollapsed=fX(t,"isCollapsed"))}),{rollbackModification:()=>fJ(t),affectedColumns:Array.from(o),colspanCompensation:s}}let fZ=new Map([["collapse",fQ],["expand",fJ],["hide-column",function(t,e){if(!Number.isInteger(e))throw Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw Error((0,ro.O)`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(i.includes(e))return;let r=!1;t.walkUp(t=>{let{data:{collapsible:e}}=t;if(e)return r=!0,!1}),r||t.walkUp(t=>{let{data:i}=t;i.crossHiddenColumns.push(e),i.colspan>1?i.colspan-=1:i.isHidden=!0})}],["show-column",function(t,e){if(!Number.isInteger(e))throw Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw Error((0,ro.O)`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);let{crossHiddenColumns:i}=t.data;if(!i.includes(e))return;let r=!1;t.walkUp(t=>{let{data:{collapsible:e}}=t;if(e)return r=!0,!1}),r||t.walkUp(t=>{let{data:i}=t;i.crossHiddenColumns.splice(i.crossHiddenColumns.indexOf(e),1),!i.isHidden&&i.colspan<i.origColspan&&(i.colspan+=1),i.isHidden=!1})}]]);function f0(t){let e=[];return(0,z.arrayEach)(t,t=>{t.walkDown(t=>{var i,r;let n,o=t.data,{origColspan:s,columnIndex:l,headerLevel:a,crossHiddenColumns:h}=o,u=(Array.isArray((i=e)[r=a])?n=i[r]:(n=[],i[r]=n),n),c=!1;for(let t=l;t<l+s;t++)if(h.includes(t)||c)u.push(fT(o));else{let t=function(t){let{crossHiddenColumns:e,...i}=fR(t);return i}(o);t.isRoot=!0,u.push(t),c=!0}})}),e}function f1(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function f2(t,e,i){return t.set(f9(t,e),i),i}function f3(t,e){return t.get(f9(t,e))}function f9(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var f4=new WeakMap,f5=new WeakMap,f8=new WeakMap;class f7{constructor(){f1(this,f4,new fP),f1(this,f5,new fG(f3(f4,this))),f1(this,f8,[[]])}setState(t){f3(f4,this).setData(t);let e=!1;try{f3(f5,this).buildTree()}catch(t){f3(f5,this).clear(),f3(f4,this).clear(),e=!0}return f2(f8,this,f0(f3(f5,this).getRoots())),e}setColumnsLimit(t){f3(f4,this).setColumnsLimit(t)}mergeStateWith(t){let e=(0,z.arrayMap)(t,t=>{let{row:e,...i}=t;return{row:e<0?this.rowCoordsToLevel(e):e,...i}});f3(f4,this).mergeWith(e),f3(f5,this).buildTree(),f2(f8,this,f0(f3(f5,this).getRoots()))}mapState(t){f3(f4,this).map(t),f3(f5,this).buildTree(),f2(f8,this,f0(f3(f5,this).getRoots()))}mapNodes(t){return(0,z.arrayReduce)(f3(f5,this).getRoots(),(e,i)=>(i.walkDown(i=>{let r=t(i.data);void 0!==r&&e.push(r)}),e),[])}triggerNodeModification(t,e,i){let r;e<0&&(e=this.rowCoordsToLevel(e));let n=f3(f5,this).getNode(e,i);return n&&(r=function(t,e,i){if(!fZ.has(t))throw Error(`The node modifier action ("${t}") does not exist.`);return fZ.get(t)(e,i)}(t,n,i),f2(f8,this,f0(f3(f5,this).getRoots()))),r}triggerColumnModification(t,e){return this.triggerNodeModification(t,-1,e)}rowCoordsToLevel(t){if(t>=0)return null;let e=t+Math.max(this.getLayersCount(),1);return e<0?null:e}levelToRowCoords(t){if(t<0)return null;let e=t-Math.max(this.getLayersCount(),1);return e>=0?null:e}getHeaderSettings(t,e){var i,r;return(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())?null:null!==(i=null===(r=f3(f8,this)[t])||void 0===r?void 0:r[e])&&void 0!==i?i:null}getHeaderTreeNodeData(t,e){let i=this.getHeaderTreeNode(t,e);return i?{...i.data}:null}getHeaderTreeNode(t,e){if(t<0&&(t=this.rowCoordsToLevel(t)),null===t||t>=this.getLayersCount())return null;let i=f3(f5,this).getNode(t,e);return i||null}findTopMostEntireHeaderLevel(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=e-t+1,r=!1,n=null;for(let o=t;o<=e;o++){let s=f3(f5,this).getRootByColumn(o);if(!s)break;r=!0,s.walkDown(r=>{let{columnIndex:o,headerLevel:s,origColspan:l,isHidden:a}=r.data;!a&&l<=i&&o>=t&&o+l-1<=e&&(null===n||s<n)&&(n=s)},fD)}return r&&null===n?-1:this.levelToRowCoords(null!=n?n:0)}findLeftMostColumnIndex(t,e){var i,r;let{isRoot:n}=null!==(i=this.getHeaderSettings(t,e))&&void 0!==i?i:{isRoot:!0};if(n)return e;let o=e-1;for(;o>=0;){let{isRoot:e}=null!==(r=this.getHeaderSettings(t,o))&&void 0!==r?r:{isRoot:!0};if(e)break;o-=1}return o}findRightMostColumnIndex(t,e){var i,r;let{isRoot:n,origColspan:o}=null!==(i=this.getHeaderSettings(t,e))&&void 0!==i?i:{isRoot:!0,origColspan:1};if(n)return e+o-1;let s=e+1;for(;s<this.getColumnsCount();){let{isRoot:e}=null!==(r=this.getHeaderSettings(t,s))&&void 0!==r?r:{isRoot:!0};if(e)break;s+=1}return s-1}getLayersCount(){return f3(f4,this).getLayersCount()}getColumnsCount(){return f3(f4,this).getColumnsCount()}clear(){f2(f8,this,[]),f3(f4,this).clear(),f3(f5,this).clear()}}function f6(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class pt{constructor(t,e){f6(this,"hot",void 0),f6(this,"nestedHeaderSettingsGetter",void 0),f6(this,"layersCount",0),f6(this,"container",void 0),f6(this,"widthsMap",void 0),this.hot=t,this.nestedHeaderSettingsGetter=e,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(t){return this.layersCount=t,this}getWidth(t){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(t))}buildWidthsMap(){let t=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),t&&this.container.classList.add(t),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);let e=this.container.querySelectorAll("tr:last-of-type th"),i=e.length;this.widthsMap.clear();for(let t=0;t<i;t++){let i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(t),r=this.hot.toPhysicalColumn(i);this.widthsMap.setValueAtIndex(r,e[t].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(t){let{rootDocument:e,columnIndexMapper:i}=this.hot,r=e.createDocumentFragment(),n=e.createElement("table"),o=!!this.hot.getSettings().dropdownMenu,s=i.getRenderableIndexesLength();for(let t=0;t<this.layersCount;t++){let r=e.createElement("tr");for(let n=0;n<s;n++){let s=i.getVisualFromRenderableIndex(n);null===s&&(s=n);let l=e.createElement("th"),a=this.nestedHeaderSettingsGetter(t,s);if(a&&(!a.isPlaceholder||a.isHidden)){let t=a.label;o&&(t+='<button class="changeType"></button>'),(0,y.fastInnerHTML)(l,t),l.colSpan=a.colspan,r.appendChild(l)}}n.appendChild(r)}r.appendChild(n),t.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function pe(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pi(t,e,i){pr(t,e),e.set(t,i)}function pr(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function pn(t,e,i){return t.set(ps(t,e),i),i}function po(t,e){return t.get(ps(t,e))}function ps(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let pl="nestedHeaders";var pa=new WeakMap,ph=new WeakMap,pu=new WeakMap,pc=new WeakMap,pd=new WeakMap,pg=new WeakSet;class pf extends eC{constructor(){super(...arguments),function(t,e){pr(t,e),e.add(t)}(this,pg),pi(this,pa,new f7),pi(this,ph,null),pi(this,pu,null),pi(this,pc,!1),pi(this,pd,null),pe(this,"ghostTable",new pt(this.hot,(t,e)=>this.getHeaderSettings(t,e))),pe(this,"detectedOverlappedHeaders",!1)}static get PLUGIN_KEY(){return pl}static get PLUGIN_PRIORITY(){return 280}isEnabled(){return!!this.hot.getSettings()[pl]}enablePlugin(){var t=this;if(this.enabled)return;let{nestedHeaders:e}=this.hot.getSettings();Array.isArray(e)&&Array.isArray(e[0])||(0,iD.R8)((0,ro.O)`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>ps(pg,this,pA).call(this)),this.addHook("afterLoadData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pN).call(t,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,py).call(t,...i)}),this.addHook("afterOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pb).call(t,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pC).call(t,...i)}),this.addHook("beforeOnCellMouseUp",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pS).call(t,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pE).call(t,...i)}),this.addHook("modifyTransformStart",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pR).call(t,...i)}),this.addHook("afterSelection",()=>ps(pg,this,pp).call(this)),this.addHook("afterSelectionFocusSet",()=>ps(pg,this,pp).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pm).call(t,...i)}),this.addHook("afterGetColumnHeaderRenderers",t=>ps(pg,this,px).call(this,t)),this.addHook("modifyColWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pk).call(t,...i)}),this.addHook("modifyColumnHeaderValue",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pO).call(t,...i)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pw).call(t,...i)}),this.addHook("beforeCopy",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pv).call(t,...i)}),this.addHook("beforeSelectColumns",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pT).call(t,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pM).call(t,...i)}),this.addHook("modifyFocusedElement",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return ps(pg,t,pI).call(t,...i)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",()=>ps(pg,this,pp).call(this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",()=>ps(pg,this,pp).call(this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;let{nestedHeaders:t}=this.hot.getSettings();po(pa,this).setColumnsLimit(this.hot.countCols()),Array.isArray(t)&&(this.detectedOverlappedHeaders=po(pa,this).setState(t)),this.detectedOverlappedHeaders&&(0,iD.R8)((0,ro.O)`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((t,e)=>{po(pa,this).triggerColumnModification(!0===t?"hide-column":"show-column",e)}),!po(ph,this)&&this.enabled&&pn(ph,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(t=>{t.forEach(t=>{let{op:e,index:i,newValue:r}=t;"replace"===e&&po(pa,this).triggerColumnModification(!0===r?"hide-column":"show-column",i)}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.clearColspans(),po(pa,this).clear(),po(ph,this).unsubscribe(),pn(ph,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return po(pa,this)}getLayersCount(){return po(pa,this).getLayersCount()}getHeaderSettings(t,e){return po(pa,this).getHeaderSettings(t,e)}clearColspans(){if(!this.hot.view)return;let{_wt:t}=this.hot.view,e=t.getSetting("columnHeaders").length,i=t.wtTable.THEAD,r=t.wtOverlays.topOverlay.clone.wtTable.THEAD,n=t.wtOverlays.topInlineStartCornerOverlay?t.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let t=0;t<e;t++){let e=i.childNodes[t];if(!e)break;let o=r.childNodes[t],s=n?n.childNodes[t]:null;for(let t=0,i=e.childNodes.length;t<i;t++)e.childNodes[t].removeAttribute("colspan"),(0,y.removeClass)(e.childNodes[t],"hiddenHeader"),o&&o.childNodes[t]&&(o.childNodes[t].removeAttribute("colspan"),(0,y.removeClass)(o.childNodes[t],"hiddenHeader")),n&&s&&s.childNodes[t]&&(s.childNodes[t].removeAttribute("colspan"),(0,y.removeClass)(s.childNodes[t],"hiddenHeader"))}}headerRendererFactory(t){var e=this;let i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,n)=>{var o,s,l,a;let{columnIndexMapper:h,view:u}=this.hot,c=h.getVisualFromRenderableIndex(r);null===c&&(c=r),n.removeAttribute("colspan"),(0,y.removeClass)(n,"hiddenHeader"),(0,y.removeClass)(n,"hiddenHeaderText");let{colspan:d,isHidden:g,isPlaceholder:f,headerClassNames:p}=null!==(o=po(pa,this).getHeaderSettings(t,c))&&void 0!==o?o:{label:""};if(f||g)(0,y.addClass)(n,"hiddenHeader");else if(d>1){let{wtOverlays:t}=u._wt,e=null===(s=t.topInlineStartCornerOverlay)||void 0===s?void 0:s.clone.wtTable.THEAD.contains(n),o=null===(l=t.inlineStartOverlay)||void 0===l?void 0:l.clone.wtTable.THEAD.contains(n);(null===(a=t.topOverlay)||void 0===a?void 0:a.clone.wtTable.THEAD.contains(n))&&c<i&&(0,y.addClass)(n,"hiddenHeaderText");let h=e||o?Math.min(d,i-r):d;h>1&&n.setAttribute("colspan",h)}if(this.hot.view.appendColHeader(c,n,function(){return e.getColumnHeaderValue(...arguments)},t),!f&&!g){let t=n.querySelector("div.relative");t&&p&&p.length>0&&((0,y.removeClass)(t,this.hot.getColumnMeta(c).headerClassName),(0,y.addClass)(t,p))}}}getColumnHeaderValue(t,e){var i;let{isHidden:r,isPlaceholder:n}=null!==(i=po(pa,this).getHeaderSettings(e,t))&&void 0!==i?i:{};return n||r?"":this.hot.getColHeader(t,e)}destroy(){pn(pa,this,null),null!==po(ph,this)&&(po(ph,this).unsubscribe(),pn(ph,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(t){if(!(t.row>=0)&&!(t.col<0))return po(pa,this).getHeaderTreeNodeData(t.row,t.col)}}function pp(){var t;let e=null===(t=this.hot)||void 0===t?void 0:t.getSelectedRangeLast();if(!e)return;let{highlight:i}=e;if(i.isHeader()&&i.col>=0){let t=po(pa,this).findLeftMostColumnIndex(i.row,i.col),e=this.hot.selection.highlight.getFocus();e.visualCellRange.highlight.col=t,e.visualCellRange.from.col=t,e.visualCellRange.to.col=t,e.commit()}}function pm(t,e){var i;let r=this.hot.getSelectedRangeLast();if(!r)return t;let{highlight:n}=r,{navigableHeaders:o}=this.hot.getSettings(),s=this.hot.selection.isSelectedByColumnHeader(),l=o?n.row:null===(i=po(pd,this))||void 0===i?void 0:i.row,a=s?t:n.col,h=l<0&&a>=0;if(pn(pd,this,null),!h)return t;let u=this.hot.getFirstFullyVisibleColumn(),c=this.hot.getLastFullyVisibleColumn(),d=c-u+1,g=po(pa,this).findLeftMostColumnIndex(l,a),f=po(pa,this).findRightMostColumnIndex(l,a),p=f-g+1;if(g<u&&f>c)return g;if(s){let t=null;return g>=u&&f>c?p>d?(e.value="start",t=g):(e.value="end",t=f):g<u&&f<=c&&(p>d?(e.value="end",t=f):(e.value="start",t=g)),t}return g<=u?g:f}function pw(t,e,i){let r=po(pa,this).getHeaderTreeNodeData(e,t);if(!r)return t;let{columnCursor:n,selectionType:o,selectionWidth:s}=i,{isRoot:l,colspan:a}=po(pa,this).getHeaderSettings(e,t);if(o===fE.PP){if(!l)return r.columnIndex}else if(o===fE.E6&&(a>s-n||!l))return null;return t}function pv(t,e,i){let{columnHeadersCount:r}=i;if(0!==r)for(let i=0;i<e.length;i++){let{startRow:r,startCol:o,endRow:s,endCol:l}=e[i],a=s-r+1,h=o-l+1;if(r>=0||1===h)break;for(let e=o;e<=l;e++)for(let i=r;i<=s;i++){var n;let r=a+i,s=e-o;0!==s&&!1===(null===(n=po(pa,this).getHeaderTreeNodeData(i,e))||void 0===n?void 0:n.isRoot)&&(t[r][s]="")}}}function py(t,e,i,r){this._getHeaderTreeNodeDataByCoords(e)&&(r.column=!0)}function pb(t,e){let i=this._getHeaderTreeNodeDataByCoords(e);if(!i)return;pn(pu,this,e.clone()),pn(pc,this,!0);let{selection:r}=this.hot,n=r.isSelected()?r.getSelectedRange().current():null,o=[],{columnIndex:s,origColspan:l}=i,a=!r.inInSelection(e);t.shiftKey&&n?e.col<n.from.col?o.push(n.getTopEndCorner().col,s,e.row):e.col>n.from.col?o.push(n.getTopStartCorner().col,s+l-1,e.row):o.push(s,s+l-1,e.row):((0,F.isLeftClick)(t)||(0,F.isRightClick)(t)&&a||(0,F.isTouchEvent)(t))&&o.push(s,s+l-1,e.row),r.selectColumns(...o)}function pC(t,e,i,r){if(!this.hot.view.isMouseDown()||r.column)return;let n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;let{columnIndex:o,origColspan:s}=n,l=this.hot.getSelectedRangeLast(),a=l.getTopStartCorner(),h=l.getBottomEndCorner(),{from:u}=l;r.column=!0,r.cell=!0;let c=[],d=(0,b.clamp)(e.row,-1/0,-1);e.col<u.col?c.push(h.col,o,d):e.col>u.col?c.push(a.col,o+s-1,d):c.push(o,o+s-1,d),this.hot.selection.selectColumns(...c)}function pS(){pn(pc,this,!1)}function pE(){let{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!po(pc,this)||!t)return;let e=this.hot.getSelectedRangeLast(),i=e.getTopStartCorner().col,r=e.getBottomEndCorner().col,{columnIndex:n,origColspan:o}=po(pa,this).getHeaderTreeNodeData(po(pu,this).row,po(pu,this).col);if(e.setHighlight(po(pu,this)),o>e.getWidth()||n<i||n+o-1>r){let t=po(pa,this).findTopMostEntireHeaderLevel((0,b.clamp)(i,n,n+o-1),(0,b.clamp)(r,n,n+o-1));e.highlight.row=t,e.highlight.col=e.from.col}}function pR(t){let{highlight:e}=this.hot.getSelectedRangeLast(),i=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(i.isHeader()&&i.col>=0))return;let r=po(pa,this).findLeftMostColumnIndex(i.row,i.col),n=po(pa,this).findRightMostColumnIndex(i.row,i.col);if(t.col<0){let i=e.col>=r&&e.col<=n?r-1:n,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,-1);null===o?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(o,e.col)-1,1)}else if(t.col>0){let i=e.col>=r&&e.col<=n?n+1:r,o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i,1);null===o?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,o)-1,1)}}function pT(t,e,i){let r=t.row,n=this._getHeaderTreeNodeDataByCoords({row:r,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:r,col:e.col});pn(pd,this,i.clone()),e.col<t.col?(n&&(t.col=n.columnIndex+n.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(n&&(t.col=n.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function px(t){if(po(pa,this).getLayersCount()>0){t.length=0;for(let e=0;e<po(pa,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function pM(t){let e=po(pa,this).getLayersCount(),i=t.startColumn,r=!!e;for(let n=0;n<e;n++){let e=po(pa,this).findLeftMostColumnIndex(n,t.startColumn),o=this.hot.columnIndexMapper.getRenderableFromVisualIndex(e);if(e>=0&&(r=!1),(0,b.isNumeric)(o)&&o<t.startColumn){i=o;break}}t.startColumn=r?po(pa,this).getHeaderTreeNodeData(0,i).columnIndex:i}function pk(t,e){let i=this.ghostTable.getWidth(e);return t>i?t:i}function pO(t,e,i){var r;let{label:n}=null!==(r=po(pa,this).getHeaderTreeNodeData(i,e))&&void 0!==r?r:{label:""};return n}function pI(t,e){if(t<0)return this.hot.getCell(t,po(pa,this).findLeftMostColumnIndex(t,e),!0)}function pA(){this.updatePlugin()}function pN(t,e){e||this.updatePlugin()}function pH(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class pP{constructor(t,e){pH(this,"hot",void 0),pH(this,"data",null),pH(this,"plugin",void 0),pH(this,"parentReference",new WeakMap),pH(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=e,this.plugin=t}setData(t){this.data=t}getData(){return this.data}getRawSourceData(){let t=null;return this.plugin.disableCoreAPIModifiers(),t=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),t}updateWithData(t){this.setData(t),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},(0,b.rangeEach)(0,this.data.length-1,t=>{this.cacheNode(this.data[t],0,null)})}cacheNode(t,e,i){this.cache.levels[e]||(this.cache.levels[e]=[],this.cache.levelCount+=1),this.cache.levels[e].push(t),this.cache.rows.push(t),this.cache.nodeInfo.set(t,{parent:i,row:this.cache.rows.length-1,level:e}),this.hasChildren(t)&&(0,z.arrayEach)(t.__children,i=>{this.cacheNode(i,e+1,t)})}getDataObject(t){return null==t?null:this.cache.rows[t]}readTreeNodes(t,e,i,r){let n=!1,o=e;if(isNaN(o)&&o.end)return o;let s=t;return(s||(s={__children:this.data},n=!0,o-=1),null!=i&&o===i)?{result:s,end:!0}:null!=r&&s===r?{result:o,end:!0}:(o+=1,s.__children&&(0,z.arrayEach)(s.__children,t=>{if(this.parentReference.set(t,n?null:s),isNaN(o=this.readTreeNodes(t,o,i,r))&&o.end)return!1}),o)}mockParent(){let t=this.mockNode();return t.__children=this.data,t}mockNode(){let t={};return(0,V.objectEach)(this.data[0],(e,i)=>{t[i]=null}),t}getRowIndex(t){return null==t?null:this.cache.nodeInfo.get(t).row}getRowIndexWithinParent(t){let e=null;e=isNaN(t)?t:this.getDataObject(t);let i=this.getRowParent(t);return null==i?this.data.indexOf(e):i.__children.indexOf(e)}countAllRows(){let t={__children:this.data};return this.countChildren(t)}countChildren(t){let e=0,i=t;return(isNaN(i)||(i=this.getDataObject(i)),i&&i.__children)?((0,z.arrayEach)(i.__children,t=>{e+=1,t.__children&&(e+=this.countChildren(t))}),e):0}getRowParent(t){let e;return e=isNaN(t)?t:this.getDataObject(t),this.getRowObjectParent(e)}getRowObjectParent(t){return t&&"object"==typeof t?this.cache.nodeInfo.get(t).parent:null}getRowLevel(t){let e=null;return(e=isNaN(t)?t:this.getDataObject(t))?this.getRowObjectLevel(e):null}getRowObjectLevel(t){return null==t?null:this.cache.nodeInfo.get(t).level}hasChildren(t){let e=t;return isNaN(e)||(e=this.getDataObject(e)),!!(e.__children&&e.__children.length)}isChild(t){return null!==this.getRowParent(t)}getChild(t,e){var i;return(null===(i=t.__children)||void 0===i?void 0:i[e])||null}isRowHighestLevel(t){return!this.isChild(t)}isParent(t){var e;let i=t;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&(null===(e=i.__children)||void 0===e?void 0:e.length)!==0}addChild(t,e){let i=e;this.hot.runHooks("beforeAddChild",t,i);let r=null;t&&(r=this.getRowIndex(t)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(t)+1,1);let n=t;t||(n=this.mockParent()),n.__children||(n.__children=[]),i||(i=this.mockNode()),n.__children.push(i),this.rewriteCache();let o=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(o,1),this.hot.runHooks("afterCreateRow",o,1),this.hot.runHooks("afterAddChild",t,i)}addChildAtIndex(t,e,i){let r,n=i;if(n||(n=this.mockNode()),this.hot.runHooks("beforeAddChild",t,n,e),t){let i=this.getRowIndex(t)+e+1;this.hot.runHooks("beforeCreateRow",i,1),t.__children.splice(e,null,n),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(t),"__children",t.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(i,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",i,1),r=i}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",e,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),r=this.getRowIndex(this.data[e]);n=this.getDataObject(r),this.hot.runHooks("afterAddChild",t,n,e)}addSibling(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"below",i=this.translateTrimmedRow(t),r=this.getRowParent(i),n=this.getRowIndexWithinParent(i);switch(e){case"below":this.addChildAtIndex(r,n+1,null);break;case"above":this.addChildAtIndex(r,n,null)}}detachFromParent(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=null,r=[];Array.isArray(t)?((0,b.rangeEach)(t[0],t[2],t=>{let e=this.translateTrimmedRow(t);r.push(this.getDataObject(e))}),(0,b.rangeEach)(0,r.length-2,t=>{this.detachFromParent(r[t],!1)}),i=r[r.length-1]):i=t;let n=this.getRowIndex(i),o=this.countChildren(i),s=this.getRowIndexWithinParent(i),l=this.getRowParent(i),a=this.getRowParent(l),h=this.getRowIndex(a),u=null;if(this.hot.runHooks("beforeDetachChild",l,i),null!=s){let t=Array.from(Array(n+o+1).keys()).splice(-1*(o+1));if(this.hot.runHooks("beforeRemoveRow",n,o+1,t,this.plugin.pluginName),l.__children.splice(s,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",n,o+1,t,this.plugin.pluginName),a){u=h+this.countChildren(a);let t=this.getChild(a,this.countChildren(a)-1),e=this.getRowIndex(t);this.hot.runHooks("beforeCreateRow",e+1,o+1,this.plugin.pluginName),a.__children.push(i)}else u=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",u-2,o+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",u-2,o+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",l,i,this.getRowIndex(i)),e&&this.hot.render()}filterData(t,e,i){let r=[];(0,z.arrayEach)(i,t=>{r.push(this.getDataObject(t))}),(0,z.arrayEach)(r,t=>{let e=this.getRowIndexWithinParent(t),i=this.getRowParent(t);null===i?this.data.splice(e,1):i.__children.splice(e,1)}),this.rewriteCache()}spliceData(t,e,i){let r=this.getDataObject(t-1),n=null,o=t;r&&r.__children&&0===r.__children.length?(n=r,o=0):t<this.countAllRows()&&(n=this.getRowParent(t),o=this.getRowIndexWithinParent(t)),n?i?n.__children.splice(o,e,...i):n.__children.splice(o,e):i?this.data.splice(o,e,...i):this.data.splice(o,e),this.rewriteCache()}syncRowWithRawSource(t){let e=t,i=e;do null!==(i=this.getRowParent(i))&&(e=i);while(null!==i);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(t,e,i,r){let n=e===this.hot.countRows(),o=this.getRowParent(t),s=this.getRowIndexWithinParent(t),l=o.__children.slice(s,s+1),a=t>e,h=n?this.getRowParent(e-1):this.getRowParent(e);null==h&&(h=this.getRowParent(e-1)),null==h&&(h=this.getDataObject(e-1)),h?h.__children||(h.__children=[]):(h=this.getDataObject(e)).__children=[];let u=n||i||r?h.__children.length:this.getRowIndexWithinParent(e),c=o===h;h.__children.splice(u,0,l[0]),o.__children.splice(s+(a&&c?1:0),1),this.syncRowWithRawSource(o),c||this.syncRowWithRawSource(h)}translateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(t):t}untranslateTrimmedRow(t){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(t):t}}function p_(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class pD{constructor(t,e){p_(this,"hot",void 0),p_(this,"plugin",void 0),this.hot=e,this.plugin=t}}let pL=pD;class pF extends pL{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(t,e){super(t,e),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(t,e){let i=this.hot.toPhysicalRow(t),r=this.dataManager.getRowLevel(i),n=this.dataManager.getDataObject(i),o=e.getElementsByTagName("DIV")[0],s=o.querySelector("span.rowHeader"),l=o.querySelectorAll('[class^="ht_nesting"]'),a=this.hot.getSettings().ariaTags;if((0,z.arrayEach)(l,t=>{t&&o.removeChild(t)}),(0,y.addClass)(e,pF.CSS_CLASSES.indicatorContainer),r){let{rootDocument:t}=this.hot,e=s.cloneNode(!0);o.innerHTML="",(0,b.rangeEach)(0,r-1,()=>{let e=t.createElement("SPAN");(0,y.addClass)(e,pF.CSS_CLASSES.emptyIndicator),o.appendChild(e)}),o.appendChild(e)}if(this.dataManager.hasChildren(n)){let t=this.hot.rootDocument.createElement("DIV");a&&(0,y.setAttribute)(t,[(0,M.MG)()]),(0,y.addClass)(e,pF.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?((0,y.addClass)(t,`${pF.CSS_CLASSES.button} ${pF.CSS_CLASSES.expandButton}`),a&&(0,y.setAttribute)(e,[(0,M.dV)(!1)])):((0,y.addClass)(t,`${pF.CSS_CLASSES.button} ${pF.CSS_CLASSES.collapseButton}`),a&&(0,y.setAttribute)(e,[(0,M.dV)(!0)])),o.appendChild(t)}}updateRowHeaderWidth(t){let e=t;e||(e=this.dataManager.cache.levelCount);let i=this.hot.view.getStylesHandler(),r=11;i.isClassicTheme()||(r=2*i.getCSSVariableValue("cell-horizontal-padding")),this.rowHeaderWidthCache=Math.max(50,r+10*e+25),this.hot.render()}}class pV extends pL{constructor(t,e){var i;super(t,e),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,t)},shiftStash:function(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;null==e&&(e=1/0),(0,z.arrayEach)(i.lastCollapsedRows,(n,o)=>{n>=t&&n<e&&(i.lastCollapsedRows[o]=n+r)})},applyStash:function(){let t=!(arguments.length>0)||void 0===arguments[0]||arguments[0];i.collapseMultipleChildren(i.lastCollapsedRows,t),i.lastCollapsedRows=void 0},trimStash:(t,e)=>{(0,b.rangeEach)(t,t+e-1,t=>{let e=this.lastCollapsedRows.indexOf(t);e>-1&&this.lastCollapsedRows.splice(e,1)})}}}collapseChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],n=null,o=null,s=null;return isNaN(t)?(n=t,o=this.dataManager.getRowIndex(n)):(n=this.dataManager.getDataObject(t),o=t),this.dataManager.hasChildren(n)&&(0,z.arrayEach)(n.__children,t=>{r.push(this.dataManager.getRowIndex(t))}),s=this.collapseRows(r,!0,!1),i&&this.trimRows(s),e&&this.renderAndAdjust(),-1===this.collapsedRows.indexOf(o)&&this.collapsedRows.push(o),s}collapseMultipleChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,z.arrayEach)(t,t=>{r.push(...this.collapseChildren(t,!1,!1))}),i&&this.trimRows(r),e&&this.renderAndAdjust()}collapseRow(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.collapseRows([t],e)}collapseRows(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,z.arrayEach)(t,t=>{r.push(t),e&&this.collapseChildRows(t,r)}),i&&this.trimRows(r),r}collapseChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){let i=this.dataManager.getDataObject(t);(0,z.arrayEach)(i.__children,t=>{let i=this.dataManager.getRowIndex(t);e.push(i),this.collapseChildRows(i,e)})}i&&this.trimRows(e)}expandRow(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];this.expandRows([t],e)}expandRows(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];return(0,z.arrayEach)(t,t=>{r.push(t),e&&this.expandChildRows(t,r)}),i&&this.untrimRows(r),r}expandChildRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];arguments.length>2&&arguments[2];let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(this.dataManager.hasChildren(t)){let i=this.dataManager.getDataObject(t);(0,z.arrayEach)(i.__children,t=>{if(!this.isAnyParentCollapsed(t)){let i=this.dataManager.getRowIndex(t);e.push(i),this.expandChildRows(i,e)}})}i&&this.untrimRows(e)}expandChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[],n=null,o=null,s=null;return isNaN(t)?(n=t,o=this.dataManager.getRowIndex(t)):(n=this.dataManager.getDataObject(t),o=t),this.collapsedRows.splice(this.collapsedRows.indexOf(o),1),this.dataManager.hasChildren(n)&&(0,z.arrayEach)(n.__children,t=>{let e=this.dataManager.getRowIndex(t);r.push(e)}),s=this.expandRows(r,!0,!1),i&&this.untrimRows(s),e&&this.renderAndAdjust(),s}expandMultipleChildren(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1],i=!(arguments.length>2)||void 0===arguments[2]||arguments[2],r=[];(0,z.arrayEach)(t,t=>{r.push(...this.expandChildren(t,!1,!1))}),i&&this.untrimRows(r),e&&this.renderAndAdjust()}collapseAll(){let t=this.dataManager.getData(),e=[];(0,z.arrayEach)(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.collapseMultipleChildren(e),this.renderAndAdjust()}expandAll(){let t=this.dataManager.getData(),e=[];(0,z.arrayEach)(t,t=>{this.dataManager.hasChildren(t)&&e.push(t)}),this.expandMultipleChildren(e),this.renderAndAdjust()}trimRows(t){this.hot.batchExecution(()=>{(0,z.arrayEach)(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!0)})},!0)}untrimRows(t){this.hot.batchExecution(()=>{(0,z.arrayEach)(t,t=>{this.plugin.collapsedRowsMap.setValueAtIndex(t,!1)})},!0)}areChildrenCollapsed(t){let e=isNaN(t)?t:this.dataManager.getDataObject(t),i=!0;return null===e&&(e={__children:this.dataManager.data}),this.dataManager.hasChildren(e)&&(0,z.arrayEach)(e.__children,t=>{let e=this.dataManager.getRowIndex(t);if(!this.plugin.collapsedRowsMap.getValueAtIndex(e))return i=!1,!1}),i}isAnyParentCollapsed(t){let e=t;for(;null!==e;){e=this.dataManager.getRowParent(e);let t=this.dataManager.getRowIndex(e);if(this.collapsedRows.indexOf(t)>-1)return!0}return!1}toggleState(t,e){if(e.col>=0)return;let i=this.translateTrimmedRow(e.row);(0,y.hasClass)(t.target,pF.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),(0,F.stopImmediatePropagation)(t))}translateTrimmedRow(t){return this.hot.toPhysicalRow(t)}untranslateTrimmedRow(t){return this.hot.toVisualRow(t)}renderAndAdjust(){this.hot.render(),this.hot.view.adjustElementsSize()}}var pW=new WeakMap;class pB extends pL{constructor(){super(...arguments),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"dataManager",this.plugin.dataManager),function(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}(this,pW,{row_above:(t,e)=>{let i=e[e.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(t,e)=>{let i=e[e.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(t){let e=[{key:"add_child",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{let t=this.dataManager.translateTrimmedRow(this.hot.getSelectedLast()[0]),e=this.dataManager.getDataObject(t);this.dataManager.addChild(e)},disabled:()=>{let t=this.hot.getSelectedLast();return!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(tq.CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedLast())},disabled:()=>{let t=this.hot.getSelectedLast(),e=this.dataManager.translateTrimmedRow(t[0]);return!this.dataManager.getRowParent(e)||!t||t[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return(0,b.rangeEach)(0,t.items.length-1,i=>{if(0===i)return(0,z.arrayEach)(e,(e,r)=>{t.items.splice(i+r,0,e)}),!1}),this.modifyRowInsertingOptions(t)}modifyRowInsertingOptions(t){return(0,b.rangeEach)(0,t.items.length-1,e=>{let i=pW.get(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}(pW,this))[t.items[e].key];null!=i&&(t.items[e].callback=i)}),t}}function pj(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class pz{constructor(t){pj(this,"plugin",void 0),pj(this,"hot",void 0),pj(this,"dataManager",void 0),pj(this,"collapsingUI",void 0),this.plugin=t,this.hot=t.hot,this.dataManager=t.dataManager,this.collapsingUI=t.collapsingUI}onBeforeRowMove(t,e,i,r){if(this.displayAPICompatibilityWarning({rows:t,finalIndex:e,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;let n=i===this.hot.countRows(),o=n?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i),s=!0,l=t.map(t=>{if(!s)return!1;let e=this.dataManager.translateTrimmedRow(t);return s=this.shouldAllowMoving(e,o),e}),a=-1===l.indexOf(o);if(!s||!a)return!1;let h=this.getBaseParent(l),u=this.getTargetParent(n,o),c=h===u;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(u),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(l,o,c),this.moveRows(l,o,u),this.dataManager.rewriteCache(),this.moveCellsMeta(l,o),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",t,e,i,r,r&&this.isRowOrderChanged(t,e)),this.hot.render(),this.selectCells(t,i),!1}displayAPICompatibilityWarning(t){let{rows:e,finalIndex:i,dropIndex:r,movePossible:n}=t,o=!1;return(0,T.isUndefined)(r)&&((0,iD.R8)((0,ro.O)`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",e,i,r,n,!1),o=!0),o}shouldAllowMoving(t,e){return!(this.dataManager.isParent(t)||this.dataManager.isRowHighestLevel(t)||t===e||0===e)}getBaseParent(t){return this.dataManager.getRowParent(t[0])}getTargetParent(t,e){let i=this.dataManager.getRowParent(t?e-1:e);return null==i&&(i=this.dataManager.getRowParent(e-1)),i}shiftCollapsibleParentsLocations(t,e,i){i||(Math.max(...t)<=e?this.collapsingUI.collapsedRowsStash.shiftStash(t[0],e,-1*t.length):this.collapsingUI.collapsedRowsStash.shiftStash(e,t[0],t.length))}moveRows(t,e,i){let r=e===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{t.forEach(t=>{this.dataManager.moveRow(t,e,this.movedToCollapsed,r)})})}moveCellsMeta(t,e){let i=[],r=Math.max(...t)<e;t.forEach(t=>{i.push(this.hot.getCellMetaAtRow(t))}),this.hot.spliceCellsMeta(t[0],t.length),this.hot.spliceCellsMeta(e-(r?i.length:0),0,...i)}selectCells(t,e){let i=t.length,r=0,n=0;if(this.movedToCollapsed){let o=null;o=t[i-1]<e?this.dataManager.translateTrimmedRow(e-i):this.dataManager.translateTrimmedRow(e);let s=this.dataManager.getRowParent(null===o?this.hot.countSourceRows()-1:o-1),l=this.dataManager.getRowIndex(s);n=r=this.dataManager.untranslateTrimmedRow(l)}else t[i-1]<e?r=(n=e-1)-i+1:n=(r=e)+i-1;this.hot.selectCells([[r,0,n,this.hot.countCols()-1]],!1)}isRowOrderChanged(t,e){return t.some((t,i)=>t-i!==e)}}function pU(t,e,i){p$(t,e),e.set(t,i)}function p$(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function pY(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function pG(t,e){return t.get(pX(t,e))}function pq(t,e,i){return t.set(pX(t,e),i),i}function pX(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let pK="nestedRows";var pJ=new WeakMap,pQ=new WeakMap,pZ=new WeakSet;class p0 extends eC{constructor(){super(...arguments),function(t,e){p$(t,e),e.add(t)}(this,pZ),pY(this,"dataManager",null),pY(this,"headersUI",null),pY(this,"collapsedRowsMap",null),pU(this,pJ,!1),pU(this,pQ,!1)}static get PLUGIN_KEY(){return pK}static get PLUGIN_PRIORITY(){return 300}isEnabled(){return!!this.hot.getSettings()[pK]}enablePlugin(){var t=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new a4.q),this.dataManager=new pP(this,this.hot),this.collapsingUI=new pV(this,this.hot),this.headersUI=new pF(this,this.hot),this.contextMenuUI=new pB(this,this.hot),this.rowMoveController=new pz(this),this.addHook("afterInit",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,mn).call(t,...i)}),this.addHook("beforeViewRender",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,mo).call(t,...i)}),this.addHook("modifyRowData",function(){return t.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return t.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return t.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p3).call(t,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p9).call(t,...i)}),this.addHook("afterGetRowHeader",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p4).call(t,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p2).call(t,...i)}),this.addHook("beforeRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p7).call(t,...i)}),this.addHook("afterRemoveRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p8).call(t,...i)}),this.addHook("beforeAddChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p6).call(t,...i)}),this.addHook("afterAddChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,mt).call(t,...i)}),this.addHook("beforeDetachChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,me).call(t,...i)}),this.addHook("afterDetachChild",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,mi).call(t,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p5).call(t,...i)}),this.addHook("afterCreateRow",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,mr).call(t,...i)}),this.addHook("beforeRowMove",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return pX(pZ,t,p1).call(t,...i)}),this.addHook("beforeLoadData",t=>pX(pZ,this,ms).call(this,t)),this.addHook("beforeUpdateData",t=>pX(pZ,this,ms).call(this,t)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();let t=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(t),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{let{highlight:t}=this.hot.getSelectedRangeLast(),e=this.collapsingUI.translateTrimmedRow(t.row);return this.collapsingUI.areChildrenCollapsed(e)?this.collapsingUI.expandChildren(e):this.collapsingUI.collapseChildren(e),!1},runOnlyIf:()=>{var t,e;let i=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;return i&&(null===(e=this.hot.getSelectedRangeLast())||void 0===e?void 0:e.isSingle())&&this.hot.selection.isCellVisible(i)&&-1===i.col&&i.row>=0},group:pK,relativeToGroup:W.b,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(pK)}disableCoreAPIModifiers(){pq(pQ,this,!0)}enableCoreAPIModifiers(){pq(pQ,this,!1)}onModifyRowData(t){if(!pG(pQ,this))return this.dataManager.getDataObject(t)}onModifySourceLength(){if(!pG(pQ,this))return this.dataManager.countAllRows()}onBeforeDataSplice(t,e,i){return!!(pG(pQ,this)||this.dataManager.isRowHighestLevel(t))||(this.dataManager.spliceData(t,e,i),!1)}destroy(){super.destroy()}}function p1(t,e,i,r){return this.rowMoveController.onBeforeRowMove(t,e,i,r)}function p2(t,e,i){this.collapsingUI.toggleState(t,e,i)}function p3(t,e,i){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(i[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(i[0],null,-1*e),this.dataManager.filterData(t,e,i),pq(pJ,this,!0),this.dataManager.getData().slice()}function p9(t){return this.contextMenuUI.appendOptions(t)}function p4(t,e){this.headersUI.appendLevelIndicators(t,e)}function p5(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function p8(t,e,i,r){r!==this.pluginName&&this.hot._registerTimeout(()=>{pq(pJ,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function p7(t,e,i){let r=Array.from(i.reduce((t,e)=>{if(this.dataManager.isParent(e)){let i=this.dataManager.getDataObject(e).__children;return t.add(e),Array.isArray(i)&&i.forEach(e=>t.add(this.dataManager.getRowIndex(e))),t}return t.add(e)},new Set));i.length=0,i.push(...r)}function p6(){this.collapsingUI.collapsedRowsStash.stash()}function mt(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function me(){this.collapsingUI.collapsedRowsStash.stash()}function mi(t,e,i){this.collapsingUI.collapsedRowsStash.shiftStash(i,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function mr(){this.dataManager.rewriteCache()}function mn(){this.headersUI.updateRowHeaderWidth()}function mo(t,e){pG(pJ,this)&&(e.skipRender=!0)}function ms(t){if(!(0,ag.isArrayOfObjects)(t)){(0,iD.z3)("The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled."),this.hot.getSettings()[pK]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function ml(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ma{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;ml(this,"rootWindow",void 0),ml(this,"prefix",void 0),ml(this,"savedKeys",[]),this.rootWindow=e,this.prefix=t,this.loadSavedKeys()}saveValue(t,e){this.rootWindow.localStorage.setItem(`${this.prefix}_${t}`,JSON.stringify(e)),-1===this.savedKeys.indexOf(t)&&(this.savedKeys.push(t),this.saveSavedKeys())}loadValue(t,e){let i=this.rootWindow.localStorage.getItem(`${this.prefix}_${void 0===t?e:t}`);return null===i?void 0:JSON.parse(i)}reset(t){this.rootWindow.localStorage.removeItem(`${this.prefix}_${t}`)}resetAll(){(0,z.arrayEach)(this.savedKeys,(t,e)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[e]}`)}),this.clearSavedKeys()}loadSavedKeys(){let t=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),e="string"==typeof t?JSON.parse(t):void 0;this.savedKeys=e||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}d.R.getSingleton().register("persistentStateSave"),d.R.getSingleton().register("persistentStateLoad"),d.R.getSingleton().register("persistentStateReset");let mh="persistentState";class mu extends eC{constructor(){super(...arguments),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"storage",void 0)}static get PLUGIN_KEY(){return mh}static get PLUGIN_PRIORITY(){return 0}isEnabled(){return!!this.hot.getSettings()[mh]}enablePlugin(){this.enabled||(this.storage||(this.storage=new ma(this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(t,e)=>this.saveValue(t,e)),this.addHook("persistentStateLoad",(t,e)=>this.loadValue(t,e)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(t,e){e.value=this.storage.loadValue(t)}saveValue(t,e){this.storage.saveValue(t,e)}resetValue(t){void 0===t?this.storage.resetAll():this.storage.reset(t)}destroy(){super.destroy()}}function mc(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function md(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let mg="search",mf=function(t,e,i,r,n){t.getCellMeta(e,i).isSearchResult=n},mp=function(t,e,i){return!((0,T.isUndefined)(t)||null===t||!t.toLocaleLowerCase||0===t.length||(0,T.isUndefined)(e)||null===e)&&-1!==e.toString().toLocaleLowerCase(i.locale).indexOf(t.toLocaleLowerCase(i.locale))};var mm=new WeakSet;class mw extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,mm),mc(this,"callback",mf),mc(this,"queryMethod",mp),mc(this,"searchResultClass","htSearchResult")}static get PLUGIN_KEY(){return mg}static get PLUGIN_PRIORITY(){return 190}isEnabled(){return this.hot.getSettings()[mg]}enablePlugin(){var t=this;if(this.enabled)return;let e=this.hot.getSettings()[mg];this.updatePluginSettings(e),this.addHook("beforeRenderer",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return md(mm,t,mv).call(t,...i)}),super.enablePlugin()}disablePlugin(){var t=this;let e=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return md(mm,t,mv).call(t,...i)};this.hot.addHook("beforeRenderer",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",e)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getCallback(),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.getQueryMethod(),r=this.hot.countRows(),n=this.hot.countCols(),o=[],s=this.hot;return(0,b.rangeEach)(0,r-1,r=>{(0,b.rangeEach)(0,n-1,n=>{let l=this.hot.getDataAtCell(r,n),a=this.hot.getCellMeta(r,n),h=a.search.callback||e,u=(a.search.queryMethod||i)(t,l,a);u&&o.push({row:r,col:n,data:l}),h&&h(s,r,n,l,u)})}),o}getCallback(){return this.callback}setCallback(t){this.callback=t}getQueryMethod(){return this.queryMethod}setQueryMethod(t){this.queryMethod=t}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(t){this.searchResultClass=t}updatePluginSettings(t){(0,V.isObject)(t)&&(t.searchResultClass&&this.setSearchResultClass(t.searchResultClass),t.queryMethod&&this.setQueryMethod(t.queryMethod),t.callback&&this.setCallback(t.callback))}destroy(){super.destroy()}}function mv(t,e,i,r,n,o){let s=o.className||[],l=[];"string"==typeof s?l=s.split(" "):l.push(...s),this.isEnabled()&&o.isSearchResult?l.includes(this.searchResultClass)||l.push(`${this.searchResultClass}`):l.includes(this.searchResultClass)&&l.splice(l.indexOf(this.searchResultClass),1),o.className=l.join(" ")}function my(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class mb{constructor(t){my(this,"viewportWidth",void 0),my(this,"overwriteColumnWidthFn",void 0),my(this,"baseWidths",new Map),my(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=t}prepare(t){let{viewportWidth:e}=t;this.viewportWidth=e,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(t,e){this.baseWidths.set(t,e)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class mC extends mb{calculate(){let t=Array.from(this.baseWidths).reduce((t,e)=>{let[,i]=e;return t+i},0);if(this.viewportWidth-t<0){this.stretchedWidths.clear();return}let e=this.viewportWidth/t,i=[],r=[],n=this.viewportWidth,o=0;if(this.baseWidths.forEach((t,s)=>{let l=Math.round(t*e),a=this.overwriteColumnWidthFn(l,s);l===a&&l>=ek.j?(i.push([s,a]),o+=a):l!==a&&(i.push([s,a]),r.push(s),n-=a)}),n<=ek.j){this.stretchedWidths.clear();return}let s=n/o,l=-1,a=0;i.forEach((t,e)=>{let[n,o]=t,h=o;r.includes(n)||(h=Math.round(o*s)),this.stretchedWidths.set(n,h),l=n,e<i.length-1&&(a+=h)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(l,Math.round(this.viewportWidth-a))}}function mS(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function mE(t,e){return t.get(mT(t,e))}function mR(t,e,i){return t.set(mT(t,e),i),i}function mT(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var mx=new WeakMap,mM=new WeakMap;class mk extends mb{constructor(){super(...arguments),mS(this,mx,0),mS(this,mM,-1)}prepare(t){super.prepare(t),mR(mx,this,0),mR(mM,this,-1)}setColumnBaseWidth(t,e){super.setColumnBaseWidth(t,e),mR(mM,this,t),mR(mx,this,e)}calculate(){if(-1===mE(mM,this))return;let t=Array.from(this.baseWidths).reduce((t,e)=>{let[,i]=e;return t+i},0),e=Math.max(this.viewportWidth-t+mE(mx,this),0);this.stretchedWidths.set(mE(mM,this),e)}}function mO(t,e,i){mI(t,e),e.set(t,i)}function mI(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function mA(t,e){return t.get(mH(t,e))}function mN(t,e,i){return t.set(mH(t,e),i),i}function mH(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var mP=new WeakMap,m_=new WeakMap,mD=new WeakMap,mL=new WeakMap,mF=new WeakSet;class mV{constructor(t){!function(t,e){mI(t,e),e.add(t)}(this,mF),mO(this,mP,void 0),mO(this,m_,void 0),mO(this,mD,new Map([["all",new mC(mH(mF,this,mj).bind(this))],["last",new mk(mH(mF,this,mj).bind(this))]])),mO(this,mL,"none"),mN(mP,this,t),mN(m_,this,mA(mP,this).columnIndexMapper.createAndRegisterIndexMap("stretchColumns","physicalIndexToValue"))}useStrategy(t){mN(mL,this,mA(mD,this).has(t)?t:"none")}refreshStretching(){if("none"===mA(mL,this)){mA(m_,this).clear();return}mA(mP,this).batchExecution(()=>{mA(m_,this).clear();let t=mA(mD,this).get(mA(mL,this)),e=mA(mP,this).view.getViewportWidth();mH(mF,this,mW).call(this)&&(e-=(0,y.getScrollbarWidth)(mA(mP,this).rootDocument)),t.prepare({viewportWidth:e});for(let e=0;e<mA(mP,this).countCols();e++)mA(mP,this).columnIndexMapper.isHidden(mA(mP,this).toPhysicalColumn(e))||t.setColumnBaseWidth(e,mH(mF,this,mB).call(this,e));t.calculate(),t.getWidths().forEach(t=>{let[e,i]=t;mA(m_,this).setValueAtIndex(mA(mP,this).toPhysicalColumn(e),i)})},!0)}getStretchedWidth(t){return mA(m_,this).getValueAtIndex(mA(mP,this).toPhysicalColumn(t))}}function mW(){let{view:t}=mA(mP,this);if(t.isVerticallyScrollableByWindow())return!1;let e=t.getViewportHeight(),i=mA(mP,this).countRows(),r=t.getStylesHandler().getDefaultRowHeight(),n=0,o=!1;for(let t=0;t<i;t++){var s;if((n+=(null!==(s=mA(mP,this).getRowHeight(t))&&void 0!==s?s:r)+ +(0===t))>e){o=!0;break}}return o}function mB(t){var e;return null!==(e=mA(mP,this).getColWidth(t,"StretchColumns"))&&void 0!==e?e:ek.j}function mj(t,e){return mA(mP,this).runHooks("beforeStretchingColumnWidth",t,e)}function mz(t,e,i){mU(t,e),e.set(t,i)}function mU(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function m$(t,e,i){return t.set(mG(t,e),i),i}function mY(t,e){return t.get(mG(t,e))}function mG(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var mq=new WeakMap,mX=new WeakMap,mK=new WeakMap,mJ=new WeakSet;class mQ extends eC{constructor(){super(...arguments),function(t,e){mU(t,e),e.add(t)}(this,mJ),mz(this,mq,new mV(this.hot)),mz(this,mX,null),mz(this,mK,new ResizeObserver(t=>{requestAnimationFrame(()=>{var e;null!==(e=this.hot)&&void 0!==e&&e.view.isHorizontallyScrollableByWindow()&&t.forEach(t=>{let{contentRect:e}=t;null!==mY(mX,this)&&mY(mX,this)!==e.width&&(this.hot.refreshDimensions(),this.hot.view.adjustElementsSize()),m$(mX,this,e.width)})})}))}static get PLUGIN_KEY(){return"stretchColumns"}static get PLUGIN_PRIORITY(){return 155}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var t=this;this.enabled||(mY(mq,this).useStrategy(this.hot.getSettings().stretchH),mY(mK,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mG(mJ,t,m0).call(t,...i)}),this.addHook("modifyColWidth",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return mG(mJ,t,mZ).call(t,...i)},10),super.enablePlugin())}updatePlugin(){mY(mq,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),mY(mK,this).unobserve(this.hot.rootElement)}getColumnWidth(t){return mY(mq,this).getStretchedWidth(t)}destroy(){mY(mK,this).disconnect(),m$(mK,this,null),m$(mq,this,null),super.destroy()}}function mZ(t,e,i){if(i===this.pluginName)return;let r=this.getColumnWidth(e);return"number"==typeof r?r:t}function m0(t){t&&mY(mq,this).refreshStretching()}function m1(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function m2(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var m3=new WeakSet;class m9 extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,m3),m1(this,"scrollbars",[]),m1(this,"clones",[]),m1(this,"lockedCollection",!1),m1(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return"touchScroll"}static get PLUGIN_PRIORITY(){return 200}static get SETTING_KEYS(){return!0}isEnabled(){return(0,eE.isTouchSupported)()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>m2(m3,this,m4).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>m2(m3,this,m5).call(this)),this.addHook("afterMomentumScroll",()=>m2(m3,this,m8).call(this))}}function m4(){if(this.lockedCollection)return;let{topOverlay:t,bottomOverlay:e,inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:n}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(i),r&&this.scrollbars.push(r),n&&n.clone&&this.scrollbars.push(n),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),i.needFullRender&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&this.clones.push(r.clone.wtTable.holder.parentNode),n&&n.clone&&this.clones.push(n.clone.wtTable.holder.parentNode)}function m5(){this.freezeOverlays=!0,(0,z.arrayEach)(this.clones,t=>{(0,y.addClass)(t,"hide-tween")})}function m8(){this.freezeOverlays=!1,(0,z.arrayEach)(this.clones,t=>{(0,y.removeClass)(t,"hide-tween"),(0,y.addClass)(t,"show-tween")}),this.hot._registerTimeout(()=>{(0,z.arrayEach)(this.clones,t=>{(0,y.removeClass)(t,"show-tween")})},400),(0,z.arrayEach)(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}let m7="trimRows";var m6=new WeakSet;class wt extends eC{constructor(){super(...arguments),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,m6),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[e]=null}(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return m7}static get PLUGIN_PRIORITY(){return 330}isEnabled(){return!!this.hot.getSettings()[m7]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new a4.q),this.trimmedRowsMap.addLocalHook("init",()=>(function(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")})(m6,this,we).call(this)),super.enablePlugin())}updatePlugin(){let t=this.hot.getSettings()[m7];Array.isArray(t)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),(0,z.arrayEach)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(t){let e=this.getTrimmedRows(),i=this.isValidConfig(t),r=e;i&&(r=Array.from(new Set(e.concat(t)))),!1!==this.hot.runHooks("beforeTrimRow",e,r,i)&&(i&&this.hot.batchExecution(()=>{(0,z.arrayEach)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0),this.hot.runHooks("afterTrimRow",e,r,i,i&&r.length>e.length))}trimRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.trimRows(e)}untrimRows(t){let e=this.getTrimmedRows(),i=this.isValidConfig(t),r=e,n=this.trimmedRowsMap.getValues().slice(),o=t.length>0;i&&o&&((0,z.arrayEach)(t,t=>{n[t]=!1}),r=(0,z.arrayReduce)(n,(t,e,i)=>(e&&t.push(i),t),[])),!1!==this.hot.runHooks("beforeUntrimRow",e,r,i&&o)&&(i&&o&&this.trimmedRowsMap.setValues(n),this.hot.runHooks("afterUntrimRow",e,r,i&&o,i&&r.length<e.length))}untrimRow(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];this.untrimRows(e)}isTrimmed(t){return this.trimmedRowsMap.getValueAtIndex(t)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(t){let e=this.hot.countSourceRows();return t.every(t=>Number.isInteger(t)&&t>=0&&t<e)}destroy(){super.destroy()}}function we(){let t=this.hot.getSettings()[m7];Array.isArray(t)&&this.hot.batchExecution(()=>{(0,z.arrayEach)(t,t=>{this.trimmedRowsMap.setValueAtIndex(t,!0)})},!0)}class wi{constructor(t){!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:"",enumerable:!0,configurable:!0,writable:!0}):t[e]=""}(this,"actionType",""),this.actionType=t}undo(){throw Error("Not implemented")}redo(){throw Error("Not implemented")}}function wr(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wn extends wi{constructor(t){let{stateBefore:e,range:i,type:r,alignment:n}=t;super("cell_alignment"),wr(this,"stateBefore",void 0),wr(this,"range",void 0),wr(this,"type",void 0),wr(this,"alignment",void 0),this.stateBefore=e,this.range=i,this.type=r,this.alignment=n}static startRegisteringEvents(t,e){t.addHook("beforeCellAlignment",(t,i,r,n)=>{e.done(()=>new wn({stateBefore:t,range:i,type:r,alignment:n}))})}undo(t,e){(0,z.arrayEach)(this.range,e=>{e.forAll((e,i)=>{e>=0&&i>=0&&t.setCellMeta(e,i,"className",this.stateBefore[e][i]||" htLeft")})}),t.addHookOnce("afterViewRender",e),t.render()}redo(t,e){nr(this.range,this.type,this.alignment,(e,i)=>t.getCellMeta(e,i),(e,i,r,n)=>t.setCellMeta(e,i,r,n)),t.addHookOnce("afterViewRender",e),t.render()}}function wo(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class ws extends wi{constructor(t){let{columns:e,finalIndex:i}=t;super("col_move"),wo(this,"columns",void 0),wo(this,"finalColumnIndex",void 0),this.columns=e.slice(),this.finalColumnIndex=i}static startRegisteringEvents(t,e){t.addHook("beforeColumnMove",(t,i)=>{!1!==t&&e.done(()=>new ws({columns:t,finalIndex:i}))})}undo(t,e){let i=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),hA(this.columns,this.finalColumnIndex,t.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(t=>{let{from:e,to:r}=t;e<r&&(r-=1),i.moveColumn(r,e)}),t.render(),t.deselectCell(),t.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(t,e){let i=t.getPlugin("manualColumnMove");t.addHookOnce("afterViewRender",e),i.moveColumns(this.columns.slice(),this.finalColumnIndex),t.render(),t.deselectCell(),t.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function wl(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wa extends wi{constructor(t){let{currentSortState:e,newSortState:i}=t;super("col_sort"),wl(this,"previousSortState",void 0),wl(this,"nextSortState",void 0),this.previousSortState=e,this.nextSortState=i}static startRegisteringEvents(t,e){t.addHook("beforeColumnSort",(t,i,r)=>{r&&e.done(()=>new wa({currentSortState:t,newSortState:i}))})}undo(t,e){let i=t.getPlugin("columnSorting"),r=t.getPlugin("multiColumnSorting"),n=r.isEnabled()?r:i;this.previousSortState.length?n.sort(this.previousSortState):n.clearSort(),e()}redo(t,e){let i=t.getPlugin("columnSorting"),r=t.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),e()}}function wh(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wu extends wi{constructor(t){let{index:e,amount:i}=t;super("insert_col"),wh(this,"index",void 0),wh(this,"amount",void 0),this.index=e,this.amount=i}static startRegisteringEvents(t,e){t.addHook("afterCreateCol",(t,i,r)=>{e.done(()=>new wu({index:t,amount:i}),r)})}undo(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(t,e){t.addHookOnce("afterCreateCol",e),t.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function wc(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wd extends wi{constructor(t){let{index:e,amount:i}=t;super("insert_row"),wc(this,"index",void 0),wc(this,"amount",void 0),this.index=e,this.amount=i}static startRegisteringEvents(t,e){t.addHook("afterCreateRow",(t,i,r)=>{e.done(()=>new wd({index:t,amount:i}),r)})}undo(t,e){let i=t.countRows(),r=t.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(t,e){t.addHookOnce("afterCreateRow",e),t.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function wg(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wf extends wi{constructor(t){let{changes:e,selected:i,countCols:r,countRows:n}=t;super("change"),wg(this,"changes",void 0),wg(this,"selected",void 0),wg(this,"countCols",void 0),wg(this,"countRows",void 0),this.changes=e,this.selected=i,this.countCols=r,this.countRows=n}static startRegisteringEvents(t,e){t.addHook("beforeChange",function(i,r){let n=i&&i.length;n&&i.find(t=>{let[,,e,i]=t;return e!==i})&&e.done(()=>{let e=i.reduce((t,e)=>(t.push([...e]),t),[]);e.forEach(e=>{e[1]=t.propToCol(e[1])});let r=n>1?this.getSelected():[[e[0][0],e[0][1]]];return new wf({changes:e,selected:r,countCols:t.countCols(),countRows:t.countRows()})},r)})}undo(t,e){let i=(0,V.deepClone)(this.changes);for(let t=0,e=i.length;t<e;t++)i[t].splice(3,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.undo");let r=t.countRows()-this.countRows;r>0&&t.alter("remove_row",null,r,"UndoRedo.undo");let n=t.countCols()-this.countCols;n>0&&t.isColumnModificationAllowed()&&t.alter("remove_col",null,n,"UndoRedo.undo"),t.scrollToFocusedCell(),t.selectCells(this.selected,!1,!1)}redo(t,e){let i=(0,V.deepClone)(this.changes);for(let t=0,e=i.length;t<e;t++)i[t].splice(2,1);t.addHookOnce("afterChange",e),t.setDataAtCell(i,null,null,"UndoRedo.redo"),this.selected&&t.selectCells(this.selected,!1,!1)}}function wp(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wm extends wi{constructor(t){let{conditionsStack:e,previousConditionsStack:i}=t;super("filter"),wp(this,"conditionsStack",void 0),wp(this,"previousConditionsStack",void 0),this.conditionsStack=e,this.previousConditionsStack=i}static startRegisteringEvents(t,e){t.addHook("beforeFilter",(t,i)=>{e.done(()=>new wm({conditionsStack:t,previousConditionsStack:i}))})}undo(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.importConditions(this.previousConditionsStack),i.filter()}redo(t,e){let i=t.getPlugin("filters");t.addHookOnce("afterViewRender",e),i.importConditions(this.conditionsStack),i.filter()}}class ww extends wi{constructor(t){let{data:e,cellRange:i}=t;super("merge_cells"),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"cellRange",void 0),this.cellRange=i,this.data=e}static startRegisteringEvents(t,e){t.addHook("beforeMergeCells",(i,r)=>{if(r)return;let n=i.getTopStartCorner(),o=i.getBottomEndCorner(),s=t.getData(n.row,n.col,o.row,o.col);e.done(()=>new ww({data:s,cellRange:i}))})}undo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.unmergeRange(this.cellRange,!0);let r=this.cellRange.getTopStartCorner();t.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.mergeRange(this.cellRange)}}function wv(t,e,i,r,n){let o=["visualRow","visualCol","row","col","prop"],s=o.length,l=[];return(0,b.rangeEach)(r,n,r=>{(0,b.rangeEach)(e,i,e=>{let i=t.getCellMeta(e,r);if(Object.keys(i).length!==s){let t=Object.fromEntries(Object.entries(i).filter(t=>{let[e]=t;return!1===o.includes(e)}));l.push([i.visualRow,i.visualCol,t])}})}),l}function wy(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}i(91215);class wb extends wi{constructor(t){let{index:e,indexes:i,data:r,amount:n,headers:o,columnPositions:s,rowPositions:l,fixedColumnsStart:a,removedCellMetas:h}=t;super("remove_col"),wy(this,"index",void 0),wy(this,"indexes",void 0),wy(this,"data",void 0),wy(this,"amount",void 0),wy(this,"headers",void 0),wy(this,"columnPositions",void 0),wy(this,"rowPositions",void 0),wy(this,"fixedColumnsStart",void 0),wy(this,"removedCellMetas",void 0),this.index=e,this.indexes=i,this.data=r,this.amount=n,this.headers=o,this.columnPositions=s.slice(0),this.rowPositions=l.slice(0),this.fixedColumnsStart=a,this.removedCellMetas=h}static startRegisteringEvents(t,e){t.addHook("beforeRemoveCol",(i,r,n,o)=>{e.done(()=>{let e=t.getSourceDataArray(),n=(t.countCols()+i)%t.countCols(),o=n+r-1,s=[],l=[],a=[];return(0,b.rangeEach)(e.length-1,i=>{let r=[],l=e[i];(0,b.rangeEach)(n,o,e=>{r.push(l[t.toPhysicalColumn(e)])}),s.push(r)}),(0,b.rangeEach)(r-1,e=>{a.push(t.toPhysicalColumn(n+e))}),Array.isArray(t.getSettings().colHeaders)&&(0,b.rangeEach)(r-1,e=>{l.push(t.getSettings().colHeaders[t.toPhysicalColumn(n+e)]||null)}),new wb({index:n,indexes:a,data:s,amount:r,headers:l,columnPositions:t.columnIndexMapper.getIndexesSequence(),rowPositions:t.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:t.getSettings().fixedColumnsStart,removedCellMetas:wv(t,0,t.countRows(),n,o)})},o)})}undo(t,e){t.getSettings().fixedColumnsStart=this.fixedColumnsStart;let i=this.indexes.slice(0).sort(),r=(t,e,r)=>r[this.indexes.indexOf(i[e])],n=this.data.length,o=[];for(let t=0;t<n;t++)o.push((0,z.arrayMap)(this.data[t],r));let s=(0,z.arrayMap)(this.headers,r),l=[];t.columnIndexMapper.setIndexesSequence(this.columnPositions),t.alter("insert_col_start",t.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),t.batchExecution(()=>{t.rowIndexMapper.setIndexesSequence(this.rowPositions),t.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),(0,z.arrayEach)(t.getSourceDataArray(),(t,e)=>{(0,z.arrayEach)(i,(i,r)=>{t[i]=o[e][r],l.push([e,i,t[i]])})}),void 0!==this.headers&&(0,z.arrayEach)(s,(e,r)=>{t.getSettings().colHeaders[i[r]]=e}),this.removedCellMetas.forEach(e=>{let[i,r,n]=e;t.setCellMetaObject(i,r,n)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(l,null,null,"UndoRedo.undo")}redo(t,e){t.addHookOnce("afterRemoveCol",e),t.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function wC(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wS extends wi{constructor(t){let{index:e,data:i,fixedRowsBottom:r,fixedRowsTop:n,rowIndexesSequence:o,removedCellMetas:s}=t;super("remove_row"),wC(this,"index",void 0),wC(this,"data",void 0),wC(this,"fixedRowsBottom",void 0),wC(this,"fixedRowsTop",void 0),wC(this,"rowIndexesSequence",void 0),wC(this,"removedCellMetas",void 0),this.index=e,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=n,this.rowIndexesSequence=o,this.removedCellMetas=s}static startRegisteringEvents(t,e){t.addHook("beforeRemoveRow",(i,r,n,o)=>{e.done(()=>{let e=t.toPhysicalRow(i),n=e+r-1,o=(0,V.deepClone)(t.getSourceData(e,0,e+r-1,t.countSourceCols()-1));return new wS({index:e,data:o,fixedRowsBottom:t.getSettings().fixedRowsBottom,fixedRowsTop:t.getSettings().fixedRowsTop,rowIndexesSequence:t.rowIndexMapper.getIndexesSequence(),removedCellMetas:wv(t,e,n,0,t.countCols()-1)})},o)})}undo(t,e){let i=t.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((t,e)=>{Object.keys(t).forEach(i=>{let n=parseInt(i,10);r.push([this.index+e,isNaN(n)?i:n,t[i]])})}),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),t.alter("insert_row_above",t.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),t.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(e=>{let[i,r,n]=e;t.setCellMetaObject(i,r,n)}),t.addHookOnce("afterViewRender",e),t.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(t,e){t.addHookOnce("afterRemoveRow",e),t.alter("remove_row",t.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function wE(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class wR extends wi{constructor(t){let{rows:e,finalIndex:i}=t;super("row_move"),wE(this,"rows",void 0),wE(this,"finalRowIndex",void 0),this.rows=e.slice(),this.finalRowIndex=i}static startRegisteringEvents(t,e){t.addHook("beforeRowMove",(t,i)=>{!1!==t&&e.done(()=>new wR({rows:t,finalIndex:i}))})}undo(t,e){let i=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),hA(this.rows,this.finalRowIndex,t.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(t=>{let{from:e,to:r}=t;e<r&&(r-=1),i.moveRow(r,e)}),t.render(),t.deselectCell(),t.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(t,e){let i=t.getPlugin("manualRowMove");t.addHookOnce("afterViewRender",e),i.moveRows(this.rows.slice(),this.finalRowIndex),t.render(),t.deselectCell(),t.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}class wT extends wi{constructor(t){let{cellRange:e}=t;super("unmerge_cells"),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"cellRange",void 0),this.cellRange=e}static startRegisteringEvents(t,e){t.addHook("afterUnmergeCells",(t,i)=>{i||e.done(()=>new wT({cellRange:t}))})}undo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.mergeRange(this.cellRange,!0)}redo(t,e){let i=t.getPlugin("mergeCells");t.addHookOnce("afterViewRender",e),i.unmergeRange(this.cellRange,!0),t.render()}}function wx(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function wM(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}let wk="undoRedo";d.R.getSingleton().register("beforeUndo"),d.R.getSingleton().register("afterUndo"),d.R.getSingleton().register("beforeRedo"),d.R.getSingleton().register("afterRedo");let wO=new Set;var wI=new WeakSet;class wA extends eC{static get PLUGIN_KEY(){return"undoRedo"}static get PLUGIN_PRIORITY(){return 1e3}static get SETTING_KEYS(){return!0}constructor(t){var e;super(t),function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,wI),wx(this,"doneActions",[]),wx(this,"undoneActions",[]),wx(this,"ignoreNewActions",!1),e=this,[wn,ws,wa,wu,wd,wf,wm,ww,wb,wS,wR,wT].forEach(i=>i.startRegisteringEvents(t,e))}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var t=this;this.enabled||(this.addHook("afterChange",function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return wM(wI,t,wN).call(t,...i)}),this.registerShortcuts(),wM(wI,this,wH).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),wM(wI,this,wP).call(this)}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],{runOnlyIf:t=>!t.altKey,group:wk})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(wk)}done(t,e){if(this.ignoreNewActions||"UndoRedo.undo"===e||"UndoRedo.redo"===e||"auto"===e)return;let i=this.doneActions.slice();if(!1===this.hot.runHooks("beforeUndoStackChange",i,e))return;let r=t(),n=this.undoneActions.slice();this.doneActions.push(r),this.hot.runHooks("afterUndoStackChange",i,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",n),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",n,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;let t=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",t);let e=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",t,this.doneActions.slice());let i=(0,V.deepClone)(e);if(!1===this.hot.runHooks("beforeUndo",i))return;this.ignoreNewActions=!0;let r=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",r),e.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(e)}),this.hot.runHooks("afterRedoStackChange",r,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;let t=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",t);let e=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",t,this.undoneActions.slice());let i=(0,V.deepClone)(e);if(!1===this.hot.runHooks("beforeRedo",i))return;this.ignoreNewActions=!0;let r=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",r),e.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(e)}),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function wN(t,e){"loadData"===e&&this.clear()}function wH(){let t=t=>{wO.has(t)||((0,iD.R8)((0,ro.O)`The "${t}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${t}()\`).`),wO.add(t))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function wP(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}var w_=i(41973);(0,tU.VA)(p.b7),(0,tU.VA)(te),(0,tU.VA)(tr),(0,tU.VA)(t_),(0,tU.VA)(tL),(0,tU.VA)(j),(0,tU.VA)(tF),(0,tU.VA)(tV),(0,tU.VA)(tj),(0,tU.VA)(A),(0,tU.VA)(tz),(0,t6.TS)(tY),(0,t6.TS)(N),(0,t6.TS)(t0),(0,t6.TS)(tG),(0,t6.TS)(t2),(0,t6.TS)(t$),(0,t6.TS)(t4),(0,t6.TS)(t5),(0,t6.TS)(t8),(0,t6.TS)(H),(0,t6.TS)(t7),(0,ea.qV)(et),(0,ea.qV)(en),(0,ea.qV)(er),(0,ea.qV)(eo),(0,ea.qV)(el),(0,f.Gk)({CELL_TYPE:"autocomplete",editor:te,renderer:tY,validator:et}),(0,f.Gk)({CELL_TYPE:"checkbox",editor:tr,renderer:t0}),(0,f.Gk)({CELL_TYPE:"date",editor:t_,renderer:eh,validator:er}),(0,f.Gk)({CELL_TYPE:"dropdown",editor:tL,renderer:tG,validator:en,filter:!1,strict:!0}),(0,f.Gk)({CELL_TYPE:"handsontable",editor:j,renderer:t2}),(0,f.Gk)({CELL_TYPE:"numeric",editor:tF,renderer:t4,validator:eo,dataType:"number"}),(0,f.Gk)({CELL_TYPE:"password",editor:tV,renderer:t5,copyable:!1}),(0,f.Gk)({CELL_TYPE:"select",editor:tj,renderer:t8}),(0,f.Gk)(P),(0,f.Gk)({CELL_TYPE:"time",editor:tz,renderer:t7,validator:el}),(0,eu.F3)(eB),(0,eu.F3)(e3),(0,eu.F3)(iu),(0,eu.F3)(iP),(0,eu.F3)(iG),(0,eu.F3)(rE),(0,eu.F3)(rP),(0,eu.F3)(nT),(0,eu.F3)(ox),(0,eu.F3)(so),(0,eu.F3)(sk),(0,eu.F3)(s_),(0,eu.F3)(s$),(0,eu.F3)(li),(0,eu.F3)(hl),(0,eu.F3)(uo),(0,eu.F3)(uV),(0,eu.F3)(uZ),(0,eu.F3)(cr),(0,eu.F3)(cH),(0,eu.F3)(dt),(0,eu.F3)(dH),(0,eu.F3)(gt),(0,eu.F3)(g1),(0,eu.F3)(fb),(0,eu.F3)(fS),(0,eu.F3)(pf),(0,eu.F3)(p0),(0,eu.F3)(mu),(0,eu.F3)(mw),(0,eu.F3)(mQ),(0,eu.F3)(m9),(0,eu.F3)(wt),(0,eu.F3)(wA),function(t){let e="undefined"!=typeof window&&window.jQuery;e&&(e.fn.handsontable=function(e){let i,r=this.first(),n=r.data("handsontable");if("string"!=typeof e){let i=e||{};return n?n.updateSettings(i):(n=new t.Core(r[0],i),r.data("handsontable",n),n.init()),r}if(n)if(void 0!==n[e]){for(var o=arguments.length,s=Array(o>1?o-1:0),l=1;l<o;l++)s[l-1]=arguments[l];i=n[e].call(n,...s),"destroy"===e&&r.removeData()}else throw Error(`Handsontable do not provide action: ${e}`);return i})}(L),L.__GhostTable=eT,L._getListenersCounter=m.O,L._getRegisteredMapsCounter=w_.o,L.EventManager=m.A;let wD=[z,w,ag,a,eE,Y,T,b,V,U,$,oK],wL=[y,F];L.helper={},L.dom={},z.arrayEach(wD,t=>{z.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(L.helper[e]=t[e])})}),z.arrayEach(wL,t=>{z.arrayEach(Object.getOwnPropertyNames(t),e=>{"_"!==e.charAt(0)&&(L.dom[e]=t[e])})}),L.cellTypes=null!==(r=L.cellTypes)&&void 0!==r?r:{},z.arrayEach((0,f.lY)(),t=>{L.cellTypes[t]=(0,f.r0)(t)}),L.cellTypes.registerCellType=f.Gk,L.cellTypes.getCellType=f.r0,L.editors=null!==(n=L.editors)&&void 0!==n?n:{},z.arrayEach((0,tU.sY)(),t=>{L.editors[`${U.toUpperCaseFirst(t)}Editor`]=(0,tU.M8)(t)}),L.editors.registerEditor=tU.VA,L.editors.getEditor=tU.M8,L.renderers=null!==(o=L.renderers)&&void 0!==o?o:{},z.arrayEach((0,t6.Yx)(),t=>{let e=(0,t6.gB)(t);"base"===t&&(L.renderers.cellDecorator=e),L.renderers[`${U.toUpperCaseFirst(t)}Renderer`]=e}),L.renderers.registerRenderer=t6.TS,L.renderers.getRenderer=t6.gB,L.validators=null!==(s=L.validators)&&void 0!==s?s:{},z.arrayEach((0,ea.P1)(),t=>{L.validators[`${U.toUpperCaseFirst(t)}Validator`]=(0,ea.by)(t)}),L.validators.registerValidator=ea.qV,L.validators.getValidator=ea.by,L.plugins=null!==(l=L.plugins)&&void 0!==l?l:{},z.arrayEach((0,eu.f4)(),t=>{L.plugins[t]=(0,eu.sd)(t)}),L.plugins[`${U.toUpperCaseFirst(eC.PLUGIN_KEY)}Plugin`]=eC,L.plugins.registerPlugin=eu.F3,L.plugins.getPlugin=eu.sd;let wF=L},42620:function(t,e,i){"use strict";var r=function(t){return t&&t.Math===Math&&t};t.exports=r("object"==typeof globalThis&&globalThis)||r("object"==typeof window&&window)||r("object"==typeof self&&self)||r("object"==typeof i.g&&i.g)||r("object"==typeof this&&this)||function(){return this}()||Function("return this")()},42665:(t,e,i)=>{"use strict";var r=i(5383);t.exports=function(t){var e=+t;return e!=e||0===e?0:r(e)}},42947:t=>{"use strict";var e=TypeError;t.exports=function(t){if(t>0x1fffffffffffff)throw e("Maximum allowed index exceeded");return t}},43163:(t,e,i)=>{"use strict";i.d(e,{Q:()=>n});var r=i(89447);function n(t,e){let i=(0,r.a)(t,null==e?void 0:e.in),n=i.getFullYear();return i.setFullYear(n+1,0,0),i.setHours(23,59,59,999),i}},43942:(t,e,i)=>{"use strict";i(64571)},43987:(t,e,i)=>{"use strict";var r,n,o,s,l=i(42620),a=i(62495),h=i(89364),u=i(99365),c=i(95467),d=i(56963),g=i(56899),f=i(13928),p=i(15567),m=i(46724),w=i(34498),y=i(83869),b=l.setImmediate,C=l.clearImmediate,S=l.process,E=l.Dispatch,R=l.Function,T=l.MessageChannel,x=l.String,M=0,k={},O="onreadystatechange";d(function(){r=l.location});var I=function(t){if(c(k,t)){var e=k[t];delete k[t],e()}},A=function(t){return function(){I(t)}},N=function(t){I(t.data)},H=function(t){l.postMessage(x(t),r.protocol+"//"+r.host)};b&&C||(b=function(t){m(arguments.length,1);var e=u(t)?t:R(t),i=f(arguments,1);return k[++M]=function(){a(e,void 0,i)},n(M),M},C=function(t){delete k[t]},y?n=function(t){S.nextTick(A(t))}:E&&E.now?n=function(t){E.now(A(t))}:T&&!w?(s=(o=new T).port2,o.port1.onmessage=N,n=h(s.postMessage,s)):l.addEventListener&&u(l.postMessage)&&!l.importScripts&&r&&"file:"!==r.protocol&&!d(H)?(n=H,l.addEventListener("message",N,!1)):n=O in p("script")?function(t){g.appendChild(p("script"))[O]=function(){g.removeChild(this),I(t)}}:function(t){setTimeout(A(t),0)}),t.exports={set:b,clear:C}},44065:(t,e,i)=>{"use strict";i.d(e,{o:()=>o}),i(19398);var r=i(12522),n=i(95061);class o extends r._{constructor(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];super(t)}getHiddenIndexes(){return(0,n.arrayReduce)(this.getValues(),(t,e,i)=>(e&&t.push(i),t),[])}}},46420:(t,e,i)=>{"use strict";i.d(e,{TS:()=>h,Yx:()=>s,gB:()=>a,sl:()=>o}),i(41658);let{register:r,getItem:n,hasItem:o,getNames:s,getValues:l}=(0,i(21413).A)("renderers");function a(t){if("function"==typeof t)return t;if(!o(t))throw Error(`No registered renderer found under "${t}" name`);return n(t)}function h(t,e){"string"!=typeof t&&(t=(e=t).RENDERER_TYPE),r(t,e)}},46724:t=>{"use strict";var e=TypeError;t.exports=function(t,i){if(t<i)throw new e("Not enough arguments");return t}},47580:(t,e,i)=>{"use strict";var r=i(34323),n=i(24851);t.exports=function(t,e,i){return i.get&&r(i.get,e,{getter:!0}),i.set&&r(i.set,e,{setter:!0}),n.f(t,e,i)}},48195:(t,e,i)=>{"use strict";var r=i(67297),n=i(76494),o=i(241),s=i(38896),l=i(4230),a=i(7107),h=TypeError,u=a("toPrimitive");t.exports=function(t,e){if(!n(t)||o(t))return t;var i,a=s(t,u);if(a){if(void 0===e&&(e="default"),!n(i=r(a,t,e))||o(i))return i;throw new h("Can't convert object to primitive value")}return void 0===e&&(e="number"),l(t,e)}},48882:(t,e,i)=>{"use strict";i.d(e,{P:()=>o});var r=i(7239),n=i(89447);function o(t,e,i){let o=(0,n.a)(t,null==i?void 0:i.in);if(isNaN(e))return(0,r.w)((null==i?void 0:i.in)||t,NaN);if(!e)return o;let s=o.getDate(),l=(0,r.w)((null==i?void 0:i.in)||t,o.getTime());return(l.setMonth(o.getMonth()+e+1,0),s>=l.getDate())?l:(o.setFullYear(l.getFullYear(),l.getMonth(),s),o)}},49291:(t,e,i)=>{"use strict";i.d(e,{Z:()=>o});var r=i(7239),n=i(89447);function o(t,e,i){let o=(0,n.a)(t,null==i?void 0:i.in),s=o.getFullYear(),l=o.getDate(),a=(0,r.w)((null==i?void 0:i.in)||t,0);a.setFullYear(s,e,15),a.setHours(0,0,0,0);let h=function(t,e){let i=(0,n.a)(t,void 0),o=i.getFullYear(),s=i.getMonth(),l=(0,r.w)(i,0);return l.setFullYear(o,s+1,0),l.setHours(0,0,0,0),l.getDate()}(a);return o.setMonth(e,Math.min(l,h)),o}},50007:(t,e,i)=>{"use strict";i.d(e,{m:()=>l});var r=i(97444),n=i(61183),o=i(25703),s=i(6711);function l(t,e,i){let[l,a]=(0,n.x)(null==i?void 0:i.in,t,e),h=(0,s.o)(l),u=(0,s.o)(a);return Math.round((+h-(0,r.G)(h)-(+u-(0,r.G)(u)))/o.w4)}},50320:(t,e,i)=>{"use strict";var r=i(99365),n=i(92743),o=TypeError;t.exports=function(t){if(r(t))return t;throw new o(n(t)+" is not a function")}},50344:(t,e,i)=>{"use strict";var r=i(42620),n=i(99365),o=r.WeakMap;t.exports=n(o)&&/native code/.test(String(o))},51308:(t,e,i)=>{"use strict";i.d(e,{m:()=>o});let r=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});default:return e.date({width:"full"})}},n=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});default:return e.time({width:"full"})}},o={p:n,P:(t,e)=>{let i,o=t.match(/(P+)(p+)?/)||[],s=o[1],l=o[2];if(!l)return r(t,e);switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;default:i=e.dateTime({width:"full"})}return i.replace("{{date}}",r(s,e)).replace("{{time}}",n(l,e))}}},52571:(t,e,i)=>{"use strict";i.d(e,{$t:()=>R,LN:()=>s,U3:()=>u,hs:()=>k,i5:()=>f,k_:()=>T,nh:()=>d,yn:()=>l});var r=i(10156),n=i(808);let o=Object.create(null);class s{constructor(t,e,i){this.$anchor=t,this.$head=e,this.ranges=i||[new l(t.min(e),t.max(e))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let t=this.ranges;for(let e=0;e<t.length;e++)if(t[e].$from.pos!=t[e].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(t,e=r.Ji.empty){let i=e.content.lastChild,n=null;for(let t=0;t<e.openEnd;t++)n=i,i=i.lastChild;let o=t.steps.length,s=this.ranges;for(let l=0;l<s.length;l++){let{$from:a,$to:h}=s[l],u=t.mapping.slice(o);t.replaceRange(u.map(a.pos),u.map(h.pos),l?r.Ji.empty:e),0==l&&w(t,o,(i?i.isInline:n&&n.isTextblock)?-1:1)}}replaceWith(t,e){let i=t.steps.length,r=this.ranges;for(let n=0;n<r.length;n++){let{$from:o,$to:s}=r[n],l=t.mapping.slice(i),a=l.map(o.pos),h=l.map(s.pos);n?t.deleteRange(a,h):(t.replaceRangeWith(a,h,e),w(t,i,e.isInline?-1:1))}}static findFrom(t,e,i=!1){let r=t.parent.inlineContent?new u(t):m(t.node(0),t.parent,t.pos,t.index(),e,i);if(r)return r;for(let r=t.depth-1;r>=0;r--){let n=e<0?m(t.node(0),t.node(r),t.before(r+1),t.index(r),e,i):m(t.node(0),t.node(r),t.after(r+1),t.index(r)+1,e,i);if(n)return n}return null}static near(t,e=1){return this.findFrom(t,e)||this.findFrom(t,-e)||new f(t.node(0))}static atStart(t){return m(t,t,0,0,1)||new f(t)}static atEnd(t){return m(t,t,t.content.size,t.childCount,-1)||new f(t)}static fromJSON(t,e){if(!e||!e.type)throw RangeError("Invalid input for Selection.fromJSON");let i=o[e.type];if(!i)throw RangeError(`No selection type ${e.type} defined`);return i.fromJSON(t,e)}static jsonID(t,e){if(t in o)throw RangeError("Duplicate use of selection JSON ID "+t);return o[t]=e,e.prototype.jsonID=t,e}getBookmark(){return u.between(this.$anchor,this.$head).getBookmark()}}s.prototype.visible=!0;class l{constructor(t,e){this.$from=t,this.$to=e}}let a=!1;function h(t){a||t.parent.inlineContent||(a=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+t.parent.type.name+")"))}class u extends s{constructor(t,e=t){h(t),h(e),super(t,e)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(t,e){let i=t.resolve(e.map(this.head));if(!i.parent.inlineContent)return s.near(i);let r=t.resolve(e.map(this.anchor));return new u(r.parent.inlineContent?r:i,i)}replace(t,e=r.Ji.empty){if(super.replace(t,e),e==r.Ji.empty){let e=this.$from.marksAcross(this.$to);e&&t.ensureMarks(e)}}eq(t){return t instanceof u&&t.anchor==this.anchor&&t.head==this.head}getBookmark(){return new c(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(t,e){if("number"!=typeof e.anchor||"number"!=typeof e.head)throw RangeError("Invalid input for TextSelection.fromJSON");return new u(t.resolve(e.anchor),t.resolve(e.head))}static create(t,e,i=e){let r=t.resolve(e);return new this(r,i==e?r:t.resolve(i))}static between(t,e,i){let r=t.pos-e.pos;if((!i||r)&&(i=r>=0?1:-1),!e.parent.inlineContent){let t=s.findFrom(e,i,!0)||s.findFrom(e,-i,!0);if(!t)return s.near(e,i);e=t.$head}return t.parent.inlineContent||(0==r?t=e:(t=(s.findFrom(t,-i,!0)||s.findFrom(t,i,!0)).$anchor).pos<e.pos==r<0||(t=e)),new u(t,e)}}s.jsonID("text",u);class c{constructor(t,e){this.anchor=t,this.head=e}map(t){return new c(t.map(this.anchor),t.map(this.head))}resolve(t){return u.between(t.resolve(this.anchor),t.resolve(this.head))}}class d extends s{constructor(t){let e=t.nodeAfter;super(t,t.node(0).resolve(t.pos+e.nodeSize)),this.node=e}map(t,e){let{deleted:i,pos:r}=e.mapResult(this.anchor),n=t.resolve(r);return i?s.near(n):new d(n)}content(){return new r.Ji(r.FK.from(this.node),0,0)}eq(t){return t instanceof d&&t.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new g(this.anchor)}static fromJSON(t,e){if("number"!=typeof e.anchor)throw RangeError("Invalid input for NodeSelection.fromJSON");return new d(t.resolve(e.anchor))}static create(t,e){return new d(t.resolve(e))}static isSelectable(t){return!t.isText&&!1!==t.type.spec.selectable}}d.prototype.visible=!1,s.jsonID("node",d);class g{constructor(t){this.anchor=t}map(t){let{deleted:e,pos:i}=t.mapResult(this.anchor);return e?new c(i,i):new g(i)}resolve(t){let e=t.resolve(this.anchor),i=e.nodeAfter;return i&&d.isSelectable(i)?new d(e):s.near(e)}}class f extends s{constructor(t){super(t.resolve(0),t.resolve(t.content.size))}replace(t,e=r.Ji.empty){if(e==r.Ji.empty){t.delete(0,t.doc.content.size);let e=s.atStart(t.doc);e.eq(t.selection)||t.setSelection(e)}else super.replace(t,e)}toJSON(){return{type:"all"}}static fromJSON(t){return new f(t)}map(t){return new f(t)}eq(t){return t instanceof f}getBookmark(){return p}}s.jsonID("all",f);let p={map(){return this},resolve:t=>new f(t)};function m(t,e,i,r,n,o=!1){if(e.inlineContent)return u.create(t,i);for(let s=r-(n>0?0:1);n>0?s<e.childCount:s>=0;s+=n){let r=e.child(s);if(r.isAtom){if(!o&&d.isSelectable(r))return d.create(t,i-(n<0?r.nodeSize:0))}else{let e=m(t,r,i+n,n<0?r.childCount:0,n,o);if(e)return e}i+=r.nodeSize*n}return null}function w(t,e,i){let r,o=t.steps.length-1;if(o<e)return;let l=t.steps[o];(l instanceof n.Ln||l instanceof n.Wg)&&(t.mapping.maps[o].forEach((t,e,i,n)=>{null==r&&(r=n)}),t.setSelection(s.near(t.doc.resolve(r),i)))}class y extends n.dL{constructor(t){super(t.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=t.selection,this.storedMarks=t.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(t){if(t.$from.doc!=this.doc)throw RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=t,this.curSelectionFor=this.steps.length,this.updated=(1|this.updated)&-3,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(t){return this.storedMarks=t,this.updated|=2,this}ensureMarks(t){return r.CU.sameSet(this.storedMarks||this.selection.$from.marks(),t)||this.setStoredMarks(t),this}addStoredMark(t){return this.ensureMarks(t.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(t){return this.ensureMarks(t.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(t,e){super.addStep(t,e),this.updated=-3&this.updated,this.storedMarks=null}setTime(t){return this.time=t,this}replaceSelection(t){return this.selection.replace(this,t),this}replaceSelectionWith(t,e=!0){let i=this.selection;return e&&(t=t.mark(this.storedMarks||(i.empty?i.$from.marks():i.$from.marksAcross(i.$to)||r.CU.none))),i.replaceWith(this,t),this}deleteSelection(){return this.selection.replace(this),this}insertText(t,e,i){let r=this.doc.type.schema;if(null==e)return t?this.replaceSelectionWith(r.text(t),!0):this.deleteSelection();{if(null==i&&(i=e),i=null==i?e:i,!t)return this.deleteRange(e,i);let n=this.storedMarks;if(!n){let t=this.doc.resolve(e);n=i==e?t.marks():t.marksAcross(this.doc.resolve(i))}return this.replaceRangeWith(e,i,r.text(t,n)),this.selection.empty||this.setSelection(s.near(this.selection.$to)),this}}setMeta(t,e){return this.meta["string"==typeof t?t:t.key]=e,this}getMeta(t){return this.meta["string"==typeof t?t:t.key]}get isGeneric(){for(let t in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function b(t,e){return e&&t?t.bind(e):t}class C{constructor(t,e,i){this.name=t,this.init=b(e.init,i),this.apply=b(e.apply,i)}}let S=[new C("doc",{init:t=>t.doc||t.schema.topNodeType.createAndFill(),apply:t=>t.doc}),new C("selection",{init:(t,e)=>t.selection||s.atStart(e.doc),apply:t=>t.selection}),new C("storedMarks",{init:t=>t.storedMarks||null,apply:(t,e,i,r)=>r.selection.$cursor?t.storedMarks:null}),new C("scrollToSelection",{init:()=>0,apply:(t,e)=>t.scrolledIntoView?e+1:e})];class E{constructor(t,e){this.schema=t,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=S.slice(),e&&e.forEach(t=>{if(this.pluginsByKey[t.key])throw RangeError("Adding different instances of a keyed plugin ("+t.key+")");this.plugins.push(t),this.pluginsByKey[t.key]=t,t.spec.state&&this.fields.push(new C(t.key,t.spec.state,t))})}}class R{constructor(t){this.config=t}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(t){return this.applyTransaction(t).state}filterTransaction(t,e=-1){for(let i=0;i<this.config.plugins.length;i++)if(i!=e){let e=this.config.plugins[i];if(e.spec.filterTransaction&&!e.spec.filterTransaction.call(e,t,this))return!1}return!0}applyTransaction(t){if(!this.filterTransaction(t))return{state:this,transactions:[]};let e=[t],i=this.applyInner(t),r=null;for(;;){let n=!1;for(let o=0;o<this.config.plugins.length;o++){let s=this.config.plugins[o];if(s.spec.appendTransaction){let l=r?r[o].n:0,a=r?r[o].state:this,h=l<e.length&&s.spec.appendTransaction.call(s,l?e.slice(l):e,a,i);if(h&&i.filterTransaction(h,o)){if(h.setMeta("appendedTransaction",t),!r){r=[];for(let t=0;t<this.config.plugins.length;t++)r.push(t<o?{state:i,n:e.length}:{state:this,n:0})}e.push(h),i=i.applyInner(h),n=!0}r&&(r[o]={state:i,n:e.length})}}if(!n)return{state:i,transactions:e}}}applyInner(t){if(!t.before.eq(this.doc))throw RangeError("Applying a mismatched transaction");let e=new R(this.config),i=this.config.fields;for(let r=0;r<i.length;r++){let n=i[r];e[n.name]=n.apply(t,this[n.name],this,e)}return e}get tr(){return new y(this)}static create(t){let e=new E(t.doc?t.doc.type.schema:t.schema,t.plugins),i=new R(e);for(let r=0;r<e.fields.length;r++)i[e.fields[r].name]=e.fields[r].init(t,i);return i}reconfigure(t){let e=new E(this.schema,t.plugins),i=e.fields,r=new R(e);for(let e=0;e<i.length;e++){let n=i[e].name;r[n]=this.hasOwnProperty(n)?this[n]:i[e].init(t,r)}return r}toJSON(t){let e={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(e.storedMarks=this.storedMarks.map(t=>t.toJSON())),t&&"object"==typeof t)for(let i in t){if("doc"==i||"selection"==i)throw RangeError("The JSON fields `doc` and `selection` are reserved");let r=t[i],n=r.spec.state;n&&n.toJSON&&(e[i]=n.toJSON.call(r,this[r.key]))}return e}static fromJSON(t,e,i){if(!e)throw RangeError("Invalid input for EditorState.fromJSON");if(!t.schema)throw RangeError("Required config field 'schema' missing");let n=new E(t.schema,t.plugins),o=new R(n);return n.fields.forEach(n=>{if("doc"==n.name)o.doc=r.bP.fromJSON(t.schema,e.doc);else if("selection"==n.name)o.selection=s.fromJSON(o.doc,e.selection);else if("storedMarks"==n.name)e.storedMarks&&(o.storedMarks=e.storedMarks.map(t.schema.markFromJSON));else{if(i)for(let r in i){let s=i[r],l=s.spec.state;if(s.key==n.name&&l&&l.fromJSON&&Object.prototype.hasOwnProperty.call(e,r)){o[n.name]=l.fromJSON.call(s,t,e[r],o);return}}o[n.name]=n.init(t,o)}}),o}}class T{constructor(t){this.spec=t,this.props={},t.props&&function t(e,i,r){for(let n in e){let o=e[n];o instanceof Function?o=o.bind(i):"handleDOMEvents"==n&&(o=t(o,i,{})),r[n]=o}return r}(t.props,this,this.props),this.key=t.key?t.key.key:M("plugin")}getState(t){return t[this.key]}}let x=Object.create(null);function M(t){return t in x?t+"$"+ ++x[t]:(x[t]=0,t+"$")}class k{constructor(t="key"){this.key=M(t)}get(t){return t.config.pluginsByKey[this.key]}getState(t){return t[this.key]}}},52596:(t,e,i)=>{"use strict";function r(){for(var t,e,i=0,r="",n=arguments.length;i<n;i++)(t=arguments[i])&&(e=function t(e){var i,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e)){var o=e.length;for(i=0;i<o;i++)e[i]&&(r=t(e[i]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}(t))&&(r&&(r+=" "),r+=e);return r}i.d(e,{$:()=>r})},53231:(t,e,i)=>{"use strict";i.d(e,{w:()=>n});var r=i(89447);function n(t,e){let i=(0,r.a)(t,null==e?void 0:e.in);return i.setDate(1),i.setHours(0,0,0,0),i}},53469:(t,e,i)=>{"use strict";var r=i(42620).navigator,n=r&&r.userAgent;t.exports=n?String(n):""},53480:(t,e,i)=>{"use strict";var r=i(14412),n=i(24851),o=i(32138);t.exports=function(t,e,i){r?n.f(t,e,o(0,i)):t[e]=i}},53545:(t,e,i)=>{"use strict";var r=i(54076),n=i(80729);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("isSupersetOf",function(t){return!t})},{isSupersetOf:n})},54076:(t,e,i)=>{"use strict";var r=i(42620),n=i(64897).f,o=i(24201),s=i(34988),l=i(7687),a=i(37e3),h=i(83072);t.exports=function(t,e){var i,u,c,d,g,f=t.target,p=t.global,m=t.stat;if(i=p?r:m?r[f]||l(f,{}):r[f]&&r[f].prototype)for(u in e){if(d=e[u],c=t.dontCallGetSet?(g=n(i,u))&&g.value:i[u],!h(p?u:f+(m?".":"#")+u,t.forced)&&void 0!==c){if(typeof d==typeof c)continue;a(d,c)}(t.sham||c&&c.sham)&&o(d,"sham",!0),s(i,u,d,t)}}},54549:(t,e,i)=>{"use strict";i.d(e,{k:()=>n});var r=i(85118);function n(t,e,i){return(0,r.J)(t,-e,i)}},54674:(t,e,i)=>{"use strict";var r=i(93840),n=i(95467),o=i(13517),s=i(96843).indexOf,l=i(4389),a=r([].push);t.exports=function(t,e){var i,r=o(t),h=0,u=[];for(i in r)!n(l,i)&&n(r,i)&&a(u,i);for(;e.length>h;)n(r,i=e[h++])&&(~s(u,i)||a(u,i));return u}},54733:t=>{"use strict";t.exports={}},55289:(t,e,i)=>{"use strict";i(81315)("flatMap")},55415:(t,e,i)=>{"use strict";var r=i(99365),n=i(76494),o=i(65847);t.exports=function(t,e,i){var s,l;return o&&r(s=e.constructor)&&s!==i&&n(l=s.prototype)&&l!==i.prototype&&o(t,l),t}},55544:(t,e,i)=>{"use strict";var r=i(54674),n=i(66627);t.exports=Object.keys||function(t){return r(t,n)}},55551:(t,e,i)=>{"use strict";i.d(e,{C:()=>n});var r=i(89447);function n(t,e){return(0,r.a)(t,null==e?void 0:e.in).getFullYear()}},56135:t=>{"use strict";t.exports=function(t){return null==t}},56146:(t,e,i)=>{"use strict";i.d(e,{j:()=>o});var r=i(7239),n=i(89447);function o(t,e){let i,o=null==e?void 0:e.in;return t.forEach(t=>{o||"object"!=typeof t||(o=r.w.bind(null,t));let e=(0,n.a)(t,o);(!i||i>e||isNaN(+e))&&(i=e)}),(0,r.w)(o,i||NaN)}},56395:(t,e,i)=>{"use strict";var r=i(42620);t.exports=function(t,e){var i=r.Iterator,n=i&&i.prototype,o=n&&n[t],s=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){s=!0}},-1)}catch(t){t instanceof e||(s=!1)}if(!s)return o}},56397:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(50320),s=i(8883),l=i(7475),a=i(31338),h=i(71197),u=i(76093),c=i(99842),d=i(56395),g=i(72255),f=!g&&!c("map",function(){}),p=!g&&!f&&d("map",TypeError),m=g||f||p,w=a(function(){var t=this.iterator,e=s(n(this.next,t));if(!(this.done=!!e.done))return h(t,this.mapper,[e.value,this.counter++],!0)});r({target:"Iterator",proto:!0,real:!0,forced:m},{map:function(t){s(this);try{o(t)}catch(t){u(this,"throw",t)}return p?n(p,this,t):new w(l(this),{mapper:t})}})},56899:(t,e,i)=>{"use strict";t.exports=i(82309)("document","documentElement")},56963:t=>{"use strict";t.exports=function(t){try{return!!t()}catch(t){return!0}}},57193:(t,e,i)=>{"use strict";i.d(e,{R8:()=>n,z3:()=>o});var r=i(78887);function n(){(0,r.isDefined)(console)&&console.warn(...arguments)}function o(){(0,r.isDefined)(console)&&console.error(...arguments)}},57272:(t,e,i)=>{"use strict";var r=i(89364),n=i(67297),o=i(8883),s=i(92743),l=i(10027),a=i(94948),h=i(7411),u=i(60695),c=i(95283),d=i(76093),g=TypeError,f=function(t,e){this.stopped=t,this.result=e},p=f.prototype;t.exports=function(t,e,i){var m,w,y,b,C,S,E,R=i&&i.that,T=!!(i&&i.AS_ENTRIES),x=!!(i&&i.IS_RECORD),M=!!(i&&i.IS_ITERATOR),k=!!(i&&i.INTERRUPTED),O=r(e,R),I=function(t){return m&&d(m,"normal"),new f(!0,t)},A=function(t){return T?(o(t),k?O(t[0],t[1],I):O(t[0],t[1])):k?O(t,I):O(t)};if(x)m=t.iterator;else if(M)m=t;else{if(!(w=c(t)))throw new g(s(t)+" is not iterable");if(l(w)){for(y=0,b=a(t);b>y;y++)if((C=A(t[y]))&&h(p,C))return C;return new f(!1)}m=u(t,w)}for(S=x?t.next:m.next;!(E=n(S,m)).done;){try{C=A(E.value)}catch(t){d(m,"throw",t)}if("object"==typeof C&&C&&h(p,C))return C}return new f(!1)}},57496:(t,e,i)=>{"use strict";i.d(e,{K:()=>s});var r=i(82505),n=i(33774),o=i(927);class s extends r.n{constructor(){super(t=>t)}insert(t,e){let i=(0,o.z)(this.indexedValues,e);this.indexedValues=(0,n.N)(i,t,e),super.insert(t,e)}remove(t){let e=(0,n.H)(this.indexedValues,t);this.indexedValues=(0,o.v)(e,t),super.remove(t)}}},57555:(t,e,i)=>{"use strict";i.d(e,{A:()=>s,O:()=>l}),i(41658),i(19398);var r=i(13115);let n=0;class o{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"context",void 0),this.context=t||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(t,e,i){let o=arguments.length>3&&void 0!==arguments[3]&&arguments[3];function s(t){i.call(this,function(t){let e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),(0,r.stopImmediatePropagation)(this)},t}(t))}return this.context.eventListeners.push({element:t,event:e,callback:i,callbackProxy:s,options:o,eventManager:this}),t.addEventListener(e,s,o),n+=1,()=>{this.removeEventListener(t,e,i)}}removeEventListener(t,e,i){let r,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=this.context.eventListeners.length;for(;s;)if(s-=1,(r=this.context.eventListeners[s]).event===e&&r.element===t){if(i&&i!==r.callback||o&&r.eventManager!==this)continue;this.context.eventListeners.splice(s,1),r.element.removeEventListener(r.event,r.callbackProxy,r.options),n-=1}}clearEvents(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.context)return;let e=this.context.eventListeners.length;for(;e;){e-=1;let i=this.context.eventListeners[e];(!t||i.eventManager===this)&&(this.context.eventListeners.splice(e,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options),n-=1)}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(t,e){let i,r=t.document,n=t;r||(n=(r=t.ownerDocument?t.ownerDocument:t).defaultView);let o={bubbles:!0,cancelable:"mousemove"!==e,view:n,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0};r.createEvent?(i=r.createEvent("MouseEvents")).initMouseEvent(e,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,o.relatedTarget||r.body.parentNode):i=r.createEventObject(),t.dispatchEvent?t.dispatchEvent(i):t.fireEvent(`on${e}`,i)}}let s=o;function l(){return n}},57580:(t,e,i)=>{"use strict";t.exports=i(8496)(i(16954).proto,"size","get")||function(t){return t.size}},57716:(t,e,i)=>{"use strict";i.d(e,{d:()=>n});var r=i(89447);function n(t,e){return+(0,r.a)(t)>+(0,r.a)(e)}},58045:(t,e,i)=>{"use strict";i.d(e,{rl:()=>c});var r=i(7346),n=i(33773),o=i(13115);let s=[{name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},{name:"editorCloseAndSaveByArrowKeys",callback(t,e,i){let r=t._getEditorManager(),o=r.getActiveEditor();o.isInFullEditMode()&&o.state===n._T.EDITING||(r.closeEditorAndSaveChanges(),t.getSelected()&&(i.includes("arrowdown")?t.selection.transformStart(1,0):i.includes("arrowup")?t.selection.transformStart(-1,0):i.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):i.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},{name:"editorCloseAndSaveByEnter",callback(t,e){let i=t._getEditorManager();i.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),i.moveSelectionAfterEnter(e)}},{name:"editorCloseWithoutSaving",callback(t){let e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},{name:"editorFastOpen",callback(t,e){let{highlight:i}=t.getSelectedRangeLast();i.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},{name:"editorOpen",callback(t,e,i){let r=t._getEditorManager(),n=t.getSelectedRangeLast(),{highlight:s}=n;if(t.selection.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){let r=t.getSettings(),n="function"==typeof r.enterMoves?r.enterMoves(e):r.enterMoves;i.includes("shift")?t.selection.transformFocus(-n.row,-n.col):t.selection.transformFocus(n.row,n.col);return}s.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),(0,o.stopImmediatePropagation)(e))}},{name:"extendCellsSelectionDown",callback(t){let{selection:e}=t,{highlight:i}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},{name:"extendCellsSelectionDownByViewportHeight",callback(t){let{selection:e,rowIndexMapper:i}=t,{to:r}=t.getSelectedRangeLast(),n=Math.min(r.row+t.countVisibleRows(),t.countRows()-1),o=i.getNearestNotHiddenIndex(n,-1);if(null!==o){let i=t._createCellCoords(o,r.col),n=r.row-t.getFirstFullyVisibleRow(),s=Math.min(i.row-n,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(i),e.markEndSource(),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"extendCellsSelectionLeft",callback(t){let{selection:e}=t,{highlight:i}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},{name:"extendCellsSelectionRight",callback(t){let{selection:e}=t,{highlight:i}=t.getSelectedRangeLast();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},{name:"extendCellsSelectionToColumns",callback(t){let{selection:e}=t,{highlight:i,from:r,to:n}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(r.col,n.col,i),e.markEndSource()}},{name:"extendCellsSelectionToMostBottom",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(t.countRows()-1,-1),a=n.clone();a.row=r.row,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,o.col)),e.markEndSource()}}},{name:"extendCellsSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){let s=i.getNearestNotHiddenIndex(t.countCols()-1,-1),l=n.clone();l.col=r.col,e.markSource("keyboard"),e.setRangeStart(l,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,s)),e.markEndSource()}}},{name:"extendCellsSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&r.isCell()){let s=parseInt(t.getSettings().fixedColumnsStart,10),l=i.getNearestNotHiddenIndex(s,1),a=n.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),e.setRangeEnd(t._createCellCoords(o.row,l)),e.markEndSource()}}},{name:"extendCellsSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),a=n.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,l)),e.markEndSource()}}},{name:"extendCellsSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByColumnHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),a=n.clone();a.col=r.col,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),s&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,l)),e.markEndSource()}}},{name:"extendCellsSelectionToMostTop",callback(t){let{selection:e,rowIndexMapper:i}=t,{highlight:r,from:n,to:o}=t.getSelectedRangeLast(),s=r.isHeader()&&e.isSelectedByRowHeader();if(r.isCell()||s){let l=i.getNearestNotHiddenIndex(0,1),a=n.clone();a.row=r.row,e.markSource("keyboard"),e.setRangeStart(a,void 0,!1,r.clone()),s&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(l,o.col)),e.markEndSource()}}},{name:"extendCellsSelectionToRows",callback(t){let{selection:e}=t,{highlight:i,from:r,to:n}=t.getSelectedRangeLast();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(r.row,n.row,i),e.markEndSource()}},{name:"extendCellsSelectionUp",callback(t){let{selection:e}=t,{highlight:i}=t.getSelectedRangeLast();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(i.isCell()||i.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},{name:"extendCellsSelectionUpByViewportHeight",callback(t){let{selection:e,rowIndexMapper:i}=t,{to:r}=t.getSelectedRangeLast(),n=Math.max(r.row-t.countVisibleRows(),0),o=i.getNearestNotHiddenIndex(n,1);if(null!==o){let i=t._createCellCoords(o,r.col),n=r.row-t.getFirstFullyVisibleRow(),s=Math.max(i.row-n,0);e.markSource("keyboard"),e.setRangeEnd(i),e.markEndSource(),t.scrollViewportTo({row:s,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},{name:"moveCellSelectionDownByViewportHeight",callback(t){let{selection:e}=t,{navigableHeaders:i}=t.getSettings(),r=i?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight,o=t.countVisibleRows()+r;o=0===o?1:o,n===t.countRows()-1?o=1:n+o>t.countRows()&&(o=t.countRows()-n-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"moveCellSelectionInlineEnd",callback(t,e){let{selection:i}=t,r=t.getSettings(),n=t.getSelectedRangeLast(),o="function"==typeof r.tabMoves?r.tabMoves(e):r.tabMoves;i.markSource("keyboard"),i.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?i.transformFocus(-o.row,-o.col):i.transformStart(-o.row,-o.col),i.markEndSource()}},{name:"moveCellSelectionInlineStart",callback(t,e){let{selection:i}=t,r=t.getSettings(),n=t.getSelectedRangeLast(),o="function"==typeof r.tabMoves?r.tabMoves(e):r.tabMoves;i.markSource("keyboard"),i.isMultiple()&&!n.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?i.transformFocus(o.row,o.col):i.transformStart(o.row,o.col),i.markEndSource()}},{name:"moveCellSelectionLeft",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},{name:"moveCellSelectionRight",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},{name:"moveCellSelectionToMostBottom",callback(t){let{selection:e}=t,{col:i}=t.getSelectedRangeLast().highlight,r=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);null===r&&(r=-1),e.setRangeStart(t._createCellCoords(r,i))}},{name:"moveCellSelectionToMostBottomInlineEnd",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsBottom,10),o=i.getNearestNotHiddenIndex(t.countRows()-n-1,-1),s=r.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,s)),e.markEndSource()}},{name:"moveCellSelectionToMostInlineEnd",callback(t){let{selection:e,columnIndexMapper:i}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeLast().highlight.row,i.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},{name:"moveCellSelectionToMostInlineStart",callback(t){let{selection:e,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedColumnsStart,10),n=t.getSelectedRangeLast().highlight.row,o=i.getNearestNotHiddenIndex(r,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(n,o)),e.markEndSource()}},{name:"moveCellSelectionToMostLeft",callback(t){let{selection:e,columnIndexMapper:i}=t,r=t.getSelectedRangeLast().highlight.row,n=i.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);null===n&&(n=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},{name:"moveCellSelectionToMostRight",callback(t){let{selection:e,columnIndexMapper:i}=t,{row:r}=t.getSelectedRangeLast().highlight,n=i.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);null===n&&(n=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,n)),e.markEndSource()}},{name:"moveCellSelectionToMostTop",callback(t){let{selection:e}=t,{col:i}=t.getSelectedRangeLast().highlight,r=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);null===r&&(r=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,i)),e.markEndSource()}},{name:"moveCellSelectionToMostTopInlineStart",callback(t){let{selection:e,rowIndexMapper:i,columnIndexMapper:r}=t,n=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),s=i.getNearestNotHiddenIndex(n,1),l=r.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(s,l)),e.markEndSource()}},{name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},{name:"moveCellSelectionUpByViewportHight",callback(t){let{selection:e}=t,{navigableHeaders:i}=t.getSettings(),r=i?t.countColHeaders():0,{row:n}=t.getSelectedRangeLast().highlight,o=t.countVisibleRows()+r;o=0===o?-1:-o,n===-r?o=-1:n+o<r&&(o=-(n+r)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeLast().highlight.row<0&&t.scrollViewportTo({row:0})}},{name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},{name:"scrollToFocusedCell",callback(t){let{highlight:e}=t.getSelectedRangeLast(),i=t.getFirstFullyVisibleRow()-1,r=t.getFirstFullyVisibleColumn()-1,n=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,s=t._createCellCoords(i,r),l=t._createCellCoords(n,o);if(!t._createCellRange(s,s,l).includes(e)&&(e.row>=0||e.col>=0)){let i={};if(e.col>=0){let r=Math.floor(t.countVisibleCols()/2);i.col=Math.max(e.col-r,0)}if(e.row>=0){let r=Math.floor(t.countVisibleRows()/2);i.row=Math.max(e.row-r,0)}t.scrollViewportTo({...i,verticalSnap:"top",horizontalSnap:"start"})}}},{name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},{name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},{name:"populateSelectedCellsData",callback(t){let e=t.getSelectedRange(),{row:i,col:r}=e[e.length-1].highlight.normalize(),n=t.getDataAtCell(i,r),o=new Map;for(let s=0;s<e.length;s++)e[s].forAll((e,s)=>{if(e>=0&&s>=0&&(e!==i||s!==r)){let{readOnly:i}=t.getCellMeta(e,s);i||o.set(`${e}x${s}`,[e,s,n])}});t.setDataAtCell(Array.from(o.values()))}}];function l(t){let e={};return s.forEach(i=>{let{name:r,callback:n}=i;e[r]=function(){for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];return n(t,...i)}}),e}function a(t){let e=t.getShortcutManager().addContext("editor"),i=l(t),n={group:r.b};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorCloseAndSaveByEnter(t,e)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(t,e)=>i.editorCloseAndSaveByEnter(t,e)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(t,e)=>i.editorCloseAndSave(t,e)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(t,e)=>i.editorCloseAndSaveByArrowKeys(t,e)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>i.editorCloseWithoutSaving()}],n)}var h=i(78887);function u(t){let e=t.getShortcutManager().addContext("grid"),i=l(t),n={runOnlyIf:()=>{let{navigableHeaders:e}=t.getSettings();return(0,h.isDefined)(t.getSelected())&&(e||!e&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:r.B};e.addShortcuts([{keys:[["F2"]],callback:t=>i.editorFastOpen(t)},{keys:[["Enter"],["Enter","Shift"]],callback:(t,e)=>i.editorOpen(t,e)},{keys:[["Backspace"],["Delete"]],callback:()=>i.emptySelectedCells()}],{group:r.b,runOnlyIf:()=>(0,h.isDefined)(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>i.selectAllCells(),runOnlyIf:()=>{var e;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var e;return null===(e=t.getSelectedRangeLast())||void 0===e?void 0:e.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>i.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>i.populateSelectedCellsData(),runOnlyIf:()=>{var e,i;return!(null!==(e=t.getSelectedRangeLast())&&void 0!==e&&e.highlight.isHeader())&&(null===(i=t.getSelectedRangeLast())||void 0===i?void 0:i.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>i.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>i.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>i.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>i.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>i.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>i.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>i.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>i.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>i.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>i.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>i.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>i.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>i.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>i.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>i.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>i.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:t=>i.moveCellSelectionInlineStart(t)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:t=>i.moveCellSelectionInlineEnd(t)},{keys:[["Control/Meta","Backspace"]],callback:()=>i.scrollToFocusedCell()}],n)}function c(t){[u,a].forEach(e=>e(t))}},58086:(t,e,i)=>{"use strict";i.d(e,{z:()=>o});var r=i(25703),n=i(89447);function o(t,e,i){let o=(0,n.a)(t,null==i?void 0:i.in);return o.setTime(o.getTime()+e*r.Cg),o}},58331:(t,e,i)=>{"use strict";var r=i(54076),n=i(24771);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("isDisjointFrom",function(t){return!t})},{isDisjointFrom:n})},58958:(t,e,i)=>{"use strict";var r=i(14412),n=i(95467),o=Function.prototype,s=r&&Object.getOwnPropertyDescriptor,l=n(o,"name"),a=l&&(!r||r&&s(o,"name").configurable);t.exports={EXISTS:l,PROPER:l&&"something"===(function(){}).name,CONFIGURABLE:a}},59149:(t,e,i)=>{"use strict";i.d(e,{Gk:()=>g,L4:()=>h,lY:()=>u,r0:()=>d}),i(41658);var r=i(21413),n=i(99206),o=i(46420),s=i(85917);let{register:l,getItem:a,hasItem:h,getNames:u,getValues:c}=(0,r.A)("cellTypes");function d(t){if(!h(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return a(t)}function g(t,e){"string"!=typeof t&&(t=(e=t).CELL_TYPE);let{editor:i,renderer:r,validator:a}=e;i&&(0,n.VA)(t,i),r&&(0,o.TS)(t,r),a&&(0,s.qV)(t,a),l(t,e)}},59594:(t,e,i)=>{"use strict";i.r(e),i.d(e,{isChrome:()=>u,isChromeWebKit:()=>c,isEdge:()=>p,isEdgeWebKit:()=>m,isFirefox:()=>d,isFirefoxWebKit:()=>g,isIOS:()=>y,isIpadOS:()=>b,isLinuxOS:()=>E,isMacOS:()=>S,isMobileBrowser:()=>w,isSafari:()=>f,isWindowsOS:()=>C,setBrowserMeta:()=>a,setPlatformMeta:()=>h});var r=i(19857),n=i(23544);let o=t=>{let e={value:!1};return e.test=(i,r)=>{e.value=t(i,r)},e},s={chrome:o((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:o(t=>/CriOS/.test(t)),edge:o(t=>/Edge/.test(t)),edgeWebKit:o(t=>/EdgiOS/.test(t)),firefox:o(t=>/Firefox/.test(t)),firefoxWebKit:o(t=>/FxiOS/.test(t)),mobile:o(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:o((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},l={mac:o(t=>/^Mac/.test(t)),win:o(t=>/^Win/.test(t)),linux:o(t=>/^Linux/.test(t)),ios:o(t=>/iPhone|iPad|iPod/i.test(t))};function a(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.objectEach)(s,i=>{let{test:r}=i;r(t,e)})}function h(){let{platform:t=navigator.platform}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.objectEach)(l,e=>{let{test:i}=e;i(t)})}function u(){return s.chrome.value}function c(){return s.chromeWebKit.value}function d(){return s.firefox.value}function g(){return s.firefoxWebKit.value}function f(){return s.safari.value}function p(){return s.edge.value}function m(){return s.edgeWebKit.value}function w(){return s.mobile.value}function y(){return l.ios.value}function b(){let{maxTouchPoints:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator;return t>2&&l.mac.value}function C(){return l.win.value}function S(){return l.mac.value}function E(){return l.linux.value}(0,n.isCSR)()&&(a(),h())},59875:(t,e,i)=>{"use strict";i.d(e,{U:()=>n});var r=i(61183);function n(t,e,i){let[n,o]=(0,r.x)(null==i?void 0:i.in,t,e);return 12*(n.getFullYear()-o.getFullYear())+(n.getMonth()-o.getMonth())}},59932:(t,e,i)=>{"use strict";i.d(e,{H:()=>s,N:()=>o}),i(12252),i(85522);var r=i(75708),n=i(95061);function o(t,e,i,n){let o=i.length?i[0]:void 0;return[...t.slice(0,o),...i.map((t,e)=>(0,r.isFunction)(n)?n(t,e):n),...void 0===o?[]:t.slice(o)]}function s(t,e){return(0,n.arrayFilter)(t,(t,i)=>!1===e.includes(i))}},60009:(t,e,i)=>{"use strict";t.exports=!i(56963)(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})},60680:(t,e,i)=>{"use strict";var r=i(76494),n=i(85592),o=i(7107)("match");t.exports=function(t){var e;return r(t)&&(void 0!==(e=t[o])?!!e:"RegExp"===n(t))}},60695:(t,e,i)=>{"use strict";var r=i(67297),n=i(50320),o=i(8883),s=i(92743),l=i(95283),a=TypeError;t.exports=function(t,e){var i=arguments.length<2?l(t):e;if(n(i))return o(r(i,t));throw new a(s(t)+" is not iterable")}},61101:t=>{"use strict";t.exports=function(t){try{var e=new Set,i=e[t]({size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}});return 1!==i.size||4!==i.values().next().value}catch(t){return!1}}},61183:(t,e,i)=>{"use strict";i.d(e,{x:()=>n});var r=i(7239);function n(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];let o=r.w.bind(null,t||i.find(t=>"object"==typeof t));return i.map(o)}},62495:(t,e,i)=>{"use strict";var r=i(98774),n=Function.prototype,o=n.apply,s=n.call;t.exports="object"==typeof Reflect&&Reflect.apply||(r?s.bind(o):function(){return s.apply(o,arguments)})},63241:(t,e,i)=>{var r=function(t){var e=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,r={},n={manual:t.Prism&&t.Prism.manual,disableWorkerMessageHandler:t.Prism&&t.Prism.disableWorkerMessageHandler,util:{encode:function t(e){return e instanceof o?new o(e.type,t(e.content),e.alias):Array.isArray(e)?e.map(t):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(t){return Object.prototype.toString.call(t).slice(8,-1)},objId:function(t){return t.__id||Object.defineProperty(t,"__id",{value:++i}),t.__id},clone:function t(e,i){var r,o;switch(i=i||{},n.util.type(e)){case"Object":if(i[o=n.util.objId(e)])return i[o];for(var s in r={},i[o]=r,e)e.hasOwnProperty(s)&&(r[s]=t(e[s],i));return r;case"Array":if(i[o=n.util.objId(e)])return i[o];return r=[],i[o]=r,e.forEach(function(e,n){r[n]=t(e,i)}),r;default:return e}},getLanguage:function(t){for(;t;){var i=e.exec(t.className);if(i)return i[1].toLowerCase();t=t.parentElement}return"none"},setLanguage:function(t,i){t.className=t.className.replace(RegExp(e,"gi"),""),t.classList.add("language-"+i)},currentScript:function(){if("undefined"==typeof document)return null;if(document.currentScript&&"SCRIPT"===document.currentScript.tagName)return document.currentScript;try{throw Error()}catch(r){var t=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(r.stack)||[])[1];if(t){var e=document.getElementsByTagName("script");for(var i in e)if(e[i].src==t)return e[i]}return null}},isActive:function(t,e,i){for(var r="no-"+e;t;){var n=t.classList;if(n.contains(e))return!0;if(n.contains(r))return!1;t=t.parentElement}return!!i}},languages:{plain:r,plaintext:r,text:r,txt:r,extend:function(t,e){var i=n.util.clone(n.languages[t]);for(var r in e)i[r]=e[r];return i},insertBefore:function(t,e,i,r){var o=(r=r||n.languages)[t],s={};for(var l in o)if(o.hasOwnProperty(l)){if(l==e)for(var a in i)i.hasOwnProperty(a)&&(s[a]=i[a]);i.hasOwnProperty(l)||(s[l]=o[l])}var h=r[t];return r[t]=s,n.languages.DFS(n.languages,function(e,i){i===h&&e!=t&&(this[e]=s)}),s},DFS:function t(e,i,r,o){o=o||{};var s=n.util.objId;for(var l in e)if(e.hasOwnProperty(l)){i.call(e,l,e[l],r||l);var a=e[l],h=n.util.type(a);"Object"!==h||o[s(a)]?"Array"!==h||o[s(a)]||(o[s(a)]=!0,t(a,i,l,o)):(o[s(a)]=!0,t(a,i,null,o))}}},plugins:{},highlightAll:function(t,e){n.highlightAllUnder(document,t,e)},highlightAllUnder:function(t,e,i){var r={callback:i,container:t,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};n.hooks.run("before-highlightall",r),r.elements=Array.prototype.slice.apply(r.container.querySelectorAll(r.selector)),n.hooks.run("before-all-elements-highlight",r);for(var o,s=0;o=r.elements[s++];)n.highlightElement(o,!0===e,r.callback)},highlightElement:function(e,i,r){var o=n.util.getLanguage(e),s=n.languages[o];n.util.setLanguage(e,o);var l=e.parentElement;l&&"pre"===l.nodeName.toLowerCase()&&n.util.setLanguage(l,o);var a=e.textContent,h={element:e,language:o,grammar:s,code:a};function u(t){h.highlightedCode=t,n.hooks.run("before-insert",h),h.element.innerHTML=h.highlightedCode,n.hooks.run("after-highlight",h),n.hooks.run("complete",h),r&&r.call(h.element)}if(n.hooks.run("before-sanity-check",h),(l=h.element.parentElement)&&"pre"===l.nodeName.toLowerCase()&&!l.hasAttribute("tabindex")&&l.setAttribute("tabindex","0"),!h.code){n.hooks.run("complete",h),r&&r.call(h.element);return}if(n.hooks.run("before-highlight",h),!h.grammar){u(n.util.encode(h.code));return}if(i&&t.Worker){var c=new Worker(n.filename);c.onmessage=function(t){u(t.data)},c.postMessage(JSON.stringify({language:h.language,code:h.code,immediateClose:!0}))}else u(n.highlight(h.code,h.grammar,h.language))},highlight:function(t,e,i){var r={code:t,grammar:e,language:i};if(n.hooks.run("before-tokenize",r),!r.grammar)throw Error('The language "'+r.language+'" has no grammar.');return r.tokens=n.tokenize(r.code,r.grammar),n.hooks.run("after-tokenize",r),o.stringify(n.util.encode(r.tokens),r.language)},tokenize:function(t,e){var i=e.rest;if(i){for(var r in i)e[r]=i[r];delete e.rest}var h=new l;return a(h,h.head,t),function t(e,i,r,l,h,u){for(var c in r)if(r.hasOwnProperty(c)&&r[c]){var d=r[c];d=Array.isArray(d)?d:[d];for(var g=0;g<d.length;++g){if(u&&u.cause==c+","+g)return;var f=d[g],p=f.inside,m=!!f.lookbehind,w=!!f.greedy,y=f.alias;if(w&&!f.pattern.global){var b=f.pattern.toString().match(/[imsuy]*$/)[0];f.pattern=RegExp(f.pattern.source,b+"g")}for(var C=f.pattern||f,S=l.next,E=h;S!==i.tail&&(!u||!(E>=u.reach));E+=S.value.length,S=S.next){var R,T=S.value;if(i.length>e.length)return;if(!(T instanceof o)){var x=1;if(w){if(!(R=s(C,E,e,m))||R.index>=e.length)break;var M=R.index,k=R.index+R[0].length,O=E;for(O+=S.value.length;M>=O;)O+=(S=S.next).value.length;if(O-=S.value.length,E=O,S.value instanceof o)continue;for(var I=S;I!==i.tail&&(O<k||"string"==typeof I.value);I=I.next)x++,O+=I.value.length;x--,T=e.slice(E,O),R.index-=E}else if(!(R=s(C,0,T,m)))continue;var M=R.index,A=R[0],N=T.slice(0,M),H=T.slice(M+A.length),P=E+T.length;u&&P>u.reach&&(u.reach=P);var _=S.prev;if(N&&(_=a(i,_,N),E+=N.length),function(t,e,i){for(var r=e.next,n=0;n<i&&r!==t.tail;n++)r=r.next;e.next=r,r.prev=e,t.length-=n}(i,_,x),S=a(i,_,new o(c,p?n.tokenize(A,p):A,y,A)),H&&a(i,S,H),x>1){var D={cause:c+","+g,reach:P};t(e,i,r,S.prev,E,D),u&&D.reach>u.reach&&(u.reach=D.reach)}}}}}}(t,h,e,h.head,0),function(t){for(var e=[],i=t.head.next;i!==t.tail;)e.push(i.value),i=i.next;return e}(h)},hooks:{all:{},add:function(t,e){var i=n.hooks.all;i[t]=i[t]||[],i[t].push(e)},run:function(t,e){var i=n.hooks.all[t];if(i&&i.length)for(var r,o=0;r=i[o++];)r(e)}},Token:o};function o(t,e,i,r){this.type=t,this.content=e,this.alias=i,this.length=0|(r||"").length}function s(t,e,i,r){t.lastIndex=e;var n=t.exec(i);if(n&&r&&n[1]){var o=n[1].length;n.index+=o,n[0]=n[0].slice(o)}return n}function l(){var t={value:null,prev:null,next:null},e={value:null,prev:t,next:null};t.next=e,this.head=t,this.tail=e,this.length=0}function a(t,e,i){var r=e.next,n={value:i,prev:e,next:r};return e.next=n,r.prev=n,t.length++,n}if(t.Prism=n,o.stringify=function t(e,i){if("string"==typeof e)return e;if(Array.isArray(e)){var r="";return e.forEach(function(e){r+=t(e,i)}),r}var o={type:e.type,content:t(e.content,i),tag:"span",classes:["token",e.type],attributes:{},language:i},s=e.alias;s&&(Array.isArray(s)?Array.prototype.push.apply(o.classes,s):o.classes.push(s)),n.hooks.run("wrap",o);var l="";for(var a in o.attributes)l+=" "+a+'="'+(o.attributes[a]||"").replace(/"/g,"&quot;")+'"';return"<"+o.tag+' class="'+o.classes.join(" ")+'"'+l+">"+o.content+"</"+o.tag+">"},!t.document)return t.addEventListener&&(n.disableWorkerMessageHandler||t.addEventListener("message",function(e){var i=JSON.parse(e.data),r=i.language,o=i.code,s=i.immediateClose;t.postMessage(n.highlight(o,n.languages[r],r)),s&&t.close()},!1)),n;var h=n.util.currentScript();function u(){n.manual||n.highlightAll()}if(h&&(n.filename=h.src,h.hasAttribute("data-manual")&&(n.manual=!0)),!n.manual){var c=document.readyState;"loading"===c||"interactive"===c&&h&&h.defer?document.addEventListener("DOMContentLoaded",u):window.requestAnimationFrame?window.requestAnimationFrame(u):window.setTimeout(u,16)}return n}("undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{});t.exports&&(t.exports=r),void 0!==i.g&&(i.g.Prism=r),r.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},r.languages.markup.tag.inside["attr-value"].inside.entity=r.languages.markup.entity,r.languages.markup.doctype.inside["internal-subset"].inside=r.languages.markup,r.hooks.add("wrap",function(t){"entity"===t.type&&(t.attributes.title=t.content.replace(/&amp;/,"&"))}),Object.defineProperty(r.languages.markup.tag,"addInlined",{value:function(t,e){var i={};i["language-"+e]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:r.languages[e]},i.cdata=/^<!\[CDATA\[|\]\]>$/i;var n={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:i}};n["language-"+e]={pattern:/[\s\S]+/,inside:r.languages[e]};var o={};o[t]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return t}),"i"),lookbehind:!0,greedy:!0,inside:n},r.languages.insertBefore("markup","cdata",o)}}),Object.defineProperty(r.languages.markup.tag,"addAttribute",{value:function(t,e){r.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+t+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[e,"language-"+e],inside:r.languages[e]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),r.languages.html=r.languages.markup,r.languages.mathml=r.languages.markup,r.languages.svg=r.languages.markup,r.languages.xml=r.languages.extend("markup",{}),r.languages.ssml=r.languages.xml,r.languages.atom=r.languages.xml,r.languages.rss=r.languages.xml,function(t){var e=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;t.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+e.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+e.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+e.source+"$"),alias:"url"}}},selector:{pattern:RegExp("(^|[{}\\s])[^{}\\s](?:[^{};\"'\\s]|\\s+(?![\\s{])|"+e.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:e,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},t.languages.css.atrule.inside.rest=t.languages.css;var i=t.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(r),r.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},r.languages.javascript=r.languages.extend("clike",{"class-name":[r.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source)+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),r.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,r.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:r.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:r.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:r.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:r.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:r.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),r.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:r.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),r.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),r.languages.markup&&(r.languages.markup.tag.addInlined("script","javascript"),r.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),r.languages.js=r.languages.javascript,function(){if(void 0!==r&&"undefined"!=typeof document){Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var t={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},e="data-src-status",i="loading",n="loaded",o="pre[data-src]:not(["+e+'="'+n+'"]):not(['+e+'="'+i+'"])';r.hooks.add("before-highlightall",function(t){t.selector+=", "+o}),r.hooks.add("before-sanity-check",function(s){var l=s.element;if(l.matches(o)){s.code="",l.setAttribute(e,i);var a,h,u,c,d=l.appendChild(document.createElement("CODE"));d.textContent="Loading…";var g=l.getAttribute("data-src"),f=s.language;if("none"===f){var p=(/\.(\w+)$/.exec(g)||[,"none"])[1];f=t[p]||p}r.util.setLanguage(d,f),r.util.setLanguage(l,f);var m=r.plugins.autoloader;m&&m.loadLanguages(f),a=g,h=function(t){l.setAttribute(e,n);var i=function(t){var e=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(t||"");if(e){var i=Number(e[1]),r=e[2],n=e[3];return r?n?[i,Number(n)]:[i,void 0]:[i,i]}}(l.getAttribute("data-range"));if(i){var o=t.split(/\r\n?|\n/g),s=i[0],a=null==i[1]?o.length:i[1];s<0&&(s+=o.length),s=Math.max(0,Math.min(s-1,o.length)),a<0&&(a+=o.length),a=Math.max(0,Math.min(a,o.length)),t=o.slice(s,a).join("\n"),l.hasAttribute("data-start")||l.setAttribute("data-start",String(s+1))}d.textContent=t,r.highlightElement(d)},u=function(t){l.setAttribute(e,"failed"),d.textContent=t},(c=new XMLHttpRequest).open("GET",a,!0),c.onreadystatechange=function(){var t;4==c.readyState&&(c.status<400&&c.responseText?h(c.responseText):c.status>=400?u((t=c.status,"✖ Error "+t+" while fetching file: "+c.statusText)):u("✖ Error: File does not exist or is empty"))},c.send(null)}}),r.plugins.fileHighlight={highlight:function(t){for(var e,i=(t||document).querySelectorAll(o),n=0;e=i[n++];)r.highlightElement(e)}};var s=!1;r.fileHighlight=function(){s||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),s=!0),r.plugins.fileHighlight.highlight.apply(this,arguments)}}}()},63280:(t,e,i)=>{"use strict";i.d(e,{d:()=>o});var r=i(61183),n=i(27981);function o(t,e,i){let[o,s]=(0,r.x)(null==i?void 0:i.in,t,e);return+(0,n.a)(o)==+(0,n.a)(s)}},63462:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(57272),s=i(50320),l=i(8883),a=i(7475),h=i(76093),u=i(56395)("forEach",TypeError);r({target:"Iterator",proto:!0,real:!0,forced:u},{forEach:function(t){l(this);try{s(t)}catch(t){h(this,"throw",t)}if(u)return n(u,this,t);var e=a(this),i=0;o(e,function(e){t(e,i++)},{IS_RECORD:!0})}})},63723:(t,e,i)=>{"use strict";i(37412)},64044:(t,e,i)=>{"use strict";i.d(e,{L:()=>o});var r=i(38991),n=i(25703);function o(t,e,i){return(0,r.A)(t,e*n.s0,i)}},64409:(t,e,i)=>{"use strict";var r=i(48195),n=i(241);t.exports=function(t){var e=r(t,"string");return n(e)?e:e+""}},64571:(t,e,i)=>{"use strict";var r=i(54076),n=i(57272),o=i(50320),s=i(8883),l=i(7475),a=i(76093),h=i(56395),u=i(62495),c=i(56963),d=TypeError,g=c(function(){[].keys().reduce(function(){},void 0)}),f=!g&&h("reduce",d);r({target:"Iterator",proto:!0,real:!0,forced:g||f},{reduce:function(t){s(this);try{o(t)}catch(t){a(this,"throw",t)}var e=arguments.length<2,i=e?void 0:arguments[1];if(f)return u(f,this,e?[t]:[t,i]);var r=l(this),h=0;if(n(r,function(r){e?(e=!1,i=r):i=t(i,r,h),h++},{IS_RECORD:!0}),e)throw new d("Reduce of empty iterator with no initial value");return i}})},64897:(t,e,i)=>{"use strict";var r=i(14412),n=i(67297),o=i(7537),s=i(32138),l=i(13517),a=i(64409),h=i(95467),u=i(24711),c=Object.getOwnPropertyDescriptor;e.f=r?c:function(t,e){if(t=l(t),e=a(e),u)try{return c(t,e)}catch(t){}if(h(t,e))return s(!n(o.f,t,e),t[e])}},65418:(t,e,i)=>{"use strict";var r=i(54076),n=i(93484),o=i(61101);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("union")||!o("union")},{union:n})},65847:(t,e,i)=>{"use strict";var r=i(8496),n=i(76494),o=i(16604),s=i(36096);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=r(Object.prototype,"__proto__","set"))(i,[]),e=i instanceof Array}catch(t){}return function(i,r){return o(i),s(r),n(i)&&(e?t(i,r):i.__proto__=r),i}}():void 0)},65911:(t,e,i)=>{"use strict";var r=i(76093);t.exports=function(t,e,i){for(var n=t.length-1;n>=0;n--)if(void 0!==t[n])try{i=r(t[n].iterator,e,i)}catch(t){e="throw",i=t}if("throw"===e)throw i;return i}},66163:(t,e,i)=>{"use strict";var r,n,o,s=i(56963),l=i(99365),a=i(76494),h=i(29440),u=i(16683),c=i(34988),d=i(7107),g=i(72255),f=d("iterator"),p=!1;[].keys&&("next"in(o=[].keys())?(n=u(u(o)))!==Object.prototype&&(r=n):p=!0),!a(r)||s(function(){var t={};return r[f].call(t)!==t})?r={}:g&&(r=h(r)),l(r[f])||c(r,f,function(){return this}),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:p}},66212:(t,e,i)=>{"use strict";var r=i(42620);t.exports=function(t,e){var i=r[t],n=i&&i.prototype;return n&&n[e]}},66256:(t,e,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(43987).clear;r({global:!0,bind:!0,enumerable:!0,forced:n.clearImmediate!==o},{clearImmediate:o})},66456:(t,e,i)=>{"use strict";var r=i(93840),n=i(33325),o=Math.floor,s=r("".charAt),l=r("".replace),a=r("".slice),h=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;t.exports=function(t,e,i,r,c,d){var g=i+t.length,f=r.length,p=u;return void 0!==c&&(c=n(c),p=h),l(d,p,function(n,l){var h;switch(s(l,0)){case"$":return"$";case"&":return t;case"`":return a(e,0,i);case"'":return a(e,g);case"<":h=c[a(l,1,-1)];break;default:var u=+l;if(0===u)return n;if(u>f){var d=o(u/10);if(0===d)return n;if(d<=f)return void 0===r[d-1]?s(l,1):r[d-1]+s(l,1);return n}h=r[u-1]}return void 0===h?"":h})}},66627:t=>{"use strict";t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},66848:(t,e,i)=>{"use strict";i.d(e,{P:()=>n});var r=i(89447);function n(t,e){return(0,r.a)(t,null==e?void 0:e.in).getDay()}},67043:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(50320),s=i(8883),l=i(7475),a=i(31338),h=i(71197),u=i(72255),c=i(76093),d=i(99842),g=i(56395),f=!u&&!d("filter",function(){}),p=!u&&!f&&g("filter",TypeError),m=u||f||p,w=a(function(){for(var t,e,i=this.iterator,r=this.predicate,o=this.next;;){if(t=s(n(o,i)),this.done=!!t.done)return;if(h(i,r,[e=t.value,this.counter++],!0))return e}});r({target:"Iterator",proto:!0,real:!0,forced:m},{filter:function(t){s(this);try{o(t)}catch(t){c(this,"throw",t)}return p?n(p,this,t):new w(l(this),{predicate:t})}})},67297:(t,e,i)=>{"use strict";var r=i(98774),n=Function.prototype.call;t.exports=r?n.bind(n):function(){return n.apply(n,arguments)}},67386:(t,e,i)=>{"use strict";i.d(e,{D:()=>n});var r=i(89447);function n(t,e){let i=(0,r.a)(t,null==e?void 0:e.in);return i.setFullYear(i.getFullYear(),0,1),i.setHours(0,0,0,0),i}},67758:(t,e,i)=>{"use strict";i.d(e,{U:()=>s,j:()=>o}),i(41658),i(19398);var r=i(27704);function n(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}let o=50;class s extends r.C{constructor(t){let{calculationTypes:e,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:s,overrideFn:l,inlineStartOffset:a}=t;super(e),n(this,"viewportWidth",0),n(this,"scrollOffset",0),n(this,"zeroBasedScrollOffset",0),n(this,"totalColumns",0),n(this,"columnWidthFn",null),n(this,"columnWidth",0),n(this,"overrideFn",null),n(this,"inlineStartOffset",0),n(this,"totalCalculatedWidth",0),n(this,"startPositions",[]),n(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=s,this.overrideFn=l,this.inlineStartOffset=a,this.calculate()}calculate(){this._initialize(this);for(let t=0;t<this.totalColumns;t++)if(this.columnWidth=this.getColumnWidth(t),this._process(t,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(t){let e=this.columnWidthFn(t);return isNaN(e)?o:e}}},68804:(t,e,i)=>{"use strict";i.d(e,{A:()=>f}),i(41658);var r=i(79791),n=i(13115),o=i(99206),s=i(57555);function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function a(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var h=new WeakSet;class u{constructor(t,e,i){!function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,h),l(this,"hot",void 0),l(this,"tableMeta",void 0),l(this,"selection",void 0),l(this,"eventManager",void 0),l(this,"destroyed",!1),l(this,"activeEditor",void 0),l(this,"cellProperties",void 0),this.hot=t,this.tableMeta=e,this.selection=i,this.eventManager=new s.A(t),this.hot.addHook("afterDocumentKeyDown",t=>a(h,this,c).call(this,t)),this.hot.addHook("beforeCompositionStart",t=>a(h,this,c).call(this,t)),this.hot.view._wt.update("onCellDblClick",(t,e,i)=>a(h,this,d).call(this,t,e,i))}getActiveEditor(){return this.activeEditor}prepareEditor(){var t;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,t=>{t&&this.prepareEditor()});return}let e=null===(t=this.hot.getSelectedRangeLast())||void 0===t?void 0:t.highlight;if(!e||e.isHeader())return;let{row:i,col:r}=e,n=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta"),s=i,l=r;if(Array.isArray(n)&&([s,l]=n),this.cellProperties=this.hot.getCellMeta(s,l),!this.isCellEditable()){this.clearActiveEditor();return}let a=this.hot.getCell(i,r,!0);if(a){let t=this.hot.getCellEditor(this.cellProperties),e=this.hot.colToProp(l),n=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(s),l);this.activeEditor=(0,o.L3)(t,this.hot),this.activeEditor.prepare(i,r,e,a,n,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.isCellEditable()){this.clearActiveEditor();return}let r=this.hot.getSelectedRangeLast(),n=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,t,e,i);if(e instanceof MouseEvent&&"boolean"!=typeof n&&(n=0===this.hot.selection.getLayerLevel()&&r.isSingle()),!1===n){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(t,e))}closeEditor(t,e,i){this.activeEditor?this.activeEditor.finishEditing(t,e,i):i&&i(!1)}closeEditorAndSaveChanges(t){this.closeEditor(!1,t)}closeEditorAndRestoreOriginalValue(t){this.closeEditor(!0,t)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){let t=this.hot.getSelectedRangeLast();if(!t)return!1;let e=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=t.highlight,{rowIndexMapper:n,columnIndexMapper:o}=this.hot,s=n.isHidden(this.hot.toPhysicalRow(i))||o.isHidden(this.hot.toPhysicalColumn(r));return!this.cellProperties.readOnly&&!!e&&!s}moveSelectionAfterEnter(t){let e={..."function"==typeof this.tableMeta.enterMoves?this.tableMeta.enterMoves(t):this.tableMeta.enterMoves};t.shiftKey&&(e.row=-e.row,e.col=-e.col),this.hot.selection.isMultiple()?this.selection.transformFocus(e.row,e.col):this.selection.transformStart(e.row,e.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function c(t){let e=this.hot.getSelectedRangeLast();if(!this.hot.isListening()||!e||e.highlight.isHeader()||(0,n.isImmediatePropagationStopped)(t))return;let{keyCode:i}=t,o=(t.ctrlKey||t.metaKey)&&!t.altKey;this.activeEditor&&(!this.activeEditor||this.activeEditor.isWaiting())||(0,r.isFunctionKey)(i)||(0,r.isCtrlMetaKey)(i)||o||this.isEditorOpened()||this.openEditor("",t)}function d(t,e){e.isCell()&&this.openEditor(null,t,!0)}let g=new WeakMap;u.getInstance=function(t,e,i){let r=g.get(t);return r||(r=new u(t,e,i),g.set(t,r)),r};let f=u},69607:(t,e,i)=>{"use strict";var r=i(54076),n=i(33325),o=i(94948),s=i(2769),l=i(76144),a=i(42947);r({target:"Array",proto:!0,arity:1,forced:1!==[].unshift(0)||!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}()},{unshift:function(t){var e=n(this),i=o(e),r=arguments.length;if(r){a(i+r);for(var h=i;h--;){var u=h+r;h in e?e[u]=e[h]:l(e,u)}for(var c=0;c<r;c++)e[c]=arguments[c]}return s(e,i+r)}})},69905:(t,e,i)=>{"use strict";var r=i(93840),n=i(6497),o=i(16954),s=o.Set,l=o.proto,a=r(l.forEach),h=r(l.keys),u=h(new s).next;t.exports=function(t,e,i){return i?n({iterator:h(t),next:u},e):a(t,e)}},70527:(t,e,i)=>{"use strict";var r=i(54076),n=i(93840),o=i(16604),s=i(42665),l=i(80763),a=i(56963),h=n("".charAt);r({target:"String",proto:!0,forced:a(function(){return"\uD842"!=="\uD842\uDFB7".at(-2)})},{at:function(t){var e=l(o(this)),i=e.length,r=s(t),n=r>=0?r:i+r;return n<0||n>=i?void 0:h(e,n)}})},70540:(t,e,i)=>{"use strict";i.d(e,{b:()=>n});var r=i(84423);function n(t,e){return(0,r.k)(t,{...e,weekStartsOn:1})}},70542:(t,e,i)=>{"use strict";i.d(e,{t:()=>n});var r=i(61183);function n(t,e,i){let[n,o]=(0,r.x)(null==i?void 0:i.in,t,e);return n.getFullYear()===o.getFullYear()&&n.getMonth()===o.getMonth()}},71182:(t,e,i)=>{"use strict";i.d(e,{p:()=>s});var r=i(7239),n=i(70540),o=i(89447);function s(t,e){let i=(0,o.a)(t,null==e?void 0:e.in),s=i.getFullYear(),l=(0,r.w)(i,0);l.setFullYear(s+1,0,4),l.setHours(0,0,0,0);let a=(0,n.b)(l),h=(0,r.w)(i,0);h.setFullYear(s,0,4),h.setHours(0,0,0,0);let u=(0,n.b)(h);return i.getTime()>=a.getTime()?s+1:i.getTime()>=u.getTime()?s:s-1}},71190:(t,e,i)=>{"use strict";i.d(e,{A:()=>h}),i(41658),i(19398);var r=i(73183);function n(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function o(t,e){return t.get(s(t,e))}function s(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var l=new WeakMap;class a{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];n(this,"highlight",null),n(this,"from",null),n(this,"to",null),function(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}(this,l,!1),this.highlight=t.clone(),this.from=e.clone(),this.to=i.clone(),function(t,e,i){t.set(s(t,e),i)}(l,this,r)}setHighlight(t){return this.highlight=t.clone(),this}setFrom(t){return this.from=t.clone(),this}setTo(t){return this.to=t.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(t){return this.from.isValid(t)&&this.to.isValid(t)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return!!(this.from.isHeader()&&this.to.isHeader())||this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;let t=Math.max(this.from.row,0),e=Math.max(this.to.row,0);return Math.max(t,e)-Math.min(t,e)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;let t=Math.max(this.from.col,0),e=Math.max(this.to.col,0);return Math.max(t,e)-Math.min(t,e)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(t){let{row:e,col:i}=t,r=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner();return r.row<=e&&n.row>=e&&r.col<=i&&n.col>=i}includesRange(t){return this.includes(t.getOuterTopStartCorner())&&this.includes(t.getOuterBottomEndCorner())}isEqual(t){return Math.min(this.from.row,this.to.row)===Math.min(t.from.row,t.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(t.from.row,t.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(t.from.col,t.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(t.from.col,t.to.col)}overlaps(t){return t.isSouthEastOf(this.getOuterTopLeftCorner())&&t.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(t){return this.getOuterTopLeftCorner().isSouthEastOf(t)||this.getOuterBottomRightCorner().isSouthEastOf(t)}isNorthWestOf(t){return this.getOuterTopLeftCorner().isNorthWestOf(t)||this.getOuterBottomRightCorner().isNorthWestOf(t)}isOverlappingHorizontally(t){return this.getOuterTopEndCorner().col>=t.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=t.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=t.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=t.getOuterTopStartCorner().col}isOverlappingVertically(t){return this.getOuterBottomStartCorner().row>=t.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=t.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=t.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=t.getOuterTopRightCorner().row}expand(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return(t.row<e.row||t.col<e.col||t.row>i.row||t.col>i.col)&&(this.from=this._createCellCoords(Math.min(e.row,t.row),Math.min(e.col,t.col)),this.to=this._createCellCoords(Math.max(i.row,t.row),Math.max(i.col,t.col)),!0)}expandByRange(t){let e=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(this.includesRange(t)||!this.overlaps(t))return!1;let i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),n=this.getDirection(),o=t.getOuterTopStartCorner(),s=t.getOuterBottomEndCorner(),l=Math.min(i.row,o.row),a=Math.min(i.col,o.col),h=Math.max(r.row,s.row),u=Math.max(r.col,s.col),c=this._createCellCoords(l,a),d=this._createCellCoords(h,u);return this.from=c,this.to=d,this.setDirection(n),e&&(this.highlight.row===this.getOuterBottomRightCorner().row&&"N-S"===this.getVerticalDirection()&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&"W-E"===this.getHorizontalDirection()&&this.flipDirectionHorizontally()),!0}getDirection(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0}setDirection(t){switch(t){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()]}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE")}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW")}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return o(l,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return o(l,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return o(l,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return o(l,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return o(l,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return o(l,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return o(l,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return o(l,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(t){return t.isEqual(this.getOuterTopLeftCorner())||t.isEqual(this.getOuterTopRightCorner())||t.isEqual(this.getOuterBottomLeftCorner())||t.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(t){return t instanceof r.A&&(t.isEqual(this.getOuterBottomEndCorner())?this.getOuterTopStartCorner():t.isEqual(this.getOuterTopStartCorner())?this.getOuterBottomEndCorner():t.isEqual(this.getOuterTopEndCorner())?this.getOuterBottomStartCorner():t.isEqual(this.getOuterBottomStartCorner())?this.getOuterTopEndCorner():void 0)}getBordersSharedWith(t){if(!this.includesRange(t))return[];let e={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(t.from.row,t.to.row),bottom:Math.max(t.from.row,t.to.row),left:Math.min(t.from.col,t.to.col),right:Math.max(t.from.col,t.to.col)},r=[];return e.top===i.top&&r.push("top"),e.right===i.right&&r.push(o(l,this)?"left":"right"),e.bottom===i.bottom&&r.push("bottom"),e.left===i.left&&r.push(o(l,this)?"right":"left"),r}getInner(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let n=t.col;n<=e.col;n++)(this.from.row!==r||this.from.col!==n)&&(this.to.row!==r||this.to.col!==n)&&i.push(this._createCellCoords(r,n));return i}getAll(){let t=this.getOuterTopStartCorner(),e=this.getOuterBottomEndCorner(),i=[];for(let r=t.row;r<=e.row;r++)for(let n=t.col;n<=e.col;n++)t.row===r&&t.col===n?i.push(t):e.row===r&&e.col===n?i.push(e):i.push(this._createCellCoords(r,n));return i}forAll(t){let e=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=e.row;r<=i.row;r++)for(let n=e.col;n<=i.col;n++)if(!1===t(r,n))return}clone(){return new a(this.highlight,this.from,this.to,o(l,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(t,e){return new r.A(t,e,o(l,this))}}let h=a},71197:(t,e,i)=>{"use strict";var r=i(8883),n=i(76093);t.exports=function(t,e,i,o){try{return o?e(r(i)[0],i[1]):e(i)}catch(e){n(t,"throw",e)}}},71310:(t,e,i)=>{"use strict";var r=i(16954),n=i(69905),o=r.Set,s=r.add;t.exports=function(t){var e=new o;return n(t,function(t){s(e,t)}),e}},71423:(t,e,i)=>{"use strict";i.d(e,{O:()=>n});var r=i(89447);function n(t,e){return(0,r.a)(t,null==e?void 0:e.in).getMinutes()}},72132:(t,e,i)=>{"use strict";var r=i(93840),n=i(99365),o=i(94767),s=r(Function.toString);n(o.inspectSource)||(o.inspectSource=function(t){return s(t)}),t.exports=o.inspectSource},72255:t=>{"use strict";t.exports=!1},72794:(t,e,i)=>{"use strict";i.d(e,{$:()=>o});var r=i(95490),n=i(89447);function o(t,e){var i,o,s,l,a,h,u,c;let d=(0,r.q)(),g=null!==(c=null!==(u=null!==(h=null!==(a=null==e?void 0:e.weekStartsOn)&&void 0!==a?a:null==e?void 0:null===(o=e.locale)||void 0===o?void 0:null===(i=o.options)||void 0===i?void 0:i.weekStartsOn)&&void 0!==h?h:d.weekStartsOn)&&void 0!==u?u:null===(l=d.locale)||void 0===l?void 0:null===(s=l.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==c?c:0,f=(0,n.a)(t,null==e?void 0:e.in),p=f.getDay();return f.setDate(f.getDate()+((p<g?-7:0)+6-(p-g))),f.setHours(23,59,59,999),f}},72887:(t,e,i)=>{"use strict";var r=i(14412),n=i(9234),o=i(24851),s=i(8883),l=i(13517),a=i(55544);e.f=r&&!n?Object.defineProperties:function(t,e){s(t);for(var i,r=l(e),n=a(e),h=n.length,u=0;h>u;)o.f(t,i=n[u++],r[i]);return t}},72979:(t,e,i)=>{"use strict";var r=i(54076),n=i(33325),o=i(94948),s=i(42665),l=i(81315);r({target:"Array",proto:!0},{at:function(t){var e=n(this),i=o(e),r=s(t),l=r>=0?r:i+r;return l<0||l>=i?void 0:e[l]}}),l("at")},73183:(t,e,i)=>{"use strict";function r(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){return t.get(s(t,e))}function o(t,e,i){return t.set(s(t,e),i),i}function s(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}i.d(e,{A:()=>h}),i(41658);var l=new WeakMap;class a{constructor(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];r(this,"row",null),r(this,"col",null),function(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}(this,l,!1),o(l,this,i),void 0!==t&&void 0!==e&&(this.row=t,this.col=e)}isValid(t){let{countRows:e,countCols:i,countRowHeaders:r,countColHeaders:n}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...t};return!!Number.isInteger(this.row)&&!!Number.isInteger(this.col)&&!(this.row<-n)&&!(this.col<-r)&&!(this.row>=e)&&!(this.col>=i)}isEqual(t){return t===this||this.row===t.row&&this.col===t.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return n(l,this)}isSouthEastOf(t){return this.row>=t.row&&(n(l,this)?this.col<=t.col:this.col>=t.col)}isNorthWestOf(t){return this.row<=t.row&&(n(l,this)?this.col>=t.col:this.col<=t.col)}isSouthWestOf(t){return this.row>=t.row&&(n(l,this)?this.col>=t.col:this.col<=t.col)}isNorthEastOf(t){return this.row<=t.row&&(n(l,this)?this.col<=t.col:this.col>=t.col)}normalize(){return this.row=null===this.row?this.row:Math.max(this.row,0),this.col=null===this.col?this.col:Math.max(this.col,0),this}assign(t){return Number.isInteger(null==t?void 0:t.row)&&(this.row=t.row),Number.isInteger(null==t?void 0:t.col)&&(this.col=t.col),t instanceof a&&o(l,this,t.isRtl()),this}clone(){return new a(this.row,this.col,n(l,this))}toObject(){return{row:this.row,col:this.col}}}let h=a},74354:(t,e,i)=>{"use strict";var r=i(85592),n=i(93840);t.exports=function(t){if("Function"===r(t))return n(t)}},75036:(t,e,i)=>{"use strict";i(25737)},75708:(t,e,i)=>{"use strict";i.r(e),i.d(e,{curry:()=>c,curryRight:()=>d,debounce:()=>a,fastCall:()=>g,isFunction:()=>o,partial:()=>u,pipe:()=>h,throttle:()=>s,throttleAfterHits:()=>l});var r=i(95061),n=i(78887);function o(t){return"function"==typeof t}function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=0,r={lastCallThrottled:!0},n=null;return function(){for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];let a=Date.now(),h=!1;r.lastCallThrottled=!0,i||(i=a,h=!0);let u=e-(a-i);return h?(r.lastCallThrottled=!1,t.apply(this,s)):(n&&clearTimeout(n),n=setTimeout(()=>{r.lastCallThrottled=!1,t.apply(this,s),i=0,n=void 0},u)),r}}function l(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=s(t,e),n=i;function o(){for(var e=arguments.length,i=Array(e),o=0;o<e;o++)i[o]=arguments[o];return n?(n-=1,t.apply(this,i)):r.apply(this,i)}return o.clearHits=function(){n=i},o}function a(t){let e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200,r=null;return function(){for(var n=arguments.length,o=Array(n),s=0;s<n;s++)o[s]=arguments[s];return r&&clearTimeout(r),r=setTimeout(()=>{e=t.apply(this,o)},i),e}}function h(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[n,...o]=e;return function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return(0,r.arrayReduce)(o,(t,e)=>e(t),n.apply(this,e))}}function u(t){for(var e=arguments.length,i=Array(e>1?e-1:0),r=1;r<e;r++)i[r-1]=arguments[r];return function(){for(var e=arguments.length,r=Array(e),n=0;n<e;n++)r[n]=arguments[n];return t.apply(this,i.concat(r))}}function c(t){let e=t.length;return function i(r){return function(){let n;for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];let a=r.concat(s);return a.length>=e?t.apply(this,a):i(a)}}([])}function d(t){let e=t.length;return function i(r){return function(){let n;for(var o=arguments.length,s=Array(o),l=0;l<o;l++)s[l]=arguments[l];let a=r.concat(s.reverse());return a.length>=e?t.apply(this,a):i(a)}}([])}function g(t,e,i,r,o,s,l,a){if((0,n.isDefined)(a))return t.call(e,i,r,o,s,l,a);if((0,n.isDefined)(l))return t.call(e,i,r,o,s,l);if((0,n.isDefined)(s))return t.call(e,i,r,o,s);if((0,n.isDefined)(o))return t.call(e,i,r,o);if((0,n.isDefined)(r))return t.call(e,i,r);else if((0,n.isDefined)(i))return t.call(e,i);return t.call(e)}},76093:(t,e,i)=>{"use strict";var r=i(67297),n=i(8883),o=i(38896);t.exports=function(t,e,i){var s,l;n(t);try{if(!(s=o(t,"return"))){if("throw"===e)throw i;return i}s=r(s,t)}catch(t){l=!0,s=t}if("throw"===e)throw i;if(l)throw s;return n(s),i}},76144:(t,e,i)=>{"use strict";var r=i(92743),n=TypeError;t.exports=function(t,e){if(!delete t[e])throw new n("Cannot delete property "+r(e)+" of "+r(t))}},76492:(t,e,i)=>{"use strict";i.d(e,{UE:()=>U,ll:()=>B,rD:()=>$,UU:()=>z,cY:()=>j});let r=Math.min,n=Math.max,o=Math.round,s=Math.floor,l=t=>({x:t,y:t}),a={left:"right",right:"left",bottom:"top",top:"bottom"},h={start:"end",end:"start"};function u(t,e){return"function"==typeof t?t(e):t}function c(t){return t.split("-")[0]}function d(t){return t.split("-")[1]}function g(t){return"y"===t?"height":"width"}function f(t){return["top","bottom"].includes(c(t))?"y":"x"}function p(t){return"x"===f(t)?"y":"x"}function m(t){return t.replace(/start|end/g,t=>h[t])}function w(t){return t.replace(/left|right|bottom|top/g,t=>a[t])}function y(t){return"number"!=typeof t?{top:0,right:0,bottom:0,left:0,...t}:{top:t,right:t,bottom:t,left:t}}function b(t){let{x:e,y:i,width:r,height:n}=t;return{width:r,height:n,top:i,left:e,right:e+r,bottom:i+n,x:e,y:i}}function C(t,e,i){let r,{reference:n,floating:o}=t,s=f(e),l=p(e),a=g(l),h=c(e),u="y"===s,m=n.x+n.width/2-o.width/2,w=n.y+n.height/2-o.height/2,y=n[a]/2-o[a]/2;switch(h){case"top":r={x:m,y:n.y-o.height};break;case"bottom":r={x:m,y:n.y+n.height};break;case"right":r={x:n.x+n.width,y:w};break;case"left":r={x:n.x-o.width,y:w};break;default:r={x:n.x,y:n.y}}switch(d(e)){case"start":r[l]-=y*(i&&u?-1:1);break;case"end":r[l]+=y*(i&&u?-1:1)}return r}let S=async(t,e,i)=>{let{placement:r="bottom",strategy:n="absolute",middleware:o=[],platform:s}=i,l=o.filter(Boolean),a=await (null==s.isRTL?void 0:s.isRTL(e)),h=await s.getElementRects({reference:t,floating:e,strategy:n}),{x:u,y:c}=C(h,r,a),d=r,g={},f=0;for(let i=0;i<l.length;i++){let{name:o,fn:p}=l[i],{x:m,y:w,data:y,reset:b}=await p({x:u,y:c,initialPlacement:r,placement:d,strategy:n,middlewareData:g,rects:h,platform:s,elements:{reference:t,floating:e}});u=null!=m?m:u,c=null!=w?w:c,g={...g,[o]:{...g[o],...y}},b&&f<=50&&(f++,"object"==typeof b&&(b.placement&&(d=b.placement),b.rects&&(h=!0===b.rects?await s.getElementRects({reference:t,floating:e,strategy:n}):b.rects),{x:u,y:c}=C(h,d,a)),i=-1)}return{x:u,y:c,placement:d,strategy:n,middlewareData:g}};async function E(t,e){var i;void 0===e&&(e={});let{x:r,y:n,platform:o,rects:s,elements:l,strategy:a}=t,{boundary:h="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:g=!1,padding:f=0}=u(e,t),p=y(f),m=l[g?"floating"===d?"reference":"floating":d],w=b(await o.getClippingRect({element:null==(i=await (null==o.isElement?void 0:o.isElement(m)))||i?m:m.contextElement||await (null==o.getDocumentElement?void 0:o.getDocumentElement(l.floating)),boundary:h,rootBoundary:c,strategy:a})),C="floating"===d?{x:r,y:n,width:s.floating.width,height:s.floating.height}:s.reference,S=await (null==o.getOffsetParent?void 0:o.getOffsetParent(l.floating)),E=await (null==o.isElement?void 0:o.isElement(S))&&await (null==o.getScale?void 0:o.getScale(S))||{x:1,y:1},R=b(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:C,offsetParent:S,strategy:a}):C);return{top:(w.top-R.top+p.top)/E.y,bottom:(R.bottom-w.bottom+p.bottom)/E.y,left:(w.left-R.left+p.left)/E.x,right:(R.right-w.right+p.right)/E.x}}async function R(t,e){let{placement:i,platform:r,elements:n}=t,o=await (null==r.isRTL?void 0:r.isRTL(n.floating)),s=c(i),l=d(i),a="y"===f(i),h=["left","top"].includes(s)?-1:1,g=o&&a?-1:1,p=u(e,t),{mainAxis:m,crossAxis:w,alignmentAxis:y}="number"==typeof p?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return l&&"number"==typeof y&&(w="end"===l?-+y:y),a?{x:w*g,y:m*h}:{x:m*h,y:w*g}}var T=i(86301);function x(t){let e=(0,T.L9)(t),i=parseFloat(e.width)||0,r=parseFloat(e.height)||0,n=(0,T.sb)(t),s=n?t.offsetWidth:i,l=n?t.offsetHeight:r,a=o(i)!==s||o(r)!==l;return a&&(i=s,r=l),{width:i,height:r,$:a}}function M(t){return(0,T.vq)(t)?t:t.contextElement}function k(t){let e=M(t);if(!(0,T.sb)(e))return l(1);let i=e.getBoundingClientRect(),{width:r,height:n,$:s}=x(e),a=(s?o(i.width):i.width)/r,h=(s?o(i.height):i.height)/n;return a&&Number.isFinite(a)||(a=1),h&&Number.isFinite(h)||(h=1),{x:a,y:h}}let O=l(0);function I(t){let e=(0,T.zk)(t);return(0,T.Tc)()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:O}function A(t,e,i,r){var n;void 0===e&&(e=!1),void 0===i&&(i=!1);let o=t.getBoundingClientRect(),s=M(t),a=l(1);e&&(r?(0,T.vq)(r)&&(a=k(r)):a=k(t));let h=(void 0===(n=i)&&(n=!1),r&&(!n||r===(0,T.zk)(s))&&n)?I(s):l(0),u=(o.left+h.x)/a.x,c=(o.top+h.y)/a.y,d=o.width/a.x,g=o.height/a.y;if(s){let t=(0,T.zk)(s),e=r&&(0,T.vq)(r)?(0,T.zk)(r):r,i=t,n=(0,T._m)(i);for(;n&&r&&e!==i;){let t=k(n),e=n.getBoundingClientRect(),r=(0,T.L9)(n),o=e.left+(n.clientLeft+parseFloat(r.paddingLeft))*t.x,s=e.top+(n.clientTop+parseFloat(r.paddingTop))*t.y;u*=t.x,c*=t.y,d*=t.x,g*=t.y,u+=o,c+=s,i=(0,T.zk)(n),n=(0,T._m)(i)}}return b({width:d,height:g,x:u,y:c})}function N(t,e){let i=(0,T.CP)(t).scrollLeft;return e?e.left+i:A((0,T.ep)(t)).left+i}function H(t,e,i){void 0===i&&(i=!1);let r=t.getBoundingClientRect();return{x:r.left+e.scrollLeft-(i?0:N(t,r)),y:r.top+e.scrollTop}}function P(t,e,i){let r;if("viewport"===e)r=function(t,e){let i=(0,T.zk)(t),r=(0,T.ep)(t),n=i.visualViewport,o=r.clientWidth,s=r.clientHeight,l=0,a=0;if(n){o=n.width,s=n.height;let t=(0,T.Tc)();(!t||t&&"fixed"===e)&&(l=n.offsetLeft,a=n.offsetTop)}return{width:o,height:s,x:l,y:a}}(t,i);else if("document"===e)r=function(t){let e=(0,T.ep)(t),i=(0,T.CP)(t),r=t.ownerDocument.body,o=n(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=n(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight),l=-i.scrollLeft+N(t),a=-i.scrollTop;return"rtl"===(0,T.L9)(r).direction&&(l+=n(e.clientWidth,r.clientWidth)-o),{width:o,height:s,x:l,y:a}}((0,T.ep)(t));else if((0,T.vq)(e))r=function(t,e){let i=A(t,!0,"fixed"===e),r=i.top+t.clientTop,n=i.left+t.clientLeft,o=(0,T.sb)(t)?k(t):l(1),s=t.clientWidth*o.x,a=t.clientHeight*o.y;return{width:s,height:a,x:n*o.x,y:r*o.y}}(e,i);else{let i=I(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return b(r)}function _(t){return"static"===(0,T.L9)(t).position}function D(t,e){if(!(0,T.sb)(t)||"fixed"===(0,T.L9)(t).position)return null;if(e)return e(t);let i=t.offsetParent;return(0,T.ep)(t)===i&&(i=i.ownerDocument.body),i}function L(t,e){let i=(0,T.zk)(t);if((0,T.Tf)(t))return i;if(!(0,T.sb)(t)){let e=(0,T.$4)(t);for(;e&&!(0,T.eu)(e);){if((0,T.vq)(e)&&!_(e))return e;e=(0,T.$4)(e)}return i}let r=D(t,e);for(;r&&(0,T.Lv)(r)&&_(r);)r=D(r,e);return r&&(0,T.eu)(r)&&_(r)&&!(0,T.sQ)(r)?i:r||(0,T.gJ)(t)||i}let F=async function(t){let e=this.getOffsetParent||L,i=this.getDimensions,r=await i(t.floating);return{reference:function(t,e,i){let r=(0,T.sb)(e),n=(0,T.ep)(e),o="fixed"===i,s=A(t,!0,o,e),a={scrollLeft:0,scrollTop:0},h=l(0);if(r||!r&&!o)if(("body"!==(0,T.mq)(e)||(0,T.ZU)(n))&&(a=(0,T.CP)(e)),r){let t=A(e,!0,o,e);h.x=t.x+e.clientLeft,h.y=t.y+e.clientTop}else n&&(h.x=N(n));o&&!r&&n&&(h.x=N(n));let u=!n||r||o?l(0):H(n,a);return{x:s.left+a.scrollLeft-h.x-u.x,y:s.top+a.scrollTop-h.y-u.y,width:s.width,height:s.height}}(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},V={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{elements:e,rect:i,offsetParent:r,strategy:n}=t,o="fixed"===n,s=(0,T.ep)(r),a=!!e&&(0,T.Tf)(e.floating);if(r===s||a&&o)return i;let h={scrollLeft:0,scrollTop:0},u=l(1),c=l(0),d=(0,T.sb)(r);if((d||!d&&!o)&&(("body"!==(0,T.mq)(r)||(0,T.ZU)(s))&&(h=(0,T.CP)(r)),(0,T.sb)(r))){let t=A(r);u=k(r),c.x=t.x+r.clientLeft,c.y=t.y+r.clientTop}let g=!s||d||o?l(0):H(s,h,!0);return{width:i.width*u.x,height:i.height*u.y,x:i.x*u.x-h.scrollLeft*u.x+c.x+g.x,y:i.y*u.y-h.scrollTop*u.y+c.y+g.y}},getDocumentElement:T.ep,getClippingRect:function(t){let{element:e,boundary:i,rootBoundary:o,strategy:s}=t,l=[..."clippingAncestors"===i?(0,T.Tf)(e)?[]:function(t,e){let i=e.get(t);if(i)return i;let r=(0,T.v9)(t,[],!1).filter(t=>(0,T.vq)(t)&&"body"!==(0,T.mq)(t)),n=null,o="fixed"===(0,T.L9)(t).position,s=o?(0,T.$4)(t):t;for(;(0,T.vq)(s)&&!(0,T.eu)(s);){let e=(0,T.L9)(s),i=(0,T.sQ)(s);i||"fixed"!==e.position||(n=null),(o?!i&&!n:!i&&"static"===e.position&&!!n&&["absolute","fixed"].includes(n.position)||(0,T.ZU)(s)&&!i&&function t(e,i){let r=(0,T.$4)(e);return!(r===i||!(0,T.vq)(r)||(0,T.eu)(r))&&("fixed"===(0,T.L9)(r).position||t(r,i))}(t,s))?r=r.filter(t=>t!==s):n=e,s=(0,T.$4)(s)}return e.set(t,r),r}(e,this._c):[].concat(i),o],a=l[0],h=l.reduce((t,i)=>{let o=P(e,i,s);return t.top=n(o.top,t.top),t.right=r(o.right,t.right),t.bottom=r(o.bottom,t.bottom),t.left=n(o.left,t.left),t},P(e,a,s));return{width:h.right-h.left,height:h.bottom-h.top,x:h.left,y:h.top}},getOffsetParent:L,getElementRects:F,getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){let{width:e,height:i}=x(t);return{width:e,height:i}},getScale:k,isElement:T.vq,isRTL:function(t){return"rtl"===(0,T.L9)(t).direction}};function W(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function B(t,e,i,o){let l;void 0===o&&(o={});let{ancestorScroll:a=!0,ancestorResize:h=!0,elementResize:u="function"==typeof ResizeObserver,layoutShift:c="function"==typeof IntersectionObserver,animationFrame:d=!1}=o,g=M(t),f=a||h?[...g?(0,T.v9)(g):[],...(0,T.v9)(e)]:[];f.forEach(t=>{a&&t.addEventListener("scroll",i,{passive:!0}),h&&t.addEventListener("resize",i)});let p=g&&c?function(t,e){let i,o=null,l=(0,T.ep)(t);function a(){var t;clearTimeout(i),null==(t=o)||t.disconnect(),o=null}return!function h(u,c){void 0===u&&(u=!1),void 0===c&&(c=1),a();let d=t.getBoundingClientRect(),{left:g,top:f,width:p,height:m}=d;if(u||e(),!p||!m)return;let w=s(f),y=s(l.clientWidth-(g+p)),b={rootMargin:-w+"px "+-y+"px "+-s(l.clientHeight-(f+m))+"px "+-s(g)+"px",threshold:n(0,r(1,c))||1},C=!0;function S(e){let r=e[0].intersectionRatio;if(r!==c){if(!C)return h();r?h(!1,r):i=setTimeout(()=>{h(!1,1e-7)},1e3)}1!==r||W(d,t.getBoundingClientRect())||h(),C=!1}try{o=new IntersectionObserver(S,{...b,root:l.ownerDocument})}catch(t){o=new IntersectionObserver(S,b)}o.observe(t)}(!0),a}(g,i):null,m=-1,w=null;u&&(w=new ResizeObserver(t=>{let[r]=t;r&&r.target===g&&w&&(w.unobserve(e),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var t;null==(t=w)||t.observe(e)})),i()}),g&&!d&&w.observe(g),w.observe(e));let y=d?A(t):null;return d&&function e(){let r=A(t);y&&!W(y,r)&&i(),y=r,l=requestAnimationFrame(e)}(),i(),()=>{var t;f.forEach(t=>{a&&t.removeEventListener("scroll",i),h&&t.removeEventListener("resize",i)}),null==p||p(),null==(t=w)||t.disconnect(),w=null,d&&cancelAnimationFrame(l)}}let j=function(t){return void 0===t&&(t=0),{name:"offset",options:t,async fn(e){var i,r;let{x:n,y:o,placement:s,middlewareData:l}=e,a=await R(e,t);return s===(null==(i=l.offset)?void 0:i.placement)&&null!=(r=l.arrow)&&r.alignmentOffset?{}:{x:n+a.x,y:o+a.y,data:{...a,placement:s}}}}},z=function(t){return void 0===t&&(t={}),{name:"flip",options:t,async fn(e){var i,r,n,o,s;let{placement:l,middlewareData:a,rects:h,initialPlacement:y,platform:b,elements:C}=e,{mainAxis:S=!0,crossAxis:R=!0,fallbackPlacements:T,fallbackStrategy:x="bestFit",fallbackAxisSideDirection:M="none",flipAlignment:k=!0,...O}=u(t,e);if(null!=(i=a.arrow)&&i.alignmentOffset)return{};let I=c(l),A=f(y),N=c(y)===y,H=await (null==b.isRTL?void 0:b.isRTL(C.floating)),P=T||(N||!k?[w(y)]:function(t){let e=w(t);return[m(t),e,m(e)]}(y)),_="none"!==M;!T&&_&&P.push(...function(t,e,i,r){let n=d(t),o=function(t,e,i){let r=["left","right"],n=["right","left"];switch(t){case"top":case"bottom":if(i)return e?n:r;return e?r:n;case"left":case"right":return e?["top","bottom"]:["bottom","top"];default:return[]}}(c(t),"start"===i,r);return n&&(o=o.map(t=>t+"-"+n),e&&(o=o.concat(o.map(m)))),o}(y,k,M,H));let D=[y,...P],L=await E(e,O),F=[],V=(null==(r=a.flip)?void 0:r.overflows)||[];if(S&&F.push(L[I]),R){let t=function(t,e,i){void 0===i&&(i=!1);let r=d(t),n=p(t),o=g(n),s="x"===n?r===(i?"end":"start")?"right":"left":"start"===r?"bottom":"top";return e.reference[o]>e.floating[o]&&(s=w(s)),[s,w(s)]}(l,h,H);F.push(L[t[0]],L[t[1]])}if(V=[...V,{placement:l,overflows:F}],!F.every(t=>t<=0)){let t=((null==(n=a.flip)?void 0:n.index)||0)+1,e=D[t];if(e&&("alignment"!==R||A===f(e)||V.every(t=>t.overflows[0]>0&&f(t.placement)===A)))return{data:{index:t,overflows:V},reset:{placement:e}};let i=null==(o=V.filter(t=>t.overflows[0]<=0).sort((t,e)=>t.overflows[1]-e.overflows[1])[0])?void 0:o.placement;if(!i)switch(x){case"bestFit":{let t=null==(s=V.filter(t=>{if(_){let e=f(t.placement);return e===A||"y"===e}return!0}).map(t=>[t.placement,t.overflows.filter(t=>t>0).reduce((t,e)=>t+e,0)]).sort((t,e)=>t[1]-e[1])[0])?void 0:s[0];t&&(i=t);break}case"initialPlacement":i=y}if(l!==i)return{reset:{placement:i}}}return{}}}},U=t=>({name:"arrow",options:t,async fn(e){let{x:i,y:o,placement:s,rects:l,platform:a,elements:h,middlewareData:c}=e,{element:f,padding:m=0}=u(t,e)||{};if(null==f)return{};let w=y(m),b={x:i,y:o},C=p(s),S=g(C),E=await a.getDimensions(f),R="y"===C,T=R?"clientHeight":"clientWidth",x=l.reference[S]+l.reference[C]-b[C]-l.floating[S],M=b[C]-l.reference[C],k=await (null==a.getOffsetParent?void 0:a.getOffsetParent(f)),O=k?k[T]:0;O&&await (null==a.isElement?void 0:a.isElement(k))||(O=h.floating[T]||l.floating[S]);let I=O/2-E[S]/2-1,A=r(w[R?"top":"left"],I),N=r(w[R?"bottom":"right"],I),H=O-E[S]-N,P=O/2-E[S]/2+(x/2-M/2),_=n(A,r(P,H)),D=!c.arrow&&null!=d(s)&&P!==_&&l.reference[S]/2-(P<A?A:N)-E[S]/2<0,L=D?P<A?P-A:P-H:0;return{[C]:b[C]+L,data:{[C]:_,centerOffset:P-_-L,...D&&{alignmentOffset:L}},reset:D}}}),$=(t,e,i)=>{let r=new Map,n={platform:V,...i},o={...n.platform,_c:r};return S(t,e,{...n,platform:o})}},76494:(t,e,i)=>{"use strict";var r=i(99365);t.exports=function(t){return"object"==typeof t?null!==t:r(t)}},78887:(t,e,i)=>{"use strict";i.r(e),i.d(e,{_injectProductInfo:()=>S,isDefined:()=>s,isEmpty:()=>a,isRegExp:()=>h,isUndefined:()=>l,stringify:()=>o});var r=i(82940),n=i(83457);function o(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=null===t?"":t.toString();break;case"undefined":e="";break;default:e=t.toString()}return e}function s(t){return void 0!==t}function l(t){return void 0===t}function a(t){return null===t||""===t||l(t)}function h(t){return"[object RegExp]"===Object.prototype.toString.call(t)}let u="length",c=t=>parseInt(t,16),d=t=>parseInt(t,10),g=(t,e,i)=>t.substr(e,i),f=t=>t.codePointAt(0)-65,p=t=>`${t}`.replace(/\-/g,""),m=t=>c(g(p(t),c("12"),f("F")))/(c(g(p(t),f("B"),~~![][u]))||9),w=()=>"undefined"!=typeof location&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host),y=!1,b={invalid:()=>(0,n.O)`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return(0,n.O)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>(0,n.O)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},C={invalid:()=>(0,n.O)`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:i}=t;return(0,n.O)`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${i}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>(0,n.O)`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function S(t,e){let i,n=!a(t),o="string"==typeof t&&"non-commercial-and-evaluation"===t.toLowerCase(),s="15.3.0",l="invalid",h="invalid",S=function(t){let e=[][u],i=e;if(t[u]!==f("Z"))return!1;for(let e="",r="B<H4P+".split(""),n=f(r.shift());n;n=f(r.shift()||"A"))--n<""[u]?i|=(d(`${d(c(e)+(c(g(t,Math.abs(n),2))+[]).padStart(2,"0"))}`)%97||2)>>1:e=g(t,n,n?1===r[u]?9:8:6);return i===e}(t=p(t||""));if(n||o||S)if(S){let e=Math.floor(r("29/04/2025","DD/MM/YYYY").toDate().getTime()/864e5),n=m(t);i=r((n+1)*864e5,"x").format("MMMM DD, YYYY"),e>n?(l="expired",h="expired"):(l="valid",h="valid")}else o?(l="non_commercial",h="valid"):(l="invalid",h="invalid");else l="missing",h="missing";if(w()&&(l="valid",h="valid"),y||"valid"===l||(b[l]({keyValidityDate:i,hotVersion:s})&&console["non_commercial"===l?"info":"warn"](b[l]({keyValidityDate:i,hotVersion:s})),y=!0),"valid"!==h&&e.parentNode&&C[h]({keyValidityDate:i,hotVersion:s})){let t=document.createElement("div");t.className="handsontable hot-display-license-info",t.innerHTML=C[h]({keyValidityDate:i,hotVersion:s}),e.parentNode.insertBefore(t,e.nextSibling)}}},79031:(t,e,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(39615),s=i(8883),l=i(99365),a=i(16683),h=i(47580),u=i(53480),c=i(56963),d=i(95467),g=i(7107),f=i(66163).IteratorPrototype,p=i(14412),m=i(72255),w="constructor",y="Iterator",b=g("toStringTag"),C=TypeError,S=n[y],E=m||!l(S)||S.prototype!==f||!c(function(){S({})}),R=function(){if(o(this,f),a(this)===f)throw new C("Abstract class Iterator not directly constructable")},T=function(t,e){p?h(f,t,{configurable:!0,get:function(){return e},set:function(e){if(s(this),this===f)throw new C("You can't redefine this property");d(this,t)?this[t]=e:u(this,t,e)}}):f[t]=e};d(f,b)||T(b,y),(E||!d(f,w)||f[w]===Object)&&T(w,R),R.prototype=f,r({global:!0,constructor:!0,forced:E},{Iterator:R})},79791:(t,e,i)=>{"use strict";i.r(e),i.d(e,{KEY_CODES:()=>o,isCtrlKey:()=>h,isCtrlMetaKey:()=>u,isFunctionKey:()=>a,isKey:()=>c,isPrintableChar:()=>l}),i(19398);var r=i(95061),n=i(59594);let o={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:(0,n.isFirefox)()?182:174,AUDIO_MUTE:(0,n.isFirefox)()?181:173,AUDIO_UP:(0,n.isFirefox)()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},s=[o.ALT,o.ARROW_DOWN,o.ARROW_LEFT,o.ARROW_RIGHT,o.ARROW_UP,o.AUDIO_DOWN,o.AUDIO_MUTE,o.AUDIO_UP,o.BACKSPACE,o.CAPS_LOCK,o.DELETE,o.END,o.ENTER,o.ESCAPE,o.F1,o.F2,o.F3,o.F4,o.F5,o.F6,o.F7,o.F8,o.F9,o.F10,o.F11,o.F12,o.F13,o.F14,o.F15,o.F16,o.F17,o.F18,o.F19,o.HOME,o.INSERT,o.MEDIA_NEXT,o.MEDIA_PLAY_PAUSE,o.MEDIA_PREV,o.MEDIA_STOP,o.NULL,o.NUM_LOCK,o.PAGE_DOWN,o.PAGE_UP,o.PAUSE,o.SCROLL_LOCK,o.SHIFT,o.TAB];function l(t){return 32===t||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function a(t){return s.includes(t)}function h(t){let e=[];return(0,n.isMacOS)()?e.push(o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX):e.push(o.CONTROL),e.includes(t)}function u(t){return[o.CONTROL,o.COMMAND_LEFT,o.COMMAND_RIGHT,o.COMMAND_FIREFOX].includes(t)}function c(t,e){let i=e.split("|"),n=!1;return(0,r.arrayEach)(i,e=>{if(t===o[e])return n=!0,!1}),n}},79960:(t,e,i)=>{"use strict";i.d(e,{A:()=>u}),i(41658),i(19398),i(12252),i(20775);var r=i(19857),n=i(15616),o=i(95061),s=i(13455),l=i(75708);function a(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class h{constructor(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];a(this,"hot",void 0),a(this,"data",void 0),a(this,"dataType","array"),a(this,"colToProp",()=>{}),a(this,"propToCol",()=>{}),this.hot=t,this.data=e}modifyRowData(t){let e;return this.hot.hasHook("modifyRowData")&&(e=this.hot.runHooks("modifyRowData",t)),void 0===e||Number.isInteger(e)?this.data[t]:e}getData(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.data&&0!==this.data.length?this.getByRange(null,null,t):this.data}setData(t){this.data=t}getAtColumn(t){let e=[];return(0,o.arrayEach)(this.data,(i,r)=>{let n=this.getAtCell(r,t);e.push(n)}),e}getAtRow(t,e,i){let n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=void 0===e&&void 0===i,{dataDotNotation:a}=this.hot.getSettings(),h=null,u=null;if(Array.isArray(h=this.modifyRowData(t)))u=[],o?h.forEach((e,i)=>{u[i]=this.getAtPhysicalCell(t,i,h)}):(0,s.rangeEach)(e,i,i=>{u[i-e]=this.getAtPhysicalCell(t,i,h)});else if((0,r.isObject)(h)||(0,l.isFunction)(h))if(u=n?[]:{},!o||n){let o=this.countFirstRowKeys()-1;(0,s.rangeEach)(0,o,s=>{let l=this.colToProp(s);if(s>=(e||0)&&s<=(i||o)&&!Number.isInteger(l)){let e=this.getAtPhysicalCell(t,l,h);n?u.push(e):a?(0,r.setProperty)(u,l,e):u[l]=e}})}else(0,r.objectEach)(h,(e,i)=>{let n=this.getAtPhysicalCell(t,i,h);a?(0,r.setProperty)(u,i,n):u[i]=n});return u}setAtCell(t,e,i){if(!(t>=this.countRows()||e>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){let n=(0,r.createObjectPropListener)(i);this.hot.runHooks("modifySourceData",t,e,n,"set"),n.isTouched()&&(i=n.value)}["__proto__","constructor","prototype"].includes(t)||(Number.isInteger(e)?this.data[t][e]=i:(0,r.setProperty)(this.data[t],e,i))}}getAtPhysicalCell(t,e,i){let n=null;if(i)if("string"==typeof e){let{dataDotNotation:t}=this.hot.getSettings();n=t?(0,r.getProperty)(i,e):i[e]}else n="function"==typeof e?e(i):i[e];if(this.hot.hasHook("modifySourceData")){let i=(0,r.createObjectPropListener)(n);this.hot.runHooks("modifySourceData",t,e,i,"get"),i.isTouched()&&(n=i.value)}return n}getAtCell(t,e){let i=this.modifyRowData(t);return this.getAtPhysicalCell(t,this.colToProp(e),i)}getByRange(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!1,n=null,o=null,l=null,a=null;null===t||null===e?(r=!0,n=0,l=this.countRows()-1):(n=Math.min(t.row,e.row),o=Math.min(t.col,e.col),l=Math.max(t.row,e.row),a=Math.max(t.col,e.col));let h=[];return(0,s.rangeEach)(n,l,t=>{h.push(r?this.getAtRow(t,void 0,void 0,i):this.getAtRow(t,o,a,i))}),h}countRows(){if(this.hot.hasHook("modifySourceLength")){let t=this.hot.runHooks("modifySourceLength");if(Number.isInteger(t))return t}return this.data.length}countFirstRowKeys(){return(0,n.countFirstRowKeys)(this.data)}destroy(){this.data=null,this.hot=null}}let u=h},80520:(t,e,i)=>{"use strict";i.d(e,{v:()=>n});var r=i(89447);function n(t,e,i){let n=+(0,r.a)(t,null==i?void 0:i.in),[o,s]=[+(0,r.a)(e.start,null==i?void 0:i.in),+(0,r.a)(e.end,null==i?void 0:i.in)].sort((t,e)=>t-e);return n>=o&&n<=s}},80729:(t,e,i)=>{"use strict";var r=i(94272),n=i(16954).has,o=i(57580),s=i(15743),l=i(6497),a=i(76093);t.exports=function(t){var e=r(this),i=s(t);if(o(e)<i.size)return!1;var h=i.getIterator();return!1!==l(h,function(t){if(!n(e,t))return a(h,"normal",!1)})}},80763:(t,e,i)=>{"use strict";var r=i(27764),n=String;t.exports=function(t){if("Symbol"===r(t))throw TypeError("Cannot convert a Symbol value to a string");return n(t)}},81174:(t,e,i)=>{"use strict";i.d(e,{A:()=>s}),i(19398);var r=i(19857),n=i(75708);let o={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},runLocalHooks(t,e,i,r,o,s,l){if(this._localHooks[t]){let a=this._localHooks[t].length;for(let h=0;h<a;h++)(0,n.fastCall)(this._localHooks[t][h],this,e,i,r,o,s,l)}},clearLocalHooks(){return this._localHooks={},this}};(0,r.defineGetter)(o,"MIXIN_NAME","localHooks",{writable:!1,enumerable:!1});let s=o},81315:(t,e,i)=>{"use strict";var r=i(7107),n=i(29440),o=i(24851).f,s=r("unscopables"),l=Array.prototype;void 0===l[s]&&o(l,s,{configurable:!0,value:n(null)}),t.exports=function(t){l[s][t]=!0}},81698:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(93840),s=i(16604),l=i(99365),a=i(76494),h=i(60680),u=i(80763),c=i(38896),d=i(85896),g=i(66456),f=i(7107),p=i(72255),m=f("replace"),w=TypeError,y=o("".indexOf),b=o("".replace),C=o("".slice),S=Math.max;r({target:"String",proto:!0},{replaceAll:function(t,e){var i,r,o,f,E,R,T,x,M,k=s(this),O=0,I="";if(a(t)){if((i=h(t))&&!~y(u(s(d(t))),"g"))throw new w("`.replaceAll` does not allow non-global regexes");if(r=c(t,m))return n(r,t,k,e);if(p&&i)return b(u(k),t,e)}for(o=u(k),f=u(t),(E=l(e))||(e=u(e)),T=S(1,R=f.length),x=y(o,f);-1!==x;)M=E?u(e(f,x,o)):g(f,o,x,[],void 0,e),I+=C(o,O,x)+M,O=x+R,x=x+T>o.length?-1:y(o,f,x+T);return O<o.length&&(I+=C(o,O)),I}})},81938:(t,e,i)=>{"use strict";var r=i(42665),n=Math.max,o=Math.min;t.exports=function(t,e){var i=r(t);return i<0?n(i+e,0):o(i,e)}},82309:(t,e,i)=>{"use strict";var r=i(42620),n=i(99365);t.exports=function(t,e){var i;return arguments.length<2?n(i=r[t])?i:void 0:r[t]&&r[t][e]}},82505:(t,e,i)=>{"use strict";i.d(e,{n:()=>a}),i(41658),i(19398);var r=i(13455),n=i(19857),o=i(75708),s=i(81174);function l(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class a{constructor(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;l(this,"indexedValues",[]),l(this,"initValueOrFn",void 0),this.initValueOrFn=t}getValues(){return this.indexedValues}getValueAtIndex(t){let e=this.indexedValues;if(t<e.length)return e[t]}setValues(t){this.indexedValues=t.slice(),this.runLocalHooks("change")}setValueAtIndex(t,e){return t<this.indexedValues.length&&(this.indexedValues[t]=e,this.runLocalHooks("change"),!0)}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,(0,o.isFunction)(this.initValueOrFn)?(0,r.rangeEach)(t-1,t=>this.indexedValues.push(this.initValueOrFn(t))):(0,r.rangeEach)(t-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(t){return this.setDefaultValues(t),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}(0,n.mixin)(a,s.A)},82637:(t,e,i)=>{"use strict";i.d(e,{w:()=>o});var r=i(61183),n=i(7038);function o(t,e,i){let[o,s]=(0,r.x)(null==i?void 0:i.in,t,e);return 4*(o.getFullYear()-s.getFullYear())+((0,n.F)(o)-(0,n.F)(s))}},82831:(t,e,i)=>{"use strict";var r,n,o,s=i(50344),l=i(42620),a=i(76494),h=i(24201),u=i(95467),c=i(94767),d=i(37889),g=i(4389),f="Object already initialized",p=l.TypeError,m=l.WeakMap;if(s||c.state){var w=c.state||(c.state=new m);w.get=w.get,w.has=w.has,w.set=w.set,r=function(t,e){if(w.has(t))throw new p(f);return e.facade=t,w.set(t,e),e},n=function(t){return w.get(t)||{}},o=function(t){return w.has(t)}}else{var y=d("state");g[y]=!0,r=function(t,e){if(u(t,y))throw new p(f);return e.facade=t,h(t,y,e),e},n=function(t){return u(t,y)?t[y]:{}},o=function(t){return u(t,y)}}t.exports={set:r,get:n,has:o,enforce:function(t){return o(t)?n(t):r(t,{})},getterFor:function(t){return function(e){var i;if(!a(e)||(i=n(e)).type!==t)throw new p("Incompatible receiver, "+t+" required");return i}}}},83072:(t,e,i)=>{"use strict";var r=i(56963),n=i(99365),o=/#|\.prototype\./,s=function(t,e){var i=a[l(t)];return i===u||i!==h&&(n(e)?r(e):!!e)},l=s.normalize=function(t){return String(t).replace(o,".").toLowerCase()},a=s.data={},h=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},83279:(t,e,i)=>{"use strict";var r=i(93840),n=i(2254),o=i(99365),s=i(85592),l=i(80763),a=r([].push);t.exports=function(t){if(o(t))return t;if(n(t)){for(var e=t.length,i=[],r=0;r<e;r++){var h=t[r];"string"==typeof h?a(i,h):("number"==typeof h||"Number"===s(h)||"String"===s(h))&&a(i,l(h))}var u=i.length,c=!0;return function(t,e){if(c)return c=!1,e;if(n(this))return e;for(var r=0;r<u;r++)if(i[r]===t)return e}}}},83457:(t,e,i)=>{"use strict";i.d(e,{O:()=>n});var r=i(95061);function n(t){for(var e=arguments.length,i=Array(e>1?e-1:0),n=1;n<e;n++)i[n-1]=arguments[n];return(0,r.arrayReduce)(t,(t,e,r)=>t+e.replace(/\r?\n\s*/g,"")+(i[r]?i[r]:""),"").trim()}},83869:(t,e,i)=>{"use strict";t.exports="NODE"===i(28060)},83929:(t,e,i)=>{"use strict";i.d(e,{dv:()=>l,fV:()=>n,sM:()=>o});var r=i(52571);class n{constructor(t,e,i={}){var r;this.match=t,this.match=t,this.handler="string"==typeof e?(r=e,function(t,e,i,n){let o=r;if(e[1]){let t=e[0].lastIndexOf(e[1]);o+=e[0].slice(t+e[1].length);let r=(i+=t)-n;r>0&&(o=e[0].slice(t-r,t)+o,i=n)}return t.tr.insertText(o,i,n)}):e,this.undoable=!1!==i.undoable,this.inCode=i.inCode||!1,this.inCodeMark=!1!==i.inCodeMark}}function o({rules:t}){let e=new r.k_({state:{init:()=>null,apply(t,e){let i=t.getMeta(this);return i||(t.selectionSet||t.docChanged?null:e)}},props:{handleTextInput:(i,r,n,o)=>s(i,r,n,o,t,e),handleDOMEvents:{compositionend:i=>{setTimeout(()=>{let{$cursor:r}=i.state.selection;r&&s(i,r.pos,r.pos,"",t,e)})}}},isInputRules:!0});return e}function s(t,e,i,r,n,o){if(t.composing)return!1;let s=t.state,l=s.doc.resolve(e),a=l.parent.textBetween(Math.max(0,l.parentOffset-500),l.parentOffset,null,"￼")+r;for(let h=0;h<n.length;h++){let u=n[h];if(!u.inCodeMark&&l.marks().some(t=>t.type.spec.code))continue;if(l.parent.type.spec.code){if(!u.inCode)continue}else if("only"===u.inCode)continue;let c=u.match.exec(a),d=c&&c[0].length>=r.length&&u.handler(s,c,e-(c[0].length-r.length),i);if(d)return u.undoable&&d.setMeta(o,{transform:d,from:e,to:i,text:r}),t.dispatch(d),!0}return!1}let l=(t,e)=>{let i=t.plugins;for(let r=0;r<i.length;r++){let n=i[r],o;if(n.spec.isInputRules&&(o=n.getState(t))){if(e){let i=t.tr,r=o.transform;for(let t=r.steps.length-1;t>=0;t--)i.step(r.steps[t].invert(r.docs[t]));if(o.text){let e=i.doc.resolve(o.from).marks();i.replaceWith(o.from,o.to,t.schema.text(o.text,e))}else i.delete(o.from,o.to);e(i)}return!0}}return!1};new n(/--$/,"—",{inCodeMark:!1}),new n(/\.\.\.$/,"…",{inCodeMark:!1}),new n(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“",{inCodeMark:!1}),new n(/"$/,"”",{inCodeMark:!1}),new n(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘",{inCodeMark:!1}),new n(/'$/,"’",{inCodeMark:!1})},84122:(t,e,i)=>{"use strict";i.d(e,{J:()=>l}),i(41658),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418);var r=i(16880),n=i(19857),o=i(75708);function s(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class l{constructor(t){var e=this;s(this,"metaManager",void 0),s(this,"metaSyncMemo",new Map),this.metaManager=t,t.addLocalHook("afterGetCellMeta",function(){return e.extendCellMeta(...arguments)}),r.R.getSingleton().add("beforeRender",t=>{t&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(t){var e,i;let{row:r,col:s}=t;if(null!==(e=this.metaSyncMemo.get(r))&&void 0!==e&&e.has(s))return;let{visualRow:l,visualCol:a}=t,h=this.metaManager.hot,u=h.colToProp(a);t.prop=u,h.runHooks("beforeGetCellMeta",l,a,t);let c=(0,n.hasOwnProperty)(t,"type")?t.type:null,d=(0,o.isFunction)(t.cells)?t.cells(r,s,u):null;c&&(d?d.type=null!==(i=d.type)&&void 0!==i?i:c:d={type:c}),d&&this.metaManager.updateCellMeta(r,s,d),h.runHooks("afterGetCellMeta",l,a,t),this.metaSyncMemo.has(r)||this.metaSyncMemo.set(r,new Set),this.metaSyncMemo.get(r).add(s)}}},84423:(t,e,i)=>{"use strict";i.d(e,{k:()=>o});var r=i(95490),n=i(89447);function o(t,e){var i,o,s,l,a,h,u,c;let d=(0,r.q)(),g=null!==(c=null!==(u=null!==(h=null!==(a=null==e?void 0:e.weekStartsOn)&&void 0!==a?a:null==e?void 0:null===(o=e.locale)||void 0===o?void 0:null===(i=o.options)||void 0===i?void 0:i.weekStartsOn)&&void 0!==h?h:d.weekStartsOn)&&void 0!==u?u:null===(l=d.locale)||void 0===l?void 0:null===(s=l.options)||void 0===s?void 0:s.weekStartsOn)&&void 0!==c?c:0,f=(0,n.a)(t,null==e?void 0:e.in),p=f.getDay();return f.setDate(f.getDate()-(7*(p<g)+p-g)),f.setHours(0,0,0,0),f}},84536:(t,e,i)=>{"use strict";i.d(e,{A$:()=>h,DW:()=>l,Jn:()=>a});var r=i(78887),n=i(19857),o=i(57193),s=i(83457);function l(t,e){return(0,n.objectEach)(e,(e,i)=>{(0,r.isUndefined)(t[i])&&(t[i]=e)}),t}function a(t){let e=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return e?`${e[1].toLowerCase()}-${e[2].toUpperCase()}`:t}function h(t){(0,r.isDefined)(t)&&(0,o.z3)((0,s.O)`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}},84945:(t,e,i)=>{"use strict";i.d(e,{UE:()=>p,UU:()=>f,cY:()=>g,we:()=>c});var r=i(76492),n=i(12115),o=i(47650),s="undefined"!=typeof document?n.useLayoutEffect:function(){};function l(t,e){let i,r,n;if(t===e)return!0;if(typeof t!=typeof e)return!1;if("function"==typeof t&&t.toString()===e.toString())return!0;if(t&&e&&"object"==typeof t){if(Array.isArray(t)){if((i=t.length)!==e.length)return!1;for(r=i;0!=r--;)if(!l(t[r],e[r]))return!1;return!0}if((i=(n=Object.keys(t)).length)!==Object.keys(e).length)return!1;for(r=i;0!=r--;)if(!({}).hasOwnProperty.call(e,n[r]))return!1;for(r=i;0!=r--;){let i=n[r];if(("_owner"!==i||!t.$$typeof)&&!l(t[i],e[i]))return!1}return!0}return t!=t&&e!=e}function a(t){return"undefined"==typeof window?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function h(t,e){let i=a(t);return Math.round(e*i)/i}function u(t){let e=n.useRef(t);return s(()=>{e.current=t}),e}function c(t){void 0===t&&(t={});let{placement:e="bottom",strategy:i="absolute",middleware:c=[],platform:d,elements:{reference:g,floating:f}={},transform:p=!0,whileElementsMounted:m,open:w}=t,[y,b]=n.useState({x:0,y:0,strategy:i,placement:e,middlewareData:{},isPositioned:!1}),[C,S]=n.useState(c);l(C,c)||S(c);let[E,R]=n.useState(null),[T,x]=n.useState(null),M=n.useCallback(t=>{t!==A.current&&(A.current=t,R(t))},[]),k=n.useCallback(t=>{t!==N.current&&(N.current=t,x(t))},[]),O=g||E,I=f||T,A=n.useRef(null),N=n.useRef(null),H=n.useRef(y),P=null!=m,_=u(m),D=u(d),L=u(w),F=n.useCallback(()=>{if(!A.current||!N.current)return;let t={placement:e,strategy:i,middleware:C};D.current&&(t.platform=D.current),(0,r.rD)(A.current,N.current,t).then(t=>{let e={...t,isPositioned:!1!==L.current};V.current&&!l(H.current,e)&&(H.current=e,o.flushSync(()=>{b(e)}))})},[C,e,i,D,L]);s(()=>{!1===w&&H.current.isPositioned&&(H.current.isPositioned=!1,b(t=>({...t,isPositioned:!1})))},[w]);let V=n.useRef(!1);s(()=>(V.current=!0,()=>{V.current=!1}),[]),s(()=>{if(O&&(A.current=O),I&&(N.current=I),O&&I){if(_.current)return _.current(O,I,F);F()}},[O,I,F,_,P]);let W=n.useMemo(()=>({reference:A,floating:N,setReference:M,setFloating:k}),[M,k]),B=n.useMemo(()=>({reference:O,floating:I}),[O,I]),j=n.useMemo(()=>{let t={position:i,left:0,top:0};if(!B.floating)return t;let e=h(B.floating,y.x),r=h(B.floating,y.y);return p?{...t,transform:"translate("+e+"px, "+r+"px)",...a(B.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:e,top:r}},[i,p,B.floating,y.x,y.y]);return n.useMemo(()=>({...y,update:F,refs:W,elements:B,floatingStyles:j}),[y,F,W,B,j])}let d=t=>({name:"arrow",options:t,fn(e){let{element:i,padding:n}="function"==typeof t?t(e):t;return i&&({}).hasOwnProperty.call(i,"current")?null!=i.current?(0,r.UE)({element:i.current,padding:n}).fn(e):{}:i?(0,r.UE)({element:i,padding:n}).fn(e):{}}}),g=(t,e)=>({...(0,r.cY)(t),options:[t,e]}),f=(t,e)=>({...(0,r.UU)(t),options:[t,e]}),p=(t,e)=>({...d(t),options:[t,e]})},85118:(t,e,i)=>{"use strict";i.d(e,{J:()=>n});var r=i(40714);function n(t,e,i){return(0,r.f)(t,7*e,i)}},85318:(t,e,i)=>{"use strict";i.d(e,{n:()=>n});var r=i(61183);function n(t,e,i){let[n,o]=(0,r.x)(null==i?void 0:i.in,t,e);return n.getFullYear()-o.getFullYear()}},85522:(t,e,i)=>{"use strict";i(56397)},85592:(t,e,i)=>{"use strict";var r=i(93840),n=r({}.toString),o=r("".slice);t.exports=function(t){return o(n(t),8,-1)}},85896:(t,e,i)=>{"use strict";var r=i(67297),n=i(95467),o=i(7411),s=i(4083),l=i(6213),a=RegExp.prototype;t.exports=s.correct?function(t){return t.flags}:function(t){return!s.correct&&o(a,t)&&!n(t,"flags")?r(l,t):t.flags}},85917:(t,e,i)=>{"use strict";i.d(e,{P1:()=>s,by:()=>a,qV:()=>h,tR:()=>o}),i(41658);let{register:r,getItem:n,hasItem:o,getNames:s,getValues:l}=(0,i(21413).A)("validators");function a(t){if("function"==typeof t)return t;if(!o(t))throw Error(`No registered validator found under "${t}" name`);return n(t)}function h(t,e){"string"!=typeof t&&(t=(e=t).VALIDATOR_TYPE),r(t,e)}},86166:(t,e,i)=>{"use strict";var r=i(82309),n=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},o=function(t){return{size:t,has:function(){return!0},keys:function(){throw Error("e")}}};t.exports=function(t,e){var i=r("Set");try{new i()[t](n(0));try{return new i()[t](n(-1)),!1}catch(r){if(!e)return!0;try{return new i()[t](o(-1/0)),!1}catch(r){var s=new i;return s.add(1),s.add(2),e(s[t](o(1/0)))}}}catch(t){return!1}}},86301:(t,e,i)=>{"use strict";function r(){return"undefined"!=typeof window}function n(t){return l(t)?(t.nodeName||"").toLowerCase():"#document"}function o(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function s(t){var e;return null==(e=(l(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function l(t){return!!r()&&(t instanceof Node||t instanceof o(t).Node)}function a(t){return!!r()&&(t instanceof Element||t instanceof o(t).Element)}function h(t){return!!r()&&(t instanceof HTMLElement||t instanceof o(t).HTMLElement)}function u(t){return!!r()&&"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof o(t).ShadowRoot)}function c(t){let{overflow:e,overflowX:i,overflowY:r,display:n}=y(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+i)&&!["inline","contents"].includes(n)}function d(t){return["table","td","th"].includes(n(t))}function g(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch(t){return!1}})}function f(t){let e=m(),i=a(t)?y(t):t;return["transform","translate","scale","rotate","perspective"].some(t=>!!i[t]&&"none"!==i[t])||!!i.containerType&&"normal"!==i.containerType||!e&&!!i.backdropFilter&&"none"!==i.backdropFilter||!e&&!!i.filter&&"none"!==i.filter||["transform","translate","scale","rotate","perspective","filter"].some(t=>(i.willChange||"").includes(t))||["paint","layout","strict","content"].some(t=>(i.contain||"").includes(t))}function p(t){let e=C(t);for(;h(e)&&!w(e);){if(f(e))return e;if(g(e))break;e=C(e)}return null}function m(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function w(t){return["html","body","#document"].includes(n(t))}function y(t){return o(t).getComputedStyle(t)}function b(t){return a(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function C(t){if("html"===n(t))return t;let e=t.assignedSlot||t.parentNode||u(t)&&t.host||s(t);return u(e)?e.host:e}function S(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}i.d(e,{$4:()=>C,CP:()=>b,L9:()=>y,Lv:()=>d,Tc:()=>m,Tf:()=>g,ZU:()=>c,_m:()=>S,ep:()=>s,eu:()=>w,gJ:()=>p,mq:()=>n,sQ:()=>f,sb:()=>h,v9:()=>function t(e,i,r){var n;void 0===i&&(i=[]),void 0===r&&(r=!0);let s=function t(e){let i=C(e);return w(i)?e.ownerDocument?e.ownerDocument.body:e.body:h(i)&&c(i)?i:t(i)}(e),l=s===(null==(n=e.ownerDocument)?void 0:n.body),a=o(s);if(l){let e=S(a);return i.concat(a,a.visualViewport||[],c(s)?s:[],e&&r?t(e):[])}return i.concat(s,t(s,[],r))},vq:()=>a,zk:()=>o})},86395:(t,e,i)=>{"use strict";i.d(e,{S:()=>n});var r=i(89447);function n(t){return(0,r.a)(t).getSeconds()}},87426:(t,e,i)=>{"use strict";i(81315)("flat")},87699:(t,e,i)=>{"use strict";var r=i(94767);t.exports=function(t,e){return r[t]||(r[t]=e||{})}},88109:(t,e,i)=>{"use strict";var r=i(54076),n=i(42620),o=i(43987).set,s=i(1730),l=n.setImmediate?s(o,!1):o;r({global:!0,bind:!0,enumerable:!0,forced:n.setImmediate!==l},{setImmediate:l})},88215:(t,e,i)=>{"use strict";i.d(e,{z:()=>a}),i(41658),i(12252),i(85522);var r=i(82505),n=i(59932),o=i(33774),s=i(927),l=i(75708);class a extends r.n{constructor(){super(...arguments),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(t=>this.indexedValues[t])}setValues(t){this.orderOfIndexes=[...Array(t.length).keys()],super.setValues(t)}setValueAtIndex(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.orderOfIndexes.length;return t<this.indexedValues.length&&(this.indexedValues[t]=e,!1===this.orderOfIndexes.includes(t)&&this.orderOfIndexes.splice(i,0,t),this.runLocalHooks("change"),!0)}clearValue(t){this.orderOfIndexes=(0,o.H)(this.orderOfIndexes,[t]),(0,l.isFunction)(this.initValueOrFn)?super.setValueAtIndex(t,this.initValueOrFn(t)):super.setValueAtIndex(t,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(t)}insert(t,e){this.indexedValues=(0,n.N)(this.indexedValues,t,e,this.initValueOrFn),this.orderOfIndexes=(0,s.z)(this.orderOfIndexes,e),super.insert(t,e)}remove(t){this.indexedValues=(0,n.H)(this.indexedValues,t),this.orderOfIndexes=(0,o.H)(this.orderOfIndexes,t),this.orderOfIndexes=(0,s.v)(this.orderOfIndexes,t),super.remove(t)}getEntries(){return this.orderOfIndexes.map(t=>[t,this.getValueAtIndex(t)])}}},88838:(t,e,i)=>{"use strict";var r=i(54076),n=i(41312);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("isSubsetOf",function(t){return t})},{isSubsetOf:n})},89328:(t,e,i)=>{"use strict";i.d(e,{E:()=>l});var r=i(7346),n=i(33787),o=i(91748);function s(t){let e=t.rootDocument.createElement("input");return e.type="text",e.name="__htFocusCatcher",e.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&(0,n.setAttribute)(e,[(0,o.SM)("Focus catcher")]),e}function l(t){var e;let i,n=(e=t,t=>{if(!t)return null;let i=a(e),r=h(e);return t.col<i.col&&(t.col=i.col),t.col>r.col&&(t.col=r.col),t.row<i.row&&(t.row=i.row),t.row>r.row&&(t.row=r.row),t}),{activate:o,deactivate:l}=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=t.rootElement,r=s(t),n=s(t);return r.addEventListener("focus",()=>null==e?void 0:e.onFocusFromTop()),n.addEventListener("focus",()=>null==e?void 0:e.onFocusFromBottom()),i.firstChild.before(r),i.lastChild.after(n),{activate(){t._registerTimeout(()=>{r.tabIndex=0,n.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{r.tabIndex=-1,n.tabIndex=-1},10)}}}(t,{onFocusFromTop(){var e;let r=null!==(e=n(i))&&void 0!==e?e:a(t);r&&(t.runHooks("modifyFocusOnTabNavigation","from_above",r),t.selectCell(r.row,r.col)),t.listen()},onFocusFromBottom(){var e;let r=null!==(e=n(i))&&void 0!==e?e:h(t);r&&(t.runHooks("modifyFocusOnTabNavigation","from_below",r),t.selectCell(r.row,r.col)),t.listen()}}),u={wrapped:!1,flipped:!1},c=!0,d=!1,g=!1;t.addHook("afterListen",()=>l()),t.addHook("afterUnlisten",()=>o()),t.addHook("afterSelection",(e,r,n,o,s)=>{if(d&&(u.wrapped&&u.flipped||g)&&(g=!1,s.value=!0),c){var l;i=null===(l=t.getSelectedRangeLast())||void 0===l?void 0:l.highlight}}),t.addHook("beforeRowWrap",(t,e,i)=>{u.wrapped=!0,u.flipped=i});let f={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:r.B,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...f,callback:()=>{let{tabNavigation:e}=t.getSettings();d=!0,t.getSelectedRangeLast()&&!e&&(c=!1),e||(g=!0)},position:"before"},{...f,callback:e=>{let{tabNavigation:r,autoWrapRow:n}=t.getSettings();if(d=!1,c=!0,!r||!t.selection.isSelected()||n&&u.wrapped&&u.flipped||!n&&u.wrapped)return n&&u.wrapped&&u.flipped&&(i=e.shiftKey?a(t):h(t)),u.wrapped=!1,u.flipped=!1,t.deselectCell(),t.unlisten(),!1;e.preventDefault()},position:"after"}])}function a(t){let{rowIndexMapper:e,columnIndexMapper:i}=t,{navigableHeaders:r}=t.getSettings(),n=r&&t.countColHeaders()>0?-t.countColHeaders():0,o=r&&t.countRowHeaders()>0?-t.countRowHeaders():0;return(0===n&&(n=e.getVisualFromRenderableIndex(n)),0===o&&(o=i.getVisualFromRenderableIndex(o)),null===n||null===o)?null:t._createCellCoords(n,o)}function h(t){var e,i;let{rowIndexMapper:r,columnIndexMapper:n}=t,{navigableHeaders:o}=t.getSettings(),s=r.getRenderableIndexesLength()-1,l=n.getRenderableIndexesLength()-1;if(s<0){if(!o||0===t.countColHeaders())return null;s=-1}if(l<0){if(!o||0===t.countColHeaders())return null;l=-1}return t._createCellCoords(null!==(e=r.getVisualFromRenderableIndex(s))&&void 0!==e?e:s,null!==(i=n.getVisualFromRenderableIndex(l))&&void 0!==i?i:l)}},89364:(t,e,i)=>{"use strict";var r=i(74354),n=i(50320),o=i(98774),s=r(r.bind);t.exports=function(t,e){return n(t),void 0===e?t:o?s(t,e):function(){return t.apply(e,arguments)}}},89447:(t,e,i)=>{"use strict";i.d(e,{a:()=>n});var r=i(7239);function n(t,e){return(0,r.w)(e||t,t)}},89658:(t,e,i)=>{"use strict";i.d(e,{u:()=>o}),i(41658),i(12252),i(21591);var r=i(75708);let n=t=>`The id '${t}' is already declared in a map.`;function o(){let{errorIdExists:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=new Map;function i(){return[...e]}function o(t){return e.has(t)}return t=(0,r.isFunction)(t)?t:n,{addItem:function(i,r){if(o(i))throw Error(t(i));e.set(i,r)},clear:function(){e.clear()},getId:function(t){let[e]=i().find(e=>{let[i,r]=e;return t===r&&i})||[null];return e},getItem:function(t){return e.get(t)},getItems:i,hasItem:o,removeItem:function(t){return e.delete(t)}}}},89741:(t,e,i)=>{"use strict";i.d(e,{z:()=>s});var r=i(33787);function n(t){(0,r.isHTMLElement)(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function o(t){let{selection:e,view:i}=t,r=t.getSelectedRangeLast(),n=e.getSelectionSource(),o=i.getFirstFullyVisibleColumn(),s=i.getLastFullyVisibleColumn(),l=r.getTopStartCorner().col,a=r.getBottomEndCorner().col,h=l<=o,u=a>=s,c=i.getFirstFullyVisibleRow(),d=i.getLastFullyVisibleRow(),g=r.getTopStartCorner().row,f=r.getBottomEndCorner().row,p=g<=c,m=f>=d;return{getComputedColumnTarget:t=>"mouse"===n||"keyboard"===n?t.col:h&&u?r.highlight.col:h?l:u?a:t.col,getComputedRowTarget:t=>"mouse"===n||"keyboard"===n?t.row:p&&m?r.highlight.row:p?g:m?f:t.row}}function s(t){let{selection:e}=t,i=!1,r=!1;return{resume(){r=!1},suspend(){r=!0},skipNextScrollCycle(){i=!0},scrollTo(s){var l;let a;if(i||r){i=!1;return}e.isFocusSelectionChanged()?a=e=>{t.scrollViewportTo(e.toObject(),()=>{let{row:e,col:i}=t.getSelectedRangeLast().highlight;n(t.getCell(e,i,!0))})}:e.isSelectedByCorner()?a=()=>{}:e.isSelectedByRowHeader()?a=e=>{let i=o(t).getComputedRowTarget(e);t.scrollViewportTo({row:i},()=>{let e=!!t.getSettings().rowHeaders;n(t.getCell(i,e?-1:0,!0))})}:e.isSelectedByColumnHeader()?a=e=>{let i=o(t).getComputedColumnTarget(e);t.scrollViewportTo({col:i},()=>{let e=!!t.getSettings().colHeaders;n(t.getCell(e?-1:0,i,!0))})}:1===e.getSelectedRange().size()&&e.isMultiple()?a=e=>{let i=o(t),r={row:i.getComputedRowTarget(e),col:i.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{let{row:e,col:i}=r;n(t.getCell(e,i,!0))})}:1!==e.getSelectedRange().size()||e.isMultiple()?e.getSelectedRange().size()>1&&(a=e=>{let i=o(t),r={row:i.getComputedRowTarget(e),col:i.getComputedColumnTarget(e)};t.scrollViewportTo(r,()=>{let{row:e,col:i}=r;n(t.getCell(e,i,!0))})}):a=e=>{let i=t.selection.getSelectionSource(),{row:r,col:o}=e,s=()=>{n(t.getCell(r,o,!0))};if(r<0&&o>=0)t.scrollViewportTo({col:o},s);else if(o<0&&r>=0)t.scrollViewportTo({row:r},s);else{if("mouse"===i&&(o===t.view.getLastPartiallyVisibleColumn()||r===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:r,col:o},s)}},null===(l=a)||void 0===l||l(s)}}}},89750:(t,e,i)=>{"use strict";var r=i(54076),n=i(82309),o=i(62495),s=i(67297),l=i(93840),a=i(56963),h=i(99365),u=i(241),c=i(13928),d=i(83279),g=i(11609),f=String,p=n("JSON","stringify"),m=l(/./.exec),w=l("".charAt),y=l("".charCodeAt),b=l("".replace),C=l(1.1.toString),S=/[\uD800-\uDFFF]/g,E=/^[\uD800-\uDBFF]$/,R=/^[\uDC00-\uDFFF]$/,T=!g||a(function(){var t=n("Symbol")("stringify detection");return"[null]"!==p([t])||"{}"!==p({a:t})||"{}"!==p(Object(t))}),x=a(function(){return'"\udf06\ud834"'!==p("\uDF06\uD834")||'"\udead"'!==p("\uDEAD")}),M=function(t,e){var i=c(arguments),r=d(e);if(!(!h(r)&&(void 0===t||u(t))))return i[1]=function(t,e){if(h(r)&&(e=s(r,this,f(t),e)),!u(e))return e},o(p,null,i)},k=function(t,e,i){var r=w(i,e-1),n=w(i,e+1);return m(E,t)&&!m(R,n)||m(R,t)&&!m(E,r)?"\\u"+C(y(t,0),16):t};p&&r({target:"JSON",stat:!0,arity:3,forced:T||x},{stringify:function(t,e,i){var r=c(arguments),n=o(T?M:p,null,r);return x&&"string"==typeof n?b(n,S,k):n}})},90290:(t,e,i)=>{"use strict";i.d(e,{I$:()=>f,Im:()=>C,RV:()=>O,Ub:()=>p,eT:()=>u,ic:()=>l,pC:()=>d,st:()=>R,wh:()=>E,y_:()=>S});var r,n=i(808),o=i(10156),s=i(52571);let l=(t,e)=>!t.selection.empty&&(e&&e(t.tr.deleteSelection().scrollIntoView()),!0);function a(t,e,i=!1){for(let r=t;r;r="start"==e?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(i&&1!=r.childCount)break}return!1}function h(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){if(t.index(e)>0)return t.doc.resolve(t.before(e+1));if(t.node(e).type.spec.isolating)break}return null}let u=(t,e,i)=>{let r=function(t,e){let{$cursor:i}=t.selection;return i&&(e?e.endOfTextblock("forward",t):!(i.parentOffset<i.parent.content.size))?i:null}(t,i);if(!r)return!1;let l=c(r);if(!l)return!1;let h=l.nodeAfter;if(m(t,l,e,1))return!0;if(0==r.parent.content.size&&(a(h,"start")||s.nh.isSelectable(h))){let i=(0,n.$L)(t.doc,r.before(),r.after(),o.Ji.empty);if(i&&i.slice.size<i.to-i.from){if(e){let r=t.tr.step(i);r.setSelection(a(h,"start")?s.LN.findFrom(r.doc.resolve(r.mapping.map(l.pos)),1):s.nh.create(r.doc,r.mapping.map(l.pos))),e(r.scrollIntoView())}return!0}}return!!h.isAtom&&l.depth==r.depth-1&&(e&&e(t.tr.delete(l.pos,l.pos+h.nodeSize).scrollIntoView()),!0)};function c(t){if(!t.parent.type.spec.isolating)for(let e=t.depth-1;e>=0;e--){let i=t.node(e);if(t.index(e)+1<i.childCount)return t.doc.resolve(t.after(e+1));if(i.type.spec.isolating)break}return null}let d=(t,e)=>{let{$head:i,$anchor:r}=t.selection;return!!(i.parent.type.spec.code&&i.sameParent(r))&&(e&&e(t.tr.insertText("\n").scrollIntoView()),!0)};function g(t){for(let e=0;e<t.edgeCount;e++){let{type:i}=t.edge(e);if(i.isTextblock&&!i.hasRequiredAttrs())return i}return null}let f=(t,e)=>{let{$head:i,$anchor:r}=t.selection;if(!i.parent.type.spec.code||!i.sameParent(r))return!1;let n=i.node(-1),o=i.indexAfter(-1),l=g(n.contentMatchAt(o));if(!l||!n.canReplaceWith(o,o,l))return!1;if(e){let r=i.after(),n=t.tr.replaceWith(r,r,l.createAndFill());n.setSelection(s.LN.near(n.doc.resolve(r),1)),e(n.scrollIntoView())}return!0},p=(t,e)=>(e&&e(t.tr.setSelection(new s.i5(t.doc))),!0);function m(t,e,i,r){let l,h,u,c=e.nodeBefore,d=e.nodeAfter,g,f,p=c.type.spec.isolating||d.type.spec.isolating;if(!p&&(l=e.nodeBefore,h=e.nodeAfter,u=e.index(),l&&h&&l.type.compatibleContent(h.type)&&(!l.content.size&&e.parent.canReplace(u-1,u)?(i&&i(t.tr.delete(e.pos-l.nodeSize,e.pos).scrollIntoView()),!0):!!(e.parent.canReplace(u,u+1)&&(h.isTextblock||(0,n.n9)(t.doc,e.pos)))&&(i&&i(t.tr.join(e.pos).scrollIntoView()),!0))))return!0;let m=!p&&e.parent.canReplace(e.index(),e.index()+1);if(m&&(g=(f=c.contentMatchAt(c.childCount)).findWrapping(d.type))&&f.matchType(g[0]||d.type).validEnd){if(i){let r=e.pos+d.nodeSize,s=o.FK.empty;for(let t=g.length-1;t>=0;t--)s=o.FK.from(g[t].create(null,s));s=o.FK.from(c.copy(s));let l=t.tr.step(new n.Wg(e.pos-1,r,e.pos,r,new o.Ji(s,1,0),g.length,!0)),a=l.doc.resolve(r+2*g.length);a.nodeAfter&&a.nodeAfter.type==c.type&&(0,n.n9)(l.doc,a.pos)&&l.join(a.pos),i(l.scrollIntoView())}return!0}let w=d.type.spec.isolating||r>0&&p?null:s.LN.findFrom(e,1),y=w&&w.$from.blockRange(w.$to),b=y&&(0,n.jP)(y);if(null!=b&&b>=e.depth)return i&&i(t.tr.lift(y,b).scrollIntoView()),!0;if(m&&a(d,"start",!0)&&a(c,"end")){let r=c,s=[];for(;s.push(r),!r.isTextblock;)r=r.lastChild;let l=d,a=1;for(;!l.isTextblock;l=l.firstChild)a++;if(r.canReplace(r.childCount,r.childCount,l.content)){if(i){let r=o.FK.empty;for(let t=s.length-1;t>=0;t--)r=o.FK.from(s[t].copy(r));i(t.tr.step(new n.Wg(e.pos-s.length,e.pos+d.nodeSize,e.pos+a,e.pos+d.nodeSize-a,new o.Ji(r,s.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function w(t){return function(e,i){let r=e.selection,n=t<0?r.$from:r.$to,o=n.depth;for(;n.node(o).isInline;){if(!o)return!1;o--}return!!n.node(o).isTextblock&&(i&&i(e.tr.setSelection(s.U3.create(e.doc,t<0?n.start(o):n.end(o)))),!0)}}let y=w(-1),b=w(1);function C(t,e=null){return function(i,r){let{$from:o,$to:s}=i.selection,l=o.blockRange(s),a=l&&(0,n.oM)(l,t,e);return!!a&&(r&&r(i.tr.wrap(l,a).scrollIntoView()),!0)}}function S(t,e=null){return function(i,r){let n=!1;for(let r=0;r<i.selection.ranges.length&&!n;r++){let{$from:{pos:o},$to:{pos:s}}=i.selection.ranges[r];i.doc.nodesBetween(o,s,(r,o)=>{if(n)return!1;if(!(!r.isTextblock||r.hasMarkup(t,e)))if(r.type==t)n=!0;else{let e=i.doc.resolve(o),r=e.index();n=e.parent.canReplaceWith(r,r+1,t)}})}if(!n)return!1;if(r){let n=i.tr;for(let r=0;r<i.selection.ranges.length;r++){let{$from:{pos:o},$to:{pos:s}}=i.selection.ranges[r];n.setBlockType(o,s,t,e)}r(n.scrollIntoView())}return!0}}function E(t,e=null,i){let r=!1!==(i&&i.removeWhenPresent),n=!1!==(i&&i.enterInlineAtoms),o=!(i&&i.includeWhitespace);return function(i,l){let{empty:a,$cursor:h,ranges:u}=i.selection;if(a&&!h||!function(t,e,i,r){for(let n=0;n<e.length;n++){let{$from:o,$to:s}=e[n],l=0==o.depth&&t.inlineContent&&t.type.allowsMarkType(i);if(t.nodesBetween(o.pos,s.pos,(t,e)=>{if(l||!r&&t.isAtom&&t.isInline&&e>=o.pos&&e+t.nodeSize<=s.pos)return!1;l=t.inlineContent&&t.type.allowsMarkType(i)}),l)return!0}return!1}(i.doc,u,t,n))return!1;if(l)if(h)l(t.isInSet(i.storedMarks||h.marks())?i.tr.removeStoredMark(t):i.tr.addStoredMark(t.create(e)));else{let a,h=i.tr;n||(u=function(t){let e=[];for(let i=0;i<t.length;i++){let{$from:r,$to:n}=t[i];r.doc.nodesBetween(r.pos,n.pos,(t,i)=>{if(t.isAtom&&t.content.size&&t.isInline&&i>=r.pos&&i+t.nodeSize<=n.pos)return i+1>r.pos&&e.push(new s.yn(r,r.doc.resolve(i+1))),r=r.doc.resolve(i+1+t.content.size),!1}),r.pos<n.pos&&e.push(new s.yn(r,n))}return e}(u)),a=r?!u.some(e=>i.doc.rangeHasMark(e.$from.pos,e.$to.pos,t)):!u.every(e=>{let i=!1;return h.doc.nodesBetween(e.$from.pos,e.$to.pos,(r,n,o)=>{if(i)return!1;i=!t.isInSet(r.marks)&&!!o&&o.type.allowsMarkType(t)&&!(r.isText&&/^\s*$/.test(r.textBetween(Math.max(0,e.$from.pos-n),Math.min(r.nodeSize,e.$to.pos-n))))}),!i});for(let i=0;i<u.length;i++){let{$from:r,$to:n}=u[i];if(a){let i=r.pos,s=n.pos,l=r.nodeAfter,a=n.nodeBefore,u=o&&l&&l.isText?/^\s*/.exec(l.text)[0].length:0,c=o&&a&&a.isText?/\s*$/.exec(a.text)[0].length:0;i+u<s&&(i+=u,s-=c),h.addMark(i,s,t.create(e))}else h.removeMark(r.pos,n.pos,t)}l(h.scrollIntoView())}return!0}}function R(...t){return function(e,i,r){for(let n=0;n<t.length;n++)if(t[n](e,i,r))return!0;return!1}}let T=R(l,(t,e,i)=>{let r=function(t,e){let{$cursor:i}=t.selection;return i&&(e?e.endOfTextblock("backward",t):!(i.parentOffset>0))?i:null}(t,i);if(!r)return!1;let l=h(r);if(!l){let i=r.blockRange(),o=i&&(0,n.jP)(i);return null!=o&&(e&&e(t.tr.lift(i,o).scrollIntoView()),!0)}let u=l.nodeBefore;if(m(t,l,e,-1))return!0;if(0==r.parent.content.size&&(a(u,"end")||s.nh.isSelectable(u)))for(let i=r.depth;;i--){let h=(0,n.$L)(t.doc,r.before(i),r.after(i),o.Ji.empty);if(h&&h.slice.size<h.to-h.from){if(e){let i=t.tr.step(h);i.setSelection(a(u,"end")?s.LN.findFrom(i.doc.resolve(i.mapping.map(l.pos,-1)),-1):s.nh.create(i.doc,l.pos-u.nodeSize)),e(i.scrollIntoView())}return!0}if(1==i||r.node(i-1).childCount>1)break}return!!u.isAtom&&l.depth==r.depth-1&&(e&&e(t.tr.delete(l.pos-u.nodeSize,l.pos).scrollIntoView()),!0)},(t,e,i)=>{let{$head:r,empty:n}=t.selection,o=r;if(!n)return!1;if(r.parent.isTextblock){if(i?!i.endOfTextblock("backward",t):r.parentOffset>0)return!1;o=h(r)}let l=o&&o.nodeBefore;return!!(l&&s.nh.isSelectable(l))&&(e&&e(t.tr.setSelection(s.nh.create(t.doc,o.pos-l.nodeSize)).scrollIntoView()),!0)}),x=R(l,u,(t,e,i)=>{let{$head:r,empty:n}=t.selection,o=r;if(!n)return!1;if(r.parent.isTextblock){if(i?!i.endOfTextblock("forward",t):r.parentOffset<r.parent.content.size)return!1;o=c(r)}let l=o&&o.nodeAfter;return!!(l&&s.nh.isSelectable(l))&&(e&&e(t.tr.setSelection(s.nh.create(t.doc,o.pos)).scrollIntoView()),!0)}),M={Enter:R(d,(t,e)=>{let i=t.selection,{$from:r,$to:n}=i;if(i instanceof s.i5||r.parent.inlineContent||n.parent.inlineContent)return!1;let o=g(n.parent.contentMatchAt(n.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let i=(!r.parentOffset&&n.index()<n.parent.childCount?r:n).pos,l=t.tr.insert(i,o.createAndFill());l.setSelection(s.U3.create(l.doc,i+1)),e(l.scrollIntoView())}return!0},(t,e)=>{let{$cursor:i}=t.selection;if(!i||i.parent.content.size)return!1;if(i.depth>1&&i.after()!=i.end(-1)){let r=i.before();if((0,n.zy)(t.doc,r))return e&&e(t.tr.split(r).scrollIntoView()),!0}let r=i.blockRange(),o=r&&(0,n.jP)(r);return null!=o&&(e&&e(t.tr.lift(r,o).scrollIntoView()),!0)},(t,e)=>{let{$from:i,$to:r}=t.selection;if(t.selection instanceof s.nh&&t.selection.node.isBlock)return!!(i.parentOffset&&(0,n.zy)(t.doc,i.pos))&&(e&&e(t.tr.split(i.pos).scrollIntoView()),!0);if(!i.depth)return!1;let o=[],l,a,h=!1,u=!1;for(let t=i.depth;;t--){if(i.node(t).isBlock){let e;h=i.end(t)==i.pos+(i.depth-t),u=i.start(t)==i.pos-(i.depth-t),a=g(i.node(t-1).contentMatchAt(i.indexAfter(t-1)));o.unshift(e||(h&&a?{type:a}:null)),l=t;break}if(1==t)return!1;o.unshift(null)}let c=t.tr;(t.selection instanceof s.U3||t.selection instanceof s.i5)&&c.deleteSelection();let d=c.mapping.map(i.pos),f=(0,n.zy)(c.doc,d,o.length,o);if(f||(o[0]=a?{type:a}:null,f=(0,n.zy)(c.doc,d,o.length,o)),!f)return!1;if(c.split(d,o.length,o),!h&&u&&i.node(l).type!=a){let t=c.mapping.map(i.before(l)),e=c.doc.resolve(t);a&&i.node(l-1).canReplaceWith(e.index(),e.index()+1,a)&&c.setNodeMarkup(c.mapping.map(i.before(l)),a)}return e&&e(c.scrollIntoView()),!0}),"Mod-Enter":f,Backspace:T,"Mod-Backspace":T,"Shift-Backspace":T,Delete:x,"Mod-Delete":x,"Mod-a":p},k={"Ctrl-h":M.Backspace,"Alt-Backspace":M["Mod-Backspace"],"Ctrl-d":M.Delete,"Ctrl-Alt-Backspace":M["Mod-Delete"],"Alt-Delete":M["Mod-Delete"],"Alt-d":M["Mod-Delete"],"Ctrl-a":y,"Ctrl-e":b};for(let t in M)k[t]=M[t];let O=("undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&!!os.platform&&"darwin"==os.platform())?k:M},91121:(t,e,i)=>{"use strict";i.d(e,{s:()=>n});var r=i(61183);function n(t,e,i){let[n,o]=(0,r.x)(null==i?void 0:i.in,t,e);return n.getFullYear()===o.getFullYear()}},91215:(t,e,i)=>{"use strict";var r=i(54076),n=i(57272),o=i(53480);r({target:"Object",stat:!0},{fromEntries:function(t){var e={};return n(t,function(t,i){o(e,t,i)},{AS_ENTRIES:!0}),e}})},91337:t=>{"use strict";t.exports=function(t,e){return{value:t,done:e}}},91588:(t,e,i)=>{"use strict";i.d(e,{t:()=>n});var r=i(89447);function n(t,e){return(0,r.a)(t,null==e?void 0:e.in).getMonth()}},91615:(t,e,i)=>{"use strict";var r=i(24201),n=i(40949),o=i(34175),s=Error.captureStackTrace;t.exports=function(t,e,i,l){o&&(s?s(t,e):r(t,"stack",n(i,l)))}},91748:(t,e,i)=>{"use strict";i.d(e,{$o:()=>p,B6:()=>f,D9:()=>b,DY:()=>j,DZ:()=>M,H0:()=>D,Jg:()=>h,Ku:()=>F,L2:()=>y,L4:()=>T,MG:()=>E,Nb:()=>k,Nf:()=>l,PF:()=>P,Pk:()=>w,Qg:()=>O,S2:()=>W,SM:()=>S,Sb:()=>u,VN:()=>V,Vy:()=>z,Xq:()=>_,ZA:()=>d,ZW:()=>C,_R:()=>R,_h:()=>N,ax:()=>n,dV:()=>A,g:()=>s,gg:()=>o,gq:()=>L,n:()=>m,nF:()=>c,pt:()=>g,rE:()=>B,t0:()=>a,u8:()=>H,vC:()=>r,wD:()=>I,wP:()=>x});let r=t=>["tabindex",t],n=()=>["role","treegrid"],o=()=>["role","presentation"],s=()=>["role","gridcell"],l=()=>["role","rowheader"],a=()=>["role","rowgroup"],h=()=>["role","columnheader"],u=()=>["role","row"],c=()=>["role","menu"],d=()=>["role","menuitem"],g=()=>["role","menuitemcheckbox"],f=()=>["role","combobox"],p=()=>["role","listbox"],m=()=>["role","option"],w=()=>["role","checkbox"],y=()=>["scope","col"],b=()=>["scope","row"],C=()=>["type","text"],S=t=>["aria-label",t],E=()=>["aria-hidden","true"],R=()=>["aria-disabled","true"],T=()=>["aria-multiselectable","true"],x=t=>["aria-haspopup",t],M=t=>["aria-rowcount",t],k=t=>["aria-colcount",t],O=t=>["aria-rowindex",t],I=t=>["aria-colindex",t],A=t=>["aria-expanded",t],N=t=>["aria-sort",t],H=()=>["aria-readonly","true"],P=()=>["aria-invalid","true"],_=t=>["aria-checked",t],D=()=>["aria-selected","true"],L=()=>["aria-autocomplete","list"],F=t=>["aria-controls",t],V=t=>["aria-activedescendant",t],W=t=>["aria-live",t],B=t=>["aria-relevant",t],j=t=>["aria-setsize",t],z=t=>["aria-posinset",t]},91826:(t,e,i)=>{"use strict";i.d(e,{E6:()=>r,Hb:()=>l,LX:()=>o,OS:()=>u,PP:()=>n,QP:()=>h,Yt:()=>s,_8:()=>a});let r="active-header",n="header",o="area",s="focus",l="fill",a="row",h="column",u="custom-selection"},92743:t=>{"use strict";var e=String;t.exports=function(t){try{return e(t)}catch(t){return"Object"}}},93277:(t,e,i)=>{"use strict";var r=i(54076),n=i(67297),o=i(50320),s=i(8883),l=i(7475),a=i(38516),h=i(31338),u=i(76093),c=i(72255),d=i(99842),g=i(56395),f=!c&&!d("flatMap",function(){}),p=!c&&!f&&g("flatMap",TypeError),m=c||f||p,w=h(function(){for(var t,e,i=this.iterator,r=this.mapper;;){if(e=this.inner)try{if(!(t=s(n(e.next,e.iterator))).done)return t.value;this.inner=null}catch(t){u(i,"throw",t)}if(t=s(n(this.next,i)),this.done=!!t.done)return;try{this.inner=a(r(t.value,this.counter++),!1)}catch(t){u(i,"throw",t)}}});r({target:"Iterator",proto:!0,real:!0,forced:m},{flatMap:function(t){s(this);try{o(t)}catch(t){u(this,"throw",t)}return p?n(p,this,t):new w(l(this),{mapper:t,inner:null})}})},93484:(t,e,i)=>{"use strict";var r=i(94272),n=i(16954).add,o=i(71310),s=i(15743),l=i(6497);t.exports=function(t){var e=r(this),i=s(t).getIterator(),a=o(e);return l(i,function(t){n(a,t)}),a}},93840:(t,e,i)=>{"use strict";var r=i(98774),n=Function.prototype,o=n.call,s=r&&n.bind.bind(o,o);t.exports=r?s:function(t){return function(){return o.apply(t,arguments)}}},93924:(t,e,i)=>{"use strict";i.r(e),i.d(e,{equalsIgnoreCase:()=>ts,isPercentValue:()=>ta,randomString:()=>tl,sanitize:()=>tc,stripTags:()=>tu,substitute:()=>th,toUpperCaseFirst:()=>to}),i(19398);let{entries:r,setPrototypeOf:n,isFrozen:o,getPrototypeOf:s,getOwnPropertyDescriptor:l}=Object,{freeze:a,seal:h,create:u}=Object,{apply:c,construct:d}="undefined"!=typeof Reflect&&Reflect;a||(a=function(t){return t}),h||(h=function(t){return t}),c||(c=function(t,e,i){return t.apply(e,i)}),d||(d=function(t,e){return new t(...e)});let g=k(Array.prototype.forEach),f=k(Array.prototype.lastIndexOf),p=k(Array.prototype.pop),m=k(Array.prototype.push),w=k(Array.prototype.splice),y=k(String.prototype.toLowerCase),b=k(String.prototype.toString),C=k(String.prototype.match),S=k(String.prototype.replace),E=k(String.prototype.indexOf),R=k(String.prototype.trim),T=k(Object.prototype.hasOwnProperty),x=k(RegExp.prototype.test),M=(Q=TypeError,function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return d(Q,e)});function k(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return c(t,e,r)}}function O(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;n&&n(t,null);let r=e.length;for(;r--;){let n=e[r];if("string"==typeof n){let t=i(n);t!==n&&(o(e)||(e[r]=t),n=t)}t[n]=!0}return t}function I(t){let e=u(null);for(let[i,n]of r(t))T(t,i)&&(Array.isArray(n)?e[i]=function(t){for(let e=0;e<t.length;e++)T(t,e)||(t[e]=null);return t}(n):n&&"object"==typeof n&&n.constructor===Object?e[i]=I(n):e[i]=n);return e}function A(t,e){for(;null!==t;){let i=l(t,e);if(i){if(i.get)return k(i.get);if("function"==typeof i.value)return k(i.value)}t=s(t)}return function(){return null}}let N=a(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),H=a(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),P=a(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),_=a(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),D=a(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),L=a(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),F=a(["#text"]),V=a(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),W=a(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),B=a(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),j=a(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),z=h(/\{\{[\w\W]*|[\w\W]*\}\}/gm),U=h(/<%[\w\W]*|[\w\W]*%>/gm),$=h(/\$\{[\w\W]*/gm),Y=h(/^data-[\-\w.\u00B7-\uFFFF]+$/),G=h(/^aria-[\-\w]+$/),q=h(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),X=h(/^(?:\w+script|data):/i),K=h(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),J=h(/^html$/i);var Q,Z=Object.freeze({__proto__:null,ARIA_ATTR:G,ATTR_WHITESPACE:K,CUSTOM_ELEMENT:h(/^[a-z][.\w]*(-[.\w]+)+$/i),DATA_ATTR:Y,DOCTYPE_NAME:J,ERB_EXPR:U,IS_ALLOWED_URI:q,IS_SCRIPT_OR_DATA:X,MUSTACHE_EXPR:z,TMPLIT_EXPR:$});let tt={element:1,text:3,progressingInstruction:7,comment:8,document:9},te=function(t,e){if("object"!=typeof t||"function"!=typeof t.createPolicy)return null;let i=null,r="data-tt-policy-suffix";e&&e.hasAttribute(r)&&(i=e.getAttribute(r));let n="dompurify"+(i?"#"+i:"");try{return t.createPolicy(n,{createHTML:t=>t,createScriptURL:t=>t})}catch(t){return console.warn("TrustedTypes policy "+n+" could not be created."),null}},ti=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};var tr=function t(){let e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"undefined"==typeof window?null:window,n=e=>t(e);if(n.version="3.2.6",n.removed=[],!i||!i.document||i.document.nodeType!==tt.document||!i.Element)return n.isSupported=!1,n;let{document:o}=i,s=o,l=s.currentScript,{DocumentFragment:h,HTMLTemplateElement:c,Node:d,Element:k,NodeFilter:z,NamedNodeMap:U=i.NamedNodeMap||i.MozNamedAttrMap,HTMLFormElement:$,DOMParser:Y,trustedTypes:G}=i,X=k.prototype,K=A(X,"cloneNode"),Q=A(X,"remove"),tr=A(X,"nextSibling"),tn=A(X,"childNodes"),to=A(X,"parentNode");if("function"==typeof c){let t=o.createElement("template");t.content&&t.content.ownerDocument&&(o=t.content.ownerDocument)}let ts="",{implementation:tl,createNodeIterator:ta,createDocumentFragment:th,getElementsByTagName:tu}=o,{importNode:tc}=s,td=ti();n.isSupported="function"==typeof r&&"function"==typeof to&&tl&&void 0!==tl.createHTMLDocument;let{MUSTACHE_EXPR:tg,ERB_EXPR:tf,TMPLIT_EXPR:tp,DATA_ATTR:tm,ARIA_ATTR:tw,IS_SCRIPT_OR_DATA:tv,ATTR_WHITESPACE:ty,CUSTOM_ELEMENT:tb}=Z,{IS_ALLOWED_URI:tC}=Z,tS=null,tE=O({},[...N,...H,...P,...D,...F]),tR=null,tT=O({},[...V,...W,...B,...j]),tx=Object.seal(u(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),tM=null,tk=null,tO=!0,tI=!0,tA=!1,tN=!0,tH=!1,tP=!0,t_=!1,tD=!1,tL=!1,tF=!1,tV=!1,tW=!1,tB=!0,tj=!1,tz=!0,tU=!1,t$={},tY=null,tG=O({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),tq=null,tX=O({},["audio","video","img","source","image","track"]),tK=null,tJ=O({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),tQ="http://www.w3.org/1998/Math/MathML",tZ="http://www.w3.org/2000/svg",t0="http://www.w3.org/1999/xhtml",t1=t0,t2=!1,t3=null,t9=O({},[tQ,tZ,t0],b),t4=O({},["mi","mo","mn","ms","mtext"]),t5=O({},["annotation-xml"]),t8=O({},["title","style","font","a","script"]),t7=null,t6=["application/xhtml+xml","text/html"],et=null,ee=null,ei=o.createElement("form"),er=function(t){return t instanceof RegExp||t instanceof Function},en=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!ee||ee!==t){if(t&&"object"==typeof t||(t={}),t=I(t),et="application/xhtml+xml"===(t7=-1===t6.indexOf(t.PARSER_MEDIA_TYPE)?"text/html":t.PARSER_MEDIA_TYPE)?b:y,tS=T(t,"ALLOWED_TAGS")?O({},t.ALLOWED_TAGS,et):tE,tR=T(t,"ALLOWED_ATTR")?O({},t.ALLOWED_ATTR,et):tT,t3=T(t,"ALLOWED_NAMESPACES")?O({},t.ALLOWED_NAMESPACES,b):t9,tK=T(t,"ADD_URI_SAFE_ATTR")?O(I(tJ),t.ADD_URI_SAFE_ATTR,et):tJ,tq=T(t,"ADD_DATA_URI_TAGS")?O(I(tX),t.ADD_DATA_URI_TAGS,et):tX,tY=T(t,"FORBID_CONTENTS")?O({},t.FORBID_CONTENTS,et):tG,tM=T(t,"FORBID_TAGS")?O({},t.FORBID_TAGS,et):I({}),tk=T(t,"FORBID_ATTR")?O({},t.FORBID_ATTR,et):I({}),t$=!!T(t,"USE_PROFILES")&&t.USE_PROFILES,tO=!1!==t.ALLOW_ARIA_ATTR,tI=!1!==t.ALLOW_DATA_ATTR,tA=t.ALLOW_UNKNOWN_PROTOCOLS||!1,tN=!1!==t.ALLOW_SELF_CLOSE_IN_ATTR,tH=t.SAFE_FOR_TEMPLATES||!1,tP=!1!==t.SAFE_FOR_XML,t_=t.WHOLE_DOCUMENT||!1,tF=t.RETURN_DOM||!1,tV=t.RETURN_DOM_FRAGMENT||!1,tW=t.RETURN_TRUSTED_TYPE||!1,tL=t.FORCE_BODY||!1,tB=!1!==t.SANITIZE_DOM,tj=t.SANITIZE_NAMED_PROPS||!1,tz=!1!==t.KEEP_CONTENT,tU=t.IN_PLACE||!1,tC=t.ALLOWED_URI_REGEXP||q,t1=t.NAMESPACE||t0,t4=t.MATHML_TEXT_INTEGRATION_POINTS||t4,t5=t.HTML_INTEGRATION_POINTS||t5,tx=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&er(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(tx.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&er(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(tx.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(tx.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),tH&&(tI=!1),tV&&(tF=!0),t$&&(tS=O({},F),tR=[],!0===t$.html&&(O(tS,N),O(tR,V)),!0===t$.svg&&(O(tS,H),O(tR,W),O(tR,j)),!0===t$.svgFilters&&(O(tS,P),O(tR,W),O(tR,j)),!0===t$.mathMl&&(O(tS,D),O(tR,B),O(tR,j))),t.ADD_TAGS&&(tS===tE&&(tS=I(tS)),O(tS,t.ADD_TAGS,et)),t.ADD_ATTR&&(tR===tT&&(tR=I(tR)),O(tR,t.ADD_ATTR,et)),t.ADD_URI_SAFE_ATTR&&O(tK,t.ADD_URI_SAFE_ATTR,et),t.FORBID_CONTENTS&&(tY===tG&&(tY=I(tY)),O(tY,t.FORBID_CONTENTS,et)),tz&&(tS["#text"]=!0),t_&&O(tS,["html","head","body"]),tS.table&&(O(tS,["tbody"]),delete tM.tbody),t.TRUSTED_TYPES_POLICY){if("function"!=typeof t.TRUSTED_TYPES_POLICY.createHTML)throw M('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if("function"!=typeof t.TRUSTED_TYPES_POLICY.createScriptURL)throw M('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');ts=(e=t.TRUSTED_TYPES_POLICY).createHTML("")}else void 0===e&&(e=te(G,l)),null!==e&&"string"==typeof ts&&(ts=e.createHTML(""));a&&a(t),ee=t}},eo=O({},[...H,...P,..._]),es=O({},[...D,...L]),el=function(t){let e=to(t);e&&e.tagName||(e={namespaceURI:t1,tagName:"template"});let i=y(t.tagName),r=y(e.tagName);return!!t3[t.namespaceURI]&&(t.namespaceURI===tZ?e.namespaceURI===t0?"svg"===i:e.namespaceURI===tQ?"svg"===i&&("annotation-xml"===r||t4[r]):!!eo[i]:t.namespaceURI===tQ?e.namespaceURI===t0?"math"===i:e.namespaceURI===tZ?"math"===i&&t5[r]:!!es[i]:t.namespaceURI===t0?(e.namespaceURI!==tZ||!!t5[r])&&(e.namespaceURI!==tQ||!!t4[r])&&!es[i]&&(t8[i]||!eo[i]):"application/xhtml+xml"===t7&&!!t3[t.namespaceURI])},ea=function(t){m(n.removed,{element:t});try{to(t).removeChild(t)}catch(e){Q(t)}},eh=function(t,e){try{m(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){m(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t)if(tF||tV)try{ea(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},eu=function(t){let i=null,r=null;if(tL)t="<remove></remove>"+t;else{let e=C(t,/^[\r\n\t ]+/);r=e&&e[0]}"application/xhtml+xml"===t7&&t1===t0&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");let n=e?e.createHTML(t):t;if(t1===t0)try{i=new Y().parseFromString(n,t7)}catch(t){}if(!i||!i.documentElement){i=tl.createDocument(t1,"template",null);try{i.documentElement.innerHTML=t2?ts:n}catch(t){}}let s=i.body||i.documentElement;return(t&&r&&s.insertBefore(o.createTextNode(r),s.childNodes[0]||null),t1===t0)?tu.call(i,t_?"html":"body")[0]:t_?i.documentElement:s},ec=function(t){return ta.call(t.ownerDocument||t,t,z.SHOW_ELEMENT|z.SHOW_COMMENT|z.SHOW_TEXT|z.SHOW_PROCESSING_INSTRUCTION|z.SHOW_CDATA_SECTION,null)},ed=function(t){return t instanceof $&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof U)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore||"function"!=typeof t.hasChildNodes)},eg=function(t){return"function"==typeof d&&t instanceof d};function ef(t,e,i){g(t,t=>{t.call(n,e,i,ee)})}let ep=function(t){let e=null;if(ef(td.beforeSanitizeElements,t,null),ed(t))return ea(t),!0;let i=et(t.nodeName);if(ef(td.uponSanitizeElement,t,{tagName:i,allowedTags:tS}),tP&&t.hasChildNodes()&&!eg(t.firstElementChild)&&x(/<[/\w!]/g,t.innerHTML)&&x(/<[/\w!]/g,t.textContent)||t.nodeType===tt.progressingInstruction||tP&&t.nodeType===tt.comment&&x(/<[/\w]/g,t.data))return ea(t),!0;if(!tS[i]||tM[i]){if(!tM[i]&&ew(i)&&(tx.tagNameCheck instanceof RegExp&&x(tx.tagNameCheck,i)||tx.tagNameCheck instanceof Function&&tx.tagNameCheck(i)))return!1;if(tz&&!tY[i]){let e=to(t)||t.parentNode,i=tn(t)||t.childNodes;if(i&&e){let r=i.length;for(let n=r-1;n>=0;--n){let r=K(i[n],!0);r.__removalCount=(t.__removalCount||0)+1,e.insertBefore(r,tr(t))}}}return ea(t),!0}return t instanceof k&&!el(t)||("noscript"===i||"noembed"===i||"noframes"===i)&&x(/<\/no(script|embed|frames)/i,t.innerHTML)?(ea(t),!0):(tH&&t.nodeType===tt.text&&(e=t.textContent,g([tg,tf,tp],t=>{e=S(e,t," ")}),t.textContent!==e&&(m(n.removed,{element:t.cloneNode()}),t.textContent=e)),ef(td.afterSanitizeElements,t,null),!1)},em=function(t,e,i){if(tB&&("id"===e||"name"===e)&&(i in o||i in ei))return!1;if(tI&&!tk[e]&&x(tm,e));else if(tO&&x(tw,e));else if(!tR[e]||tk[e]){if(!(ew(t)&&(tx.tagNameCheck instanceof RegExp&&x(tx.tagNameCheck,t)||tx.tagNameCheck instanceof Function&&tx.tagNameCheck(t))&&(tx.attributeNameCheck instanceof RegExp&&x(tx.attributeNameCheck,e)||tx.attributeNameCheck instanceof Function&&tx.attributeNameCheck(e))||"is"===e&&tx.allowCustomizedBuiltInElements&&(tx.tagNameCheck instanceof RegExp&&x(tx.tagNameCheck,i)||tx.tagNameCheck instanceof Function&&tx.tagNameCheck(i))))return!1}else if(tK[e]);else if(x(tC,S(i,ty,"")));else if(("src"===e||"xlink:href"===e||"href"===e)&&"script"!==t&&0===E(i,"data:")&&tq[t]);else if(tA&&!x(tv,S(i,ty,"")));else if(i)return!1;return!0},ew=function(t){return"annotation-xml"!==t&&C(t,tb)},ev=function(t){ef(td.beforeSanitizeAttributes,t,null);let{attributes:i}=t;if(!i||ed(t))return;let r={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:tR,forceKeepAttr:void 0},o=i.length;for(;o--;){let{name:s,namespaceURI:l,value:a}=i[o],h=et(s),u="value"===s?a:R(a);if(r.attrName=h,r.attrValue=u,r.keepAttr=!0,r.forceKeepAttr=void 0,ef(td.uponSanitizeAttribute,t,r),u=r.attrValue,tj&&("id"===h||"name"===h)&&(eh(s,t),u="user-content-"+u),tP&&x(/((--!?|])>)|<\/(style|title)/i,u)){eh(s,t);continue}if(r.forceKeepAttr)continue;if(!r.keepAttr||!tN&&x(/\/>/i,u)){eh(s,t);continue}tH&&g([tg,tf,tp],t=>{u=S(u,t," ")});let c=et(t.nodeName);if(!em(c,h,u)){eh(s,t);continue}if(e&&"object"==typeof G&&"function"==typeof G.getAttributeType)if(l);else switch(G.getAttributeType(c,h)){case"TrustedHTML":u=e.createHTML(u);break;case"TrustedScriptURL":u=e.createScriptURL(u)}if(u!==a)try{l?t.setAttributeNS(l,s,u):t.setAttribute(s,u),ed(t)?ea(t):p(n.removed)}catch(e){eh(s,t)}}ef(td.afterSanitizeAttributes,t,null)},ey=function t(e){let i=null,r=ec(e);for(ef(td.beforeSanitizeShadowDOM,e,null);i=r.nextNode();)ef(td.uponSanitizeShadowNode,i,null),ep(i),ev(i),i.content instanceof h&&t(i.content);ef(td.afterSanitizeShadowDOM,e,null)};return n.sanitize=function(t){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=null,o=null,l=null,a=null;if((t2=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!eg(t))if("function"==typeof t.toString){if("string"!=typeof(t=t.toString()))throw M("dirty is not a string, aborting")}else throw M("toString is not a function");if(!n.isSupported)return t;if(tD||en(i),n.removed=[],"string"==typeof t&&(tU=!1),tU){if(t.nodeName){let e=et(t.nodeName);if(!tS[e]||tM[e])throw M("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof d)(o=(r=eu("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType===tt.element&&"BODY"===o.nodeName?r=o:"HTML"===o.nodeName?r=o:r.appendChild(o);else{if(!tF&&!tH&&!t_&&-1===t.indexOf("<"))return e&&tW?e.createHTML(t):t;if(!(r=eu(t)))return tF?null:tW?ts:""}r&&tL&&ea(r.firstChild);let u=ec(tU?t:r);for(;l=u.nextNode();)ep(l),ev(l),l.content instanceof h&&ey(l.content);if(tU)return t;if(tF){if(tV)for(a=th.call(r.ownerDocument);r.firstChild;)a.appendChild(r.firstChild);else a=r;return(tR.shadowroot||tR.shadowrootmode)&&(a=tc.call(s,a,!0)),a}let c=t_?r.outerHTML:r.innerHTML;return t_&&tS["!doctype"]&&r.ownerDocument&&r.ownerDocument.doctype&&r.ownerDocument.doctype.name&&x(J,r.ownerDocument.doctype.name)&&(c="<!DOCTYPE "+r.ownerDocument.doctype.name+">\n"+c),tH&&g([tg,tf,tp],t=>{c=S(c,t," ")}),e&&tW?e.createHTML(c):c},n.setConfig=function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};en(t),tD=!0},n.clearConfig=function(){ee=null,tD=!1},n.isValidAttribute=function(t,e,i){return ee||en({}),em(et(t),et(e),i)},n.addHook=function(t,e){"function"==typeof e&&m(td[t],e)},n.removeHook=function(t,e){if(void 0!==e){let i=f(td[t],e);return -1===i?void 0:w(td[t],i,1)[0]}return p(td[t])},n.removeHooks=function(t){td[t]=[]},n.removeAllHooks=function(){td=ti()},n}(),tn=i(78887);function to(t){return t[0].toUpperCase()+t.substr(1)}function ts(){let t=[];for(var e=arguments.length,i=Array(e),r=0;r<e;r++)i[r]=arguments[r];let n=i.length;for(;n;){n-=1;let e=(0,tn.stringify)(i[n]).toLowerCase();-1===t.indexOf(e)&&t.push(e)}return 1===t.length}function tl(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function ta(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function th(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(t,i)=>"\\"===t.charAt(0)?t.substr(1,t.length-1):void 0===e[i]?"":e[i])}function tu(t){return tc(`${t}`,{ALLOWED_TAGS:[]})}function tc(t,e){return tr.sanitize(t,e)}},94094:(t,e,i)=>{"use strict";var r=i(54076),n=i(1416),o=i(61101);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("symmetricDifference")||!o("symmetricDifference")},{symmetricDifference:n})},94272:(t,e,i)=>{"use strict";var r=i(16954).has;t.exports=function(t){return r(t),t}},94458:(t,e,i)=>{"use strict";i.d(e,{d:()=>n});var r=i(25645);function n(t,e,i){return(0,r.e)(t,-e,i)}},94767:(t,e,i)=>{"use strict";var r=i(72255),n=i(42620),o=i(7687),s="__core-js_shared__",l=t.exports=n[s]||o(s,{});(l.versions||(l.versions=[])).push({version:"3.43.0",mode:r?"pure":"global",copyright:"\xa9 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.43.0/LICENSE",source:"https://github.com/zloirock/core-js"})},94857:(t,e,i)=>{"use strict";i.d(e,{A:()=>tr}),i(41658),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(20775),i(75036);var r=i(91826),n=i(19857),o=i(81174);class s{constructor(t,e){this.settings=t,this.cellRange=e||null}isEmpty(){return null===this.cellRange}add(t){return this.isEmpty()?this.cellRange=this.settings.createCellRange(t):this.cellRange.expand(t),this}replace(t,e){if(!this.isEmpty()){if(this.cellRange.from.isEqual(t))return this.cellRange.from=e,!0;if(this.cellRange.to.isEqual(t))return this.cellRange.to=e,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){let t=this.cellRange.getOuterTopStartCorner(),e=this.cellRange.getOuterBottomEndCorner();return[t.row,t.col,e.row,e.col]}destroy(){this.runLocalHooks("destroy")}}(0,n.mixin)(s,o.A);let l=s;class a extends l{constructor(t,e){super(t,null),function(t,e,i){var r;(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:null,enumerable:!0,configurable:!0,writable:!0}):t[e]=null}(this,"visualCellRange",null),this.visualCellRange=e||null,this.commit()}add(t){return null===this.visualCellRange?this.visualCellRange=this.settings.createCellRange(t):this.visualCellRange.expand(t),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(t){let{from:e,to:i}=t,r=this.getNearestNotHiddenCoords(e,1),n=this.getNearestNotHiddenCoords(i,-1);return null===r||null===n?null:((r.row>n.row||r.col>n.col)&&(r=e,n=i),this.settings.createCellRange(r,r,n))}getNearestNotHiddenCoords(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,t.row,e);if(null===r)return null;let n=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,t.col,i);return null===n?null:this.settings.createCellCoords(r,n)}getNearestNotHiddenIndex(t,e,i){return e<0?e:t.getNearestNotHiddenIndex(e,i)}commit(){if(null===this.visualCellRange)return this;let t=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return null===t?this.cellRange=null:this.cellRange=this.createRenderableCellRange(t.from,t.to),this}syncWith(t){let e=t.from.clone().normalize(),i="N-S"===t.getVerticalDirection()?1:-1,r="W-E"===t.getHorizontalDirection()?1:-1,n=this.settings.visualToRenderableCoords(this.visualCellRange.highlight),o=null;if((null===n||null===n.col||null===n.row)&&(o=this.getNearestNotHiddenCoords(e,i,r)),null!==o&&t.overlaps(o)){let e=t.highlight.clone();if(e.row>=0&&(e.row=o.row),e.col>=0&&(e.col=o.col),null===this.cellRange){let t=this.settings.visualToRenderableCoords(e);this.cellRange=this.settings.createCellRange(t)}t.setHighlight(e)}return"focus"===this.settings.selectionType&&null!==n&&null===o&&t.setHighlight(this.visualCellRange.highlight),this}getCorners(){let{from:t,to:e}=this.cellRange;return[Math.min(t.row,e.row),Math.min(t.col,e.col),Math.max(t.row,e.row),Math.max(t.col,e.col)]}getVisualCorners(){let t=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),e=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[t.row,t.col,e.row,e.col]}createRenderableCellRange(t,e){let i=this.settings.visualToRenderableCoords(t),r=this.settings.visualToRenderableCoords(e);return null===i.row||null===i.col||null===r.row||null===r.col?null:this.settings.createCellRange(i,i,r)}}function h(t){let{activeHeaderClassName:e,...i}=t;return new a({className:e,...i,selectionType:r.E6})}function u(t){let{areaCornerVisible:e,...i}=t;return new a({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...i,selectionType:r.LX})}function c(t){let{...e}=t;return new a({className:"highlight",...e,selectionType:r.LX})}function d(t){let{columnClassName:e,...i}=t;return new a({className:e,...i,selectionType:r.QP})}var g=i(91748);function f(t){let{headerClassName:e,...i}=t;return new a({className:e,...i,selectionType:r.PP})}function p(t){let{rowClassName:e,...i}=t;return new a({className:e,...i,selectionType:r._8})}var m=i(95061);function w(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function y(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var b=new WeakSet;class C{constructor(t){!function(t,e){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.add(t)}(this,b),w(this,"options",void 0),w(this,"layerLevel",0),w(this,"focus",void 0),w(this,"fill",void 0),w(this,"layeredAreas",new Map),w(this,"areas",new Map),w(this,"rowHeaders",new Map),w(this,"columnHeaders",new Map),w(this,"activeRowHeaders",new Map),w(this,"activeColumnHeaders",new Map),w(this,"activeCornerHeaders",new Map),w(this,"rowHighlights",new Map),w(this,"columnHighlights",new Map),w(this,"customSelections",[]),this.options=t,this.focus=function(t){let{cellCornerVisible:e,...i}=t;return new a({className:"current",headerAttributes:[(0,g.H0)()],border:{width:2,color:"#4b89ff",cornerVisible:e},...i,selectionType:r.Yt})}(t),this.fill=function(t){let{...e}=t;return new a({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:r.Hb})}(t)}isEnabledFor(t,e){let i=t;t===r.Yt&&(i="current");let n=this.options.disabledCellSelection(e.row,e.col);return"string"==typeof n&&(n=[n]),!1===n||Array.isArray(n)&&!n.includes(i)}useLayerLevel(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.layerLevel=t,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return y(b,this,S).call(this,this.layeredAreas,u)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return y(b,this,S).call(this,this.areas,c)}getAreas(){return[...this.areas.values()]}createRowHeader(){return y(b,this,S).call(this,this.rowHeaders,f)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return y(b,this,S).call(this,this.columnHeaders,f)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return y(b,this,S).call(this,this.activeRowHeaders,h)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return y(b,this,S).call(this,this.activeColumnHeaders,h)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return y(b,this,S).call(this,this.activeCornerHeaders,h)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return y(b,this,S).call(this,this.rowHighlights,p)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return y(b,this,S).call(this,this.columnHighlights,d)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(t){this.customSelections.push(function(t){let{border:e,visualCellRange:i,...n}=t;return new a({...e,...n,selectionType:r.OS},i)}({...this.options,...t}))}clear(){this.focus.clear(),this.fill.clear(),(0,m.arrayEach)(this.areas.values(),t=>void t.clear()),(0,m.arrayEach)(this.layeredAreas.values(),t=>void t.clear()),(0,m.arrayEach)(this.rowHeaders.values(),t=>void t.clear()),(0,m.arrayEach)(this.columnHeaders.values(),t=>void t.clear()),(0,m.arrayEach)(this.activeRowHeaders.values(),t=>void t.clear()),(0,m.arrayEach)(this.activeColumnHeaders.values(),t=>void t.clear()),(0,m.arrayEach)(this.activeCornerHeaders.values(),t=>void t.clear()),(0,m.arrayEach)(this.rowHighlights.values(),t=>void t.clear()),(0,m.arrayEach)(this.columnHighlights.values(),t=>void t.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function S(t,e){let i=this.layerLevel;if(t.has(i))return t.get(i);let r=e({layerLevel:i,...this.options});return t.set(i,r),r}function E(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}class R{constructor(t){E(this,"ranges",[]),E(this,"createCellRange",void 0),this.createCellRange=t}isEmpty(){return 0===this.size()}set(t){return this.clear(),this.ranges.push(this.createCellRange(t)),this}add(t){return this.ranges.push(this.createCellRange(t)),this}pop(){return this.ranges.pop(),this}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(t){return this.ranges.some(e=>e.includes(t))}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}peekByIndex(){let t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e>=0&&e<this.size()&&(t=this.ranges[e]),t}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}var T=i(78887),x=i(13455);function M(t,e,i){k(t,e),e.set(t,i)}function k(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")}function O(t,e){return t.get(A(t,e))}function I(t,e,i){return t.set(A(t,e),i),i}function A(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var N=new WeakMap,H=new WeakMap,P=new WeakMap,_=new WeakSet;class D{constructor(t,e){!function(t,e){k(t,e),e.add(t)}(this,_),M(this,N,void 0),M(this,H,void 0),M(this,P,{x:0,y:0}),I(N,this,t),I(H,this,e)}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=O(H,this).createCellCoords(t,e),o=O(N,this).current().highlight,s=O(H,this).visualToRenderableCoords(o),l=0,a=0;if(this.runLocalHooks("beforeTransformStart",r),null!==s.row&&null!==s.col){let{width:t,height:e}=A(_,this,F).call(this),{row:s,col:h}=A(_,this,B).call(this,o),u=O(H,this).fixedRowsBottom(),c=O(H,this).minSpareRows(),d=O(H,this).minSpareCols(),g=O(H,this).autoWrapRow(),f=O(H,this).autoWrapCol(),p=O(H,this).createCellCoords(s+r.row,h+r.col);if(p.row>=e){let r=(0,n.createObjectPropListener)(i&&c>0&&0===u),o=p.col+1,s=O(H,this).createCellCoords(p.row-e,o>=t?o-t:o);this.runLocalHooks("beforeColumnWrap",r,A(_,this,j).call(this,s),o>=t),r.value?this.runLocalHooks("insertRowRequire",O(H,this).countRenderableRows()):f&&p.assign(s)}else if(p.row<0){let i=(0,n.createObjectPropListener)(f),r=p.col-1,o=O(H,this).createCellCoords(e+p.row,r<0?t+r:r);this.runLocalHooks("beforeColumnWrap",i,A(_,this,j).call(this,o),r<0),f&&p.assign(o)}if(p.col>=t){let r=(0,n.createObjectPropListener)(i&&d>0),o=p.row+1,s=O(H,this).createCellCoords(o>=e?o-e:o,p.col-t);this.runLocalHooks("beforeRowWrap",r,A(_,this,j).call(this,s),o>=e),r.value?this.runLocalHooks("insertColRequire",O(H,this).countRenderableColumns()):g&&p.assign(s)}else if(p.col<0){let i=(0,n.createObjectPropListener)(g),r=p.row-1,o=O(H,this).createCellCoords(r<0?e+r:r,t+p.col);this.runLocalHooks("beforeRowWrap",i,A(_,this,j).call(this,o),r<0),g&&p.assign(o)}let{rowDir:m,colDir:w}=A(_,this,L).call(this,p);l=m,a=w,o=A(_,this,j).call(this,p)}return this.runLocalHooks("afterTransformStart",o,l,a),o}transformEnd(t,e){let i=O(H,this).createCellCoords(t,e),r=O(N,this).current(),n=O(H,this).visualToRenderableCoords(r.highlight),o=A(_,this,V).call(this,r.to.row,r.from.row),s=A(_,this,W).call(this,r.to.col,r.from.col),l=r.to.clone(),a=0,h=0;if(this.runLocalHooks("beforeTransformEnd",i),null!==n.row&&null!==n.col&&null!==o&&null!==s){let{row:t,col:e}=A(_,this,B).call(this,r.highlight),n=O(H,this).createCellCoords(o+i.row,s+i.col),u=r.getTopStartCorner(),c=r.getTopEndCorner(),d=r.getBottomEndCorner();if(i.col<0&&s>=e&&n.col<e){let t=n.col-e;n.col=A(_,this,W).call(this,u.col,c.col)+t}else if(i.col>0&&s<=e&&n.col>e){let t=A(_,this,W).call(this,c.col,u.col),e=Math.max(n.col-t,1);n.col=t+e}if(i.row<0&&o>=t&&n.row<t){let e=n.row-t;n.row=A(_,this,V).call(this,u.row,d.row)+e}else if(i.row>0&&o<=t&&n.row>t){let t=A(_,this,V).call(this,d.row,u.row),e=Math.max(n.row-t,1);n.row=t+e}let{rowDir:g,colDir:f}=A(_,this,L).call(this,n);a=g,h=f;let p=A(_,this,j).call(this,n);0===i.row&&0!==i.col?l.col=p.col:0!==i.row&&0===i.col?l.row=p.row:(l.row=p.row,l.col=p.col)}return this.runLocalHooks("afterTransformEnd",l,a,h),l}setOffsetSize(t){let{x:e,y:i}=t;I(P,this,{x:e,y:i})}resetOffsetSize(){I(P,this,{x:0,y:0})}}function L(t){let{width:e,height:i}=A(_,this,F).call(this),r=0,n=0;return t.row<0?(r=-1,t.row=0):t.row>0&&t.row>=i&&(r=1,t.row=i-1),t.col<0?(n=-1,t.col=0):t.col>0&&t.col>=e&&(n=1,t.col=e-1),{rowDir:r,colDir:n}}function F(){return{width:O(P,this).x+O(H,this).countRenderableColumns(),height:O(P,this).y+O(H,this).countRenderableRows()}}function V(t,e){let i=O(H,this).findFirstNonHiddenRenderableRow(t,e);return null===i?null:O(P,this).y+i}function W(t,e){let i=O(H,this).findFirstNonHiddenRenderableColumn(t,e);return null===i?null:O(P,this).x+i}function B(t){let{row:e,col:i}=O(H,this).visualToRenderableCoords(t);if(null===e||null===i)throw Error("Renderable coords are not visible.");return O(H,this).createCellCoords(O(P,this).y+e,O(P,this).x+i)}function j(t){let e=t.clone();return e.col=t.col-O(P,this).x,e.row=t.row-O(P,this).y,O(H,this).renderableToVisualCoords(e)}(0,n.mixin)(D,o.A);var z=i(16932),U=i(83457);function $(t,e,i){(function(t,e){if(e.has(t))throw TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,i)}function Y(t,e,i){var r;return(e="symbol"==typeof(r=function(t,e){if("object"!=typeof t||!t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var r=i.call(t,e||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(e,"string"))?r:r+"")in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function G(t,e){return t.get(X(t,e))}function q(t,e,i){return t.set(X(t,e),i),i}function X(t,e,i){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:i;throw TypeError("Private element is not present on this object")}var K=new WeakMap,J=new WeakMap,Q=new WeakMap,Z=new WeakMap,tt=new WeakMap,te=new WeakMap;class ti{constructor(t,e){var i=this;Y(this,"settings",void 0),Y(this,"tableProps",void 0),Y(this,"inProgress",!1),Y(this,"selectedRange",new R((t,e,i)=>this.tableProps.createCellRange(t,e,i))),Y(this,"highlight",void 0),$(this,K,void 0),$(this,J,void 0),Y(this,"selectedByRowHeader",new Set),Y(this,"selectedByColumnHeader",new Set),$(this,Q,!1),$(this,Z,!1),$(this,tt,"unknown"),$(this,te,-1),this.settings=t,this.tableProps=e,this.highlight=new C({headerClassName:t.currentHeaderClassName,activeHeaderClassName:t.activeHeaderClassName,rowClassName:t.currentRowClassName,columnClassName:t.currentColClassName,cellAttributes:[(0,g.H0)()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(t,e)=>this.tableProps.isDisabledCellSelection(t,e),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),createCellRange:(t,e,i)=>this.tableProps.createCellRange(t,e,i)}),q(K,this,new D(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>this.tableProps.countRenderableRows(),countRenderableColumns:()=>this.tableProps.countRenderableColumns(),visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>t.fixedRowsBottom,minSpareRows:()=>t.minSpareRows,minSpareCols:()=>t.minSpareCols,autoWrapRow:()=>t.autoWrapRow,autoWrapCol:()=>t.autoWrapCol})),q(J,this,new D(this.selectedRange,{rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,countRenderableRows:()=>{let t=this.selectedRange.current();return this.tableProps.countRenderableRowsInRange(0,t.getOuterBottomEndCorner().row)},countRenderableColumns:()=>{let t=this.selectedRange.current();return this.tableProps.countRenderableColumnsInRange(0,t.getOuterBottomEndCorner().col)},visualToRenderableCoords:t=>this.tableProps.visualToRenderableCoords(t),renderableToVisualCoords:t=>this.tableProps.renderableToVisualCoords(t),findFirstNonHiddenRenderableRow:function(){return i.tableProps.findFirstNonHiddenRenderableRow(...arguments)},findFirstNonHiddenRenderableColumn:function(){return i.tableProps.findFirstNonHiddenRenderableColumn(...arguments)},createCellCoords:(t,e)=>this.tableProps.createCellCoords(t,e),fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),G(K,this).addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformStart",...e)}),G(K,this).addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformStart",...e)}),G(K,this).addLocalHook("beforeTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformEnd",...e)}),G(K,this).addLocalHook("afterTransformEnd",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformEnd",...e)}),G(K,this).addLocalHook("insertRowRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertRowRequire",...e)}),G(K,this).addLocalHook("insertColRequire",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("insertColRequire",...e)}),G(K,this).addLocalHook("beforeRowWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeRowWrap",...e)}),G(K,this).addLocalHook("beforeColumnWrap",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeColumnWrap",...e)}),G(J,this).addLocalHook("beforeTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("beforeModifyTransformFocus",...e)}),G(J,this).addLocalHook("afterTransformStart",function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.runLocalHooks("afterModifyTransformFocus",...e)})}getSelectedRange(){return this.selectedRange}markSource(t){q(tt,this,t)}markEndSource(){q(tt,this,"unknown")}getSelectionSource(){return G(tt,this)}setExpectedLayers(t){q(te,this,t)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,q(te,this,-1)}isInProgress(){return this.inProgress}setRangeStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:t,n="multiple"===this.settings.selectionMode,o=(0,T.isUndefined)(e)?this.tableProps.getShortcutManager().isCtrlPressed():e,s=t.clone();q(Q,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,s),(!n||n&&!o&&(0,T.isUndefined)(e))&&this.selectedRange.clear(),this.selectedRange.add(s).current().setHighlight(r.clone()),0===this.getLayerLevel()&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(t)}setRangeStartOnly(t,e){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;this.setRangeStart(t,e,!0,i)}setRangeEnd(t){if(this.selectedRange.isEmpty())return;let e=t.clone(),i=this.tableProps.countRows(),r=this.tableProps.countCols(),n=this.selectedRange.current().clone().setTo(t).isSingleHeader();if((i>0||r>0)&&(0===i&&e.col<0&&!n||0===r&&e.row<0&&!n))return;this.runLocalHooks("beforeSetRangeEnd",e),this.begin();let o=this.selectedRange.current();if(this.settings.navigableHeaders||o.highlight.normalize(),"single"===this.settings.selectionMode)o.setFrom(o.highlight),o.setTo(o.highlight);else{let t=o.getHorizontalDirection(),i=o.getVerticalDirection(),r=this.isMultiple();o.setTo(e),r&&(t!==o.getHorizontalDirection()||1===o.getWidth()&&!o.includes(o.highlight))&&o.from.assign({col:o.highlight.col}),r&&(i!==o.getVerticalDirection()||1===o.getHeight()&&!o.includes(o.highlight))&&o.from.assign({row:o.highlight.row})}i>0&&r>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!o.isSingleHeader())&&o.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.selectedRange.current().highlight),this.applyAndCommit();let s=-1===G(te,this)||this.selectedRange.size()===G(te,this);this.runLocalHooks("afterSetRangeEnd",t,s)}applyAndCommit(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.selectedRange.current(),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.getLayerLevel(),i=this.tableProps.countRows(),n=this.tableProps.countCols();e<this.highlight.layerLevel&&((0,m.arrayEach)(this.highlight.getAreas(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getLayeredAreas(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getRowHeaders(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getColumnHeaders(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getActiveRowHeaders(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getActiveColumnHeaders(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getActiveCornerHeaders(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getRowHighlights(),t=>void t.clear()),(0,m.arrayEach)(this.highlight.getColumnHighlights(),t=>void t.clear())),this.highlight.useLayerLevel(e);let o=this.highlight.createArea(),s=this.highlight.createLayeredArea(),l=this.highlight.createRowHeader(),a=this.highlight.createColumnHeader(),h=this.highlight.createActiveRowHeader(),u=this.highlight.createActiveColumnHeader(),c=this.highlight.createActiveCornerHeader(),d=this.highlight.createRowHighlight(),g=this.highlight.createColumnHighlight();if(o.clear(),s.clear(),l.clear(),a.clear(),h.clear(),u.clear(),c.clear(),d.clear(),g.clear(),this.highlight.isEnabledFor(r.LX,t.highlight)&&(this.isMultiple()||e>=1)&&(o.add(t.from).add(t.to).commit(),s.add(t.from).add(t.to).commit(),1===e)){let t=this.selectedRange.previous();this.highlight.useLayerLevel(e-1),this.highlight.createArea().add(t.from).commit().syncWith(t),this.highlight.createLayeredArea().add(t.from).commit().syncWith(t),this.highlight.useLayerLevel(e)}if(this.highlight.isEnabledFor(r.PP,t.highlight)){if(!t.isSingleHeader()){let e=this.tableProps.createCellCoords(Math.max(t.from.row,0),-1),i=this.tableProps.createCellCoords(t.to.row,-1),r=this.tableProps.createCellCoords(-1,Math.max(t.from.col,0)),n=this.tableProps.createCellCoords(-1,t.to.col);"single"===this.settings.selectionMode?(l.add(e).commit(),a.add(r).commit(),d.add(e).commit(),g.add(r).commit()):(l.add(e).add(i).commit(),a.add(r).add(n).commit(),d.add(e).add(i).commit(),g.add(r).add(n).commit())}let e=!G(Z,this)&&this.isEntireRowSelected()&&(n>0&&n===t.getWidth()||0===n&&this.isSelectedByRowHeader()),r=!G(Z,this)&&this.isEntireColumnSelected()&&(i>0&&i===t.getHeight()||0===i&&this.isSelectedByColumnHeader());e&&h.add(this.tableProps.createCellCoords(Math.max(t.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(t.to.row,0),-1)).commit(),r&&u.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(t.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(t.to.col,0))).commit(),e&&r&&c.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(t){if(this.selectedRange.isEmpty())return;let e=this.selectedRange.current();this.inProgress||this.runLocalHooks("beforeSetFocus",t);let i=this.highlight.getFocus();i.clear(),e.setHighlight(t),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(r.Yt,e.highlight)&&i.add(e.highlight).commit().syncWith(e),this.inProgress||(q(Q,this,!0),this.runLocalHooks("afterSetFocus",e.highlight))}transformStart(t,e){let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.settings.navigableHeaders?G(K,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):G(K,this).resetOffsetSize(),this.setRangeStart(G(K,this).transformStart(t,e,i))}transformEnd(t,e){this.settings.navigableHeaders?G(K,this).setOffsetSize({x:this.tableProps.countRowHeaders(),y:this.tableProps.countColHeaders()}):G(K,this).resetOffsetSize(),this.setRangeEnd(G(K,this).transformEnd(t,e))}transformFocus(t,e){let i=this.selectedRange.current(),{row:r,col:n}=i.getOuterTopStartCorner(),o=this.tableProps.countRenderableColumnsInRange(0,n-1),s=this.tableProps.countRenderableRowsInRange(0,r-1);i.highlight.isHeader()?G(J,this).setOffsetSize({x:n<0?Math.abs(n):-o,y:r<0?Math.abs(r):-s}):G(J,this).setOffsetSize({x:n<0?0:-o,y:r<0?0:-s});let l=G(J,this).transformStart(t,e);this.setRangeFocus(l.normalize())}shiftRows(t,e){if(!this.isSelected())return;let i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=t){let{from:r,to:n,highlight:o}=i,s=this.tableProps.countRows(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=a?-1:0;this.getSelectedRange().pop();let u=this.tableProps.createCellCoords((0,x.clamp)(r.row+(a?0:e),h,s-1),r.col),c=this.tableProps.createCellCoords((0,x.clamp)(n.row+e,h,s-1),n.col);this.markSource("shift"),o.row>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords((0,x.clamp)(o.row+e,0,s-1),o.col)):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(c),this.markEndSource()}}shiftColumns(t,e){if(!this.isSelected())return;let i=this.selectedRange.current();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=t){let{from:r,to:n,highlight:o}=i,s=this.tableProps.countCols(),l=this.isSelectedByRowHeader(),a=this.isSelectedByColumnHeader(),h=l?-1:0;this.getSelectedRange().pop();let u=this.tableProps.createCellCoords(r.row,(0,x.clamp)(r.col+(l?0:e),h,s-1)),c=this.tableProps.createCellCoords(n.row,(0,x.clamp)(n.col+e,h,s-1));this.markSource("shift"),o.col>=t?this.setRangeStartOnly(u,!0,this.tableProps.createCellCoords(o.row,(0,x.clamp)(o.col+e,0,s-1))):this.setRangeStartOnly(u,!0),l&&this.selectedByRowHeader.add(this.getLayerLevel()),a&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(c),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){if(!this.isSelected())return!1;let t=(0,n.createObjectPropListener)(!this.selectedRange.current().isSingle());return this.runLocalHooks("afterIsMultipleSelection",t),t.value}isFocusSelectionChanged(){return this.isSelected()&&G(Q,this)}isSelectedByRowHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(t)&&(-1===t?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(t))}isEntireRowSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{col:e}=t.getOuterTopStartCorner(),i=this.tableProps.countRowHeaders(),r=this.tableProps.countCols();return(i>0&&e<0||0===i)&&t.getWidth()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByColumnHeader(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(-1===t?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(t))}isEntireColumnSelected(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getLayerLevel(),e=t=>{let{row:e}=t.getOuterTopStartCorner(),i=this.tableProps.countColHeaders(),r=this.tableProps.countRows();return(i>0&&e<0||0===i)&&t.getHeight()===r};if(-1===t)return Array.from(this.selectedRange).some(t=>e(t));let i=this.selectedRange.peekByIndex(t);return!!i&&e(i)}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(t){return this.selectedRange.includes(t)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(t){let e=this.tableProps.visualToRenderableCoords(t);return null!==e.row&&null!==e.col}isAreaCornerVisible(t){return(!Number.isInteger(t)||t===this.getLayerLevel())&&this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var t;let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1},n=this.tableProps.countRows(),o=this.tableProps.countCols(),s=this.tableProps.countRowHeaders(),l=this.tableProps.countColHeaders(),a=i?-l:0,h=e?-s:0;if(0===a&&0===h&&(0===n||0===o))return;let u=null===(t=this.getSelectedRange().current())||void 0===t?void 0:t.highlight,{focusPosition:c,disableHeadersHighlight:d}=r;q(Z,this,d),c&&Number.isInteger(null==c?void 0:c.row)&&Number.isInteger(null==c?void 0:c.col)&&(u=this.tableProps.createCellCoords((0,x.clamp)(c.row,a,n-1),(0,x.clamp)(c.col,h,o-1)));let g=this.tableProps.createCellCoords(a,h),f=this.tableProps.createCellCoords(n-1,o-1);this.clear(),this.setRangeStartOnly(g,void 0,u),h<0&&this.selectedByRowHeader.add(this.getLayerLevel()),a<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(f),this.finish(),q(Z,this,!1)}selectCells(t){var e=this;let i=(0,z.ML)(t);if(i===z.Qz)return!1;if(i===z.ay)throw Error((0,U.O)`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);let r=(0,z._e)(i,{createCellCoords:function(){return e.tableProps.createCellCoords(...arguments)},createCellRange:function(){return e.tableProps.createCellRange(...arguments)},propToCol:t=>this.tableProps.propToCol(t),keepDirection:!0}),n=this.settings.navigableHeaders,o={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:n?this.tableProps.countRowHeaders():0,countColHeaders:n?this.tableProps.countColHeaders():0},s=!t.some(t=>{let e=r(t),i=e.isValid(o);return!(i&&!e.containsHeaders()||i&&e.containsHeaders()&&e.isSingleHeader())});return s&&(this.clear(),this.setExpectedLayers(t.length),(0,m.arrayEach)(t,t=>{let{from:e,to:i}=r(t);this.setRangeStartOnly(e.clone(),!1),this.setRangeEnd(i.clone())}),this.finish()),s}selectColumns(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r="string"==typeof t?this.tableProps.propToCol(t):t,n="string"==typeof e?this.tableProps.propToCol(e):e,o=this.tableProps.countRows(),s=this.tableProps.countCols(),l=this.tableProps.countColHeaders(),a=0===l?0:-l,h=this.tableProps.createCellCoords(a,r),u=this.tableProps.createCellCoords(o-1,n),c=this.tableProps.createCellRange(h,h,u).isValid({countRows:o,countCols:s,countRowHeaders:0,countColHeaders:l});if(c){let t=0,e=0;Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(t=(0,x.clamp)(i.row,a,o-1),e=(0,x.clamp)(i.col,Math.min(r,n),Math.max(r,n))):(t=(0,x.clamp)(i,a,o-1),e=r);let s=this.tableProps.createCellCoords(t,e),h=0===l?0:(0,x.clamp)(s.row,a,-1),u=o-1,c=this.tableProps.createCellCoords(h,r),d=this.tableProps.createCellCoords(u,n);this.runLocalHooks("beforeSelectColumns",c,d,s),c.row=h,d.row=u,this.setRangeStartOnly(c,void 0,s),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectColumns",c,d,s),this.finish()}return c}selectRows(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=this.tableProps.countRows(),n=this.tableProps.countCols(),o=this.tableProps.countRowHeaders(),s=0===o?0:-o,l=this.tableProps.createCellCoords(t,s),a=this.tableProps.createCellCoords(e,n-1),h=this.tableProps.createCellRange(l,l,a).isValid({countRows:r,countCols:n,countRowHeaders:o,countColHeaders:0});if(h){let r=0,l=0;Number.isInteger(null==i?void 0:i.row)&&Number.isInteger(null==i?void 0:i.col)?(r=(0,x.clamp)(i.row,Math.min(t,e),Math.max(t,e)),l=(0,x.clamp)(i.col,s,n-1)):(r=t,l=(0,x.clamp)(i,s,n-1));let a=this.tableProps.createCellCoords(r,l),h=0===o?0:(0,x.clamp)(a.col,s,-1),u=n-1,c=this.tableProps.createCellCoords(t,h),d=this.tableProps.createCellCoords(e,u);this.runLocalHooks("beforeSelectRows",c,d,a),c.col=h,d.col=u,this.setRangeStartOnly(c,void 0,a),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(d),this.runLocalHooks("afterSelectRows",c,d,a),this.finish()}return h}refresh(){if(!this.isSelected())return;let t=this.tableProps.countRows(),e=this.tableProps.countCols();if(0===t||0===e){this.deselect();return}let i=this.selectedRange.peekByIndex(this.selectedRange.size()-1),{from:n,to:o,highlight:s}=i;this.clear(),s.assign({row:(0,x.clamp)(s.row,-1/0,t-1),col:(0,x.clamp)(s.col,-1/0,e-1)}),n.assign({row:(0,x.clamp)(n.row,-1/0,t-1),col:(0,x.clamp)(n.col,-1/0,e-1)}),o.assign({row:(0,x.clamp)(o.row,0,t-1),col:(0,x.clamp)(o.col,0,e-1)}),this.selectedRange.ranges.push(i),this.highlight.isEnabledFor(r.Yt,this.selectedRange.current().highlight)&&this.highlight.getFocus().add(s).commit().syncWith(i),this.applyAndCommit(i)}commit(){if(this.highlight.getCustomSelections().forEach(t=>{t.commit()}),!this.isSelected())return;let t=this.getLayerLevel(),e=this.selectedRange.current();this.highlight.isEnabledFor(r.Yt,e.highlight)&&this.highlight.getFocus().commit().syncWith(e);for(let t=0;t<this.selectedRange.size();t+=1){this.highlight.useLayerLevel(t);let e=this.highlight.createArea(),i=this.highlight.createLayeredArea(),r=this.highlight.createRowHeader(),n=this.highlight.createColumnHeader(),o=this.highlight.createActiveRowHeader(),s=this.highlight.createActiveColumnHeader(),l=this.highlight.createActiveCornerHeader(),a=this.highlight.createRowHighlight(),h=this.highlight.createColumnHighlight();e.commit(),i.commit(),r.commit(),n.commit(),o.commit(),s.commit(),l.commit(),a.commit(),h.commit()}this.highlight.useLayerLevel(t)}}(0,n.mixin)(ti,o.A);let tr=ti},94948:(t,e,i)=>{"use strict";var r=i(32730);t.exports=function(t){return r(t.length)}},95061:(t,e,i)=>{"use strict";function r(t){let e=t.length,i=0;for(;i<e;)t[i]=[t[i]],i+=1}function n(t,e){let i=e.length,r=0;for(;r<i;)t.push(e[r]),r+=1}function o(t){let e=[];if(!t||0===t.length||!t[0]||0===t[0].length)return e;let i=t.length,r=t[0].length;for(let n=0;n<i;n++)for(let i=0;i<r;i++)e[i]||(e[i]=[]),e[i][n]=t[n][i];return e}function s(t,e,i,r){let n=-1,o=t,s=i;Array.isArray(t)||(o=Array.from(t));let l=o.length;for(r&&l&&(n+=1,s=o[n]),n+=1;n<l;)s=e(s,o[n],n,o),n+=1;return s}function l(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let t=r[i];e(t,i,r)&&(o[s+=1]=t),i+=1}return o}function a(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length,o=[],s=-1;for(;i<n;){let t=r[i];o[s+=1]=e(t,i,r),i+=1}return o}function h(t,e){let i=0,r=t;Array.isArray(t)||(r=Array.from(t));let n=r.length;for(;i<n&&!1!==e(r[i],i,r);)i+=1;return t}function u(t){return s(t,(t,e)=>t+e,0)}function c(t){return s(t,(t,e)=>t>e?t:e,Array.isArray(t)?t[0]:void 0)}function d(t){return s(t,(t,e)=>t<e?t:e,Array.isArray(t)?t[0]:void 0)}function g(t){return t.length?u(t)/t.length:0}function f(t){let e=[];return h(t,t=>{-1===e.indexOf(t)&&e.push(t)}),e}function p(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...n]=[...e],o=r;return h(n,t=>{o=o.filter(e=>!t.includes(e))}),o}function m(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...n]=[...e],o=r;return h(n,t=>{o=o.filter(e=>t.includes(e))}),o}function w(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];let[r,...n]=[...e],o=new Set(r);return h(n,t=>{h(t,t=>{o.has(t)||o.add(t)})}),Array.from(o)}function y(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return t.split(e)}i.r(e),i.d(e,{arrayAvg:()=>g,arrayEach:()=>h,arrayFilter:()=>l,arrayFlatten:()=>function t(e){return s(e,(e,i)=>e.concat(Array.isArray(i)?t(i):i),[])},arrayMap:()=>a,arrayMax:()=>c,arrayMin:()=>d,arrayReduce:()=>s,arraySum:()=>u,arrayUnique:()=>f,extendArray:()=>n,getDifferenceOfArrays:()=>p,getIntersectionOfArrays:()=>m,getUnionOfArrays:()=>w,pivot:()=>o,stringToArray:()=>y,to2dArray:()=>r}),i(19398),i(99848),i(15030),i(58331),i(88838),i(53545),i(94094),i(65418),i(12252),i(29954)},95283:(t,e,i)=>{"use strict";var r=i(27764),n=i(38896),o=i(56135),s=i(54733),l=i(7107)("iterator");t.exports=function(t){if(!o(t))return n(t,l)||n(t,"@@iterator")||s[r(t)]}},95467:(t,e,i)=>{"use strict";var r=i(93840),n=i(33325),o=r({}.hasOwnProperty);t.exports=Object.hasOwn||function(t,e){return o(n(t),e)}},95490:(t,e,i)=>{"use strict";i.d(e,{q:()=>n});let r={};function n(){return r}},95696:(t,e,i)=>{"use strict";i.r(e),i.d(e,{CHECKBOX_CHECKED:()=>tA,CHECKBOX_RENDERER_NAMESPACE:()=>tI,CHECKBOX_UNCHECKED:()=>tN,CONTEXTMENU_ITEMS_ADD_COMMENT:()=>T,CONTEXTMENU_ITEMS_ALIGNMENT:()=>O,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:()=>D,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:()=>A,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:()=>H,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:()=>I,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:()=>_,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:()=>N,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:()=>P,CONTEXTMENU_ITEMS_BORDERS:()=>L,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:()=>W,CONTEXTMENU_ITEMS_BORDERS_LEFT:()=>B,CONTEXTMENU_ITEMS_BORDERS_RIGHT:()=>V,CONTEXTMENU_ITEMS_BORDERS_TOP:()=>F,CONTEXTMENU_ITEMS_CLEAR_COLUMN:()=>f,CONTEXTMENU_ITEMS_COPY:()=>p,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:()=>y,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:()=>w,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:()=>m,CONTEXTMENU_ITEMS_CUT:()=>b,CONTEXTMENU_ITEMS_EDIT_COMMENT:()=>x,CONTEXTMENU_ITEMS_FREEZE_COLUMN:()=>C,CONTEXTMENU_ITEMS_HIDE_COLUMN:()=>$,CONTEXTMENU_ITEMS_HIDE_ROW:()=>G,CONTEXTMENU_ITEMS_INSERT_LEFT:()=>l,CONTEXTMENU_ITEMS_INSERT_RIGHT:()=>a,CONTEXTMENU_ITEMS_MERGE_CELLS:()=>E,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:()=>U,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:()=>z,CONTEXTMENU_ITEMS_NO_ITEMS:()=>n,CONTEXTMENU_ITEMS_READ_ONLY:()=>g,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:()=>k,CONTEXTMENU_ITEMS_REDO:()=>d,CONTEXTMENU_ITEMS_REMOVE_BORDERS:()=>j,CONTEXTMENU_ITEMS_REMOVE_COLUMN:()=>u,CONTEXTMENU_ITEMS_REMOVE_COMMENT:()=>M,CONTEXTMENU_ITEMS_REMOVE_ROW:()=>h,CONTEXTMENU_ITEMS_ROW_ABOVE:()=>o,CONTEXTMENU_ITEMS_ROW_BELOW:()=>s,CONTEXTMENU_ITEMS_SHOW_COLUMN:()=>Y,CONTEXTMENU_ITEMS_SHOW_ROW:()=>q,CONTEXTMENU_ITEMS_UNDO:()=>c,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:()=>S,CONTEXTMENU_ITEMS_UNMERGE_CELLS:()=>R,CONTEXT_MENU_ITEMS_NAMESPACE:()=>r,FILTERS_BUTTONS_CANCEL:()=>tx,FILTERS_BUTTONS_CLEAR:()=>tR,FILTERS_BUTTONS_OK:()=>tT,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:()=>tM,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:()=>tO,FILTERS_BUTTONS_PLACEHOLDER_VALUE:()=>tk,FILTERS_BUTTONS_SELECT_ALL:()=>tE,FILTERS_CONDITIONS_AFTER:()=>tg,FILTERS_CONDITIONS_BEFORE:()=>tf,FILTERS_CONDITIONS_BEGINS_WITH:()=>ti,FILTERS_CONDITIONS_BETWEEN:()=>tc,FILTERS_CONDITIONS_BY_VALUE:()=>ts,FILTERS_CONDITIONS_CONTAINS:()=>tn,FILTERS_CONDITIONS_EMPTY:()=>Q,FILTERS_CONDITIONS_ENDS_WITH:()=>tr,FILTERS_CONDITIONS_EQUAL:()=>tt,FILTERS_CONDITIONS_GREATER_THAN:()=>tl,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:()=>ta,FILTERS_CONDITIONS_LESS_THAN:()=>th,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:()=>tu,FILTERS_CONDITIONS_NAMESPACE:()=>K,FILTERS_CONDITIONS_NONE:()=>J,FILTERS_CONDITIONS_NOT_BETWEEN:()=>td,FILTERS_CONDITIONS_NOT_CONTAIN:()=>to,FILTERS_CONDITIONS_NOT_EMPTY:()=>Z,FILTERS_CONDITIONS_NOT_EQUAL:()=>te,FILTERS_CONDITIONS_TODAY:()=>tp,FILTERS_CONDITIONS_TOMORROW:()=>tm,FILTERS_CONDITIONS_YESTERDAY:()=>tw,FILTERS_DIVS_FILTER_BY_CONDITION:()=>tv,FILTERS_DIVS_FILTER_BY_VALUE:()=>ty,FILTERS_LABELS_CONJUNCTION:()=>tb,FILTERS_LABELS_DISJUNCTION:()=>tC,FILTERS_NAMESPACE:()=>X,FILTERS_VALUES_BLANK_CELLS:()=>tS});let r="ContextMenu:items",n=`${r}.noItems`,o=`${r}.insertRowAbove`,s=`${r}.insertRowBelow`,l=`${r}.insertColumnOnTheLeft`,a=`${r}.insertColumnOnTheRight`,h=`${r}.removeRow`,u=`${r}.removeColumn`,c=`${r}.undo`,d=`${r}.redo`,g=`${r}.readOnly`,f=`${r}.clearColumn`,p=`${r}.copy`,m=`${r}.copyWithHeaders`,w=`${r}.copyWithGroupHeaders`,y=`${r}.copyHeadersOnly`,b=`${r}.cut`,C=`${r}.freezeColumn`,S=`${r}.unfreezeColumn`,E=`${r}.mergeCells`,R=`${r}.unmergeCells`,T=`${r}.addComment`,x=`${r}.editComment`,M=`${r}.removeComment`,k=`${r}.readOnlyComment`,O=`${r}.align`,I=`${r}.align.left`,A=`${r}.align.center`,N=`${r}.align.right`,H=`${r}.align.justify`,P=`${r}.align.top`,_=`${r}.align.middle`,D=`${r}.align.bottom`,L=`${r}.borders`,F=`${r}.borders.top`,V=`${r}.borders.right`,W=`${r}.borders.bottom`,B=`${r}.borders.left`,j=`${r}.borders.remove`,z=`${r}.nestedHeaders.insertChildRow`,U=`${r}.nestedHeaders.detachFromParent`,$=`${r}.hideColumn`,Y=`${r}.showColumn`,G=`${r}.hideRow`,q=`${r}.showRow`,X="Filters:",K=`${X}conditions`,J=`${K}.none`,Q=`${K}.isEmpty`,Z=`${K}.isNotEmpty`,tt=`${K}.isEqualTo`,te=`${K}.isNotEqualTo`,ti=`${K}.beginsWith`,tr=`${K}.endsWith`,tn=`${K}.contains`,to=`${K}.doesNotContain`,ts=`${K}.byValue`,tl=`${K}.greaterThan`,ta=`${K}.greaterThanOrEqualTo`,th=`${K}.lessThan`,tu=`${K}.lessThanOrEqualTo`,tc=`${K}.isBetween`,td=`${K}.isNotBetween`,tg=`${K}.after`,tf=`${K}.before`,tp=`${K}.today`,tm=`${K}.tomorrow`,tw=`${K}.yesterday`,tv=`${X}labels.filterByCondition`,ty=`${X}labels.filterByValue`,tb=`${X}labels.conjunction`,tC=`${X}labels.disjunction`,tS=`${X}values.blankCells`,tE=`${X}buttons.selectAll`,tR=`${X}buttons.clear`,tT=`${X}buttons.ok`,tx=`${X}buttons.cancel`,tM=`${X}buttons.placeholder.search`,tk=`${X}buttons.placeholder.value`,tO=`${X}buttons.placeholder.secondValue`,tI="CheckboxRenderer:",tA=`${tI}checked`,tN=`${tI}unchecked`},96770:(t,e,i)=>{"use strict";i.d(e,{w:()=>g});for(var r={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},n={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},o="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),s="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),l=0;l<10;l++)r[48+l]=r[96+l]=String(l);for(var l=1;l<=24;l++)r[l+111]="F"+l;for(var l=65;l<=90;l++)r[l]=String.fromCharCode(l+32),n[l]=String.fromCharCode(l);for(var a in r)n.hasOwnProperty(a)||(n[a]=r[a]);var h=i(52571);let u="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),c="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function d(t,e,i=!0){return e.altKey&&(t="Alt-"+t),e.ctrlKey&&(t="Ctrl-"+t),e.metaKey&&(t="Meta-"+t),i&&e.shiftKey&&(t="Shift-"+t),t}function g(t){let e;return new h.k_({props:{handleKeyDown:(e=function(t){let e=Object.create(null);for(let i in t)e[function(t){let e,i,r,n,o=t.split(/-(?!$)/),s=o[o.length-1];"Space"==s&&(s=" ");for(let t=0;t<o.length-1;t++){let s=o[t];if(/^(cmd|meta|m)$/i.test(s))n=!0;else if(/^a(lt)?$/i.test(s))e=!0;else if(/^(c|ctrl|control)$/i.test(s))i=!0;else if(/^s(hift)?$/i.test(s))r=!0;else if(/^mod$/i.test(s))u?n=!0:i=!0;else throw Error("Unrecognized modifier name: "+s)}return e&&(s="Alt-"+s),i&&(s="Ctrl-"+s),n&&(s="Meta-"+s),r&&(s="Shift-"+s),s}(i)]=t[i];return e}(t),function(t,i){var l;let a=("Esc"==(l=!(o&&i.metaKey&&i.shiftKey&&!i.ctrlKey&&!i.altKey||s&&i.shiftKey&&i.key&&1==i.key.length||"Unidentified"==i.key)&&i.key||(i.shiftKey?n:r)[i.keyCode]||i.key||"Unidentified")&&(l="Escape"),"Del"==l&&(l="Delete"),"Left"==l&&(l="ArrowLeft"),"Up"==l&&(l="ArrowUp"),"Right"==l&&(l="ArrowRight"),"Down"==l&&(l="ArrowDown"),l),h,u=e[d(a,i)];if(u&&u(t.state,t.dispatch,t))return!0;if(1==a.length&&" "!=a){if(i.shiftKey){let r=e[d(a,i,!1)];if(r&&r(t.state,t.dispatch,t))return!0}if((i.altKey||i.metaKey||i.ctrlKey)&&!(c&&i.ctrlKey&&i.altKey)&&(h=r[i.keyCode])&&h!=a){let r=e[d(h,i)];if(r&&r(t.state,t.dispatch,t))return!0}}return!1})}})}},96843:(t,e,i)=>{"use strict";var r=i(13517),n=i(81938),o=i(94948),s=function(t){return function(e,i,s){var l,a=r(e),h=o(a);if(0===h)return!t&&-1;var u=n(s,h);if(t&&i!=i){for(;h>u;)if((l=a[u++])!=l)return!0}else for(;h>u;u++)if((t||u in a)&&a[u]===i)return t||u||0;return!t&&-1}};t.exports={includes:s(!0),indexOf:s(!1)}},97156:(t,e,i)=>{"use strict";var r=i(54674),n=i(66627).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,n)}},97165:(t,e,i)=>{"use strict";i.d(e,{a:()=>n});var r=i(89447);function n(t,e,i){let n=(0,r.a)(t,null==i?void 0:i.in);return n.setHours(e),n}},97444:(t,e,i)=>{"use strict";i.d(e,{G:()=>n});var r=i(89447);function n(t){let e=(0,r.a)(t),i=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return i.setUTCFullYear(e.getFullYear()),+t-+i}},98416:(t,e,i)=>{"use strict";i(66256),i(88109)},98449:(t,e,i)=>{"use strict";i.d(e,{c:()=>o});var r=i(61183),n=i(50007);function o(t,e,i){let[o,l]=(0,r.x)(null==i?void 0:i.in,t,e),a=s(o,l),h=Math.abs((0,n.m)(o,l));o.setDate(o.getDate()-a*h);let u=Number(s(o,l)===-a),c=a*(h-u);return 0===c?0:c}function s(t,e){let i=t.getFullYear()-e.getFullYear()||t.getMonth()-e.getMonth()||t.getDate()-e.getDate()||t.getHours()-e.getHours()||t.getMinutes()-e.getMinutes()||t.getSeconds()-e.getSeconds()||t.getMilliseconds()-e.getMilliseconds();return i<0?-1:i>0?1:i}},98590:(t,e,i)=>{"use strict";var r=i(24851).f;t.exports=function(t,e,i){i in t||r(t,i,{configurable:!0,get:function(){return e[i]},set:function(t){e[i]=t}})}},98774:(t,e,i)=>{"use strict";t.exports=!i(56963)(function(){var t=(function(){}).bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})},98794:(t,e,i)=>{"use strict";i.d(e,{H:()=>s});var r=i(25703),n=i(7239),o=i(89447);function s(t,e){var i;let s,p,m=()=>(0,n.w)(null==e?void 0:e.in,NaN),w=null!==(i=null==e?void 0:e.additionalDigits)&&void 0!==i?i:2,y=function(t){let e,i={},r=t.split(l.dateTimeDelimiter);if(r.length>2)return i;if(/:/.test(r[0])?e=r[0]:(i.date=r[0],e=r[1],l.timeZoneDelimiter.test(i.date)&&(i.date=t.split(l.timeZoneDelimiter)[0],e=t.substr(i.date.length,t.length))),e){let t=l.timezone.exec(e);t?(i.time=e.replace(t[1],""),i.timezone=t[1]):i.time=e}return i}(t);if(y.date){let t=function(t,e){let i=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=t.match(i);if(!r)return{year:NaN,restDateString:""};let n=r[1]?parseInt(r[1]):null,o=r[2]?parseInt(r[2]):null;return{year:null===o?n:100*o,restDateString:t.slice((r[1]||r[2]).length)}}(y.date,w);s=function(t,e){var i,r,n,o,s,l,h,u;if(null===e)return new Date(NaN);let d=t.match(a);if(!d)return new Date(NaN);let p=!!d[4],m=c(d[1]),w=c(d[2])-1,y=c(d[3]),b=c(d[4]),C=c(d[5])-1;if(p){return(i=0,r=b,n=C,r>=1&&r<=53&&n>=0&&n<=6)?function(t,e,i){let r=new Date(0);r.setUTCFullYear(t,0,4);let n=r.getUTCDay()||7;return r.setUTCDate(r.getUTCDate()+((e-1)*7+i+1-n)),r}(e,b,C):new Date(NaN)}{let t=new Date(0);return(o=e,s=w,l=y,s>=0&&s<=11&&l>=1&&l<=(g[s]||(f(o)?29:28))&&(h=e,(u=m)>=1&&u<=(f(h)?366:365)))?(t.setUTCFullYear(e,w,Math.max(m,y)),t):new Date(NaN)}}(t.restDateString,t.year)}if(!s||isNaN(+s))return m();let b=+s,C=0;if(y.time&&isNaN(C=function(t){var e,i,n;let o=t.match(h);if(!o)return NaN;let s=d(o[1]),l=d(o[2]),a=d(o[3]);return(e=s,i=l,n=a,24===e?0===i&&0===n:n>=0&&n<60&&i>=0&&i<60&&e>=0&&e<25)?s*r.s0+l*r.Cg+1e3*a:NaN}(y.time)))return m();if(y.timezone){if(isNaN(p=function(t){var e,i;if("Z"===t)return 0;let n=t.match(u);if(!n)return 0;let o="+"===n[1]?-1:1,s=parseInt(n[2]),l=n[3]&&parseInt(n[3])||0;return(e=0,(i=l)>=0&&i<=59)?o*(s*r.s0+l*r.Cg):NaN}(y.timezone)))return m()}else{let t=new Date(b+C),i=(0,o.a)(0,null==e?void 0:e.in);return i.setFullYear(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()),i.setHours(t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()),i}return(0,o.a)(b+C+p,null==e?void 0:e.in)}let l={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},a=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,h=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,u=/^([+-])(\d{2})(?::?(\d{2}))?$/;function c(t){return t?parseInt(t):1}function d(t){return t&&parseFloat(t.replace(",","."))||0}let g=[31,null,31,30,31,30,31,31,30,31,30,31];function f(t){return t%400==0||t%4==0&&t%100!=0}},99026:(t,e,i)=>{"use strict";function r(t){return t instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t)}i.d(e,{$:()=>r})},99206:(t,e,i)=>{"use strict";i.d(e,{L3:()=>d,M8:()=>g,VA:()=>f,aZ:()=>a,sY:()=>h}),i(41658);var r=i(16880),n=i(21413);let o=new WeakMap,{register:s,getItem:l,hasItem:a,getNames:h,getValues:u}=(0,n.A)("editors");function c(t){let e={};this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new t(i)),e[i.guid]},r.R.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function d(t,e){let i;if("function"==typeof t)o.get(t)||f(null,t),i=o.get(t);else if("string"==typeof t)i=l(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!i)throw Error(`No editor registered under name "${t}"`);return i.getInstance(e)}function g(t){if("function"==typeof t)return t;if(!a(t))throw Error(`No registered editor found under "${t}" name`);return l(t).getConstructor()}function f(t,e){t&&"string"!=typeof t&&(t=(e=t).EDITOR_TYPE);let i=new c(e);"string"==typeof t&&s(t,i),o.set(e,i)}},99365:t=>{"use strict";var e="object"==typeof document&&document.all;t.exports=void 0===e&&void 0!==e?function(t){return"function"==typeof t||t===e}:function(t){return"function"==typeof t}},99842:t=>{"use strict";t.exports=function(t,e){var i="function"==typeof Iterator&&Iterator.prototype[t];if(i)try{i.call({next:null},e).next()}catch(t){return!0}}},99848:(t,e,i)=>{"use strict";var r=i(54076),n=i(27226),o=i(56963);r({target:"Set",proto:!0,real:!0,forced:!i(86166)("difference",function(t){return 0===t.size})||o(function(){var t=new Set([1,2,3,4]);return 3!==t.difference({size:1,has:function(){return!0},keys:function(){var e=0;return{next:function(){var i=e++>1;return t.has(1)&&t.clear(),{done:i,value:2}}}}}).size})},{difference:n})}}]);