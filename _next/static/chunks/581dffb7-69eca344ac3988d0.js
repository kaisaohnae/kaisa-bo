"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{52763:(e,t,o)=>{o.d(t,{A:()=>Q}),o(41658),o(19398),o(91215),o(99848),o(15030),o(58331),o(88838),o(53545),o(94094),o(65418),o(12252),o(29954),o(20775),o(85522),o(98416);var r=o(33787),n=o(75708),i=o(78887),l=o(59594),s=o(68804),a=o(57555),u=o(19857),c=o(29239),d=o(95061),h=o(11055),f=o(17480),g=o(46420),m=o(99206),p=o(85917),w=o(93924),C=o(13455),y=o(3422),v=o(79960),R=o(15616),b=o(23967),S=o(36425),E=o(67758),H=o(16880),M=o(24113),A=o(84536),x=o(94857),I=o(255),k=o(84122),_=o(24696),T=o(1354),F=o(89741),D=o(89328),V=o(89658),L=o(33920),N=o(58045),P=o(32886);let O=null,j=new Map;function Q(e,t){let o,Q,z,W,B,K;var U,q=this;let $=arguments.length>2&&void 0!==arguments[2]&&arguments[2],J=this,G=new a.A(J),Y=!0;(0,S.K5)($)&&(0,S.JP)(this),this.rootElement=e,this.rootDocument=e.ownerDocument,this.rootWindow=this.rootDocument.defaultView,this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;let Z=null!==(U=null==t?void 0:t.layoutDirection)&&void 0!==U?U:"inherit",X=["rtl","ltr"].includes(Z)?Z:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",X),this.isRtl=function(){return"rtl"===X},this.isLtr=function(){return!J.isRtl()},this.getDirectionFactor=function(){return J.isLtr()?1:-1},t.language=(0,M.Mj)(t.language);let ee=Object.fromEntries(Object.entries(t).filter(e=>{let[t]=e;return!(H.R.getSingleton().isRegistered(t)||H.R.getSingleton().isDeprecated(t))})),et=new I.A(J,ee,[k.J,_.Z]),eo=et.getTableMeta(),er=et.getGlobalMeta(),en=(0,V.u)();this.container=this.rootDocument.createElement("div"),e.insertBefore(this.container,e.firstChild),(0,S.yn)(this)&&((0,i._injectProductInfo)(t.licenseKey,e),(0,r.addClass)(e,"ht-wrapper")),this.guid=`ht_${(0,w.randomString)()}`,j.set(this.guid,this),this.columnIndexMapper=new b._,this.rowIndexMapper=new b._,this.columnIndexMapper.addLocalHook("indexesSequenceChange",e=>{J.runHooks("afterColumnSequenceChange",e)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",e=>{J.runHooks("afterRowSequenceChange",e)}),G.addEventListener(this.rootDocument.documentElement,"compositionstart",e=>{J.runHooks("beforeCompositionStart",e)}),Q=new v.A(J),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid);let ei=new x.A(eo,{rowIndexMapper:J.rowIndexMapper,columnIndexMapper:J.columnIndexMapper,countCols:()=>J.countCols(),countRows:()=>J.countRows(),propToCol:e=>o.propToCol(e),isEditorOpened:()=>!!J.getActiveEditor()&&J.getActiveEditor().isOpened(),countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return q.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return q.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>J.getShortcutManager(),createCellCoords:(e,t)=>J._createCellCoords(e,t),createCellRange:(e,t,o)=>J._createCellRange(e,t,o),visualToRenderableCoords:e=>{let{row:t,col:o}=e;return J._createCellCoords(t>=0?J.rowIndexMapper.getRenderableFromVisualIndex(t):t,o>=0?J.columnIndexMapper.getRenderableFromVisualIndex(o):o)},renderableToVisualCoords:e=>{let{row:t,col:o}=e;return J._createCellCoords(t>=0?J.rowIndexMapper.getVisualFromRenderableIndex(t):t,o>=0?J.columnIndexMapper.getVisualFromRenderableIndex(o):o)},findFirstNonHiddenRenderableRow:(e,t)=>{let o=t>e?1:-1,r=Math.min(e,t),n=Math.max(e,t),i=J.rowIndexMapper.getNearestNotHiddenIndex(e,o);return null===i||1===o&&i>n||-1===o&&i<r?null:i>=0?J.rowIndexMapper.getRenderableFromVisualIndex(i):i},findFirstNonHiddenRenderableColumn:(e,t)=>{let o=t>e?1:-1,r=Math.min(e,t),n=Math.max(e,t),i=J.columnIndexMapper.getNearestNotHiddenIndex(e,o);return null===i||1===o&&i>n||-1===o&&i<r?null:i>=0?J.columnIndexMapper.getRenderableFromVisualIndex(i):i},isDisabledCellSelection:(e,t)=>e<0||t<0?J.getSettings().disableVisualSelection:J.getCellMeta(e,t).disableVisualSelection});this.selection=ei;let el=e=>{let{hiddenIndexesChanged:t}=e;this.forceFullRender=!0,t&&this.selection.commit()};function es(e,t){let o="className"===e?J.rootElement:J.table;if(Y)(0,r.addClass)(o,t);else{let n=[],i=[];er[e]&&(n=Array.isArray(er[e])?er[e]:(0,d.stringToArray)(er[e])),t&&(i=Array.isArray(t)?t:(0,d.stringToArray)(t));let l=(0,d.getDifferenceOfArrays)(n,i),s=(0,d.getDifferenceOfArrays)(i,n);l.length&&(0,r.removeClass)(o,l),s.length&&(0,r.addClass)(o,s)}er[e]=t}function ea(){let e=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,e=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){0===this.validatorsInQueue&&!1===e&&(e=!0,this.onQueueEmpty(this.valid))}}}function eu(e,t,r){if(!e.length){r();return}let n=J.getActiveEditor(),i=new ea,l=!0;i.onQueueEmpty=()=>{n&&l&&n.cancelChanges(),r()};for(let r=e.length-1;r>=0;r--){let n,[s,a]=e[r],u=o.propToCol(a);n=Number.isInteger(u)?J.getCellMeta(s,u):{...Object.getPrototypeOf(eo),...eo},J.getCellValidator(n)&&(i.addValidatorToQueue(),J.validateCell(e[r][3],n,function(t,o){return function(r){if("boolean"!=typeof r)throw Error("Validation error: result is not boolean");!1===r&&!1===o.allowInvalid&&(l=!1,e.splice(t,1),o.valid=!0),i.removeValidatorFormQueue()}}(r,n),t))}i.checkIfQueueIsEmpty()}function ec(e,t){for(let t=e.length-1;t>=0;t--){let r=!1;if(null===e[t]){e.splice(t,1);continue}if(null!==e[t][2]&&void 0!==e[t][2]||null!==e[t][3]&&void 0!==e[t][3]){if(eo.allowInsertRow)for(;e[t][0]>J.countRows()-1;){let{delta:e}=o.createRow(void 0,void 0,{source:"auto"});if(0===e){r=!0;break}}if("array"===J.dataType&&(!eo.columns||0===eo.columns.length)&&eo.allowInsertColumn)for(;o.propToCol(e[t][1])>J.countCols()-1;){let{delta:e}=o.createCol(void 0,void 0,{source:"auto"});if(0===e){r=!0;break}}r||o.set(e[t][0],e[t][1],e[t][3])}}if(e.length>0){z.adjustRowsAndCols(),J.runHooks("beforeChangeRender",e,t),W.closeEditor(),J.render(),W.prepareEditor(),J.view.adjustElementsSize(),J.runHooks("afterChange",e,t||"edit");let o=J.getActiveEditor();o&&(0,i.isDefined)(o.refreshValue)&&o.refreshValue()}else J.render()}function ed(e,t,o){return Array.isArray(e)?e:[[e,t,o]]}function eh(e,t){let r=J.runHooks("beforeChange",e,t||"edit"),n=e.filter(e=>null!==e);if(!1===r||0===n.length){var l;return null===(l=J.getActiveEditor())||void 0===l||l.cancelChanges(),[]}for(let e=n.length-1;e>=0;e--){let t,[r,l,,s]=n[e],a=o.propToCol(l),{type:u,checkedTemplate:c,uncheckedTemplate:d}=Number.isInteger(a)?J.getCellMeta(r,a):{...Object.getPrototypeOf(eo),...eo};if("numeric"===u&&"string"==typeof s&&(0,C.isNumericLike)(s)&&(n[e][3]=function(e){let t=e.replace(",",".");return!1===isNaN(parseFloat(t))?parseFloat(t):e}(s)),"checkbox"===u){let t=(0,i.stringify)(s),o=t===(0,i.stringify)(c),r=t===(0,i.stringify)(d);(o||r)&&(n[e][3]=o?c:d)}}return n}this.columnIndexMapper.addLocalHook("cacheUpdated",el),this.rowIndexMapper.addLocalHook("cacheUpdated",el),this.selection.addLocalHook("afterSetRangeEnd",(e,t)=>{let o=(0,u.createObjectPropListener)(!1),n=this.selection.getSelectedRange(),{from:i,to:l}=n.current(),s=n.size()-1;this.runHooks("afterSelection",i.row,i.col,l.row,l.col,o,s),this.runHooks("afterSelectionByProp",i.row,J.colToProp(i.col),l.row,J.colToProp(l.col),o,s),t&&(!o.isTouched()||o.isTouched()&&!o.value)&&K.scrollTo(e);let a=ei.isSelectedByRowHeader(),c=ei.isSelectedByColumnHeader();a&&c?(0,r.addClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]):a?((0,r.removeClass)(this.rootElement,"ht__selection--columns"),(0,r.addClass)(this.rootElement,"ht__selection--rows")):c?((0,r.removeClass)(this.rootElement,"ht__selection--rows"),(0,r.addClass)(this.rootElement,"ht__selection--columns")):(0,r.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),"shift"!==ei.getSelectionSource()&&W.closeEditor(null),J.view.render(),W.prepareEditor()}),this.selection.addLocalHook("beforeSetFocus",e=>{this.runHooks("beforeSelectionFocusSet",e.row,e.col)}),this.selection.addLocalHook("afterSetFocus",e=>{let t=(0,u.createObjectPropListener)(!1);this.runHooks("afterSelectionFocusSet",e.row,e.col,t),(!t.isTouched()||t.isTouched()&&!t.value)&&K.scrollTo(e),W.closeEditor(),J.view.render(),W.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",e=>{let t=e.length-1,{from:o,to:r}=e[t];this.runHooks("afterSelectionEnd",o.row,o.col,r.row,r.col,t),this.runHooks("afterSelectionEndByProp",o.row,J.colToProp(o.col),r.row,J.colToProp(r.col),t)}),this.selection.addLocalHook("afterIsMultipleSelection",e=>{let t=this.runHooks("afterIsMultipleSelection",e.value);e.value&&(e.value=t)}),this.selection.addLocalHook("afterDeselect",()=>{W.closeEditor(),J.view.render(),(0,r.removeClass)(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSetRangeStart",...t)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSetRangeStartOnly",...t)}).addLocalHook("beforeSetRangeEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSetRangeEnd",...t)}).addLocalHook("beforeSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSelectColumns",...t)}).addLocalHook("afterSelectColumns",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterSelectColumns",...t)}).addLocalHook("beforeSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeSelectRows",...t)}).addLocalHook("afterSelectRows",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterSelectRows",...t)}).addLocalHook("beforeModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("modifyTransformStart",...t)}).addLocalHook("afterModifyTransformStart",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterModifyTransformStart",...t)}).addLocalHook("beforeModifyTransformFocus",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("modifyTransformFocus",...t)}).addLocalHook("afterModifyTransformFocus",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterModifyTransformFocus",...t)}).addLocalHook("beforeModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("modifyTransformEnd",...t)}).addLocalHook("afterModifyTransformEnd",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("afterModifyTransformEnd",...t)}).addLocalHook("beforeRowWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeRowWrap",...t)}).addLocalHook("beforeColumnWrap",function(){for(var e=arguments.length,t=Array(e),o=0;o<e;o++)t[o]=arguments[o];return q.runHooks("beforeColumnWrap",...t)}).addLocalHook("insertRowRequire",e=>this.alter("insert_row_above",e,1,"auto")).addLocalHook("insertColRequire",e=>this.alter("insert_col_start",e,1,"auto")),z={alter(e,t){var r,n;let l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0,u=e=>{if(0===e.length)return[];let t=[...e];return t.sort((e,t)=>{let[o]=e,[r]=t;return o===r?0:o>r?1:-1}),(0,d.arrayReduce)(t,(e,t)=>{let[o,r]=t,n=e[e.length-1],[i,l]=n,s=i+l;if(o<=s){let e=Math.max(r-(s-o),0);n[1]+=e}else e.push([o,r]);return e},[t[0]])};switch(e){case"insert_row_below":case"insert_row_above":let c=J.countSourceRows();if(eo.maxRows===c)return;let h="insert_row_below"===e?"below":"above";t=null!=t?t:"below"===h?c:0;let{delta:f,startPhysicalIndex:g}=o.createRow(t,l,{source:s,mode:h});ei.shiftRows(J.toVisualRow(g),f);break;case"insert_col_start":case"insert_col_end":let m="insert_col_end"===e?"end":"start";t=null!=t?t:"end"===m?J.countSourceCols():0;let{delta:p,startPhysicalIndex:w}=o.createCol(t,l,{source:s,mode:m});if(p){if(Array.isArray(eo.colHeaders)){let e=[J.toVisualColumn(w),0];e.length+=p,Array.prototype.splice.apply(eo.colHeaders,e)}ei.shiftColumns(J.toVisualColumn(w),p)}break;case"remove_row":let C;r=Array.isArray(t)?u(t):[[t,l]],C=0,(0,d.arrayEach)(r,e=>{let[t,r]=e,n=(0,i.isEmpty)(t)?J.countRows()-1:Math.max(t-C,0);if(Number.isInteger(t)&&(t=Math.max(t-C,0)),!o.removeRow(t,r,s))return;if(ei.isSelected()){let{row:e}=J.getSelectedRangeLast().highlight;e>=t&&e<=t+r-1&&W.closeEditor(!0)}let l=J.countRows(),a=eo.fixedRowsTop;a>=n+1&&(eo.fixedRowsTop-=Math.min(r,a-n));let u=eo.fixedRowsBottom;u&&n>=l-u&&(eo.fixedRowsBottom-=Math.min(r,u)),0===l?ei.deselect():"ContextMenu.removeRow"===s?ei.refresh():ei.shiftRows(t,-r),C+=r});break;case"remove_col":let y;n=Array.isArray(t)?u(t):[[t,l]],y=0,(0,d.arrayEach)(n,e=>{let[t,r]=e,n=(0,i.isEmpty)(t)?J.countCols()-1:Math.max(t-y,0),l=J.toPhysicalColumn(n);if(Number.isInteger(t)&&(t=Math.max(t-y,0)),!o.removeCol(t,r,s))return;if(ei.isSelected()){let{col:e}=J.getSelectedRangeLast().highlight;e>=t&&e<=t+r-1&&W.closeEditor(!0)}0===J.countCols()?ei.deselect():"ContextMenu.removeColumn"===s?ei.refresh():ei.shiftColumns(t,-r);let a=eo.fixedColumnsStart;a>=n+1&&(eo.fixedColumnsStart-=Math.min(r,a-n)),Array.isArray(eo.colHeaders)&&(void 0===l&&(l=-1),eo.colHeaders.splice(l,r)),y+=r});break;default:throw Error(`There is no such action "${e}"`)}a||z.adjustRowsAndCols(),J.view.render(),J.view.adjustElementsSize()},adjustRowsAndCols(){let e=eo.minRows,t=eo.minSpareRows,r=eo.minCols,n=eo.minSpareCols;if(e){let t=J.countRows();t<e&&o.createRow(t,e-t,{source:"auto"})}if(t){let e=J.countEmptyRows(!0);if(e<t){let r=Math.min(t-e,eo.maxRows-J.countSourceRows());o.createRow(J.countRows(),r,{source:"auto"})}}{let e;(r||n)&&(e=J.countEmptyCols(!0));let t=J.countCols();if(r&&!eo.columns&&t<r){let n=r-t;e+=n,o.createCol(t,n,{source:"auto"})}if(n&&!eo.columns&&"array"===J.dataType&&e<n){t=J.countCols();let r=Math.min(n-e,eo.maxCols-t);o.createCol(t,r,{source:"auto"})}}},populateFromArray(e,t,o,r,n){let i,l,s,a,c,h=[],f={},g=[],m=e.row,p=e.col;if(0===(l=t.length))return!1;let w=0,C=0;switch((0,u.isObject)(o)&&(w=o.col-p+1,C=o.row-m+1),n){case"shift_down":let y=(0,d.pivot)(t),v=y.length,R=Math.max(v,w),b=J.getData().slice(m),S=(0,d.pivot)(b).slice(p,p+R);for(s=0;s<R;s+=1)if(s<v){for(i=0,l=y[s].length;i<C-l;i+=1)y[s].push(y[s][i%l]);s<S.length?g.push(y[s].concat(S[s])):g.push(y[s].concat(Array(b.length).fill(null)))}else g.push(y[s%v].concat(S[s]));J.populateFromArray(m,p,(0,d.pivot)(g));break;case"shift_right":let E=t.length,H=Math.max(E,C),M=J.getData().slice(m).map(e=>e.slice(p));for(i=0;i<H;i+=1)if(i<E){for(s=0,a=t[i].length;s<w-a;s+=1)t[i].push(t[i][s%a]);if(i<M.length)for(let e=0;e<M[i].length;e+=1)t[i].push(M[i][e]);else t[i].push(...Array(M[0].length).fill(null))}else t.push(t[i%l].slice(0,H).concat(M[i]));J.populateFromArray(m,p,t);break;default:f.row=e.row,f.col=e.col;let A=0,x=0,I=!0,k=function(e){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t[e%t.length];return null!==o?r[o%r.length]:r},_=t.length,T=o?o.row-e.row+1:0;for(i=0,l=o?T:Math.max(_,T);i<l&&!(o&&f.row>o.row&&T>_||!eo.allowInsertRow&&f.row>J.countRows()-1)&&!(f.row>=eo.maxRows);i++){let t=i-A,n=k(t).length,d=o?o.col-e.col+1:0;if(a=o?d:Math.max(n,d),f.col=e.col,c=J.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipRowOnPaste){A+=1,f.row+=1,l+=1;continue}for(s=0,x=0;s<a&&!(o&&f.col>o.col&&d>n||!eo.allowInsertColumn&&f.col>J.countCols()-1)&&!(f.col>=eo.maxCols);s++){if(c=J.getCellMeta(f.row,f.col),("CopyPaste.paste"===r||"Autofill.fill"===r)&&c.skipColumnOnPaste){x+=1,f.col+=1,a+=1;continue}if(c.readOnly&&"UndoRedo.undo"!==r){f.col+=1;continue}let e=k(t,s-x),o=J.getDataAtCell(f.row,f.col);if(null!==e&&"object"==typeof e)if(Array.isArray(e)&&null===o&&(o=[]),null===o||"object"!=typeof o)I=!1;else{let t=(0,u.duckSchema)(Array.isArray(o)?o:o[0]||o),r=(0,u.duckSchema)(Array.isArray(e)?e:e[0]||e);(0,u.isObjectEqual)(t,r)||Array.isArray(t)&&Array.isArray(r)?e=(0,u.deepClone)(e):I=!1}else null!==o&&"object"==typeof o&&(I=!1);I&&h.push([f.row,f.col,e]),I=!0,f.col+=1}f.row+=1}J.setDataAtCell(h,null,null,r||"populateFromArray")}}},this.init=function(){Q.setData(eo.data),J.runHooks("beforeInit"),((0,l.isMobileBrowser)()||(0,l.isIpadOS)())&&(0,r.addClass)(J.rootElement,"mobile"),this.updateSettings(t,!0),this.view=new y.A(this);let e=eo.themeName||(0,P.J)(J.rootElement);J.useTheme(e),J.view.addClassNameToLicenseElement(J.getCurrentThemeName()),W=s.A.getInstance(J,eo,ei),K=(0,F.z)(J),B=new c.c(J),(0,S.yn)(this)&&(0,D.E)(J),J.runHooks("init"),this.render(),Y&&null===J.rootElement.offsetParent&&(0,r.observeVisibilityChangeOnce)(J.rootElement,()=>{J.view._wt.wtOverlays.updateLastSpreaderSize(),J.render(),J.view.adjustElementsSize()}),"object"==typeof Y&&(J.runHooks("afterChange",Y[0],Y[1]),Y=!1),J.runHooks("afterInit")},this._createCellCoords=function(e,t){return J.view._wt.createCellCoords(e,t)},this._createCellRange=function(e,t,o){return J.view._wt.createCellRange(e,t,o)},this.validateCell=function(e,t,o,r){let l=J.getCellValidator(t);function s(e){let r=!(arguments.length>1)||void 0===arguments[1]||arguments[1];if(!r||!0===t.hidden){o(e);return}let n=t.visualCol,i=t.visualRow,l=J.getCell(i,n,!0);if(l&&"TH"!==l.nodeName){let e=J.rowIndexMapper.getRenderableFromVisualIndex(i),t=J.columnIndexMapper.getRenderableFromVisualIndex(n);J.view._wt.getSetting("cellRenderer",e,t,l)}o(e)}if((0,i.isRegExp)(l)){var a;a=l,l=function(e,t){t(a.test(e))}}(0,n.isFunction)(l)?(e=J.runHooks("beforeValidate",e,t.visualRow,t.prop,r),J._registerImmediate(()=>{l.call(t,e,o=>{J&&(o=J.runHooks("afterValidate",o,e,t.visualRow,t.prop,r),t.valid=o,s(o),J.runHooks("postAfterValidate",o,e,t.visualRow,t.prop,r))})})):J._registerImmediate(()=>{t.valid=!0,s(t.valid,!1)})},this.setDataAtCell=function(e,t,r,n){let i,l,s,a=ed(e,t,r),u=[],c=n;for(i=0,l=a.length;i<l;i++){if("object"!=typeof a[i])throw Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof a[i][1])throw Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");s=a[i][1]>=this.countCols()?a[i][1]:o.colToProp(a[i][1]),u.push([a[i][0],s,Q.getAtCell(this.toPhysicalRow(a[i][0]),a[i][1]),a[i][2]])}c||"object"!=typeof e||(c=t);let d=eh(u,c);J.runHooks("afterSetDataAtCell",d,c),eu(d,c,()=>{ec(d,c)})},this.setDataAtRowProp=function(e,t,o,r){let n,i,l=ed(e,t,o),s=[],a=r;for(n=0,i=l.length;n<i;n++)s.push([l[n][0],l[n][1],Q.getAtCell(this.toPhysicalRow(l[n][0]),l[n][1]),l[n][2]]);a||"object"!=typeof e||(a=t);let u=eh(s,r);J.runHooks("afterSetDataAtRowProp",u,a),eu(u,a,()=>{ec(u,a)})},this.listen=function(){J&&!J.isListening()&&(j.forEach(e=>{J!==e&&e.unlisten()}),O=J.guid,J.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(O=null,J.runHooks("afterUnlisten"))},this.isListening=function(){return O===J.guid},this.destroyEditor=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1];W.closeEditor(e),J.view.render(),t&&ei.isSelected()&&W.prepareEditor()},this.populateFromArray=function(e,t,o,r,n,i,l){if("object"!=typeof o||"object"!=typeof o[0])throw Error("populateFromArray parameter `input` must be an array of arrays");let s="number"==typeof r?J._createCellCoords(r,n):null;return z.populateFromArray(J._createCellCoords(e,t),o,s,i,l)},this.spliceCol=function(e,t,r){for(var n=arguments.length,i=Array(n>3?n-3:0),l=3;l<n;l++)i[l-3]=arguments[l];return o.spliceCol(e,t,r,...i)},this.spliceRow=function(e,t,r){for(var n=arguments.length,i=Array(n>3?n-3:0),l=3;l<n;l++)i[l-3]=arguments[l];return o.spliceRow(e,t,r,...i)},this.getSelected=function(){if(ei.isSelected())return(0,d.arrayMap)(ei.getSelectedRange(),e=>{let{from:t,to:o}=e;return[t.row,t.col,o.row,o.col]})},this.getSelectedLast=function(){let e,t=this.getSelected();return t&&t.length>0&&(e=t[t.length-1]),e},this.getSelectedRange=function(){if(ei.isSelected())return Array.from(ei.getSelectedRange())},this.getSelectedRangeLast=function(){let e,t=this.getSelectedRange();return t&&t.length>0&&(e=t[t.length-1]),e},this.emptySelectedCells=function(e){if(!ei.isSelected()||0===this.countRows()||0===this.countCols())return;let t=[];(0,d.arrayEach)(ei.getSelectedRange(),e=>{if(e.isSingleHeader())return;let o=e.getTopStartCorner(),r=e.getBottomEndCorner();(0,C.rangeEach)(o.row,r.row,e=>{(0,C.rangeEach)(o.col,r.col,o=>{this.getCellMeta(e,o).readOnly||t.push([e,o,null])})})}),t.length>0&&this.setDataAtCell(t,e)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){let e=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(e,0),this.isRenderSuspended()||e!==this.renderSuspendedCounter||J.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||J.view.render())},this.batchRender=function(e){this.suspendRender();let t=e();return this.resumeRender(),t},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(t,0),(!this.isExecutionSuspended()&&t===this.executionSuspendedCounter||e)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.suspendExecution();let o=e();return this.resumeExecution(t),o},this.batch=function(e){this.suspendRender(),this.suspendExecution();let t=e();return this.resumeExecution(),this.resumeRender(),t},this.refreshDimensions=function(){if(!J.view)return;let e=J.view,{width:t,height:o}=e.getLastSize(),{width:r,height:n}=J.rootElement.getBoundingClientRect(),i=r!==t||n!==o;!1!==J.runHooks("beforeRefreshDimensions",{width:t,height:o},{width:r,height:n},i)&&((i||e._wt.wtOverlays.scrollableElement===J.rootWindow)&&(e.setLastSize(r,n),J.render(),e.adjustElementsSize()),J.runHooks("afterRefreshDimensions",{width:t,height:o},{width:r,height:n},i))},this.updateData=function(e,t){(0,T.p)(e,e=>{o=e},e=>{o=e,J.columnIndexMapper.fitToLength(this.getInitialColumnCount()),J.rowIndexMapper.fitToLength(this.countSourceRows()),z.adjustRowsAndCols(),ei.refresh()},{hotInstance:J,dataMap:o,dataSource:Q,internalSource:"updateData",source:t,metaManager:et,firstRun:Y})},this.loadData=function(e,t){(0,T.p)(e,e=>{o=e},()=>{et.clearCellsCache(),J.initIndexMappers(),z.adjustRowsAndCols(),ei.refresh(),Y&&(Y=[null,"loadData"])},{hotInstance:J,dataMap:o,dataSource:Q,internalSource:"loadData",source:t,metaManager:et,firstRun:Y})},this.getInitialColumnCount=function(){let e=eo.columns,t=0;if(Array.isArray(e))t=e.length;else if((0,n.isFunction)(e))if("array"===J.dataType){let o=this.countSourceCols();for(let r=0;r<o;r+=1)e(r)&&(t+=1)}else("object"===J.dataType||"function"===J.dataType)&&(t=o.colToPropCache.length);else if((0,i.isDefined)(eo.dataSchema)){let e=o.getSchema();t=Array.isArray(e)?e.length:(0,u.deepObjectSize)(e)}else t=this.countSourceCols();return t},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(e,t,r,n){return(0,i.isUndefined)(e)?o.getAll():o.getRange(J._createCellCoords(e,t),J._createCellCoords(r,n),o.DESTINATION_RENDERER)},this.getCopyableText=function(e,t,r,n){return o.getCopyableText(J._createCellCoords(e,t),J._createCellCoords(r,n))},this.getCopyableData=function(e,t){return o.getCopyable(e,o.colToProp(t))},this.getSchema=function(){return o.getSchema()},this.updateSettings=function(e){let t,r,l=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=(Y?J.loadData:J.updateData).bind(this),a=!1;if((0,i.isDefined)(e.rows))throw Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if((0,i.isDefined)(e.cols))throw Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if((0,i.isDefined)(e.ganttChart))throw Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');if(e.language){var c=e.language;let t=(0,A.Jn)(c);(0,M.Lp)(t)?(J.runHooks("beforeLanguageChange",t),er.language=t,J.runHooks("afterLanguageChange",t)):(0,A.A$)(c)}for(t in e)if("data"===t||"language"===t);else if("className"===t)es("className",e.className);else if("tableClassName"===t&&J.table)es("tableClassName",e.tableClassName),J.view._wt.wtOverlays.syncOverlayTableClassNames();else if(H.R.getSingleton().isRegistered(t)||H.R.getSingleton().isDeprecated(t)){let o=e[t];(0,n.isFunction)(o)?(H.R.getSingleton().addAsFixed(t,o,J),eo[t]=o):Array.isArray(o)&&(H.R.getSingleton().add(t,o,J),eo[t]=o)}else!l&&(0,u.hasOwnProperty)(e,t)&&(er[t]=e[t]);void 0===e.data&&void 0===eo.data?s(null,"updateSettings"):void 0!==e.data?s(e.data,"updateSettings"):void 0!==e.columns&&(o.createMap(),J.initIndexMappers());let d=J.countCols(),h=eo.columns;if(h&&(0,n.isFunction)(h)&&(a=!0),(void 0!==e.cell||void 0!==e.cells||void 0!==e.columns)&&et.clearCache(),d>0)for(t=0,r=0;t<d;t++){if(h){let e=a?h(t):h[r];e&&et.updateColumnMeta(r,e)}r+=1}(0,i.isDefined)(e.cell)&&(0,u.objectEach)(e.cell,e=>{J.setCellMetaObject(e.row,e.col,e)}),J.runHooks("afterCellMetaReset");let f=J.rootElement.style.height;""!==f&&(f=parseInt(J.rootElement.style.height,10));let g=e.height;if((0,n.isFunction)(g)&&(g=g()),l&&J.rootElement.getAttribute("style")&&J.rootElement.setAttribute("data-initialstyle",J.rootElement.getAttribute("style")),null===g){let e=J.rootElement.getAttribute("data-initialstyle");e&&(e.indexOf("height")>-1||e.indexOf("overflow")>-1)?J.rootElement.setAttribute("style",e):(J.rootElement.style.height="",J.rootElement.style.overflow="")}else void 0!==g&&(J.rootElement.style.height=isNaN(g)?`${g}`:`${g}px`,J.rootElement.style.overflow="hidden");if(void 0!==e.width){let t=e.width;(0,n.isFunction)(t)&&(t=t()),J.rootElement.style.width=isNaN(t)?`${t}`:`${t}px`}if(!l){if(J.view){J.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),J.view._wt.exportSettingsAsClassNames();let t=J.getCurrentThemeName(),o=(0,u.hasOwnProperty)(e,"themeName");t&&o&&t!==e.themeName&&(J.view.getStylesHandler().removeClassNames(),J.view.removeClassNameFromLicenseElement(t));let r=o&&e.themeName||(0,P.J)(J.rootElement);J.useTheme(r),J.view.addClassNameToLicenseElement(J.getCurrentThemeName())}J.runHooks("afterUpdateSettings",e)}z.adjustRowsAndCols(),J.view&&!Y&&(J.render(),J.view._wt.wtOverlays.adjustElementsSize()),!l&&J.view&&(""===f||""===g||void 0===g)&&f!==g&&J.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){let e=J.getSelectedLast();if(eo.getValue){if((0,n.isFunction)(eo.getValue))return eo.getValue.call(J);else if(e)return J.getData()[e[0][0]][eo.getValue]}else if(e)return J.getDataAtCell(e[0],e[1])},this.getSettings=function(){return eo},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(e,t,o,r,n){z.alter(e,t,o,r,n)},this.getCell=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t,n=e;if(t>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(t)))return null;r=this.columnIndexMapper.getRenderableFromVisualIndex(t)}if(e>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(e)))return null;n=this.rowIndexMapper.getRenderableFromVisualIndex(e)}return null===n||null===r||void 0===n||void 0===r?null:J.view.getCellAtCoords(J._createCellCoords(n,r),o)},this.getCoords=function(e){let t=this.view._wt.wtTable.getCoords(e);if(null===t)return null;let{row:o,col:r}=t,n=o,i=r;return o>=0&&(n=this.rowIndexMapper.getVisualFromRenderableIndex(o)),r>=0&&(i=this.columnIndexMapper.getVisualFromRenderableIndex(r)),J._createCellCoords(n,i)},this.colToProp=function(e){return o.colToProp(e)},this.propToCol=function(e){return o.propToCol(e)},this.toVisualRow=e=>this.rowIndexMapper.getVisualFromPhysicalIndex(e),this.toVisualColumn=e=>this.columnIndexMapper.getVisualFromPhysicalIndex(e),this.toPhysicalRow=e=>this.rowIndexMapper.getPhysicalFromVisualIndex(e),this.toPhysicalColumn=e=>this.columnIndexMapper.getPhysicalFromVisualIndex(e),this.getDataAtCell=function(e,t){return o.get(e,o.colToProp(t))},this.getDataAtRowProp=function(e,t){return o.get(e,t)},this.getDataAtCol=function(e){let t=[],r=o.getRange(J._createCellCoords(0,e),J._createCellCoords(eo.data.length-1,e),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getDataAtProp=function(e){let t=[],r=o.getRange(J._createCellCoords(0,o.propToCol(e)),J._createCellCoords(eo.data.length-1,o.propToCol(e)),o.DESTINATION_RENDERER);for(let e=0;e<r.length;e+=1)for(let o=0;o<r[e].length;o+=1)t.push(r[e][o]);return t},this.getSourceData=function(e,t,o,r){let n;return void 0===e?Q.getData():Q.getByRange(J._createCellCoords(e,t),J._createCellCoords(o,r))},this.getSourceDataArray=function(e,t,o,r){let n;return void 0===e?Q.getData(!0):Q.getByRange(J._createCellCoords(e,t),J._createCellCoords(o,r),!0)},this.getSourceDataAtCol=function(e){return Q.getAtColumn(e)},this.setSourceDataAtCell=function(e,t,o,r){let n=ed(e,t,o),l=this.hasHook("afterSetSourceDataAtCell"),s=[];l&&(0,d.arrayEach)(n,e=>{let[t,o,r]=e;s.push([t,o,Q.getAtCell(t,o),r])}),(0,d.arrayEach)(n,e=>{let[t,o,r]=e;Q.setAtCell(t,o,r)}),l&&this.runHooks("afterSetSourceDataAtCell",s,r),this.render();let a=J.getActiveEditor();a&&(0,i.isDefined)(a.refreshValue)&&a.refreshValue()},this.getSourceDataAtRow=function(e){return Q.getAtRow(e)},this.getSourceDataAtCell=function(e,t){return Q.getAtCell(e,t)},this.getDataAtRow=function(e){return o.getRange(J._createCellCoords(e,0),J._createCellCoords(e,this.countCols()-1),o.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(e,t,o,r){let n=void 0===e?[0,0,this.countRows(),this.countCols()]:[e,t,o,r],[i,l]=n,[,,s,a]=n,u=null,c=null;void 0===s&&(s=i),void 0===a&&(a=l);let d="mixed";return(0,C.rangeEach)(Math.max(Math.min(i,s),0),Math.max(i,s),e=>{let t=!0;return(0,C.rangeEach)(Math.max(Math.min(l,a),0),Math.max(l,a),o=>(c=this.getCellMeta(e,o).type,u?t=u===c:u=c,t)),d=t?c:"mixed",t}),d},this.removeCellMeta=function(e,t,o){let[r,n]=[this.toPhysicalRow(e),this.toPhysicalColumn(t)],i=et.getCellMetaKeyValue(r,n,o);!1!==J.runHooks("beforeRemoveCellMeta",e,t,o,i)&&(et.removeCellMeta(r,n,o),J.runHooks("afterRemoveCellMeta",e,t,o,i))},this.spliceCellsMeta=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;for(var o=arguments.length,r=Array(o>2?o-2:0),n=2;n<o;n++)r[n-2]=arguments[n];if(r.length>0&&!Array.isArray(r[0]))throw Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");t>0&&et.removeRow(this.toPhysicalRow(e),t),r.length>0&&(0,d.arrayEach)(r.reverse(),t=>{et.createRow(this.toPhysicalRow(e)),(0,d.arrayEach)(t,(t,o)=>this.setCellMetaObject(e,o,t))}),J.render()},this.setCellMetaObject=function(e,t,o){"object"==typeof o&&(0,u.objectEach)(o,(o,r)=>{this.setCellMeta(e,t,r,o)})},this.setCellMeta=function(e,t,o,r){if(!1===J.runHooks("beforeSetCellMeta",e,t,o,r))return;let n=e,i=t;e<this.countRows()&&(n=this.toPhysicalRow(e)),t<this.countCols()&&(i=this.toPhysicalColumn(t)),et.setCellMeta(n,i,o,r),J.runHooks("afterSetCellMeta",e,t,o,r)},this.getCellsMeta=function(){return et.getCellsMeta()},this.getCellMeta=function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{skipMetaExtension:!1},r=this.toPhysicalRow(e),n=this.toPhysicalColumn(t);return null===r&&(r=e),null===n&&(n=t),et.getCellMeta(r,n,{visualRow:e,visualColumn:t,...o})},this.getColumnMeta=function(e){return et.getColumnMeta(this.toPhysicalColumn(e))},this.getCellMetaAtRow=function(e){return et.getCellsMetaAtRow(e)},this.isColumnModificationAllowed=function(){return!("object"===J.dataType||eo.columns)},this.getCellRenderer=function(e,t){let o="number"==typeof e?J.getCellMeta(e,t).renderer:e.renderer;return"string"==typeof o?(0,g.gB)(o):(0,i.isUndefined)(o)?(0,g.gB)("text"):o},this.getCellEditor=function(e,t){let o="number"==typeof e?J.getCellMeta(e,t).editor:e.editor;return"string"==typeof o?(0,m.M8)(o):(0,i.isUndefined)(o)?(0,m.M8)("text"):o},this.getCellValidator=function(e,t){let o="number"==typeof e?J.getCellMeta(e,t).validator:e.validator;return"string"==typeof o?(0,p.by)(o):o},this.validateCells=function(e){this._validateCells(e)},this.validateRows=function(e,t){if(!Array.isArray(e))throw Error("validateRows parameter `rows` must be an array");this._validateCells(t,e)},this.validateColumns=function(e,t){if(!Array.isArray(e))throw Error("validateColumns parameter `columns` must be an array");this._validateCells(t,void 0,e)},this._validateCells=function(e,t,o){let r=new ea;e&&(r.onQueueEmpty=e);let n=J.countRows()-1;for(;n>=0;){if(void 0!==t&&-1===t.indexOf(n)){n-=1;continue}let e=J.countCols()-1;for(;e>=0;){if(void 0!==o&&-1===o.indexOf(e)){e-=1;continue}r.addValidatorToQueue(),J.validateCell(J.getDataAtCell(n,e),J.getCellMeta(n,e),e=>{if("boolean"!=typeof e)throw Error("Validation error: result is not boolean");!1===e&&(r.valid=!1),r.removeValidatorFormQueue()},"validateCells"),e-=1}n-=1}r.checkIfQueueIsEmpty()},this.getRowHeader=function(e){let t=eo.rowHeaders,o=e;return void 0!==o&&(o=J.runHooks("modifyRowHeader",o)),void 0===o?(t=[],(0,C.rangeEach)(J.countRows()-1,e=>{t.push(J.getRowHeader(e))})):Array.isArray(t)&&void 0!==t[o]?t=t[o]:(0,n.isFunction)(t)?t=t(o):t&&"string"!=typeof t&&"number"!=typeof t&&(t=o+1),t},this.hasRowHeaders=function(){return!!eo.rowHeaders},this.hasColHeaders=function(){if(void 0!==eo.colHeaders&&null!==eo.colHeaders)return!!eo.colHeaders;for(let e=0,t=J.countCols();e<t;e++)if(J.getColHeader(e))return!0;return!1},this.getColHeader=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,o=J.runHooks("modifyColHeader",e);if(void 0===o){let e=[],t=J.countCols();for(let o=0;o<t;o++)e.push(J.getColHeader(o));return e}let r=eo.colHeaders,i=J.toPhysicalColumn(o),l=function(e){let t=[],o=J.countCols(),r=0;for(;r<o;r++)(0,n.isFunction)(eo.columns)&&eo.columns(r)&&t.push(r);return t[e]}(i);return!1===eo.colHeaders?r=null:eo.columns&&(0,n.isFunction)(eo.columns)&&eo.columns(l)&&eo.columns(l).title?r=eo.columns(l).title:eo.columns&&eo.columns[i]&&eo.columns[i].title?r=eo.columns[i].title:Array.isArray(eo.colHeaders)&&void 0!==eo.colHeaders[i]?r=eo.colHeaders[i]:(0,n.isFunction)(eo.colHeaders)?r=eo.colHeaders(i):eo.colHeaders&&"string"!=typeof eo.colHeaders&&"number"!=typeof eo.colHeaders&&(r=(0,R.spreadsheetColumnLabel)(o)),r=J.runHooks("modifyColumnHeaderValue",r,e,t)},this._getColWidthFromSettings=function(e){let t;if(e>=0&&(t=J.getCellMeta(0,e).width),(void 0===t||t===eo.width)&&(t=eo.colWidths),null!=t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getColWidth=function(e,t){let o=J._getColWidthFromSettings(e);return void 0===(o=J.runHooks("modifyColWidth",o,e,t))&&(o=E.j),o},this._getRowHeightFromSettings=function(e){let t=this.view.getDefaultRowHeight(),o=eo.rowHeights;if(null!=o){switch(typeof o){case"object":o=o[e];break;case"function":o=o(e)}"string"==typeof o&&(o=parseInt(o,10))}return null!=o&&o<t?t:o},this.getRowHeight=function(e,t){let o=J._getRowHeightFromSettings(e);return J.runHooks("modifyRowHeight",o,e,t)},this.countSourceRows=function(){return Q.countRows()},this.countSourceCols=function(){return Q.countFirstRowKeys()},this.countRows=function(){return o.getLength()},this.countCols=function(){return Math.min(eo.maxCols,this.columnIndexMapper.getNotTrimmedIndexesLength())},this.countRenderedRows=function(){return J.view._wt.drawn?J.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return J.view._wt.drawn?J.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return J.view._wt.drawn?J.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return J.view._wt.drawn?J.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.rangeEachReverse)(J.countRows()-1,o=>{if(J.isEmptyRow(o))t+=1;else if(!0===e)return!1}),t},this.countEmptyCols=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0;return(0,C.rangeEachReverse)(J.countCols()-1,o=>{if(J.isEmptyCol(o))t+=1;else if(!0===e)return!1}),t},this.isEmptyRow=function(e){return eo.isEmptyRow.call(J,e)},this.isEmptyCol=function(e){return eo.isEmptyCol.call(J,e)},this.selectCell=function(e,t,o,r){let n=!(arguments.length>4)||void 0===arguments[4]||arguments[4],l=!(arguments.length>5)||void 0===arguments[5]||arguments[5];return!((0,i.isUndefined)(e)||(0,i.isUndefined)(t))&&this.selectCells([[e,t,o,r]],n,l)},this.selectCells=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[]],t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],o=!(arguments.length>2)||void 0===arguments[2]||arguments[2];!1===t&&K.suspend();let r=ei.selectCells(e);return r&&o&&J.listen(),K.resume(),r},this.selectColumns=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return ei.selectColumns(e,t,o)},this.selectRows=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;return ei.selectRows(e,t,o)},this.deselectCell=function(){ei.deselect()},this.selectAll=function(){let e=!(arguments.length>0)||void 0===arguments[0]||arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,o=arguments.length>2?arguments[2]:void 0;K.skipNextScrollCycle(),ei.selectAll(e,t,o)};let ef=(e,t)=>e.getNearestNotHiddenIndex(t,1,!0);this.scrollViewportTo=function(e,t){if("number"==typeof e){var o;e={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:null===(o=arguments[4])||void 0===o||o}}let{row:r,col:i,considerHiddenIndexes:l}=null!=e?e:{},s=r,a=i;if((0,n.isFunction)(t)&&this.addHookOnce("afterScroll",t),void 0===l||l){let e=Number.isInteger(r)&&r>=0,t=Number.isInteger(i)&&i>=0,o=e?ef(this.rowIndexMapper,r):void 0,n=t?ef(this.columnIndexMapper,i):void 0;if(null===o||null===n)return!1;s=e?J.rowIndexMapper.getRenderableFromVisualIndex(o):r,a=t?J.columnIndexMapper.getRenderableFromVisualIndex(n):i}let u=Number.isInteger(s),c=Number.isInteger(a),d=!1;return u&&s>=0&&c&&a>=0?d=J.view.scrollViewport(J._createCellCoords(s,a),e.horizontalSnap,e.verticalSnap):u&&s>=0&&(c&&a<0||!c)?d=J.view.scrollViewportVertically(s,e.verticalSnap):c&&a>=0&&(u&&s<0||!u)&&(d=J.view.scrollViewportHorizontally(a,e.horizontalSnap)),(0,n.isFunction)(t)&&(d?this.view.render():(this.removeHook("afterScroll",t),this._registerMicrotask(()=>t()))),d},this.scrollToFocusedCell=function(e){if(!this.selection.isSelected())return!1;(0,n.isFunction)(e)&&this.addHookOnce("afterScroll",e);let{highlight:t}=this.getSelectedRangeLast(),o=this.scrollViewportTo(t.toObject());return o?this.view.render():(0,n.isFunction)(e)&&(this.removeHook("afterScroll",e),this._registerMicrotask(()=>e())),o},this.destroy=function(){if(J._clearTimeouts(),J._clearImmediates(),J.view&&J.view.destroy(),Q&&Q.destroy(),Q=null,this.getShortcutManager().destroy(),et.clearCache(),j.delete(this.guid),(0,S.yn)(J)){let e=this.rootDocument.querySelector(".hot-display-license-info");e&&e.parentNode.removeChild(e)}(0,r.empty)(J.rootElement),G.destroy(),W&&W.destroy(),J.batchExecution(()=>{J.rowIndexMapper.unregisterAll(),J.columnIndexMapper.unregisterAll(),en.getItems().forEach(e=>{let[,t]=e;t.destroy()}),en.clear(),J.runHooks("afterDestroy")},!0),H.R.getSingleton().destroy(J),(0,u.objectEach)(J,(e,t,o)=>{var r;(0,n.isFunction)(e)?o[t]=(r=t,()=>{throw Error(`The "${r}" method cannot be called because this Handsontable instance has been destroyed`)}):"guid"!==t&&(o[t]=null)}),J.isDestroyed=!0,o&&o.destroy(),o=null,z=null,ei=null,W=null,J=null},this.getActiveEditor=function(){return W.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return J.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return J.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return J.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return J.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return J.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return J.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return J.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return J.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return J.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return J.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return J.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return J.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(e){return en.getItem((0,w.toUpperCaseFirst)(e))},this.getPluginName=function(e){return e===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:en.getId(e)},this.getInstance=function(){return J},this.addHook=function(e,t,o){H.R.getSingleton().add(e,t,J,o)},this.hasHook=function(e){return H.R.getSingleton().has(e,J)||H.R.getSingleton().has(e)},this.addHookOnce=function(e,t,o){H.R.getSingleton().once(e,t,J,o)},this.removeHook=function(e,t){H.R.getSingleton().remove(e,t,J)},this.runHooks=function(e,t,o,r,n,i,l){return H.R.getSingleton().run(J,e,t,o,r,n,i,l)},this.getTranslatedPhrase=function(e,t){return(0,M.E9)(eo.language,e,t)},this.toHTML=()=>(0,h.instanceToHTML)(this),this.toTableElement=()=>{let e=this.rootDocument.createElement("div");return e.insertAdjacentHTML("afterbegin",(0,h.instanceToHTML)(this)),e.firstElementChild},this.timeouts=[],this.useTheme=e=>{this.view.getStylesHandler().useTheme(e),this.runHooks("afterSetTheme",e,!!Y)},this.getCurrentThemeName=()=>this.view.getStylesHandler().getThemeName(),this._registerTimeout=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=e;"function"==typeof o&&(o=setTimeout(o,t)),this.timeouts.push(o)},this._clearTimeouts=function(){(0,d.arrayEach)(this.timeouts,e=>{clearTimeout(e)})},this.immediates=[],this._registerImmediate=function(e){this.immediates.push(setImmediate(e))},this._clearImmediates=function(){(0,d.arrayEach)(this.immediates,e=>{clearImmediate(e)})},this._registerMicrotask=function(e){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||e()})},this._getEditorManager=function(){return W};let eg=(0,L.s)({handleEvent:()=>J.isListening(),beforeKeyDown:e=>this.runHooks("beforeKeyDown",e),afterKeyDown:e=>{this.isDestroyed||J.runHooks("afterDocumentKeyDown",e)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",e=>{!1===e.ctrlKey&&!1===e.metaKey&&eg.releasePressedKeys()}),this.getShortcutManager=function(){return eg},this.getFocusManager=function(){return B},(0,f.f4)().forEach(e=>{let t=(0,f.sd)(e);en.addItem(e,new t(this))}),(0,N.rl)(J),eg.setActiveContextName("grid"),H.R.getSingleton().run(J,"construct")}}}]);